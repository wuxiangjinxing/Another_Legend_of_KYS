function zjtype(flag)
	--1普通2特殊3畅想4自创
	if flag ~= nil then
		JY.Base["类型"] = flag
	else
		return JY.Base["类型"]
	end
end

--无酒不欢：在自身位置播放动画的函数
function CurIDTXDH2(id, eft, order, str, strColor, endFrame)
	--增加文字颜色控制
	if strColor == nil then
		strColor = C_GOLD
	end
	--增加强制结束帧
	if endFrame == nil then
		endFrame = CC.Effect[eft]
	end
	local x0, y0 = WAR.Person[id]["坐标X"], WAR.Person[id]["坐标Y"]
	local hb = GetS(JY.SubScene, x0, y0, 4)
	local starteft = 0
	
	for i = 0, eft - 1 do
		starteft = starteft + CC.Effect[i]
	end
	
	local ssid = lib.SaveSur(0, 0, CC.ScreenW, CC.ScreenH)
	for ii = 1, endFrame, order do
		lib.GetKey()
		lib.PicLoadCache(3, (starteft + ii) * 2, CC.ScreenW / 2, CC.ScreenH / 2 - hb, 2, 192)
		if str ~= nil then
			DrawString(-1, CC.ScreenH / 2 - hb, str, strColor, CC.DefaultFont)
		end
		ShowScreen()
		lib.Delay(CC.BattleDelay)
		lib.LoadSur(ssid, 0, 0)
	end
	lib.FreeSur(ssid)
	Cls()
end

--[[function QQSH(id)
	if MPPD(id)==12 and (PersonKF(id,72) or PersonKF(id,73) or PersonKF(id,125) or PersonKF(id,71)) then
		return true
	elseif PersonKF(id,72) and PersonKF(id,73) and PersonKF(id,125) and PersonKF(id,71) then
		return true
	elseif inteam(id) then
		return false
	else
		return true
	end
end]]

function TGLX(id)
	if id==143 then
		return true
	elseif  id==144 then
	return true
	elseif  id==145 then
	return true
	elseif  id==146 then
	return true
	elseif  id==147 then
	return true
	elseif  id==148 then
	return true
	else
		return false
	end
end

function pcount(t, flag) --t = 1, 我方；flag dead/alive
	local n = 0
	for i = 0, WAR.PersonNum - 1 do
		if flag == nil or flag == WAR.Person[i]["死亡"] then
			if t == 1 and WAR.Person[i]["我方"] == WAR.Person[WAR.CurID]["我方"] then
				n = n + 1
			elseif t == 2 and WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				n = n + 1
			end
		end
	end
	return n
end

function putong(flag)
	--普通：1拳2剑3刀4特5罡6仁7医8毒9琴10盗11赌12阵13暗
	if flag ~= nil then
		JY.Base["普通"] = flag
	elseif T10XXZ(0) and JY.Person[0]["无用13"] > 0 then --武骧金星：萧笑竹特殊判定
		return JY.Person[0]["无用13"]
	else
		return JY.Base["普通"]
	end	
end

function teshu(flag)
	--特殊1零2水4石5白6萧7东8李9赵   
	if flag ~= nil then
		JY.Base["特殊"] = flag
	else
		return JY.Base["特殊"]
	end		
end

function wash(t)
	if (t ~= nil and t == true) or DrawStrBoxYesNo(-1, -1, "要洗武功吗？", C_WHITE, CC.DefaultFont) then
		Cls()
		local nexty = CC.MainSubMenuY + CC.SingleLineHeight
		local p = SelectTeamMenu(CC.MainSubMenuX, nexty)
		if p > 0 then
			local pid = JY.Base["队伍" .. p]
			local menu = {}
			for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
				if JY.Person[pid]["武功"..i] > 0 then
					local wg = JY.Person[pid]["武功"..i]
					menu[#menu+1] = {JY.Wugong[wg]["名称"], nil, 1, wg, i}
				end
			end	
			Cls()
			local r = ShowMenu(menu, #menu, 0, CC.MainSubMenuX, CC.MainSubMenuY, 0, 0, 1, 1, CC.DefaultFont, C_ORANGE, C_WHITE)
			if r > 0 then
				local thingid = -1
				for i = 0, JY.ThingNum - 1 do
					if JY.Thing[i]["练出武功"] > 0 and JY.Thing[i]["练出武功"] == menu[r][4] then
						thingid = i
						local level = math.modf(JY.Person[pid]["武功等级" .. menu[r][5]] / 100) + 1
						if level > 10 then level = 10 end
						AddPersonAttrib(pid, "内力最大值", -JY.Thing[thingid]["加内力最大值"] * 2 * level)
						AddPersonAttrib(pid, "攻击力", -JY.Thing[thingid]["加攻击力"] * 2 * level)
						AddPersonAttrib(pid, "轻功", -JY.Thing[thingid]["加轻功"] * 2 * level)
						AddPersonAttrib(pid, "防御力", -JY.Thing[thingid]["加防御力"] * 2 * level)	
						AddPersonAttrib(pid, "医疗能力", -JY.Thing[thingid]["加医疗能力"] * 2 * level)
						AddPersonAttrib(pid, "用毒能力", -JY.Thing[thingid]["加用毒能力"] * 2 * level)
						AddPersonAttrib(pid, "解毒能力", -JY.Thing[thingid]["加解毒能力"] * 2 * level)
						AddPersonAttrib(pid, "抗毒能力", -JY.Thing[thingid]["加抗毒能力"] * 2 * level)
						AddPersonAttrib(pid, "拳掌功夫", -JY.Thing[thingid]["加拳掌功夫"] * 2 * level)
						AddPersonAttrib(pid, "御剑能力", -JY.Thing[thingid]["加御剑能力"] * 2 * level)
						AddPersonAttrib(pid, "耍刀技巧", -JY.Thing[thingid]["加耍刀技巧"] * 2 * level)
						AddPersonAttrib(pid, "特殊兵器", -JY.Thing[thingid]["加特殊兵器"] * 2 * level)		
						break
					end
				end
				for i = menu[r][5], #menu - 1 do
					JY.Person[pid]["武功"..i] = JY.Person[pid]["武功"..i+1]
					JY.Person[pid]["武功等级"..i] = JY.Person[pid]["武功等级"..i+1]
				end
				JY.Person[pid]["武功"..#menu] = 0
				JY.Person[pid]["武功等级"..#menu] = 0
				QZXS(JY.Person[pid]["姓名"].."已经洗掉"..menu[r][1])
			end
		end
	end
end

function breakdown(m, n) --string table break down into n
	--status window = 62
	--side window = 50
	if n == nil then n = 50 end
	local count2 = #m
	local count = 1
	while true do
		local s = m[count]
		if s ~= nil and string.len(s) > n then
			local t = string.sub(s, 1, n)
			local t2 = string.sub(s, n + 1)
			m[count] = t
			table.insert(m, count + 1, t2)
			count2 = count2 + 1
		end		
		count = count + 1
		if count > count2 then break end
	end
	return m
end

function anqinum() --返回暗器数
	local num = 0
	for i = 1, CC.MyThingNum do
		if JY.Base["物品" .. i] >= 0 and JY.Base["物品数量" .. i] > 0 
			and JY.Thing[JY.Base["物品" .. i]]["类型"] == 4 then
			num = num + JY.Base["物品数量" .. i]
		end
	end
	return num
end

function randomanqi() --返回随机暗器 武骧金星：改为随机获得一种
	--local num = 0
	--local menu = {}
	--for i = 1, CC.MyThingNum do
	--	if JY.Base["物品" .. i] >= 0 and JY.Base["物品数量" .. i] > 0 
	--		and JY.Thing[JY.Base["物品" .. i]]["类型"] == 4 then
	--		num = num + 1
	--		menu[num] = {JY.Base["物品" .. i], JY.Base["物品数量" .. i]}
	--	end
	--end
	--if num > 0 then
	--	local r = math.random(#menu)
	--	return menu[r][1]
	--end
	--return -1
	return math.random(28,35)
end

function thingnum(thing)
	local num = 0
	for i = 1, CC.MyThingNum do
		if JY.Base["物品" .. i] >= 0 and JY.Base["物品" .. i] == thing then
			num = JY.Base["物品数量" .. i]
			break
		end
	end
	return num
end
function zssdz(pid) ----
   local a = JY.Person[pid]["半身像"]*2
   for i = 1,121,60 do 
   lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55, i)
   lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
	ShowScreen()
	--lib.Delay(200)
   end
	ShowScreen()
	lib.Delay(100)
end
function sixi(pid, t)
	local a = 0
	if t == 1 then
		a = JY.Person[pid]["拳掌功夫"] + MPAttrib(pid, 10)
		if JY.Person[pid]["武器"] >= 0 then
			a = a + JY.Thing[JY.Person[pid]["武器"]]["加拳掌功夫"]
		end
		if JY.Person[pid]["防具"] >= 0 then
			a = a + JY.Thing[JY.Person[pid]["防具"]]["加拳掌功夫"]
		end		
		if NF(pid) and juexing() > 1 then --聂风十强拳劲
		    a = a + math.modf(JY.Person[pid]["内力"]/25)
		end	
		if BJY(pid) then --步惊云拳劲
		    a = a + math.modf(JY.Person[pid]["内力"]/25)
		end	
		if wglw(pid,153) then
			a = a + math.modf(JY.Person[pid]["品德"]*3)
		end	
	elseif t == 2 then
		a = JY.Person[pid]["御剑能力"] + MPAttrib(pid, 11)
		if JY.Person[pid]["武器"] >= 0 then
			a = a + JY.Thing[JY.Person[pid]["武器"]]["加御剑能力"]
		end
		if JY.Person[pid]["防具"] >= 0 then
			a = a + JY.Thing[JY.Person[pid]["防具"]]["加御剑能力"]
		end	
		if wglw(pid,89) or (PersonKF(pid,89) and DT(pid,19)) then --紫霞剑系
		    a = a + math.modf(JY.Person[pid]["内力"]/25)
		end		
		if NF(pid) and juexing() > 1 then --聂风十强剑气
		    a = a + math.modf(JY.Person[pid]["内力"]/25)
		end	
		if BJY(pid) and juexing() > 0 then --步惊云剑气
		    a = a + math.modf(JY.Person[pid]["内力"]/25)
		end
		if wglw(pid,153) then
			a = a + math.modf(JY.Person[pid]["品德"]*3)
		end	
	elseif t == 3 then
		a = JY.Person[pid]["耍刀技巧"] + MPAttrib(pid, 12)
		if JY.Person[pid]["武器"] >= 0 then
			a = a + JY.Thing[JY.Person[pid]["武器"]]["加耍刀技巧"]
		end
		if JY.Person[pid]["防具"] >= 0 then
			a = a + JY.Thing[JY.Person[pid]["防具"]]["加耍刀技巧"]
		end				
		if NF(pid) then --创刀刀气
		    a = a + math.modf(JY.Person[pid]["内力"]/25)
		end
		if wglw(pid,153) then
			a = a + math.modf(JY.Person[pid]["品德"]*3)
		end	
	elseif t == 4 then
		a = JY.Person[pid]["特殊兵器"] + MPAttrib(pid, 13)
		if JY.Person[pid]["武器"] >= 0 then
			a = a + JY.Thing[JY.Person[pid]["武器"]]["加特殊兵器"]
		end
		if JY.Person[pid]["防具"] >= 0 then
			a = a + JY.Thing[JY.Person[pid]["防具"]]["加特殊兵器"]
		end		
		if NF(pid) and juexing() > 1 then --聂风十强特劲
		    a = a + math.modf(JY.Person[pid]["内力"]/25)
		end
		if wglw(pid,153) then
			a = a + math.modf(JY.Person[pid]["品德"]*3)
		end	
	elseif t == 5 then
		a = JY.Person[pid]["暗器技巧"] + MPAttrib(pid, 7)
		if JY.Person[pid]["武器"] >= 0 then
			a = a + JY.Thing[JY.Person[pid]["武器"]]["加暗器技巧"]
		end
		if JY.Person[pid]["防具"] >= 0 then
			a = a + JY.Thing[JY.Person[pid]["防具"]]["加暗器技巧"]
		end				
		if NF(pid) and juexing() > 1 then --聂风十强暗劲
		    a = a + math.modf(JY.Person[pid]["内力"]/25)
		end	
		if wglw(pid,153) then
			a = a + math.modf(JY.Person[pid]["品德"]*3)
		end	
	end
	
	if T3XYK(pid) then
		a = a + limitX(math.modf(JY.Person[pid]["实战"] / 15), 0, 30)
	end

    if DT(pid, 664) then a = a + RW.fame end --武骧金星：小宝特殊判定
	
	if hasTF(pid, 141) then
		a = 999
	end
	
    if JY.Status == GAME_WMAP then
       if WAR.JSYZ[pid] ~= nil then 
	      a = 0
	   end
    end
	return a
end

function getzx(aa) 
	if JY.Thing[aa][WZ6] < 0 then
		return 0
	end	
	return JY.Thing[aa][WZ6]
end

function setzx(aa, zx) 
	JY.Thing[aa][WZ6] = zx
end

function zj()
	--if GetS(103, 0, 0, 1) < 0 then
		--return 0
	--end
	--return GetS(103, 0, 0, 1)
	return 0
end

function cxzj()
	if GetS(103, 0, 0, 1) <= 0 then
		return 0
	end
	return GetS(103, 0, 0, 1)
end

function effective(eff,pid)
    if eff ~= nil and eff[pid] ~= nil and eff[pid] > 0 then
	  return true
	else
	  return false
	end
end

function gethead(hid, flag)
    local headid = hid
	if hid == 0 then
		return JY.Person[0]["半身像"]
	end
	if flag ~= nil and flag == 1 then
		return hid
	end
	if hid > 0 and JY.Person[hid]["半身像"] > 0 then
		return JY.Person[hid]["半身像"]
	end

	return headid
end

function ShowMenu3(menuItem,numItem,rownum,x1,y1,x2,y2,isBox,isEsc,size,color,selectColor,Title1,Title2,color2,color3,linenum, flag)
    local w = 0
    local h = 0
    local i = 0
    local newNumItem = 0
    lib.GetKey()
    local newMenu = {}
    for i = 1, numItem do
        if menuItem[i][3] > 0 then
            newNumItem = newNumItem + 1
            newMenu[newNumItem] = {menuItem[i][1], menuItem[i][2], menuItem[i][3], i}
        end
    end
    if newNumItem == 0 then
        return 0
    end
    local maxlength = 0
    for i = 1, newNumItem do
	    if maxlength < string.len(newMenu[i][1]) then
		    maxlength = string.len(newMenu[i][1])
	    end
    end
    if linenum == nil then
  	   linenum = math.modf((newNumItem-1)/rownum+1)
    end
    if x1 == -2 and y1 == -2 or x2 == -2 and y2 == -2 then
        w = (size * maxlength / 2 + CC.MenuBorderPixel) * rownum + CC.MenuBorderPixel
	    if w < size*string.len(Title1 or "")/2 + size*string.len(Title2 or "")/2 + size + 2 * CC.MenuBorderPixel then
		    w = size*string.len(Title1 or "")/2 + size*string.len(Title2 or "")/2 + size + 2 * CC.MenuBorderPixel
	    end
	    if Title1 == nil and Title2 == nil then
		    h = (size + CC.MenuBorderPixel*2 + 5) * linenum + CC.MenuBorderPixel
	    else
		    h = (size + CC.MenuBorderPixel*2 + 5) * (linenum + 1) + CC.MenuBorderPixel + 10
	    end
    else
        w = x2 - x1
        h = y2 - y1
    end
    if x1 == -2 and y1 == -2 and x2 == -2 and y2 == -2 then
  	   x1 = math.modf(CC.ScreenW/2 - w/2)
	   y1 = math.modf(CC.ScreenH/2 - h/2)
    elseif x1 == -2 and y1 == -2 then
	   x1 = x2 - w
	   y1 = y2 - h
    end
    local xx = x1 + w/rownum/2 - size * maxlength / 4
    local start = 1
    local current = 1
    local keyPress = -1
    local returnValue = 0
    if isBox == 1 then
	   DrawBox(x1,y1,x1+w,y1+h,C_WHITE)
    end
    local surid = lib.SaveSur(0,0,CC.ScreenW,CC.ScreenH)
    while true do
	if flag ~= nil then
		Cls(x1,y1,x1+w,y1+h)
	else
		Cls()
	end
	lib.LoadSur(surid, 0, 0)
	if Title1 ~= nil then
		DrawString(x1 + CC.MenuBorderPixel,y1 + CC.MenuBorderPixel,Title1,selectColor,size)
	end
	if Title2 ~= nil then
		DrawString(x1 + w - size*string.len(Title2)/2 - CC.MenuBorderPixel,y1 + CC.MenuBorderPixel,Title2,selectColor,size)
	end
	local over = limitX(start + rownum * linenum - 1,start,newNumItem)
	local yy = y1 + size + 2 * CC.MenuBorderPixel + 15
	if Title1 == nil and Title2 == nil then
		yy = y1 + 10
	end
	for i = start, over do
		local colorS = color
		local row = rownum - 1
		if math.fmod(i,rownum) ~= 0 then
			row = math.fmod(i,rownum) - 1
		end
		if i == current then
			colorS = selectColor
			lib.Background(xx+row*w/rownum-3,yy-3,xx+row*w/rownum+maxlength*size/2+3,yy+size+8, 128, color)
		end
		if newMenu[i][3] == 2 and color2 ~= nil then
			colorS = color2
		end
		if newMenu[i][3] == 3 and color3 ~= nil then
			colorS = color3
		end
		DrawString(xx+row*w/rownum,yy,newMenu[i][1],colorS,size)
		if math.fmod(i,rownum) == 0 then
			yy = yy + size + CC.MenuBorderPixel * 2 + 5
		end
	end
	ShowScreen()
	keyPress = WaitKey(1)
	local moda = math.fmod(newNumItem,rownum)
	if moda == 0 then
		moda = rownum
	end
	local modc = math.fmod(current,rownum)
	if modc == 0 then
		modc = rownum
	end
	if isEsc == 1 and keyPress==VK_ESCAPE then                  --Esc 退出
		break;
	elseif keyPress==VK_DOWN then                --Down
		current = current + rownum
		if current > over and over < newNumItem then
			start = start + rownum
		elseif current > newNumItem then
			start = 1
			current = modc
		end
	elseif keyPress==VK_UP then                  --Up
		current = current - rownum
		if current < start and start > 1 then
			start = start - rownum
		elseif current < 1 then
			start = limitX(newNumItem-(linenum-1)*rownum-moda+1,1,newNumItem)
			if moda >= modc then
				current = newNumItem + modc - moda
			else
				current = newNumItem - moda - rownum + modc
			end
		end
	elseif keyPress == VK_RIGHT then
		current = current + 1
		if current > over and over < newNumItem then
			start = start + rownum
		elseif current > newNumItem then
			start = 1
			current = 1
		end
	elseif keyPress == VK_LEFT then
		current = current - 1
		if current < start and start > 1 then
			start = start - rownum
		elseif current < 1 then
			start = limitX(newNumItem-(linenum-1)*rownum-moda+1,1,newNumItem)
			current = newNumItem
		end
	elseif  keyPress==VK_SPACE or keyPress==VK_RETURN  then
		if newMenu[current][2]==nil and newMenu[current][3] == 1 then
			returnValue=newMenu[current][4];
			break;
		elseif newMenu[current][3] == 1 then
			local r=newMenu[current][2](newMenu,current);               --调用菜单函数
			if r==1 then
				returnValue= -newMenu[current][4];
				break;
			else
				Cls(x1,y1,x1+w,y1+h);
				if isBox==1 then
					DrawBox(x1,y1,x1+w,y1+h,C_WHITE);
				end
			end
		end
	elseif keyPress==888 and start>1 then
		start=start-rownum
	elseif keyPress==999 and start<newNumItem-(linenum-1)*rownum-moda+1 then
		start=start+rownum
	elseif keyPress>999999 then
		local kind, mx, my = nil, nil, nil
		if keyPress>1999999 then
			kind=1
			keyPress=keyPress-2000000
		else
			kind=0
			keyPress=keyPress-1000000
		end
		mx=math.modf(keyPress/1000)
		my=math.fmod(keyPress,1000)

		if mx>x1 and mx<x1+w and my>y1 and my<y1+h then
			if Title1 == nil and Title2 == nil then
				current = start-1+math.modf((mx-xx)/(w/rownum)+1) + rownum*math.modf((my-y1-10)/(size+CC.MenuBorderPixel*2+5))
			else
				current = start-1+math.modf((mx-xx)/(w/rownum)+1) + rownum*math.modf((my-y1-size-2*CC.MenuBorderPixel-15)/(size+CC.MenuBorderPixel*2+5))
			end
			current = limitX(current,1,newNumItem)
			if kind==1 then
				if newMenu[current][2]==nil and newMenu[current][3] == 1 then
					returnValue=newMenu[current][4];
					break;
				elseif newMenu[current][3] == 1 then
					local r=newMenu[current][2](newMenu,current);               --调用菜单函数
					if r==1 then
						returnValue= -newMenu[current][4];
						break;
					else
						Cls(x1,y1,x1+w,y1+h);
						if isBox==1 then
							DrawBox(x1,y1,x1+w,y1+h,C_WHITE);
						end
					end
				end
			end
		end
	end
    end
    lib.FreeSur(surid)
    return returnValue
end

--混蛋痛判定
function DT(id,p) --单通队友行动发生作用
	if bjfight(id, p) then
		return true
	end
	if JY.Status == GAME_WMAP and WAR.XRWDNX[id] ~= nil then --小人物的逆袭
		return false
	end
	if id == p or (JY.Person[id]["无用12"] == p and id > 0) or (GetS(4, 7, 7, 5) == 1 and inteam(p) and ZJ(id)) then --武骧金星：萧笑竹特殊判定
		return true
	end
	if JY.Person[id]["无用12"] == p and T10XXZ(id) then
		return true
	end
	if GetS(103, 0, 0, 1) == 1 then --弃用
		if GetS(103, 0, 0, 1) == p then
			return true
		end
	end	
	if ZJ(id) and GetS(103, 0, 0, 1) > 0 and GetS(103, 0, 0, 1) == p then --畅想
		return true
	end
	--[[if ownMP() and MPPD(id) == 63 and (JY.Wugong[122]["未知4"] == p or JY.Wugong[122]["未知5"] == p) then
		return true
	end]]
	--蛋痛福利
	if p == 82 and GetS(4, 7, 7, 5) == 1 and ZJ(id) and instruct_18(106) then --宋青书
		return true
	end
	if p == 49 and GetS(4, 7, 7, 5) == 1 and ZJ(id) and instruct_18(200) then  --虚竹
		return true
	end
	if p == 88 and GetS(4, 7, 7, 5) == 1 and ZJ(id) and instruct_18(221) then  --祖千秋
		return true
	end
	if p == 89 and GetS(4, 7, 7, 5) == 1 and ZJ(id) and instruct_18(220) then  --人厨子
	--单通有bug 暂时先屏蔽
		--return true
	end
	if p == 29 and GetS(4, 7, 7, 5) == 1 and ZJ(id) and GetS(86,10,12,5) ~= 0 then  --小田田
		return true
	end
	if WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 and GetS(86, 2, 9, 5) == 3 and (id == 5 or id == 27 or id == 50 or id == 64 or id == 114 or id == 129 or id == 140 or id == 558 or id == 599 or id == 601 or id == 602 or id == 615 or id == 618) 
	and (p == 5 or p == 27 or p == 50 or p == 64 or p == 114 or p == 129 or p == 140 or p == 558 or p == 599 or p == 601 or p == 602 or p == 615 or p == 618) and JY.Person[p]["生命"] > 0 then --天机盘龙
	return true
	end
	if WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 and GetS(86, 2, 11, 5) == 3 and (id == 5 or id == 50 or id == 64 or id == 129 or id == 558 or id == 599 or id == 601 ) 
	and (p == 5 or p == 50 or p == 64 or p == 129 or p == 558 or p == 599 or p == 601 ) and JY.Person[p]["生命"] > 0 then --宗师
	return true
	end
	if WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 and GetS(86, 2, 12, 5) == 3 and (id == 5 or id == 27 or id == 50 or id == 114) 
	and (p == 5 or p == 27 or p == 50 or p == 114) and JY.Person[p]["生命"] > 0 then --四神封绝
	return true
	end
	if WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 and GetS(86, 2, 14, 5) == 3 and (id == 602 or id == 615 or id == 618) 
	and (p == 602 or p == 615 or p == 618) and JY.Person[p]["生命"] > 0 then --天龙传说
	return true
	end
end--蠢蛋痛判定
function DT1(id,p) --单通队友在场上即发挥作用
	if bjfight(id, p) then
		return true
	end
	if id == 0 and p == 0 then
		if GetS(4, 7, 7, 5) ~= 1 then
			return false
		end
	end
	if JY.Person[id]["无用12"] == p or (GetS(4, 7, 7, 5) == 1 and inteam(p) and ZJ(id)) then --单通
		return true
	end
	if GetS(103, 0, 0, 0) == 1 then
		if GetS(103, 0, 0, 1) == p then --弃用
			return true
		end
	end
	
	if ZJ(id) and GetS(103, 0, 0, 1) > 0 and GetS(103, 0, 0, 1) == p then --畅想
		return true
	end
	
	return false
end
function DT3(id, p) --单通指令用
	if id == p then
		return true
	end
	if ZJ(id) and GetS(103, 0, 0, 1) > 0 and GetS(103, 0, 0, 1) == p then --畅想
		return true
	end	
	if ownMP() and MPPD(id) == 63 and (JY.Wugong[122]["未知4"] == p or JY.Wugong[122]["未知5"] == p) then
		return true
	end	
	return false
end
function CXTRT(id, p) --畅想指令用
	if id == p then
		return true
	end
	if p == 92 then
		if id >= 655 and id <= 657 then
			return true
		end
	end
	if ZJ(id) and GetS(103, 0, 0, 1) > 0 and GetS(103, 0, 0, 1) == p then --畅想
		return true
	end	
	return false
end

--猪脚判断
function ZJ(id)
	if JY.Base["队伍1"] == id then
		return true
	end
	return false
end
function randomPD(tt)
	local max = 0
	for i = 1, #tt do
		max = max + tt[i]
	end
	local event = math.random(max)
	local count = 0
	local result = 1
	for i = 1, #tt do
		if event > count and event <= tt[i] + count then
			result = i
			break
		end
		count = tt[i] + count
	end
	return result
end

function randomthing()
	return (math.random(0, 35))
end

function randomwugong()
	local highlv = 0
	local thing = -1
	if math.random(20) == 1 then
		highlv = 1
	end
	while true do
		thing = math.random(64, 290)
		if JY.Thing[thing]["练出武功"] > 0 then
			if (JY.Wugong[JY.Thing[thing]["练出武功"]]["攻击力10"] < 800 and 
				JY.Wugong[JY.Thing[thing]["练出武功"]]["攻击力10"] > 0) or highlv == 1 then
				break
			end
		end
	end
	return thing
end

function randomwugong2(aa, bb, flag)
	aa = math.max(math.modf(aa * 100),200) - 50
	bb = math.max(math.modf(bb * 100),200) + 50
	local thing = -1
	local lv = -1
	while true do
		thing = math.random(64, JY.ThingNum - 1)
		if JY.Thing[thing]["练出武功"] > 0 then
			lv = JY.Wugong[JY.Thing[thing]["练出武功"]]["攻击力10"]
			if lv == 0 and flag == nil then
				lv = 1000
			end			
			if aa <= lv and lv <= bb then
				break
			end
		end
	end
	return thing
end

function changeattrib(id, str, flag) -- flag 0 - random, 1 - +, 2 - -
	local change = 0
	local word = "增加"
	if math.random(50) <= 5 or flag == 2 then
		change = 1
		word = "减少"
	end
	if flag == 1 then
		change = 0
		word = "增加"
	end
	local number = math.random(0, 10)
	if str == "攻击力" or str == "轻功" or str == "防御力" then
		number = number + 5
	end
	if change == 1 then
		number = math.modf(number * -1)
	end	
	AddPersonAttrib(id, str, number)
	return JY.Person[id]["姓名"].."的"..str..word..math.abs(number).."点"
end

function conversion (pp)
	if pp == 1 then
		pp = "攻击力"
	elseif pp == 2 then
		pp = "轻功"
	elseif pp == 3 then
		pp = "防御力"
	elseif pp == 4 then
		pp = "拳掌功夫"
	elseif pp == 5 then
		pp = "御剑能力"
	elseif pp == 6 then
		pp = "耍刀技巧"
	else
		pp = "特殊兵器"
	end
	return pp
end

function Menu_MP() --门派菜单日月神教
	local menu = {}
	for i = 1, #CC.MPMENU do
		menu[i] = {CC.MPMENU[i], nil, 1}
	end
	local r = ShowMenu(menu, #menu, 0, CC.MainSubMenuX, CC.MainSubMenuY, 0, 0, 1, 1, CC.DefaultFont, C_ORANGE, C_WHITE)
	if r == 1 then
		local menu2 = {}
		for i = 1, #CC.MP do
			menu2[i] = CC.MP[i]
		end
		
		DrawStrBox(CC.MainSubMenuX, CC.MainSubMenuY, "要查看哪个门派", C_WHITE, CC.DefaultFont)
		local r2 = ShowMenu(menu2,#menu2,15,85,55,0,0,1,1,CC.DefaultFont,C_ORANGE, C_WHITE);
		--local r2 = ShowMenu(menu2,#menu2,0,CC.MainSubMenuX,CC.MainSubMenuY+CC.SingleLineHeight,0,0,1,1,CC.DefaultFont,C_ORANGE,C_WHITE);
		if r2 <= 0 then
			do return end
		end
		Cls()
		say(CC.MPINFO[r2],585) 		
		Cls()
		say(CC.MPINFO2[r2],585) 			
		for i = 1, #CC.SKILLINFO[r2] do		
			Cls()
			local r3 = JYMsgBox(CC.SKILLNAME[r2][i], CC.SKILLINFO[r2][i], {"继续", "停止"}, 2, 220)
			if r3 == 2 then
				break
			end
		end
	elseif r == 2 then
		OEVENTLUA[30001]()
	elseif r == 3 then
		OEVENTLUA[30000]()
	else
		return 0
	end	
end

function DHdisplay(aa, bb, str,strColor)
	if strColor == nil then
		strColor = C_GOLD
	end	
	for i = aa, bb do
		CurIDTXDH(WAR.CurID, i, i, str,strColor);		
		lib.Delay(10)
	end		
end

function selectPerson(num, flag)--1敌2我3both
	War_CalMoveStep(WAR.CurID, num, 1) 
	local nx, ny = nil, nil
	local victim = -1
	local victimid = -1
	while true do
		nx, ny = War_SelectMove()
		if nx == nil then
			return -1, -1, -1, -1
		end
		if nx ~= nil then
			if lib.GetWarMap(nx, ny, 2) < 0 and lib.GetWarMap(nx, ny, 5) < 0 then
				QZXS("此处无人，请重新选择")			
			elseif GetWarMap(nx, ny, 2) == nil or GetWarMap(nx, ny, 2) < 0 then
				QZXS("此处无人，请重新选择")	
			else
				victim = GetWarMap(nx, ny, 2)
				victimid = WAR.Person[victim]["人物编号"]
				if flag == 1 and WAR.Person[WAR.CurID]["我方"] == WAR.Person[victim]["我方"] then
					QZXS("不能选择我方人物")	
				elseif flag == 2 and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[victim]["我方"] then
					QZXS("不能选择敌方人物")	
				else
					break;
				end
			end
		end
	end
	return nx, ny, victim, victimid
end
			
function DIYdisplay(str,strColor)
	if strColor == nil then
		strColor = C_GOLD
	end	
	for i=12,24 do
		NewDrawString(-1,-1,str,strColor,25+i)
		ShowScreen();
		if i==24 then
			Cls();							
			NewDrawString(-1,-1,str,strColor,25+i)
			ShowScreen();
			lib.Delay(500);
		else
			lib.Delay(1);
		end						
	end
end

function duiyou(pp)
	if pp == 0 or pp == 606 then --武骧金星：微调
		return true
	end
	--if pp >= 608 and pp <= 613 then
	--	return true
	--end
	local checkteam = 0
	for i,v in pairs(CC.PersonExit) do
		if pp == v[1] then
			checkteam = 1
			break
		end
	end
	for i = 1, #TeamP do
		if pp == TeamP[i] then
			checkteam = 1
			break		
		end
	end
	if checkteam == 0 then
		return false
	else
		return true
	end
end

function xiaobin(pp)
	if pp == 419 or pp == 440 or pp == 430 or pp == 456 or pp == 457 or pp == 578 or pp == 580 or pp == 583 or pp == 584 or pp == 607 or pp == 455 or pp == 597 or pp == 929 or pp == 598 or pp == 599 or pp == 600 or pp == 601 or pp == 602 or pp == 603 or pp == 617 or pp == 604 or pp == 605 or pp == 665 or pp == 666 or pp == 667 or pp == 930 or pp == 931 or pp == 932 then --武骧金星：添加无酒不欢
		return false
	elseif pp >= 607 and pp <= 613 then
		return false
	elseif (pp >= 191 and pp <= 450) or (pp >= 456 and pp <= 457) or pp == 460 then
		return true
	end
	if pp >= 669 and pp <= JY.PersonNum - 1 then --925 武骧金星：实际上有928个人
		return true
	end
	if pp >= 461 and pp <= 496 then
		return true
	end
	if pp == 579 then
		return true
	end
	if pp >= 598 and pp <= 605 then
		return true
	end
	return false
end

function animal(enemy)
	if enemy == 190 or (enemy >= 311 and enemy <= 319) or (enemy >= 410 and enemy <= 440) 
		or (enemy >= 607 and enemy <= 613) then
		return true
	end
	if (enemy >= 868 and enemy <= 895) or (enemy >= 769 and enemy <= 777) then
		return true
	end
	return false
end

function wgnumber(tmppid, wgtype, flag)
	local wg = 0
	local ji = true
	if flag == nil then
		ji = false
	end
	if wgtype == 0 then
		for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
			if ji or JY.Person[tmppid]["武功等级" .. i] >= 999 then
				wg = wg + 1
			end
		end
	elseif wgtype == 1 then 
		for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
		  if yongquan(JY.Person[tmppid]["武功" .. i]) and (ji or JY.Person[tmppid]["武功等级" .. i] >= 999) then
			wg = wg + 1
		  end
		end
	elseif wgtype == 2 then
		for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
		  if yongjian(JY.Person[tmppid]["武功" .. i]) and (ji or JY.Person[tmppid]["武功等级" .. i] >= 999) then
			wg = wg + 1
		  end
		end
	elseif wgtype == 3 then
		for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
		  if yongdao(JY.Person[tmppid]["武功" .. i]) and (ji or JY.Person[tmppid]["武功等级" .. i] >= 999) then
			wg = wg + 1
		  end
		end
	elseif wgtype == 4 then
		for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
		  if yongte(JY.Person[tmppid]["武功" .. i]) and (ji or JY.Person[tmppid]["武功等级" .. i] >= 999) then
			wg = wg + 1
		  end
		end
	elseif wgtype == 5 then
		for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
			if (yongnei(JY.Person[tmppid]["武功" .. i]) or JY.Person[tmppid]["武功" .. i] == 49) and 
				(ji or JY.Person[tmppid]["武功等级" .. i] >= 900) then
				wg = wg + 1
			end
		end	
	elseif wgtype == 6 then
		for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
			if yongan(JY.Person[tmppid]["武功" .. i]) and (ji or JY.Person[tmppid]["武功等级" .. i] >= 999) then
				wg = wg + 1
			end
		end			
	end
	return wg
end

function wglw(pid, f) --内功领悟
    if f == 0 then 
	    return false
    end
    if WAR.PJTX == 1 and not DT(pid,592) then --破尽天下
        return false
    else
		if pid == 0 or (inteam(pid) and T10XXZ(0) and JY.Person[pid]["挑战"] + 1 >= JY.Thing[202][WZ7]) or (ownMP() and MPPD(pid) == 63 ) then
			if (PersonKF(pid,f) or f == 999 or f == 592 or (PersonKF(pid,9999) and (JY.Thing[224]["加攻击力"] == f or JY.Thing[224]["加防御力"] ==f))) and GetS(111,0,0,0) == f then 
				return true
			end
			if MPPD(pid) == 4 and MPDJ(pid) >= 4 and PersonGT(pid,99) and f == 99 then 
				return true
			end
		end
		--[[
		if ZJ(pid) and GetS(111,0,0,0) == f and JY.Person[pid]["武功"..i] == f then
			return true
		elseif ZJ(pid) and GetS(111,0,0,0) == f and f == 592 then
			return true
		elseif ZJ(pid) and GetS(111,0,0,0) == f and f == 999 then
			return true
		elseif ZJ(pid) and GetS(111,0,0,0) == f and JY.Person[pid]["武功"..i]==9999 and (JY.Thing[224]["加攻击力"] == f or JY.Thing[224]["加防御力"] ==f) then 
		   return true
		end
		if DT(pid,116) and JY.Person[pid]["武功"..i] == f then 
		   return true
		end
		]]
		if DT(pid,116) and PersonKF(pid,f) and (f ~= 592 and f ~= 203) then 
		   return true
		end 	
		
        if DT(pid,583) and PersonGT(pid,f) and (f ~= 592 and f ~= 203) then 
		   return true
		end 		
		
		if (ZJ(pid) and MPPD(pid) == 7 and MPDJ(pid) == 5 and GetS(111,0,0,0) == 998) and PersonKF(pid,98) then
			if PersonGT(pid,f) or (PersonKF(pid,101) and f == 101) or (PersonKF(pid,85) and f == 85) then 
				return true
			end
			if PersonGT(pid, 9999) and (JY.Thing[224]["加攻击力"] == f or JY.Thing[224]["加防御力"] ==f) then 
				return true
			end
		end	
		
		if ZJ(pid) and pid == 0 and putong() == 5 and juexing() > 0 then
			if PersonGT(pid,f) and GetS(112,2,0,0) == f then
				return true
			end
		end		
		
		if (ZJ(pid) and GetS(111,0,0,0) == 997) and PersonKF(pid,108) and PersonKF(pid,22) and PersonKF(pid,136) and PersonKF(pid,57) then
			if (PersonGT(pid,96) and f == 96 ) or (PersonGT(pid,108) and f == 108 ) or (PersonGT(pid,151) and f == 151 ) or (PersonGT(pid,183) and f == 183 )then 
				return true
			end
		end
		if T11CJR(pid) and PersonKF(pid,103) and f == 103 and juexing() >= 2 then
			return true
		end	
			
		if DT(pid,618) and (f ~= 592 and f ~= 203) then
			return true
		end
		if DT(pid,604) and PersonKF(pid,f) and f == 121 and juexing() > 0 then
			return true
		end	
		if DT(pid,667) and PersonKF(pid,f) and (f == 6 or f == 102) then
			return true
		end		
	end	
	    return false
end

function wglw1(pid, f) --外功领悟
    if f == 0 then 
        return false
    end
    --if DT(pid,618) and GetS(113,0,0,0) ~= f then 
	--    return false
    --end 
	if DT(pid,614) then --阿青全剑法领悟
		if f <= JY.WugongNum - 1 and yongjian(f) then
			return true
		end
	end  	
    if (pid == 0 or (inteam(pid) and T10XXZ(0) and JY.Person[pid]["挑战"] + 1 >= JY.Thing[202][WZ7]) or (ownMP() and MPPD(pid) == 63)) and GetS(113,0,0,0) == f and PersonKF(pid,f) then 
        return true
    end
    if T12YMZ(pid) and juexing() >= 3 then 
	    if JY.Person[pid]["无用12"] == f or f == 112 then return true end 
    end
	if (ZJ(pid) and GetS(113,0,0,0) == 997) and PersonKF(pid,108) and PersonKF(pid,22) and PersonKF(pid,136) and PersonKF(pid,57) then
	    if (PersonKF(pid,22) and f == 22) or (PersonKF(pid,136) and f == 136) or (PersonKF(pid,57) and f == 57) then 
			return true
		end
	end
	if pid == 0 and GetS(113,0,0,0) == 40 and PersonKF(pid,40) and PersonKF(pid,173) then
		if (PersonKF(pid,40) and f == 40) or (PersonKF(pid,173) and f == 173) then
			return true
		end
	end
	if pid == 0 and GetS(113,0,0,0) == 60 then
		if (PersonKF(pid,60) and f == 60) or (PersonKF(pid,37) and f == 37) then
			return true
		end
	end	
	if pid > 0 and JY.Person[pid]["无用16"] == f then
		return true
	end	
	if DT(pid,604) and PersonKF(pid,f) and f == 11 then
		return true
	end
	if DT(pid,667) and PersonKF(pid,f) and f == 18 then
		return true
	end
	if DT(pid, 92) and JX(pid) and MRL(pid) and PersonKF(pid,f) and f == 67 then --苗若兰觉醒后自带胡刀领悟
		return true
	end
    return false
end

function setLW1(a) --外功领悟
   SetS(113,0,0,0,a)
end 

function wglw2(pid, f) --轻功领悟
    if f == 0 then 
        return false
    end
    if (pid == 0 or (inteam(pid) and T10XXZ(0) and JY.Person[pid]["挑战"] + 1 >= JY.Thing[202][WZ7]) or (ownMP() and MPPD(pid) == 63)) and GetS(114,0,0,0) == f and PersonKF(pid,f) then 
        return true
    end
	--if DT(pid,618) and GetS(114,0,0,0) ~= f  then 
	--    return false
    --end
	if ZJ(pid) and pid == 0 and putong() == 10 and juexing() > 0 then
		if PersonKF(pid,f) and GetS(112,3,0,0) == f then
			return true
		end
	end	
	if DT(pid,604) and PersonKF(pid,f) and f == 119 and juexing() > 0 then
		return true
	end
	if DT(pid,667) then 
		if f <= JY.WugongNum - 1 and yongqing(f) then
			return true
		end
	end 
        return false
end

function setLW2(a) --轻功领悟
   SetS(114,0,0,0,a)
end

function yongquan(pp)
	if JY.Wugong[pp]["类型"] == 1 then
		return true
	else
		return false
	end
end

function yongjian(pp)
	if GetS(113,0,0,0) == 77 and pp == 77 then
		return true
	elseif JY.Wugong[pp]["类型"] == 2 then
		return true
	else
		return false
	end
end

function yongdao(pp)
	if GetS(113,0,0,0) == 77 and pp == 77 then
		return true
	elseif JY.Wugong[pp]["类型"] == 3 then
		return true
	else
		return false
	end
end

function yongte(pp)
	if JY.Wugong[pp]["类型"] == 4 then
		return true
	else
		return false
	end
end

function yongan(pp)
	if JY.Wugong[pp]["类型"] == 6 then
		return true
	else
		return false
	end
end

function yongnei(pp, flag)
	if flag == nil then
		flag = true
	else
		flag = false
	end
	
	if pp == nil then
		return false
	end 

	if pp == 43 or pp == 85 or pp == 87 or pp == 88 then
		if flag then
			return true
		else
			return false
		end
	else
		if JY.Wugong[pp] == nil or JY.Wugong[pp]["类型"] == nil then
			return false
		end
		if JY.Wugong[pp]["类型"] == 0 then
			return true
		else
			return false
		end
	end
end

function yongqing(pp)
	if pp >= 115 and pp <= 119 then
		return true
	end
	if pp == 143 then
		return true
	end
	if pp == 179 then
		return true
	end
	if pp >= 190 and pp <= 200 then
		return true
	end	
	return false
end

function juexing()
	local jx = 0
	return JY.Person[zj()]["觉醒"]
	--[[if GetS(99, 0, 0, 2) == 1 then
		jx = 3
	elseif GetS(99, 0, 0, 1) == 1 then
		jx = 2
	elseif GetS(10, 0, 7, 0) == 1 then
		jx = 1
	end]]
end

function ZYBF(pid) --沼跃鱼：战意系统判定
	if WAR.SPIRIT[pid]>=120 and WAR.SPIRIT[pid] ~= nil and JX(pid) then
		return true
	end	
	return false
end

function ZYJ(pid)--沼跃鱼：战意技判定
	if ZYBF(pid) and WAR.LQZ[pid] ~= nil and WAR.LQZ[pid] >= 100 then
		return true
	end	
	return false
end

function BZN(pid)
    local aa=0
	for j = 0, WAR.PersonNum - 1 do 
		if wglw1(WAR.Person[j]["人物编号"], 57) and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~=  WAR.Person[pid]["我方"] then
		  	aa=1
			break
		end
	end
	if aa==1 then
	    return true
	end
	    return false
end

function MP11(pid)--17-3-1
	if MPPD(pid) == 11 and PersonKF(pid,115) and PersonGT(pid,180) then
		return true
	end	
	return false
end

function KHTJF(pid)
	if wglw(pid,105) and wglw1(pid,48) and PersonKF(pid,48) and PersonKF(177) and PersonGT(pid,105) then
		return true
	end
	if DT(pid,36) and PersonKF(pid,48) and JX(pid) and PersonGT(pid,105) then
		return true
	end
	if DT(pid,27) and PersonKF(pid,177) and PersonKF(pid,48) and PersonGT(pid,105) and wglw1(pid,48) then
		return true
	end	
	return false
end	
function KHTZF(pid)
	if wglw(pid,105) and wglw1(pid,177) and PersonKF(pid,48) and PersonKF(pid,177) and PersonGT(pid,105) then
		return true
	end
	if DT(pid,27) and PersonKF(pid,177)  and PersonGT(pid,105) then --and JX(pid)
		return true
	end	
	return false
end	
function KHT(pid)
	if wglw(pid,105) and (wglw1(pid,177) or wglw1(pid,48)) and PersonKF(pid,48) and PersonKF(pid,177) and PersonGT(pid,105) then
		return true
	end
	if DT(pid,27) and PersonKF(pid,177) and PersonKF(pid,48) and PersonGT(pid,105) then
		return true
	end	
	if DT(pid,36) and PersonKF(pid,177) and PersonKF(pid,48) and JX(pid) and PersonGT(pid,105) then
		return true
	end
	return false
end	

function tianshu()
	if instruct_18(205) then
		return 14
	end
	local ts = 0
	for i = 1, CC.MyThingNum do
		if JY.Base["物品" .. i] > 143 and JY.Base["物品" .. i] < 158 then
		  ts = ts + 1
		end
	end
	return ts
end

function DIYPD(pp, jl)
	local x = JY.Person[pp]["资质"]
	local a = jl / 200 
	local b = jl / 200 * ((110 - x) / 120)
	local c = 1 - ((1 - a ) * (1 - b))
	return math.modf(c * 100)
end

function PersonGTJL(p, kf, jl) --判断加力内功是否为主功体
	if JY.Person[p]["声望"] == kf and kf == jl then
		return true
	end
	if DT(p, 618) then --武骧金星：逍遥子特殊判定
		for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
			if JY.Person[p]["武功" .. i] == kf then
				return true
			end
		end	
	end	
    --北冥吸功体
	if p == 0 and (JY.Person[p]["声望"] == kf or WAR.BMGT == kf) then 
	   return true
	end
	if JY.Person[p]["声望"] == 9999 and (JY.Thing[224]["加攻击力"] == kf or JY.Thing[224]["加防御力"] == kf) then 
	   return true
	end
	return false
end

function PersonGTHT(p, kf, ht) --判断护体内功是否为主功体
	if JY.Person[p]["声望"] == kf and kf == ht then
		return  true
	end
	if DT(p, 618) then --武骧金星：逍遥子特殊判定
		for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
			if JY.Person[p]["武功" .. i] == kf then
			return true
			end
		end	
	end
	--北冥吸功体
	if p == 0 and (JY.Person[p]["声望"] == kf or WAR.BMGT == kf) then 
	   return true
	end
	if JY.Person[p]["声望"] == 9999 and (JY.Thing[224]["加攻击力"] == kf or JY.Thing[224]["加防御力"] ==kf) then 
	   return true
	end
	return false
end

function PersonGT(p, kf) --判断主功体
    if WAR.PJTX == 1 and not DT(p,592) then --破尽天下
	   return false
	end
	if WAR.TLHD == 1 and not DT(p,583) then
		return false
	end
	if JY.Person[p]["声望"] == kf then--北冥吸功体
	    if WAR.BMGT2 ~= p then
		   return true
		elseif WAR.SGDF == kf and WAR.SGDF2 == p then    
		   return false
		end
	end 	
	if twogt(p) and JY.Person[p]["外号"] == tostring(kf) then
		return true
	end
	if twogt(p) and JY.Person[p]["外号"] == kf then
		return true
	end
	--[[if pid == 0 and putong() == 5 and juexing() > 0 and (JY.Person[p]["武功"] >= 106 and JY.Person[p]["武功"]<=108) and (kf>=106 and kf<=108) then
		return true
	end]]
	
	if DT(p,667) and (kf == 102 or kf == 93) then
		return true
	end	
	
	if DT(p,38) and JX(p) and (kf == 102 or kf == 96) then
		return true
	end	
	
	
	if DT(p, 618) then --武骧金星：逍遥子特殊判定
		for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
			if JY.Person[p]["武功" .. i] == kf then
			return true
			end
		end	
	end--北冥吸功体
	if p == 0 and (JY.Person[p]["声望"] == kf or WAR.BMGT == kf) then 
	   return true
	end
	if (JY.Person[p]["声望"] == 9999 or JY.Person[p]["外号"] == 9999 ) and (JY.Thing[224]["加攻击力"] == kf or JY.Thing[224]["加防御力"] ==kf) then 
	   return true
	end
	return false
end
--天赋内功12.26   ((v[1] == pid) or (v[1] == cxzj() and pid == 0))
function PersonTFGT(p, kf)
    if WAR.PJTX == 1 and not DT(p,592) then --破尽天下
	   return false
	end
	if WAR.TLHD == 1 and not DT(p,583) then
		return false
	end
	if PersonGT(p, kf) then
		for k, v in ipairs(CC.TFNG) do --豸苗：更多显示
			if ((v[1] == p) or (v[1] == cxzj() and p == 0)) and v[2] == kf then					
				return true
			end
		end
		for k, v in ipairs(CC.TFNG1) do --豸苗：更多显示
			if ((v[1] == p) or (v[1] == cxzj() and p == 0)) and v[2] == kf then					
				return true
			end
		end
		if DT(p, 92) and kf == JY.Person[578]["防御力"] then 
			return true
		end
		if p == 0 and (putong() > 0 or teshu() > 0) and GetS(112,2,0,0) == kf then
			return true
		end
		if kf == 9999 and p == 0 then 
		   return true
		end
	end
	if yongnei(kf) then   
		if DT(p, 618) then --武骧金星：逍遥子特殊判定
		    for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
			    if JY.Person[p]["武功" .. i] == kf then
			    return true
			    end
		    end	
	    end
		if DT(p, 597) then --谢无悠
		    for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
			    if JY.Person[p]["武功" .. i] == kf then
			    return true
			    end
		    end	
	    end
		if p == 0 and putong() == 5 then --天罡
		    for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
			    if JY.Person[p]["武功" .. i] == kf then
			    return true
			    end
		    end	
	    end
	end	
    return false
end

function douzhuankekong(person)
	local p = JY.Person[person]
    local dzlv = JY.Person[person]["拳掌功夫"] + JY.Person[person]["御剑能力"] + 
		JY.Person[person]["耍刀技巧"] + JY.Person[person]["特殊兵器"] + JY.Person[person]["暗器技巧"]
	if inteam(person) and (dzlv >= 390 or DT(person, 113) or DT(person, 51)) then --做y-斗D抵翟O定
		return true
	else
		return false
	end
end

function DrawBox3(x1, y1, x2, y2, color)
  lib.DrawRect(x1, y1, x2, y1, color)
  lib.DrawRect(x1, y2, x2, y2, color)
  lib.DrawRect(x1, y1, x1, y2, color)
  lib.DrawRect(x2, y1, x2, y2, color)
end

--显示BUFF
function My_Show_Buff()
	
  local x0 = WAR.Person[WAR.CurID]["坐标X"];
	local y0 = WAR.Person[WAR.CurID]["坐标Y"];
	
	for k = 0, WAR.PersonNum - 1 do
		local tmppid = WAR.Person[k]["人物编号"]
		if WAR.Person[k]["死亡"] == false then
			local dx = WAR.Person[k]["坐标X"] - x0
	    local dy = WAR.Person[k]["坐标Y"] - y0
	    local rx = CC.XScale * (dx - dy) + CC.ScreenW / 2
	    local ry = CC.YScale * (dx + dy) + CC.ScreenH / 2
	    
	    local hb = GetS(JY.SubScene, dx + x0, dy + y0, 4)
	    if CONFIG.Zoom == 1 then
	      hb = hb * 2
	    end
	    ry = ry - hb - CC.YScale*7;
	    
		if WAR.Person[k]["人物编号"] == 92 then
			local anubiaoqian = 0
			for i = 0, WAR.PersonNum - 1 do
				if WAR.AN[WAR.Person[i]["人物编号"]] ~= nil then
					anubiaoqian = 1
					break
				end
			end		
			if anubiaoqian == 1 then
				--lib.PicLoadCache(0,4368*2,rx, ry, 2, 256);
			end
		end
		
	    --胡青牛 持续加血显示BUFF图标
		if WAR.L_HQNZL[WAR.Person[k]["人物编号"]] ~= nil and WAR.L_HQNZL[WAR.Person[k]["人物编号"]] > 1 then
	      --lib.PicLoadCache(0,4368*2,rx, ry, 2, 256);
	    end
	    --王难姑 持续中毒显示BUFF图标
	    if WAR.L_WNGZL[WAR.Person[k]["人物编号"]] ~= nil and WAR.L_WNGZL[WAR.Person[k]["人物编号"]] > 0 then
	      --lib.PicLoadCache(0,4369*2,rx, ry, 2, 256);
	    end
	    
		if WAR.AN[WAR.Person[k]["人物编号"]] ~= nil then
			--lib.PicLoadCache(0,4369*2,rx, ry, 2, 256)
		end
		
		if WAR.AN2[WAR.Person[k]["人物编号"]] ~= nil then
			--lib.PicLoadCache(0,4369*2,rx, ry, 2, 256)
		end
		
		--HP&名字显示
		--[[  local pid = WAR.Person[k]["人物编号"]
		  local name=JY.Person[pid]["姓名"]
          local SM=JY.Person[pid]["生命"]
		  local SMZ=JY.Person[pid]["生命最大值"]
		  local YS=C_WHITE
		  if SM<math.modf(SMZ/2) then
		  YS=C_GOLD
		  end
		  if SM<math.modf(SMZ/5) then
		  YS=C_RED
		  end
		  MyDrawString(rx, rx + 100, ry + 85, name, YS, 16) --名字
          MyDrawString(rx, rx + 100, ry + 100, "HP:"..SM, YS, 16)--HP	]]	
			--[[	  local pid = WAR.Person[k]["人物编号"]
		  local name=JY.Person[pid]["姓名"]
          local SM=JY.Person[pid]["生命"]
		  local SMZ=JY.Person[pid]["生命最大值"]
          local NL=JY.Person[pid]["内力"]
		  local NLZ=JY.Person[pid]["内力最大值"]
		  local YS = C_RED
		  local YS1 = M_RoyalBlue
		  DrawBox3(rx-20,ry-7,rx+20,ry-3,YS)
		  lib.Background(rx-19,ry-6,rx-19+math.modf(39*SM/SMZ),ry-3, 0, YS)
		  DrawBox3(rx-20,ry-2,rx+20,ry+2,YS1)
		  lib.Background(rx-19,ry-1,rx-19+math.modf(39*NL/NLZ),ry+2, 0, YS1)]]
		
		if WAR.SXXYS[tmppid] ~= nil then
			if WAR.SXXYS[tmppid] == 3 then
				lib.PicLoadCache(0,4373*2,rx, ry, 2, 256)
			elseif WAR.SXXYS[tmppid] == 2 then
				lib.PicLoadCache(0,4372*2,rx, ry, 2, 256)
			else
				lib.PicLoadCache(0,4371*2,rx, ry, 2, 256)
			end
		end	
	  end
  end
end

--基础机率
function baseRandom(p)
	local jl = 0;
	
	if JY.Status == GAME_WMAP then
		--王语嫣+10点
		for i = 0, WAR.PersonNum - 1 do
			local pid = WAR.Person[i]["人物编号"]
			if WAR.Person[i]["死亡"] == false and DT(pid,76) and inteam(p) == inteam(pid) then
			  jl = jl + 10	
			end
		end
		--if DT1(p,76) then
		--	jl = jl + 10
		--end
		if GetS(22, 0, 0, 0) == 5 and putong() == 6 then --仁者追加特效10
			if inteam(p) then jl = jl + 10 end
			--[[
			for i = 0, WAR.PersonNum - 1 do
				local pid = WAR.Person[i]["人物编号"]
				if WAR.Person[i]["死亡"] == false and WAR.Person[i]["我方"] then --and pid == 0 then
				  jl = jl + 10	
				end
			end
			]]
		end
		if WAR.SPIRIT[p] >= 100 then --战意的几率加成
			jl = jl + limitX(math.modf((WAR.SPIRIT[p] - 100) * 0.5), 0, 20)
			if wglw2(p,198) then jl = jl + 10 end
			if T9ZY(p) and juexing() > 0 then jl = jl + limitX(math.modf((WAR.SPIRIT[p] - 100) * 0.5), 0, 20) end
		end
		if WAR.XYLS[p] == nil then
		jl = jl 
		else
		jl = jl - 10
		end
	end
	--内力值最多+20点
	jl = jl + limitX(JY.Person[p]["内力"] / 500, 0, 20);
	
	local aaa = JY.Person[p]["生命最大值"] or 1
	local bbb = JY.Person[p]["生命"] or 1

	--生命值最多+20点
	jl = jl + limitX(1 + (aaa * 2) / (bbb + (aaa / 10)), 0, 20)	
	--体力最多+5点
	jl = jl + JY.Person[p]["体力"] / 20

	--nino 资质加成，越高越好 
	jl = jl + JY.Person[p]["资质"] / 10
	
	--武常加成
	--jl = jl + JY.Person[p]["武学常识"] / 10

	--实战加成
	--满实战+25点
	local jp = JY.Person[p]["实战"] / 20
	jl = jl + jp  
    
	if addjl(p) > 0 then
		jl = jl + addjl(p)
	end
  
	if PersonGT(p, 102) then
		jl = jl + 20
	elseif PersonKF(p, 102) then --太玄神功+10点
		jl = jl + 10
	end  
	
	if p == 0 and putong() == 6 then
		jl = jl + 10
	end
	
	if not inteam(p) then		--敌人额外的机率
		jl = jl + 10;
	end
	
	--羞月洛神
	
	
	if JY.Person[p]["武学常识"] > 10 then jl = jl + math.modf(JY.Person[p]["武学常识"] / 10) end
	
	return math.modf(jl)
end

--根据人物的攻击力计算机率
--jl 初始机率
--p 人物编号
function atkRandom(jl, p)
	local atk = JY.Person[p]["攻击力"];
	--队友攻击力加成
    for i,v in pairs(CC.AddAtk) do
        if v[1] == p then
            for wid = 0, WAR.PersonNum - 1 do
                if WAR.Person[wid]["人物编号"] == v[2] and WAR.Person[wid]["死亡"] == false then
                    atk = atk + v[3]
		            if hasTF(p, 129) then
			            atk = atk + v[3]
		            end
                end
            end
        end
	    if DT1(p,v[1]) and DT1(p,v[2]) then
		    atk = atk + v[3]		
	    end
    end
	
	atk = atk + MPAttrib(p, 1)
	
	--装备攻击加成
	if JY.Person[p]["武器"] >= 0 then
  	    atk = atk + JY.Thing[JY.Person[p]["武器"]]["加攻击力"];
    end
    if JY.Person[p]["防具"] >= 0 then
        atk = atk + JY.Thing[JY.Person[p]["防具"]]["加攻击力"];
    end
	if JY.Person[p]["无用15"] >= 0 then
        atk = atk + JY.Thing[JY.Person[p]["无用15"]]["加攻击力"];
    end
    --攻击力加成机率
    jl = jl + limitX(math.modf(atk / 15), 10, 50);
  
    --计算额外的基础机率
    jl = jl + baseRandom(p);
    
    return DIYPD(p, jl);
end

--根据人物的防御力计算机率
--jl 初始机率
--p 人物编号
function defRandom(jl, p)
	local def = JY.Person[p]["防御力"];
	--队友防御力加成
    for i,v in pairs(CC.AddDef) do
        if v[1] == p then
            for wid = 0, WAR.PersonNum - 1 do
                if WAR.Person[wid]["人物编号"] == v[2] and WAR.Person[wid]["死亡"] == false then
                    def = def + v[3]
		            if hasTF(p, 129) then
			            def = def + v[3]
		            end			  
                end
            end
        end
	    if DT1(p,v[1]) and DT1(p,v[2]) then
		    def = def + v[3]
	    end
    end
	
	def = def + MPAttrib(p, 2)
	
	--装备防御加成
	if JY.Person[p]["武器"] >= 0 then
  	    def = def + JY.Thing[JY.Person[p]["武器"]]["加防御力"];
    end
    if JY.Person[p]["防具"] >= 0 then
        def = def + JY.Thing[JY.Person[p]["防具"]]["加防御力"];
    end
	if JY.Person[p]["无用15"] >= 0 then
        def = def + JY.Thing[JY.Person[p]["无用15"]]["加防御力"];
    end
    --防御力加成机率
    jl = jl + limitX(math.modf(def / 15), 10, 50);
  
    --计算额外的基础机率
    jl = jl + baseRandom(p);
  
    --return jl >= math.random(150);
	return DIYPD(p, jl);
end
	
--根据人物的轻功计算机率
--jl 初始机率
--p 人物编号
function spdRandom(jl, p)
	local spd = JY.Person[p]["轻功"];
	--队友轻功加成
    for i,v in pairs(CC.AddSpd) do
        if v[1] == p then
            for wid = 0, WAR.PersonNum - 1 do
                if WAR.Person[wid]["人物编号"] == v[2] and WAR.Person[wid]["死亡"] == false then
                    spd = spd + v[3]
		            if hasTF(p, 129) then
			            spd = spd + v[3]
		            end			  
                end
            end
        end
	    if DT1(p,v[1]) and DT1(p,v[2]) then
		    spd = spd + v[3]
	    end
    end
  
    spd = spd + MPAttrib(p, 3)
	
	--装备轻功加成
	if JY.Person[p]["武器"] >= 0 then
  	    spd = spd + JY.Thing[JY.Person[p]["武器"]]["加轻功"];
    end
    if JY.Person[p]["防具"] >= 0 then
        spd = spd + JY.Thing[JY.Person[p]["防具"]]["加轻功"];
    end
	if JY.Person[p]["无用15"] >= 0 then
        spd = spd + JY.Thing[JY.Person[p]["无用15"]]["加轻功"];
    end
	
    --轻功加成机率
    jl = jl + limitX(math.modf(spd / 15), 10, 50);
  
    --计算额外的基础机率
    jl = jl + baseRandom(p);
  
    return DIYPD(p, jl);
end

--根据人物的攻击力、防御力计算机率
--jl 初始机率
--p 人物编号
--根据人物的防御力计算机率
--jl 初始机率
--p 人物编号
function atkdefRandom(jl, p)
    local atk = JY.Person[p]["攻击力"];
	--队友攻击力加成
    for i,v in pairs(CC.AddAtk) do
        if v[1] == p then
            for wid = 0, WAR.PersonNum - 1 do
                if WAR.Person[wid]["人物编号"] == v[2] and WAR.Person[wid]["死亡"] == false then
                    atk = atk + v[3]
		            if hasTF(p, 129) then
			            atk = atk + v[3]
		            end		  
                end
            end
        end
	    if DT1(p,v[1]) and DT1(p,v[2]) then
		    atk = atk + v[3]
	    end
    end
	
	atk = atk + MPAttrib(p, 1)
	
	--装备攻击加成
	if JY.Person[p]["武器"] >= 0 then
  	    atk = atk + JY.Thing[JY.Person[p]["武器"]]["加攻击力"];
    end
    if JY.Person[p]["防具"] >= 0 then
        atk = atk + JY.Thing[JY.Person[p]["防具"]]["加攻击力"];
    end
	if JY.Person[p]["无用15"] >= 0 then
        atk = atk + JY.Thing[JY.Person[p]["无用15"]]["加攻击力"];
    end
    --攻击力加成机率
    local jl1 =  limitX(math.modf(atk / 15), 10, 50);
	
	local def = JY.Person[p]["防御力"];
	--队友防御力加成
    for i,v in pairs(CC.AddDef) do
        if v[1] == p then
            for wid = 0, WAR.PersonNum - 1 do
                if WAR.Person[wid]["人物编号"] == v[2] and WAR.Person[wid]["死亡"] == false then
                    def = def + v[3]
		            if hasTF(p, 129) then
			            def = def + v[3]
		            end		  
                end
            end
        end
	    if DT1(p,v[1]) and DT1(p,v[2]) then
		    def = def + v[3]
	    end
    end
	
	def = def + MPAttrib(p, 2)
	
	--装备防御加成
	if JY.Person[p]["武器"] >= 0 then
  	    def = def + JY.Thing[JY.Person[p]["武器"]]["加防御力"];
    end
    if JY.Person[p]["防具"] >= 0 then
        def = def + JY.Thing[JY.Person[p]["防具"]]["加防御力"];
    end
	if JY.Person[p]["无用15"] >= 0 then
        def = def + JY.Thing[JY.Person[p]["无用15"]]["加防御力"];
    end
    --防御力加成机率
    local jl2 = limitX(math.modf(def / 15), 10, 50);
  
    --计算机率
    jl = jl + math.modf((jl1+jl2)/2) + baseRandom(p);
  
    return DIYPD(p, jl);
end

function attribRandom(p, jl, flag) --nino:新写的几率判定
	local m = {
		{"攻击力", "加攻击力", CC.AddAtk},
		{"防御力", "加防御力", CC.AddDef},
		{"轻功", "加轻功", CC.AddSpd},
	}
	local aa = JY.Person[p][m[flag][1]];
	--队友加成
	if JY.Status == GAME_WMAP then
		for i,v in pairs(m[flag][3]) do
			if v[1] == p then
				for wid = 0, WAR.PersonNum - 1 do
					if WAR.Person[wid]["人物编号"] == v[2] and WAR.Person[wid]["死亡"] == false then
						aa = aa + v[3]
						if hasTF(p, 129) then
							aa = aa + v[3]
						end
					end
				end
			end
			if DT1(p,v[1]) and DT1(p,v[2]) then
				aa = aa + v[3]
			end
		end
	end
	aa = aa + MPAttrib(p, flag)	--门派加成
	--装备攻击加成
	if JY.Person[p]["武器"] >= 0 then
		aa = aa + JY.Thing[JY.Person[p]["武器"]][m[flag][2]];
	end
	if JY.Person[p]["防具"] >= 0 then
		aa = aa + JY.Thing[JY.Person[p]["防具"]][m[flag][2]];
	end
	if JY.Person[p]["无用15"] >= 0 then
		aa = aa + JY.Thing[JY.Person[p]["无用15"]][m[flag][2]];
	end
   
	jl = jl + limitX(aa / 15, 10, 50);

	--计算额外的基础机率
	jl = jl + baseRandom(p);

	return DIYPD(p, jl);
end

--DIY专用伤害计算
function War_DIY_WugongHurtLife(emenyid, wugong, hurt, ang, dng)
	local eid = WAR.Person[emenyid]["人物编号"]
	return hurt, ang, dng;
end

--计算武功伤害
function War_WugongHurtLife(emenyid, wugong, level, ang)

    local pid = WAR.Person[WAR.CurID]["人物编号"]
    local eid = WAR.Person[emenyid]["人物编号"]
    local dng = 0
    local WGLX = JY.Wugong[wugong]["类型"]
    local mptype, mpdj = 0, 0
    if MPPD(pid) ~= 0 then
	    mptype = MPPD(pid)
	    mpdj = MPDJ(pid)
    end
  
    if yongnei(wugong) then --内功类型随机
	    WGLX = math.random(5)
	    if WGLX == 5 then WGLX = 6 end
    end
  
    --是否为自己人
    local function DWPD()
    if WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
        return true
    else
      return false
    end
    end
  
    local mywuxue = 0
    local emenywuxue = 0
    for i = 0, WAR.PersonNum - 1 do
        local id = WAR.Person[i]["人物编号"]
    
    --武学常识共用....
    if WAR.Person[i]["死亡"] == false and JY.Person[id]["武学常识"] > 10 then
        if WAR.Person[WAR.CurID]["我方"] == WAR.Person[i]["我方"] and mywuxue < JY.Person[id]["武学常识"] then
            mywuxue = JY.Person[id]["武学常识"]
        end
        if WAR.Person[emenyid]["我方"] == WAR.Person[i]["我方"] and emenywuxue < JY.Person[id]["武学常识"] then
      	    emenywuxue = JY.Person[id]["武学常识"]
    	end
    end
    
    if emenywuxue < 20 then
        emenywuxue = 20
    end
    end
  
    --计算实际使用武功等级
    while true do
  	if JY.Person[pid]["内力"] < math.modf((level + 1) / 2) * JY.Wugong[wugong]["消耗内力点数"] then
   		level = level - 1
  	else
  		break;
  	end
    end

	--防止出现左右互博时第一次攻击完毕，第二次攻击没有内力的情况。
	if level <= 0 then
	  level = 1
	end
	
    --重写内功护体
	if JY.Person[eid]["声望"] > 0 and yongnei(JY.Person[eid]["声望"]) and DWPD() and WAR.BMGT2 ~= eid and WAR.PJTX == 0 and WAR.ZBT2<9 and WAR.GJQJ2< 15 then --如果有设置主功体
		local bht = HTJL(eid)
		--[[if math.random(100) <= bht and not (JY.Person[pid]["武器"] == 306 and wugong == 149) 
		    and not (WAR.BJ==1 and wugong == 1) and not (PersonGT(pid, 150) and MPPD(pid)==16) 
			and not (wglw1(pid,155) and yongquan(wugong) and WAR.Actup[pid] ~= nil or DT(pid,665)) and not (wglw1(pid,175) and JLSD(10,60,pid))
			and not (BJY(pid) and yongquan(wugong) and JY.Person[0]["拳掌功夫"] > 300 and JLSD(10,60,pid))
			and not ((wglw1(pid,47) or DT(pid,592)) and WAR.DGJJ_PQS1 == 1 and JLSD(10,60,pid))
			and not (wugong == 26 and (DT(pid,55) or DT(pid,617)) and JLSD(10,60,pid))
			and not (MPPD(pid) == 18 and MPDJ(pid) >= 3 and PersonGTJL(pid,189,WAR.NGJL) and JLSD(10,70,pid))
			and not (WAR.FXHJ4 == 1) and not (wugong == 13 and wglw1(pid,13) and JY.Person[eid]["内力性质"] == 0 and JLSD(10,20,pid))
			and WAR.KMWD3[eid] == nil then --武骧金星：子弹不能用内功抵挡]]
        if JY.Person[pid]["武器"] == 306 and (wugong == 149 or JLSD(10,30,pid)) then
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+".. "时代变了"
			else
				WAR.Person[emenyid][CC.TXWZ2] = "时代变了"
			end
		elseif WAR.BJ==1 and wugong == 1 then
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+".. "罗汉破罡"
			else
				WAR.Person[emenyid][CC.TXWZ2] = "罗汉破罡"
			end
		elseif PersonGT(pid, 150) and MPPD(pid)==16 and JLSD(10,60,pid) then
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+".. "杀意破气"
			else
				WAR.Person[emenyid][CC.TXWZ2] = "杀意破气"
			end
		elseif wglw1(pid,155) and yongquan(wugong) and (WAR.Actup[pid] ~= nil or DT(pid,665)) then 
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+".. "五指刀・裂破"
			else
				WAR.Person[emenyid][CC.TXWZ2] = "五指刀・裂破"
			end
		elseif wglw1(pid,175) and JLSD(10,60,pid) then
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+".. "雷火碎魄"
			else
				WAR.Person[emenyid][CC.TXWZ2] = "雷火碎魄"
			end
		elseif BJY(pid) and yongquan(wugong) and JY.Person[0]["拳掌功夫"] > 300 and JLSD(10,60,pid) then
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+".. "排云掌・劲贯云空"
			else
				WAR.Person[emenyid][CC.TXWZ2] = "排云掌・劲贯云空"
			end
		elseif (wglw1(pid,47) or DT(pid,592)) and WAR.DGJJ_PQS1 == 1 and JLSD(10,60,pid) then
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+".. "九剑・剑气碎罡"
			else
				WAR.Person[emenyid][CC.TXWZ2] = "九剑・剑气碎罡"
			end
		elseif wugong == 26 and (DT(pid,50) or DT(pid,55) or DT(pid,617)) and JLSD(10,60,pid) then
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+".. "降龙・刚柔自在"
			else
				WAR.Person[emenyid][CC.TXWZ2] = "降龙・刚柔自在"
			end
		elseif MPPD(pid) == 18 and MPDJ(pid) >= 3 and PersonGTJL(pid,189,WAR.NGJL) and JLSD(10,70,pid) then
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+".. "七伤劲・乱阴阳"
			else
				WAR.Person[emenyid][CC.TXWZ2] = "七伤劲・乱阴阳"
			end
		elseif WAR.FXHJ4 == 1 then
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+".. "命如飞絮"
			else
				WAR.Person[emenyid][CC.TXWZ2] = "命如飞絮"
			end
		--elseif wugong == 13 and wglw1(pid,13) and JY.Person[eid]["内力性质"] == 0 and JLSD(10,20,pid) then
		elseif WAR.KMWD3[eid] ~= nil then
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+".. "空明・至柔至虚"
			else
				WAR.Person[emenyid][CC.TXWZ2] = "空明・至柔至虚"
			end
		else
			if math.random(100) <= bht then
				WAR.NGHT = JY.Person[eid]["声望"]
				WAR.L_SGHT = WAR.NGHT
				local wl = 0
				for i,v in ipairs(CC.ZGTDEF) do
					if v[1] == WAR.NGHT then
						wl = math.random(v[2], v[3])
						break
					end
				end
				dng = dng + wl
				if hasTF(eid, 10) then
					dng = dng + math.modf(wl * 0.5)
				end
				if WAR.LYDJLW2[eid]~=nil and WAR.LYDJLW2[eid]>0 then
					dng=dng/2
				if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
					WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "阴阳如磨・人若微尘"
				else
					WAR.Person[emenyid][CC.TXWZ3] = "阴阳如磨・人若微尘"
				end
				end
				if WAR.DLYZ[eid]~=nil and WAR.DLYZ[eid]>0 then
					dng=0
					WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -500)
					if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
						WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "多罗迦叶"
					else
						WAR.Person[emenyid][CC.TXWZ2] = "多罗迦叶"
					end
					WAR.DLYZ[eid]=0
				end
				if WAR.FMZZ[eid]~=nil and WAR.FMZZ[eid]>0 then
					WAR.MENG[eid]=30
					WAR.CYSH[eid]=30
					AddPersonAttrib(eid, "受伤程度", 20)
				if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
					WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+".. "业障缠身"
				else
					WAR.Person[emenyid][CC.TXWZ2] = "业障缠身"
				end
					WAR.FMZZ[eid]=0
				end
				if WAR.WYQS[eid]~=nil and WAR.WYQS[eid]>0 then --五蕴炽盛
					local aa=math.random(5)
					local bb=math.random(5)
					local cc=math.random(5)
					local dd=math.random(5)
					local ee=math.random(5)
					WAR.FXDS[eid]= WAR.FXDS[eid] or 0 + 5*aa
					WAR.ICE[eid] = WAR.ICE[eid] or 0 + 5*bb
					WAR.HOT[eid] = WAR.HOT[eid] or 0 + 5*cc
					WAR.LXZT[eid] = WAR.LXZT[eid] or 0 + 5*dd
					AddPersonAttrib(eid, "中毒程度", 5*ee)
					WAR.BZ[eid]=WAR.BZ[eid] or 0 +1
					if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
						WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+".. "五蕴炽盛"
					else
						WAR.Person[emenyid][CC.TXWZ2] = "五蕴炽盛"
					end
					WAR.WYQS[eid]=0
				end
				if WAR.FRYG[eid]~=nil and WAR.FRYG[eid]> 0 then --焚日阳罡
					WAR.HOT[eid] = 50
					AddPersonAttrib(eid, "受伤程度", 50)
					dng = 0
					--[[if nokillspeed(eid) == true then 
						return false 
					end]]
					if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
						WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+".. "焚日阳罡"
					else
						WAR.Person[emenyid][CC.TXWZ2] = "焚日阳罡"
					end
					WAR.FRYG[eid]=0
				end
				if WAR.BTSP1[eid] ~= nil and WAR.BTSP1[eid] > 0 then
					local ff = (WAR.BTSP1[eid] or 0)
					AddPersonAttrib(eid, "受伤程度", ff)
					WAR.ZDNS[eid] = 20
					if WAR.Person[emenyid][CC.TXWZ1] ~= nil then
						WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+".. "怪蟒缠绕"
					else
						WAR.Person[emenyid][CC.TXWZ1] = "怪蟒缠绕"
					end
					WAR.BTSP1[eid] = nil
					WAR.BTSP2[eid] = nil
				end	
				if WAR.SJTH[eid]~=nil and WAR.SJTH[eid]>0 then
					WAR.BZ[eid]=1
					WAR.OYFSD[eid]=100
					if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
						WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "剑意透体"
					else
						WAR.Person[emenyid][CC.TXWZ2] = "剑意透体"
					end
					WAR.SJTH[eid]=0
				end
				if WAR.QSLZ[eid]~=nil and WAR.QSLZ[eid]>0 then
					local aa=JY.Person[eid]["中毒程度"]
					WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -3*aa*WAR.QSLZ[eid])
					WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -10*aa*WAR.QSLZ[eid])
					if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
						WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "七死爆毒"
					else
						WAR.Person[emenyid][CC.TXWZ2] = "七死爆毒"
					end
					WAR.QSLZ[eid]=0
				end
				if WAR.LYXJ[eid]~=nil and WAR.LYXJ[eid]>0 then
					local aa=WAR.LXZT[eid] or 0 + JY.Person[eid]["受伤程度"]
					WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -2*aa)
					WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -10*aa)
					if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
						WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+".. "千本落英"
					else
						WAR.Person[emenyid][CC.TXWZ2] = "千本落英"
					end
						WAR.LYXJ[eid]=0
				end
				if WAR.YHZJ[eid]~=nil and WAR.YHZJ[eid]>0 then
					WAR.CHXS[eid]=1
					WAR.CHZ[eid]=50
					WAR.ICEXS[eid]=1
					WAR.ICE[eid]=50
					WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -500)
					if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
						WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "寒毒侵脉"
					else
						WAR.Person[emenyid][CC.TXWZ2] = "寒毒侵脉"
					end
						WAR.YHZJ[eid]=0
				end
				if WAR.HDGX[eid]~=nil and WAR.HDGX[eid]>0 then
					WAR.HOTXS[eid]=1
					WAR.HOT[eid]=50
					WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -150)
					WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "受伤程度", 20)
					if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
						WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "火毒攻心"
					else
						WAR.Person[emenyid][CC.TXWZ2] = "火毒攻心"
					end
						WAR.HDGX[eid]=0
				end
					local str = JY.Wugong[WAR.NGHT]["名称"]
					if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
						WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" ..str .. "防护"
					else
						WAR.Person[emenyid][CC.TXWZ2] = str .. "防护"
					end
						WAR.Person[emenyid][CC.TXDH] = math.fmod(WAR.NGHT, 10) + 85
				if eid == 0 and zjtype() == 1 then 
					WAR.YYHJ = WAR.YYHJ + 1
					if putong()==5 then
						WAR.YYHJ = WAR.YYHJ + 1
					end
					if WAR.YYHJ >= 10 then 
						WAR.YYHJ = 10
					end
				end    
			elseif WAR.KMWD3[eid]~=nil then
				WAR.KMWD3[eid]=nil
			else
			end
		end
    elseif WAR.GJQJ2>=15 then
		WAR.GJQJ2=0
	else
	end
	
	if eid == 0 and WAR.BMGT~= 0 and WAR.KMWD3[eid]==nil and WAR.PJTX == 0 and WAR.ZBT2<9 and WAR.GJQJ2< 15 then 
	    WAR.NGHT = WAR.BMGT
		WAR.L_SGHT = WAR.NGHT
		local wl = 0
		for i,v in ipairs(CC.ZGTDEF) do
			if v[1] == WAR.NGHT then
				wl = math.random(v[2], v[3])
				break
			end
		end
		dng = dng + wl
		if hasTF(eid, 10) then
			dng = dng + math.modf(wl * 0.5)
		end
		if WAR.DLYZ[eid]~=nil and WAR.DLYZ[eid]>0 then
            dng=0
		    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -500)
		    if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "多罗迦叶"
			else
				WAR.Person[emenyid][CC.TXWZ2] = "多罗迦叶"
			end
			    WAR.DLYZ[eid]=0
	    end
		if WAR.FMZZ[eid]~=nil and WAR.FMZZ[eid]>0 then
		    WAR.MENG[eid]=30
		    WAR.CYSH[eid]=30
		    AddPersonAttrib(eid, "受伤程度", 20)
		    if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+".. "业障缠身"
			else
				WAR.Person[emenyid][CC.TXWZ2] = "业障缠身"
			end
			    WAR.FMZZ[eid]=0
	        end
			if WAR.BTSP1[eid] ~= nil and WAR.BTSP1[eid] > 0 then
				local ff = (WAR.BTSP1[eid] or 0)
				AddPersonAttrib(eid, "受伤程度", ff)
				WAR.ZDNS[eid] = 20
				if WAR.Person[emenyid][CC.TXWZ1] ~= nil then
					WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+".. "怪蟒缠绕"
				else
					WAR.Person[emenyid][CC.TXWZ1] = "怪蟒缠绕"
				end
				WAR.BTSP1[eid] = nil
				WAR.BTSP2[eid] = nil
			end	
		if WAR.WYQS[eid]~=nil and WAR.WYQS[eid]>0 then
		        local aa=math.random(5)
				local bb=math.random(5)
				local cc=math.random(5)
				local dd=math.random(5)
				local ee=math.random(5)
				WAR.FXDS[eid]= (WAR.FXDS[eid] or 0) + 5*aa
				WAR.ICE[eid] = (WAR.ICE[eid] or 0) + 5*bb
				WAR.HOT[eid] = (WAR.HOT[eid] or 0) + 5*cc
				WAR.LXZT[eid] = (WAR.LXZT[eid] or 0) + 5*dd
				AddPersonAttrib(eid, "中毒程度", 5*ee)
				WAR.BZ[eid] = (WAR.BZ[eid] or 0) +1
		    if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+".. "五蕴炽盛"
			else
				WAR.Person[emenyid][CC.TXWZ2] = "五蕴炽盛"
			end
				WAR.WYQS[eid]=0
		end
			if WAR.SJTH[eid]~=nil and WAR.SJTH[eid]>0 then
		        WAR.BZ[eid]=1
		        WAR.OYFSD[eid]=100
		    if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "剑意透体"
			else
				WAR.Person[emenyid][CC.TXWZ2] = "剑意透体"
			end
		        WAR.SJTH[eid]=0
	    end
		if WAR.LYXJ[eid]~=nil and WAR.LYXJ[eid]>0 then
		    local aa=WAR.LXZT[eid] or 0 + JY.Person[eid]["受伤程度"]
		    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -2*aa)
		    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -10*aa)
		    if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+".. "千本落英"
			else
				WAR.Person[emenyid][CC.TXWZ2] = "千本落英"
			end
			WAR.LYXJ[eid]=0
	    end
		if WAR.QSLZ[eid]~=nil and WAR.QSLZ[eid]>0 then
		    local aa=JY.Person[eid]["中毒程度"]
		    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -3*aa)
		    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -10*aa)
		    if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "七死爆毒"
			else
				WAR.Person[emenyid][CC.TXWZ2] = "七死爆毒"
			end
		        WAR.QSLZ[eid]=0
	    end
		if WAR.YHZJ[eid]~=nil and WAR.YHZJ[eid]>0 then
		    WAR.CHXS[eid]=1
		    WAR.CHZ[eid]=50
		    WAR.ICEXS[eid]=1
		    WAR.ICE[eid]=50
		    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -500)
		    if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "寒毒侵脉"
			else
				WAR.Person[emenyid][CC.TXWZ2] = "寒毒侵脉"
			end
			    WAR.YHZJ[eid]=0
	    end
		if WAR.HDGX[eid]~=nil and WAR.HDGX[eid]>0 then
		    WAR.HOTXS[eid]=1
		    WAR.HOT[eid]=50
		    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -150)
		    WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "受伤程度", 20)
		    if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "火毒攻心"
			else
				WAR.Person[emenyid][CC.TXWZ2] = "火毒攻心"
			end
			    WAR.HDGX[eid]=0
	    end
			local str = JY.Wugong[WAR.NGHT]["名称"]
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" ..str .. "防护"
			else
				WAR.Person[emenyid][CC.TXWZ2] = str .. "防护"
			end
			    WAR.Person[emenyid][CC.TXDH] = math.fmod(WAR.NGHT, 10) + 85	
			if eid == 0 and zjtype() == 1 then 
		        WAR.YYHJ = WAR.YYHJ + 1
				if putong()==5 then
		           WAR.YYHJ = WAR.YYHJ + 1
		        end
		        if WAR.YYHJ >= 10 then 
		           WAR.YYHJ = 10
		        end
		    end
		elseif WAR.KMWD3[eid]~=nil then
				WAR.KMWD3[eid]=nil
		elseif WAR.GJQJ2>=15 then
				WAR.GJQJ2=0
		else		
	end 		

	if (JY.Person[pid]["武功2"] == 91 and JY.Wugong[91]["名称"] == "赤血真龙诀") or (JY.Person[eid]["武功2"] == 91 and JY.Wugong[91]["名称"] == "赤血真龙诀") then
		if JY.ZLXF == 0 then
		JY.ZLXF = 1
		end
	end	

	if (wglw(eid,94) or (DT(eid,632) and PersonKF(eid,94))) and JLSD(10,40,eid) then
        local aa = JY.Person[pid]["生命最大值"]
	    local bb = JY.Person[pid]["生命"]
	    local cc = (aa + bb) / 3
	    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", (cc * 2)) 
		WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "受伤程度", -100)	
		if WAR.Person[emenyid][CC.TXWZ1] ~= nil then
			WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" .. "腾云驾雾"
		else
			WAR.Person[emenyid][CC.TXWZ1] = "腾云驾雾"
		end
	end 	
	
    if (wglw(eid,94) or (DT(eid,632) and PersonKF(eid,94))) and JLSD(10,40,eid) then
        local aa = JY.Person[pid]["内力最大值"]
	    local bb = JY.Person[pid]["内力"]
	    local cc = (aa - bb) * 3
	    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", (cc * 2)) 
		WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", 1000)	
		if WAR.Person[emenyid][CC.TXWZ1] ~= nil then
			WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" .. "气通百会"
		else
			WAR.Person[emenyid][CC.TXWZ1] = "气通百会"
		end
	end	
	
	if T6XQS(eid) and juexing() > 1 then --萧秋水2次觉醒后内功护体的时候出忘情天书
		if WAR.NGHT > 0 then
			WAR.XQS = math.random(4, 5)
			local WZTS = {"忘情天书・水逝","忘情天书・火延","忘情天书・金断","忘情天书・木顽","忘情天书・土掩"}
			WAR.Person[emenyid][CC.TXWZ1] = WZTS[WAR.XQS];
		end
	end	
	
	if T4WXS(eid) and juexing() > 2 then --王小石后天大乘诀
		if JLSD(10, 30 + math.modf(JY.Person[eid]["内力"]/300), eid) then 
			WAR.SHITOUNG=1 --王小石内功特效
		end	
	end
	
	if T4WXS(eid) and WAR.SHITOUNG==1 and DWPD() then --王小石后天大乘诀特效
		local sp= math.modf((sixi(eid,2)+sixi(eid,3))/15)
		local str=""
		if JLSD(10, 30+sp, eid) then
		WAR.SHITOUFJ=-1
		str=".刀剑逆杀"
		end	
		if WAR.Person[emenyid][CC.TXWZ2]==nil then
			WAR.Person[emenyid][CC.TXWZ2] = "后天大乘诀"..str
		else
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+后天大乘诀"..str
		end
		WAR.SHITOUNG=math.random(3)+1 --2-4
		if WAR.SHITOUNG==2 then --伤害杀气减半
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."・情意绵绵" 
			WAR.Person[emenyid][CC.TXDH]=51
		elseif WAR.SHITOUNG==3 then --反弹50%
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."・爱恨交织" 
			WAR.Person[emenyid][CC.TXDH]=48
		elseif WAR.SHITOUNG==4 then --杀气变集气
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."・愁肠百转" 
			WAR.Person[emenyid][CC.TXDH]=46
		end
		
	end	
	
	if T13TQS(eid) and juexing() > 0 then --沼跃鱼：滕青山神兽斗气
		if JLSD(10, 20 + WAR.SWFY*10, eid) then 
			WAR.TQS2=1 --滕青山神兽斗气
		end
	end
	
	if T13TQS(eid) and WAR.TQS2==1 and DWPD() then --滕青山神兽斗气
		if WAR.Person[emenyid][CC.TXWZ3]==nil then
			WAR.Person[emenyid][CC.TXWZ3] = "神兽"
		else
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."+神兽"
		end
		WAR.TQS2=math.random(4)+WAR.TQS2 --2-5
		if WAR.TQS2==2 then 
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."・青龙斗气" 
			WAR.Person[emenyid][CC.TXDH]=51
		elseif WAR.TQS2==3 then
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."・白虎斗气" 
			WAR.Person[emenyid][CC.TXDH]=48
		elseif WAR.TQS2==4 then 
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."・玄武斗气" 
			WAR.Person[emenyid][CC.TXDH]=46
		elseif WAR.TQS2==5 then
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."・朱雀斗气" 
			WAR.Person[emenyid][CC.TXDH]=52
		end
	end	
	
	if wssz(eid) then --沼跃鱼：滕青山神兽斗气
		if JLSD(10, 20 + WAR.SWFY1*10, eid) then 
			WAR.TQS2=1 --滕青山神兽斗气
		end
	end
	
	if wssz(eid) and WAR.TQS2==1 and DWPD() then --滕青山神兽斗气
		if WAR.Person[emenyid][CC.TXWZ3]==nil then
			WAR.Person[emenyid][CC.TXWZ3] = "神兽"
		else
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."+神兽"
		end
		WAR.TQS2=math.random(4)+WAR.TQS2 --2-5
		if WAR.TQS2==2 then 
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."・青龙斗气" 
			WAR.Person[emenyid][CC.TXDH]=51
		elseif WAR.TQS2==3 then
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."・白虎斗气" 
			WAR.Person[emenyid][CC.TXDH]=48
		elseif WAR.TQS2==4 then 
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."・玄武斗气" 
			WAR.Person[emenyid][CC.TXDH]=46
		elseif WAR.TQS2==5 then
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."・朱雀斗气" 
			WAR.Person[emenyid][CC.TXDH]=52
		end
	end
	
	if eid == 0 and putong() == 8 and DWPD() and JY.Person[eid]["中毒程度"] > 0 and juexing() > 0 then
		local pz = math.modf(JY.Person[eid]["资质"] / 4)
		if JLSD(10, 30 + pz, eid) then
			WAR.YTML = 1
			WAR.Person[emenyid][CC.TXWZ2] = "五毒秘・法用万物"
			WAR.Person[emenyid][CC.TXDH] = 112
		end
	end
	
	if MPPD(eid) == 5 and JLSD(10, 40 + tianshu(), eid) and WAR.Defup[eid] == nil then --金钟罩
	    if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
	        WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+"..CC.PSKILL[5][1]
	    else
	        WAR.Person[emenyid][CC.TXWZ2] = CC.PSKILL[5][1]
	    end	
	        WAR.Defup[eid] = 1
	end

	if eid == 0 and putong() == 12 and JY.Person[0]["生命"] < 300 then	--武骧金星：乾坤皆阵自动防御
	    WAR.Defup[eid] = 1
	end	
	
    if MPPD(eid) == 8 and PersonGT(eid,95) then	 --白驼山蛤蟆功自动防御
		WAR.Defup[eid] = 1
	end	

    if wglw(eid,186) and PersonGT(eid,186) then --峨眉九阳
        WAR.Defup[eid] = 1
	end			
	
	if (PersonKF(eid, 85) or T1LEQ(eid)) and PersonKF(eid, 101) and PersonKF(eid, 98) then
		local jj = math.modf(JY.Person[eid]["实战"] / 25)
		if JLSD(10, 40 + jj, eid) then --
			if PersonKF(eid,179) and MPPD(eid) == 7 and MPDJ(eid) > 2 then
				WAR.XYYF[eid] = (WAR.XYYF[eid] or 0) + 5
				WAR.Person[emenyid][CC.TXDH] = 7
				if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
					WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+".."真・逍遥御风"    
				else
					WAR.Person[emenyid][CC.TXWZ2] = "真・逍遥御风"
				end 
			else
				WAR.XYYF[eid] = (WAR.XYYF[eid] or 0) + 2
				WAR.Person[emenyid][CC.TXDH] = 7
				if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
					WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+逍遥御风"    
				else
					WAR.Person[emenyid][CC.TXWZ2] = "逍遥御风"
				end 
			end
		end
		--end
	end
	
	--防御状态
	if WAR.Defup[eid] == 1 then
	    if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
	        WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. CC.WARS79
	    else
	        WAR.Person[emenyid][CC.TXWZ3] = CC.WARS80
	    end
	    if PersonKF(eid, 101) then     --八荒六合气防+1000-1500
	        dng = dng + 1000
		    if PersonGT(eid, 101) then
			    dng = dng + 500
		    end
		    else
	  	        dng = dng + 500
	        end
		if BJY(eid) and juexing() > 2 then
			dng = dng + 1500
		end	
	
	if wglw(eid,186) and PersonGT(eid,186) then --峨眉九阳  
		dng = dng + 800
	end 	
	 
	if DT(eid,1) and WAR.ZYDQ>0 then --沼跃鱼：胡斐刀气护体增加气防
	    dng=dng+math.modf(WAR.ZYDQ*1.5)
	end
	 
    --白驼山主运蛤蟆增加气防1500
	if MPPD(eid) == 8 and PersonGT(eid,95) then	
		dng = dng + 1500
	end 	
	 
	if MPPD(eid) == 5 then
		dng = dng + 500
		if PersonGT(eid,151) then
		    local aa= JY.Person[eid]["内力"]
		    dng = dng + math.modf(aa/4)
		    if wglw(eid, 151)  then
		        ang=ang-math.modf(aa/4)
			    if ang<0 then
			        ang=0
			    end
	        end	
		 end
	end
	if DT(eid, 40) then --木岛主防御+800
	    dng = dng + 800
	end		  
	else
	if PersonGT(eid, 101) then
		dng = dng + 800
	end	
	end
	
	--普通主角，六如护体
	local lrjl = 0
	lrjl = math.modf(tianshu() * 2)

	if eid == 0  and (JLSD(25,50 + lrjl, eid) or (putong() == 6 and JLSD(30, 55, eid)) or wglw(0,102) or (DT(pid,38) and PersonKF(pid,102)))
		and (zjtype() == 1 or T10XXZ(0) or zjtype() == 4) and tianshu()>=4 and --武骧金星：萧笑竹风林六如有效
		WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
		local t = math.random(6)
		local p = math.random(6)
		local mc = "六如苍龙诀・"
		if juexing()>0 then
		    mc = "六如隼龙诀・"
		end

		--if JLSD(10, 60, eid) then --4如1-3 GetS(10, 0, 11, 0) ~= 1 and
		--	t = math.random(3)
		--else
		--	t = math.random(4) --六如1-4
		--end
		--仁者
		if putong() == 6 then --and GetS(10, 0, 11, 0) ~= 1 then --仁者4如2-3
			t = math.random(8) + 1
			p = math.random(8) + 1
		end

		if t > 3 and tianshu()>=3 then --3 = 如林
			WAR.Person[emenyid][CC.TXDH] = 6
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .."+"..FLHSYL[2]
			else
				WAR.Person[emenyid][CC.TXWZ2] = mc .. FLHSYL[2]		--其徐如林
			end
			WAR.FLHS2 = WAR.FLHS2 + 3
		end
		if p > 3 and tianshu()>=6 then -- 2 = 如山
			WAR.Person[emenyid][CC.TXDH] = 6
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .."+"..FLHSYL[4]		--不动如山
			else
				WAR.Person[emenyid][CC.TXWZ2] = mc .. FLHSYL[4]		--不动如山
			end
			WAR.FLHS4 = 1
		end
					-- 1和4，50%出如阴 仁者一定出
		if ((putong() == 6 and math.random(2) < 2) or (math.random(4) < 2)) and PersonKF(eid, 91) and juexing() > 0 then
			WAR.Person[emenyid][CC.TXDH] = 6
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .."+"..FLHSYL[5]		--难知如阴
			else
				WAR.Person[emenyid][CC.TXWZ2] = mc .. FLHSYL[5]		--难知如阴
			end
			WAR.ACT = 10
			WAR.ZYHB = 0
			WAR.FLHS5 = 1
		end
	end

    if DT(eid,662) and JLSD(10,60,eid) then 
		WAR.SJRL = 1
		if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .."+".."逆・其徐如林"
		else
			WAR.Person[emenyid][CC.TXWZ2] = "逆・其徐如林"
		end
	end 

    if DT(eid,662) and JLSD(10,60,eid) then 
		WAR.ACT = 10
		WAR.ZYHB = 0
		WAR.FLHS5 = 1
		if WAR.Person[emenyid][CC.TXWZ1] ~= nil then
			WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .."+".."正・难知如阴"
		else
			WAR.Person[emenyid][CC.TXWZ1] = "正・难知如阴"
		end
	end 

    if WAR.ZYHB1[eid] ~= nil then
	    WAR.ACT = 10 
	end   
	
	if hasTF(eid, 22) then
		dng = dng + 1000
	end


    if DT(eid,50) then  --沼跃鱼：萧峰擒龙功护体
	    local str="九龙合璧"
	    local aa=math.modf(JY.Person[pid]["内力"] /800)
	    if aa > 12 then
	        aa = 12
	elseif aa < 3 then 
	        aa = 3
	    end
	    dng = dng + 200*aa
	    if ZYBF(eid) then
	        WAR.FS2=1
	        str="天锁苍龙"
	    end
	    if ZYJ(eid) then
	        WAR.FS2=WAR.FS2+1
	        str="因陀罗的逆鳞"
	    end
	    if PersonGTHT(eid, 178, WAR.NGHT) == false then
		    WAR.Person[emenyid][CC.TXWZ2] = str		
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = "擒龙真诀・"..str
	    end
	    WAR.Person[emenyid][CC.TXDH] = 140
    end
	if DT(eid,48) and JX(eid) then
		if WAR.YHZJ[eid] ~= nil and WAR.YHZJ[eid] > 0 then
			WAR.YHZJ[eid] = 0
		end
	end	
	if DT(eid, 636) then --袁紫衣加气防
	    dng = dng + wgnumber(eid, 5, 0) * 150
	end	
		
	--brolycjw: 独孤求败
    if DT(pid , 592) then
		if WAR.L_DGQB_X < 3 then
			dng = dng + 1200
		elseif WAR.L_DGQB_X < 5 then
			dng = dng + 1400		
		elseif WAR.L_DGQB_X < 7 then
			dng = dng + 1600	
		elseif WAR.L_DGQB_X < 9 then
			dng = dng + 1800				
		else
			dng = dng + 2000		
		end
    end
	
	--北冥神功40%
	--北冥真气
	if (PersonKF(eid, 85) or T1LEQ(eid)) and (JLSD(30, 70, eid) or 
		((DT(eid, 118) or DT(eid, 116)) and JLSD(10, 40, eid)) or (T1LEQ(eid) and juexing() > 1)) then
	    if WAR.Person[emenyid][CC.TXDH] == -1 then
	        WAR.Person[emenyid][CC.TXDH] = 85
	    end
	    if T1LEQ(eid) and juexing() > 1 then
	        WAR.FXDS[eid] = nil
	        WAR.LXZT[eid] = nil
	        WAR.CHZ[eid] = nil
	        WAR.ICE[eid] = nil
	        WAR.HOT[eid] = nil
			WAR.MABI[eid] = nil
	    end
	    if WAR.Person[emenyid][CC.TXWZ2] == nil then
	        WAR.Person[emenyid][CC.TXWZ2] = CC.WARS87
	    else 
	        WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. CC.WARS87
	        dng = dng + 800
	    end
	    if MPPD(eid) == 7 and DWPD() and not PersonKF(pid, 124) then
		    SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 4, 2)	  
		    local xnl = math.modf(JY.Person[pid]["内力"] / 20 + math.random(10))
		    WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", -xnl);
		    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", math.modf(xnl + 1))	
		    if wglw(pid,101) or (DT(pid,117) and PersonKF(pid,101)) and DWPD() then	--唯我独尊--17-2-27
		        WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -math.modf(xnl/2 + 1))
		    end
		    if inteam(eid) then AddPersonAttrib(eid, "内力最大值", math.modf(xnl * 2 / 3 + 10)) end
	    end
	        WAR.B_BMJQ[eid] = 1;
	end
  
    --飞影彩蛋：真龙心法【真龙・逆鳞】反击触发
	if PersonKF(eid, 91) and inteam(eid) and JY.ZLXF == 1 then 
		WAR.CLFJ[eid] = {pid, WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"]}
	end
  
    --安七
	if DT(eid,456) then 
		WAR.CLFJ[eid] = {pid, WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"]}
	end

    --雪饮反击
	if NF(eid) and juexing() > 1 and DWPD() then
		WAR.XYFJ[eid] = {pid, WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"]}
	end	

    --无求易诀
	if BJY(eid) and juexing() > 2 and DWPD() then
		WAR.WQYJ[eid] = {pid, WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"]}
	end	

    --森罗反击
    if DT(eid,583) and DWPD() then
		WAR.SLFJ[eid] = {pid, WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"]}
	end	

    if DT(eid,592) and JLSD(10,60,eid) and DWPD() then
		WAR.DGFJ[eid] = {pid, WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"]}
	end	

    if MPPD(eid) == 3 and JLSD(10, 60, eid) and DWPD() then --玉蜂针
	   WAR.YFZ[eid] = {pid, WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"]}
    end
  
    if hasTF(eid, 151) then --反戈一击
		WAR.FGYJ[eid] = {pid, WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"]}
    end

    if KHTZF(eid) then --葵花套件
		WAR.KHFJ[eid] = {pid, WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"]}
    end

    if T13TQS(eid) and WAR.TQS2==3 then --沼跃鱼：白虎斗气反击
	   WAR.BHFJ[eid] = {pid, WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"]}
	   WAR.TQS2=0
    end
  
    if wssz(eid) and WAR.TQS2==3 then --沼跃鱼：白虎斗气反击
	   WAR.BHFJ[eid] = {pid, WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"]}
	   WAR.TQS2=0
    end
  
    if MPPD(eid) == 9 and DWPD() and WAR.AutoFight == 0 then --唐门反击 and anqinum() > 0 武骧金星：取消暗器数量判断
	   WAR.TM[eid] = {pid, WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"]}
    end

    if eid == 662 and not (PersonKF(eid, wugong) or yongnei(wugong)) then --武骧金星：水镜特殊判定
	   JY.Person[eid]["武功2"] = wugong
    end
  
    --计算受到的伤害
    local hurt = nil
    local diypofang  

    if level > 10 then
	   level = 10
    end
    local gjl = WGWL(pid, wugong, level)
    if WAR.XWGJ == 1 then --17-2-12
       gjl = WGWL(pid, 98, level)
    end
       hurt = math.modf(gjl / 4 * 0.75)
       diypofang = gjl
 
    --每多一本天书+10 最多100
	--local tmpts = 0
	--for i = 1, 200 do
	--  if JY.Base[CC.EVB12 .. i] > 143 and JY.Base[CC.EVB12 .. i] < 158 then
	--	tmpts = tmpts + 10
	--  end
	--end
	--
	--if tmpts > 100 then tmpts = 100 end
	--
	--tmpts = 0

    if GetS(86, 2, 9, 5) == 3 then
		if eid == 602 then 
		local s = 0
			for j = 0, WAR.PersonNum - 1 do
				if j ~= emenyid and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] then
					s = 1
					break
				end
			end
			if s == 1 then
				hurt = 0
				WAR.Person[emenyid][CC.TXWZ1] = "不灭盘龙"
			end
		end 
	end

    local atk = JY.Person[pid]["攻击力"]
    --[[
    if not inteam(pid) then --nino: 敌人攻击力+100
	   if pid==27 or pid==5 or pid==50 or pid==114 then
		  atk=atk+tmpts+50
		  if atk>600 then atk=600 end
	elseif pid==592 then
	else
		atk=atk+100+tmpts
		if atk>600 then atk=600 end
	   end
    end]]
  
	if pid == 0 and putong() == 10 and juexing() > 0 and WAR.LKZX2 ~= 0 then
		atk = atk + WAR.LKZX2
	end	
	
    local def = JY.Person[eid]["防御力"]
  
	if eid == 0 and putong() == 10 and juexing() > 0 then
		local pz = math.modf(JY.Person[eid]["资质"] / 4)
		if JLSD(10, 30 + pz, eid) then
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "・万物如我意"
			else
				WAR.Person[emenyid][CC.TXWZ2] = "万物如我意"
			end		
			WAR.Person[emenyid][CC.TXDH] = 152		
			for i = 0, WAR.PersonNum - 1 do
				if WAR.Person[i]["死亡"] == false and RealJL(emenyid, i, 5) and i ~= emenyid then
					local tid = WAR.Person[i]["人物编号"]
					def = def + math.modf(JY.Person[tid]["防御力"] * 0.15)
				end
			end
		end
	end

	local function myrnd(x)
		if x <= 1 then
			return 0
		end
	return math.random(x * 0.5, x)
	end
	
    --防具伤害计算
    if JY.Person[pid]["武器"] >= 0 then
       atk = atk + (JY.Thing[JY.Person[pid]["武器"]]["加攻击力"])
    end
    if JY.Person[pid]["防具"] >= 0 then
       atk = atk + (JY.Thing[JY.Person[pid]["防具"]]["加攻击力"])
    end
    if JY.Person[eid]["武器"] >= 0 then
       def = def + (JY.Thing[JY.Person[eid]["武器"]]["加防御力"])
    end
    if JY.Person[eid]["防具"] >= 0 then
       def = def + (JY.Thing[JY.Person[eid]["防具"]]["加防御力"])
    end
	if JY.Person[pid]["无用15"] >= 0 then
       atk = atk + (JY.Thing[JY.Person[pid]["无用15"]]["加攻击力"])
    end
    if JY.Person[eid]["无用15"] >= 0 then
       def = def + (JY.Thing[JY.Person[eid]["无用15"]]["加防御力"])
    end	
    --[[if not inteam(eid) then --nino: 敌人防御力+100
	   if eid==27 or eid==5 or eid==50 or eid==114 then
		def=def+tmpts+50
		if def>600 then def=600 end
	elseif eid==592 then
	   else
		def=def+100+tmpts
		if def>600 then def=600 end
	  end
    end]]
  
    if JY.Status == GAME_WMAP then
  
  	--队友攻击力加成
    for i,v in pairs(CC.AddAtk) do
        if DT(v[1], pid) then
            for wid = 0, WAR.PersonNum - 1 do
                if DT(WAR.Person[wid]["人物编号"], v[2]) and WAR.Person[wid]["死亡"] == false then
                    atk = atk + v[3]
			        if hasTF(pid, 129) then
				        atk = atk + v[3]
			        end			
                end
            end
        end
	    --if DT1(pid,v[1]) and DT1(pid,v[2]) then
		    --atk = atk + v[3]
	    --end
    end
	
	atk = atk + MPAttrib(pid, 1)
    
    --队友防御力加成
    for i,v in pairs(CC.AddDef) do
        if DT(v[1], eid) then
            for wid = 0, WAR.PersonNum - 1 do
                if DT(WAR.Person[wid]["人物编号"], v[2]) and WAR.Person[wid]["死亡"] == false then
                    def = def + v[3]
			        if hasTF(eid, 129) then
				        def = def + v[3]
			        end			
                end
            end
        end
	    --if DT1(eid,v[1]) and DT1(eid,v[2]) then
		    --def = def + v[3]
	    --end
    end
    end
  
    def = def + MPAttrib(eid, 2)
  
    local diydef = def
  
    local function getnl(id)
         return (JY.Person[id]["内力"] * 2 + JY.Person[id]["内力最大值"]) / 3
    end
  
    --local t = nil
    --if inteam(pid) then
    --  t = 1.3
    --else
    --  --hurt = (hurt) * 1.2 + 30
    --  if GetS(0, 0, 0, 0) ~= 1 then
    --    t = 1.5
    --	else
    --  	t = 2
    --  end
    --end
    local t = 1.3
    if not inteam(pid) then
	   t = 2
    end
    --蓝烟清：如果使用的不是雷震剑法，释放雷震剑法的加成
    if wugong ~= 28 and WAR.L_LZJF_ATK[pid] ~= nil then
  	   atk = atk + WAR.L_LZJF_ATK[pid];
  	   WAR.L_LZJF_ATK[pid] = nil;
    --elseif WAR.L_LZJF_ATK[pid] ~= nil then
    --	atk = atk + WAR.L_LZJF_ATK[pid];
    end	
  
    atk = atk + t * getnl(pid) / 50 + mywuxue
    --atk = atk + mywuxue + ang / 10
    --atk = atk + mywuxue + ang / 15
    --hurt = hurt + (atk) / 4 + (mywuxue - emenywuxue) / 2
    --if inteam(pid) then
        --hurt = hurt + (mywuxue - emenywuxue) / 2
    --else
        --hurt = hurt + (mywuxue - emenywuxue) / 2
    --end
  
    --[[
    if inteam(eid) then
       t = 1
    else
        if GetS(0, 0, 0, 0) ~= 1 then
            t = 1.5
  	    else
            t = 2
        end
    end
    ]]

    t = 1.3
    if not inteam(eid) then
	    t = 2
    end 
        def = def + t * getnl(eid) / 50 + emenywuxue 
  
    if JY.Thing[202][WZ7] >= 1 then --武骧金星：难6处理
        local a = JY.Thing[202][WZ7]
	    if not inteam(pid) then atk = atk + tianshu()*4*a end
	        if not inteam(eid) then def = def + tianshu()*4*a end
    end
  
    --战意的攻防加成
    atk = atk * (0.6+WAR.SPIRIT[pid] / 250)
    def = def * (0.6+WAR.SPIRIT[eid] / 250)

    if T9ZY(pid) and juexing() > 0 and WAR.SPIRIT[pid] > 100 then atk = atk + atk * ((WAR.SPIRIT[pid] - 100) / 100) end
    if T9ZY(eid) and juexing() > 0 and WAR.SPIRIT[eid] > 100 then def = def + def * ((WAR.SPIRIT[eid] - 100) / 100) end
	
	if PersonKF(eid,195) and JLSD(10,70,eid) then
		def = def + math.modf(JY.Person[eid]["轻功"]*0.7)
	end	
----------------------------------------------------------------------------------------以下是防御归零  
    if WAR.XMPM>=0 and MPPD(pid)==5 and MPDJ(pid)>1 then----沼跃鱼：降魔刀破魔
       atk=atk+WAR.XMPM
       def=0
    end
    if WAR.CYYJ==1 then----沼跃鱼：重阳遗剑
       def=0
    end
    if WAR.CJSZ==1 then----沼跃鱼：摧坚神爪
       atk=999
       def=0
    end
	if WAR.XYLQ == 1 then
		atk = 2000
		def = -100
	end	
    if DT(pid, 602) then----段思平
       def=0
    end
	if WAR.XSJS == 1 then --洗髓伤害
		def = 0
	end	
	if WAR.DYWQ == 1 and JLSD(10,70,pid) and wglw1(pid,73)then --大雅伤害
		def = 0
	end
	if WAR.TXTX == 4 or WAR.TXTX == 6 then
		def = 0
	end	
	if WAR.FQDS == 1 or WAR.FQDS == 6 then
		def = 0
	end
	if WAR.XMSSZ == 2 then --须弥领悟减防御
	local aa=math.modf(sixi(pid,1) - sixi(eid,1))
		if aa < 1 then aa = 1 end
		def = def/aa
	end
	
	if WAR.EMQF2 == 1 then --佛光普照
		def = 0
	end	
	
    if T9ZY(pid) and WAR.ZYQT==1 then --沼跃鱼：赵云单骑
       atk=atk+999
       def=0
	end
	if MPPD(pid) == 8 and wugong == 9 and WAR.KSTW == 1 then
		def = 0
		atk = atk + (WAR.BTSP[eid]or 0)+(JY.Person[eid]["中毒程度"] or 0)
		WAR.KSTW = 0 
	end
	
	if (wglw1(pid,68) and wugong == 68) or (T9ZY(pid) and wugong == 112 and wglw1(pid,68)) then
		def = def/10
	end
	
	if (wglw1(pid,67) or (DT(pid, 1) and JX(pid)) or (DT(pid, 621) and JX(pid))) and WAR.TSYXL == 3 then --金刚碎牙
       def=0
	end
  
  	if wugong == 140 and (wglw1(pid,140) or DT(pid,558)) and WAR.YHZJ[eid]~=nil and WAR.YHZJ[eid]>0 then
		def = def*0.5
		if WAR.LQZ[pid] == 100 then
		def = 0
		end
	end
	
	if WAR.LYDJLW2 == 1 then --两仪微尘阵
		def1 = 0
	end	
	
	if D1GHYD(pid) and yongdao(wugong) then
		if JLSD(0,10+(tianshu()*2),pid) then
		def = def/(10+tianshu()*2)
		end
	end
	
	if WAR.HSYFD == 1 then 
		def=0
	end
	
    --hurt=hurt*(1-(def/(600+def))) --nino: 改公式
    --hurt=hurt*(1+(atk/(600+atk)))
    --hurt = math.modf((hurt) * (atk) / (atk + def))
    --[[
    if inteam(pid) == false and WAR.tmp[200 + pid] ~= nil then --蛤蟆加伤害
       hurt = hurt + WAR.tmp[200 + pid] / 2
    end]]
  
    --local function myrnd(x)
    --if x <= 1 then
        --return 0
    --end
        --return math.random(x * 0.5, x)
    --end

    ----防具伤害计算
    --if JY.Person[pid]["武器"] >= 0 then
    --   hurt = hurt + myrnd(JY.Thing[JY.Person[pid]["武器"]]["加攻击力"])
    --end
    --if JY.Person[pid]["防具"] >= 0 then
    --   hurt = hurt + myrnd(JY.Thing[JY.Person[pid]["防具"]]["加攻击力"])
    --end
    --if JY.Person[eid]["武器"] >= 0 then
    --   hurt = hurt - myrnd(JY.Thing[JY.Person[eid]["武器"]]["加防御力"])
    --end
    --if JY.Person[eid]["防具"] >= 0 then
    --   hurt = hurt - myrnd(JY.Thing[JY.Person[eid]["防具"]]["加防御力"])
    --end
  
    --防御力，气防伤害计算
    --hurt = hurt - (def) / 12
    --[[  hurt = hurt + (atk) / 12 + (mywuxue - emenywuxue) / 2 - (def) / 12
    if MPPD(pid)==1 then --星宿派攻击和毒的关系
       hurt = hurt + JY.Person[pid]["体力"] / 5 - JY.Person[eid]["体力"] / 5 + JY.Person[eid]["中毒程度"] / 2 + JY.Person[pid]["中毒程度"] 
    elseif MPPD(eid)==1 then--星宿派防御和毒的关系
       hurt = hurt + JY.Person[pid]["体力"] / 5 - JY.Person[eid]["体力"] / 5 - JY.Person[eid]["中毒程度"]  - JY.Person[pid]["中毒程度"] / 2
    else
       hurt = hurt + JY.Person[pid]["体力"] / 5 - JY.Person[eid]["体力"] / 5 + JY.Person[eid]["中毒程度"] / 2 - JY.Person[pid]["中毒程度"] / 2
    end
       hurt = (hurt) * (atk) / (atk + def)

    local hurt2 = 0
    local hurt2js = 0
    --难度判断
    if JY.Thing[202][WZ7] == 1 then
       hurt2js = 5
    elseif JY.Thing[202][WZ7] == 2 then
       hurt2js = 4
    elseif JY.Thing[202][WZ7] == 3 then
       hurt2js = 3
    else
       hurt2js = 2
    end]]
   --[[ 
    if inteam(pid) then --不破防则二次判定
       hurt2 = math.modf(math.random(5) + (atk) / 7)
    else
       hurt2 = math.modf(math.random(20) + (atk) / hurt2js)
    end]]
    --最终伤害判定
	--[[if inteam(pid) then
	    hurt2=math.modf(math.random(15)+atk/40-def/(hurt2js*10)+diypofang/10)
		--diyhurt3=math.modf(math.random(10)+atk/7)
		--if diyhurt3>hurt2 then hurt2=diyhurt3 end --三次判定...
	else
	    hurt2=math.modf(math.random(25)+atk/(hurt2js*10)-def/40+diypofang/10)
		--diyhurt3=math.modf(math.random(20)+atk/hurt2js)
		--hurt2=math.modf(math.random(20)+atk/hurt2js)
	end	]]
	
	--hurt2 = math.modf(hurt2 * limitX((1 - (0.0003 * def)), 0.8, 1)) --diy防御对不破防伤害的加成
	--[[
    if not inteam(pid) and xiaobin(pid) then	
	   hurt2 = math.modf(hurt2 * 1.1)
    end]]
    --tb(hurt..":"..hurt2) --换公式？？
   --[[ if hurt < hurt2 then
        hurt = hurt2
	    if hasTF(pid, 55) then
		    hurt = math.modf(hurt * 1.5)
	    end
 	    if xiaobin(pid) and JY.Thing[202][WZ7] > 2 then
		    hurt = math.modf(hurt * 1.2)
	    end	
    end 
    hurt=math.modf(hurt)
    WAR.KMWD2=math.modf(hurt)]]
	
	local function effect(donghuaid,ziti,mingzi,qifang,shanghai) --DIY特效判定，依次为动画id，特效文字1、2、3，名字，气防与伤害
		WAR.Person[emenyid]["特效动画"]=donghuaid
		if WAR.Person[emenyid][ziti]== nil then
			WAR.Person[emenyid][ziti]=mingzi
		else   
			WAR.Person[emenyid][ziti]=mingzi.."+"..WAR.Person[emenyid][ziti]
		end
		dng = dng + qifang
		hurt = hurt - shanghai
		if hurt < 0 then hurt = 0 end
	end	
	
	--易筋+伏魔+神掌护体+800，易筋护体发动
	if (((PersonKF(eid,86)or JY.Person[eid]["武器"] == 363) and (PersonKF(eid,24) or JY.Person[eid]["武器"] == 50) and (PersonKF(eid,108) or PersonKF(eid,183))) or DT(eid,615) or wglw1(eid,24)) 
		and (PersonGTHT(eid,108,WAR.NGHT) or PersonGTHT(eid,183,WAR.NGHT)) then 
		if JY.Person[eid]["受伤程度"] ~= nil and JY.Person[eid]["受伤程度"] > 10 then
			JY.Person[eid]["受伤程度"] = JY.Person[eid]["受伤程度"] - 10
		else
			JY.Person[eid]["受伤程度"] = 0
		end
		if WAR.HOT[eid] ~= nil and WAR.HOT[eid] > 10 then
			WAR.HOT[eid] = WAR.HOT[eid] - 10
		else
			WAR.HOT[eid] = nil 
		end
		if WAR.LXZT[eid] ~= nil and WAR.LXZT[eid] > 10 then
			WAR.LXZT[eid] = WAR.LXZT[eid] - 10
		else
			WAR.LXZT[eid] = nil 
		end	
		if WAR.ICE[eid] ~= nil and WAR.ICE[eid] > 10 then
			WAR.ICE[eid] = WAR.ICE[eid] - 10
		else
			WAR.ICE[eid] = nil 
		end
		effect(78,"特效文字3","物我两忘・除却四相",800,0)
	elseif wglw(eid,108) and PersonGTHT(eid,108,WAR.NGHT) then
		if JY.Person[eid]["受伤程度"] ~= nil and JY.Person[eid]["受伤程度"] > 10 then
			JY.Person[eid]["受伤程度"] = JY.Person[eid]["受伤程度"] - 10
		else
			JY.Person[eid]["受伤程度"] = 0
		end
		if WAR.HOT[eid] ~= nil and WAR.HOT[eid] > 10 then
			WAR.HOT[eid] = WAR.HOT[eid] - 10
		else
			WAR.HOT[eid] = nil 
		end
		if WAR.LXZT[eid] ~= nil and WAR.LXZT[eid] > 10 then
			WAR.LXZT[eid] = WAR.LXZT[eid] - 10
		else
			WAR.LXZT[eid] = nil 
		end	
		if WAR.ICE[eid] ~= nil and WAR.ICE[eid] > 10 then
			WAR.ICE[eid] = WAR.ICE[eid] - 10
		else
			WAR.ICE[eid] = nil 
		end
		effect(78,"特效文字3","物我两忘・除却四相",1000,0)
	end	
    
	if WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then 
	    if jtyl(eid) then--2-3-
	        JY.Person[eid]["生命"] = WAR.SJSM[1000+eid]
	        WAR.SJSM[100+eid] = JY.Person[eid]["生命"]
	end
	
	if wssz(eid) then--2-3-
	    JY.Person[eid]["生命"] = WAR.SSFN[1000+eid]
	    WAR.SSFN[100+eid] = JY.Person[eid]["生命"]
	end
	
	if XYL(pid) and juexing() > 2 and DWPD() then --豸苗：谢云流八荒伤害伤害	
	    local aa = JY.Person[eid]["生命最大值"]
	    local bb = JY.Person[eid]["生命"]
	    local cc = (aa - bb) / aa
	    hurt = math.modf(hurt*(1 + cc * 1.5))
    end

	if WAR.PJS == 1 and DWPD() then
		if WAR.LXZT[eid] ~= nil then
			JY.Person[eid]["生命"] = JY.Person[eid]["生命"] - math.random(3) - math.modf(JY.Person[eid]["受伤程度"] / 1)
		else
			JY.Person[eid]["生命"] = JY.Person[eid]["生命"] - 1 - math.modf(JY.Person[eid]["受伤程度"] / 1)
			if JY.Person[eid]["生命"] < 1 then
				JY.Person[eid]["生命"] = 1
			end
		end

	end

	if WAR.PJS2 == 1 and DWPD() then
		if WAR.LQZ[eid] ~= nil and WAR.LQZ[eid] ==100 then
			WAR.LQZ[eid] = math.modf(WAR.LQZ[eid]/2)
		end
		WAR.DGJJ[eid] = 1
	end
	
    if WAR.SBJ == 3 then
		local aa = JY.Person[eid]["生命最大值"]
	    local bb = JY.Person[eid]["生命"]
	    local cc = (aa - bb) / aa
	    hurt = math.modf(hurt*(1 + cc * 3))
	end 					
	
	if WAR.ZQDL[pid] ~= nil then 
	    hurt = math.modf(hurt * 1.4)
	end
 
    if MPPD(pid) == 8 and PersonGT(pid,95) and DWPD() then  --白驼山蛤蟆功伤害
		hurt = math.modf(hurt*JY.Person[eid]["中毒程度"])
	end		

	--[[if XYL(pid) and WAR.L_HQJK == 1 and DWPD() then  --豸苗：谢云流附加伤害
	  hurt = hurt + WAR.L_XYL_X*30 + 20
	end]]
	
	if DT(pid,69) and WAR.GWZQ == 1 and DWPD() then --豸苗：丐王真气
	    hurt =  math.modf(hurt*1.2)
	    WAR.GWZQ = 0
	end		
	
	if DT(pid, 53) and JX(pid) and wugong==49 and DWPD() then
        WAR.LMJQ1=WAR.LMJQ1 + math.modf(hurt/100)
	    local lqz= WAR.LMJQ1
        --if WAR.Person[WAR.CurID][CC.TXWZ3] == nil then
			WAR.Person[WAR.CurID][CC.TXWZ3] = "龙气值"..lqz
        --else
            --WAR.Person[WAR.CurID][CC.TXWZ3] = WAR.Person[WAR.CurID][CC.TXWZ3] .. "+" ..  "龙气值"..lqz
        --end
		if WAR.LMJQ2[eid]==nil then
		    WAR.LMJQ2[eid]=0
		end
    end
    
    if WAR.LMJQ2[pid]~=nil and WAR.LMJQ2[pid]>=0 then
        WAR.LMJQ2[pid]=WAR.LMJQ2[pid] + math.modf(hurt/100)
        local jqz=WAR.LMJQ2[pid]
        --if WAR.Person[WAR.CurID][CC.TXWZ3] == nil then
			WAR.Person[WAR.CurID][CC.TXWZ3] = "剑气值"..jqz
	    --else
	        --WAR.Person[WAR.CurID][CC.TXWZ3] = WAR.Person[WAR.CurID][CC.TXWZ3] .. "+" ..  "剑气值"..jqz
	    --end
    end
	
	local function efttext(ziti,text,dhid) --显示字体
		if WAR.Person[WAR.CurID][ziti] == nil then
			WAR.Person[WAR.CurID][ziti] = text
		else
			WAR.Person[WAR.CurID][ziti] = WAR.Person[WAR.CurID][ziti].."+"..text
		end
		WAR.Person[WAR.CurID]["特效动画"] = dhid;
	end
	
	--狱龙破
	local bb=math.random(3,6)	
	if WAR.QYYYL == 1 then
		if WAR.YLP[eid] == nil then
			WAR.YLP[eid] = bb
		end
	end
    
	if BJY(pid) and yongquan(wugong) and DWPD() then
		WAR.XYQJ = WAR.XYQJ + math.modf(hurt + 100)
		local lqz = WAR.XYQJ
		if WAR.PYZJ[eid] == nil then
			WAR.PYZJ[eid] = 0
		end
		WAR.Person[WAR.CurID][CC.TXWZ3] = "虚云劲"
	end			
	
    if WAR.PYZJ[pid] ~= nil and WAR.PYZJ[pid] >= 0 then
		WAR.PYZJ[pid] = WAR.PYZJ[pid] + math.modf(hurt + 50)
		local jqz = WAR.PYZJ[pid]
		WAR.Person[WAR.CurID][CC.TXWZ3] = "排云掌劲"
	end		
	
	--从云牙比良黄泉特效(不死、魅惑)
	if wugong == 67 and (wglw1(pid,67) or (DT(pid, 1) and JX(pid)) or (DT(pid, 621) and JX(pid)))  then		
		if ((eid >= 191 and eid <= 310) or (eid >= 320 and eid <= 409) or (eid >= 441 and eid <= 450) or
		    (eid >= 456 and eid <= 457) or (eid>=461 and eid <= 496) or (eid >= 669 and eid <= 926)) and DWPD() then
			if WAR.BLHQ1 == nil then
				WAR.BLHQ1 = 1
			else
				WAR.BLHQ1 = 1
			end
		end
	end	
			
	--豸苗：扫地僧佛渡
	if DT(pid,114) and DWPD() then
	    local aa = math.modf(WAR.SPIRIT[eid]-100)
        local bb = WAR.LQZ[eid]	   
	    hurt = math.modf(hurt*(1+ aa/100))
	    if WAR.LQZ[eid] ~= nil then 
	        hurt = math.modf(hurt*(1+ aa/100)) + bb*3
	    end
	end
	
	if DT(pid,114) then --17-2-9
	    hurt = math.modf(hurt*(1.7-WAR.SDQQ*0.1))
	    if WAR.HQWX == 1 then
	        hurt = math.modf(hurt*1.3)
	    end  
	end
	
    if DT(pid,583) then
		hurt = math.modf(hurt * 6)
    end 		
	
	--豸苗：李秋水传音搜魂
	if DT(pid,118) and WAR.CYSH ~= nil then
	    hurt = math.modf(hurt*1.2)
	end

	--豸苗：童姥返老还童
	if DT(pid,117) then
        if WAR.FLHT >= 100 and WAR.FLHT < 190 then
	        hurt = math.modf(limitX(hurt*(WAR.FLHT/100 - 0.5),hurt*0.5,hurt*1.3))
		elseif WAR.FLHT >= 190 then
		    hurt = math.modf(hurt*1.3)
	    end
	end
	--豸苗：白马切JJ惩罚
	if pid == 0 and GetS(86,15,15,5) == 1 then
	    hurt = math.modf(hurt * 0.85)
	end
	
	if MPPD(pid) == 1 and WAR.SYWGZ >= 1 then --三阴蜈蚣爪
	    local mpdj=MPDJ(pid)
		hurt = hurt + math.modf((JY.Person[eid]["中毒程度"] + JY.Person[pid]["中毒程度"]) * 0.5*(mpdj+1))
		if WAR.SYWGZ == 2 and DWPD() then----引毒
		    local YD=math.modf(JY.Person[eid]["中毒程度"]*mpdj)
		    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -YD)
		end
	end

	if DT(pid,2) and JX(pid) and JLSD(20,50,pid) and DWPD() then --七星神木
		local mpdj=MPDJ(pid)
		hurt = hurt + math.modf((JY.Person[eid]["中毒程度"] + JY.Person[pid]["中毒程度"]) * 2)
		local YD=math.modf(JY.Person[eid]["中毒程度"]*3)
		WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -YD)
		effect(51,"特效文字1","七星神木.毒髓侵袭",1500,0)
	end	
    end	

    --北冥秘意
	if PersonKF(pid,85) and WAR.BMMY == 1 then
		AddPersonAttrib(pid, "攻击力", 5)
		AddPersonAttrib(pid, "防御力", 5)  
	    AddPersonAttrib(pid, "轻功", 5)     
		AddPersonAttrib(pid, "受伤程度", -100)
		AddPersonAttrib(pid, "中毒程度", -100)  
		JY.Person[pid]["拳掌功夫"] = JY.Person[pid]["拳掌功夫"] + 3
		if JY.Person[eid]["拳掌功夫"] > 999 then
			JY.Person[eid]["拳掌功夫"] = 999
		end
		JY.Person[pid]["御剑能力"] = JY.Person[pid]["御剑能力"] + 3
		if JY.Person[eid]["御剑能力"] > 999 then
			JY.Person[eid]["御剑能力"] = 999
		end
		JY.Person[pid]["耍刀技巧"] = JY.Person[pid]["耍刀技巧"] + 3
		if JY.Person[eid]["耍刀技巧"] > 999 then
			JY.Person[eid]["耍刀技巧"] = 999
		end
		JY.Person[pid]["特殊兵器"] = JY.Person[pid]["特殊兵器"] + 3
		if JY.Person[eid]["特殊兵器"] > 999 then
			JY.Person[eid]["特殊兵器"] = 999
		end
		JY.Person[pid]["暗器技巧"] = JY.Person[pid]["暗器技巧"] + 3  
		if JY.Person[eid]["暗器技巧"] > 999 then
			JY.Person[eid]["暗器技巧"] = 999
		end	
	end 	

    --吸星真谛
    if PersonKF(pid,88) and WAR.XXZD == 1 then
        WAR.FXDS[pid] = nil
	    WAR.LXZT[pid] = nil
	    WAR.CHZ[pid] = nil
	    WAR.ICE[pid] = nil
	    WAR.HOT[pid] = nil
		WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", 100)
		WAR.Person[WAR.CurID]["内伤点数"] = (WAR.Person[WAR.CurID]["内伤点数"] or 0) + AddPersonAttrib(pid, "受伤程度", -30)
		WAR.Person[WAR.CurID]["中毒点数"] = (WAR.Person[WAR.CurID]["中毒点数"] or 0) + AddPersonAttrib(pid, "中毒程度", -30)  
	end	

    if wglw(pid,185) or (PersonGT(pid,185) and DT(pid,5)) and WAR.Actup[pid] ~= nil then
		WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "受伤程度", 50)
	end 	

    if WAR.FQDS == 5 or WAR.FQDS == 6 then
		WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) AddPersonAttrib(eid, "受伤程度", 10)
	end 

    --虚竹降龙掌
	if wugong == 26 and (DT(pid,49) or DT(pid,617)) then
		AddPersonAttrib(pid, "攻击力", 5)
		AddPersonAttrib(pid, "防御力", 5)
		AddPersonAttrib(pid, "轻功", 5)
		WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", 200)
		WAR.Person[WAR.CurID]["体力点数"] = (WAR.Person[WAR.CurID]["体力点数"] or 0) + AddPersonAttrib(pid, "体力", 10)
		WAR.Person[WAR.CurID]["内伤点数"] = (WAR.Person[WAR.CurID]["内伤点数"] or 0) + AddPersonAttrib(pid, "受伤程度", -10)
		WAR.Person[WAR.CurID]["中毒点数"] = (WAR.Person[WAR.CurID]["中毒点数"] or 0) + AddPersonAttrib(pid, "中毒程度", -10)
		WAR.Person[WAR.CurID][CC.TXWZ1] = "北冥降龙"
	end

    --小二
    if DT(pid,585) and WAR.LQZ[pid] == 100 and DWPD() then 
		AddPersonAttrib(eid, "内力", -9999)
	end	

    if wglw(pid,186) and PersonGT(pid,186) and JLSD(10,45,pid) then --峨眉九阳 	
        WAR.FXXS[eid] = 1 
	    WAR.FXDS[eid] = 10	
	    if WAR.FXDS[eid] == nil then
		    WAR.FXDS[eid] = 10
	    else
		    WAR.FXDS[eid] = WAR.FXDS[eid] + 10
	    end
		AddPersonAttrib(eid, "受伤程度", 10)
		AddPersonAttrib(eid, "体力", -10)
		if WAR.Person[WAR.CurID][CC.TXWZ2] == nil then 
	        WAR.Person[WAR.CurID][CC.TXWZ2] = "浪起湖心动山摇"
	    else 
	        WAR.Person[WAR.CurID][CC.TXWZ2] = WAR.Person[WAR.CurID][CC.TXWZ2].."+".."浪起湖心动山摇"
	    end
	end 	

    if wglw(pid,186) and PersonGT(pid,186) and JLSD(10,45,pid) then --峨眉九阳
		hurt = hurt * 3
        for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - 300
				local tmppid = WAR.Person[j]["人物编号"]
				WAR.LXZT[tmppid] = WAR.LXZT[tmppid] or 0 + math.random(50,100)
			end
		end	
		if WAR.Person[WAR.CurID][CC.TXWZ1] == nil then 
	        WAR.Person[WAR.CurID][CC.TXWZ1] = "闪现雷鸣山压顶"
	    else 
	        WAR.Person[WAR.CurID][CC.TXWZ1] = WAR.Person[WAR.CurID][CC.TXWZ1].."+".."闪现雷鸣山压顶"
	    end
	end		

    if DT(pid,662) and JLSD(10,60,pid) then
		WAR.SJRH = 1
		hurt = hurt * 3
		WAR.FXXS[eid] = 1 
	    WAR.FXDS[eid] = 15	
	    if WAR.FXDS[eid] == nil then
		    WAR.FXDS[eid] = 15
	    else
		    WAR.FXDS[eid] = WAR.FXDS[eid] + 15
	    end
		AddPersonAttrib(eid, "受伤程度", 20)
		if WAR.Person[WAR.CurID][CC.TXWZ1] == nil then 
	        WAR.Person[WAR.CurID][CC.TXWZ1] = "霸・侵略如火"
	    else 
	        WAR.Person[WAR.CurID][CC.TXWZ1] = WAR.Person[WAR.CurID][CC.TXWZ1].."+".."霸・侵略如火"
	    end
	end

    if DT(pid,662) and JLSD(10,60,pid) then
        WAR.SJRT = 1
		if WAR.Person[WAR.CurID][CC.TXWZ2] == nil then 
	        WAR.Person[WAR.CurID][CC.TXWZ2] = "猛・动如雷霆"
	    else 
	        WAR.Person[WAR.CurID][CC.TXWZ2] = WAR.Person[WAR.CurID][CC.TXWZ2].."+".."猛・动如雷霆"
	    end
	end

    if WAR.KTAY1 == 1 then
	    hurt = hurt + math.modf(JY.Person[eid]["受伤程度"] * 2)
	    hurt = math.modf(hurt * JY.Person[eid]["内力最大值"]) 
	    hurt = hurt * 2
	end	

	--斗转星移
    --for i = 1, 10 do
    --local kfid = JY.Person[eid]["武功" .. i]
    --end
  	local fanji=math.modf(JY.Person[eid]["资质"]/2) --斗转概率资质/2+5，慕容父子额外70%判定
    if PersonKF(eid, 43) and JY.Person[eid]["体力"] > 10 and WAR.Person[emenyid]["反击武功"] == -1 and WAR.Person[WAR.CurID]["反击武功"] == -1 --武骧金星：尝试修复斗转互相弹来弹去的问题
		and WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and 
		(JLSD(10,20+fanji,eid) or ((DT(eid, 51) or DT(eid , 113) or wglw1(eid , 43)) and (WAR.HMXC > 0 or JLSD(20, 90, eid))) 
		or (WAR.tmp[1000 + eid] == 1 and JLSD(30, 70, eid)))  and not (D1GHYD(pid) and yongdao(wugong)) and (not (wugong == 18 and WAR.TZQJ13[pid] == 1)) and WAR.DWRY ~= 1 then
        local p = JY.Person[eid]
        local dzlv = sixi(eid, 1) + sixi(eid, 2) + sixi(eid, 3) + sixi(eid, 4) + sixi(eid, 5)
        local dzwz = ""
	    local dzfj = ""

	if T7DFWM(eid) and juexing() >= 2 then --东方未明乾坤斗转
		WAR.DFWM3 = 1
		if yongquan(wugong) then
		    WAR.DFWM3P=1
		    dzfj="・真拳荡江湖"
		end
		if yongjian(wugong) then
            WAR.DFWM3P=2
            dzfj="・傲剑镇山河"			
        end
	    if yongdao(wugong) then
            WAR.DFWM3P=3
            dzfj="・狂刀破苍穹"			
        end
	    if yongte(wugong) then
		    WAR.DFWM3P=4
            dzfj="・天机动乾坤"			
        end
	    if yongan(wugong) then
		    WAR.DFWM3P=5
            dzfj="・千手变星辰"			
        end
	    if yongnei(wugong) then
		    WAR.DFWM3P=6
            dzfj="・罡气乱天下"			
        end
	end
	 
	if DT(eid , 51) and JX(eid) then --沼跃鱼：慕容无间斗转
		WAR.WJDZ = math.random(1,5)
		WAR.WJDZ2 = WAR.WJDZ2+1
		local WZTS = {"修罗・趣果无间","修罗・受苦无间","修罗・时无间","修罗・命无间","修罗・身形无间"}
		local WJDZ=WAR.WJDZ
		dzfj = WZTS[WJDZ]..dzfj
		dng = dng + 3*dzlv
		WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", math.modf(dzlv/10 + 30))
    end
   
    if DT(eid,457) and JLSD(10,60,eid) then
        WAR.FLHS4 = 1
	    --WAR.ACT = 10
	    WAR.ZYHB = 0
	    --local dzxg=math.modf(JY.Person[eid]["内力"]/2)
	    dzfj = dzfj.."・化解"
	    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid,"生命",200)
	end

	if wglw1(eid,43) or ((DT(eid , 51) or DT(eid,113)) and JX(eid)) then
       WAR.FLHS4 = 1
	   WAR.ACT = 10
	   WAR.ZYHB = 0
	   local dzxg=math.modf(JY.Person[eid]["内力"]/2)
	   dzfj = dzfj..".星辰化解"
	   WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", math.modf((dzlv+dzxg)/5))
	end
	
	if DT3(eid , 51) and WAR.HMXC > 0 then --慕容幻梦星辰
        dzwz = "幻梦星辰"
        WAR.DZXYLV[eid] = 3
    elseif dzlv >= 390 or DT(eid , 51) or DT(eid , 113) then
        dzwz = CC.WARS88			--离合参商
        WAR.DZXYLV[eid] = 3
    elseif dzlv >= 280 then
        dzwz = CC.WARS89			--斗转星移
        WAR.DZXYLV[eid] = 2
    else
        dzwz = CC.WARS90			--北斗移辰
        WAR.DZXYLV[eid] = 1
    end
	    if dzfj ~= nil then
		    if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
			    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. dzwz..dzfj
		    else
			    WAR.Person[emenyid][CC.TXWZ2] = dzwz..dzfj
		    end
	    else
		    if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
			    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. dzwz
		    else
			    WAR.Person[emenyid][CC.TXWZ2] = dzwz
		    end	  
	    end
        if WAR.Person[emenyid][CC.TXDH] == nil then
            WAR.Person[emenyid][CC.TXDH] = math.fmod(43, 10) + 85
        end
        WAR.Person[emenyid]["反击武功"] = wugong
	    if not (DT(eid , 113) or wglw1(eid,43)) then
		    JY.Person[eid]["体力"] = JY.Person[eid]["体力"] - 3
	    end
        --break;
    end 
  
    --斗转星移伤害和杀集气计算
    if WAR.DZXYLV[pid] ~= nil and WAR.DZXYLV[pid] > 10 then
        hurt = math.modf(hurt * WAR.DZXYLV[pid] / 100)
	    if DT(pid, 113) then
		    ang = ang + WAR.DZXYLV[pid] * 15
	    else
		    ang = ang + WAR.DZXYLV[pid] * 10
	    end
    end

    if WAR.DGJJ[pid] ~= nil then
		ang = 0
	end
  
	if hasTF(pid, 54) and DWPD() then
		if JY.Person[pid]["生命"] > math.modf(JY.Person[pid]["生命最大值"] * 0.5) then
			JY.Person[pid]["生命"] = math.modf(JY.Person[pid]["生命"] * 0.9)
			WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + (-math.modf(JY.Person[pid]["生命"] * 0.1))
			hurt = hurt + math.modf(JY.Person[eid]["生命最大值"] * 0.05)
		end
	end

    if T9ZY(pid) or T9ZY(eid) then
		local wofang = 0
		local difang = 0
        for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == true then
                wofang = wofang + 1
            end
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == false then
                difang = difang + 1
            end		  
        end
		local cha = difang - wofang 
		if cha > 0 then
			if T9ZY(pid) and DWPD() then hurt = hurt * (1 + cha * 0.05) end
			    if T9ZY(eid) and DWPD() then hurt = hurt * (1 - cha * 0.05) end
		end
    end	
	
	if T9ZY(pid) and PersonKF(eid, wugong) and DWPD() then
		hurt = hurt * 2
	end
	
	if T9ZY(eid) and PersonKF(eid, wugong) and DWPD() then
		hurt = hurt * 0.5
	end

    --华山拳系
    if (MPPD(pid) == 14 and PersonGT(pid,90) and JY.Person[pid]["拳掌功夫"] >= 200 and yongquan(wugong)) or ((DT(pid,54) or DT(pid,185) or DT(pid,188)) and yongquan(wugong)) then
        hurt = hurt * 1.2
	end
		
    --步惊云用拳加攻
    if BJY(pid) and yongquan(wugong) then 
		hurt = hurt * 1.5
	end 
	
	--步惊云1觉用剑加攻
	if BJY(pid) and yongjian(wugong) and juexing() > 0 then 
		hurt = hurt * 2
	end 		

    if WAR.XMSZ > 0 then
		if JLSD(10,60,pid) then
		    if JY.Person[eid]["中毒程度"] == 100 then
			    if math.random(10) < 5 then
	                WAR.BZ[eid] = WAR.BZ[eid] or 0 + 1
				end 	
	        end
		end
	end

    if WAR.XMSZ == 1 then
        for j = 0, WAR.PersonNum - 1 do			      	  
		local tmppid = WAR.Person[j]["人物编号"]
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == false then
				JY.Person[tmppid]["中毒程度"] = 100       
	            WAR.HDGX[eid] = WAR.HDGX[eid] or 0 + 1
	            WAR.YHZJ[eid] = WAR.YHZJ[eid] or 0 + 1
	            AddPersonAttrib(eid, "体力", -10);	
			end						
		end
	end	

    if WAR.XMSZ == 2 then
	    for j = 0, WAR.PersonNum - 1 do 
			if WAR.Person[j]["我方"] == false and WAR.Person[j]["死亡"] == false and j ~= WAR.CurID then
				WAR.Person[j].Time = limitX(WAR.Person[j].Time-250,-250,500)
				WAR.ICE[WAR.Person[j]["人物编号"]] = 1 
				if WAR.ICE[WAR.Person[j]["人物编号"]] ~= nil then
					WAR.ICE[WAR.Person[j]["人物编号"]] = WAR.ICE[WAR.Person[j]["人物编号"]] + math.random(50,100)
				else
					WAR.ICE[WAR.Person[j]["人物编号"]] = math.random(50,100)
				end
			end
		end
	end	

    if WAR.XMSZ == 3 and DWPD() then 
		WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -200)
		WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -100) 	
	end 	

    if WAR.XMSZ == 4 and DWPD() then
        WAR.FXDS[emenyid] = 100
	    WAR.LXZT[emenyid] = 100
	    WAR.CHZ[emenyid] = 100 	
	end  			

    if WAR.SGSF == 1 then 
		if JY.Person[pid]["内力最大值"] < 8500 then
	        WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", -300)
		end 	
	end 

    if WAR.SGSF == 2 then
		if JY.Person[pid]["内力最大值"] < 8500 then
		    WAR.BZ[pid] = 1
		    WAR.OYFSD[pid] = 100
		end 						
	end
	
	if WAR.SGSF == 3 then
		if JY.Person[pid]["内力最大值"] < 8500 then
			WAR.Person[WAR.CurID]["内伤点数"] = (WAR.Person[WAR.CurID]["内伤点数"] or 0) + AddPersonAttrib(pid, "受伤程度", 50)
		end	
	end 

    if WAR.SGSF == 4 then 
		if JY.Person[pid]["内力最大值"] < 8500 then
	        if WAR.MENG[pid] == nil then
		        WAR.MENG[pid] = 50
		    end 
	    end
    end

    if WAR.SGSF == 5 then 
		if JY.Person[pid]["内力最大值"] < 8500 then
            WAR.KHCM[pid] = 1
		end 	
	end 

    if WAR.SGSF == 6 then
		if JY.Person[pid]["内力最大值"] < 8500 then
		    WAR.CHZ[pid] = 50
		    WAR.ICEXS[pid] = 1
		    WAR.ICE[pid] = 50
		end 	
	end 	

    if WAR.SGSF == 7 then
	    if math.random(10)<5 then
	        WAR.BZ[eid] = WAR.BZ[eid] or 0 + 1
	    end
    end

    if DT(pid,603) then 
		for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - 100
			end 
		end 		
	    AddPersonAttrib(eid, "内力", -300) 	
	end 

    if DT(pid,603) then
		WAR.OYFSD[eid] = 100						
	end
	
	if DT(pid,603) then
	    AddPersonAttrib(eid, "受伤程度", 50)
	end 

    if DT(pid,603) then 
	    if WAR.MENG[eid] == nil then
		    WAR.MENG[eid] = 50
		end 
    end

    if DT(pid,603) and JLSD(10,40,pid) then 
        WAR.KHCM[eid] = 1
	end 

    if DT(pid,603) then
		WAR.CHZ[eid] = 50
		WAR.ICEXS[eid] = 1
		WAR.ICE[eid] = 50 	
	end 	

    if DT(pid,603) and JLSD(10,40,pid) then 
		WAR.L_NOT_MOVE[eid] = 1
	end 	

    if DT(pid,603) then
	    WAR.PEACE[eid] = WAR.PEACE[eid] or 0 + 100
    end

     if WAR.FQDS == 4 or WAR.FQDS == 6 then
		WAR.L_NOT_MOVE[eid] = 1
	end 

    if WAR.XMHJ == 1 then
		WAR.PEACE[eid] = WAR.PEACE[eid] or 0 + 100
    end

    if JY.Person[pid]["武器"] == 299 and (DT(pid, 585) or wglw1(pid, 141)) and yongdao(wugong) then
		WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -150);
    end
	
    if wugong == 49 and ((DT(pid, 53) or DT(pid, 602)) or wglw1(pid,49)) then
		for j = 0, WAR.PersonNum - 1 do
	        if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then				
		        local tmppid = WAR.Person[j]["人物编号"]
		        WAR.ICE[tmppid]=WAR.ICE[tmppid] or 0 + 30
		        local bb=WAR.ICE[tmppid]*15
		        WAR.Person[j]["体力点数"] = (WAR.Person[j]["体力点数"] or 0) + AddPersonAttrib(tmppid, "体力", -1)	
				WAR.XNXS[tmppid] = 1
	            WAR.Person[WAR.CurID][CC.TXWZ1] = "六脉剑气"
	        end
        end
	end
	
    if DT(pid, 456) then
		for j = 0, WAR.PersonNum - 1 do
	        if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then				
		        local tmppid = WAR.Person[j]["人物编号"]
		        WAR.ICE[tmppid]=WAR.ICE[tmppid] or 0 + 30
		        local bb=WAR.ICE[tmppid]*15
		        WAR.Person[j]["体力点数"] = (WAR.Person[j]["体力点数"] or 0) + AddPersonAttrib(tmppid, "体力", -1)	
				WAR.XNXS[tmppid] = 1	
	            WAR.Person[WAR.CurID][CC.TXWZ1] = "六脉剑气"
	        end
        end
	end 	
	
	if WAR.LMJQ == 1 then
	    if WAR.LXZT[pid] ~= nil then
            JY.Person[pid]["生命"] = JY.Person[pid]["生命"] - math.random(3) - math.modf(JY.Person[pid]["受伤程度"] / 1)
        else
            JY.Person[pid]["生命"] = JY.Person[pid]["生命"] - 1 - math.modf(JY.Person[pid]["受伤程度"] / 1)
            if JY.Person[pid]["生命"] < 1 then
                JY.Person[pid]["生命"] = 1
            end
        end
	end

    if WAR.LMJQ == 1 then
	    local a = math.modf((ang+100)/1000)
		if a > 10 then 
		    a = 10 
		elseif a < 1 then 
            a = 1		   
		end   
	end	

    if WAR.LMJQ == 1 then
	    WAR.ICE[pid] = (WAR.ICE[pid] or 0) + 20
	    if WAR.ICE[pid] > 50 then WAR.ICE[pid] = 50 end
		    WAR.ICEXS[pid] = 1    
	end 	

    if WAR.LMJQ == 2 and DWPD() then
        if WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
            local SN=math.modf(JY.Person[eid]["内力"]/200*sixi(pid,1) and sixi(pid,2)*0.1)
	        local SN2=SN*10
	        AddPersonAttrib(eid, "生命", -SN)
	        WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0)+AddPersonAttrib(eid, "生命", -SN)
	    end
	end	

    if WAR.LMJQ == 3 then
        local d = math.modf((JY.Person[pid]["攻击力"] - JY.Person[eid]["攻击力"]) / 6)
		if d < 10 then
            d = 10
        end
		hurt = hurt + math.modf((JY.Person[eid]["内力最大值"] - JY.Person[eid]["内力"])*0.02*d)
		AddPersonAttrib(eid,"受伤程度", math.random(10,20))
	end	

    if WAR.LSJQ == 3 then 
		for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then				
				local tmppid = WAR.Person[j]["人物编号"]
				WAR.ICE[tmppid]=WAR.ICE[tmppid] or 0 + 30
				local bb=WAR.ICE[tmppid]*15
				AddPersonAttrib(tmppid, "内力", -bb)
			end
		end		
	end	

    if WAR.LMJQ == 4 and DWPD() then
	    local SN=math.modf(JY.Person[eid]["内力"]/200)
	    local SN2=SN*10
	    AddPersonAttrib(eid, "生命", -SN)
	    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0)+AddPersonAttrib(eid, "生命", -SN)
	    AddPersonAttrib(eid, "内力", -SN2)
	    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0)+AddPersonAttrib(eid, "内力", -SN2)
	end	

    if WAR.LMJQ == 5 then
        if WAR.LQZ[pid] == nil then
			WAR.LQZ[pid] = 30
		elseif WAR.LQZ[pid] > 75 and WAR.LQZ[pid] ~= 100 then
			WAR.LQZ[pid] = 100
		elseif WAR.LQZ[pid]  < 100 then
			WAR.LQZ[pid] = WAR.LQZ[pid] + 30
	    end
	end

    if WAR.LMJQ == 5 then
	    for j = 0, WAR.PersonNum - 1 do
		    if WAR.Person[j]["死亡"] == false and 
			    WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
			    WAR.Person[j].Time = WAR.Person[j].Time - 300
		        if WAR.Person[j].Time < -500 then WAR.Person[j].Time = -500 
		        end
		    end
	    end	
    end

    if WAR.LMJQ == 6 then
	    for j = 0, WAR.PersonNum - 1 do
		    if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then				
			    local tmppid = WAR.Person[j]["人物编号"]
			    WAR.HOT[tmppid]=WAR.HOT[tmppid] or 0 + 30
			    local bb=WAR.HOT[tmppid]*5
			    AddPersonAttrib(tmppid, "生命", -bb)
		    end
	    end		
	end	  
	
	if WAR.LMJQ == 6 then
	    if WAR.LQZ[pid] ~= nil then
		    dng = 0
		    hurt = math.modf(hurt * 2)
	        ang = ang + 2500 + math.modf((WAR.LQZ[pid] or 0) * 100)
	    else
	        ang = ang + 2500
	    end
	end

    if WAR.FQDS == 6 then
		if WAR.LQZ[pid] ~= nil then
			dng = 0 
			hurt = math.modf(hurt * WAR.LQZ[pid])
			ang = ang + 2500 + math.modf((WAR.LQZ[pid] or 0) * 100)
		end
	end	

    if WAR.DGJJ[eid]~= nil then
	dng = 0
	end
	
    if WAR.HYZF == 1 then
        WAR.CHXS[eid] = 1
		WAR.CHZ[eid] = 100
		WAR.ICEXS[eid] = 1
		WAR.ICE[eid] = 50
	end	

    if WAR.HYZF == 2 then
        WAR.BZ[eid] = 1
	    if WAR.MENG[eid] == nil then
		    WAR.MENG[eid] = 70
	    end
	end	

    if WAR.HYZF == 3 then
        local d = math.modf(JY.Person[pid]["内力"] / 300)
		if d < 20 then
            d = 20
        end
		local dd = d * 10
		for i = 0, WAR.PersonNum - 1 do 
			if WAR.Person[i]["我方"] == false and WAR.Person[i]["死亡"] == false and i ~= WAR.CurID then
				WAR.Person[i].Time = math.max(WAR.Person[i].Time - dd, -500)
				AddPersonAttrib(WAR.Person[i]["人物编号"],"受伤程度", math.random(20,d))
			end
		end
	end			
	
    if WAR.FXHJ2 == 1 then
		for j = 0, WAR.PersonNum -1 do 
		    local a = WAR.Person[j]["人物编号"]
		    local b = 10
		    local c = math.modf(b)
		    WAR.LXZT[WAR.Person[j]["人物编号"]] = WAR.LXZT[WAR.Person[j]["人物编号"]] or 0 + math.random(1,9)
		    if WAR.LXZT[WAR.Person[j]["人物编号"]] ~= nil and WAR.LXZT[WAR.Person[j]["人物编号"]] > 0 then 
                AddPersonAttrib(a, "生命", -b)
			end	
		end 
	end 		
	
    --霹雳刀气破防、内伤、流血(敌、我都会流血)
	if (DT(pid, 585) or wglw1(pid, 141)) and JLSD(15, 65, pid) and WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and yongdao(wugong) then
		dng = 0;
        local s = 1000 + JY.Person[pid]["内力"] - JY.Person[eid]["内力"];
        if s < 0 then
            s = 0;
	    end 
	   	ang = ang+s
  	    AddPersonAttrib(eid, "受伤程度", 15);
        WAR.LXZT[eid] = WAR.LXZT[eid] or 0 + 20
	    if 50 < WAR.LXZT[eid] then
	        WAR.LXZT[eid] = 50
	    end
	    local s1=math.modf(s/400)
	    if JY.Person[pid]["内力性质"] == 1 then----
	        WAR.HDGX[eid]=WAR.HDGX[eid] or 0 + 1
	        elseif JY.Person[pid]["内力性质"] == 0 then
	        WAR.YHZJ[eid]=WAR.YHZJ[eid] or 0 + 1
	    else
	        if JY.Person[eid]["内力"]>=s1 then
	            AddPersonAttrib(eid, "体力", -s1);
	        end
	    end
        if WAR.Person[emenyid][CC.TXWZ1] == nil then
		    WAR.Person[emenyid][CC.TXWZ1] = "霹雳刀法・刀气蚀体"
	    else
		    WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1].."+霹雳刀法・刀气蚀体"
	    end	
		    WAR.Person[emenyid][CC.TXDH] = 48
	end	
	
    if WAR.SBZ == 2 then
		for j = 0, WAR.PersonNum - 1 do
		    if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then				
			    local tmppid = WAR.Person[j]["人物编号"]
			    WAR.HOT[tmppid]=WAR.HOT[tmppid] or 0 + 30
			    local bb = WAR.HOT[tmppid] * 5
			    AddPersonAttrib(tmppid, "生命", -bb)
		    end
	    end		
	end 		
	
    if pid == 0 and putong() == 11 then
	    if WAR.PLJZ["攻击力"] ~= nil then
		    hurt = hurt * (1 + (WAR.PLJZ["攻击力"] / 100))
	    end
	    if WAR.PLJZ["气攻值"] ~= nil then
		    ang = ang * (1 + (WAR.PLJZ["气攻值"] / 100))
	    end
    end

    if eid == 0 and putong() == 11 then
	    if WAR.PLJZ["防御力"] ~= nil then
		    hurt = hurt * (1 - (WAR.PLJZ["防御力"] / 100))
	    end
	    if WAR.PLJZ["气防值"] ~= nil then
		    dng = dng * (1 + (WAR.PLJZ["气防值"] / 100))
	    end	
    end
  
    if WAR.NS[pid] ~= nil then 
        dng = 0----日月神教
    end
    --狄云
    if DT(pid , 37) and JY.Person[0]["品德"] > 70 then
        hurt = (1 + (JY.Person[0]["品德"] - 70) / 100) * hurt
    end
  
    if MPPD(pid) == 5 and JY.Person[pid]["品德"] > 50 then --袈裟伏魔
	    hurt = (1 + (JY.Person[pid]["品德"] - 50) / 200) * hurt
    end
  
    if DT(pid , 99) and JY.Person[0]["品德"] < 30 then --叶二娘，品德越低攻击越高
        hurt = (1 + (30 - JY.Person[0]["品德"]) / 100) * hurt
    end 
  
    --程英
    if DT(pid, 63) and JY.Person[pid]["生命"] < math.modf(JY.Person[pid]["生命最大值"] / 2) then
        hurt = hurt * (2 - math.modf(JY.Person[pid]["生命"] / JY.Person[pid]["生命最大值"]))	
    end
  
    --brolycjw: 龙岛主
    if DT(pid , 39) then
        hurt = hurt * 1.2
    end
  
    --伏魔杖法领悟
    if wugong == 86 and (DT(pid, 615) or wglw1(pid,86)) then
        hurt = hurt * 2
    end 	

    --葵花神针领悟
    if wugong == 177 and (DT(pid, 27) or wglw1(pid,177)) then
        hurt = hurt * 2
    end 	

	if wugong == 140 and (wglw1(pid,140) or DT(pid,558))  then
        hurt = hurt * 1.5
		if WAR.LQZ[pid] == 100 then
		hurt = hurt * 2.5
		end
    end

	if WAR.HSYFD == 1 then
		hurt = hurt * 2.5
	end

    --玄冥领悟
    if wugong == 21 and ((DT(pid, 643) or DT(pid, 644)) or wglw1(pid,21)) then
        hurt = hurt * 2.5
    end 	
	
    --七伤拳领悟
    if wugong == 23 and ((DT(pid, 8) or DT(pid, 167) or DT(pid, 168) or DT(pid, 603)) or wglw1(pid,23)) then
        hurt = hurt * 1.8
    end 	
	
	--胡刀领悟
	if wugong == 67 and (wglw1(pid,67) or (DT(pid, 1) and JX(pid)) or (DT(pid, 621) and JX(pid))) and JLSD(10, 20, eid) then
		hurt = hurt * 1.5
	end	
	
    --桃花三宝伤害加10%
    if WAR.THSB ~= 0 then
	    hurt = hurt * 1.1
    end
  
    --峨眉掌门限定伤害
	if (MPPD(pid) == 17 and MPDJ(pid) >= 2) or (GX(pid) and JX(pid)) then
		hurt = hurt * 2 + 150
	end	
    
    --沼跃鱼：真传桃花三宝伤害加20%
    if MPPD(pid) and WAR.THSB4 ~= 0 then
	    hurt = hurt * 1.2
    end

    if JY.Person[pid]["武器"] == 245 and JLSD(10,40,pid) then  --玄铁指环
		local a = JY.Person[pid]["拳掌功夫"] / 10
		hurt = hurt * a
	end	

    if JY.Person[pid]["武器"] == 292 and JLSD(10,40,pid) then  --铁棋盘
		local a = JY.Person[pid]["特殊兵器"] / 10
        hurt = hurt * a
	end 
	
    if JY.Person[pid]["武器"] == 293 and JLSD(10,40,pid)  then  --刺针指环
		local a = JY.Person[pid]["暗器技巧"] / 10
        hurt = hurt * a
	end 
		
    if JY.Person[pid]["武器"] == 300 and JLSD(10,40,pid)  then	--峨眉刺
		local a = JY.Person[pid]["御剑能力"] / 10
        hurt = hurt * a
	end 	
		
    if JY.Person[pid]["武器"] == 305 and JLSD(10,40,pid)  then	--紫金八卦刀
		local a = JY.Person[pid]["耍刀技巧"] / 10
        hurt = hurt * a
	end 		
		
    if JY.Person[pid]["武器"] == 311 and JLSD(10,40,pid)  then	--圣火令
		local a = JY.Person[pid]["轻功"] / 10
        hurt = hurt * a
	end 		
		
    --崆峒拳系弟子伤害
	if MPPD(pid) == 18 and yongquan(wugong) then
		local a = JY.Person[pid]["拳掌功夫"] / 3
		hurt = hurt * a
	end	

    --崆峒特系弟子伤害
	if MPPD(pid) == 18 and yongte(wugong) then
		local a = JY.Person[pid]["特殊兵器"] / 3
		hurt = hurt * a
	end	

    --崆峒暗系弟子伤害
	if MPPD(pid) == 18 and yongan(wugong) then
		local a = JY.Person[pid]["暗器技巧"] / 3
		hurt = hurt * a
	end	

    --弹指神通
	if wugong == 18 and (DT(pid, 57) or wglw1(pid, 18)) then
		local a = JY.Person[pid]["暗器技巧"] * 2
		hurt = hurt + a
	end	

    --辟邪剑法
	if PersonKF(pid,48) and JLSD(10,40,pid) then
		local a = JY.Person[pid]["轻功"]
		hurt = hurt * (a * 0.05) 
	end	

    if pid==0 and putong() == 9 then --血手以自身流血值加伤害
	    if WAR.LXZT[0]~=nil then
		    hurt = math.modf(hurt * (2+(WAR.LXZT[0]/20)))
	    end
    end
	
	if PersonKF(pid,191) and JLSD(10,50,pid) then --血手以自身流血值加伤害
	    if WAR.LXZT[pid]~=nil then
		    hurt = math.modf(hurt * (1.5+(WAR.LXZT[pid]/40)))
	    end
    end
	
    if wglw1(pid,63) and WAR.XDDF2==1 then
        if WAR.LXZT[pid]~=nil and  WAR.LXZT[pid]>0 then
	        local aa= WAR.LXZT[pid]
		    WAR.FXDS[eid]=WAR.FXDS[eid] or 0 + aa
	    elseif WAR.LXZT[eid]~=nil and  WAR.LXZT[eid]>0 then
	        local aa= WAR.LXZT[eid]
		    WAR.FXDS[eid]=WAR.FXDS[eid] or 0 + aa
	    else
	        WAR.FXDS[eid]=WAR.FXDS[eid] or 0 + 5
	    end
            WAR.XQFJ[eid]=WAR.XQFJ[eid] or 0 + 50
    end   
  
    if pid==0 and T4WXS(0) and WAR.SHITOUJIAN==1 and math.random(100)<=20 then --王小石剑法特效20%受伤10
	    AddPersonAttrib(eid, "受伤程度", 30)
    end
  
  	if DT(pid,72) and JX(pid) and WAR.DJJIAN == 1 and JLSD(10, 30, pid) then --田归农剑法特效20%流血
	    AddPersonAttrib(eid, "中毒程度", 30)
	end
  
    --梅超风攻击
    if WAR.MCF == 1 then
        if ZJ(pid) then
		    hurt = hurt * 1.5
	    else
		    hurt = hurt * 2
	    end
    end
  
    if hasTF(pid, 159) then
		JY.Person[eid]["中毒程度"] = JY.Person[eid]["中毒程度"] + 20
		if JY.Person[eid]["中毒程度"] > 100 then
			JY.Person[eid]["中毒程度"] = 100
		end
	end		 

    if wugong == 177 and (DT(pid, 27) or wglw1(pid,177)) then --葵花神针
	    AddPersonAttrib(eid, "受伤程度", 30)
	    AddPersonAttrib(eid, "中毒程度", 30)
    end
  
    if wugong == 21 and ((DT(pid, 643) or DT(pid, 644)) or wglw1(pid,21)) then --玄冥神掌
        AddPersonAttrib(eid, "中毒程度", 20)
    end  

    if MPPD(pid) == 8 and PersonGT(pid,95) and JLSD(10,60,pid) then
		AddPersonAttrib(eid,"中毒程度",20)
	end 	

    if DT(pid, 662) then
		WAR.YANGKANG = 1 
	end	

    if WAR.YANGKANG == 1 and DWPD() then --附加异常状态
	    local yk = 20 + math.modf(JY.Person[pid]["实战"] / 20)
	    if JLSD(10, 35, pid) and (WAR.ATKDOWN[eid] == nil or WAR.ATKDOWN[eid] <= 0) then
		    WAR.ATKDOWN[eid] = limitX(yk, 0, 50)
	    end
	    if JLSD(10, 35, pid) and (WAR.DEFDOWN[eid] == nil or WAR.DEFDOWN[eid] <= 0) then
		    WAR.DEFDOWN[eid] = limitX(yk, 0, 50)
	    end	
	    if JLSD(10, 30, pid) and (WAR.SPDDOWN[eid] == nil or WAR.SPDDOWN[eid] <= 0) then
		    WAR.SPDDOWN[eid] = limitX(yk, 0, 50)
	    end		
	    if JLSD(10, 25, pid) and (WAR.L_WNGZL[eid] == nil or WAR.L_WNGZL[eid] <= 0) then
		    WAR.L_WNGZL[eid] = limitX(yk, 0, 50)
	    end		
	    if JLSD(10, 25, pid) and (WAR.L_NOT_MOVE[eid] == nil or WAR.L_NOT_MOVE[eid] <= 0) then
		    WAR.L_NOT_MOVE[eid] = 1
	    end		
	    if JLSD(10, 15, pid) and (WAR.KHCM[eid] == nil or WAR.KHCM[eid] <= 0) then
		    WAR.KHCM[eid] = 2
	    end			
	    if JLSD(10, 15, pid) and (WAR.BZ[eid] == nil or WAR.BZ[eid] <= 0) then
		    WAR.BZ[eid] = 1
	    end	
		if JLSD(10, 15, pid) and (WAR.BZ[eid] == nil or WAR.BZ[eid] <= 0) then
		    WAR.NHH[eid] = 1
	    end
		if JLSD(10, 15, pid) and (WAR.BZ[eid] == nil or WAR.BZ[eid] <= 0) then
		    WAR.NBH[eid] = 1
	    end
		if JLSD(10, 15, pid) and (WAR.BZ[eid] == nil or WAR.BZ[eid] <= 0) then
		    WAR.LXZS[eid] = 1
	    end	
		if JLSD(10, 15, pid) and (WAR.BZ[eid] == nil or WAR.BZ[eid] <= 0) then
		    WAR.ZDNS[eid] = limitX(yk, 0, 50)
	    end
    end
  
    if pid == 0 and putong() == 13 and WAR.QJSF == 1 then
	    local ss = math.random(10)
	    if ss == 1 then
		    WAR.ATKDOWN[eid] = WAR.ATKDOWN[eid] or 0 + 30
	    elseif ss == 2 then
		    WAR.DEFDOWN[eid] = WAR.DEFDOWN[eid] or 0 + 30
	    elseif ss == 3 then
		    WAR.SPDDOWN[eid] = WAR.SPDDOWN[eid] or 0 + 30
	    elseif ss == 4 then
		    WAR.L_WNGZL[eid] = WAR.L_WNGZL[eid] or 0 + 30
	    elseif ss == 5 then
		    WAR.L_NOT_MOVE[eid] = 1
	    elseif ss == 6 then
		    WAR.KHCM[eid] = 2
	    elseif ss == 7 then
		    WAR.BZ[eid] = 1
	    elseif ss == 8 then
		    WAR.GUDUVICTIE[eid] = 2
	    elseif ss == 9 then
		    WAR.CONFUSE[eid] = WAR.CONFUSE[eid] or 0 + 50
	    elseif ss == 10 then
		    WAR.PEACE[eid] = WAR.PEACE[eid] or 0 + 30
	    end	
    end
  
	if PersonKF(eid,196) and WAR.ACT <= 2 then --暗香疏影反弹异常
	    local yk = 20 + math.modf(JY.Person[eid]["实战"] / 20)
	    if JLSD(10, 35, eid) and (WAR.ATKDOWN[pid] == nil or WAR.ATKDOWN[pid] <= 0) then
		    WAR.ATKDOWN[pid] = limitX(yk, 0, 50)
	    end
	    if JLSD(10, 35, eid) and (WAR.DEFDOWN[pid] == nil or WAR.DEFDOWN[pid] <= 0) then
		    WAR.DEFDOWN[pid] = limitX(yk, 0, 50)
	    end	
	    if JLSD(10, 30, eid) and (WAR.SPDDOWN[pid] == nil or WAR.SPDDOWN[pid] <= 0) then
		    WAR.SPDDOWN[pid] = limitX(yk, 0, 50)
	    end		
	    if JLSD(10, 25, eid) and (WAR.L_WNGZL[pid] == nil or WAR.L_WNGZL[pid] <= 0) then
		    WAR.L_WNGZL[pid] = limitX(yk, 0, 50)
	    end		
	    if JLSD(10, 25, eid) and (WAR.L_NOT_MOVE[pid] == nil or WAR.L_NOT_MOVE[pid] <= 0) then
		    WAR.L_NOT_MOVE[pid] = 1
	    end		
	    if JLSD(10, 15, eid) and (WAR.KHCM[pid] == nil or WAR.KHCM[pid] <= 0) then
		    WAR.KHCM[pid] = 2
	    end			
	    if JLSD(10, 15, eid) and (WAR.BZ[pid] == nil or WAR.BZ[pid] <= 0) then
		    WAR.BZ[pid] = 1
	    end			
    end
  
    if ((PersonKF(pid, 87) and (MPPD(pid) == 1 and MPDJ(pid) >= 2)) and (JLSD(25, 75, pid) or 
        ((DT(pid, 47) or DT(pid, 46))and JLSD(10, 50, pid))))  then
        if WAR.Person[emenyid][CC.TXDH] == -1 then
            WAR.Person[emenyid][CC.TXDH] = math.fmod(87, 10) + 85
        end
        if WAR.Person[emenyid][CC.TXWZ2] == nil then
            WAR.Person[emenyid][CC.TXWZ2] = "神木毒髓.摧脉毒心"
        else
            WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "神木毒髓.摧脉毒心"
        end
	    local YD=math.modf(JY.Person[eid]["中毒程度"]*mpdj/3)
        WAR.L_WNGZL[eid] = WAR.L_WNGZL[eid] or 0 + YD
	    WAR.POISON[eid] = WAR.POISON[eid] or 0 + YD
	end  
  
    if (DT(pid,2) and JX(pid) )  and (JLSD(25, 75, pid) or 
        (JLSD(10, 50, pid)))  then
        if WAR.Person[emenyid][CC.TXDH] == -1 then
            WAR.Person[emenyid][CC.TXDH] = math.fmod(87, 10) + 85
        end
        if WAR.Person[emenyid][CC.TXWZ2] == nil then
            WAR.Person[emenyid][CC.TXWZ2] = "神木毒王.海棠飘香"
        else
            WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "神木毒王.海棠飘香"
        end
	    local YD=math.modf(JY.Person[eid]["中毒程度"])
        WAR.L_WNGZL[eid] = WAR.L_WNGZL[eid] or 0 + YD
	    WAR.POISON[eid] = WAR.POISON[eid] or 0 + YD
	end  
  
    --白驼山蛤蟆功
	if MPPD(pid) == 8 and PersonGT(pid,95) and JLSD(10,60,pid) then
		if JY.Person[eid]["中毒程度"] == 100 then
			if WAR.MENG[eid] == nil then
		        WAR.MENG[eid] = 100
	        end
		end
	end		

    if wglw(pid,185) or (PersonGT(pid,185) and DT(pid,5)) or DT(pid,666) then
		if JLSD(10,40,pid) then
            for j = 0, WAR.PersonNum - 1 do 
			    if WAR.Person[j]["我方"] == false and WAR.Person[j]["死亡"] == false and j ~= WAR.CurID then
				    WAR.Person[j].Time = limitX(WAR.Person[j].Time-100,-100,200)
				    WAR.FXXS[WAR.Person[j]["人物编号"]] = 1 
				    if WAR.FXXS[WAR.Person[j]["人物编号"]] ~= nil then
					    WAR.FXXS[WAR.Person[j]["人物编号"]] = WAR.FXXS[WAR.Person[j]["人物编号"]] + math.random(10,20)
				    else
					    WAR.FXXS[WAR.Person[j]["人物编号"]] = math.random(10,20)
					end 	
				end
			end
		end
		if WAR.Person[emenyid][CC.TXWZ2] == nil then
		   WAR.Person[emenyid][CC.TXWZ2] = "武当九阳・发劲"
	    else
		   WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "武当九阳・发劲"
	    end	
	end 	

    if DT(pid,47) and JX(pid) and (JLSD(10,20 + math.modf(WAR.SPIRIT[pid]-100),pid) or ZYJ(pid)) and
	    WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
	    local d = math.modf((JY.Person[pid]["内力"] - JY.Person[eid]["内力"]) / 100)
	    local str=""
        if d < 30 then
            d = 30
        end
  	    WAR.L_WNGZL[eid] = limitX((WAR.L_WNGZL[eid]  or 0) + d, 0, 100)
	    local n=math.random(1,6)
	    if n==1 then
	        WAR.CYSH[eid] = limitX((WAR.CYSH[eid] or 0) + d, 0, 100);
	        WAR.ATKDOWN[eid] = limitX((WAR.ATKDOWN[eid] or 0) + d, 0, 100);
	        WAR.DEFDOWN[eid] = limitX((WAR.DEFDOWN[eid] or 0) + d, 0, 100)
	        str=".惊魂曲"
	    elseif n==2 then
	        WAR.PEACE[eid] = limitX((WAR.DEFDOWN[eid] or 0) + d, 0, 100)
	        WAR.KHG[eid] = limitX((WAR.KHG[eid] or 0) + d, 0, 50)
	        str=".安魂曲"
	    elseif n==3 then
	        JY.Person[eid]["内力"]=JY.Person[eid]["内力"]-500
	        WAR.AN[eid] = limitX((WAR.AN[eid] or 0) + d, 0, 50)
	        str=".洗魂曲"
        elseif n==4 then
	        WAR.MENG[eid] = limitX((WAR.MENG[eid] or 0) + d, 0, 100)
            str=".眠魂曲"
	    elseif n==5 then
	        WAR.LHFM[eid]=	limitX((WAR.LHFM[eid] or 0) + d, 0, 100)
	        WAR.CONFUSE[eid]=	limitX((WAR.CONFUSE[eid] or 0) + d, 0, 20)
	        str=".夺魂曲"
    else
	    WAR.BZ[eid]=1
	    WAR.L_NOT_MOVE[eid] = 1
	    WAR.GUDUVICTIE[eid] = 2
	    str=".镇魂曲"
    end
	    WAR.AZ=WAR.AZ+50
	    if WAR.Person[emenyid][CC.TXWZ2] == nil then
		   WAR.Person[emenyid][CC.TXWZ2] = "紧那罗.彼岸夜曲"..str
	    else
		   WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "紧那罗.彼岸夜曲"..str
	    end	
	       WAR.Person[emenyid][CC.TXDH] = 65
    end

    if WAR.PLDS == 1  and WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
 	    local d = math.modf((JY.Person[pid]["内力"] - JY.Person[eid]["内力"]) / 100)
        if d < 10 then
           d = 10
        end 
  	    WAR.MENG[eid] = limitX((WAR.MENG[eid] or 0) + d, 0, 100)
	    WAR.OYFSD[eid] = limitX((WAR.OYFSD[eid] or 0) + d, 0, 100);
    end
  
    if WAR.PLDS == 3 and WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
        local SN=math.modf(JY.Person[eid]["内力"]/200*sixi(pid,3)*0.01)
	    local SN2=SN*10
	    AddPersonAttrib(eid, "生命", -SN)
	    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0)+AddPersonAttrib(eid, "生命", -SN)
	    AddPersonAttrib(eid, "内力", -SN2)
	    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0)+AddPersonAttrib(eid, "内力", -SN2)
    end
  
    if ((wglw(pid,107) and PersonGT(pid,107)) or DT(pid,599)) and JLSD(10,50,pid) and
	    WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
	    local d = math.modf((JY.Person[pid]["内力"] - JY.Person[eid]["内力"]) / 100)
	    local str=""
            if d < 10 then
                d = 10
            end
	    local n=math.random(1,6)
	    if n==1 then
	        WAR.CYSH[eid] = limitX((WAR.CYSH[eid] or 0) + d, 0, 100);
	        WAR.ATKDOWN[eid] = limitX((WAR.ATKDOWN[eid] or 0) + d, 0, 100);
	        WAR.DEFDOWN[eid] = limitX((WAR.DEFDOWN[eid] or 0) + d, 0, 100)
	        str=".惊魂"
	    elseif n==2 then
	        WAR.PEACE[eid] = limitX((WAR.PEACE[eid] or 0) + d, 0, 100)
	        WAR.KHG[eid] = limitX((WAR.KHG[eid] or 0) + d, 0, 50)
	        str=".落魄"
	    elseif n==3 then
	        JY.Person[eid]["内力"]=JY.Person[eid]["内力"]-500
	        WAR.AN[eid] = limitX((WAR.AN[eid] or 0) + d, 0, 50)
	        str=".夺神"
       elseif n==4 then
	        WAR.MENG[eid] = limitX((WAR.MENG[eid] or 0) + d, 0, 100)
            str=".通灵"
	    elseif n==5 then
	        WAR.LHFM[eid]=	limitX((WAR.LHFM[eid] or 0) + d, 0, 100)
	        str=".灭精"
    else
	    WAR.BZ[eid]=1
	    WAR.L_NOT_MOVE[eid] = 1
	    WAR.GUDUVICTIE[eid] = 2
	    str=".无相音罡"
	end
	    if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "九阴奥义.鬼狱阴风"..str
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "鬼狱阴风"..str
	    end	
	        WAR.Person[emenyid][CC.TXDH] = 65
    end
  
    if ((wglw(pid,107) and PersonGT(pid,107)) or DT(pid,599)) and JLSD(10,50,pid) and
	    WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
	    local d = math.modf((JY.Person[pid]["内力"] - JY.Person[eid]["内力"]) / 100)
	    local str=""
            if d < 10 then
                d = 10
            end
	    local n=math.random(1,6)
	    if n==1 then
	        WAR.CYSH[eid] = limitX((WAR.CYSH[eid] or 0) + d, 0, 100);
	        WAR.ATKDOWN[eid] = limitX((WAR.ATKDOWN[eid] or 0) + d, 0, 100);
	        WAR.DEFDOWN[eid] = limitX((WAR.DEFDOWN[eid] or 0) + d, 0, 100)
	        str=".惊魂"
	    elseif n==2 then
	        WAR.PEACE[eid] = limitX((WAR.PEACE[eid] or 0) + d, 0, 100)
	        WAR.KHG[eid] = limitX((WAR.KHG[eid] or 0) + d, 0, 50)
	        str=".落魄"
	    elseif n==3 then
	        JY.Person[eid]["内力"]=JY.Person[eid]["内力"]-500
	        WAR.AN[eid] = limitX((WAR.AN[eid] or 0) + d, 0, 50)
	        str=".夺神"
        elseif n==4 then
	        WAR.MENG[eid] = limitX((WAR.MENG[eid] or 0) + d, 0, 100)
            str=".通灵"
	   elseif n==5 then
	        WAR.LHFM[eid]=	limitX((WAR.LHFM[eid] or 0) + d, 0, 100)
	        str=".灭精"
    else
	    WAR.BZ[eid]=1
	    WAR.L_NOT_MOVE[eid] = 1
	    WAR.GUDUVICTIE[eid] = 2
	    str=".无相音罡"
	end
	    if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "九阴奥义.鬼狱阴风"..str
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "鬼狱阴风"..str
	    end	
	        WAR.Person[emenyid][CC.TXDH] = 149
    end

    if (wglw(pid,592) or DT(pid,592)) and WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
	    local d = math.modf((JY.Person[pid]["内力"] - JY.Person[eid]["内力"]) / 100)
	    local str=""
        if d < 10 then
            d = 10
        end
	    local n=math.random(1,6)
	    if n==1 then
	        WAR.CYSH[eid] = limitX((WAR.CYSH[eid] or 0) + d, 0, 100);
	        WAR.ATKDOWN[eid] = limitX((WAR.ATKDOWN[eid] or 0) + d, 0, 100);
	        WAR.DEFDOWN[eid] = limitX((WAR.DEFDOWN[eid] or 0) + d, 0, 100)
	        str="・利剑无意"
	    elseif n==2 then
	        WAR.PEACE[eid] = limitX((WAR.PEACE[eid] or 0) + d, 0, 100)
	        WAR.KHG[eid] = limitX((WAR.KHG[eid] or 0) + d, 0, 50)
	        str="・软剑无常"
	    elseif n==3 then
	        JY.Person[eid]["内力"]=JY.Person[eid]["内力"]-500
	        WAR.AN[eid] = limitX((WAR.AN[eid] or 0) + d, 0, 50)
	        str="・重剑无锋"
        elseif n==4 then
	        WAR.MENG[eid] = limitX((WAR.MENG[eid] or 0) + d, 0, 100)
            str="・木剑无俦"
	    elseif n==5 then
	        WAR.LHFM[eid] = limitX((WAR.LHFM[eid] or 0) + d, 0, 100)
	        str="・无剑无招"
    else
	    WAR.BZ[eid]=1
	    WAR.L_NOT_MOVE[eid] = 1
	    WAR.GUDUVICTIE[eid] = 2
	    str="・无我之境"
	end
	    if WAR.Person[emenyid][CC.TXWZ1] == nil then
		    WAR.Person[emenyid][CC.TXWZ1] = "独孤剑意"..str
	    else
		    WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" .. "独孤剑意"..str
	    end	
	        WAR.Person[emenyid][CC.TXDH] = 149
    end

    if DT(pid,601) and JLSD(10,60,pid) and wugong==79 and
	    WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then --林朝英银铃
	    local d = math.modf((JY.Person[pid]["内力"] - JY.Person[eid]["内力"]) / 100)
	    local str=""
        if d < 10 then
            d = 10
        end
	    WAR.FXXS[eid]=1
	    WAR.FXDS[eid]= limitX((WAR.FXDS[eid] or 0) + d, 0, 50);
	    hurt = hurt + math.modf((JY.Person[eid]["内力最大值"] - JY.Person[eid]["内力"])*0.005*d)
	    local n=math.random(1,6)
	    if n==1 then
	        JY.Person[eid]["内力"]=JY.Person[eid]["内力"]-500
	        WAR.CYSH[eid] = limitX((WAR.CYSH[eid] or 0) + d, 0, 100);
	        str="・宫调"
	    elseif n==2 then
	        WAR.ATKDOWN[eid] = limitX((WAR.ATKDOWN[eid] or 0) + d, 0, 100);
	        WAR.DEFDOWN[eid] = limitX((WAR.DEFDOWN[eid] or 0) + d, 0, 100);
	        WAR.KHG[eid] = limitX((WAR.KHG[eid] or 0) + d*2, 0, 50)
	        str="・商调"
	    elseif n==3 then
	        WAR.AN[eid] = limitX((WAR.AN[eid] or 0) + d, 0, 50)
	        str="・角调"
        elseif n==4 then
	        WAR.MENG[eid] = limitX((WAR.MENG[eid] or 0) + d*2, 0, 100)
            str="・徵调"
	    elseif n==5 then
	        WAR.LHFM[eid]=	limitX((WAR.LHFM[eid] or 0) + d*2, 0, 100)
	        str="・羽调"
		else
			WAR.BZ[eid]=1
			WAR.L_NOT_MOVE[eid] = 1
			WAR.GUDUVICTIE[eid] = 2
			str="・昭君出塞"
		end
	    if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "清心金铃"..str
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "清心金铃"..str
	   end	
	        WAR.Person[emenyid][CC.TXDH] = 65
    end
  
  	if WAR.MKZS >0 and WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
	    local d = math.modf((JY.Person[pid]["内力"] - JY.Person[eid]["内力"]) / 100)
	    local str=""
        if d < 10 then
            d = 10
        end
  	    WAR.LXXS[eid] = 1
	    WAR.LXZT[eid] = limitX((WAR.LXZT[eid] or 0) + d, 0, 100)
	    WAR.FXXS[eid] = 1
	    WAR.FXDS[eid] = limitX((WAR.FXDS[eid] or 0) + d, 0, 100)
	    if WAR.MKZS==1 then
	        JY.Person[eid]["生命"] = 0 
  	        if WAR.UNDEAD[eid] == nil then
  		        WAR.UNDEAD[eid] = 50
  		        WAR.Person[emenyid][CC.TXDH] = 119
	        end
	    elseif  WAR.MKZS==2 then
	            WAR.HOTXS[eid]=1
	            WAR.HOT[eid]=WAR.HOT[eid] or 0 + d
	            WAR.ICEXS[eid]=1
	            WAR.ICE[eid]=WAR.ICE[eid] or 0 + d
	    elseif WAR.MKZS==3 then
                WAR.MENG[eid]=WAR.MENG[eid] or 0 + 100
	else
        WAR.BZ[eid]=1
        end	
	end
  
    if wglw1(pid,63) and WAR.XDDF2 == 2 then
        if WAR.XQFJ[eid]~=nil and  WAR.XQFJ[eid]>0 then
	        local aa= WAR.XQFJ[eid]
            WAR.HOTXS[eid]=1
            WAR.HOT[eid]=WAR.HOT[eid] or 0 + aa
            if WAR.HOT[eid]>= 50 then
                WAR.HOT[eid] = 50 
            end	 
	    end
    end
  
    if PersonGTJL(pid, 124, WAR.NGJL) and MPPD(pid) == 14 and MPDJ(pid) > 1 and
	    WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
	    local d = math.modf((JY.Person[pid]["内力"] - JY.Person[eid]["内力"]) / 300)
	    local str=""
        if d < 10 then
            d = 10
        end
	    if WAR.ICE[eid]~=nil and WAR.ICE[eid]>0 then
	        WAR.CHXS[eid] = 1
	        WAR.CHZ[eid] = limitX((WAR.CHZ[eid] or 0) + d, 0, 50)
	    end
  	        WAR.ICEXS[eid] = 1
	        WAR.ICE[eid] = limitX((WAR.ICE[eid] or 0) + d, 0, 50)
	    if JLSD(10,30+MPDJ(pid)*5,pid) then
	        WAR.YHZJ[eid]=WAR.YHZJ[eid] or 0 + 1
	        str=".寒毒封脉"
	    end
	    if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "意寒真诀"..str
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "意寒真诀"..str
	    end	
	        WAR.Person[emenyid][CC.TXDH] = 31
    end
   
    if (DT(pid,615) and JLSD(20,50,pid)) and DWPD() and WAR.Person[emenyid]["死亡"] == false then ----沼跃鱼：罗汉堂降魔刀法
        local SN=0
	    if WAR.LQZ[eid]~=nil and WAR.LQZ[eid]>=0 then
	        SN=WAR.LQZ[eid]
	    end
	        WAR.XMPM=WAR.XMPM+SN
	    if JLSD(10,60,pid) and WAR.LQZ[eid]~=nil and WAR.LQZ[eid]>=0 then
	        local aa=WAR.LQZ[eid] or 0
	        WAR.LQZ[eid]=math.modf(WAR.LQZ[eid]/2)
	        WAR.KMWD2=math.modf(WAR.KMWD2+aa)
	    end
	    WAR.GTSHAQI=WAR.KMWD2
	    WAR.GTPID2=pid
	    local cc=math.modf(WAR.KMWD2*10)
	    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) +  AddPersonAttrib(eid, "内力",  - cc)
	    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) +	AddPersonAttrib(eid, "生命", -WAR.KMWD2);
	    if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "韦陀镇魂・嗔恶退治"
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "镇魂・嗔恶退治"
	    end	
	        WAR.Person[emenyid][CC.TXDH] = 70
	end		
	
	if MPPD(pid)==5 and MPDJ(pid)>1 and DWPD() then
		if (wugong == 139 and JY.Person[pid]["武器"] == 365 and JLSD(10,70,pid)) or ((wugong == 139) and JY.Person[pid]["武器"] == 367) then
			local SN=0
			local str = ""
			WAR.GTSHAQI=WAR.KMWD2
			WAR.GTPID2=pid
			if WAR.LQZ[eid]~=nil and WAR.LQZ[eid]>=0 then
				SN=WAR.LQZ[eid]
				WAR.XMPM=WAR.XMPM+(SN*1.5)
				local aa=WAR.LQZ[eid] or 0
				WAR.LQZ[eid]=math.modf(WAR.LQZ[eid]/2)
				WAR.KMWD2=math.modf(WAR.KMWD2+aa)
				str = "・破执降魔"
			end
			local cc=math.modf(WAR.KMWD2*10)
			WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) +  AddPersonAttrib(eid, "内力",  - cc)
			WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) +	AddPersonAttrib(eid, "生命", - WAR.KMWD2);
			if WAR.Person[emenyid][CC.TXWZ2] == nil then
				WAR.Person[emenyid][CC.TXWZ2] = "韦陀镇魂・嗔恶退治"..str
			else
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "镇魂・嗔恶退治"..str
			end	
				WAR.Person[emenyid][CC.TXDH] = 70
		elseif (wugong == 139 and PersonGTJL(pid, 96, WAR.NGJL))  then
			local SN=0
			local str = ""
			if WAR.LQZ[eid]~=nil and WAR.LQZ[eid]>=0 then
				SN=WAR.LQZ[eid]
			end
				WAR.XMPM=WAR.XMPM+SN
			if JLSD(10,60,pid) and WAR.LQZ[eid]~=nil and WAR.LQZ[eid]>=0 then
				local aa=WAR.LQZ[eid] or 0
				WAR.LQZ[eid]=math.modf(WAR.LQZ[eid]/2)
				WAR.KMWD2=math.modf(WAR.KMWD2+aa)
				str = "・破执降魔"
			end
			WAR.GTSHAQI=WAR.KMWD2
			WAR.GTPID2=pid
			local cc=math.modf(WAR.KMWD2*10)
			WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) +  AddPersonAttrib(eid, "内力",  - cc)
			WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) +	AddPersonAttrib(eid, "生命", -WAR.KMWD2);
			if WAR.Person[emenyid][CC.TXWZ2] == nil then
				WAR.Person[emenyid][CC.TXWZ2] = "韦陀镇魂・嗔恶退治"..str
			else
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "镇魂・嗔恶退治"..str
			end	
				WAR.Person[emenyid][CC.TXDH] = 70
		end		
    end
  
    if (MPPD(pid) == 5 and PersonGT(pid, 96) ) and 
	    yongte(wugong) and WAR.BJ==1 and DWPD() then --沼跃鱼：罗汉堂棍法
	    local SN=math.modf(JY.Person[pid]["内力"]/500)
	    local SN2=MPDJ(pid)+5
	    if JY.Person[pid]["武器"] == 50 then----沼跃鱼：伏魔杵
	        SN2=SN2+2
	    end
	    hurt=math.modf(hurt*1.25)
        WAR.KMWD2=math.modf(hurt*0.05*SN2)
	    hurt=hurt-WAR.KMWD2
	    if hurt<=0 then
	        hurt=1
	    end
	    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) +	AddPersonAttrib(eid, "生命", -WAR.KMWD2);
	    WAR.SZWH[eid]=WAR.SZWH[eid] or 0 + SN
	    if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "韦陀镇魂・雷霆棍击"
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "镇魂・雷霆棍击"
	    end	
	        WAR.Person[emenyid][CC.TXDH] = 45
	end
  
	if WAR.XMSSZ == 1 then
		local aa = math.modf(0 + math.abs((JY.Person[pid]["品德"] - 50) / 2))
		if aa < 10 then aa = 10 end
		AddPersonAttrib(eid, "受伤程度", aa)
		if WAR.FMZZ[eid]~=nil and WAR.FMZZ[eid]>0 then
		    WAR.MENG[eid]=30
		    WAR.CYSH[eid]=30
		    AddPersonAttrib(eid, "受伤程度", 20)
		    if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+".. "业障缠身"
			else
				WAR.Person[emenyid][CC.TXWZ2] = "业障缠身"
			end
			WAR.FMZZ[eid]=0	
	    end
		if WAR.FMZZ[eid]==nil and JLSD(10,30,pid) then
			WAR.FMZZ[eid] = WAR.FMZZ[eid] or 0 + 1
		end	
	end

	if WAR.XMSSZ == 2 then
		if WAR.DLYZ[eid]~=nil and WAR.DLYZ[eid]>0 then
            dng=0
		    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -500)
		    if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "多罗迦叶"
			else
				WAR.Person[emenyid][CC.TXWZ2] = "多罗迦叶"
			end
			    WAR.DLYZ[eid]=0
	        end
		if WAR.DLYZ[eid]==nil and JLSD(10,30,pid) then
			WAR.DLYZ[eid] = WAR.DLYZ[eid] or 0 + 1
		end	
	end	
	
	if WAR.XMSSZ == 3 then
		local aa=math.modf((170 - WAR.SPIRIT[eid])*25)
		WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) +  AddPersonAttrib(eid, "内力", - aa)
	end	
  	if wugong == 140 and WAR.YFDLW == 2 then
		local aa=WAR.ICE[eid] or 0
		local bb=aa*2
		if WAR.MENG[eid] == nil then
		   WAR.MENG[eid] = 20
		end
		WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) +  AddPersonAttrib(eid, "内力", - aa)
		if WAR.YHZJ[eid]~=nil and WAR.YHZJ[eid]>0 then
			if WAR.MENG[eid] == nil then
				WAR.MENG[eid] = 40
			end
			WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", - bb)
		end
	end	
	
	if wugong == 140 and (wglw1(pid,140) or DT(pid,558)) and WAR.LQZ[pid] == 100 then 
		WAR.YHZJ[eid]=WAR.YHZJ[eid] or 0 + 1
	end
	
	if	wugong == 140 and  WAR.HSYFD == 1 then
		WAR.YHZJ[eid]=WAR.YHZJ[eid] or 0 + 1
    end
  
    if T9ZY(pid) and WAR.ZYQT==1 then --沼跃鱼：赵云单骑
	    local SN2=WAR.ZYSP
        WAR.KMWD2=math.modf(hurt*0.05*SN2)
	    hurt=hurt-WAR.KMWD2
	    if hurt<=0 then
	        hurt=1
	    end
	    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) +	AddPersonAttrib(eid, "生命", -WAR.KMWD2);
	end
  
    if MPPD(pid) == 4 then
		if WAR.WDQF1 == 1 and WAR.ACT == 1 then --沼跃鱼：武当太奥拳法
			local SN=math.modf(JY.Person[pid]["内力"]/500)
			WAR.CHXS[eid]=1
			WAR.CHZ[eid] =WAR.CHZ[eid] or 0 + SN
			WAR.Person[emenyid][CC.TXDH] = 42
		end
		if WAR.WDQF2 == 1 and WAR.ACT > 1 then --沼跃鱼：武当太奥拳法
			local SN2=MPDJ(pid)+5
			WAR.FXXS[eid]= 1
			WAR.FXDS[eid]=WAR.FXDS[eid] or 0 +SN2*2*(WAR.ACT-1)
			WAR.Person[emenyid][CC.TXDH] = 41
		end
		if WAR.WDJF1 == 1 then
			WAR.WDWJJ[eid] = (WAR.WDWJJ[pid] or 0) + 1
			WAR.Person[emenyid][CC.TXDH] = 41
		end	
	end
	
	if WAR.WDWJJ[pid] ~= nil then
		if WAR.LQZ[pid] ~= nil and WAR.LQZ[pid] >= 100 then
			WAR.WDWJJ[pid] = nil
		else
			hurt = math.modf(hurt/(WAR.WDWJJ[pid] + 1))
		end
	end	
	
    if (PersonGTJL(pid, 121, WAR.NGJL) and MPPD(pid)==3) or DT(pid,601) and
        WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then ----沼跃鱼：玉女清心诀
        local SN=0
	    local str="・娉婷秀雅"
	    if WAR.LQZ[eid]~=nil and WAR.LQZ[eid]>=0 then
	        SN=WAR.LQZ[eid]*5
	    end
	    WAR.GTSHAQI=SN
	    if JLSD(10,40,pid) and WAR.LQZ[eid]~=nil and WAR.LQZ[eid]>=0 and not (wglw(pid,121) or DT(pid,59) or DT(pid,601)) then
	        if WAR.LQZ[eid]==100 then
	           WAR.LQZ[eid]=0
	        else
	           WAR.LQZ[eid]=math.modf(WAR.LQZ[eid]/2)
	           str="・美目盼兮"
	        end
	        elseif wglw(pid,121) or DT(pid,59) or DT(pid,601) then
	           WAR.MENG[eid]=WAR.MENG[eid] or 0 + SN
	           str="・媚眼如丝"
	        else
	    end
	    if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "玉女清心诀"..str
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "玉女清心诀"..str
	    end	
	        WAR.Person[emenyid][CC.TXDH] = 89
    end
  
	if (DT(pid,615) and JLSD(20,50,pid)) and DWPD() then --沼跃鱼：罗汉堂燃木刀法
	    local SN=math.modf(JY.Person[eid]["内力"]/30)
	    local SN2=math.modf(SN*10)
	    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - SN2;
  	    AddPersonAttrib(eid, "内力", -SN2);
	    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) - SN;
	    AddPersonAttrib(eid, "生命", -SN);
	    WAR.HOTXS[eid]=1
	    WAR.HOT[eid] = limitX((WAR.HOT[eid] or 0) + SN, 0, 50)
		if JLSD(10,30,eid) then
			local aa = math.modf((WAR.HOT[eid] or 0)/10)
			WAR.Person[emenyid]["体力点数"] = (WAR.Person[emenyid]["体力点数"] or 0) - aa;
			AddPersonAttrib(eid, "体力", -aa)
		end	
	    if WAR.Person[emenyid][CC.TXWZ3] == nil then
		    WAR.Person[emenyid][CC.TXWZ3] = "韦陀镇魂・火宅佛狱"
	    else
		    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "镇魂・火宅佛狱"
	    end	
	        WAR.Person[emenyid][CC.TXDH] = 71
	end		
    
	if MPPD(pid) == 5 and DWPD() then
		if ((JY.Person[pid]["武器"] == 366 and wugong == 65 and JLSD(10,70,pid)) or ((wugong == 65) and JY.Person[pid]["武器"] == 367)) then --沼跃鱼：罗汉堂燃木刀法
			local SN=math.modf(JY.Person[eid]["内力"]/25)
			local SN2=math.modf(SN*10)
			WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - SN2;
			AddPersonAttrib(eid, "内力", -SN2);
			WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) - SN;
			AddPersonAttrib(eid, "生命", -SN);
			WAR.HOTXS[eid]=1
			WAR.HOT[eid] = limitX((WAR.HOT[eid] or 0) + SN, 0, 50)
			if JLSD(10,30,eid) then
			local aa = math.modf((WAR.HOT[eid] or 0)/10)
				WAR.Person[emenyid]["体力点数"] = (WAR.Person[emenyid]["体力点数"] or 0) - aa;
				AddPersonAttrib(eid, "体力", -aa)
			end	
			if WAR.Person[emenyid][CC.TXWZ3] == nil then
				WAR.Person[emenyid][CC.TXWZ3] = "韦陀镇魂・火宅佛狱"
			else
				WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "镇魂・火宅佛狱"
			end	
				WAR.Person[emenyid][CC.TXDH] = 71
		elseif wugong == 65 and  PersonGTJL(pid, 96, WAR.NGJL) and DWPD() then
			local SN=math.modf(JY.Person[eid]["内力"]/30)
			local SN2=math.modf(SN*10)
			WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - SN2;
			AddPersonAttrib(eid, "内力", -SN2);
			WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) - SN;
			AddPersonAttrib(eid, "生命", -SN);
			WAR.HOTXS[eid]=1
			WAR.HOT[eid] = limitX((WAR.HOT[eid] or 0) + SN, 0, 50)
			if JLSD(10,30,eid) then
			local aa = math.modf((WAR.HOT[eid] or 0)/10)
				WAR.Person[emenyid]["体力点数"] = (WAR.Person[emenyid]["体力点数"] or 0) - aa;
				AddPersonAttrib(eid, "体力", -aa)
			end	
			if WAR.Person[emenyid][CC.TXWZ3] == nil then
				WAR.Person[emenyid][CC.TXWZ3] = "韦陀镇魂・火宅佛狱"
			else
				WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "镇魂・火宅佛狱"
			end	
				WAR.Person[emenyid][CC.TXDH] = 71
		end		
	end
	
	if (DT(pid,615) and JLSD(20,50,pid)) and WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
		WAR.HDGX[eid] = (WAR.HDGX[eid] or 0) + 1 
		WAR.NHH[eid] = 1
		if WAR.Person[emenyid][CC.TXWZ3] == nil then
		    WAR.Person[emenyid][CC.TXWZ3] = "韦陀镇魂・业力火莲"
	    else
		    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "镇魂・业力火莲"
	    end	
	        WAR.Person[emenyid][CC.TXDH] = 71
	end	
	
	if MPPD(pid) == 5 and DWPD() then
		if ((JY.Person[pid]["武器"] == 366 and wugong == 65) or ((wugong == 65) and JY.Person[pid]["武器"] == 367)) then
			WAR.HDGX[eid] = (WAR.HDGX[eid] or 0) + 1 
			WAR.NHH[eid] = 1
			if WAR.Person[emenyid][CC.TXWZ3] == nil then
				WAR.Person[emenyid][CC.TXWZ3] = "韦陀镇魂・业力火莲"
			else
				WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "镇魂・业力火莲"
			end	
	        WAR.Person[emenyid][CC.TXDH] = 71
		elseif wugong == 65 and PersonGTJL(pid, 96, WAR.NGJL) then
			WAR.HDGX[eid] = (WAR.HDGX[eid] or 0) + 1 
			WAR.NHH[eid] = 1
			if WAR.Person[emenyid][CC.TXWZ3] == nil then
				WAR.Person[emenyid][CC.TXWZ3] = "韦陀镇魂・业力火莲"
			else
				WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "镇魂・业力火莲"
			end	
	        WAR.Person[emenyid][CC.TXDH] = 71
		end	
	end
	
	
	if T9ZY(pid) and WAR.ZYQT==3 and DWPD() then --沼跃鱼：赵云子龙朱雀
	    local SN=math.modf(JY.Person[eid]["内力"]/100)
	    local SN2=SN*10
	    AddPersonAttrib(eid, "生命", -SN);
  	    AddPersonAttrib(eid, "内力", -SN2);
	    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - SN2;
	    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) - SN;
	    WAR.HOTXS[eid]=1
	    WAR.HOT[eid] = limitX((WAR.HOT[eid] or 0) + SN, 0, 100)
	end
  
 	if T9ZY(pid) and WAR.ZYQT==5 then --沼跃鱼：赵云端坐霜天
	    local SN=math.modf(JY.Person[pid]["内力"]/100)
	    local SN2=SN*10
	    WAR.ICEXS[eid]=1
	    WAR.ICE[eid] = limitX((WAR.ICE[eid] or 0) + SN, 0, 100)
	    WAR.PEACE[eid] = WAR.PEACE[eid] or 0 + SN
	    AddPersonAttrib(pid, "生命", SN);
  	    AddPersonAttrib(pid, "内力", SN2);
	    WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + SN2;
	    WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + SN;
	end

	--昆仑门人普通主运特效
	if MPPD(pid) == 19 and PersonGT(pid,204) then
		local mpdj = math.modf(MPDJ(pid)*5)
		if yongjian(wugong) and JLSD(10,30+mpdj,pid) then
			WAR.KLJTX[eid] = 1
		end
		if yongdao(wugong) and JLSD(10,30+mpdj,pid) then
			hurt = hurt + (JY.Person[pid]["防御力"] or 0)
			if WAR.Person[emenyid].Time >= 0 then
				hurt = hurt + WAR.Person[emenyid].Time
			end
			WAR.Person[WAR.CurID][CC.TXWZ2] = "昆仑刀势・巍峨雄峰"
		end
	end	
	if WAR.KLJTX[pid] == 1 and (math.random(10) > 6 or WAR.NGJL > 0) then
		hurt = hurt*0.8
		AddPersonAttrib(pid,"受伤程度",15)
		if WAR.BJ == 1 and math.random(10) > 3 then
			WAR.ZDNS[pid] = (WAR.ZDNS[pid] or 0) + 15
		end
		if WAR.NGJL > 0 then
			WAR.KLJTX[pid] = nil
		end	
	end	
	if PersonKF(eid,204) and JLSD(10,50,eid) then
		local aa = math.abs(WAR.Person[emenyid].Time)
		if PersonGT(eid,204) then
			WAR.SPIRIT[eid] = (WAR.SPIRIT[eid] or 0) + math.modf(aa/400)
		else
			WAR.SPIRIT[eid] = (WAR.SPIRIT[eid] or 0) + math.modf(aa/500)
		end
	end	
	if MPPD(eid) == 19 and PersonKF(eid,205) then
		if JLSD(10,60,eid) then
			WAR.YLSZ[eid] = (WAR.YLSZ[eid] or 0) + 1
			if WAR.YLSZ[eid] > 15 then WAR.YLSZ[eid] = 15 end
			if WAR.Person[emenyid][CC.TXWZ1] == nil then
				WAR.Person[emenyid][CC.TXWZ1] = "云龙三折"	
			else
				WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+".."云龙三折"	
			end
		end	
		if WAR.KLDG[eid] ~= nil then
			AddPersonAttrib(pid,"内力",-WAR.KLDG[eid])
			if WAR.KLDG[eid] > 3000 and math.random(10) > 6 then
				WAR.KLDG[eid] = nil
			end
			if WAR.Person[emenyid][CC.TXWZ1] == nil then
				WAR.Person[emenyid][CC.TXWZ1] = "苍龙探爪"	
			else
				WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+".."苍龙探爪"	
			end
		end
	end	
	--昆仑门人刀剑阵效果
	local kldj = 0
	if MPPD(pid) == 19 then
		kldj = MPDJ(pid)*5
	end	
	if WAR.KLJZ > 0 then	
		local str = ""
		if WAR.KLJZ == 1 then--顺逆两仪阵
			if WAR.KLJZWF[pid] == 1 and yongjian(wugong) then
				hurt = hurt + math.modf(sixi(pid,3) * 1.5)
				WAR.SPIRIT[pid] = (WAR.SPIRIT[pid] or 0 ) + math.random(5)
				str = "两仪顺逆・剑顺天性"
			elseif WAR.KLJZWF[pid] == 1 and yongdao(wugong) then
				hurt = hurt + math.modf(sixi(pid,2) * 1.5)
				if JLSD(10,20+kldj,pid) then
					WAR.SZWH[eid] = (WAR.SZWH[eid] or 0) + 5
				end
				str = "两仪顺逆・刀逆人道"
			end	
			if WAR.KLJZDF[pid] == 1 then
				local aa = math.modf((sixi(pid,2) + sixi(pid,3))/5)
				if aa > 100 then aa = 100 end
				for kl = 0, WAR.PersonNum-1 do
					local klid = WAR.Person[kl]["人物编号"]
					if WAR.Person[kl]["死亡"] == false and WAR.Person[kl]["我方"] == WAR.Person[WAR.CurID]["我方"] then
						AddPersonAttrib(klid,"生命",-aa)
					end
				end
				str = "两仪颠乱・阴阳逆冲"
			end	
		end
		if WAR.KLJZ == 2 then--疾风惊蛰阵
			if WAR.KLJZWF[pid] == 2 and (yongjian(wugong) or yongdao(wugong)) and JLSD(10,35+kldj,pid) then
				WAR.XZZ = 1
			end	
			if WAR.KLJZWF[eid] == 2 and WAR.Person[emenyid].Time < 0 and JLSD(10,45+kldj,eid) then
				WAR.Person[emenyid].Time = 0
				str = "疾风惊蛰・穿林打叶"
			end
			if WAR.KLJZDF[eid] == 2 and (yongjian(wugong) or yongdao(wugong)) and JLSD(10,35+kldj,pid) then
				WAR.KMSHJQ[eid] = (WAR.KMSHJQ[eid] or 0) + 2
				str = "疾风惊蛰・雷破无生"
			end
		end	
		if WAR.KLJZ == 3 then--天剑绝刀阵
			if WAR.KLJZWF[eid] == 3 then
				if WAR.NGHT > 0 then
					dng = dng + math.modf(sixi(eid,2)+sixi(eid,3))
					hurt = hurt - math.modf((ang or 0)+sixi(eid,2)+sixi(eid,3))
				else
					dng = dng + 2000
				end
				str = "天剑绝刀・双绝如圣"
			end
			if WAR.KLJZDF[pid] == 3 and (yongjian(wugong) or yongdao(wugong)) and math.random(10) > 5 then	
				ang = ang - math.modf((sixi(pid,2)+sixi(pid,3))*5)
				hurt = hurt - math.modf((sixi(pid,2)+sixi(pid,3))*3)
				str = "天剑绝刀・断刃残锋"
			end		
		end
		if WAR.KLJZ == 4 then--霜炎九重阵
			if WAR.KLJZWF[pid] == 4 and JLSD(10,35+kldj,pid) then
				if yongjian(wugong) then
					WAR.ICE[eid] = (WAR.ICE[eid] or 0) + 10
					if sixi(pid,2) > sixi(eid,2) then
						WAR.YHZJ[eid] = 1
					end	
				end
				if yongdao(wugong) then
					WAR.HOT[eid] = (WAR.HOT[eid] or 0) + 10
					if sixi(pid,3) > sixi(eid,3) then
						WAR.HDGX[eid] = 1
					end	
				end
				str = "霜炎九重・狱火冥霜"
			end
			if WAR.KLJZDF[pid] == 4 then
				if WAR.HOT[pid] ~= nil and WAR.HOT[pid] > 20 and math.random(10) > 5 then
					WAR.NHH[pid] = 1
					str = "霜炎九重・火途破命"
				end
				if WAR.ICE[pid] ~= nil and WAR.ICE[pid] > 20 and math.random(10) > 5 then
					WAR.NBH[pid] = 1
					str = "霜炎九重・死霜魂销"
				end
			end	
		end	
		if WAR.KLJZ == 5 then --佛业双身阵
			if WAR.SPIRIT[eid] ~= nil and WAR.SPIRIT[eid] > 120 then
				if KLJZWF[eid] == 5 then
					hurt = math.modf(hurt * 0.8)
					if JLSD(10,35+kldj,eid) then
						JY.Person[eid]["受伤程度"] = 0
						JY.Person[eid]["中毒程度"] = 0
					end
					str = "佛业双身・初佛明性"
				end
				if KLJZDF[eid] == 5 then
					hurt = math.modf(hurt*1.2)
				end
			elseif WAR.SPIRIT[eid] ~= nil and WAR.SPIRIT[eid] <= 120 then
				if KLJZWF[eid] == 5 then
					hurt = math.modf(hurt * 0.8)
				end
				if KLJZDF[eid] == 5 then
					hurt = math.modf(hurt*1.2)
					if WAR.ACT == 1 then
						AddPersonAttrib(eid,"生命",(WAR.LQZ[eid] or 0))
					elseif WAR.ACT > 1 and math.random(10) > 6 then
						WAR.LQZ[eid] = 0
						WAR.XSKJ[eid] = 20
					end
					str = "佛业双身・业我无间"	
				end
			end
		end
		if WAR.Person[emenyid][CC.TXWZ3] == nil then
			WAR.Person[emenyid][CC.TXWZ3] = str	
		else
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+"..str	
		end	
	end

    --峨眉使者限定 
    if (GX(pid) and JX(pid)) and JLSD(10,60,pid) and WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
		local SN=math.modf(JY.Person[eid]["内力"]/30)
		local SN2=math.modf(SN*10)
		WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - SN2;
		AddPersonAttrib(eid, "内力", -SN2);
		WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) - SN;
		AddPersonAttrib(eid, "生命", -SN);
		WAR.HOTXS[eid]=1
		WAR.HOT[eid] = limitX((WAR.HOT[eid] or 0) + SN, 0, 50)
		WAR.ICEXS[eid]=1
		WAR.ICE[eid] = limitX((WAR.ICE[eid] or 0) + SN, 0, 50)
		if WAR.Person[emenyid][CC.TXWZ3] == nil then
			WAR.Person[emenyid][CC.TXWZ3] = "飘雪穿云掌"
		else
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "飘雪穿云掌"
		end	
	elseif ((MPPD(pid) == 17 and MPDJ(pid) >= 3)) and PersonGT(pid,153) and WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"]  then
		if sixi(pid,1) >= 300 and (sixi(pid,1) + sixi(pid,2)) >= 450 then
			if wugong == 130 or (yongquan(wugong) and JLSD(10,60,pid)) then
				local SN=math.modf(JY.Person[eid]["内力"]/30)
				local SN2=math.modf(SN*10)
				WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - SN2;
				AddPersonAttrib(eid, "内力", -SN2);
				WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) - (SN-50);
				AddPersonAttrib(eid, "生命", -SN);
				WAR.HOTXS[eid]=1
				WAR.HOT[eid] = limitX((WAR.HOT[eid] or 0) + SN, 0, 50)
				WAR.ICEXS[eid]=1
				WAR.ICE[eid] = limitX((WAR.ICE[eid] or 0) + SN, 0, 50)
				if WAR.Person[emenyid][CC.TXWZ3] == nil then
					WAR.Person[emenyid][CC.TXWZ3] = "飘雪穿云掌"
				else
					WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "飘雪穿云掌"
				end
			elseif not yongquan(wugong) and JLSD(10,35,pid) then
				local SN=math.modf(JY.Person[eid]["内力"]/30)
				local SN2=math.modf(SN*10)
				if SN2 > 1500 then SN2 = 1500 end
				WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - SN2;
				AddPersonAttrib(eid, "内力", -SN2);
				WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) - (SN-100);
				AddPersonAttrib(eid, "生命", -SN);
				WAR.HOTXS[eid]=1
				WAR.HOT[eid] = limitX((WAR.HOT[eid] or 0) + SN, 0, 50)
				WAR.ICEXS[eid]=1
				WAR.ICE[eid] = limitX((WAR.ICE[eid] or 0) + SN, 0, 50)
				if WAR.Person[emenyid][CC.TXWZ3] == nil then
					WAR.Person[emenyid][CC.TXWZ3] = "飘雪穿云掌"
				else
					WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "飘雪穿云掌"
				end
			end
		end	
	end
	
	if ((MPPD(pid) == 17 and MPDJ(pid) >= 3) and JLSD(10,40,pid) and PersonGT(pid,153) and yongjian(wugong)) 
		or ((GX(pid) and JX(pid)) and JLSD(10,60,pid)) then
		local aa = JY.Person[pid]["轻功"]
		local bb = JY.Person[eid]["轻功"]
		local cc = math.ceil((aa - bb)/10)
		if cc < 5 then cc = 5 end
		WAR.LXXS[eid]=1
		WAR.LXZT[eid] = limitX((WAR.LXZT[eid] or 0) + cc, 0, 50)
		local dd = WAR.LXZT[eid]
		AddPersonAttrib(eid, "受伤程度", dd)
		if WAR.Person[emenyid][CC.TXWZ2] == nil then
			WAR.Person[emenyid][CC.TXWZ2] = "回风扶柳剑"
		else
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "回风扶柳剑"
		end
	end	
	
	if ((MPPD(pid) == 17 and MPDJ(pid) >= 3) and JLSD(10,40,pid) and PersonGT(pid,153) and yongquan(wugong)) 
		or ((GX(pid) and JX(pid)) and JLSD(10,60,pid)) then
		WAR.ATKDOWN[eid] = limitX((WAR.ATKDOWN[eid] or 0) + 15, 0, 50)
		if WAR.EMQF1[eid] == nil then
			WAR.EMQF1[eid] = 1
		end
		if WAR.Person[emenyid][CC.TXWZ2] == nil then
			WAR.Person[emenyid][CC.TXWZ2] = "截手九式"
		else
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "截手九式"
		end
	end
		
	if ((MPPD(pid) == 17 and MPDJ(pid) >= 3) and PersonGT(pid,153) and yongquan(wugong)) or ((GX(pid) and JX(pid))) then
		if WAR.ACT > 2 and GX(pid) and JLSD(10,60,pid) then
			dng = 0
			WAR.EMQF2 = 1
			if WAR.Person[emenyid][CC.TXWZ3] == nil then
			WAR.Person[emenyid][CC.TXWZ3] = "佛光普照"
			else
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "佛光普照"
			end
		elseif (wugong == 130 or JLSD(10,40,pid)) and WAR.ACT > 2 then
			dng = 0
			WAR.EMQF2 = 1
			if WAR.ACT > 4 and JLSD(10,25,pid) then
				WAR.ACT = 10
			end	
			if WAR.Person[emenyid][CC.TXWZ3] == nil then
			WAR.Person[emenyid][CC.TXWZ3] = "佛光普照"
			else
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "佛光普照"
			end
		end
	end	
    		
	
	if ((MPPD(pid) == 17 and MPDJ(pid) >= 3) and JLSD(10,40,pid) and PersonGT(pid,153)) or ((GX(pid) and JX(pid)) and JLSD(10,60,pid)) then --峨眉使者限定
        for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - 150
			end
		end		
		if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
      	    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."+".."玉女丹青・索女掸尘"
        else
      	    WAR.Person[emenyid][CC.TXWZ3] = "玉女丹青・索女掸尘"
        end	   
	end 	

    if ((MPPD(pid) == 17 and MPDJ(pid) >= 4) or (GX(pid) and JX(pid))) and JLSD(10,45,pid) and DWPD() then  --峨眉祖师限定
		WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -800)
	    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -2000)
	    if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
            WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .."一树开五花・五花八叶扶"
        else
          	WAR.Person[emenyid][CC.TXWZ3] = "一树开五花・五花八叶扶"
        end	
    end 

    if MPPD(pid) == 18 and WAR.KTFT == 1 and JY.Person[pid]["拳掌功夫"] >= 300 and yongquan(wugong) and JLSD(10,45,pid) then --崆峒拳系堂主
		local a = JY.Person[pid]["拳掌功夫"] / 3
		WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -a)
		if wugong == 23 then
			WAR.YJQS[eid] = 50
			WAR.Person[emenyid][CC.TXWZ2] = "一劲七伤"
		else 
			WAR.YJQS[eid] = 30
			WAR.Person[emenyid][CC.TXWZ2] = "一劲七伤"
		end	
	end
	
	
	if MPPD(pid) == 18 and WAR.KTFT == 2 and JY.Person[pid]["特殊兵器"] >= 300 and yongte(wugong) and JLSD(10,45,pid) then
		WAR.YJQS[eid] = 30
		WAR.Person[emenyid][CC.TXWZ2] = "一劲七伤"
	end

    if MPPD(pid) == 18 and WAR.KTFT == 3 and JY.Person[pid]["暗器技巧"] >= 200 and yongte(wugong) and JLSD(10,45,pid) then --崆峒暗系堂主
		local a = JY.Person[pid]["暗器技巧"] / 3
        WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -a)
	end	

    if MPPD(pid) == 18 and WAR.KTFT == 3 and JY.Person[pid]["暗器技巧"] >= 400 and yongan(wugong) and JLSD(10,45,pid) and PersonGTJL(pid,189,WAR.NGJL) then --崆峒暗系堂主
		local aa = JY.Person[pid]["暗器技巧"] + 100
	    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - aa;
	    AddPersonAttrib(eid, "内力", -aa);
	    WAR.ICEXS[eid] = 1
	    WAR.ICE[eid] = limitX((WAR.ICE[eid] or 0) + aa, 0, 50)
	    if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "崆峒追魂・子午流注"
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "崆峒追魂・子午流注"
	    end	
	end	

    if (wglw(pid,96) or ((pid == 400 and JY.Person[pid]["姓名"] == "慧聪") or DT(pid,38) or DT(pid,615)) and PersonGTJL(pid,96)) and JLSD(10,60,pid) and DWPD() then --罗汉伏魔领悟
        local aa = math.modf(JY.Person[eid]["内力"]/20)
	    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) - aa;
	    AddPersonAttrib(eid, "生命", -aa);
	    WAR.HOTXS[eid]=1
	    WAR.HOT[eid] = limitX((WAR.HOT[eid] or 0) + aa, 0, 50)
	    if WAR.Person[emenyid][CC.TXWZ1] == nil then
		    WAR.Person[emenyid][CC.TXWZ1] = "罗汉伏魔・不染于物欲"
	    else
		    WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" .. "罗汉伏魔・不染于物欲"
	    end	
	end	
	
    if wglw(pid,187) and PersonGTJL(pid,187) and JLSD(10,40,pid) and DWPD() then --少林九阳
        local a = math.modf(JY.Person[pid]["内力"] / 30)
	    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) - a;
	    AddPersonAttrib(eid, "生命", -a);
	    if WAR.Person[emenyid][CC.TXWZ1] == nil then
		    WAR.Person[emenyid][CC.TXWZ1] = "少林九阳・伏魔"
	    else
		    WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" .. "少林九阳・伏魔"
	    end	
	end		
	
	if ((wglw(pid,124) and JLSD(10,60,pid)) or (DT(pid,22) and JLSD(10,60,pid))) and DWPD() then --寒冰真气领悟
        local aa = JY.Person[eid]["内力"]
		local bb = JY.Person[eid]["内力最大值"]
	    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) - ((bb-aa)/20);
	    AddPersonAttrib(eid, "生命", -((bb-aa)/20));
	    if WAR.Person[emenyid][CC.TXWZ1] == nil then
		    WAR.Person[emenyid][CC.TXWZ1] = "封天之寒・片霜冷长河"
	    else
		    WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" .. "封天之寒・片霜冷长河"
	    end	
	end	
	
    if JY.Person[pid]["武器"] == 54 and DWPD() == false and JLSD(10,40,pid) then  --焦尾琴
        local fhurt = 100 + Rnd(10)
		hurt = 0
		WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", fhurt)
		--WAR.Person[emenyid]["真伤点数"] = fhurt
        WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "受伤程度", -8)		
	end
	if DWPD() then
		if JY.Person[pid]["武器"] == 36 and JLSD(10,40,pid) then  --玄铁剑
			WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -500);
			WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "受伤程度", 10);
		end 		
		
		if JY.Person[pid]["武器"] == 40 and JLSD(10,40,pid)  then  --金蛇剑
			WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", 20);
			WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "受伤程度", 5);
		end 		
		
		if JY.Person[pid]["武器"] == 46 and JLSD(10,40,pid)  then  --碧波香露刀
			WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", 30);
			WAR.Person[emenyid]["体力点数"] = (WAR.Person[emenyid]["体力点数"] or 0) + AddPersonAttrib(eid, "体力", -10);
		end	
		
		if JY.Person[pid]["武器"] == 47  and JLSD(10,40,pid) then  --金刀
			WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) +  AddPersonAttrib(eid, "内力", -100);
		end	
		
		if JY.Person[pid]["武器"] == 52 and JLSD(10,40,pid)  then  --鳄嘴剪
			WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -80);
			WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "受伤程度", 8);
		end		
		
		if JY.Person[pid]["武器"] == 53 and JLSD(10,40,pid)  then  --判官笔
			WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", 10);
			WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "受伤程度", 10);
		end			
		
		if JY.Person[pid]["武器"] == 236 and JLSD(10,40,pid)  then  --太极剑	
			WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -200);
		end	
		
		if JY.Person[pid]["武器"] == 244 and JLSD(10,40,pid)  then  --金蜈钩
			WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", 80);
		end	
		
		if JY.Person[pid]["武器"] == 252 and JLSD(10,40,pid)  then  --西毒蛇杖
			WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", 100);
			WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "受伤程度", 50);
		end 			
		
		if JY.Person[pid]["武器"] == 253 and JLSD(10,40,pid)  then  --七星海棠
			WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", 100);
			WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -300);
		end 	

		if JY.Person[pid]["武器"] == 291 and JLSD(10,40,pid) then  --银烟管
			WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", 50);
		end 	
		
		if JY.Person[pid]["武器"] == 295 and JLSD(10,40,pid)  then  --柔蚕丝
			WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", 20);
			WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "受伤程度", 20);
		end 	
		
		if JY.Person[pid]["武器"] == 296 and JLSD(10,40,pid)  then  --阴阳扇
			WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -150);
			WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", 30);
			WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "受伤程度", 30);
		end	
		
		if JY.Person[pid]["武器"] == 297 and JLSD(10,40,pid)  then  --含沙射影
			WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -200);
			WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", 50);
		end		
		
		if JY.Person[pid]["武器"] == 303 and JLSD(10,40,pid)  then  --紫薇软剑
			WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -300);
		end		
		
		if JY.Person[pid]["武器"] == 304 and JLSD(10,40,pid)  then  --玉箫
			WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) +  AddPersonAttrib(eid, "内力", -500);
		end		
		
		if JY.Person[pid]["武器"] == 306 and JLSD(10,40,pid) then  --火枪
			WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -400);
		end		
		
		if JY.Person[pid]["武器"] == 309 and JLSD(10,40,pid)  then  --软红蛛索
			WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "中毒程度", 45);
			WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) +  AddPersonAttrib(eid, "内力", -600);
		end	
	end	
	
	if WAR.FXHJ2 == 1 then
		if WAR.LQZ[eid] == 100 then
	        WAR.LQZ[eid] = WAR.LQZ[eid] - 15
        end
	end 	

    if WAR.FXHJ2 == 1 then
        WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -1000)
	end 	

    --太极神功减怒气
	if PersonGT(pid,182) and WAR.Actup[pid] ~= nil then
        if WAR.LQZ[eid] == 100 then
	        WAR.LQZ[eid] = WAR.LQZ[eid] - 15
        end
    end

    --洗髓经暴击
	if WAR.XSJS == 1 then
        WAR.LQZ[pid] = WAR.LQZ[pid] or 0 + 100
	    if WAR.LQZ[pid] >= 100 then
	        WAR.LQZ[pid] = 100
		end	
    end 

    if (wugong == 175 and wglw1(pid,175)) and JLSD(10,50,pid) then --霹雳火雷领悟
        local aa = math.modf(JY.Person[eid]["内力"] / 18)
	    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) - aa;
	    AddPersonAttrib(eid, "生命", -aa);
	    WAR.HOTXS[eid]=1
	    WAR.HOT[eid] = limitX((WAR.HOT[eid] or 0) + aa, 0, 50)
	    if WAR.Person[emenyid][CC.TXWZ1] == nil then
		    WAR.Person[emenyid][CC.TXWZ1] = "霹雳火雷・星罗棋布"
	    else
		    WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" .. "霹雳火雷・星罗棋布"
	    end	
	end	

    if (wugong == 175 and wglw1(pid,175)) and JLSD(10,50,pid) then --霹雳火雷领悟
        local a = math.modf(JY.Person[pid]["防御力"] / 18)
		if a < 10 then
            a = 10
        end
		hurt = hurt + math.modf((JY.Person[eid]["内力最大值"] - JY.Person[eid]["内力"]) * 0.0025)
		AddPersonAttrib(eid,"受伤程度", 25)
		if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "霹雳火雷・群星璀璨"
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "霹雳火雷・群星璀璨"
	    end	
	end	

    if (wugong == 175 and wglw1(pid,175)) and JLSD(10,50,pid) then --霹雳火雷领悟
        if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emenyid]["我方"] then
	        if math.random(10)<5 then
	            WAR.BZ[eid]=WAR.BZ[eid] or 0 +1
	        end
	        WAR.GUDUVICTIE[eid]=WAR.GUDUVICTIE[eid] or 0 +1
	        local aa=math.modf(JY.Person[eid]["内力"] / 18) 
	        WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -aa);
        end
		if WAR.Person[emenyid][CC.TXWZ3] == nil then
		    WAR.Person[emenyid][CC.TXWZ3] = "霹雳火雷・月朗星稀"
	    else
		    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "霹雳火雷・月朗星稀"
	    end	
	end

    if wugong == 133 and (DT(pid, 113) or wglw1(pid,133)) and JLSD(10, 60, pid) then
        for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - 200
				local tmppid = WAR.Person[j]["人物编号"]
				WAR.LXZT[tmppid] = WAR.LXZT[tmppid] or 0 + math.random(50,100)
				local bb = WAR.LXZT[tmppid]
				AddPersonAttrib(tmppid, "受伤程度", bb)
			end
		end		
		if WAR.Person[WAR.CurID][CC.TXWZ3] ~= nil then
      	    WAR.Person[WAR.CurID][CC.TXWZ3] = WAR.Person[WAR.CurID][CC.TXWZ3].."+".."慕・玄指为先"
        else
      	    WAR.Person[WAR.CurID][CC.TXWZ3] = "慕・玄指为先"
        end	   
	end 

    if wugong == 133 and (DT(pid, 113) or wglw1(pid,133)) and JLSD(10, 60, pid) then
        local aa = math.modf(JY.Person[eid]["内力"]/200 * sixi(pid,1) * 0.005)
		local bb = aa * 2
	    AddPersonAttrib(eid, "生命", -aa)
	    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -aa)
		AddPersonAttrib(eid, "内力", -bb)
	    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -bb)
		if WAR.Person[WAR.CurID][CC.TXWZ2] ~= nil then
      	    WAR.Person[WAR.CurID][CC.TXWZ2] = WAR.Person[WAR.CurID][CC.TXWZ2].."+".."容・混气柔刚"
        else
      	    WAR.Person[WAR.CurID][CC.TXWZ2] = "容・混气柔刚"
        end	   
	end 
  
    if wugong == 133 and (DT(pid, 113) or wglw1(pid,133)) and JLSD(10, 60, pid) then
        local aa = math.modf(JY.Person[eid]["内力"] * 0.2)
	    hurt = hurt * 1.5
	    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - aa;
  	    AddPersonAttrib(eid, "内力", -aa);
	    if WAR.Person[WAR.CurID][CC.TXWZ3] ~= nil then
      	    WAR.Person[WAR.CurID][CC.TXWZ3] = WAR.Person[WAR.CurID][CC.TXWZ3].."+".."参・海运洞显"
        else
      	    WAR.Person[WAR.CurID][CC.TXWZ3] = "参・海运洞显"
        end	   
	end 	

    if wugong == 133 and (DT(pid, 113) or wglw1(pid,133)) and JLSD(10, 60, pid) then 
        local a = math.modf(JY.Person[pid]["内力"]/30)
  	    WAR.HOT[eid] = 1
	    WAR.HOTXS[eid] = limitX((WAR.HOT[eid] or 0) + a, 0, 15)
	    hurt = hurt * math.modf(JY.Person[eid]["内力最大值"] * 1 * a)
	    WAR.ICE[eid]=1
	    WAR.ICEXS[eid] = limitX((WAR.ICE[eid] or 0) + a, 0, 15)
		if WAR.Person[WAR.CurID][CC.TXWZ1] ~= nil then
      	    WAR.Person[WAR.CurID][CC.TXWZ1] = WAR.Person[WAR.CurID][CC.TXWZ1].."+".."合・日月济世"
        else
      	    WAR.Person[WAR.CurID][CC.TXWZ1] = "合・日月济世"
        end	   
	end 

	if wugong == 24 and (DT(pid,615) or wglw1(pid,24)) then	-- 须弥山神掌领悟
		local offset = math.abs(WAR.Person[WAR.CurID]["坐标X"] - WAR.Person[emenyid]["坐标X"]) + math.abs(WAR.Person[WAR.CurID]["坐标Y"] - WAR.Person[emenyid]["坐标Y"])
		if offset < 10 then offset = 10 end
		if offset > 30 then offset = 30 end
		if JLSD(0, offset*3, pid) then
			WAR.FMZZ[eid] = WAR.FMZZ[eid] or 0 + 1
		end	
		if JLSD(0, offset*3, pid) then
			WAR.LHZF[eid] = WAR.LHZF[eid] or 0 + 1
		end
		if JLSD(0, offset*3, pid) then
			WAR.DLYZ[eid] = WAR.DLYZ[eid] or 0 + 1
		end
		if WAR.Person[emenyid][CC.TXWZ1] == nil then
		    WAR.Person[emenyid][CC.TXWZ1] = "七佛灭罪・迦叶"
	    else
		    WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" .. "七佛灭罪・迦叶"
	    end	
	end
--玉女素心剑
   if wugong == 42 and WAR.YNSX == 1 then
        WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid,"受伤程度",3)		
		hurt = hurt + math.modf(hurt * (JY.Person[eid]["受伤程度"] / 5))   
	end	

    if wugong == 42 and WAR.YNSX == 2 then
		WAR.Person[emenyid]["体力点数"] = (WAR.Person[emenyid]["体力点数"] or 0) + AddPersonAttrib(eid, "体力", -12)	   
	end	

    if wugong == 42 and WAR.YNSX == 3 then
        WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -150)
		WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -500)	   
	end	

    if wugong == 42 and WAR.YNSX == 4 then
        if math.random(10)<5 then
	        WAR.BZ[eid]=WAR.BZ[eid] or 0 +1
	    end	   
	end	

    if wugong == 42 and WAR.YNSX == 5 then
        WAR.L_NOT_MOVE[eid] = 1	   
	end	

    if wugong == 42 and WAR.YNSX == 6 then
        hurt = math.modf(hurt *(2 - (JY.Person[eid]["内力最大值"] - JY.Person[eid]["内力"]) / JY.Person[eid]["内力最大值"])) 
	    if WAR.ICE[eid] ~= nil and WAR.ICE[eid] > 0 then
	        hurt = hurt * 1.2
	    end	   
	end	
--玉女素心剑
    if wugong == 39 and (DT(pid, 129) or wglw1(pid,39)) and JLSD(10, 40, pid) then
		local a1 = math.modf(sixi(pid, 1) * 2)
		local a2 = math.modf(sixi(pid, 2) * 2)
		local a3 = a1 * a2		
		hurt = hurt + math.modf(hurt * (JY.Person[eid]["攻击力"] * a3))
		if JY.Person[pid]["攻击力"] >= JY.Person[eid]["攻击力"] then
		    hurt = hurt + math.modf(((JY.Person[pid]["攻击力"] - JY.Person[eid]["攻击力"]) / 20) + a3)
		end
	    if WAR.Person[WAR.CurID][CC.TXWZ1] ~= nil then
      	    WAR.Person[WAR.CurID][CC.TXWZ1] = WAR.Person[WAR.CurID][CC.TXWZ1].."+".."全真剑法・明河共影"
        else
      	    WAR.Person[WAR.CurID][CC.TXWZ1] = "全真剑法・明河共影"
		end		   
	end	

    if wugong == 39 and (DT(pid, 129) or wglw1(pid,39)) and JLSD(10, 40, pid) then
        if WAR.LQZ[eid] == 100 then
	        WAR.LQZ[eid] = WAR.LQZ[eid] - 10
	    end
		if WAR.Person[WAR.CurID][CC.TXWZ3] ~= nil then
      	    WAR.Person[WAR.CurID][CC.TXWZ3] = WAR.Person[WAR.CurID][CC.TXWZ3].."+".."全真剑法・兰烬蕉暗"
        else
      	    WAR.Person[WAR.CurID][CC.TXWZ3] = "全真剑法・兰烬蕉暗"
		end		   
	end	

    if wugong == 39 and (DT(pid, 129) or wglw1(pid,39)) and JLSD(10, 40, pid) then
        WAR.PEACE[eid]=limitX((WAR.PEACE[eid] or 0) + 30, 0, 100)
		if WAR.Person[WAR.CurID][CC.TXWZ3] ~= nil then
      	    WAR.Person[WAR.CurID][CC.TXWZ3] = WAR.Person[WAR.CurID][CC.TXWZ3].."+".."全真剑法・胡霜千里"
        else
      	    WAR.Person[WAR.CurID][CC.TXWZ3] = "全真剑法・胡霜千里"
		end		   
	end	

    if wugong == 15 and (DT(pid, 64) or wglw1(pid,15)) and JLSD(10, 45, pid) then
		if WAR.LQZ[eid] == 100 then
	        WAR.LQZ[eid] = 0
	    end
        local a1 = math.modf(sixi(eid, 1) * 2)
		local a2 = math.modf(sixi(eid, 2) * 2)
		local a3 = math.modf(sixi(eid, 3) * 2)
		local a4 = math.modf(sixi(eid, 4) * 2)
		local a5 = math.modf(sixi(eid, 5) * 2)
		local a6 = a1 + a2 + a3 + a4 + a5 	
		hurt = hurt + math.modf(hurt + ((JY.Person[eid]["攻击力"] + JY.Person[eid]["攻击力"] + JY.Person[eid]["攻击力"]) * a6))
		if (JY.Person[eid]["攻击力"] >= JY.Person[eid]["防御力"]) or (JY.Person[eid]["攻击力"] <= JY.Person[eid]["防御力"]) then
		    hurt = hurt + math.modf(((JY.Person[eid]["攻击力"] + JY.Person[eid]["防御力"] + JY.Person[eid]["轻功"])) * a6)
		end
		if WAR.Person[WAR.CurID][CC.TXWZ1] ~= nil then
      	    WAR.Person[WAR.CurID][CC.TXWZ1] = WAR.Person[WAR.CurID][CC.TXWZ1].."+".."空朦洞松・风通容梦・冲穷中弄・童庸弓虫"
        else
      	    WAR.Person[WAR.CurID][CC.TXWZ1] = "空朦洞松・风通容梦・冲穷中弄・童庸弓虫"
		end		   
	end	

    if wugong == 15 and (DT(pid, 64) or wglw1(pid,15)) and JLSD(10, 60, pid) then
        WAR.FXXS[eid] = 1 
	    WAR.FXDS[eid] = 35	
	    if WAR.FXDS[eid] == nil then
		    WAR.FXDS[eid] = 35
	    else
		    WAR.FXDS[eid] = WAR.FXDS[eid] + 35
	    end
		if WAR.Person[WAR.CurID][CC.TXWZ3] ~= nil then
      	    WAR.Person[WAR.CurID][CC.TXWZ3] = WAR.Person[WAR.CurID][CC.TXWZ3].."+".."奥义・空碗盛饭"
        else
      	    WAR.Person[WAR.CurID][CC.TXWZ3] = "奥义・空碗盛饭"
		end		   
	end	

    if wugong == 15 and (DT(pid, 64) or wglw1(pid,15)) and JLSD(10, 60, pid) then
        WAR.GTSHAQI = WAR.GTSHAQI + 350
		WAR.GTPID2 = pid  
		if WAR.Person[WAR.CurID][CC.TXWZ3] ~= nil then
      	    WAR.Person[WAR.CurID][CC.TXWZ3] = WAR.Person[WAR.CurID][CC.TXWZ3].."+".."奥义・空屋住人"
        else
      	    WAR.Person[WAR.CurID][CC.TXWZ3] = "奥义・空屋住人"
		end		   
	end	

    if wugong == 15 and (DT(pid, 64) or wglw1(pid,15)) and JLSD(10, 40, pid) then
        hurt = hurt * math.modf(JY.Person[pid]["内力最大值"] / 1)
		if WAR.Person[WAR.CurID][CC.TXWZ2] ~= nil then
      	    WAR.Person[WAR.CurID][CC.TXWZ2] = WAR.Person[WAR.CurID][CC.TXWZ2].."+".."奥义・深藏若虚"
        else
      	    WAR.Person[WAR.CurID][CC.TXWZ2] = "奥义・深藏若虚"
		end		   
	end	

    if wugong == 15 and (DT(pid, 64) or wglw1(pid,15)) and JLSD(10, 60, pid) then
        WAR.YANGKANG = 1
		if WAR.Person[WAR.CurID][CC.TXWZ2] ~= nil then
      	    WAR.Person[WAR.CurID][CC.TXWZ2] = WAR.Person[WAR.CurID][CC.TXWZ2].."+".."奥义・妙手空空"
        else
      	    WAR.Person[WAR.CurID][CC.TXWZ2] = "奥义・妙手空空"
		end		   
	end	
	
    if WAR.JWDF == 1 then
		local a = math.modf(JY.Person[pid]["内力"] * 2)
	    ang = ang + a
	end 		
	
    if WAR.JWDF == 4 then
		local a = math.modf(JY.Person[pid]["内力"] * 0.35)
		hurt = hurt + a
	end 		
	
	--无上大力杵无上大千
	if wugong == 83 and wglw1(pid,83) then
        local a1 = math.modf(JY.Person[pid]["攻击力"] * 0.1)
		local a2 = math.modf(JY.Person[pid]["防御力"] * 0.1)
		local a3 = math.modf(JY.Person[eid]["攻击力"] * 0.05)
		local a4 = math.modf(JY.Person[eid]["防御力"] * 0.05)
		local a5 = math.modf(sixi(pid, 4) * 1.5)
		local a7 = math.modf(1 + (WAR.LQZ[eid]or 0))
		local a6 = (a1 - a3) + (a2 - a4)  	
		if (JY.Person[eid]["攻击力"] + JY.Person[eid]["防御力"]) <= 1000 then
		hurt = hurt + math.modf(hurt * a5 * a6 * 0.01)
		elseif (JY.Person[eid]["攻击力"] + JY.Person[eid]["防御力"]) > 1000 then
		hurt = hurt + math.modf(hurt * (a5 * a6 * 0.01 * a7))
		end
	end
	--黄沙万里鞭沙狱乱尘无尽
	if wugong == 78 and wglw1(pid,78) then
        local a1 = WAR.ACT
		local a2 = math.modf(sixi(pid, 4) * 0.8)
		local a3 = math.modf(101 - JY.Person[eid]["体力"])	
		hurt = hurt + math.modf(hurt * a1 * a2 * a3)
		if WAR.BMSZ == 1 then
	    hurt = hurt + math.modf((hurt * a1 * a2 * a3) + (hurt * a3))
		WAR.Person[emenyid][CC.TXDH] = 52
		end
	end
	--持瑶琴刚柔劲阴阳弦
	if wugong == 73 and wglw1(pid,73) then
        local a1 = WAR.Person[pid].TimeAdd
		local a2 = WAR.Person[emenyid].TimeAdd
		local a3 = JY.Person[eid]["受伤程度"]
		local a4 = math.modf(JY.Person[pid]["内力"]/10)
		local a5 = a1 - a2
		if a5 < 3 then a5 = 3 end
		hurt = hurt + math.modf(hurt * (a1 - a2)) + math.modf(hurt * (a3 + a4))
	end
	
	--胡刀领悟：天下霸道三刀
	if wugong == 67 and (wglw1(pid,67) or (DT(pid, 1) and JX(pid)) or (DT(pid, 621) and JX(pid))) then
        local a1 = math.modf(sixi(pid, 3) * 1.5)
		hurt = hurt + math.modf(hurt * a1)
	end
	
	--铁碎牙风之伤
	if wugong == 67 and WAR.FZS == 1 and (wglw1(pid,67) or (DT(pid, 1) and JX(pid)) or (DT(pid, 621) and JX(pid))) then
        local aa = math.random(5)
		local bb = math.random(3)
		local a1 = math.modf(JY.Person[pid]["内力最大值"]*aa)
		local a2 = math.modf(JY.Person[pid]["内力"]*aa)
		local a3 = math.modf(JY.Person[eid]["内力最大值"]*bb)
		local a4 = math.modf(JY.Person[eid]["内力"]*bb)
		local a5 = ((a1+a2) - (a3+a4))
		if a5 < 0 then a5 = 0 end
		hurt = hurt + math.modf(hurt*a5)
	end

	--古墓剑系：双剑精绝
	if yongjian(wugong) and MPPD(pid) == 3 and PersonKF(pid,39) and PersonKF(pid,42) and PersonGT(pid,121) then
       local hurt1 = 0
	   local hurt2 = 0
		if sixi(pid,2) > sixi(eid,2) then
			local a1 = sixi(pid,2) - sixi(eid,2)
			if a1 < 100 then a1 = 100 end
			hurt1 = math.modf( a1 * 3 )
		end
		if JY.Person[pid]["内力最大值"] < JY.Person[eid]["内力最大值"] then
			local a2 = JY.Person[eid]["内力最大值"] - (math.ceil(JY.Person[pid]["内力最大值"] / 2))
			if a2 < 1000 then a2 = 1000 end
			hurt2 = math.ceil( a2 / 10 )
		end
		hurt = hurt + hurt1 + hurt2
	end
	
	--冰魄银针 伤害增加
	if (wglw1(pid,170) or (DT(pid,161)))and wugong == 170 then
		local aa = JY.Person[pid]["用毒能力"] - JY.Person[eid]["解毒能力"]
		local bb = sixi(pid,5)
		hurt = hurt + math.ceil((math.abs(aa)) * bb/5)
	end	

    --弹指神通
	if wugong == 18 and (DT(pid, 57) or wglw1(pid,18)) and JLSD(10, 45, pid) then 
	    WAR.L_NOT_MOVE[eid] = 1
	end	

    --白羽箭法
	if wugong == 148 and (DT(pid, 55) or wglw1(pid,148)) and JLSD(10, 45, pid) then 
		WAR.Person[emenyid].Time = WAR.Person[WAR.CurID].Time - 999
	end	

    --白羽箭法
	if wugong == 148 and (DT(pid, 55) or wglw1(pid,148)) and JLSD(10, 45, pid) then 
	    WAR.L_NOT_MOVE[eid] = 1
		WAR.PEACE[eid] = WAR.PEACE[eid] or 0 + 100
	end	

    --白羽箭法
	if wugong == 148 and (DT(pid, 55) or wglw1(pid,148)) and JLSD(10, 45, pid) then 
	    local a1 = math.modf(sixi(pid, 5) * 1.5)
		hurt = hurt + math.modf(hurt * a1)
		hurt = math.modf(hurt * JY.Person[pid]["内力最大值"]) 
	end	

    if WAR.HKSL == 1 then
		WAR.Person[emenyid].Time = WAR.Person[WAR.CurID].Time - 999
	end 	

    if WAR.HKSL == 1 then
		WAR.BZ[eid] = 1
		WAR.PEACE[eid] = WAR.PEACE[eid] or 0 + 100
	end 
	
	if WAR.HKSL == 1 then
		hurt = math.modf(hurt * JY.Person[pid]["内力最大值"]) 
	end 

    --蚊须针
	if wugong == 166 and (DT(pid, 12) or wglw1(pid,166)) and JLSD(10, 50, pid) then
	    hurt = hurt + math.modf(JY.Person[eid]["受伤程度"] * 1.2)
	    hurt = math.modf(hurt * JY.Person[eid]["内力最大值"]) 
	    if WAR.HOT[eid] ~= nil and WAR.HOT[eid] > 0 then
	        hurt = hurt * 1.5
	    end
		WAR.Person[WAR.CurID][CC.TXWZ2] = "蚊须针・痒磨树者"
	end	

    --蚊须针
    if wugong == 166 and (DT(pid, 12) or wglw1(pid,166)) and JLSD(10, 50, pid) then
		WAR.LHZF[eid]=WAR.LHZF[eid] or 0 + 1
		if WAR.LQZ[eid] == 100 then
	        WAR.LQZ[eid] = WAR.LQZ[eid] - 15
        end
		WAR.Person[WAR.CurID][CC.TXWZ3] = "蚊须针・心痒难挝"
	end	

    --蚊须针
    if wugong == 166 and (DT(pid, 12) or wglw1(pid,166)) and JLSD(10, 50, pid) then
        WAR.YHZJ[eid] = WAR.YHZJ[eid] or 0 + 1
		WAR.Person[emenyid][CC.TXWZ2] = "蚊须针・知疼着痒"
	end	

    --逍遥神仙环
    if JY.Person[pid]["武器"] == 247 and JLSD(10,40,pid) then	
        hurt = math.modf(hurt * (JY.Person[pid]["内力最大值"] / 50)) 
	end 	

    --青竹棒
    if JY.Person[pid]["武器"] == 301 and JLSD(10,40,pid) then	
        hurt = math.modf(hurt * (JY.Person[pid]["内力最大值"] / 40)) 
	end 

    --木剑
    if JY.Person[pid]["武器"] == 302 and JLSD(10,40,pid) then	
        hurt = math.modf(hurt * (JY.Person[pid]["内力最大值"] / 30)) 
	end 

    if DT(pid,617) and JY.Person[eid]["生命"] <= 0 and DWPD() then
		WAR.Person[emenyid]["我方"] = WAR.Person[WAR.CurID]["我方"]
		JY.Person[eid]["生命"] = JY.Person[eid]["生命最大值"]
		JY.Person[eid]["内力"] = JY.Person[eid]["内力最大值"]
		JY.Person[eid]["中毒程度"] = 0
		JY.Person[eid]["受伤程度"] = 0
		JY.Person[eid]["冰封程度"] = 0
		JY.Person[eid]["灼烧程度"] = 0
		JY.Person[eid]["体力"] = 100
		WAR.FXXS[eid] = nil
		WAR.LXZT[eid] = nil
		WAR.CHZ[eid] = nil
		WAR.ICE[eid] = nil
		WAR.HOT[eid] = nil
	end

    if WAR.ZCDZ == 1 and hasDZ(pid,5) then--战意组件5
	    local ss = math.random(10)
	    if ss == 1 then
		    WAR.ATKDOWN[eid] = WAR.ATKDOWN[eid] or 0 + 30
	    elseif ss == 2 then
		    WAR.DEFDOWN[eid] = WAR.DEFDOWN[eid] or 0 + 30
	    elseif ss == 3 then
		    WAR.SPDDOWN[eid] = WAR.SPDDOWN[eid] or 0 + 30
	    elseif ss == 4 then
		    WAR.L_WNGZL[eid] = WAR.L_WNGZL[eid] or 0 + 30
	    elseif ss == 5 then
		    WAR.L_NOT_MOVE[eid] = 1
	    elseif ss == 6 then
		    WAR.KHCM[eid] = 2
	    elseif ss == 7 then
		    WAR.BZ[eid] = 1
	    elseif ss == 8 then
		    WAR.GUDUVICTIE[eid] = 2
	    elseif ss == 9 then
		    WAR.CONFUSE[eid] = WAR.CONFUSE[eid] or 0 + 50
	    elseif ss == 10 then
		    WAR.PEACE[eid] = WAR.PEACE[eid] or 0 + 30
	    end	
    end
  
    --豸苗：谢云流叠刃
    if XYL(pid) and DWPD() and WAR.XYLCZ == 1 then --17-3-1
	    local a = WAR.SHTY
	    WAR.DR[eid] = 80
	    if WAR.DR_X[eid] == nil then  
	        WAR.DR_X[eid] = 0 
	    end
	    if WAR.BJ == 1 then
	        WAR.DR_X[eid] = WAR.DR_X[eid] + 2 + a
	    else
	        WAR.DR_X[eid] = WAR.DR_X[eid] + 1 + a
	    end
	end

	if ((MPPD(pid)==12 and PersonKF(pid, 88) and not PersonGT(pid, 105) and GetS(54,0,0,1) == 1) or DT(pid,26)) and WAR.XXQG[pid]~=nil and WAR.XXQG[pid]>=0 and MPDJ(pid)>1 then --日月捧月派气攻加成
        local aa=10
	    if DT(pid,26) then
	        aa=aa+5
	    end
	    if WAR.NGJL>0 then
	        aa=aa+5
	    end
	    ang=ang+WAR.XXQG[pid]*10
	    if WAR.XXQF[eid]~=nil and WAR.XXQF[eid]>=0 then
		    dng=dng-WAR.XXQF[eid]*10
		    if dng<=0 then
		        dng=0
		    end
        end
	    WAR.Person[emenyid][CC.TXWZ3] = "群星捧月・星河倒泄" 
        WAR.Person[emenyid][CC.TXDH] = 75	  
	end
	
	if T1LEQ(pid) and WAR.XXQG[pid]~=nil and WAR.XXQG[pid]>=0 then --日月捧月派气攻加成
        local aa=20
	    if WAR.NGJL>0 then
	        aa=aa+5
	    end
	    ang=ang+WAR.XXQG[pid]*10
	    if WAR.XXQF[eid]~=nil and WAR.XXQF[eid]>=0 then
		    dng=dng-WAR.XXQF[eid]*10
		    if dng<=0 then
		        dng=0
		    end
        end
	    WAR.Person[emenyid][CC.TXWZ3] = "苍半无双.星河动摇" 
        WAR.Person[emenyid][CC.TXDH] = 75	  
	end
	
	if DT(pid, 55) and PersonGT(pid,107) and JX(pid) and WAR.GJQJ==13 then
	    dng=0
	end
	
	if WAR.XMHJ == 1 then
		dng = 0
	end 		
	
	if MPPD(pid) == 14 and PersonGT(pid,90) and MPDJ(pid)>1 then--沼跃鱼：正气歌主运效果
        local str=".下则为河岳"
		local shang=math.modf(JY.Person[pid]["内力"]*0.03)
		ang=ang+math.modf(JY.Person[pid]["内力"]*0.8)
		if ang>= 2000+MPDJ(pid)*1000 then
		    ang=2000+MPDJ(pid)*1000;
		end
		if JLSD(10,45,pid) and PersonGTHT(pid, 90, WAR.NGJL) then
		    local tmp=math.modf(shang*MPDJ(pid));
		    dng=0
		    WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) +tmp;
  	        AddPersonAttrib(pid, "内力", tmp);
		    str=".上则为日星"
	else
		end
		if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
    	    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "正气歌"..str
        else
    	    WAR.Person[emenyid][CC.TXWZ3] = "正气歌"..str
        end
	end
	
	--华山拳系
    if (MPPD(pid) == 14 and PersonGT(pid,90) and JY.Person[pid]["拳掌功夫"] >= 200 and yongquan(wugong) and JLSD(10,40,pid)) or ((DT(pid,54) or DT(pid,185) or DT(pid,188)) and yongquan(wugong) and JLSD(10,45,pid)) then	
        WAR.BZ[eid] = 1
		if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "华山・破玉拳"
		end	
    end	
	
	--打狗棒
    if JY.Person[pid]["武器"] == 48 and JLSD(10,40,pid) then
		WAR.BZ[eid] = 1
	end 		
	
    if (DT(pid,64) or wglw(pid,999)) and WAR.ZYHB == 0 and WAR.ZYHB2 == 1 then --左右三连
        WAR.BZ[eid] = 1
    end
	
    --辟邪剑法
	if PersonKF(pid,48) then 
        local jl = JY.Person[pid]["轻功"] / 30
		if JLSD(10, 20 + jl, pid) then 
			WAR.BZ[eid] = 1
		end 
	end 			
	
	if (wglw(pid,108) and PersonGT(pid,108)) or DT(pid, 615) or DT(pid, 114) or DT(pid, 585) then--沼跃鱼：易筋领悟主运
        local str=".释迦禅意"
		local shang=math.modf(JY.Person[pid]["内力最大值"]*0.05)
		ang=ang+math.modf(JY.Person[pid]["内力"]*0.8)
		if ang>= math.modf(JY.Person[pid]["内力最大值"]) then
		    ang=math.modf(JY.Person[pid]["内力最大值"]);
		end
		if JLSD(10,45,pid) and PersonGTHT(pid, 108, WAR.NGJL) then
		    dng=math.modf(dng/2)
		    WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) +shang;
  	        AddPersonAttrib(pid, "内力", shang);
		    str=".锭光真谛"
    else
        end
		if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
    	    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "易筋神髓"..str
        else
    	    WAR.Person[emenyid][CC.TXWZ3] = "易筋神髓"..str
        end
	end	
	
    if DT(pid, 457) then  --凡总自带
        local str="・释迦禅意"
		local shang=math.modf(JY.Person[pid]["内力最大值"]*0.05)
		ang=ang+math.modf(JY.Person[pid]["内力"]*0.8)
		if ang>= math.modf(JY.Person[pid]["内力最大值"]) then
		    ang=math.modf(JY.Person[pid]["内力最大值"]);
		end
		if JLSD(10,45,pid) and PersonGTHT(pid, 108, WAR.NGJL) then
		    dng=math.modf(dng/2)
		    WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) +shang;
  	        AddPersonAttrib(pid, "内力", shang);
		    str="・锭光真谛"
    else
        end
		if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
    	    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "易筋神髓"..str
        else
    	    WAR.Person[emenyid][CC.TXWZ3] = "易筋神髓"..str
        end
	end		
	
    if DT(pid,118) and WAR.CYSH[eid] == nil and DWPD() then
	    if WAR.LQZ[eid] == 100 or WAR.LQZ[pid] == 100 then
		    WAR.CYSH[eid] = 50
		    effect(47,"特效文字1","传音搜魂",500,0)
    elseif JLSD(0,40,pid) then --豸苗：李秋水
		    WAR.CYSH[eid] = 50
		    effect(47,"特效文字1","传音搜魂",500,0) 
	    end
	end	

	--豸苗：欧阳锋蛇毒
	--[[if (DT(pid, 60) or DT(pid, 620)) and DWPD() and JLSD(0,30,pid) and WAR.OYFSD[eid] == nil and hurt > 0 then
	    WAR.Person[WAR.CurID][CC.TXWZ1] = "灵蛇杖毒"
	    WAR.OYFSD[eid] = 100
	end	]]	
	
	--郭靖降龙
    if wugong == 26 and (DT(pid,55) or DT(pid,617)) then
		WAR.LXZT[eid] = 1
	end 	
	
    if WAR.JWDF == 2 then
		WAR.LXZT[eid] = 1
	end 		
	
    --辟邪剑法流血
	if PersonKF(pid,48) then 
		WAR.LXZT[eid] = 1	
	end	
	
    --葵花神针流血
	if wugong == 177 and (DT(pid, 27) or wglw1(pid,177)) then
		WAR.LXZT[eid] = 1
	end	 	
	
    --崆峒高级弟子
	if MPPD(pid) == 18 and MPDJ(pid) >= 2 and PersonGT(pid,189) then
		WAR.LXZT[eid] = 1
	end 		
	
    --七伤拳
	if wugong == 23 and ((DT(pid, 8) or DT(pid, 167) or DT(pid, 168) or DT(pid, 603)) or wglw1(pid,23)) then
		WAR.LXZT[eid] = 1
	end		
	
	--葵花套件
	if KHT(pid) and JLSD(10,40,pid) then
        WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命",-100)
		--JY.Person[eid]["生命"]	= JY.Person[eid]["生命"] - 100
	end	
	
	--葵花神针流血加倍
    if wugong == 177 and (DT(pid, 27) or wglw1(pid,177)) and JLSD(10, 40, pid) then
        WAR.LXZT[eid] = WAR.LXZT[eid] or 0 + 30
	    if 50 > WAR.LXZT[eid] then
	        WAR.LXZT[eid] = 50
	    end	
	    WAR.Person[WAR.CurID][CC.TXDH] = 80
        WAR.Person[WAR.CurID][CC.TXWZ2] = "葵花神针・依云"	
	end
	
	--倚天剑
    if JY.Person[pid]["武器"] == 37 then	
		WAR.LXZT[eid] = WAR.LXZT[eid] or 0 + 15
	    if 80 > WAR.LXZT[eid] and JLSD(10,40,pid)  then
	        WAR.LXZT[eid] = 100
	    end	
	end	
	
    if BJY(pid) and yongquan(wugong) and JLSD(10,40,pid) then
		WAR.LXZT[eid] = WAR.LXZT[eid] or 0 + 30
	    if 50 < WAR.LXZT[eid] then
	        WAR.LXZT[eid] = 50
	    end	
	end		
	
	--黄裳
	if (wglw(pid, 107) or DT(pid,599)) and WAR.YHDF1 == 1 and DWPD() then --17-2-10 
	    WAR.YHDF[eid] = 1
	end
	
    if T13TQS(pid) and WAR.TQS3==4 and DWPD() and hurt > 0 then--沼跃鱼：滕青山血光冥蛇斗气
	    local SN=math.modf(JY.Person[eid]["生命"]/20*WAR.SWHH*0.1)
	    WAR.LXXS[eid] = 1
	    WAR.LXZT[eid] = limitX((WAR.LXZT[eid] or 0) + SN, 0, 100)
	    WAR.ICEXS[eid]=1
	    WAR.ICE[eid] = limitX((WAR.ICE[eid] or 0) + SN, 0, 100)
	    WAR.OYFSD[eid] = limitX((WAR.OYFSD[eid] or 0) + SN, 0, 100)
	    WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", SN)
	end	
	
	if wssz(pid) and WAR.TQS3==4 and DWPD() and hurt > 0 then--沼跃鱼：滕青山血光冥蛇斗气
	    local SN=math.modf(JY.Person[eid]["生命"]/20*WAR.SWHH1*0.1)
	    WAR.LXXS[eid] = 1
	    WAR.LXZT[eid] = limitX((WAR.LXZT[eid] or 0) + SN, 0, 100)
	    WAR.ICEXS[eid]=1
	    WAR.ICE[eid] = limitX((WAR.ICE[eid] or 0) + SN, 0, 100)
	    WAR.OYFSD[eid] = limitX((WAR.OYFSD[eid] or 0) + SN, 0, 100)
	    WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", SN)
	end		
	
	if T13TQS(pid) and WAR.TQS3==2 and DWPD() and hurt > 0 then--沼跃鱼：滕青山九尾妖狐斗气
	    local SN=math.modf(JY.Person[eid]["内力"]/200*WAR.SWHH*0.1)
	    local SN2=SN*10
	    AddPersonAttrib(eid, "生命", -SN2)
	    WAR.HOTXS[eid]=1
	    WAR.HOT[eid] = limitX((WAR.HOT[eid] or 0) + SN, 0, 100)
	end	
	
    if wssz(pid) and WAR.TQS3==2 and DWPD() and hurt > 0 then--沼跃鱼：滕青山九尾妖狐斗气
	    local SN=math.modf(JY.Person[eid]["内力"]/200*WAR.SWHH1*0.1)
	    local SN2=SN*10
	    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -SN2)
	    WAR.HOTXS[eid]=1
	    WAR.HOT[eid] = limitX((WAR.HOT[eid] or 0) + SN, 0, 100)
	end	
	
    if pid == 0 and T6XQS(0) then --萧秋水城郭炎上
	    if WAR.XQS == 6 then
	        local SN=math.modf(JY.Person[eid]["内力"]/200*sixi(pid,2)*0.01)
	        local SN2=SN*10
	        AddPersonAttrib(eid, "生命", -SN)
	        WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0)+AddPersonAttrib(eid, "生命", -SN)
	        AddPersonAttrib(eid, "内力", -SN2)
	        WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0)+AddPersonAttrib(eid, "内力", -SN2)
	        WAR.HOTXS[eid]=1
	        WAR.HOT[eid] = limitX((WAR.HOT[eid] or 0) + SN, 0, 50)
	    end
    end
  
    if wglw1(pid,32) then --松明抚斩
	    if WAR.WYLW3 == 2 then
	        local SN=math.modf(JY.Person[eid]["内力"]/200*sixi(pid,2)*0.01)
	        local SN2=SN*10
	        AddPersonAttrib(eid, "生命", -SN)
	        WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0)+AddPersonAttrib(eid, "生命", -SN)
	        AddPersonAttrib(eid, "内力", -SN2)
	        WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0)+AddPersonAttrib(eid, "内力", -SN2)
	        WAR.HOTXS[eid]=1
	        WAR.HOT[eid] = limitX((WAR.HOT[eid] or 0) + SN, 0, 50)
	    end
    end
	
	if WAR.ZCDZ == 1 and hasDZ(pid,9)  then--战意组件9
	    local SN=math.modf(JY.Person[eid]["内力"]/200)
	    local SN2=SN*10
	    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -SN2)
	    WAR.HOTXS[eid]=1
	    WAR.HOT[eid] = limitX((WAR.HOT[eid] or 0) + SN, 0, 100)
	end
	
	if ((wglw1(pid,77) or ((DT(pid,605) or (DT(pid,627)))and JX(pid))) or ((DT(pid,605) or (DT(pid,627)))and JX(pid))) and WAR.DZDJ1>0  then--战意组件9
	    local SN=math.modf(JY.Person[eid]["内力"]/200)
	    local SN2=SN*10
	    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) +  AddPersonAttrib(eid, "内力", -SN2)
	    WAR.HOTXS[eid]=1
	    WAR.HOT[eid] = limitX((WAR.HOT[eid] or 0) + SN, 0, 100)
	end
	
	if ((wglw1(pid,77) or ((DT(pid,605) or (DT(pid,627)))and JX(pid))) or ((DT(pid,605) or (DT(pid,627)))and JX(pid))) and WAR.DZDJ2>0  then--战意组件9
	    local SN=math.modf(JY.Person[eid]["内力"]/200)
	    local SN2=SN*10
	    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) +  AddPersonAttrib(eid, "内力", -SN2)
	    WAR.ICEXS[eid]=1
	    WAR.ICE[eid] = limitX((WAR.ICE[eid] or 0) + SN, 0, 100)
	end
	
	--豸苗：太玄经
	if (PersonKF(pid, 102) or  (T5BCF(pid) and juexing()>0)) and (WAR.TXTX == 2 or WAR.TXTX == 6) then 
	    WAR.TXJ2[eid] = 50 
	end   
	--豸苗：谢烟客控鹤功
	if DT(pid, 164) and DWPD() and JLSD(0,30,pid) then
	    WAR.Person[WAR.CurID][CC.TXWZ1] = "控鹤功・隔空控鹤"
	    WAR.KHG[eid] = 20
	end	
	
    if WAR.DGJJ_ZJS == 1 and WAR.LQZ[pid] == 100 then 
	    WAR.L_NOT_MOVE[eid] = 1
	end 		
	
    if WAR.XLGJ == 2 or WAR.XLGJ == 4 or WAR.XLGJ == 5 then  --降龙柔劲
	    WAR.L_NOT_MOVE[eid] = 1
	end 	

  	if WAR.TQS ==2 and DWPD() then ----沼跃鱼：滕青山拟兽式虎咆
	    WAR.L_NOT_MOVE[eid] = 1
        WAR.ATKDOWN[eid] = WAR.ATKDOWN[eid] or 0 + 30	
	end
  
    if WAR.TQS ==1 and DWPD() then ----沼跃鱼：滕青山拟兽式蛇咬
	    WAR.GUDUVICTIE[eid] = 2
        WAR.L_WNGZL[eid] = WAR.L_WNGZL[eid] or 0 + 30	
	end

    if XYL(pid) and WAR.XYLCZ == 3 and DWPD() and hurt > 0 then	--豸苗：谢云流万剑归宗
	    WAR.DEFDOWN[eid] = 30
	    WAR.WJGZ[eid] = 1
	end
	
	if jtyl(pid) then --谢无悠九天
	    --addeffect(WAR.JTWW, pid, 1)
	    WAR.JTWW = 3
	end
	
	--1-10-寒冰真气
	if (wglw(pid,124) or (DT(pid,22) and PersonKF(pid,124))) and WAR.HBZQ[eid] == nil and DWPD() then 
	    WAR.HBZQ[eid] = 60
	end  
	
	if jtyl(pid) and (WAR.JTYL == 5 or WAR.JTYL == 9) and DWPD() then --谢无悠
	    WAR.ICEXS[eid]=1
	    WAR.HOT[eid] = (WAR.HOT[eid] or 0) + 50
	    WAR.HOTXS[eid]=1
	    WAR.ICE[eid] = (WAR.ICE[eid] or 0) + 50
	    WAR.CHXS[eid]=1
	    WAR.CHZ[eid] = (WAR.CHZ[eid] or 0) + 50
	    WAR.LXXS[eid]=1
	    WAR.LXZT[eid] = (WAR.LXZT[eid] or 0) + 50
	    JY.Person[eid]["受伤程度"] = 100
	end	
	if jtyl(pid) and (WAR.JTYL == 6 or WAR.JTYL == 9) and DWPD() then --谢无悠 
	    WAR.LGQJ[eid] = 25
	end
	if jtyl(pid) and (WAR.JTYL == 7 or WAR.JTYL == 9) and DWPD() then --谢无悠 
	    WAR.ZSWQ[eid] = 25
	end	
    if (MPPD(pid) == 11 and wugong == 131 and WAR.SJL == 3 and DWPD() and hurt > 0)
	or (XYL(pid) and WAR.XYLCZ1 == 2 and DWPD() and hurt > 0 ) then			--豸苗：一刀流破防
	    WAR.DEFDOWN[eid] = 30
	end--[[
	if NF(pid) and DWPD() and hurt > 0 then
	    WAR.DEFDOWN[eid] = 30
	end]]
	if txjid(pid) and JLSD(10,40,pid) then --玄一无相
	    WAR.XYWX[100+eid] = 50
	end
    if wugong==66 and (DT(pid,103) or DT(pid,595)) and WAR.CHD==3 then--沼跃鱼：鸠摩智残火刀二式
        WAR.YANGKANG=1
	    local ns= math.modf(JY.Person[eid]["受伤程度"])
	    WAR.LXXS[eid]=1
	    WAR.LXZT[eid] = (WAR.LXZT[eid] or 0) + ns
	    WAR.OYFSD[eid] = (WAR.OYFSD[eid] or 0) + ns
    end
	
    if wugong==66 and (DT(pid,103) or DT(pid,595)) and WAR.CHD==2 then--沼跃鱼：鸠摩智残火刀三式
 		WAR.ICEXS[eid]=1
		WAR.HOTXS[eid]=1
		local ns= math.modf(JY.Person[eid]["受伤程度"])
		WAR.ICE[eid] = WAR.ICE[eid] or 0 + ns
		WAR.HOT[eid] = WAR.HOT[eid] or 0 + ns
		WAR.PEACE[eid] = WAR.PEACE[eid] or 0 + ns
		WAR.CHXS[eid]=1
	    WAR.CHZ[eid] = WAR.CHZ[eid] or 0 + ns
    end	
	
    if DT(pid,51) and WAR.DZXY == 1 and WAR.WJDZ == 2 then --沼跃鱼：慕容复无间斗转2
        WAR.Person[WAR.CurID][CC.TXWZ1] = "修罗・受苦无间"
		WAR.ICEXS[eid]=1
		WAR.HOTXS[eid]=1
		WAR.ICE[eid] = WAR.ICE[eid] or 0 + 30
		WAR.HOT[eid] = WAR.HOT[eid] or 0 + 30
		WAR.PEACE[eid] = WAR.PEACE[eid] or 0 + 30
	end
		
	if DT(pid,51) and WAR.DZXY == 1 and WAR.WJDZ == 4 then --沼跃鱼：慕容复无间斗转4
        WAR.Person[WAR.CurID][CC.TXWZ1] = "修罗・命无间"
		local SN=math.modf(JY.Person[eid]["生命"]/200*WAR.WJDZ2)
		WAR.LXXS[eid] = 1
	    WAR.LXZT[eid] = limitX((WAR.LXZT[eid] or 0) + SN, 0, 100)
	    WAR.OYFSD[eid] = limitX((WAR.OYFSD[eid] or 0) + SN, 0, 100)
		SN=SN*5
	    WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", SN)
	end
	
	if DT(pid,51) and WAR.DZXY == 1 and WAR.WJDZ == 3 then --沼跃鱼：慕容复无间斗转3
        WAR.Person[WAR.CurID][CC.TXWZ1] = "修罗・时无间"
		for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[j]["死亡"] == false then
			    WAR.LHFM[WAR.Person[j]["人物编号"]] = WAR.LHFM[WAR.Person[j]["人物编号"]] or 0 +25+WAR.WJDZ2
			end
		end
		    WAR.QFY1[pid] = WAR.QFY1[pid] or 0 + 25+WAR.WJDZ2
	end
	
	if DT(pid,51) and WAR.DZXY == 1 and WAR.WJDZ == 3 then --沼跃鱼：慕容复无间斗转5
		WAR.Person[WAR.CurID][CC.TXWZ1] = "修罗・身形无间"
		WAR.KHG[eid] = 20
		WAR.WJDZ3 = WAR.WJDZ3+2
	end
	
	if wugong == 176 and (DT(pid, 117) or wglw1(pid,176))	or DT(pid,618) then
	    if WAR.ssf == 1 then 
	        WAR.HOTXS[eid] = 1
            WAR.HOT[eid] = (WAR.HOT[eid] or 0) + 50
	        WAR.ssf[1000+eid] = 100
        elseif WAR.ssf == 2 then
	        WAR.ICEXS[eid] = 1
            WAR.ICE[eid] = (WAR.ICE[eid] or 0) + 50
	        WAR.ssf[2000+eid] = 100
        end
    end
	
    if DWPD() then -- 豸苗：童姥八荒八灭
        if WAR.BHBM == 1 then 
	        WAR.HOTXS[eid] = 1
            WAR.HOT[eid] = (WAR.HOT[eid] or 0) + 25
	        WAR.bhbm[1000+eid] = 50
        elseif WAR.BHBM == 2 then
	        WAR.ICEXS[eid] = 1
            WAR.ICE[eid] = (WAR.ICE[eid] or 0) + 25
	        WAR.bhbm[2000+eid] = 50
        end
    end
	
    --温青青，使用雷震剑法
    if WAR.WQQ == 1 then
        hurt = hurt * (1 + math.random(200) / 100)
    end
  
    if wglw(pid,103) or (PersonGT(pid, 103) and (DT(pid, 62) or DT(pid, 594))) or (DT(pid, 662) and PersonKF(pid, 103)) and WAR.LXQJ1 == 1 and DWPD() then --血龙
	    WAR.LXQJ[100+eid] = 1
    end
  
    if wglw1(pid,66) or (PersonKFJ(pid, 66) and (DT(pid, 103) or DT(pid, 595))) and WAR.HYDX1 == 1 and DWPD() then --血龙
	    WAR.HYDM[100+eid] = 1
    end

    if NF(pid) and yongdao(wugong) and WAR.XYDY == 1 and juexing() > 0 and DWPD() then
		WAR.XYDH[100+eid] = 1
	end		

    if MPPD(pid) == 9 and DWPD() and (DT(pid, 93) or yongan(wugong)) then --唐门模式
        if WAR.LZZ == 1 then
            WAR.SZWH[eid] = 15
	    end
        if WAR.HXB == 1 then
            WAR.HXB1[100+eid] = 50
			if ((DT(pid, 92) and TMQ(pid)) or DT(pid, 93)) and JX(pid) then
				for j = 0, WAR.PersonNum - 1 do
					if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
						local tmppid = WAR.Person[j]["人物编号"]
						if WAR.HXB1[100+tmppid] ~= nil then
							WAR.HXB1[100+tmppid] = WAR.HXB1[100+tmppid] + 50
						else
							WAR.HXB1[100+tmppid] = 50
						end
					end
	            end
			end
	    end
        if WAR.CXN == 1 then
            WAR.HXB1[200+eid] = 50
	    end
        if WAR.JTJD1 == 1 then
            WAR.JTJD[eid] = 1
	    end
    end
	
  	--沼跃鱼：老顽童武痴心得
    if DT(pid , 64)  then
        WAR.KMWD1= WAR.KMWD1+1
	    if WAR.KMWD1 >=6 then
	        WAR.KMWD1=6
	    end
	        WAR.KMWD2=math.modf(WAR.KMWD2*WAR.KMWD1*0.16)
    end
	
	--沼跃鱼：老顽童空明武道
    if DT(pid , 64) and (JLSD(10,40,pid) or (WAR.ZYHB>1 and WAR.ACT>1)) then
        WAR.KMWD= 1
	    WAR.KMSH=WAR.KMSH+1
	    WAR.Person[WAR.CurID][CC.TXWZ2]="空明武道"
	    WAR.Person[WAR.CurID][CC.TXDH]=139
	    WAR.KMWD3[eid]=1
	    if JLSD(10,40,pid) then
	        WAR.KMWD = 2
	        local aa = WAR.KMWD2
			AddPersonAttrib(eid, "生命", -WAR.KMWD2)
	        WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) +aa;
	        WAR.KMWD2=0
	        WAR.Person[WAR.CurID][CC.TXWZ2]="空明武道.极"
	        WAR.Person[WAR.CurID][CC.TXDH]=117
	    end
    end

    if WAR.ZCDZ ==1 and hasDZ(pid,11)  then --沼跃鱼：战意组件11
	    WAR.KMWD2=math.modf(WAR.KMWD2*0.5)
	    AddPersonAttrib(eid, "生命", -WAR.KMWD2)
	    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) +AddPersonAttrib(eid, "生命", -WAR.KMWD2);
	    WAR.KMWD2=0	
    end 
 
  	--沼跃鱼:明教圣火阵
    if MPPD(pid) == 13 then
        local shz = 0
	    local xg = MPDJ(pid)
        for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
                shz = shz + 1
            end
        end
        if shz >= 2 then
    	    hurt = math.modf(hurt * (1 + (shz)*0.02*xg))
    	    ang = ang + (shz) * 100
 	    end
	    if shz > 8 then
	        shz = 8
	    end
    end
  
    if WAR.ZCDZ ==1 and hasDZ(pid,4)  then --沼跃鱼：战意组件4
        WAR.BJ=1	
    end 
  
    --全真七星北斗阵
    if MPPD(pid) == 16 then
        local shz = 0
	    local xg = MPDJ(pid)
        for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
                shz = shz + 1
            end
        end
        if shz >= 2 then
    	    ang = ang + (shz) * 100*xg
 	    end
    end 
  
    if T13TQS(pid) and WAR.HIDE[pid]~=nil and WAR.HIDE[pid] > 0 then  --沼跃鱼：滕青山豹王.潜影杀机
        hurt = hurt *math.random(3,5)
	    effect(47,"特效文字1","豹王.潜影杀机",500,0) 
    end
  
    if wssz(pid) and WAR.HIDE[pid]~=nil and WAR.HIDE[pid] > 0 then  --沼跃鱼：滕青山豹王.潜影杀机
        hurt = hurt *math.random(3,5)
	    effect(47,"特效文字1","豹王.潜影杀机",500,0) 
    end
 
    if DT(pid,104) and JX(pid) and WAR.HIDE[pid]~=nil and WAR.HIDE[pid] > 0 then  --沼跃鱼：滕青山豹王.潜影杀机
	    hurt = hurt+ math.modf(WAR.SPIRIT[pid]*1.5)
	    local str="炫光舞法.时空逆转"
	    WAR.QDP1=math.modf(WAR.SPIRIT[pid]*2.5)
	    if JLSD(10,30,pid) or WAR.LQZ[pid]==100 then
	        WAR.QDP1=1005
	        str="真炫光舞法.空间神行"
	    end
	    effect(67,"特效文字2",str,500,0) 
    end
  
    if (wglw(pid,93) or DT(pid,66)) and WAR.HIDE[pid]~=nil and WAR.HIDE[pid] > 0 then
        hurt = hurt *2
    end
  
    if DT(pid,618) and PersonKF(pid, 98) and WAR.HIDE[pid]~=nil and WAR.HIDE[pid] > 0 then
        hurt = hurt *2
    end
  
    --宋青书 有女的攻击加成
    if pid == 82 then
        local s = 0
        for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] and JY.Person[WAR.Person[j]["人物编号"]]["性别"] == 1 then
                s = s + 1
            end
        end
        hurt = hurt * (1 + (s) / 10)
    end
	
    if DT1(pid,82) then
  	    local s = 0
        for j = 1, CC.TeamNum do
            if JY.Base["队伍"..j] == -1 then
	  	        break  	
	        end
	        if JY.Person[JY.Base["队伍"..j]]["性别"] == 1 then
                s = s + 1
            end
        end
            hurt = hurt * (1 + (s) / 10)
    end
  
    if DT(pid, 7) then
	    local wife = 0
	    for j = 0, WAR.PersonNum - 1 do
	        if WAR.Person[j]["死亡"] == false and WAR.Person[j]["人物编号"] == 166 then
		        wife = 1
		        break
	        end
	    end  
	    if wife == 1 then
		    hurt = hurt * 1.5
	    else
		    if JY.Person[eid]["性别"] == 1 then
			    hurt = hurt * 0.5
		    end
	    end
    end
    
	--蓝烟清：被太玄加力攻击的敌人，攻击时消耗体力加倍
    --[[if WAR.L_SGJL == 102 then
  	    if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emenyid]["我方"] then
  		   WAR.L_TXSG[eid] = 1;
  	    end
    end]]
  
    --五岳剑派
    if MPPD(pid) == 14 and yongjian(wugong) then
        local mpdj = MPDJ(pid)*0.05
  	    hurt = math.modf(hurt*(1 + (mpdj)));
    end
  
    if MPPD(pid)==13 and WAR.HIDE[pid]~=nil and WAR.HIDE[pid] > 0 then  --沼跃鱼：滕青山豹王.潜影杀机
	    --local str="焚影圣诀.暗影突袭"
	    local aa=500
	    if yongdao(wugong) then
	        aa=aa+100*MPDJ(pid)
	        AddPersonAttrib(eid,"中毒程度", 30);
	        WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) +AddPersonAttrib(eid, "生命", -100);
			WAR.SZWH[eid]= WAR.SZWH[eid] or 0 +30+3*MPDJ(pid)
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
  		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .."+" .."焚影圣诀・影刀突杀"
			else
  		    WAR.Person[emenyid][CC.TXWZ2] = "焚影圣诀・影刀突杀"
			end 
	    elseif yongte(wugong) then
	        WAR.BJ=1
            local bb=WAR.HOT[eid] or 0
	        AddPersonAttrib(eid,"受伤程度", bb);
	        WAR.HOTXS[eid] =1
	        WAR.HOT[eid]= WAR.HOT[eid] or 0 +30+3*MPDJ(pid) 
			WAR.SZWH[eid]= WAR.SZWH[eid] or 0 +30+3*MPDJ(pid)
			if JLSD(10,30,pid) then
				WAR.HIDE[pid]=WAR.HIDE[pid]+10+3*MPDJ(pid)
			end
	        --str="焚影圣诀.火影无双"
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .."+" .."焚影圣诀・火影无双"
			else
				WAR.Person[emenyid][CC.TXWZ2] = "焚影圣诀・火影无双"
			end 
	    elseif MPDJ(pid) > 3 then
			aa=aa+100*MPDJ(pid)
	        WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid,"中毒程度", 30)
			WAR.SZWH[eid]= WAR.SZWH[eid] or 0 +30+3*MPDJ(pid)
			WAR.HOTXS[eid] =1
	        WAR.HOT[eid]= WAR.HOT[eid] or 0 +30+3*MPDJ(pid)
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .."+" .."焚影圣诀・暗影突袭"
			else
				WAR.Person[emenyid][CC.TXWZ2] = "焚影圣诀・暗影突袭"
			end
		end
	    ang=ang+aa
    end
  
    --崆峒掌派
	if MPPD(pid) == 18 and MPDJ(pid) >= 5 then
		local a = math.modf(JY.Person[pid]["内力"] / 300)
  	    WAR.HOT[eid] = 1
	    WAR.HOTXS[eid] = limitX((WAR.HOT[eid] or 0) + a, 0, 10)
	    WAR.ICE[eid] = 1
	    WAR.ICEXS[eid] = limitX((WAR.ICE[eid] or 0) + a, 0, 10)
	end	

    --冰糖恋：瓦尔拉齐称号特效  改为70%的机率上毒30点
    if DT(pid , 138) then
        if JLSD(25, 95, 138) then
    	    WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid,"中毒程度", 30);
    	    WAR.Person[WAR.CurID][CC.TXWZ3] = RWWH[138];  	
	    end
    end
  
    --逆运走火
    if WAR.tmp[1000 + pid] == 1 then
        hurt = hurt * 1.3
    end

    if JY.Person[pid]["武功" .. wugong] == 26 and DT(pid,55) then
		hurt = hurt + 300
	end	

    if wglw(pid,185) or (PersonGT(pid,185) and DT(pid,5)) or DT(pid,666) then  --武当九阳
		hurt = hurt + 300
	end	

    if wglw(pid,188) or (DT(pid,48) and PersonGT(pid,188)) then --神足经
		hurt = hurt + 500
	end 	

    --张三丰
    --[[if DT(pid, 5) and WAR.ZDDH > 220 then
         hurt = math.modf(hurt * 1.2)
    end]]
  
    hurt = math.modf(hurt)
	
    --欧阳锋  敌人伤害提高
    if DT(eid, 60) and WAR.ZDDH == 171 then
        hurt = math.modf(hurt * 1.2)
    end
 
    --青青大暴伤害提高5%
    if DT3(pid, 91) and WAR.QQDB == 1 then
	    hurt = math.modf(hurt * 1.05)
    end
  
    if DT(pid, 140) and DWPD() then --风清扬伤害加成
	    local tmp = sixi(eid, 1)
	    if tmp < sixi(eid, 2) then tmp = sixi(eid, 2) end
	    if tmp < sixi(eid, 3) then tmp = sixi(eid, 3) end
	    if tmp < sixi(eid, 4) then tmp = sixi(eid, 4) end
	        hurt = math.modf(hurt * (1 + tmp / 240))
	        ang = math.modf(ang * (1 + tmp / 240))
    end

    --百分比增加伤害
	if WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then 
		for i = 1, #CC.ZGT3 do
			if (CC.ZGT3[i][1] == wugong or (T12YMZ(pid) and wugong == 112)) and (PersonGTJL(pid, CC.ZGT3[i][2], WAR.NGJL) or ((PersonGTJL(pid,9999, WAR.NGJL) and (JY.Thing[224]["加攻击力"]) == CC.ZGT3[i][2] or JY.Thing[224]["加防御力"]) == CC.ZGT3[i][2])) then
				hurt = math.modf(hurt * (1 + CC.ZGT3[i][3] / 100))
				break
			end
		end
	end  
    --1-26-and (PersonGTJL(pid, CC.ZGT3[i][2], WAR.NGJL) or ((PersonGTJL(pid,9999, WAR.NGJL) and (JY.Thing[224]["加攻击力"]) == CC.ZGT3[i][2] or JY.Thing[224]["加防御力"]) == CC.ZGT3[i][2])) then
	if WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then 
		for i = 1, #CC.ZGT3 do
			if (CC.ZGT3[i][1] == WAR.HLTX or CC.ZGT3[i][2] == WAR.HLTX) and (wglw(pid,102) or (DT(pid,38) and PersonKF(pid,102))) then
				hurt = math.modf(hurt * (1 + CC.ZGT3[i][3] / 100))
				break
			end
		end
	end 
    --豸苗：折梅手
	if WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then 
		for i = 1, #CC.ZGT3 do
	        for l = 1,10 do
	            local jl = 15 + math.modf(JY.Person[pid]["实战"] / 20)+ math.modf(JY.Person[pid]["武学常识"] / 10)
	            if wugong == 14 and (JLSD(0,5+jl,pid) or (MPPD(pid)==7 and JLSD(0,15,pid))) and JY.Person[pid]["内力"] >= 7000 then
	                if JY.Person[pid]["武功" .. l] == CC.ZGT3[i][1] then
				        hurt = math.modf(hurt * (1 + CC.ZGT3[i][3] / 100))
				        WAR.ZMS = 1
				        break
			        end
		        end
		    end
		end
	end 
	
	if DWPD() then
		hurt = math.modf(hurt * (1 + gangxi(pid, wugong)))	
	end
    
    --三大圣使 圣火阵
    if (WAR.ZDDH == 14 or WAR.ZDDH == 360) and (pid == 173 or pid == 174 or pid == 175) then
        local shz = 0
        for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
                shz = shz + 1
            end
        end
        if shz == 3 then
    	    hurt = math.modf(hurt * 1.5)
    	    ang = ang + 1000
 	    end
    end
  
    --波斯三圣使
    if (WAR.ZDDH == 14 or WAR.ZDDH == 360) and (eid == 173 or eid == 174 or eid == 175) then
        local shz = 0
        for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] then
                shz = shz + 1
            end
        end
        if shz == 3 then
    	    hurt = math.modf(hurt * 0.5)
    	    dng = dng + 1000
  	    end
    end
    
    --全真七子，天罡北斗阵，增加伤害和气攻
    if WAR.ZDDH == 73 then
        local num = 0
        for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] and WAR.Person[WAR.CurID]["我方"] == false then
                num = num + 1
            end
        end
	    --if num>7 then num=7 end
        for n=1, num do
    	    hurt = math.modf(hurt * (1+0.04))
    	    ang = ang + 100
        end
    end
  
    --全真七子，天罡北斗阵，减少伤害和增加气防
    if WAR.ZDDH == 73 then
        local num = 0
        for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] and WAR.Person[emenyid]["我方"] == false then
                num = num + 1
            end
        end
	    --if num>7 then num=7 end
        for n=1, num do
    	    hurt = math.modf(hurt * (1-0.03))
    	    dng = dng + 100
        end
    end
   
    --hurt = math.modf(hurt * limitX(1.2 - defadd / 240, 0.2, 1.2))

  	--罗汉伏魔神功杀气和伤害增加, 受当前内力和武功消耗内力影响
	if (wglw(pid,96) or (pid == 400 and JY.Person[pid]["姓名"] == "慧聪") or DT(pid,38) or DT(pid,615)) and WAR.LHXS == 1 then
	    local nlmod = JY.Person[pid]["内力"]/10000 
		local wgmod = JY.Wugong[wugong]["消耗内力点数"]/400
		local totalmod = 1 + nlmod * wgmod;
		ang = math.modf(ang * totalmod)
		hurt = math.modf(hurt * totalmod)
		WAR.LHFM[eid] = 20
	end

	--蓝烟清：新逆运伤害提高20%
	if WAR.L_NYZH[pid] ~= nil or wglw(pid,104) then
		hurt = math.modf(hurt * 1.2);
	end
	
	
	--蓝烟清：新内功护体，防护内功
    --蛤蟆功防护，蛤蟆蓄力，额外气防 --300+5*储气，伤害减储气/3
    if PersonKF(eid, 95) and DWPD() then
	    local jl = 30
	    if PersonGT(eid, 95) then
		    jl = jl + 20
	    end
	    if DT(eid, 60) or DT(eid, 620) or DT(eid, 61) then
		    jl = jl + 10
	    end
	    if JLSD(10, jl + 10, eid) then
		    if WAR.Person[emenyid][CC.TXWZ2] == nil then
			    WAR.Person[emenyid][CC.TXWZ2] = "蛤蟆功"
		    end		
		    local limit = 200
		    if PersonGT(eid, 95) then
			    limit = limit + 200
		    end	
		    if PersonKFJ(eid, 9) then
			    limit = limit + 80
		    end
		    if PersonKFJ(eid, 120) then
			    limit = limit + 150
		    end
		    if WAR.tmp[200 + eid] == nil or WAR.tmp[200 + eid] == 0 then
			    WAR.tmp[200 + eid] = 50;
		    else
			    WAR.tmp[200 + eid] = WAR.tmp[200 + eid] + 35;
		    end
		    if DT(eid, 61) or DT(eid, 60) or DT(eid, 620) then --欧阳克和欧阳锋额外储气10
			    WAR.tmp[200 + eid] = WAR.tmp[200 + eid] + 10;
			    limit = limit + 100
		    end
		    if MPPD(eid) == 8 then --武骧金星：白驼山弟子额外储气10
			    WAR.tmp[200 + eid] = WAR.tmp[200 + eid] + 10;
			    limit = limit + 100
		    end		
		    if WAR.tmp[200 + eid] > limit then WAR.tmp[200 + eid] = limit end
		        WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "・蛤蟆蓄力";
		        dng = dng + math.modf(3 * WAR.tmp[200 + eid])
		        --[[if PersonGT(eid, 95) then --蛤蟆主功体蓄力时减伤
			    hurt = hurt - math.modf(WAR.tmp[200 + eid]/3)
			    if hurt < 0 then hurt = 0 end
		            end		]]
	    end
    end
  
    --太极神功防护、蓄力、额外气防 --300+5*储气，伤害减储气/3
    if PersonGT(eid, 182) and DWPD() then
	    local jl = 30
	    if PersonGT(eid, 182) then
		    jl = jl + 20
	    end
	    if JLSD(10, jl + 10, eid) then
		    if WAR.Person[emenyid][CC.TXWZ2] == nil then
			    WAR.Person[emenyid][CC.TXWZ2] = "太极神功"
		    end		
		    local limit = 200
		    if WAR.tmp[200 + eid] == nil or WAR.tmp[200 + eid] == 0 then
			    WAR.tmp[200 + eid] = 50;
		    else
			    WAR.tmp[200 + eid] = WAR.tmp[200 + eid] + 35;
		    end	
		    if WAR.tmp[200 + eid] > limit then WAR.tmp[200 + eid] = limit end
		        WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "・阴阳蓄力";
		        dng = dng + math.modf(3 * WAR.tmp[200 + eid])
	    end
    end

    --[[伤害限制
    if hurt > 100 then 
        local a = hurt 
	    a = math.modf((a-100)/1.5) + 100
	    if a > 200 then
	        a = math.modf((a-200)/1.5) + 200
	    end
	    if a > 300 then
	        a = math.modf((a-300)/2) + 300
	    end
	    if a > 400 then
	        a = math.modf((a-400)/2.5) + 400
	    end
	    hurt = a
    end ]]
  
    --[[ 
    --龙象蓄力时，减少20%的伤害
    if WAR.Actup[eid] ~= nil and PersonKF(eid, 103) then
       hurt = math.modf(hurt * 0.8)
    end]]
   
    if getHZ(pid, 11) then  --涅印
  	    hurt = math.modf(hurt * (1 + (JY.Person[pid]["受伤程度"] * 0.005)))
    end  
  
    if wugong == 66 and (DT(pid,103) or DT(pid,595)) and WAR.CHD>1 then--沼跃鱼：鸠摩智残火刀前三式伤害
        hurt = math.modf(hurt*(1+0.15*(5-WAR.CHD)))
    end

    if MPPD(pid) == 13 then   
        local tymj = sixi(pid,1) +sixi(pid,2) + sixi(pid,3) + sixi(pid,4) + sixi(pid,5)
        hurt = math.modf(hurt * (1 + (tymj) * 0.002))
    end
  
    if WAR.QFY2[pid] ~= nil and WAR.QFY2[pid] > 0 and DWPD() then --破虏令伤害+30%
	    hurt = math.modf(hurt * 1.3)
    end
  
    if MPPD(pid) == 6 and MZ(pid)== 2 then --血祭
	    if WAR.XJ[pid] ~= nil then
		    hurt = math.modf(hurt * (1 + 0.05 * WAR.XJ[pid]))
	    end
    end
  
    if PersonGT(pid, 150) and MPPD(pid)==16 and WAR.ZYHB==0 then
        if JLSD(0,30,pid) then
		    WAR.ZYHB=1
	    end
    end
  
  	if (wugong == 37 or wugong == 60) and (wglw1(pid,60) or DT(pid,166)) and WAR.ZYHB==0 and not (MPPD(pid) == 14 and PersonGT(pid,90)) then
        if JLSD(0,30,pid) then
		    WAR.ZYHB=1
	    end
    end
  
    if wglw1(pid, 77) and WAR.ZYHB==0 then
        if JLSD(0,50,pid) then
		    WAR.ZYHB=1
	    end
    end
   
    if hasTF(pid, 61) then
	    if WAR.CLXL[pid] ~= nil then
		    hurt = math.modf(hurt * (1 + 0.1 * WAR.CLXL[pid]))	
	    end
    end
  
    if WAR.ZBX[pid] ~= nil then --醉八仙攻击*2
	    hurt = math.modf(hurt * 2)
    end
  
    if MPPD(pid) == 4 and WAR.YJZD2[pid] ~= nil then --以静制动
	    if WAR.YJZD2[pid][1] ~= nil then
		    AddPersonAttrib(eid, "受伤程度", WAR.YJZD2[pid][1])
	    end
	    if WAR.YJZD2[pid][2] ~= nil then
		    AddPersonAttrib(eid, "中毒程度", WAR.YJZD2[pid][2])
	    end
	    if WAR.YJZD2[pid][3] ~= nil then
		    WAR.FXXS[eid] = 1 
		    if WAR.FXDS[eid] == nil then
			    WAR.FXDS[eid] = WAR.YJZD2[pid][3]
		    else
			    WAR.FXDS[eid] = WAR.FXDS[eid] + WAR.YJZD2[pid][3]
		    end
	    end
	    if WAR.YJZD2[pid][4] ~= nil then
		    WAR.LXXS[eid] = 1
		    if WAR.LXZT[eid] == nil then
			    WAR.LXZT[eid] = WAR.YJZD2[pid][4]
		    else
			    WAR.LXZT[eid] = WAR.LXZT[eid] + WAR.YJZD2[pid][4]
		    end	
	    end
	    if WAR.YJZD2[pid][5] ~= nil then
		    if WAR.CHZ[eid] == nil then
			    WAR.CHZ[eid] = WAR.YJZD2[pid][5]
		    else
			    WAR.CHZ[eid] = WAR.CHZ[eid] + WAR.YJZD2[pid][5]
		    end		
		    WAR.CHXS[eid] = 1
	    end	
	    hurt = math.modf(hurt * 2)
    end
    

	if getHZ(pid, 7) then   --多情符    
		if JY.Person[pid]["性别"] ~= JY.Person[eid]["性别"] then
			hurt = math.modf(hurt * 0.9)
		end
	end  
	if getHZ(pid, 8) then   --无情符    
		if JY.Person[pid]["性别"] ~= JY.Person[eid]["性别"] then
			hurt = math.modf(hurt * 1.2)
		end
	end  
	if getHZ(eid, 8) then   --无情符    
		if JY.Person[pid]["性别"] ~= JY.Person[eid]["性别"] then
			hurt = math.modf(hurt * 1.1)
		end
	end	
  
	if hasTF(pid, 41) then
		if JY.Person[pid]["性别"] ~= JY.Person[eid]["性别"] then
			hurt = math.modf(hurt * 0.85)
		end	
	end	
  
 	if hasTF(eid, 42) then
		if JY.Person[pid]["性别"] ~= JY.Person[eid]["性别"] then
			hurt = math.modf(hurt * 1.15)
		end	
	end

	if hasTF(pid, 42) then
		if JY.Person[pid]["性别"] ~= JY.Person[eid]["性别"] then
			hurt = math.modf(hurt * 1.3)
		end	
	end	
	
	if hasTF(pid, 51) and DWPD() then
		hurt = math.modf(hurt * 1.5)		
	end			

	if hasTF(pid, 132) and DWPD() then
		hurt = math.modf(hurt * 0.5)		
	end			

	if hasTF(pid, 122) and DWPD() then
		hurt = math.modf(hurt * 0.5)		
	end				
	
	if hasTF(pid, 53) or hasTF(eid, 53) then
		local aa = JY.Person[eid]["攻击力"] + JY.Person[eid]["防御力"] + JY.Person[eid]["轻功"]
		local bb = JY.Person[pid]["攻击力"] + JY.Person[pid]["防御力"] + JY.Person[pid]["轻功"]
		if bb < aa and hasTF(pid, 53) then
			hurt = math.modf(hurt * 1.2)	
		elseif bb > aa and hasTF(eid, 53) then
			hurt = math.modf(hurt * 0.8)	
		end
	end
	
	if hasTF(pid, 58) then
		if JY.Person[eid]["内力性质"] == 0 and JY.Person[pid]["内力性质"] == 1 then
			hurt = math.modf(hurt * 1.3)
		elseif JY.Person[eid]["内力性质"] == 1 and JY.Person[pid]["内力性质"] == 0 then
			hurt = math.modf(hurt * 1.3)
		end
	end
	
	if hasTF(eid, 58) then
		if JY.Person[eid]["内力性质"] == 0 and JY.Person[pid]["内力性质"] == 1 then
			hurt = math.modf(hurt * 1.15)
		elseif JY.Person[eid]["内力性质"] == 1 and JY.Person[pid]["内力性质"] == 0 then
			hurt = math.modf(hurt * 1.15)
		end
	end	
	
	if hasTF(pid, 59) then
		hurt = math.modf(hurt * 1.3)
		if JY.Person[eid]["内力"] > JY.Person[pid]["内力"] then
			AddPersonAttrib(pid, "受伤程度", math.random(10))
		end
	end
	
	if DT(pid, 6) then
		hurt = math.modf(hurt * (1 + (21 - pcount(1)) * 0.025))
	end
  
    if T7DFWM(pid) and WAR.DFWM == 1 and DWPD() then --东方未明觉醒后生命50%以下，25%几率攻击加倍
	   hurt = math.modf(hurt * 2)
    end
  
    if LYR(pid) then --林月如怒气100
	    if WAR.LQZ[pid] ~= nil and WAR.LQZ[pid] >= 100 then
		    hurt = math.modf(hurt * 1.5)
	    end
    end
	
    if NF(pid) and juexing() > 0 then 
	    if WAR.LQZ[pid] ~= nil and WAR.LQZ[pid] >= 100 then
		    hurt = math.modf(hurt * 2)
	    end
    end	
	
    --[[
    if DT(pid, 112) then --萧远山攻击加成
	   if WAR.LXZT[pid] ~= nil then
		  hurt = math.modf(hurt * (1 + WAR.LXZT[pid] / 100))
	   end
	   if WAR.LQZ[pid] ~= nil and WAR.LQZ[pid] >= 100 then
		  hurt = math.modf(hurt * 1.5)
	   end
    end]]
  
    if DT(eid,50) and ZYBF(eid) and WAR.FS2 ~= 0 and DWPD() then 
  	    WAR.FXXS[pid] = 1 
	    WAR.FXDS[pid] = 20	
	    if WAR.FXDS[pid] == nil then
		    WAR.FXDS[pid] = 20
	    else
		    WAR.FXDS[pid] = WAR.FXDS[pid] + 20
	    end
    end

    if WAR.XLDL[pid] == 1 then 	
	    WAR.FXXS[pid] = 1
	    if WAR.FXDS[pid] == nil then
		    WAR.FXDS[pid] = 5
	    else
		    WAR.FXDS[pid] = WAR.FXDS[pid] + 5
	    end
    end
  
    if wglw(eid,106) or (DT(eid,9) and PersonGT(eid,106)) then
        WAR.FXXS[pid] = 1 
	    WAR.FXDS[pid] = 9	
	    if WAR.FXDS[pid] == nil then
		    WAR.FXDS[pid] = 9
	    else
		    WAR.FXDS[pid] = WAR.FXDS[pid] + 9
	    end
		if WAR.Person[emenyid][CC.TXWZ2] == nil then 
	        WAR.Person[emenyid][CC.TXWZ2] = "九阳・诸法不侵"
	    else 
	        WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+".."九阳・褚法不侵"
	    end
    end
	
    if wglw(eid,187) and PersonGT(eid,187) then
		hurt = math.modf(hurt * 0.5)
        WAR.FXXS[pid] = 1 
	    WAR.FXDS[pid] = 5	
	    if WAR.FXDS[pid] == nil then
		    WAR.FXDS[pid] = 5
	    else
		    WAR.FXDS[pid] = WAR.FXDS[pid] + 5
	    end
		if WAR.Person[emenyid][CC.TXWZ1] == nil then 
	        WAR.Person[emenyid][CC.TXWZ1] = "少林九阳・御"
	    else 
	        WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1].."+".."少林九阳・御"
	    end
    end	
	
    if WAR.MJBCJ[eid] ~=nil and DWPD() then
        local aa=WAR.MJBCJ[eid]
	    if aa==3 then--三次裁决为重大通缉犯，伤害2倍
	        aa=10
        end
        hurt=math.modf(hurt*(1+0.1*aa))
	    local SN=math.modf(hurt*0.1*aa)
	    WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", SN)--攻击被裁决者的赏金
	    WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", SN*10)
	end
  
    if T7DFWM(pid) and WAR.DFWM2 == 1 and DWPD() then --东方未明拳系封穴20
	    WAR.FXXS[eid] = 1 
	    WAR.FXDS[eid] = 20	
	    if WAR.FXDS[eid] == nil then
		    WAR.FXDS[eid] = 20
	    else
		    WAR.FXDS[eid] = WAR.FXDS[eid] + 20
	    end
    end
	
    if T7DFWM(pid) and yongquan(wugong) and JLSD(10,40,pid) and DWPD() then 
	    WAR.FXXS[eid] = 1 
	    WAR.FXDS[eid] = 20	
	    if WAR.FXDS[eid] == nil then
		    WAR.FXDS[eid] = 20
	    else
		    WAR.FXDS[eid] = WAR.FXDS[eid] + 20
	    end
    end	
	
    if MPPD(pid) == 18 and MPDJ(pid) >= 2 and PersonGT(pid,189) and JY.Person[pid]["拳掌功夫"] >= 300 and yongquan(wugong) then --崆峒拳系高级弟子
	    WAR.FXXS[eid] = 1 
	    WAR.FXDS[eid] = 30	
	    if WAR.FXDS[eid] == nil then
		    WAR.FXDS[eid] = 30
	    else
		    WAR.FXDS[eid] = WAR.FXDS[eid] + 30
	    end
    end	
	
	--华山拳系
    if (MPPD(pid) == 14 and PersonGT(pid,90) and JY.Person[pid]["拳掌功夫"] >= 200 and yongquan(wugong) and JLSD(10,40,pid)) or ((DT(pid,54) or DT(pid,185) or DT(pid,188)) and yongquan(wugong) and JLSD(10,45,pid)) then
	    WAR.FXXS[eid] = 1 
	    WAR.FXDS[eid] = 20	
	    if WAR.FXDS[eid] == nil then
		    WAR.FXDS[eid] = 20
	    else
		    WAR.FXDS[eid] = WAR.FXDS[eid] + 20
	    end
		if WAR.Person[emenyid][CC.TXWZ2] == nil then 
	        WAR.Person[emenyid][CC.TXWZ2] = "华山・铁指诀"
	    else 
	        WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+".."华山・铁指诀"
	    end
	end 			

    if WAR.FQDS == 2 or WAR.FQDS == 6 then
		WAR.FXXS[eid] = 1 
	    WAR.FXDS[eid] = 10	
	    if WAR.FXDS[eid] == nil then
		    WAR.FXDS[eid] = 10
	    else
		    WAR.FXDS[eid] = WAR.FXDS[eid] + 10
	    end
    end

    if JY.Person[pid]["武器"] == 50 and JLSD(10,40,pid) then --伏魔杵
		WAR.FXXS[eid] = 1 
	    WAR.FXDS[eid] = 10	
	    if WAR.FXDS[eid] == nil then
		    WAR.FXDS[eid] = 10
	    else
		    WAR.FXDS[eid] = WAR.FXDS[eid] + 8
	    end		
	end	
    if DT(pid, 58) or wglw1(pid,25) then
		WAR.FXXS[eid] = 50
		WAR.FXDS[eid] = 50
	end	
	
    if hasTF(pid, 157) then
		WAR.FXXS[eid] = 50
		WAR.FXDS[eid] = 50
	end	 	
	
    --豸苗：李秋水传音搜魂封穴
    if WAR.CYSH[eid] ~= nil then
        if WAR.LQZ[eid] ~= nil and WAR.LQZ[eid] == 100 then
            local aa = WAR.CYSH[eid]
 		    WAR.FXXS[eid]= 1 
		    WAR.FXDS[eid]= aa
		    if WAR.FXDS[eid] == nil then
		        WAR.FXDS[eid] = aa
	        else
		        WAR.FXDS[eid] = WAR.FXDS[eid] + aa
			end
	    end
    end			
	
    if wugong == 26 and (DT(pid,49) or DT(pid,617)) then --虚竹降龙掌	
		WAR.LQZ[eid] = 0
    end	

	if (wglw(pid,102) or (DT(pid,38) and PersonKF(pid,102)) or (T5BCF(pid) and juexing()>0)) and JLSD(0,40,pid) then 
	    if WAR.LQZ[eid] ~= nil and WAR.LQZ[eid] == 100 then
	        WAR.LQZ[eid] = 50
	        if WAR.Person[emenyid][CC.TXWZ3] == nil then 
	            WAR.Person[emenyid][CC.TXWZ3] = "浑沦太玄"
	        else 
	            WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."+".."浑沦太玄"
	        end
	    end 
	end 
	
    --豸苗：碧针清掌
    if DT(pid,164) and ZYJ(pid) and WAR.ACT == 1 and wugong == 18 then
	    WAR.FXXS[eid] = 1 
	    WAR.FXDS[eid] = 30	
	    if WAR.FXDS[eid] == nil then
		    WAR.FXDS[eid] = 30
	    else
		    WAR.FXDS[eid] = WAR.FXDS[eid] + 30
	    end
    end 
  
    --白驼山蛤蟆功封穴
	if MPPD(pid) == 8 and PersonGT(pid,95) and DWPD() then
		if DT(pid,61) and JLSD(10,50,pid) then
			WAR.FXXS[eid] = 1
			WAR.FXDS[eid] = 20
			if WAR.FXDS[eid] == nil then
				WAR.FXDS[eid] = 20
			else
				WAR.FXDS[eid] = WAR.FXDS[eid] + 20
			end 
		else
			WAR.FXXS[eid] = 1
			WAR.FXDS[eid] = 5
			if WAR.FXDS[eid] == nil then
				WAR.FXDS[eid] = 5
			else
				WAR.FXDS[eid] = WAR.FXDS[eid] + 10
			end
		end	
	end 			

    --弹指神通
    if wugong == 18 and (DT(pid,57) or wglw1(pid,18)) then
		WAR.FXXS[eid] = 1
		WAR.FXDS[eid] = 10
		if WAR.FXDS[eid] == nil then
			WAR.FXDS[eid] = 10
        else
		    WAR.FXDS[eid] = WAR.FXDS[eid] + 10
		end 
	end 			

    if (MPPD(pid)==13 and MPDJ(pid)>1) and PersonGT(pid, 93) then --沼跃鱼:明教焚影圣诀,几率击中破绽
        local mpdj=MPDJ(pid)
	    if JLSD(20,40+mpdj*5,pid) then
	        ang= math.modf(ang * (1 + (mpdj / 5)))
	        WAR.MCF=1
	        WAR.Person[emenyid][CC.TXWZ3] = "焚影圣诀.破绽贯通"
	        WAR.Person[emenyid][CC.TXDH] = 6
	    end
    end
  
    if (MPPD(pid)==13 and MPDJ(pid)>1) and PersonGT(pid, 93) and (yongdao(wugong) or yongte(wugong)) then --沼跃鱼:明教焚影圣诀,攻击眩晕敌人会增加伤害
        if WAR.SZWH[eid]~=nil and WAR.SZWH[eid]>=0 then
		    hurt = math.modf(hurt * 1.35)
	    end
		if JY.Person[pid]["轻功"] >= 999 or (JY.Person[pid]["轻功"] - JY.Person[eid]["轻功"] >= 100) then
			if PersonKF(pid,194) then
				WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid,"生命",-((WAR.LXZT[eid] or 0)*2))
				WAR.Person[emenyid][CC.TXWZ2] = "袖刃刺杀"
			end
		end	
    end	

    if MPPD(pid)==15 then --沼跃鱼:大理铁指寸劲
        local xishu=sixi(pid,1)
        ang=ang+xishu*20 
	    local mpdj=MPDJ(pid)
	    if PersonKF(pid, 17) then
	        mpdj=mpdj+1
	    end
	    if JLSD(20,40+mpdj*5,pid) then
	        ang= math.modf(ang * (1 + (mpdj / 5)))
	        WAR.Person[emenyid][CC.TXWZ3] = "大理秘手.铁指寸劲"
	        WAR.Person[emenyid][CC.TXDH] = 18
	    end
	end
  
    if DT(pid,602) then --段思平
        local xishu=sixi(pid,1)
        ang=ang+xishu*20 
	    local mpdj=MPDJ(pid)
	    if PersonKF(pid, 17) then
	        mpdj=mpdj+1
	    end
	    if JLSD(20,40+mpdj*5,pid) then
	        ang= math.modf(ang * (1 + (mpdj / 5)))
	        WAR.Person[emenyid][CC.TXWZ3] = "大理秘手 铁指寸劲"
	        WAR.Person[emenyid][CC.TXDH] = 18
	    end
	end
  
  	if T13TQS(pid)  then --沼跃鱼：气功与拳系数有关
	    local xishu=sixi(pid,1)
        ang=ang+xishu*15 
    end
	
    if wssz(pid)  then --沼跃鱼：气功与拳系数有关
	    local xishu=sixi(pid,1)
        ang=ang+xishu*15 
    end
	
    if MPPD(pid) == 18 and WAR.KTFT == 2 and JY.Person[pid]["特殊兵器"] >= 200 and yongte(wugong) and JLSD(10,45,pid) then --崆峒特系堂主
        local a = sixi(pid,4)
        ang = ang + a * 7 
	end		
	
    --[[
    --八荒六合功 主功体护体：减50%伤害变内力伤害,如果有北冥真气，减的内力变加一半
    if PersonGTHT(eid, 101, WAR.NGHT) and WAR.B_BMJQ[eid] ~= nil and WAR.B_BMJQ[eid] == 1 
	   and hurt > 0 and JY.Person[eid]["内力"] >= hurt and DWPD() then
	   hurt = math.modf(hurt/2);
  	   WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0)+hurt;
  	   AddPersonAttrib(eid, "内力", hurt);
    elseif PersonGTHT(eid, 101, WAR.NGHT) and hurt > 0 and JY.Person[eid]["内力"] >= (hurt + 500) and DWPD() then 	
  	   WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - math.modf(hurt * 0.4);
  	   AddPersonAttrib(eid, "内力", -math.modf(hurt * 0.4));
	   hurt = math.modf(hurt * 0.8);
    end]]     
  
    if ZLE(pid) and WAR.ZLE == 1 and DWPD() then --赵灵儿回魂仙梦50时序
	    if WAR.MENG[eid] == nil then
		    WAR.MENG[eid] = 50
	    end
    end

    --蓝烟清：五岳剑法，增加伤害
    if WAR.L_WYJFA > 0 then 	
	    if PersonGTJL(pid, 89, WAR.NGJL) then
		    hurt = math.modf(hurt * 1.35)
	    else
		    hurt = math.modf(hurt * 1.2)
	    end
	    --3增加内伤
	    if WAR.L_WYJFA == 3 and DWPD() then		
		    AddPersonAttrib(eid, "受伤程度", 10)
	    end
    end
    
    if WAR.FXHJ1 == 1 then 
		AddPersonAttrib(eid, "受伤程度", 15)	
	end	
	
    if BJY(pid) and yongquan(wugong) and JLSD(10,40,pid) then
		AddPersonAttrib(eid,"受伤程度", 20)
	end 		
	
    --侵略如火
	if WAR.FLHS3 == 1 then
		AddPersonAttrib(eid,"受伤程度", 15)
	end 				
	
    --白驼山蛤蟆功内伤
	if MPPD(pid) == 8 and PersonGT(pid,95) and JLSD(10,60,pid) then	
		AddPersonAttrib(eid,"受伤程度", 12)
	end 	
	
    --五岳剑派：五岳剑法，增加伤害
    if WAR.L_WYJFA1 == 1 or WAR.L_WYJFA2 == 1 or WAR.L_WYJFA3 == 1 or WAR.L_WYJFA4 == 1 or WAR.L_WYJFA5 == 1 then 	
	    if PersonGTJL(pid, 89, WAR.NGJL) then
		    hurt = math.modf(hurt * 1.15)
	    else
		    hurt = math.modf(hurt * 1.1)
	    end
	    --3增加内伤
	    if WAR.L_WYJFA3 == 1 and DWPD() then		
		    AddPersonAttrib(eid, "受伤程度", 20)
	    end
    end
	
    for j = 0, WAR.PersonNum - 1 do --香香光环
        if DT(WAR.Person[j]["人物编号"], 628) and WAR.Person[j]["死亡"] == false then --武骧金星：单通判定修正
		    if WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] and JY.Person[pid]["性别"] == 0 then
			    hurt = math.modf(hurt * 1.1)
		    elseif WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] and JY.Person[eid]["性别"] == 1 then
			    hurt = math.modf(hurt * 0.9)
		    end	  
	    end
    end

    for j = 0, WAR.PersonNum - 1 do
        if guwu(WAR.Person[j]["人物编号"]) > 0
		and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
            hurt = math.modf(hurt * (1 + guwu(WAR.Person[j]["人物编号"])))
        end
    end

    for j = 0, WAR.PersonNum - 1 do
        if hasTF(WAR.Person[j]["人物编号"], 69)
		and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
            hurt = math.modf(hurt * 1.15)
        end
    end	
	
    for j = 0, WAR.PersonNum - 1 do
        if hasTF(WAR.Person[j]["人物编号"], 73)
		and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[emenyid]["我方"] then
            hurt = math.modf(hurt * 1.15)
        end
    end	

	for j = 0, WAR.PersonNum - 1 do --魔音・碧海潮生12.26
	    if WAR.Person[j]["人物编号"]==0 and WAR.BHCS[WAR.Person[j]["人物编号"]] == 1 and WAR.Person[j]["死亡"] == false then 
	        if WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
		        hurt = math.modf(hurt*0.7)
		    end
	        if WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
		        hurt = math.modf(hurt*1.3)
		    end
	    end 
	end
	 
	for j = 0, WAR.PersonNum - 1 do --魔音・碧海潮生12.26
	    if WAR.Person[j]["人物编号"]==0 and WAR.BHCS[WAR.Person[j]["人物编号"]] == 1 and WAR.Person[j]["死亡"] == false then 
	        if WAR.Person[j]["我方"] ~= WAR.Person[emenyid]["我方"] then
		        hurt = math.modf(hurt*1.3)
		    end
	        if WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] then
		        hurt = math.modf(hurt*0.7)
		    end
	    end 
	end
	 
	for j = 0, WAR.PersonNum - 1 do --沼跃鱼：萧峰帝释天威效果--己方加攻
	    if DT(WAR.Person[j]["人物编号"], 50) and (WAR.Person[j]["人物编号"]==0 or WAR.Person[j]["人物编号"]==50) and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
		    local aa=WAR.Person[j]["人物编号"]
		    local bb=WAR.SPIRIT[aa]
		    local cc=(math.max(bb,100)-100)/250
		    if cc>0.25 then
		        cc=0.25
		    end
		    if DT(WAR.Person[j]["人物编号"], 50) and (WAR.Person[j]["人物编号"]==0 or WAR.Person[j]["人物编号"]==50) and WAR.LQZ[WAR.Person[j]["人物编号"]]~=nil and WAR.LQZ[WAR.Person[j]["人物编号"]]==100 then
		        cc=cc*2
		    end
		    hurt = math.modf(hurt * (1+cc))
		end
	end
	 
	for j = 0, WAR.PersonNum - 1 do --沼跃鱼：萧峰帝释天威效果--敌方减防
	    if DT(WAR.Person[j]["人物编号"], 50) and (WAR.Person[j]["人物编号"]==0 or WAR.Person[j]["人物编号"]==50) and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[emenyid]["我方"]then
		    local aa=WAR.Person[j]["人物编号"]
		    local bb=WAR.SPIRIT[aa]
		    local cc=(math.max(bb,100)-100)/250
		    if cc>0.25 then
		        cc=0.25
		    end
		    if DT(WAR.Person[j]["人物编号"], 50) and (WAR.Person[j]["人物编号"]==0 or WAR.Person[j]["人物编号"]==50) and WAR.LQZ[WAR.Person[j]["人物编号"]]~=nil and WAR.LQZ[WAR.Person[j]["人物编号"]]==100 then
		        cc=cc*2
		    end
		        hurt = math.modf(hurt * (1+cc))
		end
	end

	for j = 0, WAR.PersonNum - 1 do --峨眉派鼓舞士气，伤害提升50%
	    if MPPD(pid) == 17 or GX(WAR.Person[j]["人物编号"],0) and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
		    local aa = WAR.Person[j]["人物编号"]
		    local bb = WAR.SPIRIT[aa]
		    local cc = (math.max(bb,100)-100)/250
		    if cc > 0.5 then
		        cc = 0.5
		    end
		    if GX(WAR.Person[j]["人物编号"],0) and WAR.LQZ[WAR.Person[j]["人物编号"]] ~= nil and WAR.LQZ[WAR.Person[j]["人物编号"]] == 100 then
		        cc = cc * 2
		    end
		    hurt = math.modf(hurt * (1 + cc))
		end
	end

	for j = 0, WAR.PersonNum - 1 do --豸苗：降龙伏虎
	    if WAR.Person[j]["人物编号"]==0 and WAR.XLFH[WAR.Person[j]["人物编号"]] ~= nil and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
		    hurt = math.modf(hurt * 0.85)
	    end
	end
	 
	for j = 0, WAR.PersonNum - 1 do --豸苗：降龙伏虎
	    if WAR.Person[j]["人物编号"]==0 and WAR.XLFH[WAR.Person[j]["人物编号"]] ~= nil and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[emenyid]["我方"]then
		    hurt = math.modf(hurt * 1.15)
	    end
	end
	
    --蓝烟清：独孤求败攻击时，根据X变化
	if DT(pid , 592) then
	    if WAR.L_DGQB_X < 8 then
		    hurt = math.modf(hurt*(WAR.L_DGQB_X/5));
	    else
		    hurt = math.modf(hurt*(1 + WAR.L_DGQB_X/10));
	    end
	end
	 
    if MPPD(pid) == 4 then --武当攻击-10%
	    hurt = math.modf(hurt * 0.9)
    end  
  
	if XYL(pid) and WAR.XYLCZ == 1 and DWPD() then --豸苗：谢云流附加伤害
	    hurt = math.modf(hurt * (1+WAR.SHTY*0.1))
	    WAR.SHTY = 0
	end
	
    if WAR.BYCX[pid]~=nil then
        if WAR.XKZ>=1 then
	        local aa=math.modf((hurt+JY.Person[pid]["受伤程度"])*0.85*WAR.XKZ)
	        local bb=math.modf(aa*1.1 * WAR.XKZ)
	        if WAR.XKZ>=8 then
		        WAR.LYXJ[pid]=1
		    end
	        hurt = math.modf(hurt * 0.8)
	        WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", -bb)
	        WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", -aa)
	  	    WAR.Person[WAR.CurID][CC.TXWZ0] = "玉箫魔音.八音穿心"
	        WAR.Person[WAR.CurID][CC.TXDH] = 39
		    WAR.BYB=0
		    WAR.BYCX[pid]=nil
	    end
    end

    if hasTF(pid, 30) then
	    hurt = math.modf(hurt * 1.1)
    end
  
    if hasTF(pid, 31) then
	    hurt = math.modf(hurt * 1.3)
    end  
	
    --岳灵珊武功剑法加成
    if DT(pid, 79) then
        local JF = wgnumber(pid, 2)    
        hurt = hurt * (1 + 0.05 * (JF))
    end
  
    if hasTF(pid, 23) then
	    local xz = 0
	    for j = 0, WAR.PersonNum - 1 do
	        if WAR.Person[j]["死亡"] == true and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
		        xz = xz + 5
	        end
	    end
	    hurt = hurt * (1 + xz / 100)
    end
    if getHZ(pid, 32) then
        hurt = hurt * (1 + WAR.SQL / 20)
        ang = ang * (1 + WAR.SQL / 20)
    end
  
    if hasTF(pid, 25) then 
	    local s = 0
        for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
                s = s + 1
            end
        end  
	    hurt = hurt * (1 + s * 0.05)
    end
  
    if hasTF(pid, 36) then
	    if WAR.SEVENSTAR[pid] ~= nil and WAR.SEVENSTAR[pid] > 1 then
		    hurt = hurt * (1 + (WAR.SEVENSTAR[pid] - 1) * 0.03)
	    end
    end

    if FHXX(pid) then 
        local fhxy = 10
        for i = 1,HHH_GAME_SETTING["WG_COUNT_MAX"] do 
            if JY.Person[pid]["武功"..i] > 0 then 
                fhxy = fhxy -1 
            end
        end
        hurt = math.modf(hurt*(1+fhxy*0.3))
    end	

    --调整一下伤害----------------------
   --[[ if hurt > 200 then 
        local a = hurt 
	    if a > 200 then
	        a = math.modf((a-200)/1.5) + 200
	    end
	    if a > 300 then
	        a = math.modf((a-300)/2) + 300
	    end
	    if a > 400 then
	        a = math.modf((a-400)/3) + 400
	    end
	    if a > 600 then
	        a = math.modf((a-600)/4) + 600
	    end
	    if a > 800 then
	        a = math.modf((a-800)/6) + 800
	    end
	    if a >= 200 then 
	        a = math.modf(a/2) + 100
	    end  
	        hurt = a
    end ]]
    if hasTF(pid, 24) and WAR.ZBT[pid] ~= nil then
        hurt = hurt * (1 + WAR.ZBT[pid] / 20)
    end

    --天机盘龙
	if WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 and GetS(86, 2, 9, 5) == 3 and (pid == 5 or pid == 27 or pid == 50 or pid == 64 or pid == 114 or pid == 129 or pid == 140 or pid == 558 or pid == 599 or pid == 601 or pid == 602 or pid == 615 or pid == 618)then
		local ssdf = 0
	    for j = 1,WAR.PersonNum-1 do
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
			    ssdf = ssdf + 1
			end
	    end
           	hurt = math.modf(hurt * (1+ssdf*0.1))
    	    ang = ang + ssdf*250
		end        --天机盘龙
	  	if WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 and GetS(86, 2, 9, 5) == 3 and (eid == 5 or eid == 27 or eid == 50 or eid == 64 or eid == 114 or eid == 129 or eid == 140 or eid == 558 or eid == 599 or eid == 601 or eid == 602 or eid == 615 or eid == 618)then
		    local ssdf = 0
	        for j = 1,WAR.PersonNum-1 do
			    if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] then
			        ssdf = ssdf + 1
		        end
		    end
	    hurt = math.modf(hurt * (1-ssdf*0.05))
    	dng = dng + ssdf*250
	end	

    --宗师
	if WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 and GetS(86, 2, 11, 5) == 3 and (pid == 5 or pid == 50 or pid == 64 or pid == 129 or pid == 558 or pid == 599 or pid == 601)then
		local ssdf = 0
	    for j = 1,WAR.PersonNum-1 do
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
			    ssdf = ssdf + 1
			end
		end
           	hurt = math.modf(hurt * (1+ssdf*0.1))
    	    ang = ang + ssdf*250
		end        --宗师
	  	if WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 and GetS(86, 2, 11, 5) == 3 and (eid == 5 or eid == 50 or eid == 64 or eid == 129 or eid == 558 or eid == 599 or eid == 601)then
		    local ssdf = 0
	        for j = 1,WAR.PersonNum-1 do
			    if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] then
			        ssdf = ssdf + 1
		        end
		    end
	    hurt = math.modf(hurt * (1-ssdf*0.05))
    	dng = dng + ssdf*250
	end	
 
    --四神封绝
	if WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 and GetS(86, 2, 12, 5) == 3 and (pid == 5 or pid == 27 or pid == 50 or pid == 114)then
		local ssdf = 0
	    for j = 1,WAR.PersonNum-1 do
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
			    ssdf = ssdf + 1
		    end
		end
           	hurt = math.modf(hurt * (1+ssdf*0.1))
    	    ang = ang + ssdf*250
		end        --四神封绝
	  	if WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 and GetS(86, 2, 12, 5) == 3 and (eid == 5 or eid == 27 or eid == 50 or eid == 114)then
		    local ssdf = 0
	        for j = 1,WAR.PersonNum-1 do
		        if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] then
			        ssdf = ssdf + 1
		        end
		    end
		hurt = math.modf(hurt * (1-ssdf*0.05))
    	dng = dng + ssdf*250
    end	
		
    --天龙传说
	if WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 and GetS(86, 2, 14, 5) == 3 and (pid == 602 or pid == 615 or pid == 618)then
		local ssdf = 0
	    for j = 1,WAR.PersonNum-1 do
		    if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
			    ssdf = ssdf + 1
		    end
		end
           	hurt = math.modf(hurt * (1+ssdf*0.1))
    	    ang = ang + ssdf*250
		end        --天龙传说
	  	if WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 and GetS(86, 2, 14, 5) == 3 and (eid == 602 or eid == 615 or eid == 618)then
		    local ssdf = 0
	        for j = 1,WAR.PersonNum-1 do
		        if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] then
			        ssdf = ssdf + 1
		        end
		    end
		hurt = math.modf(hurt * (1-ssdf*0.05))
    	dng = dng + ssdf*250
    end			
		
    --豸苗：18铜人
    if WAR.ZDDH == 217 then
	    local sbtr = 0
		for j = 0, WAR.PersonNum - 1 do
	        if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] and WAR.Person[WAR.CurID]["我方"] == false then
	            sbtr = sbtr + 1
		    end
		end
		hurt = math.modf(hurt * (1+sbtr*0.02))
    	ang = ang + sbtr*60
	end
	
    --豸苗：18铜人
    if WAR.ZDDH == 217 then
	    local sbtr = 0
	    for j = 0, WAR.PersonNum - 1 do
	        if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] and WAR.Person[emenyid]["我方"] == false then
	            sbtr = sbtr + 1
		    end
		end
		hurt = math.modf(hurt * (1-sbtr*0.02))
        dng = dng + sbtr*60
	end
	
    if WAR.ZDDH == 331 and (eid >= 645 and eid <= 649) then --五行八卦阵
        local num = 0
        for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] and WAR.Person[emenyid]["我方"] == false then
                num = num + 1
            end
        end
        dng = dng + 500 * num
    end
  
    ---------------------------从这开始，↑为被调整一下伤害，↓是不被调整一下伤害
    if pid == 0 and zjtype()==1 and juexing()>0 and GetS(10, 0, 11, 0) == 1  then 
	    if WAR.LMBJ4==1 then 
		    hurt=math.modf(hurt*1.15)
		    effect(51,"特效文字2","隼旋初式.念奴娇",750,0)
	    elseif WAR.LMBJ4==2 then	
		    hurt=math.modf(hurt*1.3)
		    effect(52,"特效文字2","隼旋次式.破阵子",1500,0)
	    elseif WAR.LMBJ4==3 then	
            hurt=math.modf(hurt*1.5)
		    effect(53,"特效文字2","隼旋终式.满江红",3000,0)
	    end 
	    WAR.LMBJ4=0
    end
	
	if DT(pid,152) and JX(pid) then --萧秋水几率3-5连击，出招式，随机杀气
        if WAR.LMBJ4==2 then
		    hurt=math.modf(hurt*1.15)
		    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -50)
		elseif WAR.LMBJ4==3 then	
            hurt=math.modf(hurt*1.25)
		    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -100)
		elseif WAR.LMBJ4==4 then	
            hurt=math.modf(hurt*1.5)
			WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -150)
		elseif WAR.LMBJ4>=5 then	
            hurt=math.modf(hurt*2)
			WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -200)
		end
	end
	
	
	if pid == 0 and zjtype()==4 and juexing()>0 then 
	    if WAR.LMBJ4==1 then 
		    hurt=math.modf(hurt*1.15)
		    effect(51,"特效文字2","虚空初式.麒麟落地",750,0)
	    elseif WAR.LMBJ4==2 then	
		    hurt=math.modf(hurt*1.3)
		    effect(52,"特效文字2","虚空次式.凤凰回巢",1500,0)
	    elseif WAR.LMBJ4==3 then	
            hurt=math.modf(hurt*1.5)
		    effect(53,"特效文字2","虚空终式.蛟龙洗巷",3000,0)
	    end 
	    WAR.LMBJ4=0
    end
	
    if pid == 0 and zjtype()==4 and juexing()>0 and GetS(10, 0, 11, 0) == 1 and WAR.GJQJ2>0 then
	    hurt=math.modf(hurt*(1+0.1*WAR.GJQJ2))
	end  

    --蓝烟清：南山刀法，伤害加成
    if WAR.L_NSDF[eid] ~= nil then
  	    hurt = hurt * 2;
  	    ang = ang * 2;
  	    WAR.L_NSDF[eid] = nil;
    end

	--蓝烟清：南山刀法命中
	if WAR.L_NSDFCC == 1 and DWPD() then
		WAR.L_NSDF[eid] = 1;
	end 
 
    if WAR.TLHD == 1 then
		hurt = hurt + math.modf(JY.Person[eid]["受伤程度"] * 3)
	    if WAR.HOT[eid] ~= nil and WAR.HOT[eid] > 0 then
	        hurt = hurt * 3
	    end
	end 	
 
    if WAR.XQFJ[eid]~=nil and WAR.XQFJ[eid]>0 then
	    local aa= WAR.XQFJ[eid]
	    if aa<=0 then
	        aa=0
	    end
	    if aa>=600 then
	        aa=600
	    end
	    hurt = hurt +math.modf(1.5*aa)
        WAR.XQFJ[eid] = WAR.XQFJ[eid]-20
	    WAR.KHG[eid] = WAR.KHG[eid] or 0 + 20
        if WAR.XQFJ[eid]<=0 then
            WAR.XQFJ[eid]=nil 
        end	 
	end

	if WAR.XQFJ[eid]~=nil and  WAR.XQFJ[eid]<=0 then
        WAR.XQFJ[eid]=nil 
    end
	
	if WAR.XQFJ[pid]~=nil and  WAR.XQFJ[pid]<=0 then
        WAR.XQFJ[pid]=nil 
    end
	
	if WAR.LXYYJ >= 1 and T8LXY(pid) then ----沼跃鱼：李逍遥御剑术伤害与剑系数与御剑等级相关
		hurt = hurt + 50 + math.modf(10 * wgnumber(0, 2))
		if WAR.LXYYJ== 4 then
		    hurt = hurt + math.modf(JY.Person[eid]["内力"] * 0.05) 
		end
		hurt = hurt* math.modf(1 + (WAR.LXYKJ * WAR.LXYYJ / 100))
	end
	
	if (DT(pid,103) or DT(pid,595)) and WAR.CHDZS==1 then--残火刀终式伤害
	    hurt = hurt + math.modf(JY.Person[eid]["受伤程度"]  * 2)
	    hurt =  math.modf(hurt *(3-((JY.Person[eid]["内力最大值"]-JY.Person[eid]["内力"])/JY.Person[eid]["内力最大值"]))) 
	    if WAR.HOT[eid]~=nil and WAR.HOT[eid]>0 then
	        hurt = hurt*2
	    end
	    WAR.CHDZS=0--沼跃鱼：残火刀终式
	end
	
    if WAR.WYLW3==2 then--松明抚斩
	    hurt = hurt + math.modf(JY.Person[eid]["受伤程度"]  * 2)
	    hurt =  math.modf(hurt *(3-((JY.Person[eid]["内力最大值"]-JY.Person[eid]["内力"])/JY.Person[eid]["内力最大值"]))) 
	    if WAR.HOT[eid]~=nil and WAR.HOT[eid]>0 then
	        hurt = hurt*2
	    end
	end
	
	if WAR.DZDJ1==2 then--烈阳舞
	    hurt = hurt + math.modf(JY.Person[eid]["受伤程度"]  * 2)
	    hurt =  math.modf(hurt *(3-((JY.Person[eid]["内力最大值"]-JY.Person[eid]["内力"])/JY.Person[eid]["内力最大值"]))) 
	    if WAR.HOT[eid]~=nil and WAR.HOT[eid]>0 then
	        hurt = hurt*2
	    end
	end
	
    if NF(pid) and WAR.NJXY == 1 and juexing() > 2 then --聂风雪饮
	    hurt = hurt + math.modf((JY.Person[eid]["内伤程度"] + JY.Person[pid]["内伤程度"]) * 2)
	    hurt = math.modf(hurt *(2 - (JY.Person[eid]["内力最大值"] - JY.Person[eid]["内力"])/JY.Person[eid]["内力最大值"])) 
	    if WAR.ICE[eid]~=nil and WAR.ICE[eid]>0 then
	        hurt = hurt * 1.5
	    end
	    WAR.NJXY = 0
	end	
	
    if DT(pid,48) and WAR.DLY==1 then--游坦之战意技伤害
	    hurt = hurt + math.modf((JY.Person[eid]["中毒程度"] + JY.Person[pid]["中毒程度"]) * 0.5)
	    hurt = math.modf(hurt *(2-(JY.Person[eid]["内力最大值"]-JY.Person[eid]["内力"])/JY.Person[eid]["内力最大值"])) 
	    if WAR.ICE[eid]~=nil and WAR.ICE[eid]>0 then
	        hurt = hurt*2
	    end
	    WAR.DLY=0--沼跃鱼：游坦之地龙玉
	end

	if DT(pid,48) and JX(pid) and wugong == 21 and WAR.ICE[pid] ~= nil and WAR.ICE[eid] ~= nil then--游坦之觉醒后玄冥掌加强
	    hurt =  math.modf(hurt * ((WAR.ICE[pid] + WAR.ICE[eid])/10)) 
	    if WAR.ICE[eid]~=nil and WAR.ICE[eid]>0 and JLSD(10,60,pid) then
	        WAR.ICE[pid] = (WAR.ICE[pid] or 0 ) + (WAR.ICE[eid] /10)
	    end
	end

	if DT(pid,51) and WAR.XLWC==1 then--慕容修罗无惨
	    hurt = hurt + WAR.WJDZ2*75
	    WAR.WJDZ2=math.modf(WAR.WJDZ2/2)
	    WAR.XLWC=0--沼跃鱼：慕容修罗无惨
	end
	
	if DT(pid,53) and WAR.LMJQ3==1 then--段誉龙脉剑气
	    hurt = math.modf(hurt*(1 + WAR.LMJQ1/5))
	    WAR.LMJQ1=math.modf(WAR.LMJQ1/2)
        if WAR.LMJQ2[eid]~=nil then
	        local aa=WAR.LMJQ2[eid]*30
	        WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -aa)
	        WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", aa)
	        WAR.LMJQ2[eid]=0
	    end
	        WAR.LMJQ3=0
	end
	
	
	
    if BJY(pid) then
		hurt = math.modf(hurt + 10)
		WAR.XYQJ = math.modf(WAR.XYQJ + 10)
		if WAR.PYZJ[eid] ~= nil then
			local ad = WAR.PYZJ[eid] + 20	
			WAR.Person[WAR.CurID]["攻击力"] = (WAR.Person[WAR.CurID]["攻击力"] or 0) + AddPersonAttrib(pid, "内力", ad)
			WAR.PYZJ[eid] = 0
		end
	end		
	
	if T13TQS(pid) and WAR.SWHH>0 then  --沼跃鱼：滕青山累计攻击上升
        hurt = hurt + WAR.SWHH *75
	    hurt = hurt * math.modf((1 + WAR.SWHH / 50))
	    hurt = hurt * math.modf(2-(JY.Person[pid]["生命"] / JY.Person[pid]["生命最大值"]))
	    if WAR.SWFY>4 and juexing()>2 then
	        WAR.HB[pid] = (WAR.HB[pid] or 0) + 1
			--addeffect(WAR.HB, pid, 2)
	    end
    end
 
    if wglw1(pid,58) then  --沼跃鱼：滕青山累计攻击上升
	    hurt = hurt * math.modf(2-(JY.Person[pid]["生命"] / JY.Person[pid]["生命最大值"]))
    end
  
  	if wssz(pid) then  --沼跃鱼：滕青山累计攻击上升
        hurt = hurt + WAR.SWHH1 *75
	    hurt = hurt * math.modf((1 + WAR.SWHH1 / 50))
	    hurt = hurt * math.modf(2-(JY.Person[pid]["生命"] / JY.Person[pid]["生命最大值"]))
	    WAR.HB[pid] = (WAR.HB[pid] or 0) + 1
		--addeffect(WAR.HB, pid, 2)
    end
	
    if DT(pid,49) and WAR.LXSS==1 then
	    if WAR.TZ_XZ_SSH[eid]~=nil then
	        WAR.FXXS[eid] = 1
		    WAR.FXDS[eid] = WAR.FXDS[eid] or 0+30
	        if WAR.TZ_XZ_SSH2[eid]~=nil then
		        WAR.FXDS[eid] = WAR.FXDS[eid] or 0+10* WAR.TZ_XZ_SSH2[eid]--沼跃鱼：虚竹螺旋生死符
		    end
	    end   
	end
	
	if DT(pid,49) and WAR.LXSS==1 then
	    if WAR.TZ_XZ_SSH2[eid]~=nil then
	        ang=math.modf(ang*(1+WAR.TZ_XZ_SSH2[eid]*0.1))
	        if WAR.TZ_XZ_SSH[eid]~=nil then
		        WAR.FXDS[eid] = WAR.FXDS[eid] or 0+10* WAR.TZ_XZ_SSH2[eid]--沼跃鱼：虚竹螺旋生死符
		        hurt=hurt*2
		    end
	    end   
	end
	
	if DT(pid,51) and WAR.DZXY == 1 and WAR.WJDZ == 1 then --沼跃鱼：慕容复无间斗转1
        WAR.Person[WAR.CurID][CC.TXWZ1] = "修罗・趣果无间"
		hurt = hurt + math.modf((JY.Person[eid]["内力最大值"] - JY.Person[eid]["内力"])*0.015*WAR.WJDZ2)
		local SN=math.modf(JY.Person[eid]["生命"]/20*WAR.WJDZ2)
		WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", SN)
	end
	
	if pid == 0 and T6XQS(0) then --萧秋水金断根据剑系数
	    if WAR.XQS == 3 then
		    hurt = math.modf(hurt * (1+0.001*sixi(pid,2)))
	    end
    end
  
    if pid == 0 and T6XQS(0) then --萧秋水金断根据剑系数
	    if WAR.XQS == 7 then
		    hurt = math.modf(hurt * (1+0.001*sixi(pid,2)))
		    hurt = hurt+math.modf(sixi(pid,2)/5)
		    dng=0
	    end
    end
	
    if wglw1(pid,34) then --华山剑法领悟
	    if WAR.WYLW5 == 1 then
		    hurt = math.modf(hurt * (1+0.001*sixi(pid,2)))
		    hurt = hurt+math.modf(sixi(pid,2)/5)
		    dng=0
	    end
    end
  
    if WAR.FXHJ4 == 1 then
		dng = 0
    end

    if wugong == 177 and (DT(pid, 27) or wglw1(pid,177)) then --葵花神针剑系、暗系
		hurt = math.modf(hurt * (1+0.01*sixi(pid,2)))
        hurt = math.modf(hurt * (1+0.01*sixi(pid,5)))	
	end	
	
	if wugong == 140 and (wglw1(pid,140) or DT(pid,558)) then --阴风刀 袖白雪
		local aa=math.modf(1+0.03*sixi(pid,3))
		local cc=math.modf(1+0.01*sixi(pid,1))
		local bb=WAR.ICE[eid]
		hurt = math.modf(hurt * aa)
		hurt = math.modf(hurt * cc)
		if  WAR.LQZ[pid] == 100 then
			if WAR.ACT == 1 then
            hurt = math.modf(hurt * aa * 2)
			hurt = math.modf(hurt * cc * 2) 	
			elseif  WAR.ACT == 2 then
			hurt = math.modf(hurt * aa * 2.5)
			hurt = math.modf(hurt * cc * 2.5) 	
			hurt = math.modf(hurt * bb)	
			end
		end
	end
	
	if wugong == 24 and (DT(pid,615) or wglw1(pid,24)) and WAR.LQZ[pid] == 100 then --须弥山 灭罪真言
		local aa=math.modf(WAR.SPIRIT[pid] - (WAR.SPIRIT[eid]/2))
		local bb=math.modf(JY.Person[pid]["品德"] - (JY.Person[eid]["品德"]/2))--75
		local cc=math.modf(sixi(pid,1)*10)
		local dd=math.modf(JY.Person[pid]["内力最大值"] / 1)
		hurt = hurt + math.modf((((aa * bb) + cc + dd)/4))
		if WAR.WYQS[eid] == nil or (WAR.WYQS[eid] ~= nil and WAR.WYQS[eid] > 0) then
			WAR.WYQS[eid] = WAR.WYQS[eid] or 0 + 1
		end
		WAR.Person[emenyid][CC.TXDH] = 102
	end
	--八卦刀加伤害
	if wglw1(pid,138) and wugong == 138 then
		local cc=math.modf(sixi(pid,3)*1)
		hurt = hurt + math.modf(cc*3)
	end
	if WAR.GBXL==1 then
	    hurt = hurt + math.modf((JY.Person[eid]["内力最大值"] - JY.Person[eid]["内力"])*0.03)
	end
	
	if DT(pid,1) and WAR.HDYD >0 then--沼跃鱼：胡斐大招伤害
        hurt = hurt * (1 + math.modf(WAR.HDYD / 100))
    end
  
    if DT(pid,58) and WAR.XTDJ >0 then--沼跃鱼：杨过大招伤害
        hurt = hurt * (1 + math.modf(WAR.XTDJ / 1000))
    end
  
    if DT(pid,80) and WAR.NSTJ2 >0 then--沼跃鱼：张召重大招伤害
        local bb=JY.Person[eid]["受伤程度"]
        hurt = (hurt+bb) * (1 + math.modf(WAR.NSTJ2 / 1000))
    end
  
    if T7DFWM(pid) and WAR.DFWM2 == 5 then --东方未明暗系特技附加内力伤害
	    hurt = hurt + math.modf((JY.Person[eid]["内力最大值"] - JY.Person[eid]["内力"])*0.1)
    end	
	
    if DT(pid,50) and WAR.ACT==4 then--沼跃鱼：萧峰降龙第四掌秘手
        local aa=WAR.SPIRIT[pid]-100
	    hurt = hurt + math.max(aa,20) *10
	    hurt = hurt + math.modf(JY.Person[pid]["内力"] / 15)
	    WAR.BJ=1
    end		
	
	if WAR.YFDLW == 3 then --阴风刀领悟附加内力伤害
		local aa=(math.modf((JY.Person[pid]["内力最大值"] - JY.Person[eid]["内力"])*0.5))
		local bb=aa*0.05
	    hurt = hurt + aa
		WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) +	AddPersonAttrib(eid, "生命", -bb)
    end
	
	if WAR.XMSSZ == 5 then --须弥山第六式真伤
		local aa=JY.Person[eid]["受伤程度"]
		local bb=JY.Person[eid]["中毒程度"]
		local cc=WAR.HOT[eid] or 0
		local dd=WAR.ICE[eid] or 0 
		local ee=WAR.CHZ[eid] or 0
		local ff=WAR.FXDS[eid] or 0
		local gg=WAR.LXZT[eid] or 0
		local hh=aa+bb+cc+dd+ee+ff+gg
		if hh > 300 then hh= 300 end
		WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) +	AddPersonAttrib(eid, "生命", -((aa+bb+cc+dd+ee+ff+gg)/5))
		WAR.FXDS[eid] = nil
		WAR.CHZ[eid] = nil
		WAR.ICE[eid] = nil
		WAR.HOT[eid] = nil
		WAR.LXZT[eid] = nil
		AddPersonAttrib(eid, "受伤程度", -100)
		AddPersonAttrib(eid, "中毒程度", -100)
    end
	
    --少林不动明王，金刚不坏神功加力时达摩剑法造成特殊效果
    if (wugong == 136 and PersonGTJL(pid, 151, WAR.NGJL) and MPPD(pid) == 5 and MPDJ(pid) > 2) or (DT(pid,615) and JLSD(20,50,pid)) and
	    WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
	    local d = math.modf((JY.Person[pid]["内力"] - JY.Person[eid]["内力"]) /50)
        if d < 50 then
            d = 50
        end
  	    WAR.LXXS[eid] = 1
	    WAR.LXZT[eid] = limitX((WAR.LXZT[eid] or 0) + d, 0, 100)
	    hurt = hurt + math.modf((JY.Person[eid]["内力最大值"] - JY.Person[eid]["内力"])*0.005*d)
	    WAR.CHXS[eid]=1
	    WAR.CHZ[eid] = (WAR.CHZ[eid] or 0) + d
	    if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "不动明王.慧剑断妄"
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "不动明王.慧剑断妄"
	    end	
	        WAR.Person[emenyid][CC.TXDH] = 43
    end
  
    if (MPPD(pid) == 5 and PersonGTJL(pid, 96, WAR.NGJL) )  and yongdao(wugong) then --沼跃鱼：罗汉堂刀法
	    local d = math.modf(JY.Person[pid]["内力"] /500)
        if d < 10 then
            d = 10
        end
  	    WAR.LXXS[eid] = 1
	    WAR.LXZT[eid] = limitX((WAR.LXZT[eid] or 0) + d, 0, 100)
	    if JY.Person[pid]["武器"] >= 365 and JY.Person[pid]["武器"] <= 367 then
			hurt = hurt + math.modf((JY.Person[eid]["内力最大值"] - JY.Person[eid]["内力"])*0.03*d)
		else
			hurt = hurt + math.modf((JY.Person[eid]["内力最大值"] - JY.Person[eid]["内力"])*0.015*d)
		end
	    WAR.CHXS[eid]=1
	    WAR.CHZ[eid] = limitX((WAR.CHZ[eid] or 0) + d, 0, 100)
	    if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "韦陀镇魂.佛罪断杀"
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "韦陀镇魂.佛罪断杀"
	    end	
	        WAR.Person[emenyid][CC.TXDH] = 43
    end
  
  --少林不动明王，金刚不坏神功加力时龙爪手造成特殊效果
    if (wugong == 20 and PersonGTJL(pid, 151, WAR.NGJL) and MPPD(pid) == 5 and MPDJ(pid) > 1) or (DT(pid,615) and JLSD(20,50,pid)) and
	    WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
	    local d = math.modf((JY.Person[pid]["内力"] - JY.Person[eid]["内力"]) / 300)
	    local str=""
        if d < 10 then
            d = 10
        end
  	    WAR.LXXS[eid] = 1
	    WAR.LXZT[eid] = limitX((WAR.LXZT[eid] or 0) + d, 0, 100)
	    hurt = hurt + math.modf((JY.Person[eid]["内力最大值"] - JY.Person[eid]["内力"])*0.015*d)
	    if wglw(pid,151) then
	        if WAR.LXZT[eid]>50 then
	            local aa=math.modf(WAR.LXZT[eid]*math.random(1,3))
	            WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid,"生命",-aa)
	        end
	    end
	    local n=math.random(1,6)
	    if n>1 and n<4 then
	        WAR.OYFSD[eid] = limitX((WAR.OYFSD[eid] or 0) + d, 0, 100);
	        str=".软筋"
	    elseif n>4 and n<6 then
	        WAR.BZ[eid]=1
	        str=".碎骨"
	else
	    WAR.MENG[eid] = limitX((WAR.MENG[eid] or 0) + d, 0, 50)
	    str=".断脉"
	end
	    if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "不动明王.大力金刚指"..str
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "不动明王.大力金刚指"..str
	    end	
	        WAR.Person[emenyid][CC.TXDH] = 112
    end

    if wugong == 19  and WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
	    local d = math.modf((JY.Person[pid]["内力"] - JY.Person[eid]["内力"]) / 300)-10
        if d < 0 then
            d = 0
        end
  	    WAR.LXXS[eid] = 1
	    WAR.LXZT[eid] = limitX((WAR.LXZT[eid] or 0) + d, 0, 50)
	    if JLSD(10,60,pid) then
	        WAR.ICEXS[eid]=1
	        WAR.ICE[eid]=WAR.ICE[eid] or 0  + d
	    end
	    if PersonKFJ(pid,17) and JLSD(10,35,pid) then----螺旋气劲：阴寒
	        WAR.YHZJ[eid]=WAR.YHZJ[eid] or 0 + 1
		    if WAR.Person[emenyid][CC.TXWZ2] == nil then
		        WAR.Person[emenyid][CC.TXWZ2] = "螺旋气劲.阴寒"
	        else
		        WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "螺旋气劲.阴寒"
	        end	
	            WAR.Person[emenyid][CC.TXDH] = 112
	    end
    end
  
    if wugong == 17  and WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
	    local d = math.modf((JY.Person[pid]["内力"] - JY.Person[eid]["内力"]) / 300)-10
        if d < 0 then
            d = 0
        end
  	    WAR.FXXS[eid] = 1
	    WAR.FXDS[eid] = limitX((WAR.FXDS[eid] or 0) + d, 0, 50)
	    if JLSD(10,60,pid) then
	        WAR.HOTXS[eid]=1
	        WAR.HOT[eid]=WAR.HOT[eid] or 0 + d
	    end
	    if PersonKFJ(pid,19) and JLSD(10,35,pid) then----螺旋气劲：阴寒
	        WAR.HDGX[eid]=WAR.HDGX[eid] or 0 + 1
	        if WAR.Person[emenyid][CC.TXWZ2] == nil then
		        WAR.Person[emenyid][CC.TXWZ2] = "螺旋气劲.阳炙"
	        else
		        WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "螺旋气劲.阳炙"
	        end	
	            WAR.Person[emenyid][CC.TXDH] = 112
	    end
    end
  
        --霹雳刀法 天火围城
	if (DT(pid, 585) or wglw1(pid, 141)) and JLSD(30, 60, pid) and yongdao(wugong) then
        WAR.Person[emenyid][CC.TXDH] = 50
        if WAR.Person[emenyid][CC.TXWZ3] == nil then
            WAR.Person[emenyid][CC.TXWZ3] = "霹雳刀法・天火围城"
        else
            WAR.Person[emenyid][CC.TXWZ3] = "霹雳刀法・天火围城" .. "・" .. WAR.Person[emenyid][CC.TXWZ3]
        end
	    if WAR.LQZ[pid] ~= nil then
		    dng = 0
		    hurt = math.modf(hurt * 1.8)
	        ang = ang + 2500 + math.modf((WAR.LQZ[pid] or 0) * 100)
	    else
	        ang = ang + 2500
	    end
    end
  
    if (wglw(pid,182) or (DT(pid,5) and PersonGT(pid,182))) and WAR.LQZ[pid] == 100 then
        if WAR.LQZ[pid] ~= nil then
		    dng = 0
		    hurt = math.modf(hurt * 1.5)
	        ang = ang + 2500 + math.modf((WAR.LQZ[pid] or 0) * 100)
	    else
	        ang = ang + 2500
	    end
		WAR.TJJS = 1
	end	
	
    if (wglw(pid,184) and PersonGT(pid,184)) and WAR.LQZ[pid] == 100 or DT(pid,665) then
        if WAR.LQZ[pid] ~= nil then
		    dng = 0
		    hurt = math.modf(hurt * 1.5)
	        ang = ang + 2500 + math.modf((WAR.LQZ[pid] or 0) * 100)
	    else
	        ang = ang + 2500
	    end
		WAR.YJJS = 1
	end	
	
    if DT(pid,583)	then
		if WAR.LQZ[pid] ~= nil then
		    dng = 0
			hurt = math.modf(hurt * WAR.LQZ[pid])
		    ang = ang + 2500 + math.modf((WAR.LQZ[pid] or 0) * 100)
	    else
	        ang = ang + 2500
	    end	
	end 	
	
    --少林达摩院，易筋神功加力时龙爪手造成特殊效果
    if (wugong == 20 and PersonGTJL(pid, 108, WAR.NGJL) and MPPD(pid) == 5 and MPDJ(pid) > 1) or (DT(pid,615) and JLSD(20,50,pid)) and
	    WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
	    local d = math.modf((JY.Person[pid]["内力"] - JY.Person[eid]["内力"]) / 30)
	    local str=""
        if d < 10 then
            d = 10
        end
  	    WAR.FXXS[eid] = 1
	    WAR.FXDS[eid] = limitX((WAR.FXDS[eid] or 0) + d, 0, 100)
	    WAR.OYFSD[eid] = limitX((WAR.OYFSD[eid] or 0) + d, 0, 100);
	    local n=math.random(1,6)
	    WAR.DMZF=n
	    if n==1 then
	        str=".拈花指"
	        WAR.LHZF[eid]=WAR.LHZF[eid] or 0 +1
	    elseif n==2 then
	        WAR.DLYZ[eid]=WAR.DLYZ[eid] or 0 +1
	        str=".多罗叶指"
	    elseif n==3 then
	        str=".大智无定指"
	    elseif n==4 then
	        str=".寂灭抓"
	        WAR.PEACE[eid]=limitX((WAR.PEACE[eid] or 0) + d, 0, 100)
			for i = 0, WAR.PersonNum - 1 do 
				if WAR.Person[i]["我方"] == false and WAR.Person[i]["死亡"] == false and i ~= WAR.CurID then
				   WAR.Person[i].Time = math.max(WAR.Person[i].Time - 200, -500)
					AddPersonAttrib(WAR.Person[i]["人物编号"],"受伤程度", math.random(10,20))
				end
			end
	    elseif n==5 then
	       str=".去烦恼指"
	       WAR.LQZ[eid] = WAR.LQZ[eid] or 0 -100
	    if WAR.LQZ[eid]<0 then
	        WAR.LQZ[eid]=0
	    end
	else
	    str=".无相劫指"
	    local bb=math.random(2,4)
	    local aa=math.modf(JY.Person[eid]["生命"]/bb)
	    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0)-aa;
        AddPersonAttrib(eid, "生命", -aa)
	end
	    if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "达摩指爪精要."..str
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "达摩指爪精要."..str
	    end	
	        WAR.Person[emenyid][CC.TXDH] = 112
    end
  
    --乔峰龙爪手
    if DT(pid,50) then
	    local d = math.modf((JY.Person[pid]["内力"] - JY.Person[eid]["内力"]) / 10)
	    local str = ""
        if d < 10 then
            d = 10
        end
  	    WAR.FXXS[eid] = 1
	    WAR.FXDS[eid] = limitX((WAR.FXDS[eid] or 0) + d, 0, 100)
	    local n = math.random(1,2)
	    WAR.QFLZ = n
	    if n == 1 then
	        str="・抢珠三式"
	        WAR.DWLZ[eid] = WAR.DWLZ[eid] or 0 +1
	    elseif n == 2 then
	        WAR.ZLZS[eid] = WAR.ZLZS[eid] or 0 +1
	        str = "・沛然有雨"
	        WAR.PEACE[eid] = limitX((WAR.PEACE[eid] or 0) + d, 0, 100)
			for i = 0, WAR.PersonNum - 1 do 
				if WAR.Person[i]["我方"] == false and WAR.Person[i]["死亡"] == false and i ~= WAR.CurID then
				   WAR.Person[i].Time = math.max(WAR.Person[i].Time - 20, -50)
				   AddPersonAttrib(WAR.Person[i]["人物编号"],"受伤程度", math.random(30))
				end
			end
	        WAR.LQZ[eid] = WAR.LQZ[eid] or 0 -100
			if WAR.LQZ[eid] < 0 then
				WAR.LQZ[eid] = 0
			end
		end	
	    if JLSD(10,40,pid) then
			local bb = math.random(3,5)
			local aa = math.modf(JY.Person[eid]["生命"] / bb)
			WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) - aa;
			AddPersonAttrib(eid, "生命", - aa)
		end	
	    if WAR.Person[emenyid][CC.TXWZ3] == nil then
		    WAR.Person[emenyid][CC.TXWZ3] = "龙爪手"..str
	    else
		    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "龙爪手"..str
	    end	
    end	

    if DT(pid,583) and JLSD(10,45,pid) then
		local d = math.modf((JY.Person[pid]["内力"] - JY.Person[eid]["内力"]) / 10)
		local n = math.random(1,2)
		local str = ""
		if d < 10 then
            d = 10
        end
		WAR.JMZD = n
		if n == 1 then
	        str = "・海枯石烂"
	        WAR.HKSL = 1
	    elseif n == 2 then
	        WAR.WSXW = 1
	        str = "・万世凶亡"
			WAR.PEACE[eid] = limitX((WAR.PEACE[eid] or 0) + d, 0, 100)
			WAR.LQZ[eid] = WAR.LQZ[eid] or 0 -100
			if WAR.LQZ[eid] < 0 then
				WAR.LQZ[eid] = 0
			end
		end
		if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "寂灭之道"..str
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "寂灭之道"..str
	    end	
    end	

    if wglw1(pid,31) and WAR.WYLW2==1 then
        local d = math.modf((JY.Person[pid]["内力"] - JY.Person[eid]["内力"]) / 500)
		if d < 10 then
           d = 10
        end
		hurt = hurt + math.modf((JY.Person[eid]["内力最大值"] - JY.Person[eid]["内力"])*0.015*d)
		WAR.SZWH[eid]=WAR.SZWH[eid] or 0 + d
	end
  
    if wglw1(pid,33) and WAR.WYLW4==1 then
        local d = math.modf((JY.Person[pid]["防御力"] - JY.Person[eid]["防御力"]) / 10)
		if d < 10 then
         d = 10
        end
		hurt = hurt + math.modf((JY.Person[eid]["内力最大值"] - JY.Person[eid]["内力"])*0.015*d)
		AddPersonAttrib(eid,"受伤程度", math.random(10,20))
	end
 
    if MPPD(pid)==10 and PersonGT(pid,6) and WAR.THSB1==2 then
	    ang = math.modf(ang *2)+1000
		dng = math.modf(dng/2)
		WAR.GTSHAQI = WAR.GTSHAQI+math.abs(ang-dng)
	end
	 
	if MPPD(pid)==10 and PersonGT(pid,6) and WAR.THSB2==2 then
	    WAR.FMZZ[eid] = WAR.FMZZ[eid] or 0 + 1
		WAR.LHZF[eid] = WAR.LHZF[eid] or 0 + 1
	end
	 
	if MPPD(pid)==10 and PersonGT(pid,6) and WAR.THSB3==2 then
        WAR.PEACE[eid]=limitX((WAR.PEACE[eid] or 0) + 30, 0, 100)
		WAR.CYSH[eid]=limitX((WAR.CYSH[eid] or 0) + 20, 0, 100)
	end
	--旋风扫叶腿领悟
	if MPPD(pid) == 10 and wglw2(pid,193) and WAR.THKF == 1 then
		local aa = math.random(2)
		local bb = WAR.ACT
		if aa == 1 then
			WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) - math.modf(30*bb)
		elseif aa == 2 then
			WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - math.modf(100*bb)
		end
	end	
	
    --莫名悲痛
	if WAR.MMBT == nil then
        local d = math.modf(JY.Person[pid]["内力"] / 10)
		if d < 20 then
            d = 20
        end
		local bb = WAR.LQZ[eid] or 0
        WAR.PEACE[eid] = math.modf(bb / 2)		 
        local aa = WAR.LQZ[pid] or 0 + d
		local cc = math.modf(aa + bb)
		WAR.HOTXS[eid] = 1
		WAR.HOT[eid] = WAR.HOT[eid] or 0 + cc
		AddPersonAttrib(eid,"受伤程度", cc)
	end

    if wglw1(pid,155) and WAR.ZKSY==2 or DT(pid,665) then
        local d = math.modf(JY.Person[pid]["内力"]  / 300)
		if d < 20 then
        d = 20
        end
		WAR.SZWH[eid]=WAR.SZWH[eid] or 0 + d
	end
  
    if wglw1(pid,155) and WAR.ZKSY==1 or DT(pid,665) then
        local d = math.modf(JY.Person[pid]["内力"]  / 300)
		if d < 20 then
            d = 20
        end
		WAR.ASKD = 1
		WAR.CHXS[eid]=1
	    WAR.CHZ[eid] = (WAR.CHZ[eid] or 0) + d
		local SN=math.modf(JY.Person[eid]["生命"]/10)
		WAR.Person[WAR.CurID]["真伤点数"] = WAR.Person[WAR.CurID]["真伤点数"] or 0 + AddPersonAttrib(pid, "生命", SN)
		WAR.Person[WAR.CurID]["内力点数"] = WAR.Person[WAR.CurID]["内力点数"] or 0 + AddPersonAttrib(pid, "内力", SN*10)
	end

    if wglw1(pid,155) and WAR.ZKSY==3 or DT(pid,665) then
        local d = math.modf(JY.Person[pid]["内力"]  / 300)
		if d < 20 then
            d = 20
        end
		local bb = WAR.LQZ[eid] or 0
        WAR.PEACE[eid]=math.modf(bb/2)		 
        local aa = WAR.LQZ[pid] or 0 + d
		local SN=math.modf(aa+bb)
		WAR.HOTXS[eid]=1
		WAR.HOT[eid]= WAR.HOT[eid] or 0 + SN
		AddPersonAttrib(eid,"受伤程度", SN)
	end
	 
    --少林达摩院，易筋神功加力时龙爪手造成特殊效果
    if T5BCF(pid) and WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
	    local d = math.modf((JY.Person[pid]["内力"] - JY.Person[eid]["内力"]) / 30)
	    local str=""
        if d < 10 then
            d = 10
        end
  	    WAR.FXXS[eid] = 1
	    WAR.FXDS[eid] = limitX((WAR.FXDS[eid] or 0) + d, 0, 100)
	    local n=math.random(1,4)
	    WAR.DMZF1=n
	    if n==1 and juexing() > 2 then
	        str=".大寒"
	        local bb=math.random(2,4)
	        local aa=math.modf(JY.Person[eid]["生命"]/bb)
	        WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0)-aa;
            AddPersonAttrib(eid, "生命", -aa);
	        WAR.YHZJ[eid]=WAR.YHZJ[eid] or 0 + 1
	    elseif n==2 and juexing() > 1 then
	        str=".霜降"
	        WAR.PEACE[eid]=limitX((WAR.PEACE[eid] or 0) + d, 0, 100)
		    for i = 0, WAR.PersonNum - 1 do 
			    if WAR.Person[i]["我方"] == false and WAR.Person[i]["死亡"] == false and i ~= WAR.CurID then
					WAR.Person[i].Time = math.max(WAR.Person[i].Time - 200, -500)
				    AddPersonAttrib(WAR.Person[i]["人物编号"],"受伤程度", math.random(10,20))
				    WAR.SJTH[WAR.Person[i]["人物编号"]]=WAR.SJTH[WAR.Person[i]["人物编号"]] or 0+1
				end
			end
	    elseif n==3 and juexing() > 0 then
	        str=".芒种"
	        WAR.OYFSD[eid] = limitX((WAR.OYFSD[eid] or 0) + d, 0, 100);
	        local SN=math.modf(JY.Person[eid]["内力"]/30)
	        local SN2=math.modf(SN*10)
	        WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - SN2;
  	        AddPersonAttrib(eid, "内力", -SN2);
	        WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) - SN;
	        AddPersonAttrib(eid, "生命", -SN);
	        WAR.HOTXS[eid]=1
	        WAR.HOT[eid] = limitX((WAR.HOT[eid] or 0) + SN, 0, 50)
	    elseif n==4 then
            str=".惊蛰"
	        WAR.LHZF[eid]=WAR.LHZF[eid] or 0 +1
            WAR.DLYZ[eid]=WAR.DLYZ[eid] or 0 +1
	    end
	    if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "二十四节气指."..str
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "二十四节气指"..str
	    end	
	        WAR.Person[emenyid][CC.TXDH] = 45
    end
  
    if wugong == 47 and DT(pid, 592) or wglw1(pid, 47) then
		hurt = hurt + math.modf(JY.Person[pid]["内力最大值"] / 5)
	end

    if wugong == 45 and DT(pid, 592) or wglw1(pid, 45) then
		hurt = hurt + math.modf(JY.Person[pid]["内力最大值"] / 4)
	end

    if WAR.LMSJ == 6 then
		hurt = hurt + math.modf(JY.Person[pid]["内力最大值"] / 3)
	end

    if WAR.MMBT == 1 then
		hurt = hurt + math.modf(JY.Person[pid]["内力最大值"] * 4)
		AddPersonAttrib(eid,"受伤程度", 100)
	end	

    if (wglw(pid,181) or DT(pid, 455)) and PersonGT(pid, 181) then --玄武真功的十方皆灭内力附加伤害
		local xihe = sixi(pid,1) + sixi(pid,2) + sixi(pid,3) + sixi(pid,4) + sixi(pid,5)
		if xihe >= 700 then
		    hurt = hurt + math.modf(JY.Person[pid]["内力最大值"] / 3)
		end
	end  

    if DT(pid,600) then --武无敌的十方皆灭内力附加伤害
		local xihe = sixi(pid,1) + sixi(pid,2) + sixi(pid,3) + sixi(pid,4) + sixi(pid,5)
		if xihe >= 700 then
		    hurt = hurt + math.modf(JY.Person[pid]["内力最大值"] / 1)
			local a = math.modf(JY.Person[pid]["内力"] /10)
  	        WAR.HOT[eid] = 1
	        WAR.HOTXS[eid] = limitX((WAR.HOT[eid] or 0) + a, 0, 100)
	        hurt = hurt * math.modf(JY.Person[eid]["内力最大值"] * 1 * a)
	        WAR.ICE[eid] = 1
	        WAR.ICEXS[eid] = limitX((WAR.ICE[eid] or 0) + a, 0, 100)
		end
	end  

    if WAR.SLJJ == 1 then
		hurt = hurt + math.modf(JY.Person[pid]["内力最大值"] / 3)
		local a = math.modf(JY.Person[pid]["内力"] /10)
		WAR.ICE[eid] = 1
	    WAR.ICEXS[eid] = limitX((WAR.ICE[eid] or 0) + a, 0, 100)
		AddPersonAttrib(eid,"受伤程度", 20)
    end		

    if (wglw(pid,182) or (DT(pid,5) and PersonGT(pid,182))) and WAR.LQZ[pid] == 100 then
        hurt = hurt + math.modf(JY.Person[pid]["内力最大值"] / 1)
		hurt = hurt * WAR.LQZ[pid]
	end	

  	if T8LXY(pid) and WAR.LXYJS == 1 and DWPD() then ----沼跃鱼：李逍遥酒神咒杀自身内力最大值的一定比例
		hurt = hurt + math.modf(JY.Person[pid]["内力最大值"] / 15)
	end
  
    if ((wglw(pid,107) and PersonGT(pid,107)) or DT(pid,599)) and JLSD(10,40,pid) then
		hurt = hurt + math.modf(JY.Person[pid]["内力最大值"] / 3)
	end	

   	if WAR.HQGS == 1 and DWPD() then ----沼跃鱼：洪七龙纹打狗棒
		hurt = hurt + math.modf(JY.Person[pid]["内力最大值"] / 25)
		AddPersonAttrib(eid,"受伤程度", math.random(10,25))
		ang = math.modf(ang *2)+1000
		dng = math.modf(dng/2)
		WAR.GTSHAQI = WAR.GTSHAQI+math.abs(ang-dng)
		WAR.GTPID2=pid
	end
  
    if  WAR.HQGS3 == 1 and DWPD() then ----沼跃鱼：洪七龙纹打狗棒
	    local SN=math.modf(JY.Person[eid]["内力"]/10)
	    local SN2=math.modf(JY.Person[eid]["内力"]/2)
	    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - SN2;
  	    AddPersonAttrib(eid, "内力", -SN2);
	    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) - SN;
	    AddPersonAttrib(eid, "生命", -SN);
	    WAR.Person[emenyid].TimeAdd =-999
	    AddPersonAttrib(eid,"受伤程度", math.random(30,50))
	end
  
  	if WAR.ZCDZ==1 and hasDZ(pid,6) then ----沼跃鱼：战意组件6
		hurt = hurt + math.modf(JY.Person[pid]["内力"] / 20)
	end
  
  	if (wglw1(pid,77) or ((DT(pid,605) or (DT(pid,627)))and JX(pid))) and (WAR.DZDJ1 >0 or yongdao(wugong))then ---阳刀
		local aa = math.modf(sixi(pid, 3) / 20)
		local bb = math.modf(sixi(pid, 3) / 10)
		local cc = limitX(math.random(aa, bb), 1, 24)
		hurt = hurt +  math.modf(cc * 20)				
	end
  
    if (wglw1(pid,77) or ((DT(pid,605) or (DT(pid,627)))and JX(pid))) and (WAR.DZDJ2 >0 or yongjian(wugong))then ---阴剑
		local aa = math.modf(sixi(pid, 2) / 20)
		local bb = math.modf(sixi(pid, 2) / 10)
		local cc = limitX(math.random(aa, bb), 1, 24)
		hurt = hurt +  math.modf(cc * 20)				
	end
  
    if MPPD(pid)==10 then ----沼跃鱼：桃花岛根据对方内力增加攻击伤害
	    local mpdj=MPDJ(pid)
		hurt = hurt+math.modf(hurt * (1-JY.Person[eid]["内力"] / JY.Person[eid]["内力最大值"])*(1+0.1*mpdj))
		if JY.Person[pid]["内力"]>=JY.Person[eid]["内力"] then
		hurt = hurt+math.modf((JY.Person[pid]["内力"] -JY.Person[eid]["内力"])/40*(1+0.1*mpdj))
		end
	end
  
  	if WAR.ZCDZ==1 and hasDZ(pid,10) then ----沼跃鱼：战意组件10
		hurt = hurt + math.modf(JY.Person[eid]["中毒程度"]*1.5)
	end
    if WAR.ZCDZ ==1 and hasDZ(pid,2) and yongquan(wugong) then --沼跃鱼：战意组件2
    	local aa = math.modf(sixi(pid, 1) / 20)
		local bb = math.modf(sixi(pid, 1) / 10)
		local cc = limitX(math.random(aa, bb), 1, 24)
		hurt = hurt + math.modf(cc * 10)	
    end 
  
    if WAR.ZCDZ ==1 and hasDZ(pid,4) and yongte(wugong) then --沼跃鱼：战意组件4
    	local aa = math.modf(sixi(pid, 4) / 20)
		local bb = math.modf(sixi(pid, 4) / 10)
		local cc = limitX(math.random(aa, bb), 1, 24)
		hurt = hurt + math.modf(cc * 10)	
    end 

    if T13TQS(pid) and WAR.TQS == 5 then ----沼跃鱼：滕青山拟兽式象形
       hurt = hurt + math.modf((JY.Person[eid]["内力最大值"] - JY.Person[eid]["内力"])*0.01*(WAR.SWHH+WAR.SWFY))
	end
	
    if wssz(pid) and WAR.TQS == 5 then ----沼跃鱼：滕青山拟兽式象形
    hurt = hurt + math.modf((JY.Person[eid]["内力最大值"] - JY.Person[eid]["内力"])*0.01*(WAR.SWHH1+WAR.SWFY1))
	end
  
    if T9ZY(pid) and WAR.ZYQT==7 then --沼跃鱼：赵云化蛟覆海
       local n=sixi(pid,4)*10
       hurt = hurt + math.modf((JY.Person[pid]["内力"])*0.0001*n)
	end
  
    if (MPPD(pid) == 17 and MPDJ(pid) >= 2) or (GX(pid) and JX(pid)) then --峨眉掌门限定内力攻击
	    local a = MPDJ(pid)
		hurt = hurt+math.modf(hurt * (1-JY.Person[eid]["内力"] / JY.Person[eid]["内力最大值"]) * 3)
		if JY.Person[pid]["内力"]>=JY.Person[eid]["内力"] then
		    hurt = hurt+math.modf((JY.Person[pid]["内力"] -JY.Person[eid]["内力"])/40 * 3)
		end
	end 

	if (GB(pid)==3 or DT(pid, 69))  then 
	    if WAR.LMBJ5==1 then 
		    hurt=hurt+math.modf(WAR.SPIRIT[pid]*1.15)
		    effect(51,"特效文字1","乌衣丐帮.傲血战意",750,0)
	    elseif WAR.LMBJ5==2 then	
		    hurt=hurt+math.modf(WAR.SPIRIT[pid]*1.15)
		    effect(52,"特效文字1","乌衣丐帮.傲骨战意",1500,0)
	    elseif WAR.LMBJ5==3 then	
            hurt=hurt+math.modf(WAR.SPIRIT[pid]*1.15)
		    effect(53,"特效文字1","乌衣丐帮.傲天战意",3000,0)
	    end 
	    WAR.LMBJ5=0
    end
	
    --蓄力攻击+20%
    if WAR.Actup[pid] ~= nil and WAR.DZXY ~= 1 then
        if PersonKF(pid, 103) then         --有龙象30%，主功体50%
            ang = ang + 1000
	        if PersonGT(pid, 103) then
	            if MPPD(pid) == 6 then
		            local mpdj = MPDJ(pid)*0.2
		            hurt = math.modf(hurt * (1.5 + mpdj))
		        else
                    hurt = math.modf(hurt * 1.5)
	            end
	        else
	            if MPPD(pid) == 6 then
		            local mpdj = MPDJ(pid)*0.2
		            hurt = math.modf(hurt * (1.3 + mpdj))
		        else
                    hurt = math.modf(hurt * 1.3)
	            end		
	        end
    else
    	if MPPD(pid) == 6 then
		    local mpdj = MPDJ(pid)*0.2
		    hurt = math.modf(hurt * (1.2 + mpdj))
		else
            hurt = math.modf(hurt * 1.2)
	    end	
    end
	    if DT(pid, 39) then --龙岛主蓄力+30%
		    hurt = math.modf(hurt * 1.3)
	    end
	    if wglw1(pid, 155) then --五指秘刀领悟
		    hurt = math.modf(hurt * 2)
	    end
		if WAR.JWDF == 2 then
			hurt = math.modf(hurt * 3)
		end
    end 
  
    if T5BCF(pid) and WAR.BCFZL >=1 then --天敌伤害杀气+50%
	    local yujian = math.modf(sixi(pid, 1) / 40)
	    hurt = math.modf(hurt * (1 + (0.05 * yujian)))
	    ang = math.modf(ang * (1 + (0.05 * yujian)))
    end
  
    if T5BCF(pid) and WAR.BCFZL == 3 then --天敌伤害杀气+50%
	    hurt = math.modf(hurt * 1.5)
	    ang = math.modf(ang * 1.5)
    end
  
    if PersonGT(pid, 107) then --九阴主功体伤害+30%，否则+10%
  	    hurt = math.modf(hurt * 1.3);
    elseif PersonKF(pid, 107) then
	    hurt = math.modf(hurt * 1.1);
    end  

    if PersonGT (pid, 181) then --玄武真功主功体+50%，非主功体+25%
	    hurt = math.modf(hurt * 1.5);
    elseif PersonKF(pid, 181) then
        hurt = math.modf(hurt * 1.25)
    end
  
  	if (MPPD(pid) == 5 and PersonGT(pid,96) and MPDJ(pid)>1) or DT(pid,615) and WAR.LHT>0 then --沼跃鱼：罗汉堂主运效果
	    hurt = math.modf(hurt*(1+WAR.LHT*0.2))
	    ang = math.modf(ang*(1+WAR.LHT*0.2))
	end
  
  	if pid == 0 and T6XQS(0) then --萧秋水御剑每+40伤害+5%
		local yujian = math.modf(sixi(pid, 2) / 40)
		hurt = math.modf(hurt * (1 + (0.05 * yujian)))
	end

    if WAR.YJJS == 1 then 
	    hurt = math.modf(hurt * 2)
	    ang = math.modf(ang * 1.5)
	end  

    --拳系大招
    if WAR.LXZQ == 1 then
        hurt = math.modf(hurt * 1.3)
    end
    --主角拳系，学拳法伤害加成5%
    --东方未明拳法伤害加成5%
    if (putong() == 1 and pid == 0) or T7DFWM(pid) then
        local lxzq = wgnumber(pid, 1)
        hurt = math.modf(hurt * (1 + 0.05 * (lxzq)))
    end
    if pid == 0 and putong() == 3 and WAR.KUANGDAO > 0 then --刀系狂刀伤害增加
	    hurt = math.modf(hurt * (1 + (WAR.KUANGDAO / 50)))
    end
  
    if pid == 0 and putong() == 5 and WAR.TIANGANG > 0 then --罡气护体
	    hurt = math.modf((hurt+WAR.SPIRIT[pid]) * (1 + (WAR.TIANGANG / 50)))
    end
  
    if J2YSS(pid) and WAR.DUOMINGJIAN > 0 then --罡气护体
	    hurt = math.modf((hurt+math.modf(sixi(pid,2)/3)) * (1 + (WAR.DUOMINGJIAN / 50)))
    end
  
  	if T7DFWM(pid) and WAR.DZXY == 1 and yongnei(wugong) and juexing()>1 then --东方未明内功反击特效
	    local jiali= math.modf(JY.Person[pid]["内力最大值"]/20)
	    hurt= hurt + jiali
	end	 
  
  	if MPPD(pid) == 6 then
		if wugong == 66 or (MZ(pid)==2 and yongdao(wugong)) then
			WAR.XUEFU[pid]=WAR.XUEFU[pid] or 0 + math.random(3)
			hurt = hurt * math.modf(2-(JY.Person[pid]["生命"] / JY.Person[pid]["生命最大值"]))
			if WAR.XUEFU[pid]~=nil and WAR.XUEFU[pid]>=0 then
				hurt = hurt * math.modf((1 + (WAR.XUEFU[pid] / 5)))
			end
			if WAR.LQZ[pid] ~= nil and WAR.LQZ[pid]>=100 and WAR.XUEFU[pid]~=nil and WAR.XUEFU[pid]>=0 then
				if WAR.ACT == 1 then
					hurt = hurt+50*(WAR.XUEFU[pid] + 100)
				else
					hurt = hurt+100*WAR.XUEFU[pid]
				end	
				if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
					WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+血纹奥义・冥河之怒"
				else
					WAR.Person[emenyid][CC.TXWZ3] ="血纹奥义・冥河之怒"
				end	
				WAR.XUEFU[pid] = math.modf(WAR.XUEFU[pid]/2)	
			end
		end	
    end

	if (MPPD(pid) == 6 and wugong == 66) or (MZ(pid) == 3 and yongte(wugong)) then
		WAR.WSDL[pid] = (WAR.WSDL[pid] or 0) + math.random(3)
		hurt = hurt * math.modf(2-(JY.Person[pid]["内力"] / JY.Person[pid]["内力最大值"]))
		if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+龙象巨力・磐阜ㄉ"
		else
			WAR.Person[emenyid][CC.TXWZ3] ="龙象巨力・磐阜ㄉ"
		end
		if WAR.WSDL[pid] ~= nil and WAR.WSDL[pid] > 0 then
			hurt = hurt * math.modf(1 + (WAR.WSDL[pid] / 10))
			WAR.DEFDOWN[eid] = limitX((WAR.DEFDOWN[eid] or 0) + (WAR.WSDL[pid]*5), 0, 100)
			if WAR.LQZ[pid] ~= nil and WAR.LQZ[pid]>=100 and WAR.WSDL[pid]~=nil and WAR.WSDL[pid]>=0 then
				local aa = WAR.WSDL[pid] + (WAR.DEFDOWN[eid] or 0)
				if aa > 50 then aa = 50 end
				if JLSD(10,60,pid) then
					WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid,"生命",-(aa*6))
					WAR.WSDL[pid] = 0
					if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
						WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+龙象巨力・无上威德"
					else
						WAR.Person[emenyid][CC.TXWZ3] ="龙象巨力・无上威德"
					end
				end
			end	
		end	
	end
  
    if wugong==128 and PersonGTJL(pid, 124, WAR.NGJL) and MPPD(pid) == 14 and MPDJ(pid) > 1 and
	    WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
	    if WAR.ICE[eid]~=nil and WAR.ICE[eid]>0 then
	        hurt=math.modf(hurt*(1+WAR.ICE[eid]*0.03))
	        if WAR.Person[emenyid][CC.TXWZ2] == nil then
		        WAR.Person[emenyid][CC.TXWZ2] = "意寒真诀.寒冰指"
	        else
		        WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "意寒真诀.寒冰指"
	        end	
	        WAR.Person[emenyid][CC.TXDH] = 67
         end
    end
  
    if PersonGTHT(eid, 124, WAR.NGHT) and MPPD(eid) == 14 and MPDJ(eid) > 1 then
	    if WAR.ICE[pid]~=nil and WAR.ICE[pid]>0 then
	        hurt=math.modf(hurt*(1-WAR.ICE[pid]*0.01))
	        if WAR.Person[emenyid][CC.TXWZ2] == nil then
		        WAR.Person[emenyid][CC.TXWZ2] = "意寒真诀.控冰守护"
	        else
		        WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "意寒真诀.控冰守护"
	        end	
	            WAR.Person[emenyid][CC.TXDH] = 67
        end
    end
	
	if wugong == 83 and wglw1(pid,83) and JLSD(10,80,eid)then 
		WAR.SZWH[eid]= WAR.SZWH[eid] or 0 + 50
		if WAR.Person[emenyid][CC.TXWZ1] == nil then
			WAR.Person[emenyid][CC.TXWZ1] = "一大三千・神威世界"
		else
			WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" .."神威世界"
		end
	elseif wugong == 83 and wglw1(pid,83) then
		WAR.LQZ[eid] = 100
		WAR.LHFM[eid] = 20
		if WAR.Person[emenyid][CC.TXWZ1] == nil then
			WAR.Person[emenyid][CC.TXWZ1] = "一大三千・神威世界"
		else
			WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" .."神威世界"
		end			
	end
	
	--黄沙万里鞭折戟沉沙特效
	if wugong == 78 and (wglw1(pid,78) or (DT(pid,25) and PersonKF(pid,78))) and WAR.HSWLB[eid] == nil and DWPD() and JLSD(10,50,pid) then 
	    WAR.HSWLB[eid] = 30
		WAR.SZWH[eid]= WAR.SZWH[eid] or 0 + 30
		WAR.DEFDOWN[eid] = 30
		WAR.ATKDOWN[eid] = 30
		if WAR.Person[emenyid][CC.TXWZ3] == nil then
			WAR.Person[emenyid][CC.TXWZ3] = "沙狱・折戟沉沙"
		else
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .."折戟沉沙"
		end
	end
	
	--持瑶琴大雅无曲
	if wugong == 73 and wglw1(pid,73) and JLSD(10,60,pid) then
		WAR.PEACE[eid]=limitX((WAR.PEACE[eid] or 0) + 20, 0, 100)
		if JLSD(0,50,pid) and WAR.DYWQ == nil then
			WAR.DYWQ = 1
		end
		if WAR.Person[emenyid][CC.TXWZ3] == nil then
			WAR.Person[emenyid][CC.TXWZ3] = "伏羲神天・大雅无曲"
		else
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .."大雅无曲"
		end
	end	
	--黄沙万里鞭破体凝沙特效
	if wugong == 78 and wglw1(pid,78) and ((WAR.ICE[eid] ~= nil and WAR.ICE[eid] >=30) or (WAR.LXZT[eid] ~= nil and WAR.LXZT[eid]>= 50)) then	
		WAR.KMWD = 2
		if WAR.Person[emenyid][CC.TXWZ1] == nil then
			WAR.Person[emenyid][CC.TXWZ1] = "沙狱・破体凝沙"
		else
			WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" .."破体凝沙"
		end
	end
	
	--侠客经典 神行背刺
	if wglw2(pid,117) and JLSD(10,40,pid) and PersonKF(pid,117) and WAR.ACT == 1 then
		WAR.LXXS[eid] = 1
		WAR.LXZT[eid] = limitX((WAR.LXZT[eid] or 0) + 25, 0, 100)
		if JLSD(10,50,eid) then
			local aa = WAR.LXZT[eid]
			WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -(aa * 2))
		end	
		if WAR.Person[emenyid][CC.TXWZ1] == nil then
			WAR.Person[emenyid][CC.TXWZ1] = "侠客经典・神行背刺"
		else
			WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" .."神行背刺"
		end
	end
	--一渡江I悟
	if PersonKF(eid,143) and (wglw2(eid,143) or DT(eid,615) or DT(eid,114) or DT(eid,617)) then
		if WAR.LHFM[eid] ~= nil then
			WAR.FXXS[eid] = 1
			WAR.FXDS[eid] = limitX((WAR.FXDS[eid] or 0) + 20, 0, 100)
			if WAR.Person[emenyid][CC.TXWZ1] == nil then
			WAR.Person[emenyid][CC.TXWZ1] = "一苇渡江・西天坦途"
			else
			WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" .."西天坦途"
			end
		end
		if WAR.MENG[eid] ~= nil then
			WAR.FXXS[eid] = 1
			WAR.FXDS[eid] = limitX((WAR.FXDS[eid] or 0) + 20, 0, 100)
			if WAR.Person[emenyid][CC.TXWZ1] == nil then
			WAR.Person[emenyid][CC.TXWZ1] = "一苇渡江・西天坦途"
			else
			WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" .."西天坦途"
			end
		end
		if WAR.SZWH[eid] ~= nil then
			WAR.FXXS[eid] = 1
			WAR.FXDS[eid] = limitX((WAR.FXDS[eid] or 0) + 20, 0, 100)
			if WAR.Person[emenyid][CC.TXWZ1] == nil then
			WAR.Person[emenyid][CC.TXWZ1] = "一苇渡江・西天坦途"
			else
			WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" .."西天坦途"
			end
		end
	end	
	
	--八卦刀领悟 明八卦守
	if wglw1(eid,138) then
		if WAR.MINBG1[eid] == nil then
			WAR.MINBG1[eid] = math.random(4)
		else
			WAR.MINBG1[eid] = math.random(4)
		end
	end	
	
	--八卦刀领悟，敌方攻击特效
	if WAR.ANBG > 0 and WAR.YXZ[pid] ~= nil and WAR.YXZ[pid] > 0 then
		hurt = math.modf(hurt*0.7)
		if wglw1(eid,138) then
			hurt = math.modf(hurt*0.5)
		local aa = math.random(3,10)
		local bb = math.random(2,5)
			if JY.Person[eid]["受伤程度"] ~= nil or JY.Person[eid]["中毒程度"] ~= nil and JLSD(10,50,eid) then
				WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "受伤程度", - (aa*8))
				WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "中毒程度", - (aa*8))
				WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) +	AddPersonAttrib(eid, "生命", (aa*40))
				WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) +	AddPersonAttrib(eid, "内力", (aa*80))
				if JY.Person[eid]["中毒程度"] <= 0 then
					JY.Person[eid]["中毒程度"] = 0
				end
				if JY.Person[eid]["受伤程度"] <= 0 then
					JY.Person[eid]["受伤程度"] = 0
				end	
				if WAR.ANBG == 1 and WAR.MINBG1[eid] == 1 and WAR.YXZ[pid] ~= nil and WAR.YXZ[pid] > 0 then
					WAR.KHCM[pid] = (WAR.KHCM[pid] or 0) + 1
				end	
				if WAR.ANBG == 1 and WAR.MINBG1[eid] == 1 and WAR.YXZ[pid] ~= nil and WAR.YXZ[pid] > 0 and WAR.Person[emenyid][CC.TXWZ3] == nil then
						WAR.Person[emenyid][CC.TXWZ3] = "明暗乾坤・天护地佑"
				elseif 	WAR.ANBG == 1 and WAR.MINBG1[eid] == 1 and WAR.YXZ[pid] ~= nil and WAR.YXZ[pid] > 0 and WAR.Person[emenyid][CC.TXWZ3] ~= nil then
						WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .."乾坤・天护地佑"
				else	
					if WAR.Person[emenyid][CC.TXWZ2] == nil then
						WAR.Person[emenyid][CC.TXWZ2] = "八卦易数・乾坤"
					else
						WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .."易数・乾坤"
					end
				end	
			end
			if WAR.ICE[eid] ~= nil or WAR.HOT[eid] ~= nil and JLSD(10,70,eid) then
				WAR.ICE[eid] = (WAR.ICE[eid] or 0) - (bb*8)
				WAR.HOT[eid] = (WAR.HOT[eid] or 0) - (bb*8)
				if WAR.ICE[eid] <= 0 then
					WAR.ICE[eid] = 0
				end
				if WAR.HOT[eid] <= 0 then
					WAR.HOT[eid] = 0
				end
				if WAR.ANBG == 2 and WAR.MINBG1[eid] == 2 and WAR.YXZ[pid] ~= nil and WAR.YXZ[pid] > 0 then
					--local cc = math.modf(JY.Person[eid]["资质"] / (math.random(2,5)))
					--if cc < 10 then cc = 10 end
					WAR.ICE[pid] = limitX((WAR.ICE[pid] or 0) + 50,0,50)
					WAR.HOT[pid] = limitX((WAR.HOT[pid] or 0) + 50,0,50)
				end
				if WAR.ANBG == 2 and WAR.MINBG1[eid] == 2 and WAR.YXZ[pid] ~= nil and WAR.YXZ[pid] > 0 and WAR.Person[emenyid][CC.TXWZ3] == nil then
						WAR.Person[emenyid][CC.TXWZ3] = "明暗坎离・水火不侵"
				elseif 	WAR.ANBG == 2 and WAR.MINBG1[eid] == 2 and WAR.YXZ[pid] ~= nil and WAR.YXZ[pid] > 0 and WAR.Person[emenyid][CC.TXWZ3] ~= nil then
						WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .."乾坤・水火不侵"
				else
					if WAR.Person[emenyid][CC.TXWZ2] == nil then
						WAR.Person[emenyid][CC.TXWZ2] = "八卦易数・坎离"
					else
						WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .."易数・坎离"
					end
				end	
			end
			if WAR.FXDS[eid] ~= nil and JLSD(10,70,eid) then
				WAR.FXDS[eid] = (WAR.FXDS[eid] or 0) - (bb*8)
				WAR.QFY1[eid] = (WAR.QFY1[eid] or 0) + (bb*8)
				if WAR.FXDS[eid] <= 0 then
					WAR.FXDS[eid] = 0
				end
				if WAR.ANBG == 3 and WAR.MINBG1[eid] == 3 and WAR.YXZ[pid] ~= nil and WAR.YXZ[pid] > 0 then
					--local cc = math.modf(JY.Person[eid]["资质"] / (math.random(2,5)))
					--if cc < 10 then cc = 10 end
					WAR.GUDUVICTIE[pid] = (WAR.GUDUVICTIE[pid] or 0) + 1
				end
				if WAR.ANBG == 3 and WAR.MINBG1[eid] == 3 and WAR.YXZ[pid] ~= nil and WAR.YXZ[pid] > 0 and WAR.Person[emenyid][CC.TXWZ3] == nil then
						WAR.Person[emenyid][CC.TXWZ3] = "明暗震巽・风平云静"
				elseif 	WAR.ANBG == 3 and WAR.MINBG1[eid] == 3 and WAR.YXZ[pid] ~= nil and WAR.YXZ[pid] > 0 and WAR.Person[emenyid][CC.TXWZ3] ~= nil then
						WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .."震巽・风平云静"
				else
					if WAR.Person[emenyid][CC.TXWZ2] == nil then
						WAR.Person[emenyid][CC.TXWZ2] = "八卦易数・震巽"
					else
						WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .."易数・震巽"
					end
				end	
			end
			if WAR.CHZ[eid] ~= nil and JLSD(10,70,eid) then
				WAR.CHZ[eid] = (WAR.CHZ[eid] or 0) - (bb*8)
				WAR.QFY3[eid] = (WAR.QFY3[eid] or 0) + (bb*8)
				if WAR.CHZ[eid] <= 0 then
					WAR.CHZ[eid] = 0
				end
				if WAR.ANBG == 4 and WAR.MINBG1[eid] == 4 and WAR.YXZ[pid] ~= nil and WAR.YXZ[pid] > 0 then
					--local cc = math.modf(JY.Person[eid]["资质"] / (math.random(2,5)))
					--if cc < 10 then cc = 10 end
					WAR.L_WNGZL[pid] = limitX((WAR.L_WNGZL[pid] or 0) + 50,0,50)
				end
				if  WAR.ANBG == 4 and WAR.MINBG1[eid] == 4 and WAR.YXZ[pid] ~= nil and WAR.YXZ[pid] > 0 and WAR.Person[emenyid][CC.TXWZ3] == nil then
						WAR.Person[emenyid][CC.TXWZ3] = "明暗艮兑・山恩泽被"
				elseif 	WAR.ANBG == 4 and WAR.MINBG1[eid] == 4 and WAR.YXZ[pid] ~= nil and WAR.YXZ[pid] > 0 and WAR.Person[emenyid][CC.TXWZ3] ~= nil then
						WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .."艮兑・山恩泽被"
				else
					if WAR.Person[emenyid][CC.TXWZ2] == nil then
						WAR.Person[emenyid][CC.TXWZ2] = "八卦易数・艮兑"
					else
						WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .."易数・艮兑"
					end
				end	
			end	
		end
		WAR.ANBG = 0
	end
	
	--八卦刀领悟 领悟者攻击特效
	if wglw1(pid,138) and wugong == 138 and WAR.MINBG > 0 and WAR.MINBG ~= nil  then
		local a1 = WAR.YXZ[eid] or 0 
		if WAR.YXZ[eid] == nil then
			WAR.ANBG1[eid] = nil
		else
			WAR.ANBG1[eid] = math.random(4)
			hurt = hurt + math.modf(a1 * 2 * (math.random(4)))
		end	
		if WAR.MINBG == 1 and WAR.ANBG1[eid] == 1 and WAR.ANBG1[eid] ~= nil then
			hurt = hurt * 4
			WAR.DLYZ[eid]=WAR.DLYZ[eid] or 0 + 1
			WAR.LHZF[eid] = WAR.LHZF[eid] or 0 + 1
			if WAR.Person[emenyid][CC.TXWZ3] == nil then
				WAR.Person[emenyid][CC.TXWZ3] = "明暗乾坤・天翻地覆"
			else
				WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].. "+" .."乾坤・天翻地覆"
			end
			WAR.YXZ[eid] = math.modf((WAR.YXZ[eid] or 0)/2)
		end
		if WAR.MINBG == 2 and WAR.ANBG1[eid] == 2 and WAR.ANBG1[eid] ~= nil then
			hurt = hurt * 4
			WAR.HDGX[eid] = WAR.HDGX[eid] or 0 + 1
			WAR.YHZJ[eid] = WAR.YHZJ[eid] or 0 + 1
			if WAR.Person[emenyid][CC.TXWZ3] == nil then
				WAR.Person[emenyid][CC.TXWZ3] = "明暗坎离・水火无情"
			else
				WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].. "+" .."坎离・水火无情"
			end
			WAR.YXZ[eid] = math.modf((WAR.YXZ[eid] or 0)/2)	
		end	
		if WAR.MINBG == 3 and WAR.ANBG1[eid] == 3 and WAR.ANBG1[eid] ~= nil then
			hurt = hurt * 4
			WAR.BJ = 1
			dng = 0
			WAR.SZWH[eid] = 20
			if WAR.Person[emenyid][CC.TXWZ3] == nil then
				WAR.Person[emenyid][CC.TXWZ3] = "明暗震巽・风怒雷动"
			else
				WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].. "+" .."震巽・风怒雷动"
			end	
			WAR.YXZ[eid] = math.modf((WAR.YXZ[eid] or 0)/2)
		end
		if WAR.MINBG == 4 and WAR.ANBG1[eid] == 4 and WAR.ANBG1[eid] ~= nil then
			hurt = hurt * 4
			if JLSD(10,60,pid) then
			WAR.ATKDOWN[eid] = (WAR.ATKDOWN[eid] or 0) + 64
			else
			WAR.DEFDOWN[eid] = (WAR.DEFDOWN[eid] or 0) + 64
			end
			for i = 0, WAR.PersonNum - 1 do 
				if WAR.Person[i]["我方"] == false and WAR.Person[i]["死亡"] == false and i ~= WAR.CurID then
					WAR.Person[i].Time = WAR.Person[i].Time - 240
				end
			end
			if WAR.Person[emenyid][CC.TXWZ3] == nil then
				WAR.Person[emenyid][CC.TXWZ3] = "明暗艮兑・山泽陷落"
			else
				WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].. "+" .."艮兑・山泽陷落"
			end	
			WAR.YXZ[eid] = math.modf((WAR.YXZ[eid] or 0)/2)
		end
		WAR.MINBG = 0
	end	
  	
	--[[
	--铁掌领悟攻击特效
	if wugong == 13 and wglw1(pid,13) and JY.Person[eid]["内力性质"] == 2 and JLSD(10,40,eid) then
		WAR.HDGX[eid] = (WAR.HDGX[eid] or 0) + 1
		WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) +	AddPersonAttrib(eid, "内力", -(500))
	end
	--寒冰绵掌领悟攻击特效
	if wugong == 5 and wglw1(pid,5) and JY.Person[eid]["内力性质"] == 2 and JLSD(10,40,eid) then
		WAR.YHZJ[eid] = (WAR.YHZJ[eid] or 0) + 1
		WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) +	AddPersonAttrib(eid, "内力", -(500))
	end
	--铁掌领悟 辟邪烈日
	if wugong == 13 and wglw1(pid,13) and WAR.CYANGZ == 2 then
		local aa = WAR.HOT[eid] or 0
		local bb = math.random(3,5)
		local cc = JY.Person[eid]["受伤程度"] or 0
		hurt = hurt + math.modf(hurt * cc)
		WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) +	AddPersonAttrib(eid, "生命", -(bb*aa))
		if JLSD(10,60,pid) then
			if WAR.RJZQ[eid] == nil then
				WAR.RJZQ[eid] = limitX((WAR.RJZQ[eid] or 0) + 10,0,25)
			else	
				WAR.RJZQ[eid] = limitX((WAR.RJZQ[eid] or 0) + 10,0,25)
			end
		end	
	end	
	--铁掌领悟 纯阳贯地
	if wugong == 13 and wglw1(pid,13) and WAR.CYANGZ == 3 then
		local cc = JY.Person[eid]["防御力"] or 0
		local dd = math.random(3,5)
		if WAR.FRYG[eid] == nil and JLSD(10,40,pid) then
			WAR.FRYG[eid] = 1
		else	
			WAR.FRYG[eid] = 1
		end
		hurt = hurt + math.modf(hurt*cc/dd)
		WAR.Person[emenyid][CC.TXDH] = 108
	end]]	
	
	if WAR.YFDLW == 1 then
		if WAR.ICE[eid]~=nil and WAR.ICE[eid]>0 then
			hurt=math.modf(hurt*(1+WAR.ICE[eid]*0.1))
			WAR.Person[emenyid][CC.TXDH] = 67
		end
	    if JLSD(10,50,pid) then
	        WAR.YHZJ[eid]=WAR.YHZJ[eid] or 0 + 1
	    end
    end
  
	--古墓暗器特效
	if WAR.GMAQ > 0 then
		WAR.FXXS[eid] = 1
		WAR.FXDS[eid] = (WAR.FXDS[eid] or 0) + 10
		if WAR.FXDS[eid] >= 30 then
			if WAR.GMAQ == 1 then
				WAR.LQZ[eid] = (WAR.LQZ[eid] or 0) + 20
				if WAR.LQZ[eid] >= 100 then
					WAR.KHCM[eid] = (WAR.KHCM[eid] or 0) + 1
					WAR.LQZ[eid] = 100
				end
				if WAR.Person[emenyid][CC.TXWZ1] == nil then
					WAR.Person[emenyid][CC.TXWZ1] = "钻百会"
				else
					WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" .."钻百会"
				end
			elseif WAR.GMAQ == 2 then
				local aa = WAR.FXDS[eid]
				WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) +	AddPersonAttrib(eid, "内力", -(aa*10))
				if JLSD(10,40,eid) then
					dng = dng / 2
				end
				if WAR.Person[emenyid][CC.TXWZ1] == nil then
					WAR.Person[emenyid][CC.TXWZ1] = "刺丹田"
				else
					WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" .."刺丹田"
				end
			elseif WAR.GMAQ == 3 then
				local bb = WAR.FXDS[eid]
				WAR.Person[emenyid]["受伤程度"] = (WAR.Person[emenyid]["受伤程度"] or 0) + AddPersonAttrib(eid, "受伤程度", (bb/2))
				if WAR.Person[emenyid][CC.TXWZ1] == nil then
					WAR.Person[emenyid][CC.TXWZ1] = "损膻中"
				else
					WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" .."损膻中"
				end
			end
		end
		WAR.GMAQ = 0
	end
	
	--古墓门派领悟 全真克星
	if MPPD(pid) == 16 and yongjian(wugong) then
		if PersonGT(eid,121) and ((DT(eid,59)) or (DT(eid,601)) or (MPPD(eid) == 3 and wglw(eid,121))) then
			local cc = math.random(2,4)
			hurt = math.modf(hurt*(cc / 10))
			ang = math.modf(ang*(cc / 10))
			if JLSD(10,30,eid) then
			 ang = 0
			end
		end
	elseif MPPD(pid) == 16 then
		if PersonGT(eid,121) and ((DT(eid,59)) or (DT(eid,601)) or (MPPD(eid) == 3 and wglw(eid,121))) then
			local cc = math.random(3,7)
			hurt = math.modf(hurt*(cc / 10))
		end	
	end	
	
	--冰魄银针领悟
	if wugong == 170 and WAR.BPLW1 == 1 then
		local aa = WAR.LQZ[eid] or 0
		WAR.ICE[eid] = (WAR.ICE[eid] or 0) + aa
	end

	--冰魄银针领悟
	if wugong == 170 and WAR.BPLW2 == 1 then
		if JY.Person[eid]["中毒程度"] >= 50 and WAR.ICE[eid] >= 50 then
			WAR.CONFUSE[eid] = (WAR.CONFUSE[eid] or 0 ) + 20
			hurt = hurt + math.modf(hurt * ang / 50)
		end
	end

	--冰魄银针领悟
	if wugong == 170 and WAR.BPLW3 == 1 then
		local aa = JY.Person[pid]["内力"]
		if JY.Person[eid]["中毒程度"] < 50 and JLSD(10,40,eid) then
			JY.Person[eid]["中毒程度"] = 50
		elseif JY.Person[eid]["中毒程度"] >= 50 and JLSD(10,40,eid) then
			JY.Person[eid]["中毒程度"] = JY.Person[eid]["中毒程度"] + (math.ceil(aa/300))
		end	
	end		
	
	--冰魄银针领悟
	if wugong == 170 and WAR.BPLW4 == 1 then
		WAR.BPD[eid] = limitX((WAR.BPD[eid] or 0) + 10, 0, 30)
	end	
	
	--黄沙万里鞭特殊加成-金龙鞭
	if wugong == 78 and WAR.QLKS == 1 then 
		dng = 0
		WAR.BLX = 1
		WAR.Person[emenyid][CC.TXDH] = 114
	end

	--持瑶琴回光返照
	if wugong == 73 and wglw1(pid,73) then
		if JY.Person[eid]["中毒程度"] >= 100 then
			if WAR.HGFZ[eid] == nil then
			WAR.HGFZ[eid] = 1
			else
			WAR.HGFZ[eid] = 1
			end
		end
	end
	
	--持瑶琴魂牵罪判
	if wugong == 73 and wglw1(pid,73) and JLSD(10,50,pid) then
		if WAR.HQZP[eid] == nil then
		WAR.HQZP[eid] = 10
		else
		WAR.HQZP[eid] = WAR.HQZP[eid]
		end
		if WAR.Person[emenyid][CC.TXWZ3] == nil then
			WAR.Person[emenyid][CC.TXWZ3] = "阎王三更・魂牵罪判"
		else
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .."魂牵罪判"
		end
	end
	
	--持瑶琴地响
	if WAR.TDSX == 2 then
		WAR.L_WNGZL[eid] = WAR.L_WNGZL[eid] or 0 + 30
	end	
	--三指诛仙
	if WAR.SZZX == 1 then
		WAR.PEACE[eid] = limitX((WAR.PEACE[eid] or 0) + 30, 0, 100)
		WAR.ZDNS[eid] = limitX((WAR.ZDNS[eid] or 0) + 30, 0, 100)
		WAR.Actup[pid] = 1
		WAR.SZZX = 0 
	end
	
	if WAR.SZZX == 3 then --三指诛仙
		local aa = math.random(5,10)
		local bb = math.modf(JY.Person[pid]["内力最大值"]/aa)
		JY.Person[pid]["内力"] = JY.Person[pid]["内力"] - bb
		if JY.Person[pid]["内力"] <= 0 then
			JY.Person[pid]["内力"] = 0
		end
		hurt = (hurt*math.modf(bb/100)) + math.modf(bb/10)
		if (JY.Person[eid]["生命"] <= (JY.Person[eid]["生命最大值"]/2)) and WAR.SZZX1[eid] == nil then
			WAR.SZZX1[eid] = (WAR.SZZX1[eid] or 0) + 30
		end
		WAR.SZZX = 0	
	end	
	
	if WAR.ZDNS[eid] ~= nil then -- 重伤效果
		if JLSD(10,50,eid) then
			JY.Person[eid]["受伤程度"] = math.modf(JY.Person[eid]["受伤程度"]*2)
		end
		WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", - math.modf(JY.Person[eid]["受伤程度"]*2))
		--JY.Person[eid]["生命"] = JY.Person[eid]["生命"] 
	end
	
	if WAR.EMQF1[pid] ~= nil then --截手九式
		if yongquan(wugong) or yongjian(wugong) then
			hurt = hurt - 300
		end
		if WAR.BJ == 1 then
			WAR.ACT = 10
		end
		WAR.EMQF1[pid] = 0
	end
	
	if JY.Person[pid]["武器"] == 37 or DT(pid,6) then
		if WAR.L_MMJF == 2 then
			WAR.Person[emenyid].Time = WAR.Person[emenyid].Time - 100
		elseif WAR.L_MMJF == 4 then
			WAR.Person[emenyid].Time = WAR.Person[emenyid].Time - 150
		end
	end	
	
	if wglw(eid,153) and (WAR.BJ == 1 or JLSD(10,40,eid)) then
		dng = dng + 2000
		WAR.LHFY1[eid] = (WAR.LHFY1[eid] or 0) + ang
		if WAR.Person[emenyid][CC.TXWZ1] == nil then
			WAR.Person[emenyid][CC.TXWZ1] = "风鹤气劲"
		else
			WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" .."风鹤气劲"
		end
	end

	if WAR.LHFY == 1 and wglw(pid,153) then
		local FH = WAR.LHFY1[pid] or 0
		WAR.LHFY2[eid] = (WAR.LHFY2[eid] or 0) + (ang/10) + FH
		WAR.LHFY1[pid] = nil
	end	
	
	if WAR.DXYM == 1 then
		WAR.DXYM1[eid] = 1
	end	
	
	if WAR.LJZYJ1 == 1 and wglw(pid,153) then --临济领悟战意技
		local aa = 0
		--if WAR.LXZT[eid] ~= nil or WAR.ICE[eid] ~= nil 
			--or WAR.HOT[eid] ~= nil or WAR.FXDS[eid] ~= nil or WAR.CHZ[eid] ~= nil then
		aa = aa + (WAR.LXZT[eid] or 0 ) + (WAR.ICE[eid] or 0 ) + (WAR.HOT[eid] or 0 ) + (WAR.FXDS[eid] or 0 ) +	(WAR.CHZ[eid] or 0 )
		if aa > 300 then aa = 300 end
		WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid,"生命", aa)
		WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid,"内力", (aa*5))
	end

	if WAR.LJZYJ2 == 1 and wglw(pid,153) then
		WAR.SPIRIT[eid] = (WAR.SPIRIT[eid] or 0) - 5
	end	
	
	if WAR.LJZYJ3 == 1 and wglw(pid,153) then
		local aa = hurt
		if aa > 2500 then aa = 2500 end
		WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - aa;
  	    AddPersonAttrib(eid, "内力", -aa);
	    hurt = 0
		if JY.Person[eid]["内力"] < JY.Person[eid]["生命"] and JLSD(10,60,eid)then
			JY.Person[eid]["生命"] = JY.Person[eid]["内力"]
		end	
	end
	
	if WAR.LJZYJ4 == 1 and wglw(pid,153) then
		local ee = sixi(pid,1) + sixi(pid,2) + sixi(pid,3) + sixi(pid,4) + sixi(pid,5)
		hurt = math.modf((hurt * ee)/100)
		JY.Person[pid]["生命"] = JY.Person[pid]["生命最大值"]
		JY.Person[pid]["内力"] = JY.Person[pid]["内力最大值"]
		JY.Person[pid]["受伤程度"] = nil
		JY.Person[pid]["中毒程度"] = nil
		WAR.FXDS[pid] = nil
		WAR.CHZ[pid] = nil
		WAR.ICE[pid] = nil
		WAR.HOT[pid] = nil
		WAR.LXZT[pid] = nil
		if WAR.HIDE[pid] == nil or WAR.HIDE[pid] < 30 then
			WAR.HIDE[pid] = 30
		end
		WAR.ACT = 10		
	end	
	
	--阴阳磨普通特效
	if PersonKF(pid,189) then
		local aa = math.random(3,5)
		local bb = 100 * aa
		if PersonGT(pid,189) then
			local str = "阴阳磨"
			if JY.Person[pid]["内力性质"] == 0 and JY.Person[eid]["内力性质"] ~= 0 then 
				hurt = hurt * 1.5
				ang = ang * 1.5
				WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - bb
				if WAR.Person[emenyid][CC.TXWZ1] == nil then
					WAR.Person[emenyid][CC.TXWZ1] = str
				else
					WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" ..str
				end
			elseif 	JY.Person[pid]["内力性质"] == 1 and JY.Person[eid]["内力性质"] ~= 1 then
				hurt = hurt * 1.5
				ang = ang * 1.5
				WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - bb
				if WAR.Person[emenyid][CC.TXWZ1] == nil then
					WAR.Person[emenyid][CC.TXWZ1] = str
				else
					WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" ..str
				end
			elseif	JY.Person[pid]["内力性质"] == 2 then
				ang = ang * 2
				WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - (bb-100)
				if WAR.Person[emenyid][CC.TXWZ1] == nil then
					WAR.Person[emenyid][CC.TXWZ1] = str
				else
					WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" ..str
				end
			elseif 	JY.Person[pid]["内力性质"] == 3 then
				hurt = hurt * 2
				ang = ang * 2
				WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - (bb*1.5)
				if WAR.Person[emenyid][CC.TXWZ1] == nil then
					WAR.Person[emenyid][CC.TXWZ1] = str
				else
					WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" ..str
				end
			end
		else
			if JY.Person[pid]["内力性质"] == 0 and JY.Person[eid]["内力性质"] ~= 0 then 
				hurt = hurt * 1.25
				ang = ang * 1.25
			elseif 	JY.Person[pid]["内力性质"] == 1 and JY.Person[eid]["内力性质"] ~= 1 then
				hurt = hurt * 1.25
				ang = ang * 1.25
			elseif	JY.Person[pid]["内力性质"] == 2 then
				ang = ang * 1.5
			elseif 	JY.Person[pid]["内力性质"] == 3 then
				hurt = hurt * 2
				ang = ang * 2	
			end
		end	
	end
	
	if PersonKF(eid,189) then
		if PersonGT(eid,189) then
			if JY.Person[pid]["内力性质"] == 0 and JY.Person[eid]["内力性质"] == 0 then 
				hurt = hurt - 500
				ang = ang  - 2000
			elseif 	JY.Person[pid]["内力性质"] == 1 and JY.Person[eid]["内力性质"] == 1 then
				hurt = hurt - 500
				ang = ang  - 2000
			elseif	JY.Person[eid]["内力性质"] == 2 then
				ang = ang - 3000
			elseif 	JY.Person[eid]["内力性质"] == 3 then
				hurt = hurt - 600
				ang = ang - 3000	
			end
		else
			if JY.Person[pid]["内力性质"] == 0 and JY.Person[eid]["内力性质"] == 0 then 
				hurt = hurt - 250
				ang = ang -1000
			elseif 	JY.Person[pid]["内力性质"] == 1 and JY.Person[eid]["内力性质"] == 1 then
				hurt = hurt - 250
				ang = ang - 1000
			elseif	JY.Person[eid]["内力性质"] == 2 then
				ang = ang - 1500
			elseif 	JY.Person[eid]["内力性质"] == 3 then
				hurt = hurt - 300
				ang = ang - 2000		
			end
		end	
	end
	----阴阳磨普通特效结束
	--阴阳磨领悟效果
	if (wglw(eid,189) or DT(eid,603)) and PersonGT(eid,189) then
		local str = "真・阴阳磨"
		local aa = JY.Person[pid]["内力最大值"] or 0 
		local bb = math.modf(JY.Person[pid]["内力"] / JY.Person[pid]["内力最大值"])
		local cc = JY.Person[eid]["生命最大值"] - JY.Person[eid]["生命"]
		if bb < 0.1 then bb = 0.1 end
		WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", -(aa/10))
		hurt = hurt * bb 		
		if WAR.YANGJ[eid] ~= nil and WAR.YANGJ[eid] > 0 then
			local selfhurt = math.modf(hurt/3)
			if WAR.Person[emenyid][CC.TXWZ2] == nil then
				WAR.Person[emenyid][CC.TXWZ2] = "阴阳气・阳极神罡"
			else
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+阴阳气・阳极神罡"
			end	
			SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 4, 2)
			WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", - selfhurt)
			--JY.Person[pid]["生命"] = JY.Person[pid]["生命"] 
			if PersonGTHT(eid,189,WAR.NGHT) and WAR.YQWR1[pid] == nil then
				WAR.YQWR1[pid] = 20
			end	
			if JY.Person[pid]["生命"] <= 0 then		--弹不死
				JY.Person[pid]["生命"] = 1
			end
			--WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) - selfhurt
		elseif WAR.YINJ[eid] ~= nil and WAR.YINJ[eid] > 0 then
			WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", (cc/2))
			if WAR.Person[emenyid][CC.TXWZ2] == nil then
				WAR.Person[emenyid][CC.TXWZ2] = "阴阳气・阴极返命"
			else
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+阴阳气・阴极返命"
			end	
			if PersonGTHT(eid,189,WAR.NGHT) and WAR.YQWR2[pid] == nil then
				WAR.YQWR2[pid] = 20
			end
		end	
		if WAR.Person[emenyid][CC.TXWZ1] == nil then
			WAR.Person[emenyid][CC.TXWZ1] = str
		else
			WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" ..str
		end
	end	
	
	if wglw(pid,189) and WAR.YSJS[pid] ~= nil and WAR.YSJS[pid] > 0 then
		local aa = math.modf(JY.Person[eid]["内力"] / JY.Person[pid]["内力最大值"])
		hurt = hurt * math.modf((1+(1-aa))*3)
		if WAR.YQWR1[eid] == nil then
			WAR.YQWR1[eid] = 20
		else 	
			WAR.YQWR1[eid] = (WAR.YQWR1[eid] or 0 ) + 20
		end	
		if WAR.Person[emenyid][CC.TXWZ3] == nil then
			WAR.Person[emenyid][CC.TXWZ3] = "阳神降世・荡尽邪魔"
		else
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .."阳神降世・荡尽邪魔"
		end
	end
	if wglw(pid,189) and WAR.YSZL[pid] ~= nil and WAR.YSZL[pid] > 0 then
		if WAR.YQWR2[eid] == nil then
			WAR.YQWR2[eid] = 20
		else 	
			WAR.YQWR2[eid] = (WAR.YQWR2[eid] or 0 ) + 20
		end	
		if math.random(10) > 6 then
			WAR.YHDF[eid] = 1
		else
			if WAR.LHFM[eid] == nil then
				WAR.LHFM[eid] = 20
			else
				WAR.LHFM[eid] = (WAR.LHFM[eid] or 0) + 20
			end
		end
		if WAR.Person[emenyid][CC.TXWZ3] == nil then
			WAR.Person[emenyid][CC.TXWZ3] = "阴圣再临・乾坤清盛"
		else
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .."阴圣再临・乾坤清盛"
		end
	end	
	--阴阳磨领悟结束	
	
	if PersonKF(pid,192) and MPPD(pid) == 16 then --全真金雁功伤害
		local mpdj = MPDJ(pid)
		hurt = hurt + math.modf(((mpdj*10)+WAR.XKZ)*10)
	end	
	
	if PersonKF(pid,199) and JLSD(10,50,pid) then --龙行虎步
		local aa = math.random(3)
		WAR.SPIRIT[pid] = WAR.SPIRIT[pid] + aa
		if wglw2(pid,198) then
			WAR.SPIRIT[pid] = WAR.SPIRIT[pid] + aa
		end	
    end
	
	if PersonKF(eid,199) and wglw2(eid,199) and JLSD(10,60,eid) then
		if WAR.SPIRIT[pid] ~= nil and WAR.SPIRIT[eid] ~= nil and WAR.SPIRIT[eid] > WAR.SPIRIT[pid] then
			local aa = math.modf((WAR.SPIRIT[eid] - WAR.SPIRIT[pid])/100)
			local str = "天子身"
			hurt = math.modf(hurt*(1-aa))
			if WAR.Person[emenyid][CC.TXWZ3] == nil then
				WAR.Person[emenyid][CC.TXWZ3] = str
			else
				WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" ..str
			end
		end
	end	
	if PersonKF(pid,199) and MPPD(pid) == 15 then--龙行虎步
		if WAR.SPIRIT[pid] > WAR.SPIRIT[eid] and (yongquan(wugong) or wugong == 49 ) then
			WAR.FXXS[eid] = 1
			WAR.FXDS[eid] = 5
			if WAR.FXDS[eid] == nil then
				WAR.FXDS[eid] = 5
			else
				WAR.FXDS[eid] = WAR.FXDS[eid] + 5
			end
		end	
	end	

	if PersonKF(eid,200) then --摘星功
		local aa = JY.Person[eid]["用毒能力"] or 0
		local str = "摘星换斗"
		if JLSD(10,aa/5,eid) then
			if MPPD(eid) == 1 then
				WAR.Person[WAR.CurID]["中毒点数"] = (WAR.Person[WAR.CurID]["中毒点数"] or 0) + 
				AddPersonAttrib(pid, "中毒程度", 30)
				if JLSD(10,aa/2,eid) then
					WAR.DUO = 1
					if JY.Person[eid]["中毒程度"] >= 80 then
						WAR.OYFSD[pid] = (WAR.OYFSD[pid] or 0) +  15
						WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命",-math.modf(JY.Person[pid]["中毒程度"]/2))
						--AddPersonAttrib(pid,"生命",)
					end
				end	
			else
				WAR.Person[WAR.CurID]["中毒点数"] = (WAR.Person[WAR.CurID]["中毒点数"] or 0) + AddPersonAttrib(pid, "中毒程度", 20)
			end
			if WAR.Person[emenyid][CC.TXWZ1] == nil then
				WAR.Person[emenyid][CC.TXWZ1] = str
			else
				WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" ..str
			end
		end
	end
	
	if PersonKF(eid,200) and wglw2(eid,200) and JLSD(10,50,eid) then
		local aa = JY.Person[eid]["用毒能力"] or 0
		if WAR.ZXGLW[pid] == nil then
			WAR.ZXGLW[pid] = math.modf(aa/50)
			WAR.ZXGLW1[pid] = 11
		end
		if WAR.Person[emenyid][CC.TXWZ3] == nil then
			WAR.Person[emenyid][CC.TXWZ3] = "毒落星辰"
		else
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .."毒落星辰"
		end
	end	
	
	if PersonKF(pid,203) and WAR.NHJT == 1 then --怒海剑涛
		WAR.DEFDOWN[eid] = (WAR.DEFDOWN[eid] or 0 ) +20
	end	
	
	if wglw(pid,203) and yongjian(wugong) then
		hurt = hurt * math.modf((JY.Person[pid]["内力"]+JY.Person[pid]["内力最大值"])/1000)
	end
		
	if wglw(eid,203) then
		dng = dng + math.modf((JY.Person[pid]["内力"]+JY.Person[pid]["内力最大值"])/100)
		hurt = math.modf((hurt * 0.35) - sixi(eid,2))
		if WAR.Person[emenyid].Time < 300 then
			WAR.Person[emenyid].Time = 300
		end
		if JLSD(10,25,eid) then
			WAR.NTLW4[eid] = 2
		end	
		if WAR.Person[emenyid][CC.TXWZ3] == nil then
			WAR.Person[emenyid][CC.TXWZ3] = "剑定海涛"
		else
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .."剑定海涛"
		end
	end	
	--怒海剑涛领悟结束
	if PersonKF(pid,196) and MPPD(pid) == 12 then
		if WAR.QQSH1 == 1 then
			WAR.Person[WAR.CurID]["中毒点数"] = (WAR.Person[WAR.CurID]["中毒点数"] or 0) + 
			AddPersonAttrib(pid, "中毒程度", (WAR.ICE[eid] or 0))
		end
		if WAR.QQSH1 == 2  then
			WAR.Person[WAR.CurID]["内伤点数"] = (WAR.Person[WAR.CurID]["内伤点数"] or 0) + 
			AddPersonAttrib(pid, "受伤程度", (WAR.FXDS[eid] or 0))
		end
		if WAR.QQSH1 == 3  then
			if JY.Person[eid]["体力"] > 30 then
				local aa = math.random(5)
				JY.Person[eid]["体力"] = JY.Person[eid]["体力"] - aa
			end	
		end
		if WAR.QQSH1 == 4  then
			if WAR.LQZ[eid] == nil or WAR.LQZ[eid] < 50 then
				WAR.PEACE[eid] = limitX((WAR.PEACE[eid] or 0) + 6, 0, 30)
			end	
		end
	end	
	
	--弹指神通领悟炮台
	if wugong == 18 and WAR.TZPT > 0 then--
		local str = ""
		if WAR.TZPT == 6 then
			WAR.MENG[eid] = 50
			--str = "弹指・碧海劲"
		end
		if WAR.TZPT == 103 then
			hurt = hurt + (JY.Person[pid]["攻击力"] or 0)
			WAR.DEFDOWN[eid] = 50
			--str = "弹指・龙象劲"
		end
		if WAR.TZPT == 95 then
			WAR.L_WNGZL[eid] = 50
			--str = "弹指・蛤蟆劲"
		end
		if WAR.TZPT == 90 then	
			AddPersonAttrib(eid,"体力",-math.random(2,5))
			local aa = math.abs(JY.Person[pid]["体力"]-JY.Person[eid]["体力"])
			hurt = hurt * math.modf(aa/10)
			--str = "弹指・混元劲"
		end
		if WAR.TZPT == 93 then	
			WAR.XZZ = 1
			--str = "弹指・圣火劲"
		end
		if WAR.TZPT == 94 then	
			WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid,"生命",math.modf(JY.Person[pid]["生命最大值"]/10))
			WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid,"内力",math.modf(JY.Person[pid]["内力最大值"]/10))
			WAR.Person[WAR.CurID]["体力点数"] = (WAR.Person[WAR.CurID]["体力点数"] or 0) + AddPersonAttrib(pid,"体力",10)
			--str = "弹指・神照劲"
		end
		if WAR.TZPT == 96 then	
			WAR.LHFM[eid] = (WAR.LHFM[eid] or 0) + 15
			--str = "弹指・伏魔劲"
		end
		if WAR.TZPT == 97 then	
			WAR.TZQJ1[pid] = 50---50时序内被攻击时二次判定乾坤
			--str = "弹指・乾坤劲"
		end
		if WAR.TZPT == 98 then	
			WAR.HIDE[pid] = (WAR.HIDE[pid] or 0) + 30
			--str = "弹指・无相劲"
		end	
		if WAR.TZPT == 99 then	
			WAR.TZQJ2[pid] = 100--100时序内武功不耗内，且加速纯阳清毒
			--str = "弹指・纯阳劲"
		end
		if WAR.TZPT == 100 then	
			WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid,"生命",300)
			WAR.TZQJ3[pid] = 50 --50时序内，攻击时机率享受「先天真气调理」效果
			--str = "弹指・先天劲"
		end
		if WAR.TZPT == 101 then	
			WAR.bhbm[3000+eid] = 92--直接触发八荒八灭效果
			--str = "弹指・八荒劲"
		end
		if WAR.TZPT == 102 then	
			hurt = hurt + math.modf((sixi(pid,1)+sixi(pid,2))*2)--本次攻击附加拳剑系数伤害，
			WAR.LQZ[pid] = (WAR.LQZ[pid] or 0) + 25--增加自身怒气25，
			WAR.TZQJ4[pid] = 5--五回合内必连必暴
			--str = "弹指・太玄劲"
		end
		if WAR.TZPT == 104 then	
			WAR.TZQJ5[eid] = 30--30时序内机率增加内伤。机率依照内伤触发逆奔流效果
			--str = "弹指・逆运劲"
		end
		if WAR.TZPT == 105 then	
			for cm = 0, WAR.PersonNum-1 do --该次攻击全屏刺目
				if WAR.Person[cm]["死亡"] == false and WAR.Person[cm]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
					local cmid = WAR.Person[cm]["人物编号"]
					WAR.KHCM[cmid] = 1
				end
			end
			WAR.TZQJ6[pid] = 30 -- 50时序内被攻击高机率触发葵花魅影闪躲攻击
			--str = "弹指・葵花劲"
		end
		if WAR.TZPT == 106 then	
			JY.Person[pid]["中毒程度"] = 0
			WAR.JYHT[pid] = 5
			WAR.YQWR1[eid] = 20
			--str = "弹指・九阳劲"
		end
		if WAR.TZPT == 107 then	
			JY.Person[pid]["受伤程度"] = 0
			WAR.LXZT[pid] = 0
			WAR.JYZQ[pid] = 5
			WAR.YQWR2[eid] = 20
			--str = "弹指・九阴劲"
		end
		if WAR.TZPT == 108 then	
			JY.Person[pid]["内力"] = JY.Person[pid]["内力最大值"]
			WAR.CHZ[pid] = 0
			WAR.MABI[pid] = 0
			WAR.TZQJ7[pid] = 30 --30时序内，被攻击不破防，机率触发绝对气防
			--str = "弹指・易筋劲"
		end
		--以下是part2
		if WAR.TZPT == 121 then	
			WAR.TZQJ8[pid] = 30--30时序内，自身五格内的敌人怒气时序上升，并依照其怒气回补自身命、体、被满怒敌人攻击必然无伤
			str = "弹指・玉女劲"
		end
		if WAR.TZPT == 124 then	
			WAR.ICEXS[eid] = 1
			WAR.ICE[eid] = (WAR.ICE[eid] or 0) + 10
			WAR.YHZJ[eid] = 1
			WAR.HBZQ[eid] = 30
			--str = "弹指・寒冰劲"
		end
		if WAR.TZPT == 150 then	
			local aa = math.modf(JY.Person[pid]["体力"]/10)
			WAR.FXXS[eid] = 1
			WAR.FXDS[eid] = (WAR.FXDS[eid] or 0) + aa
			WAR.SPIRIT[pid] = (WAR.SPIRIT[pid] or 0 ) + aa
			--str = "弹指・玉i劲"
		end
		if WAR.TZPT == 151 then	
			WAR.TZQJ9[pid] = 30 --30时序内，享受金刚不坏免伤、减少杀气效果。
			--str = "弹指・金刚劲"
		end
		if WAR.TZPT == 152 then	
			WAR.HOTXS[eid] = 1
			WAR.HOT[eid] = (WAR.HOT[eid] or 0) + 10
			WAR.HDGX[eid] = 1
			WAR.RJZQ[eid] = 20
			--str = "弹指・易阳劲"
		end
		if WAR.TZPT == 153 then	
			WAR.TZQJ10[pid] = 100 --接下来100时序内，暴击大幅增加伤害、大幅降低战意并且回复血量
			str = "弹指・临济劲"
		end
		if WAR.TZPT == 180 then	
			WAR.TZQJ11[pid] = 30 --接下来30时序内，攻击时享受伤害加成，加成幅度类似于太虚对剑法的加成
			--str = "弹指・太虚劲"
		end
		if WAR.TZPT == 181 then	
			WAR.TZQJ12[pid] = 1 --该回合攻击机率发动「十方皆灭」
			--str = "弹指・玄武劲"
		end
		if WAR.TZPT == 182 then	
			WAR.TZQJ13[pid] = 1 --该回合攻击不触发斗转、乾坤反弹、对招以及玉女反噬
			--str = "弹指・太极劲"
		end
		if WAR.TZPT == 183 then	
			AddPersonAttrib(eid,"内力",-JY.Person[pid]["内力"])
			JY.Person[pid]["内力"] = JY.Person[pid]["内力最大值"]
			JY.Person[pid]["体力"] = (JY.Person[pid]["体力"] or 0) + 50
			WAR.Person[WAR.CurID]["内力点数"] = JY.Person[pid]["内力最大值"]
			WAR.Person[WAR.CurID]["体力点数"] = (WAR.Person[WAR.CurID]["体力点数"] or 0) + 50
			JY.Person[pid]["受伤程度"] = 0
			JY.Person[pid]["中毒程度"] = 0
			WAR.POISON[pid] = nil
			WAR.OYFSD[pid] = nil
			WAR.HDGX[pid] = nil
			WAR.YHZJ[pid] = nil
			WAR.L_WNGZL[pid] = nil
			WAR.GUDUVICTIE[pid] = nil
			--str = "弹指・洗髓劲"
		end
		if WAR.TZPT == 184 then	
			WAR.LQZ[pid] = 99
			WAR.SPIRIT[pid] = WAR.SPIRITMAX[pid]
			hurt = hurt + math.modf((JY.Person[pid]["攻击力"] + JY.Person[pid]["防御力"] + JY.Person[pid]["轻功"])*3)
			--str = "弹指・瑜伽劲"
		end
		if WAR.TZPT == 188 then	
			for sz = 0, WAR.PersonNum-1 do --该次攻击
				if WAR.Person[sz]["死亡"] == false and WAR.Person[sz]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
					local szid = WAR.Person[sz]["人物编号"]
					WAR.SZWH[szid] = 10
					WAR.L_NOT_MOVE[szid] = 1
				end
			end
			WAR.TZQJ14[pid] = 30 --30时序内享受圣火主运行动后再移动的效果
			--str = "弹指・神足劲"
		end
		if WAR.TZPT == 189 then	
			local yang = 0
			local yin = 0
			local tiao = 0
			for yy = 0, WAR.PersonNum-1 do 
				local yyid = WAR.Person[yy]["人物编号"]
				if WAR.Person[yy]["死亡"] == false then
					if JY.Person[yyid]["内力性质"] == 0 then
						yin = yin + 1
					elseif JY.Person[yyid]["内力性质"] == 1 then
						yang = yang + 1
					elseif 	JY.Person[yyid]["内力性质"] == 2 then
						tiao = tiao + 1
					end
				end
			end
			WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid,"生命",-math.modf(yin*10))
			WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid,"内力",-math.modf(yang*200))
			WAR.Person[emenyid]["体力点数"] = (WAR.Person[emenyid]["体力点数"] or 0) + AddPersonAttrib(eid,"体力",-math.modf(tiao*10))
			--str = "弹指・阴阳劲"
		end
		if WAR.TZPT == 203 then	
			WAR.SPIRIT[pid] = (WAR.SPIRIT[pid] or 0) + 10
			for nh = 0, WAR.PersonNum-1 do
				local nhid = WAR.Person[nh]["人物编号"]
				if WAR.Person[nh]["死亡"] == false and WAR.Person[nh]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
					if WAR.LQZ[nhid] == nil then
						AddPersonAttrib(nhid,"生命",-100)
					else
						AddPersonAttrib(nhid,"生命",-math.modf(100 * WAR.LQZ[nhid]))
						WAR.MENG[nhid] = WAR.LQZ[nhid]
						WAR.LQZ[nhid] = 0
					end
				end	
			end	
			--str = "弹指・怒海劲"
		end
		if WAR.TZPT == 178 then	
			AddPersonAttrib(eid,"受伤程度",100)
			if WAR.SPIRIT[pid] ~= nil and WAR.SPIRIT[pid] > 120 then
				WAR.FDZS[eid] = 50
			end	
			--str = "弹指・擒龙劲"
		end
		--[[if WAR.TZPT == 204 then	
			
			str = "弹指・太清劲"
		end]]
	end
	
	if WAR.TZQJ10[pid] ~= nil and WAR.BJ == 1 then
		WAR.SPIRIT[eid] = (WAR.SPIRIT[eid] or 0) - math.modf(3,10)
		hurt = math.modf(hurt * sixi(pid,5))
	end	
	
	if wugong == 18 and (wglw1(pid,18) or DT(pid,57)) and WAR.TZPT1 == 1 then
		hurt = math.modf(hurt * ang * 0.5)
	end	
	
	--灵蛇杖法领悟
	if wugong == 120 and (wglw1(pid,120) or DT(eid, 60) or DT(eid, 620)) and DWPD() then
		hurt = hurt * math.modf((sixi(pid,4)+sixi(eid,4)/100))
		if JY.Person[eid]["中毒程度"] ~= nil then
			hurt = hurt + (JY.Person[eid]["中毒程度"]*5)
		end	
		if JY.Person[eid]["中毒程度"] >= 100 then
			if math.random(10) > 8 and WAR.LSZD1[eid] == nil then
				WAR.LSZD1[eid] = 10
				if WAR.Person[emenyid][CC.TXWZ2] == nil then
					WAR.Person[emenyid][CC.TXWZ2] = "双蛇剧毒・基因毒"
				else
					WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .."双蛇剧毒・基因毒"
				end
			else
				if math.random(10) > 5 and WAR.LSZD2[eid] == nil then
					WAR.LSZD2[eid] = 1
					if WAR.Person[emenyid][CC.TXWZ2] == nil then
						WAR.Person[emenyid][CC.TXWZ2] = "双蛇剧毒・神经毒"
					else
						WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .."双蛇剧毒・神经毒"
					end
				else
					if WAR.LSZD[eid] == nil then
						WAR.LSZD[eid] = 1
					end	
					if WAR.Person[emenyid][CC.TXWZ2] == nil then
						WAR.Person[emenyid][CC.TXWZ2] = "双蛇剧毒・出血毒"
					else
						WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .."双蛇剧毒・出血毒"
					end
				end
			end
		end
	end	
	if wugong == 120 and DWPD() and WAR.OYFSD[eid] == nil then
		if wglw1(pid,120) and JLSD(10,60,pid) then
			WAR.Person[emenyid][CC.TXWZ3] = "灵蛇杖毒"
			WAR.Person[emenyid][CC.TXDH] = 112
			WAR.OYFSD[eid] = 100
		elseif (DT(pid,60) or DT(pid,620)) and JLSD(10,40,pid) then
			WAR.Person[emenyid][CC.TXWZ3] = "灵蛇杖毒"
			WAR.Person[emenyid][CC.TXDH] = 112
			WAR.OYFSD[eid] = 100
		end
	end
	if PersonKF(eid,120) and DWPD() and WAR.OYFSD[pid] == nil then
		if wglw1(eid,120) and JLSD(0,50,eid) then
			hurt = hurt - sixi(eid,4)
			WAR.Person[emenyid][CC.TXWZ3] = "灵蛇杖毒"
			WAR.Person[emenyid][CC.TXDH] = 112
			WAR.OYFSD[pid] = 100
		elseif (DT(eid, 60) or DT(eid, 620))  and JLSD(0,30,eid) then
			hurt = hurt - sixi(eid,4)
			WAR.Person[emenyid][CC.TXWZ3] = "灵蛇杖毒"
			WAR.Person[emenyid][CC.TXDH] = 112
			WAR.OYFSD[pid] = 100
		end	
	end	
	if wugong == 120 and WAR.LSZD[eid] ~= nil and WAR.LSZD[eid] == 1 then
		local str = ""
		hurt = hurt + math.modf(hurt * (WAR.LXZT[eid]or 0) / 10)
		if WAR.LXZT[eid] ~= nil and JLSD(10,WAR.LXZT[eid],eid) then
			WAR.CHXS[eid] = 1
			WAR.CHZ[eid] = (WAR.CHZ[eid] or 0) + math.modf(WAR.LXZT[eid]/2)
		end
		if WAR.LXZT[eid] ~= nil and WAR.LXZT[eid] >= 100 and JY.Person[eid]["中毒程度"] ~= nil and JY.Person[eid]["中毒程度"] >= 100 and JLSD(10,60,eid) then
			WAR.LSZD[eid] = nil
			WAR.Person[emenyid].Time = WAR.Person[emenyid].Time - 300
			if WAR.Person[emenyid].Time < -500 then
				WAR.Person[emenyid].Time = -500
			end	
			WAR.XUEMO[eid] = 30
			if WAR.Person[emenyid][CC.TXWZ3] == nil then
				WAR.Person[emenyid][CC.TXWZ3] = "万蛇天化・赤尾青竹"
			else
				WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .."万蛇天化・赤尾青竹"
			end
			WAR.Person[emenyid][CC.TXDH] = 135
		elseif wugong == 9 and WAR.LSZD[eid] ~= nil and WAR.LSZD[eid] == 1 then
			if JLSD(10,25,eid) and WAR.LXZT[eid] ~= nil and WAR.LXZT[eid] >= 100 and JY.Person[eid]["中毒程度"] ~= nil and JY.Person[eid]["中毒程度"] >= 100 then
				WAR.LSZD[eid] = nil
			end
		end	
	end
	if WAR.LSZD2[pid] ~= nil and WAR.LSZD2[pid] == 1 then
		local aa = math.modf(hurt*0.5)
		if math.random(10) > 5 then
			if hurt > 0 then
				hurt = 0
			end	
			WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid,"生命",-aa)
			WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"]or 0) + AddPersonAttrib(pid,"生命",-aa)
		else
			if hurt > 0 then
				hurt = 0
			end
			AddPersonAttrib(eid,"生命",aa)
			WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"]or 0) + AddPersonAttrib(eid,"生命",aa)
		end
	end	
	if wugong == 120 and WAR.LSZD2[eid] ~= nil and WAR.LSZD2[eid] == 1 then
		if JY.Person[eid]["中毒程度"] ~= nil and JY.Person[eid]["中毒程度"] >= 100 and JLSD(10,70,pid) then
			WAR.LSZD2[eid] = nil
			WAR.SZWH[eid] = 20
			WAR.BZ[eid] = 2
		end
		if WAR.Person[emenyid][CC.TXWZ3] == nil then
			WAR.Person[emenyid][CC.TXWZ3] = "万蛇天化・眼镜王蛇"
		else
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .."万蛇天化・眼镜王蛇"
		end
		WAR.Person[emenyid][CC.TXDH] = 40
	elseif 	wugong == 9 and WAR.LSZD2[eid] ~= nil and WAR.LSZD2[eid] == 1 then
		if JLSD(10,25,eid) and JY.Person[eid]["中毒程度"] ~= nil and JY.Person[eid]["中毒程度"] >= 100 then
			WAR.LSZD2[eid] = nil
		end	
	end	
		
	if wugong == 120 and WAR.LSZD1[eid] ~= nil then
		if JLSD(10,70,pid) then
			dng = 0
		end
		if JY.Person[eid]["中毒程度"] >= 100 and JLSD(10,40,pid) then
			WAR.KHCM[eid] = 1
			WAR.ZDNS[eid] = (WAR.ZDNS[eid] or 0) + 20
			if WAR.Person[emenyid][CC.TXWZ3] == nil then
				WAR.Person[emenyid][CC.TXWZ3] = "万蛇天化・金银双环"
			else
				WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .."万蛇天化・金银双环"
			end
			WAR.Person[emenyid][CC.TXDH] = 50
		end
	end	
	--灵蛇杖法领悟结束
	--灵蛇拳法领悟
	if wugong == 9 and (wglw1(pid,9) or (DT(pid,61) and JX(pid))) and DWPD() then
		local aa = math.modf(sixi(eid,1)*3)
		if aa < 500 then aa = aa + 300 end
		if MPPD(pid) == 8 and PersonGT(pid,95) then
			hurt = hurt + math.abs(math.modf((aa*3)-1000))
		else
			hurt = hurt + math.modf((aa*10)-2000)
		end	
		if WAR.LSQ[eid] == nil then
			WAR.LSQ[eid] = 1
		end	
	end
	if wugong == 9 and (wglw1(pid,9) or (DT(pid,61) and JX(pid))) and DWPD() then
		if JY.Person[eid]["中毒程度"] == nil then
			JY.Person[eid]["中毒程度"] = 10
		else
			JY.Person[eid]["中毒程度"] = JY.Person[eid]["中毒程度"] + 10
		end
	end
	if wugong == 9 and (wglw1(pid,9) or (DT(pid,61) and JX(pid))) and DWPD() and JLSD(10,60,pid) then
		local str = ""
		local bb = math.random(8)--火毒、寒毒、蛊毒、毒击、杖毒、冰魄毒、七死、猛毒
		if bb == 1 then
			WAR.HDGX[eid] = (WAR.HDGX[eid] or 0) + 1
			str = "火毒攻心"
		elseif bb == 2 then
			WAR.YHZJ[eid] = (WAR.YHZJ[eid] or 0) + 1
			str = "寒毒侵脉"
		elseif bb == 3 then
			WAR.GUDUVICTIE[eid] = (WAR.GUDUVICTIE[eid] or 0) + 1
			str = "蛊毒缠身"
		elseif bb == 4 then
			WAR.L_WNGZL[eid] = (WAR.L_WNGZL[eid] or 0) + 20
			str = "绝毒重击"
		elseif bb == 5 then
			WAR.OYFSD[eid] = 100
			str = "灵蛇杖毒"
		elseif bb == 6 then
			WAR.BPD[eid] = (WAR.BPD[eid] or 0) + 20
			str = "冰魄奇毒"
		elseif bb == 7 then
			WAR.POISON[eid] = (WAR.POISON[eid] or 0) + 20
			str = "不解猛毒"
		elseif bb == 8 then
			WAR.QSLZ[eid] = (WAR.QSLZ[eid] or 0) + 1
			str = "七死爆毒"
		end
		if WAR.Person[emenyid][CC.TXWZ2] == nil then
			WAR.Person[emenyid][CC.TXWZ2] = "八岐怪毒・"..str
		else
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .."八岐怪毒・"..str
		end
	end	
	if wugong == 9 and WAR.LSQ[eid] ~= nil and WAR.FXDS[eid] ~= nil and WAR.FXDS[eid] >= 50 and JLSD(10,40,eid) then
		if wglw1(pid,9) or (wglw1(pid,9) or (DT(pid,61) and JX(pid))) then
			for i = 3185, 3200 do
				CurIDTXDH(WAR.CurID, i, i, "八岐天灾 毒化天下");		--动画显示	
				lib.Delay(10)
			end
		end	
		local cc = JY.Person[eid]["中毒程度"] or 0
		local a = math.random(3)
		local str = ""
		AddPersonAttrib(eid,"生命",-cc)
		WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"]or 0) + AddPersonAttrib(eid,"生命",-cc)
		AddPersonAttrib(eid,"内力",-(cc*10))
		WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"]or 0) + AddPersonAttrib(eid,"内力",-(cc*10))
		WAR.LSQ[eid] = nil
		for j = 0, WAR.PersonNum-1 do 
			local df = WAR.Person[j]["人物编号"] 
			local offset1 = math.abs(WAR.Person[emenyid]["坐标X"] - WAR.Person[j]["坐标X"]) 
            local offset2 = math.abs(WAR.Person[emenyid]["坐标Y"] - WAR.Person[j]["坐标Y"])	
			if WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] and WAR.Person[j]["死亡"] == false and offset1 <= 8 and offset2 <= 8 then
			   if a == 1 then 
               WAR.LSZD[df] = 1
			   str = "毒血漂橹"
			   elseif a == 2 then 
			   WAR.LSZD2[df] = 1
			   str = "毒惑心智"
			   elseif a == 3 then
			   WAR.LSZD1[df] = 10
			   str = "毒化本源"
			   end
			end
        end
		if WAR.Person[emenyid][CC.TXWZ3] == nil then
			WAR.Person[emenyid][CC.TXWZ3] = "八岐乱世・"..str
		else
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .."八岐乱世・"..str
		end 
	end
	--灵蛇拳法领悟结束
	if (wglw1(pid,77) or ((DT(pid,605) or (DT(pid,627)))and JX(pid))) and DWPD() then
		if WAR.JWYX == 1 then
			WAR.NBH[eid] = 1
		elseif WAR.JWYX == 2 then
			WAR.NHH[eid] = 1
		end	
	end	
	if WAR.NBH[pid] ~= nil then
		WAR.ICE[pid] = (WAR.ICE[pid]or 0) + 10
		local aa = WAR.ICE[pid]or 0
		--AddPersonAttrib(pid,"生命",-aa)
		WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"]or 0) + AddPersonAttrib(pid,"生命",-aa)
		--AddPersonAttrib(pid,"内力",-aa)
		WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"]or 0) + AddPersonAttrib(pid,"内力",-(aa*3))
	end	
	if WAR.NHH[pid] ~= nil then
		WAR.HOT[pid] = (WAR.HOT[pid]or 0) + 10
		local aa = WAR.HOT[pid]or 0
		--AddPersonAttrib(pid,"生命",-aa)
		WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"]or 0) + AddPersonAttrib(pid,"生命",-aa)
		--AddPersonAttrib(pid,"内力",-aa)
		WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"]or 0) + AddPersonAttrib(pid,"内力",-(aa*3))
	end
	if WAR.LXZS[pid] ~= nil then
		WAR.LXZT[pid] = (WAR.LXZT[pid]or 0) + 10
		local aa = WAR.LXZT[pid]or 0
		--AddPersonAttrib(pid,"生命",-aa)
		WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"]or 0) + AddPersonAttrib(pid,"生命",-aa)
		--AddPersonAttrib(pid,"内力",-aa)
		WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"]or 0) + AddPersonAttrib(pid,"内力",-(aa*3))
	end
	--风刀雷剑
	if WAR.FDLJ > 0 then
		local aa = math.modf((sixi(pid,2)+sixi(pid,3))/2)
		if wugong == 137 then
			hurt = hurt + aa + sixi(pid,2)
		elseif wugong == 55 then
			hurt = hurt + aa + sixi(pid,3)
		end
		if (wglw1(pid,77) or ((DT(pid,605) or (DT(pid,627)))and JX(pid)))then
			if WAR.FDLJ2[eid] == nil then
				WAR.FDLJ2[eid] = 30
			end
		else	
			if WAR.FDLJ1[eid] == nil then
				WAR.FDLJ1[eid] = 30
			end	
		end	
		if (wglw1(pid,77) or ((DT(pid,605) or (DT(pid,627)))and JX(pid))) then
			if WAR.Person[emenyid].TimeAdd < 30 then
				WAR.MABI[eid] = (WAR.MABI[eid] or 0) + 15
			end	
		end
	end
	
	--白驼兵器专精
	if (JY.Person[eid]["武器"] == 246 and wugong == 9) or (JY.Person[eid]["武器"] == 252 and wugong == 120) then
		if MPPD(eid) == 8 and JLSD(10,40,eid) then
			WAR.BTSP[eid] = (WAR.BTSP[eid] or 0) +1 
		end
		if MPPD(eid) == 8 and JLSD(10,40,eid) and JY.Person[eid]["武器"] == 246 and yongquan(wugong) then
			WAR.CYSH[eid] = 20
		end	
	end	
	if (JY.Person[eid]["武器"] == 246) or (JY.Person[eid]["武器"] == 252) then
		if MPPD(eid) == 8 and JLSD(10,40,eid) then
			WAR.BTSP[pid] = (WAR.BTSP[pid] or 0) +1 
		end
	end	
	--白驼门派专精
	if MPPD(pid) == 8 and (yongquan(wugong) or yongte(wugong)) then
		WAR.BTSP[eid] = (WAR.BTSP[eid] or 0) + math.random(2)
		if JLSD(10,40,pid) and (wugong == 9 or wugong == 120) then
			WAR.BTSP[eid] = (WAR.BTSP[eid] or 0) + (2*math.random(2))
		end	
		if WAR.BTSP[eid] ~= nil then
			local sn = WAR.BTSP[eid] or 0
			WAR.Person[WAR.CurID]["真伤点数"]=WAR.Person[WAR.CurID]["真伤点数"] or 0 +AddPersonAttrib(eid, "生命", (sn*5))
		    WAR.Person[WAR.CurID]["内力点数"]=WAR.Person[WAR.CurID]["内力点数"] or 0 +AddPersonAttrib(eid, "内力", (sn*10))
			if WAR.BTSP[eid] > 25 then
				if wugong == 120 and WAR.ACT == 1 then
					DHdisplay(745,769,"凶蛇天破",M_PaleGreen)
					local aa = math.modf((WAR.BTSP[eid]+sixi(pid,4)+sixi(eid,4)+sixi(pid,5)+sixi(eid,5))/5)
					if aa > 300 then aa = 300 end
					WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid,"生命", -aa)
					for i = 0, WAR.PersonNum - 1 do 
						if WAR.Person[i]["我方"] == false and WAR.Person[i]["死亡"] == false and i ~= WAR.CurID then
							local tmppid = WAR.Person[i]["人物编号"]
							WAR.RJZQ[tmppid] = 20
						end
					end
					WAR.BTSP[eid] = 0
				elseif wugong == 9 and WAR.ACT == 1 then
					DHdisplay(745,769,"狂蛇天威",M_PaleGreen)
					WAR.KSTW = 1
					for i = 0, WAR.PersonNum - 1 do 
						if WAR.Person[i]["我方"] == false and WAR.Person[i]["死亡"] == false and i ~= WAR.CurID then
							local tmppid = WAR.Person[i]["人物编号"]
							WAR.Person[i].Time = WAR.Person[i].Time - 150
							WAR.SPIRIT[tmppid] = (WAR.SPIRIT[tmppid] or 0) - 10
						end
					end
					WAR.BTSP[eid] = 0
				end	
			elseif 	WAR.BTSP[eid] > 15 and math.random(10) > 7 then
				WAR.XZZ = 1
				if wugong == 120 then
					local bb = WAR.BTSP[eid] or 0
					WAR.YQWR1[eid] = (WAR.YQWR1[eid] or 0) + math.modf(bb/2)
					WAR.YQWR2[eid] = (WAR.YQWR2[eid] or 0) + math.modf(bb/2)
					WAR.L_NOT_MOVE[eid] = 1
					if WAR.Person[emenyid][CC.TXWZ1] == nil then
						WAR.Person[emenyid][CC.TXWZ1] = "阴阳双蛇"
					else
						WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" .."阴阳双蛇"
					end
					WAR.BTSP[eid] = 0
				elseif 	wugong == 9 then
					local cc = (WAR.BTSP[eid] or 0)
					WAR.L_NOT_MOVE[eid] = 1
					WAR.BTSP1[eid] = cc + 1
					WAR.BTSP2[eid] = 15
					if WAR.Person[emenyid][CC.TXWZ1] == nil then
						WAR.Person[emenyid][CC.TXWZ1] = "怪蟒缠绕"
					else
						WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" .."怪蟒缠绕"
					end
					WAR.BTSP[eid] = 0
				end
			elseif WAR.BTSP[eid] > 5 and math.random(10) > 5 then
				dng = dng - math.modf(100*(WAR.BTSP[eid] or 0))
				if wugong == 120 or wugong == 9 then
					WAR.BTSP[eid] = (WAR.BTSP[eid] or 0) - 0
				else
					WAR.BTSP[eid] = (WAR.BTSP[eid] or 0) - 1
				end
				if WAR.Person[emenyid][CC.TXWZ3] == nil then
					WAR.Person[emenyid][CC.TXWZ3] = "地蛟翻腾"
				else
					WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .."地蛟翻腾"
				end
			end
		end
	end
	
	if wglw1(pid,63) and WAR.XQFJ[eid] ~= nil and WAR.XQFJ[eid] > 30 and JLSD(10,40,eid) then --血脉咒杀
		local aa = math.modf((WAR.LXZT[eid]or 0)+(WAR.XQFJ[eid]*3))
		AddPersonAttrib(eid,"生命",-aa)
	end	
	--金蛇剑领悟
	if (wglw1(pid,40) or (DT(pid,91)and JX(pid)) or DT(pid,54) or DT(pid,630)) and dng > 0 then
		WAR.JSJZ = 1
	end
	if (wglw1(pid,40) or (DT(pid,91)and JX(pid)) or DT(pid,54) or DT(pid,630)) and wugong == 173 then
		if math.random(10) > 7 then
			WAR.KHCM[eid] = 1
		end
		if JLSD(10,45,pid) then
			WAR.L_WNGZL[eid] = (WAR.L_WNGZL[eid] or 0) + 20
			WAR.POISON[eid] = (WAR.POISON[eid] or 0) + 20
		end
	end			
	if (wglw1(pid,40) or (DT(pid,91)and JX(pid)) or DT(pid,54) or DT(pid,630)) and wugong == 40 and JLSD(10,50,pid) then
		DIYdisplay("金蛇剑法・金血蛇光",M_Red)
		for j = 0, WAR.PersonNum-1 do 
			local df = WAR.Person[j]["人物编号"] 
			local offset1 = math.abs(WAR.Person[WAR.CurID]["坐标X"] - WAR.Person[j]["坐标X"]) 
            local offset2 = math.abs(WAR.Person[WAR.CurID]["坐标Y"] - WAR.Person[j]["坐标Y"])	
			if WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[j]["死亡"] == false and offset1 <= 6 and offset2 <= 6 then
			   if WAR.JSXD[df] == nil then 
				WAR.JSXD[df] = 1
			   end
			end
        end
	end
	--杨家枪领悟
	if (wglw1(pid,68) and wugong == 68) or (T9ZY(pid) and wugong == 112 and wglw1(pid,68)) then
		local str = ""
		if JLSD(10,40,pid) then
			local aa = WAR.HOT[pid] or 0
			WAR.FXXS[eid] = 1
			WAR.FXDS[eid] = (WAR.FXDS[eid] or 0) + math.modf(aa/3)
			WAR.YQLYQY[eid] = 1
		end
		if WAR.FXDS[eid] ~= nil and WAR.HOT[eid] ~= nil and JLSD(10,60,pid) then
			if WAR.FXDS[eid] >= WAR.HOT[eid] then
				WAR.Person[emenyid].Time = WAR.Person[emenyid].Time - math.modf((WAR.FXDS[eid] or 0)*3)
				if WAR.Person[emenyid].Time > 0 then
					dng = dng/2
				end
				str = "二十针・燃炎封络"
			else
				local bb = math.random(3)
				WAR.HOT[eid] = (WAR.HOT[eid] or 0 ) - 5*bb
				AddPersonAttrib(eid,"受伤程度",5*bb)
				str = "二十针・烈火燃心"
			end
			if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
				WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .."+".."燎原百击・"..str
			else
				WAR.Person[emenyid][CC.TXWZ3] = "燎原百击・"..str
			end
		end 
	end
	
	if (wglw1(pid,68) and wugong == 68) or (T9ZY(pid) and wugong == 112 and wglw1(pid,68)) then 
		if WAR.YQLW == 1 then
			WAR.SPIRIT[pid] = (WAR.SPIRIT[pid] or 0 ) + 2
		end
		if WAR.YQLW == 2 then
			WAR.SPIRIT[eid] = (WAR.SPIRIT[eid] or 0 ) - 2
			if WAR.SPIRIT[eid] < 90 then
				WAR.CYSH[eid] = 10
			end
		end	
		if WAR.YQLW == 3 then
			local aa = math.modf(JY.Person[pid]["内力"]/JY.Person[pid]["内力最大值"])
			if aa > 0.25 then aa = 0.25 end
			hurt = hurt + math.modf(JY.Person[pid]["内力"]*aa)
		end
		if WAR.YQLW1 == 1 and JLSD(10,60,pid) then
			WAR.BZ[eid] = 1
		end
		if 	WAR.YQLW1 == 3 then
			WAR.ATKDOWN[eid] = (WAR.ATKDOWN[eid] or 0) + 25
		end	
	end
	--辟邪剑法特效
	if wugong == 48 and WAR.BXJF > 0 then
		if WAR.BXJF == 1 then
			WAR.Person[WAR.CurID]["体力点数"] = (WAR.Person[WAR.CurID]["体力点数"] or 0) + AddPersonAttrib(pid, "体力", 10)
			if WAR.LXZT[eid] ~= nil then
				WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", WAR.LXZT[eid])
				if WAR.LXZT[eid] > 30 then
					WAR.LXZT[eid] = 100
				end
			end
		end
		if WAR.BXJF == 2 then
			local aa = 0
			WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", math.modf((JY.Person[pid]["内力最大值"] or 0) *0.05))
			for j = 0, WAR.PersonNum-1 do 
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"]  then
					aa = aa + 3
				end
				if aa > 25 then aa = 25 end
			end
			hurt = math.modf(hurt*((100+aa)/100))
			WAR.RJZQ[eid] = 15	
		end
		if WAR.BXJF == 3 then
			WAR.SPIRIT[pid] = (WAR.SPIRIT[pid] or 0) + 5
			WAR.SPIRIT[eid] = (WAR.SPIRIT[eid] or 0) - 5
			WAR.MENG[eid] = (WAR.MENG[eid] or 0) + 10
			local aa = math.modf((WAR.LQZ[eid] or 0)/20)
			WAR.LQZ[pid] = (WAR.LQZ[pid] or 0) + aa
			WAR.LQZ[eid] = 0
		end
		if WAR.BXJF == 4 then
			WAR.LYXJ[eid] = 1
			WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -(WAR.LQZ[pid] or 0))
			local bb = math.abs(WAR.Person[WAR.CurID].Time - WAR.Person[emenyid].Time)
			if WAR.LQZ[pid] ~= nil and WAR.LQZ[pid] >=100 then
				WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -bb)
			end	
		end
		if WAR.BXJF == 5 then
			WAR.L_NOT_MOVE[eid] = 1
			WAR.SZWH[eid] = (WAR.SZWH[eid] or 0) + 10
			WAR.QFY1[pid] = (WAR.QFY1[pid] or 0) + 20
		end	
	end	
	if WAR.BXJF1 == 1 then
		local aa = math.modf((WAR.LXZT[eid] or 0)*1.5)
		WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -aa)
		if WAR.LQZ[pid] ~= nil and WAR.LQZ[pid] >= 100 and WAR.ACT == 1 then
			WAR.Person[emenyid]["体力点数"] = (WAR.Person[emenyid]["体力点数"] or 0) + AddPersonAttrib(eid, "体力", -15)
		end
	end	
		
	--杀戮魅影
	if KHTJF(eid) and JY.Person[eid]["生命"] <= 500 and JLSD(10,40,eid) then --秘剑演武・剑势
	    local str = ""
	    if WAR.JSJY[eid] == nil and WAR.JSJY[200+eid] == nil then --剑势剑影
			--local nydx = {}
			--local nynum = 1
			--for j = 0, WAR.PersonNum - 1 do
			--  if WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[j]["死亡"] == false then
			--    nydx[nynum] = j
			--    nynum = nynum + 1
			--  end
			--end
			--local nyft = nydx[math.random(nynum - 1)]
			local x, y = WE_xy(WAR.Person[emenyid]["坐标X"], WAR.Person[emenyid]["坐标Y"] - 1)
			local mid = 30000-eid;				--定义一个临时的戚长发数据
			JY.Person[mid] = {};
			for i=1, #PSX do
				JY.Person[mid][PSX[i]] = JY.Person[eid][PSX[i]]
			end
			JY.Person[mid]["姓名"] = JY.Person[eid]["姓名"]
			JY.Person[mid]["生命"] = JY.Person[eid]["生命"]
			JY.Person[mid]["无用12"] = eid
			JY.Person[mid]["无用14"] = JY.Person[eid]["无用14"]
			for o = 1,HHH_GAME_SETTING["WG_COUNT_MAX"] do
				JY.Person[mid]["武功"..o] = JY.Person[eid]["武功"..o]
				JY.Person[mid]["武功等级"..o] = JY.Person[eid]["武功等级"..o]
			end
			if WAR.Person[emenyid]["我方"] == true then 
				NewWARPersonZJ(mid, true, x, y, false, 1);
				WAR.DW[mid] = 1
			else
				NewWARPersonZJ(mid, false, x, y, false, 1);
				WAR.DW[mid] = 2
			end
			if eid == 0 and cxzj() > 0 then 
			   JY.Person[mid]["无用12"] = cxzj()
			end
			--WAR.Person[mid].Time = 999
			WAR.JSJY[eid] = mid
			WAR.JSJY[100+mid] = 20
			WAR.JSJY[200+mid] = eid
			WAR.JSJY[300+mid] = 1
			WAR.SPIRITMIN[mid] = 100
			str = "振影・杀戮魅影"
		end
		WAR.BXJFHQ = 1
		if WAR.Person[emenyid][CC.TXWZ3] ~= nil and str ~= "" then
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+"..str
		else
			WAR.Person[emenyid][CC.TXWZ3] = str
		end
	end
	
	if WAR.BXJF2 == 1 and wugong == 48 then
		local aa = math.modf(WAR.Person[WAR.CurID].TimeAdd*1.5)
		for cm = 0, WAR.PersonNum-1 do --该次攻击全屏刺目
			if WAR.Person[cm]["死亡"] == false and WAR.Person[cm]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				local cmid = WAR.Person[cm]["人物编号"]
				WAR.KHCM[cmid] = 1
			end
		end
		WAR.BHJFHQ = 1
		WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid,"生命",-aa)
	end
		
	if wglw1(eid,48) and JLSD(10,40,eid) then
		WAR.KHCM[pid] = 1
		WAR.BXJF4[eid] = 1
	end	
	if KHTJF(eid) and WAR.LQZ[eid] ~= nil and WAR.LQZ[eid] > 50 then
		local str = ""
		if JLSD(20,WAR.LQZ[eid],eid) then
			str = "焰解・紫气东来"
			WAR.ACT = 10
			WAR.BXJFHQ = 1
			WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -3000 )
			WAR.Person[emenyid]["体力点数"] = (WAR.Person[emenyid]["体力点数"] or 0) + AddPersonAttrib(eid, "体力", -15)
			for cm = 0, WAR.PersonNum-1 do --
				if WAR.Person[cm]["死亡"] == false and WAR.Person[cm]["我方"] == WAR.Person[WAR.CurID]["我方"] then
					local cmid = WAR.Person[cm]["人物编号"]
					WAR.Person[cm]["TimeAdd"] = WAR.Person[cm]["TimeAdd"] - 500
					WAR.CYSH[cmid] = 10
				end
			end
			if WAR.Person[emenyid][CC.TXWZ3] ~= nil and str ~= "" then
				WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+"..str
			else
				WAR.Person[emenyid][CC.TXWZ3] = str
			end
		end
	end	
	
	--天赋功体减伤
    if JY.Person[pid]["声望"] ~= 0 then
		local v = JY.Person[pid]["声望"]
		if PersonTFGT(pid, v) then 
		    if inteam(pid) then
		       hurt = math.modf(hurt * 1.2)
			else
			   hurt = math.modf(hurt * 1.4)
			end	 
		end
    end
		
    if eid == 0 and putong() == 5 and WAR.TIANGANG > 0 then --护体真罡减少
	    hurt = math.modf((hurt-WAR.SPIRIT[pid]) * (1 - (WAR.TIANGANG / 50)))
	    if hurt<=0 then
	        local aa=math.abs(math.modf(hurt*10))
	        AddPersonAttrib(eid, "内力", aa)
	        hurt=0
	    end
    end
		
    --豸苗：武功到极
	local wgdj = 0 
	for i = 1,HHH_GAME_SETTING["WG_COUNT_MAX"] do
	    if JY.Person[pid]["武功"..i] > 0 and JY.Person[pid]["武功等级"..i] >= 999 then
	        wgdj = wgdj + 1
	    end	
	end
	hurt = math.modf(hurt*(1+wgdj*0.04))

  	if MPPD(pid) == 11 then	--17-3-1
	    if WAR.ZMYJ == 1 or WAR.HQJK == 1 then 
	        hurt = math.modf(hurt * 1.5)
	    else
	        hurt = math.modf(hurt * 1.2)
	    end
	end
	
	if WAR.JSJY[200+pid] ~= nil then 
	    hurt = math.modf(hurt * 0.5)
	end
----从这里开始，伤害尽量集中在这里写	
    --暴击
    if WAR.BJ == 1 then
        local SLWX = 0
        for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
            if JY.Person[eid]["武功" .. i] == 106 or JY.Person[eid]["武功" .. i] == 107 then
                SLWX = SLWX + 1
            end
        end  
		if WAR.XSKJ[pid] ~= nil then
			WAR.BJ = 0
		end	
		if AN(eid) and not wglw(pid,153) then
			WAR.Person[emenyid][CC.TXDH] = 111
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "为伊故 乐所苦"
			else
				WAR.Person[emenyid][CC.TXWZ2] ="为伊故 乐所苦"
			end		
		elseif getHZ(eid, 23) and not wglw(pid,153) then
			WAR.Person[emenyid][CC.TXDH] = 6
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+金刚不坏"
			else
				WAR.Person[emenyid][CC.TXWZ2] = "金刚不坏"
			end	
		elseif (wglw(eid,151) or (DT(eid,615) and PersonKF(eid,151))) and not wglw(pid,153) then --豸苗：金刚不坏奥义
			WAR.Person[emenyid][CC.TXDH] = 6
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+金刚不坏"
			else
				WAR.Person[emenyid][CC.TXWZ2] = "金刚不坏"
			end			
		elseif SLWX == 2 and not wglw(pid,153) then --武骧金星：取消森罗万象的调和要求
			WAR.Person[emenyid][CC.TXDH] = 6
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. CC.WARS91    --森罗万象
			else
				WAR.Person[emenyid][CC.TXWZ2] = CC.WARS92
			end
		elseif hasTF(eid, 113) and not wglw(pid,153) then
			WAR.Person[emenyid][CC.TXDH] = 146
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+明心见性"
			else
				WAR.Person[emenyid][CC.TXWZ2] = "明心见性"
			end		
		elseif wglw1(eid,24) and JLSD(10,70,eid) and not wglw(pid,153) then 
			WAR.Person[emenyid][CC.TXDH] = 34
			if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
				WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+七佛灭罪・释迦牟尼"
			else
				WAR.Person[emenyid][CC.TXWZ3] = "七佛灭罪・释迦牟尼"
			end
		elseif DT(eid,665) or PersonGT(eid,184) and not wglw(pid,153) then 
			WAR.Person[emenyid][CC.TXDH] = 34
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+瑜伽防御"
			else
				WAR.Person[emenyid][CC.TXWZ2] = "瑜伽防御"
			end				
		elseif T2SQ(eid) and juexing() > 1 and not wglw(pid,153) then 
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+智强满道"
			else
				WAR.Person[emenyid][CC.TXWZ2] = "智强满道"
			end					
		else    
			local ratio = 1.5
			if extrabj(pid) > 0 then
				ratio = ratio + extrabj(pid)
			end
			if PersonGT(pid, 104) then
				ratio = ratio + 0.25
			end
			if wugong == 24 and (wglw1(pid,24) or DT(pid,615)) and JLSD(10,50,pid) then
				WAR.XMSSZ = 6
				WAR.DEFDOWN[eid] = 21
				ratio = ratio + 1
			end
			if MPPD(pid) == 6 then --逆运主功体，有九阴，暴击伤害追加50%
				local mpdj = MPDJ(pid)
				if PersonGT(pid, 103) then
					ratio = ratio * (1+mpdj * 0.15) --密教
				else
					ratio = ratio * (1+mpdj * 0.1)
				end
			end
			if wglw(pid,153) then
				local aa = math.random(2,4)
				ratio = ratio * aa
			end	
			hurt = hurt * ratio
			ang = ang * ratio
			if MPPD(pid) == 8 and wglw(pid,104) then --逆运主功体，有九阴，暴击伤害追加50%
				local SN=math.modf(JY.Person[eid]["受伤程度"]*2.5)
				AddPersonAttrib(eid, "生命", -SN)
				WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) -SN;
			end
			if wglw1(pid,68) then
				hurt = hurt + sixi(pid,4)
			end
		end
    end
  
    if (wglw(pid,178) or (DT(pid,69) and PersonKF(pid,178)) or T9ZY(pid) or DT(pid,602)) and WAR.KLYH == 1 then --九龙功
	    local ratio = 1.5
		hurt = math.modf(hurt * ratio)
		ang = math.modf(ang * ratio)
		if WAR.SLCS[200+pid] ~= nil and WAR.SLCS[200+pid] > 0 then 
		hurt = math.modf(hurt *(1+ WAR.SLCS[200+pid]))
		WAR.SLCS[200+pid] = nil
		end
	end
	
    if WAR.WYY[pid] ~= nil or WAR.ATKDOWN[pid] ~= nil then --攻击力下降
	    hurt = math.modf(hurt * 0.7)
	    ang = math.modf(ang * 0.7)
    end

    if wglw(pid,182) or (DT(pid,5) and PersonGT(pid,182)) and WAR.TJJS == 1 then --太极神功
		local ad = 2
		hurt = math.modf(hurt * ad)
		ang = math.modf(ang * ad)
		if WAR.TJSG[300 + pid] ~= nil and WAR.TJSG[300 + pid] > 0 then 
		    hurt = math.modf(hurt * (1 + WAR.TJSG[300 + pid]))
		    WAR.TJSG[300 + pid] = nil
		end
	end	
	
	if WAR.XSJS == 1 then --洗髓经
		local ad = 2
		hurt = math.modf(hurt * ad)
		ang = math.modf(ang * ad)
		if WAR.XSSG[200 + pid] ~= nil and WAR.XSSG[300 + pid] > 0 then 
		    hurt = math.modf(hurt * (1 + WAR.XSSG[300 + pid]))
		    WAR.XSSG[200 + pid] = nil
		end
	end		
	
   --刀剑合壁 
    if WAR.DJGZ >= 1 then
        hurt = math.modf(hurt * 1.2)
    end
  
    if WAR.XLEB >= 1 then
        hurt = math.modf(hurt * (1+0.2*(4-WAR.XLEB)))
	    if WAR.BJ==1 then
	        hurt = math.modf(hurt * 1.5)
	    end
    end
  
    if WAR.SHAOLIN2 == 1 then
        hurt = math.modf(hurt * 1.25)
	    WAR.FMZZ[eid]=WAR.FMZZ[eid] or 0+1
	    if WAR.BJ==1 then
	        hurt = math.modf(hurt * 1.5)
	    end
    end
	if wglw(pid,100) or (DT(pid,129) and PersonKF(pid,100)) then--豸苗：先天领悟
	    local a = math.modf(JY.Person[pid]["生命最大值"]*0.6)
	    if JY.Person[pid]["生命"] > a then
		   hurt = math.modf(hurt * 1.2) 
		end   
	end
	if pid == 0 and WAR.XTG == 1 and WAR.WCY2 == 1 then
	    hurt = math.modf(hurt * 1.3)
	end
	
	for i = 1, JY.WugongNum-1 do 
	    if pid == 0 and putong() == 5 and PersonTFGT(pid,i) then --天罡
	        hurt = math.modf(hurt*1.03)
	    end
	end
    if  WAR.TZ_XZ_SSH2[pid] ~=nil and WAR.SEVENSTAR[pid]~=nil then--沼跃鱼:生死轮回效果
        local aa=WAR.TZ_XZ_SSH2[pid]
	    local bb=WAR.SEVENSTAR[pid]
        hurt = math.modf(hurt * (1-aa*0.1))
	    local SN=math.modf(hurt*0.1*aa)	   
	    local aa=AddPersonAttrib(eid, "生命", SN)
	    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) +aa
	    local bb=AddPersonAttrib(eid, "内力", SN*10)
	    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) +bb
	    AddPersonAttrib(pid, "受伤程度", bb+aa)
	    WAR.TZ_XZ_SSH2[pid]=WAR.TZ_XZ_SSH2[pid] -1
	    if WAR.TZ_XZ_SSH2[pid]<=0 then
	        WAR.TZ_XZ_SSH2[pid]=nil
	    end
    end
  
    if WAR.TZ_XZ_SSH2[eid]~=nil and DWPD() then--沼跃鱼:生死轮回效果
        local aa= WAR.TZ_XZ_SSH2[eid]
	    hurt=math.modf(hurt*(1+0.1*aa))
	    local SN=math.modf(hurt*0.1*aa)
	    local bb=AddPersonAttrib(pid, "生命", SN)
	    WAR.Person[WAR.CurID]["真伤点数"] = WAR.Person[WAR.CurID]["真伤点数"] or 0 +bb
	    WAR.TZ_XZ_SSH2[eid]=WAR.TZ_XZ_SSH2[eid]+1
	    if WAR.TZ_XZ_SSH2[eid]>=6 then
	        WAR.TZ_XZ_SSH2[eid]=6
	    end
    end
	
    --魔音・碧海潮生12.26
	if (wglw(pid,6) or (PersonKF(pid,6) and DT(pid,57))) and WAR.BHZC1 == 1 then
	    hurt = math.modf(hurt*(1+ WAR.BHZC*0.2))
		WAR.BHZC1 = 0
		WAR.BHZC = 0
	end
    local ssym = 0
	local ssym1 = 0
    if jtyl(pid) then
	    local a = JY.Person[pid]["生命"]/JY.Person[pid]["生命最大值"]
	    local b = JY.Person[eid]["生命"]/JY.Person[eid]["生命最大值"]
	    if a >= b then
	        ssym = 1
	        ssym1 = a-b
	    else
	        ssym = 2
	        ssym1 = b-a
	    end
	end
  	if jtyl(pid) and (WAR.JTYL == 8 or WAR.JTYL == 9) and ssym == 1 and DWPD() and not jtyl(eid) then
	    hurt = math.modf((1+ssym1*2)*hurt)
	end 
	
    --灼烧状态伤害加深
    if (WAR.HOT[eid] or 0) >= 20 then
	    if wglw1(eid,176) or (DT(eid,117) and PersonKF(eid,176)) or DT(eid,116) then
		    hurt = math.modf(hurt * 0.8)
	    elseif WAR.ARJX > 0 then
  	        hurt = math.modf(hurt * 3)
	    elseif wugong == 141 and (DT(pid, 585) or wglw1(pid,141)) then --霹雳刀法灼烧状态伤害加深
  	        hurt = math.modf(hurt * 2.5)
	    elseif wugong == 45 and ((DT(pid, 592) or DT(pid, 607)) or wglw1(pid,45)) then --玄铁剑法烧伤状态伤害加深
            hurt = math.modf(hurt * 3)
	    elseif wugong == 86 and (DT(pid, 615) or wglw1(pid,86)) then --伏魔杖法烧伤状态伤害加深
            hurt = math.modf(hurt * 3)
	    elseif wugong == 23 and ((DT(pid, 8) or DT(pid, 167) or DT(pid, 168) or DT(pid, 603)) or wglw1(pid,23)) then --七伤拳灼烧状态伤害加深
	        hurt = math.modf(hurt * 1.5)
	    elseif wugong == 8 and ((DT(pid, 618) or DT(pid, 116)) or wglw1(pid,8)) then --天山六阳掌烧伤状态伤害加深
            hurt = math.modf(hurt * 3)
	    elseif wugong == 66 and ((DT(pid, 103) or DT(pid, 595)) or wglw1(pid,66)) then --火焰刀烧伤状态伤害加深
	        hurt = math.modf(hurt * 2.5)
        elseif wugong == 176 and ((DT(pid, 618) or DT(pid, 117)) or wglw1(pid,86)) then	--生死符烧伤状态伤害加深
            hurt = math.modf(hurt * 2.5)
	    elseif wugong == 17 and ((DT(pid, 65) or DT(pid, 602)) or wglw1(pid,17)) then -- 一阳指烧伤状态伤害加深
	        hurt = math.modf(hurt * 2)
		elseif wugong == 11 and (DT(pid, 599) or wglw1(pid,11)) then --摧坚神爪烧伤状态伤害加深
            hurt = math.modf(hurt * 2)	
		elseif wugong == 175 and wglw1(pid,175) then --霹雳火雷烧伤状态伤害加深
            hurt = math.modf(hurt * 3)	
		elseif wugong == 133 and (DT(pid, 113) or wglw1(pid,133)) then --参合指烧伤状态伤害加深
		    hurt = math.modf(hurt * 2.5)	
		elseif wugong == 39 and (DT(pid, 129) or wglw1(pid,39)) then --全真剑法烧伤状态加深
		    hurt = math.modf(hurt * 1.5)	
		elseif WAR.XLGJ == 2 or WAR.XLGJ == 4 or WAR.XLGJ == 5 then --降龙柔劲烧伤状态加深
		    hurt = math.modf(hurt * 1.3)	
		elseif MPPD(pid) == 18 and MPDJ(pid) >= 2 and PersonGT(189) then 	--崆峒高级弟子
		    hurt = math.modf(hurt * 1.5)
		elseif wugong == 62 and (DT(pid,189) or wglw1(pid,62)) then --夫妻刀法烧伤状态加深
		    hurt = math.modf(hurt * 1.2)		
		elseif WAR.JWDF > 0 then --金乌刀法
		    hurt = math.modf(hurt * 2)	
		elseif WAR.SZZX == 2 then --
		    hurt = math.modf(hurt * 2)		
		elseif WAR.FXHJ3 == 1 then
		    hurt = math.modf(hurt * 4)
		elseif WAR.XYHQ == 1 then
		    hurt = math.modf(hurt * 3)	
		elseif wugong == 13 and wglw1(pid,13) then -- 铁掌领悟灼烧状态伤害加深
			hurt = math.modf(hurt * 2)
		elseif (wglw1(pid,68) and wugong == 68) or (T9ZY(pid) and wugong == 112 and wglw1(pid,68)) then
			if (WAR.HOT[pid] or 0) >= 20 then
				hurt = math.modf(hurt * 4)
			else	
				hurt = math.modf(hurt * 2)
			end
		else
			hurt = math.modf(hurt * 1.2)
			if hasTF(eid, 51) and DWPD() then
				hurt = math.modf(hurt * 1.5)
			end
		end
    else		
	    if WAR.ARJX > 0 then
  	        hurt = math.modf(hurt * 2)
	    end
        if wugong == 141 and (DT(pid, 585) or wglw1(pid,141)) then
  	        hurt = math.modf(hurt * 2)
        end 
        if wugong == 176 and (DT(pid, 117) or (wglw1(pid,176) or (DT(pid,59) and PersonKF(pid,176)) or DT(pid,116) or DT(pid,618))) then	
            hurt = math.modf(hurt * 2)
        end  
	    if wugong == 8 and ((DT(pid, 618) or DT(pid, 116)) or wglw1(pid,8)) then
  	        hurt = math.modf(hurt * 2)
        end 
		if (wglw1(pid,68) and wugong == 68) or (T9ZY(pid) and wugong == 112 and wglw1(pid,68)) then
			if (WAR.HOT[pid] or 0) >= 20 then
				hurt = math.modf(hurt * 4)
			else	
				hurt = math.modf(hurt * 3)
			end
		end	
    end

    --冰封状态伤害加深
    if (WAR.ICE[eid] or 0) >= 20 then--冰封状态伤害加深
        if wugong == 133 and (DT(pid, 113) or wglw1(pid,133)) then --参合指冰封状态伤害加深
		    hurt = math.modf(hurt * 2.5)	
		end	
		if wugong == 42 and ((DT(pid, 601) or DT(pid, 59)) or wglw1(pid,42)) then  --玉女剑法冰封状态伤害加深
			hurt = math.modf(hurt * 3)
		end	
		if wugong == 26 and (DT(pid,49) or DT(pid,617)) then --虚竹降龙掌冰封状态加伤
			hurt = math.modf(hurt * 1.5)
		end	
		if wugong == 19 and (DT(pid, 18) or wglw1(pid,19)) then --幻阴指冰封状态伤害加深
			hurt = math.modf(hurt * 1.3)
		end 	
		if WAR.XLGJ == 2 or WAR.XLGJ == 4 or WAR.XLGJ == 5 then --降龙柔劲冰封状态加深
			hurt = math.modf(hurt * 1.3)
		end 	
		if MPPD(pid) == 18 and MPDJ(pid) >= 2 and PersonGT(pid,189) then --崆峒高级弟子
			hurt = math.modf(hurt * 1.5)
		end	
		if WAR.FXHJ3 == 1 then
			hurt = math.modf(hurt * 2)
		end
		if wugong == 170 and wglw1(pid,170) then
			hurt = math.modf(hurt * 1.8)
		end
		if WAR.XYBQ == 1 then
			hurt = math.modf(hurt * 4)
		end 	
		if WAR.SZZX == 2 then --
		    hurt = math.modf(hurt * 2)
			WAR.SZZX = 0
		end	
		if wugong == 62 and (DT(pid,189) or wglw1(pid,62)) then  --夫妻刀法
			hurt = math.modf(hurt * 1.2) 
		end 	
	else
	    hurt = math.modf(hurt * 1.2)
	    if hasTF(eid, 51) and DWPD() then
		    hurt = math.modf(hurt * 1.5)
	    end
	end

    if wugong == 176 and (DT(pid, 111) or wglw1(pid,176)) or DT(pid,618) and WAR.ICE[eid] ~= nil then
  	    hurt = math.modf(hurt * 3)
	    ang = math.modf(ang * 1.5) 
    end  

    if wugong == 66 and ((DT(pid, 103) or DT(pid, 595)) or wglw1(pid,66)) then
        hurt = math.modf(hurt * 1.5)
    end	
  
    if wugong == 17 and ((DT(pid, 65) or DT(pid, 602)) or wglw1(pid,17)) then
	    hurt = math.modf(hurt * 2)
	end 

    if WAR.DEFDOWN[eid] ~= nil then --防御力下降
 	    hurt = math.modf(hurt * 1.3)
	    ang = math.modf(ang * 1.3) 
    end
  
    --受内伤，攻击伤害减少
    if inteam(pid) then
        hurt = math.modf(hurt * (1 - JY.Person[pid]["受伤程度"] * 0.0025))
    else
	    hurt = math.modf(hurt * (1 - JY.Person[pid]["受伤程度"] * 0.002))
    end
  
    --内伤，被攻击伤害提高
    if inteam(eid) then
	    hurt = math.modf(hurt * (1 + JY.Person[eid]["受伤程度"] * 0.0025))
    else
        hurt = math.modf(hurt * (1 + JY.Person[eid]["受伤程度"] * 0.002))
    end
  
    if hasTF(pid, 47) then
	    hurt = math.modf(hurt * (1 + JY.Person[pid]["受伤程度"] * 0.0075))
    end
  
    if WAR.Person[WAR.CurID]["我方"] then --连锁加伤害和杀气--17-2-10
	    if DWPD() and WAR.MYCHAIN > 1 then
		    hurt = math.modf(hurt * (1 + (WAR.MYCHAIN / 100)))
		    ang = math.modf(ang * (1 + (WAR.MYCHAIN / 100)))
	    end
    else
 	    if DWPD() and WAR.URCHAIN > 1 then
		    hurt = math.modf(hurt * (1 + (WAR.URCHAIN / 100)))
		    ang = math.modf(ang * (1 + (WAR.URCHAIN / 100)))
        end 
    end 
  
	--距离伤害计算
	if inteam(pid) then
		local offset = math.abs(WAR.Person[WAR.CurID]["坐标X"] - WAR.Person[emenyid]["坐标X"]) + math.abs(WAR.Person[WAR.CurID]["坐标Y"] - WAR.Person[emenyid]["坐标Y"])
		if T12YMZ(pid) then 
			hurt = hurt * 1.3
		elseif wglw1(pid,155) and yongquan(wugong) or DT(pid,665) then 
			hurt = hurt * 1.3
			ang = ang * 1.3
		elseif T8LXY(pid) and WAR.LXYYJ>0 then----沼跃鱼：李逍遥御剑术无视距离
		    hurt = hurt * 1.3
		elseif hasTF(pid, 26) then
			if offset > 10 then offset = 10 end
			hurt = hurt * (1 + (0.03 * offset))	
		elseif MPPD(pid) == 9 and WAR.TMMS[pid] == 1 and (DT(pid, 93) or yongan(wugong)) then --唐门模式
		    hurt = hurt * (1 + (0.05 * offset))	
		elseif WAR.XLGJ > 0 then
		    hurt = hurt * (1 + (0.05 * offset))	
		elseif wugong == 148 and (DT(pid, 55) or wglw1(pid,148)) then	
		    hurt = hurt * (1 + (0.05 * offset))
		elseif wugong == 18 and (DT(pid, 57) or wglw1(pid, 18)) then
		    hurt = hurt * (1 + (0.05 * offset))	
		elseif wugong == 13 and wglw1(pid,13) and WAR.CYANGZ == 3 then	
		    hurt = hurt * (3 + (0.05 * offset))	
		elseif WAR.LMSJ > 0 then
		    hurt = hurt * (1 + (0.05 * offset))	
		elseif wugong==24 or wugong==132 then----
		    hurt = hurt * 1.1
			ang = ang * 1.1
		else
			if offset < 10 then
				hurt = (hurt) * (100 - (offset - 1) * 3) / 100		
			else
				hurt = hurt * 2 / 3
			end
		end
	else
		local offset = math.abs(WAR.Person[WAR.CurID]["坐标X"] - WAR.Person[emenyid]["坐标X"]) + math.abs(WAR.Person[WAR.CurID]["坐标Y"] - WAR.Person[emenyid]["坐标Y"])
		if hasTF(pid, 26) then
			if offset > 15 then offset = 15 end
			hurt = hurt * (1 + (0.03 * offset))		
		elseif MPPD(pid) == 9 and WAR.TMMS[pid] == 1 and (DT(pid, 93) or yongan(wugong)) then --唐门模式
		    hurt = hurt * (1 + (0.05 * offset))	
		elseif wugong==24 then----
		    hurt = hurt * 1.1
			ang = ang * 1.1
			if (DT(pid,615) or wglw1(pid,24)) then
			hurt = hurt * (1 + (0.1 * offset))
			ang = ang * 1.5
			end
		elseif wugong==132 then----
		    hurt = hurt * 1.1
			ang = ang * 1.1		
		elseif wugong == 18 and	(DT(pid,57) or wglw1(pid,18)) then
		    hurt = hurt * 1.5
			ang = ang * 1.2
		end		
	end
	hurt = math.modf(hurt)
    -------------------------------系数加成
    local defadd = 0

    if WGLX == 1 then
        defadd = sixi(eid, 1)
    elseif WGLX == 2 or DT(eid, 614) or wglw(eid,89) or (PersonKF(eid,89) and DT(eid,19)) then --武骧金星：阿青用剑系进行计算--紫霞剑系
        defadd = sixi(eid, 2)
    elseif WGLX == 3 then
        defadd = sixi(eid, 3)
    elseif WGLX == 4 then
        defadd = sixi(eid, 4)
    elseif WGLX == 6 then
        defadd = sixi(eid, 5)
    end
  
  	local atkadd=0;

	if WGLX==1 then
		atkadd = sixi(pid, 1)
	elseif WGLX==2 or DT(pid, 614) then --武骧金星：阿青用剑系进行计算
		atkadd = sixi(pid, 2)
	elseif WGLX==3 then
		atkadd = sixi(pid, 3)
	elseif WGLX==4 then
		atkadd = sixi(pid, 4)
    elseif WGLX == 6 then
        atkadd = sixi(pid, 5)
	end
		
	if not inteam(pid) then
		if atkadd<50 then 
			atkadd=50
		elseif atkadd<100 then
			atkadd=100		
		elseif atkadd<150 then	
			atkadd=150
		end
	end
	
	if not inteam(eid) then --修改兵器值最小值
	--	if defadd<50 then defadd=50 end
	--else
		if defadd<50 then 
			defadd=50 
		elseif defadd<100 then
			defadd=100
		elseif defadd<150 then
			defadd=150
		end
	end	
	
	if yongnei(wugong) or wugong==49 then  --内功计算 六脉也是内功
		atkadd=getnl(pid)
		defadd=getnl(eid)
		local tmpnum
		if atkadd>defadd then 
			tmpnum=15000
		else	
			--tmpnum=10000
			tmpnum=15000
		end
		if wglw(pid,592) then 
		    atkadd = sixi(pid, 2)*40
		end
		if wglw(eid,592) then 
		    defadd = sixi(eid, 2)*40
		end
		if DT(pid,592) then 
		    atkadd= 20000
		end
		if DT(eid,592) then 
		    defadd= 20000
		end
		local a = 0.5
		local b = 1.5
		local a1 = -50
		local b1 = 50
        if txjid(pid) then 
		    atkadd = atkadd*2
		    defadd = 0
		    tmpnum=7500
		    a = 0.75
		    b = 1.75
		    a1 = -25
		    b1 = 75
        end
        if txjid(eid) then 
		   atkadd = 0
		   defadd = defadd*2
		   tmpnum=7500
		   a = 0.25
		   b = 1.25
		   a1 = -75
		   b1 = 25
        end
		hurt=math.modf(hurt*limitX(1-((defadd-atkadd)/tmpnum),a,b));
		local str = "伤害增加"
		local aa = limitX(math.modf((atkadd-defadd)/tmpnum*100),a1,b1)
		if aa < 0 then 
		    aa = - aa 
		end
		if atkadd < defadd then 
		    str = "伤害减少"
		end
		WAR.Person[emenyid][CC.TXWZ0] = str..aa.."％"
	else
	    if DT(pid,592) then 
		    atkadd = 20000
		end
		if wglw(pid,592) then 
		   atkadd = sixi(pid, 2)*2
		end
		if wglw(eid,592) then 
		   defadd = sixi(eid, 2)*2
		end
	    if DT(eid,592) then 
		    defadd = 20000
		end	
		if MPPD(pid) == 7 then
			atkadd = 9999
		end
		if MPPD(eid) == 7 then
			defadd = 9999
		end
		if hasTF(pid, 46) then
			atkadd = 9999
		end
		if hasTF(eid, 46) then
			defadd = 9999
		end
		if wglw(pid,153) and WAR.BJ == 1 then
			atkadd = 9999
		end
		if wglw(eid,153) and WAR.BJ == 1 then
			defadd = 9999
		end	
		if wugong == 37 and (wglw1(pid,60) or DT(pid,166)) then
			defadd = sixi(eid, 2)*0.5
		end
		if wugong == 60 and (wglw1(pid,60) or DT(pid,166)) then
			defadd = sixi(eid, 3)*0.5
		end
		local tmpnum
		if atkadd>defadd then 
			tmpnum=600
		else	
			--tmpnum=240
			tmpnum=600
		end
		local a = 0.5
		local b = 1.5
		local a1 = -50
		local b1 = 50
        if txjid(pid) then 
		   atkadd = sixi(pid, 2)*2
		   defadd = 0
		   tmpnum=300
		   a = 0.75
		   b = 1.75
		   a1 = -25
		   b1 = 75
        end
        if txjid(eid) then 
		   atkadd = 0
		   defadd = sixi(eid, 2)*2
		   tmpnum=300
		   a = 0.25
		   b = 1.25
		   a1 = -75
		   b1 = 25
        end
		hurt=math.modf(hurt*limitX(1-((defadd-atkadd)/tmpnum),a,b));
		local str = "伤害增加"
		local aa = limitX(math.modf((atkadd-defadd)/tmpnum*100),a1,b1)
		if aa < 0 then 
		    aa = - aa 
		end
		if atkadd < defadd then 
		str = "伤害减少"
		end
		WAR.Person[emenyid][CC.TXWZ0] = str..aa.."％"
	end
	--系数加成计算结束
	if MPPD(pid) == 6 and WAR.LXFM == 1 then
		local nlmod = JY.Person[pid]["内力"]/5000 --改弱了一点
		local wgmod = JY.Wugong[wugong]["消耗内力点数"]/200
		if WAR.WSDL[pid] ~= nil and WAR.WSDL[pid] > 0 then
			wgmod = wgmod * math.modf(1+(WAR.WSDL[pid]/20))
		end	
		local totalmod = 1 + nlmod * wgmod;
	    ang = math.modf(ang * totalmod)
		hurt = math.modf(hurt * totalmod)
	end
    
	--捞月 辟邪
	if wugong == 48 and WAR.BXJF > 0 then
		local aa = WAR.LXZT[eid] or 0
		local bb = WAR.SPIRIT[pid] or 0
		hurt = hurt + math.modf((hurt + aa) * math.modf((bb-100)*2/15))
	end	
	--豸苗：龙象
	if (PersonGT(pid, 103) and ((DT(pid, 62) or DT(pid, 594)))) or (DT(pid, 618) and PersonKF(pid, 98)) or (DT(pid, 662) and PersonKF(pid, 103)) or wglw(pid,103) then
	    hurt = math.modf(hurt*(1+WAR.LXBL*0.05))
	end
	--六脉神剑
	if WAR.LMSJ > 0 then 
	    hurt =math.modf(hurt*4)
	end 	
	--降龙刚劲
	if WAR.XLGJ == 1 or WAR.XLGJ == 4 or WAR.XLGJ == 5 then
	    hurt = math.modf(hurt*3)
	end
	--虚竹降龙掌
	if wugong == 26 and (DT(pid,49) or DT(pid,617)) then
		hurt = math.modf(hurt*2)
	end 	
	--白羽箭法
	if wugong == 148 and (DT(pid, 55) or wglw1(pid,148)) then
		hurt = math.modf(hurt*2)
	end 
	--金乌刀法
	if (wugong == 61 and wglw1(pid,61)) or (DT(pid, 38) and (wugong == 61 or wugong == 66 )) then
		hurt = math.modf(hurt*2)
	end 	
	if (DT(pid, 50) or wglw1(pid, 26)) and hurt < 300 then --降龙领伤害小于250，实际伤害乘以3
        hurt = hurt * 3 
	end	
	if (DT(pid, 5) or wglw1(pid, 16)) and hurt < 250 then --太极拳领伤害小于250，实际伤害乘以5
        hurt = hurt * 5 
	end	
	if DT(pid, 600) and hurt > 100 then
	    hurt = hurt * 10
	end
	if wugong == 17 and ((DT(pid, 65) or DT(pid, 602)) or wglw1(pid,17)) then 
	    hurt = math.modf(hurt*1.5)
	end
	if wugong == 176 and (DT(pid, 117) or wglw1(pid,176)) or DT(pid,618) then
	    hurt = math.modf(hurt*1.5)
	end
	if wugong == 46 and ((DT(pid, 5) or DT(pid, 9) or DT(pid, 666)) or wglw1(pid,46)) then
	    hurt = math.modf(hurt*1.2)
	end
	if wugong == 47 and (DT(pid, 592) or wglw1(pid,47)) then
	    hurt = math.modf(hurt*1.5)
	end
	if wugong == 45 and (DT(pid, 592) or wglw1(pid,45)) then
	    hurt = math.modf(hurt*2)
	end
	if wugong == 8 and ((DT(pid, 618) or DT(pid, 116)) or wglw1(pid,8)) then
	    hurt = math.modf(hurt*2)
	end
	if wugong == 19 and (DT(pid, 18) or wglw1(pid,19)) then 
	    hurt = math.modf(hurt*1.3)
	end
	--灵蛇杖法领悟
	if wugong == 120 and (wglw1(pid,120) or DT(pid,60) or DT(pid,620)) then
		hurt = math.modf(hurt*2.2)
	end
	--灵蛇拳法领悟
	if wugong == 9 then
		if wglw1(pid,9) or (DT(pid,61) and JX(pid)) then
			hurt = math.modf(hurt*2)
		elseif DT(pid,61) then
			hurt = math.modf(hurt*1.5)
		end
	end	
	
	--佛刑禅那
	if yongdao and (JY.Person[pid]["武器"] == 365 or JY.Person[pid]["武器"] == 367) then
		local aa= JY.Person[pid]["品德"]
		hurt = hurt * math.modf(2+(aa/100))
	end
	--涤罪犀角
	if yongdao and (JY.Person[pid]["武器"] == 366 or JY.Person[pid]["武器"] == 367) then
		local xx= JY.Person[eid]["品德"]
		hurt = hurt * math.modf(2+(xx/100))
	end
	--侵略如火
	if WAR.FLHS3 == 1 then
		hurt = math.modf(hurt*2)
	end 	
	if hasTF(pid, 154) then 
		hurt = math.modf(hurt*2)
	end 
	--黯然伤害
	if WAR.ARJX == 1 or WAR.ARJX == 2 or WAR.ARJX == 3 or WAR.ARJX == 4 or WAR.ARJX == 5 then
	    hurt = math.modf(hurt*2)
	end
	--持瑶琴战意技伤害强化
	if WAR.TDSX > 0 then
	    hurt = math.modf(hurt*2)
	end
	--须弥山领悟伤害强化
	if WAR.XMSSZ == 1 and WAR.FMZZ[eid] ~= nil and WAR.FMZZ[eid] > 0 then
	    hurt = math.modf(hurt*2)
	end
	if WAR.XMSSZ == 2 and WAR.DLYZ[eid] ~= nil and WAR.DLYZ[eid] > 0 then
	    hurt = math.modf(hurt*2)
	end
	if WAR.XMSSZ == 3 and WAR.LHZF[eid] ~= nil and WAR.LHZF[eid] > 0 then
	    hurt = math.modf(hurt*2)
	end
	if WAR.XMSSZ == 4 and WAR.CHZ[eid] ~= nil and WAR.CHZ[eid] > 30 then
	    hurt = math.modf(hurt*2)
	end	
	if WAR.XMSSZ == 5 or WAR.XMSSZ == 6 then
	    hurt = math.modf(hurt*2)
	end
	if wugong == 67 and (wglw1(pid,67) or (DT(pid, 1) and JX(pid)) or (DT(pid, 621) and JX(pid))) and WAR.QLP ~= nil then
		if WAR.YLP[eid] ~= nil then
			hurt = math.modf(hurt*2)
		end
	end	
	if wugong == 13 and wglw1(pid,13) and JY.Person[eid]["内力性质"] == 0 then
		hurt = math.modf(hurt*3)
	elseif wugong == 13 and wglw1(pid,13) and JY.Person[eid]["内力性质"] == 2 then
		hurt = math.modf(hurt*2)
	end
	if wugong == 5 and wglw1(pid,5) and JY.Person[eid]["内力性质"] == 1 then
		hurt = math.modf(hurt*3)
	elseif wugong == 5 and wglw1(pid,5) and JY.Person[eid]["内力性质"] == 2 then
		hurt = math.modf(hurt*2)
	end
	if wglw(pid,181) or (PersonGT(pid, 181) and (DT(pid, 600))) then
		hurt = math.modf(hurt*5)
	end
	if PersonGT(pid,182) and WAR.Actup[pid] ~= nil then  --太极神功
		hurt = math.modf(hurt*1.5)
    end	
	if wglw(pid,188) or (DT(pid,48) and PersonGT(pid,188)) then --神足经
		hurt = math.modf(hurt*2)
	end 	
	if WAR.YJJS == 1 then
		hurt = math.modf(hurt*2)
	end	
	if wugong == 86 and ((DT(pid, 615) or DT(pid, 116)) or wglw1(pid, 86)) then
		hurt = math.modf(hurt*2.5)
	end	
	if wugong == 16 and (DT(pid, 5) or wglw1(pid, 16)) then
		hurt = math.modf(hurt*1.5)
	end	
	if wugong == 66 and ((DT(pid, 103) or DT(pid, 595)) or wglw1(pid,66)) then
		hurt = math.modf(hurt*2)
	end 	
	if wugong == 166 and (DT(pid, 12) or wglw1(pid,166)) then
	    hurt = math.modf(hurt * 1.5)
	end	
	if wugong == 18 and (DT(pid, 57) or wglw1(pid, 18)) then
		hurt = math.modf(hurt * 1.5)
	end	
	if NF(pid) and juexing() > 2 then
		hurt = math.modf(hurt*1.5)
	end	
	if MPPD(pid) == 9 and DWPD() and WAR.TMMS[pid] == 1 and (DT(pid, 93) or yongan(wugong)) then --唐门模式
	    if WAR.DPJ[pid] == 4 then 
	        hurt = math.modf(hurt*1.5)
		    if JY.Person[eid]["生命"] > math.modf(JY.Person[eid]["生命最大值"]*0.7) then 
		        hurt = math.modf(hurt*1.7)
		    end
	    end  
	end
	if WAR.QJBMS[pid] == 2 then --唐门模式千机变
	    hurt = math.modf(hurt*2.5)
	end
	if WAR.QJBMS[pid] == 3 then --唐门模式千机变
	    hurt = math.modf(hurt*0.7)
	end
	if not inteam(pid) then 
	    if JY.Thing[203][WZ6] > 0 then 
	    local a = JY.Thing[203][WZ6]
	        if a > 25 then 
		        a = 25
		    end
	        hurt = math.modf(hurt * (1+a*0.02))
        end	   
    end	
    -------------------------------系数加成
    --连击，伤害减少40% 杀气-50%
    --连城剑法减少10%
    --nino 六脉减少30% 杀气-30%
    --东方连击减弱10%
    if WAR.ACT > 1 then
        if pid == 0 and zjtype()==1 and juexing()>0 and GetS(10, 0, 11, 0) == 1 then
		    hurt = math.modf(hurt * 1)
		    ang = math.modf((ang) * 1)
	    elseif getHZ(pid, 22) or extralj(pid) then
	            if DT(pid,27) and MPPD(pid) == 12 then 
	                local mpdj = MPDJ(pid)
		            hurt = math.modf(hurt * (1 + (WAR.ACT / 50 * mpdj)))
		            ang = math.modf((ang) * (1 + (WAR.ACT / 50 * mpdj)))
		        else
		            hurt = math.modf(hurt * 1)
		            ang = math.modf((ang) * 1)	
                end
	    elseif MPPD(pid)==3 then
		        hurt = math.modf(hurt * 1)
		        ang = math.modf((ang) * 1)
	    elseif GB(pid)==2 or DT(pid,69) then
		        hurt = math.modf(hurt * 1.1)
		        ang = math.modf((ang) * 1)
	    elseif GB(pid)==3 or DT(pid,69) then
		        hurt = math.modf(hurt * 1)
		        ang = math.modf((ang) * 1.1)
	    elseif wugong == 130 then
		        hurt = math.modf(hurt * 1.1)
		        ang = math.modf((ang) * 1.1)			
	    elseif T6XQS(pid) then
		        hurt = math.modf(hurt * (0.9 - (WAR.ACT / 10)))
		        ang = math.modf(ang * (0.9 - (WAR.ACT / 10)))
		        if juexing()>2 then
		            AddPersonAttrib(eid,"生命",-WAR.ACT*10)
		        end
	    elseif wugong == 49 then
		        hurt = math.modf(hurt * 0.8)
		        ang = math.modf((ang) * 0.8)	
	    elseif wugong == 114 then
		        hurt = math.modf(hurt * 0.9)
		        ang = math.modf((ang) * 0.9)	
	    elseif PersonKF(eid, 153) then --临济十二庄被连击时伤害减少
		        hurt = math.modf(hurt * 0.5)
		        ang = math.modf((ang) * 0.5)
        elseif T7DFWM(pid) and yongquan(wugong) and WAR.DZXY==1 and juexing()>1 then --拳系反击伤害增加
		        hurt = math.modf(hurt * 1.2)
		        ang = math.modf((ang) * 1.2)
        elseif DT(pid,5) and WAR.TJZX2>0 then --太极之形增加
		        hurt = math.modf(hurt * (1 + (WAR.ACT / 10))+math.modf((WAR.SPIRIT[pid]-100)*30))
		        ang = math.modf((ang) * (1 + (WAR.ACT / 10)))	
	    elseif (MPPD(pid) == 12 and not DT(pid,27)) or DT(pid,617) then --日月神教
	    local mpdj = MPDJ(pid)
		hurt = math.modf(hurt * (1 + (WAR.ACT / 50 * mpdj)))
		ang = math.modf((ang) * (1 + (WAR.ACT / 50 * mpdj)))	
	else
		hurt = math.modf(hurt * 0.7)
		ang = math.modf((ang) * 0.6)
	    end
    end  
    
	if wglw(pid,106) or (DT(pid,9) and PersonKF(pid,106))then --17-2-8
	    local YNWG = {}
	    local ynwg = 0
	    for i = 0, JY.ThingNum - 1 do
		    if JY.Thing[i]["需内力性质"] == 1 then
			    ynwg = ynwg + 1
			    YNWG[ynwg] = JY.Thing[i]["练出武功"]
		    end
	    end
	    for i = 1, #YNWG do
            if wugong == YNWG[i] then 
	            hurt = math.modf(hurt * 1.3)
	        end  
        end	
	end
	
	if eid == 0 and putong() == 5 and JX(eid) and JY.Person[eid]["内力"] >=5000 then
		local aa = math.modf(JY.Person[eid]["内力"] / 800)
		local bb = math.modf(JY.Person[eid]["内力"] / 400)
		local cc = limitX(math.random(aa, bb), 1, 24)
		ang = ang - math.modf(cc * 100)
        if ang<=0	then
	        ang=0
        end	   
		WAR.TIANGANG = cc
	end	
	
    if eid == 0 and putong() == 5 and WAR.TIANGANG > 0 and JX(eid) then --天罡斗气显示
		local duanshu = ""
		local names = 
		{{1,"一" },
		{2, "二"},
		{3,"三" },
		{4, "四"},
		{5, "五"},
		{6, "六"},
		{7, "七"},
		{8, "八"},
		{9, "九"},
		{10, "一十"},
		{11, "一十一"},
		{12,"一十二" },
		{13, "一十三"},
		{14, "一十四"},
		{15, "一十五"},
		{16, "一十六"},
		{17, "一十七"},
		{18, "一十八"},
		{19, "一十九"},
		{20, "二十"},
		{21, "二十一"},
		{22, "二十二"},
		{23, "二十三"},
		{24, "绝对防御"},		
		}
		for i,v in ipairs(names) do
			if v[1] == WAR.TIANGANG then
				duanshu = v[2]
				break
			end
	    end
		Cls()
        NewDrawString(-1, -1, "护体真罡・"..duanshu, C_GOLD, 50)
        ShowScreen()
        lib.Delay(700)		
	end		
	
	if wglw(pid,107) or DT(pid,599) then --17-2-10
	    local YNWG = {}
	    local ynwg = 0
	    for i = 0, JY.ThingNum - 1 do
		    if JY.Thing[i]["需内力性质"] == 0 then
			    ynwg = ynwg + 1
			    YNWG[ynwg] = JY.Thing[i]["练出武功"]
		    end
	    end
	    for i = 1, #YNWG do
            if wugong == YNWG[i] then 
	            hurt = math.modf(hurt * 1.3)
	        end  
        end	
	end
 
    --侵略如火附加伤害
	if WAR.FLHS3 == 1 then
		hurt = hurt + 300
	end 		
	
    --聂风3觉附加伤害
	if NF(pid) and juexing() > 2 then
	    hurt = hurt + 200
	end 	
	
    --步惊云2觉附加伤害
	if BJY(pid) and  juexing() > 1 then
	    hurt = hurt + 200
	end 	
	
	--武无敌附加伤害
	if DT(pid, 600) then
	    hurt = hurt + 1000
    end	
	
    --六脉领悟附加伤害
	if WAR.LMJQ > 0 then 
	    hurt = hurt + 400
	end		
	
    --降龙柔劲附加伤害
	if WAR.XLGJ == 2 or WAR.XLGJ == 4 or WAR.XLGJ == 5 then
	    hurt = hurt + 300
    end		
	
    --黯然附加伤害
	if WAR.ARJX > 0 then
	    hurt = hurt + 200
    end	

    --太极神功附加伤害
	if PersonGT(pid,182) and WAR.Actup[pid] ~= nil then
		hurt = hurt + 300
	end 	

    --霹雳刀法附加伤害
	if wugong == 141 and (DT(pid, 585) or wglw1(pid,141)) then
		hurt = hurt + 150
	end
    
	--黯然销魂掌附加伤害
    if wugong == 25 and (DT(pid, 58) or wglw1(pid,25)) then
	    hurt = hurt + 250
	end
	
	--须弥山神掌掌附加伤害
    if wugong == 24 and (DT(pid, 615) or WAR.XMSSZ > 0) then
	    hurt = hurt + 200
	end
	
	--玄铁剑法附加伤害
    if wugong == 45 and (DT(pid, 592) or wglw1(pid,45)) then
	    hurt = hurt + 300
	end	
 
    --太极剑法附加伤害
    if wugong == 46 and ((DT(pid, 5) or DT(pid, 9) or DT(pid, 666)) or wglw1(pid,46)) then
	    hurt = hurt + 200
	end 	
 	
    --火焰刀法附加伤害
	if wugong == 66 and ((DT(pid, 103) or DT(pid, 595)) or wglw1(pid,66)) then
	    hurt = hurt + 250
	end 		
	
    --七伤拳附加伤害
	if wugong == 23 and ((DT(pid, 8) or DT(pid, 167) or DT(pid, 168) or DT(pid, 603)) or wglw1(pid,23)) then
	    hurt = hurt + 125
	end	
	
	--幻阴指附加伤害
    if wugong == 19 and (DT(pid, 18) or wglw1(pid,19)) then 	
	    hurt = hurt + 200
	end 	

	--胡刀附加伤害
    if wugong == 67 and (wglw1(pid,67) or (DT(pid, 1) and JX(pid)) or (DT(pid, 621) and JX(pid))) and JLSD(10, 20, eid) then 	
	    hurt = hurt + 200
	end
	
    --白羽箭法
	if wugong == 148 and (DT(pid, 55) or wglw1(pid,148)) then 	
	    hurt = hurt + 250
	end 	
	
    --夫妻刀法
	if wugong == 62 and (DT(pid,189) or wglw1(pid,62)) then
		hurt = hurt + 150
	end 			
	
    --萧雨客附加伤害
	if T3XYK(pid) then
	    hurt = hurt + 100
	end 	
	
    if DT(pid, 662) then 
		hurt = hurt + 200
	end 		
	
	--豸苗：太玄经
	if (PersonKF(pid, 102) or  (T5BCF(pid) and juexing()>0)) then
	    if (WAR.TXTX == 1 or WAR.TXTX == 6) then
	        hurt = math.modf(hurt * 1.3) + math.modf(JY.Person[pid]["内力"]/30)
	        WAR.TXJ[pid] = 50
	    elseif WAR.TXTX > 1 and WAR.TXTX < 6 then
	         hurt = hurt + math.modf(JY.Person[pid]["内力"]/60) 
	    end
	end
	
	if (PersonKF(pid, 102) or  (T5BCF(pid) and juexing()>0)) then
	    if (WAR.TXTX == 5 or WAR.TXTX == 6) then
			local aa =  math.modf(sixi(pid,1)/100)
			hurt = hurt * aa
			if JLSD(10, 20+(aa*10), pid) then
				WAR.MENG[eid] = 30
			end
		elseif WAR.TXTX > 0  and  WAR.TXTX ~= 5 then
	        local aa =  math.modf(sixi(pid,1)/100)
			hurt = hurt + math.modf(hurt * (aa/5))
	    end	
	end
	
	if (PersonKF(pid, 102) or  (T5BCF(pid) and juexing()>0)) then
	    if (WAR.TXTX == 4 or WAR.TXTX == 6) then
			local bb =  math.modf(sixi(pid,2)/10)
			if JLSD(10,20+bb,pid) then
				WAR.SJTH[eid]=WAR.SJTH[eid] or 0 + 1
				WAR.LYXJ[eid]=WAR.LYXJ[eid] or 0 + 1
			end
		elseif WAR.TXTX > 0  and WAR.TXTX ~= 4  then
	        local bb =  math.modf(sixi(pid,2)/10)
			hurt = hurt + math.modf(hurt * (bb/50))
		end
	end
	
	
	if wglw(pid,99) or ((DT(pid,5) or DT(pid,666)) and PersonKF(pid,99)) and WAR.ACT > 1 then
	    hurt = math.modf(hurt*1.5)
	end   
	
	if MPPD(pid) == 11 and wugong == 131 then --豸苗：森九岚附加伤害
	    if WAR.SJL == 2 then 
	       hurt = math.modf(hurt * 1.3)
		elseif WAR.SJL == 5 then
		   hurt = hurt + 100
		elseif WAR.SJL == 4 then 
		   hurt = hurt + 50
		end
	end
	
     --太极拳，借力打力最多200
    if wugong == 16 and WAR.tmp[3000 + pid] ~= nil and WAR.tmp[3000 + pid] > 0 and DWPD() then
        if wglw1(pid,16) then
			hurt = hurt + WAR.tmp[3000 + pid]
			if WAR.TQFJ ~= -1 then
				local aa = math.random(3)
				WAR.tmp[3000 + pid] = math.modf(WAR.tmp[3000 + pid]/aa)
			end
		else	
			local a = 200 
			if DT(pid,5) then
				a = 300
			end  
			if WAR.tmp[3000 + pid]> a then
				WAR.tmp[3000 + pid] = a
			end
			if DT(pid,5) then
				hurt = hurt + WAR.tmp[3000 + pid]
				WAR.JLDL1 = 1
			else
				hurt = hurt + WAR.tmp[3000 + pid]
				WAR.tmp[3000 + pid] = 0
			end
			if DT(pid,5) then
				WAR.JLDL2 = 0
			end 
		end	
    end		
	
   --太极神功借力打力
    if wglw(pid,182) and WAR.tmp[3000 + pid] ~= nil and WAR.tmp[3000 + pid] > 0 and DWPD() then
        if wglw1(pid,16) and wugong == 16 then
			if WAR.tmp[3000 + pid] > 3000 then
				WAR.tmp[3000 + pid] = 3000
			end
			hurt = hurt + WAR.tmp[3000 + pid]
		else
			if WAR.tmp[3000 + pid] > 1000 then
				WAR.tmp[3000 + pid] = 1000
			end
			hurt = hurt + WAR.tmp[3000 + pid]
			WAR.tmp[3000 + pid] = 0
        end
    end	
	
	--铁碎牙暴流破
	if WAR.TSYBL == 1 and WAR.tmp[3000 + pid] ~= nil and WAR.tmp[3000 + pid] > 0 and DWPD() and (wglw1(pid,67) or (DT(pid, 1) and JX(pid)) or (DT(pid, 621) and JX(pid))) then --and JLSD(10,40,pid)
        local aa = math.random(3)
		if WAR.tmp[3000 + pid] > 1000 then
            WAR.tmp[3000 + pid] = 1000
        end
        hurt = hurt + WAR.tmp[3000 + pid]
		if JY.Person[pid]["武器"] == 43 then
			hurt = hurt + WAR.tmp[3000 + pid]*aa
		end	
        WAR.tmp[3000 + pid] = 0
		WAR.TSYBL = 0
    end
	
	if WAR.QJSD1 == 1 then      --强极十道伤害+100
		hurt = hurt + 100
	end	
	if WAR.JGZ_DMZ > 0 then	--达摩掌 伤害+80
		hurt = hurt + 100
	end
	if WAR.RL > 0 then		    --达摩掌 伤害+80
		hurt = hurt + 150
	end
    if WAR.LHQ_BNZ > 0 then    --般若掌 伤害+50
		hurt = hurt + 50
	end
	if WAR.XMS_QSRL > 0 then
		hurt = hurt + 200
	end	
	
	if pid == 0 and putong() == 2 then --剑神每练1剑伤害+5
		hurt = hurt + math.modf(10 * wgnumber(0, 2))
	end
	
	hurt = hurt + baxi(pid, wugong)
    hurt = math.modf(hurt)
	--小日本 攻击伤害提高
	if WAR.BSMT == 1 then
		hurt = hurt + 100 + math.random(50)
	end
	
	if DT(pid, 635) and JY.Person[pid]["受伤程度"] > 0 then --穆念慈受伤越高伤害越大
		hurt = hurt + math.modf(JY.Person[pid]["受伤程度"] * 1.5)
	end
  
	if hasTF(pid, 33) and JY.Person[eid]["受伤程度"] > 0 then
		hurt = hurt + JY.Person[eid]["受伤程度"] 
	end
	if hasTF(pid, 34) and JY.Person[eid]["中毒程度"] > 0 then
		hurt = hurt + JY.Person[eid]["中毒程度"] 
	end	
	if not T8LXY(0) then
		if pid == 0 or pid == 92 then --mm宿缘彼此追加伤害
			local sycount = 0
			for j = 0, WAR.PersonNum - 1 do
				if (WAR.Person[j]["人物编号"] == 0 or WAR.Person[j]["人物编号"] == 92) and 
					WAR.Person[j]["死亡"] == false then
					sycount = sycount + 1
				end
			end
			if sycount == 2 then
				hurt = hurt + math.modf((WAR.MMSY + 5) * 5)
			end
		end  
	end
	
    if wugong == 26 and (DT(pid,55) or DT(pid,617)) then	--郭靖降龙根据敌方内力耗损量追加100%伤害
		local a = (JY.Person[eid]["内力最大值"] - JY.Person[eid]["内力"]) / JY.Person[eid]["内力最大值"]
		hurt = math.modf(hurt * (2 + a))
	end	
	
    --幻蝶扇
	if JY.Person[pid]["武器"] == 245 and JLSD(10,40,pid) then	
		WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", 6)
	end	
	
	--霍都攻击
	if WAR.HDWZ == 1 then
		hurt = math.modf(hurt + 70)
		WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", 15)
	end	
	
     --蚊须针带毒
	if wugong == 166 and (DT(pid, 12) or wglw1(pid,166)) then	
		hurt = hurt + 100
		WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", 10)
		WAR.L_WNGZL[eid] = WAR.L_WNGZL[eid] or 0 +20
	    WAR.POISON[eid] = WAR.POISON[eid] or 0 +20
	end	
	
    --葵花神针带毒 	
	if wugong == 177 and (DT(pid, 27) or wglw1(pid,177)) then
		hurt = hurt + 200
		WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", 25)
	end		
	
    --葵花套件
	if KHTZF(pid) and wugong == 177 then
		WAR.L_WNGZL[eid] = WAR.L_WNGZL[eid] or 0 +20
	    WAR.POISON[eid] = WAR.POISON[eid] or 0 	+20
	    if WAR.LQZ[eid] == 100 then
	        WAR.LQZ[eid] = WAR.LQZ[eid] - 20
	    end
		local aa = 0
		aa = math.modf(JY.Person[eid]["生命"] * 0.07)
		if aa < 100 then
			aa = 100
		elseif aa > 300 then
			aa = 300
		end
		WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "生命", -aa)
		WAR.Person[emenyid]["中毒点数"] = AddPersonAttrib(eid, "中毒程度", math.random(10,15))
	end 	
	
    --玄冥带毒
	if wugong == 21 and ((DT(pid, 643) or DT(pid, 644)) or wglw1(pid,21)) then	
		hurt = hurt + 300
		WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", 20)
	end	
	
    --六脉剑气
	if wugong == 49 and (DT(pid, 53) or wglw1(pid,49)) then
		hurt = hurt + 200
		WAR.Person[emenyid]["受伤程度"] = (WAR.Person[emenyid]["受伤程度"] or 0) + AddPersonAttrib(eid, "受伤程度", 30)
	end		
	
    --降龙内劲内伤 	
	if wugong == 26 and ((DT(pid, 50) or DT(pid,617)) or wglw1(pid,26)) then
		hurt = hurt + 200
		WAR.Person[emenyid]["受伤程度"] = (WAR.Person[emenyid]["受伤程度"] or 0) + AddPersonAttrib(eid, "受伤程度", 25)
	end		
	
    --玄冥内伤
	if wugong == 21 and ((DT(pid, 643) or DT(pid, 644)) or wglw1(pid,21)) then	
		hurt = hurt + 100
		WAR.Person[emenyid]["受伤程度"] = (WAR.Person[emenyid]["受伤程度"] or 0) + AddPersonAttrib(eid, "受伤程度", 15)
	end		
	
    --七伤拳内伤
	if wugong == 23 and ((DT(pid, 8) or DT(pid, 167) or DT(pid, 168) or DT(pid, 603)) or wglw1(pid,23)) then
		hurt = hurt + 75
		WAR.Person[emenyid]["受伤程度"]	= (WAR.Person[emenyid]["受伤程度"] or 0) + AddPersonAttrib(eid, "受伤程度", 12)
	end 	
	
	--灭绝剑法，增加伤害
	--灭
	if WAR.L_MJJF == 1 then
		hurt = hurt + 50;	
		if JY.Person[pid]["武器"] == 37 then
			JY.Person[emenyid]["生命"] = (JY.Person[emenyid]["生命"] or 0) - 50
		end
	end
	
	if WAR.L_MJJF == 3 then
		hurt = hurt + 50;	
		if JLSD(10,70,pid) then
			hurt = hurt + 100;
		end
		if JY.Person[pid]["武器"] == 37 or DT(pid,6) then
			JY.Person[emenyid]["生命"] = (JY.Person[emenyid]["生命"] or 0) - 100
		end	
	end
	
    if MPPD(pid) == 12 and DWPD() then 
        local mpdj=MPDJ(pid)
        hurt = math.modf(hurt + 0.03* mpdj * JY.Person[pid]["攻击力"]) 
    end----日月神教

    if pid == 0 and putong() == 8 then
	   hurt = hurt + JY.Person[pid]["中毒程度"] 
	end
  
    if wugong == 177 and (DT(pid, 27) or wglw1(pid,177)) then
		hurt = hurt + JY.Person[pid]["中毒程度"]
	end 	 
	
	if wugong == 21 and ((DT(pid, 643) or DT(pid, 644)) or wglw1(pid,21)) then
		hurt = hurt + JY.Person[pid]["中毒程度"]
	end 	 

    if MPPD(pid) == 14 and yongjian(wugong) and PersonGTJL(pid, 89, WAR.NGJL) and MPDJ(pid) > 1 and --五岳剑派山居剑意伤害
	    WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
	    local d = math.modf((JY.Person[pid]["内力"] - JY.Person[eid]["内力"]) / 300)
	    local str=""
        if d < 10 then
            d = 10
        end
  	    WAR.LXXS[eid] = 1
	    WAR.LXZT[eid] = limitX((WAR.LXZT[eid] or 0) + d, 0, 100)
        local aa = math.modf(sixi(pid, 2) / 20)
	    local bb = math.modf(sixi(pid, 2) / 10)
	    local cc = limitX(math.random(aa, bb), 1, 24)
	    hurt = hurt + math.modf(cc * 10)
	    if JLSD(10,30+MPDJ(pid)*5,pid) then
	        WAR.SJTH[eid]=WAR.SJTH[eid] or 0+1
	        str=".透魂剑锋"
	    end
	    if WAR.Person[emenyid][CC.TXWZ3] == nil then
		    WAR.Person[emenyid][CC.TXWZ3] = "山居剑意"..str
	    else
		    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "山居剑意"..str
	    end	
	    WAR.Person[emenyid][CC.TXDH] = 112
    end
  
    if WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then 
	
	if DT(pid, 614) and yongjian(wugong) then --武骧金星：阿青附加伤害
		local q = wgnumber(pid, 2)
		hurt = hurt + 30 * q
	end

	if DT(pid, 20) and yongjian(wugong) then
		hurt = hurt + math.modf(sixi(pid, 2) * 0.5) 
	end
	
	if DT(pid, 632) and WAR.DD == 1 then
		hurt = hurt + math.modf(JY.Person[eid]["生命"] * 0.1) 
	end	
	
	if MPPD(pid)==16 and PersonGTJL(pid,100,WAR.NGJL) and yongjian(wugong) and JLSD(20,50,pid) then ----气罡剑法
	    hurt = hurt + math.modf(ang * 0.5) 
	if WAR.Person[emenyid][CC.TXWZ3] == nil then
		WAR.Person[emenyid][CC.TXWZ3] = "紫阳剑罡.两仪化形"
	else
		WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "紫阳剑罡.两仪化形"
	end	
	WAR.Person[emenyid][CC.TXDH] = 101
	end
	
	if MPPD(pid)==16 and PersonGTJL(pid,100,WAR.NGJL) and yongjian(wugong) and JLSD(20,50,pid) then ----气罡剑法
	    WAR.GTJIQI=WAR.GTJIQI+math.modf(ang*0.25) 
	    WAR.GTPID=pid
	    if WAR.Person[emenyid][CC.TXWZ3] == nil then
		    WAR.Person[emenyid][CC.TXWZ3] = "紫阳剑罡.大道无形"
	    else
		    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "紫阳剑罡.大道无形"
	    end	
	        WAR.Person[emenyid][CC.TXDH] = 112
	end
	
	if MPPD(pid)==16 and PersonGTJL(pid,150,WAR.NGJL) and yongquan(wugong) and JLSD(20,50,pid) then ----气罡剑法
	    WAR.GTSHAQI=math.modf(hurt*1.25) 
	    WAR.GTPID2 = pid 
	    if WAR.Person[emenyid][CC.TXWZ3] == nil then
		    WAR.Person[emenyid][CC.TXWZ3] = "金关刚拳.杀意化实"
	    else
		    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "金关刚拳.杀意化实"
	    end	
	        WAR.Person[emenyid][CC.TXDH] = 78
	end
	
    if DT(pid,153) and JX(pid) and JLSD(10,40,pid) then----赵半山
        WAR.GTJIQI=WAR.GTJIQI+math.modf(hurt*0.5)
	    WAR.GTPID = pid
	    if WAR.Person[emenyid][CC.TXWZ3] == nil then
		    WAR.Person[emenyid][CC.TXWZ3] = "千臂如来.飞龙回巢"
	    else
		    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "千臂如来.飞龙回巢"
	    end	
	        WAR.Person[emenyid][CC.TXDH] = 109
	end
	
	if WAR.ZFLY == 1 then
		if (wglw1(pid,77) or ((DT(pid,605) or (DT(pid,627)))and JX(pid))) and JLSD(10,15+(WAR.CHZ[eid]or 0),eid) then
			dng = 0
			WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid,"内力",-300)
		end	
		hurt = hurt + math.modf(sixi(pid, 3) * 0.5)
		if (wglw1(pid,60) or DT(pid,166)) then
			hurt = hurt + math.modf((sixi(pid,2) + sixi(pid, 3)) * 2)
		end
		if WAR.ZFLY1>0 then
		    hurt = hurt + math.modf(WAR.ZFLY1 * 0.1) 
		end
	end
	
	if WAR.ZFLY == 2 then
		if (wglw1(pid,77) or ((DT(pid,605) or (DT(pid,627)))and JX(pid))) and JLSD(10,15+(WAR.CHZ[eid]or 0),eid) then
			dng = 0
			WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid,"内力",-300)
		end
		hurt = hurt + math.modf(sixi(pid, 2) * 0.5)
		if (wglw1(pid,60) or DT(pid,166)) then
			hurt = hurt + math.modf((sixi(pid,2) + sixi(pid, 3)) * 2)
		end
		if WAR.ZFLY1>0 then
		    hurt = hurt + math.modf(WAR.ZFLY1 * 0.1) 
		end		
	end
	
	if pid == 0 and WAR.KHNP1[pid] == 1 then --葵花涅1
	    hurt = math.modf(hurt * 1.3)
	end

	if (XYL(pid) or DT(pid,597)) and yongjian(wugong) then --豸苗：谢云流附加伤害
		hurt = hurt + math.modf(JY.Person[pid]["御剑能力"] * 0.35)
	end
   
    if wugong == 42 and ((DT(pid, 601) or DT(pid, 59)) or wglw1(pid,42)) then --玉女剑法剑系附加伤害
		hurt = hurt + math.modf(JY.Person[pid]["御剑能力"] * 0.65)
	end

    if wugong == 133 and (DT(pid, 113) or wglw1(pid,133)) then --参合指拳系附加伤害
		hurt = hurt + math.modf(JY.Person[pid]["拳掌功夫"] * 0.5)
	end	

    if wugong == 26 and (DT(pid,49) or DT(pid,617)) then
		hurt = hurt + math.modf(JY.Person[pid]["拳掌功夫"] * 1.5)
	end	 

    --华山拳系
	if (MPPD(pid) == 14 and PersonGT(pid,90) and JY.Person[pid]["拳掌功夫"] >= 200 and yongquan(wugong)) or ((DT(pid,54) or DT(pid,185) or DT(pid,188)) and yongquan(wugong)) then
		hurt = hurt + math.modf(sixi(pid,1) * 1.2)
	end	

    if NF(pid) and yongquan(wugong) and juexing() > 1 then --聂风拳系附加伤害
		hurt = hurt + math.modf(sixi(pid,1) * 1.5)
	end

    if NF(pid) and yongjian(wugong) and juexing() > 1 then --聂风剑系附加伤害
		hurt = hurt + math.modf(sixi(pid,2) * 1.5)
	end

    if NF(pid) and yongdao(wugong) then --聂风刀系附加伤害
		hurt = hurt + math.modf(sixi(pid,3) * 2)
	end

    if NF(pid) and yongte(wugong) then --聂风特系附加伤害
		hurt = hurt + math.modf(sixi(pid,4) * 2)
	end

    if NF(pid) and yongan(wugong) and juexing() >1 then --聂风暗器附加伤害
		hurt = hurt + math.modf(sixi(pid,5) * 1.5)
	end

    if BJY(pid) and yongquan(wugong) then --步惊云拳系附加伤害
		hurt = hurt + math.modf(sixi(pid,1) * 2)
	end

    if BJY(pid) and yongjian(wugong) then --步惊云剑系附加伤害
		hurt = hurt + math.modf(sixi(pid,2) * 2)
	end

    if DT(pid, 600) and yongquan(wugong) then --武无敌拳系附加伤害
		hurt = hurt + math.modf(sixi(pid,1) * 5)
	end

    if DT(pid, 600) and yongjian(wugong) then --武无敌剑系附加伤害
		hurt = hurt + math.modf(sixi(pid,2) * 5)
	end

    if DT(pid, 600) and yongdao(wugong) then --武无敌刀系附加伤害
		hurt = hurt + math.modf(sixi(pid,3) * 5)
	end

    if DT(pid, 600) and yongte(wugong) then --武无敌特系附加伤害
		hurt = hurt + math.modf(sixi(pid,4) * 5)
	end

    if DT(pid, 600) and yongan(wugong) then --武无敌暗器附加伤害
		hurt = hurt + math.modf(sixi(pid,5) * 5)
	end
	
    if DT(pid,665) and yongdao(wugong) then --组长刀系附加伤害
		hurt = hurt + math.modf(sixi(pid,3) * 1.2)
	end	
	
     if wugong == 62 and (DT(pid,189) or wglw1(pid,62)) then --夫妻刀法
		hurt = hurt + math.modf(sixi(pid,3) * 1.2)
	end 	
	
    --白羽箭法附加暗器系数伤害
	if wugong == 148 and (DT(pid, 55) or wglw1(pid,148)) then 	
	    hurt = hurt + math.modf(sixi(pid,5) * 1.5)
	end 	

    if WAR.KTAY1 == 1 then
		hurt = hurt + math.modf(sixi(pid,1) * 2)
	end 	

    if WAR.XSJS == 1 then
		hurt = hurt * 1.25
	end 	

    if WAR.LYFH > 0 then
		hurt = hurt * 2
	end 	

    if WAR.LMSJ > 0 then
		hurt = hurt + math.modf(sixi(pid,1)* 2)
	end

    if WAR.LMSJ > 0 then 
		hurt = hurt + math.modf(sixi(pid,2)* 2)
	end

	if WAR.MCF2 == 1 and WAR.WCY3>0 then
        if ZJ(pid) then
		    hurt = hurt +50*(8-WAR.WCY3)
	    else
		    hurt = hurt +75*(8-WAR.WCY3)
	    end
    end
  
    if WAR.MCF2 == 1 and WAR.WCY4>0 then
        if ZJ(pid) then
		    hurt = hurt +50*(7-WAR.WCY4)
	    else
		    hurt = hurt +75*(7-WAR.WCY4)
	    end
    end

    if WAR.SBJ == 1 then
		local ad = math.modf((JY.Person[pid]["内力"] - JY.Person[eid]["内力"]) / 300)
		WAR.GTSHAQI = math.modf(hurt * 1.25) 
	    WAR.GTPID2 = pid
		WAR.LXXS[eid] = 1
	    WAR.LXZT[eid] = limitX((WAR.LXZT[eid] or 0) + ad, 0, 100)
        local aa = math.modf(sixi(pid, 2) / 20)
	    local bb = math.modf(sixi(pid, 2) / 10)
	    local cc = limitX(math.random(aa, bb), 1, 24)
	    hurt = hurt + math.modf(cc * 10)
	end	 

	if SJL(pid) and yongjian(wugong) then --豸苗：森九岚附加伤害
		hurt = hurt + math.modf(JY.Person[pid]["御剑能力"]* 0.35)
	end
	
	if MPPD(pid)==11 and yongjian(wugong) and not (XYL(pid) or SJL(pid) or DT(pid,597)) then --豸苗：一刀流附加伤害
		hurt = hurt + math.modf(JY.Person[pid]["御剑能力"]* 0.3)
	end
	
    if wugong == 42 and ((DT(pid, 601) or DT(pid, 59)) or wglw1(pid,42)) then  --玉女剑法附加伤害
		hurt = hurt + math.modf(JY.Person[pid]["御剑能力"] * 0.65)
	end		
	
	if WAR.DJSX==1 or WAR.SHITOUJY>0 then --田归农刀剑十杀附加刀剑系数伤害
	    hurt = hurt + math.modf((JY.Person[pid]["御剑能力"]+JY.Person[pid]["耍刀技巧"])* 0.35)
    end
	
	if WAR.DFMQ==1 then --九阴大伏魔拳
	    hurt = hurt + math.modf(JY.Person[pid]["拳掌功夫"]* 0.35)
    end
	
	if WAR.DMZF>=1 then --九阴大伏魔拳
	    hurt = hurt + math.modf((JY.Person[pid]["拳掌功夫"]+WAR.SPIRIT[pid])* 0.35)
    end
	
	if WAR.DMZF1>=1 then --九阴大伏魔拳
	    hurt = hurt + math.modf((JY.Person[pid]["拳掌功夫"]+WAR.SPIRIT[pid])* 0.35)
    end

	if WAR.PLDS >= 1 and wugong==141 then --霹雳刀法
	    hurt = hurt + math.modf((sixi(pid,3)+WAR.SPIRIT[pid])* 0.35 * WAR.PLDS)
	    if JY.Person[pid]["武器"] == 299 then----
	        hurt=math.modf(hurt*2)
	    end
    end
	
    for i,v in ipairs(CC.JCLW) do --拳掌基础领悟
        if (pid ==0 and wglw1(pid,v[1])) and v[2] ==1 and yongquan(wugong) and JY.Person[pid]["实战"]>250 then
            hurt = hurt + math.modf(JY.Person[pid]["拳掌功夫"]* 0.35)
        end
    end 
  
    for i,v in ipairs(CC.JCLW) do --御剑基础领悟
        if (pid ==0 and wglw1(pid,v[1])) and v[2] ==2 and yongjian(wugong) and JY.Person[pid]["实战"]>250 then
            hurt = hurt + math.modf(JY.Person[pid]["御剑能力"]* 0.35)
        end
    end 
	
	for i,v in ipairs(CC.JCLW) do --耍刀基础领悟
        if (pid ==0 and wglw1(pid,v[1])) and v[2] ==3 and yongdao(wugong) and JY.Person[pid]["实战"]>250 then
            hurt = hurt + math.modf(JY.Person[pid]["耍刀技巧"]* 0.35)
        end
    end 
  
    for i,v in ipairs(CC.JCLW) do --特殊基础领悟
        if (pid ==0 and wglw1(pid,v[1])) and v[2] ==4 and yongte(wugong) and JY.Person[pid]["实战"]>250 then
            hurt = hurt + math.modf(JY.Person[pid]["特殊兵器"]* 0.35)
        end
    end 
  
    for i,v in ipairs(CC.JCLW) do --暗器基础领悟
        if (pid ==0 and wglw1(pid,v[1])) and v[2] ==5 and yongan(wugong) and JY.Person[pid]["实战"]>250 then
            hurt = hurt + math.modf(JY.Person[pid]["暗器技巧"]* 0.35)
        end
    end 
	
	if JY.Person[pid]["武器"] == 363 and (JY.Person[pid]["品德"]or 0) >= (JY.Person[eid]["品德"] or 0) and yongquan(wugong) then--佛珠伤害加成
		local aa= JY.Person[pid]["品德"]or 0
		local bb = JY.Person[eid]["品德"] or 0
		if MPPD(pid) == 5 then
			hurt = hurt + math.modf(200+((aa-bb)*2))
			if WAR.Person[emenyid][CC.TXWZ1] == nil then
				WAR.Person[emenyid][CC.TXWZ1] = "真・物理超渡"
			else
				WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" .. "真・物理超渡"
			end
		else
			hurt = hurt + math.modf(200+(aa-bb))
			if WAR.Person[emenyid][CC.TXWZ1] == nil then
				WAR.Person[emenyid][CC.TXWZ1] = "物理超渡"
			else
				WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" .. "物理超渡"
			end
		end
		if JY.Person[pid]["品德"] ~= nil and JY.Person[pid]["品德"] > 99 then
			if JLSD(10,35,pid) and WAR.FDZS[eid] == nil then
				WAR.FDZS[eid] = limitX((WAR.FDZS[eid] or 0) + 15, 0, 100)
			end
		end	
	end
	
	if WAR.FDZS[pid] ~= nil then
		if (WAR.SPIRIT[pid] or 0) <= (WAR.SPIRIT[eid] or 0) then
			local aa = (WAR.SPIRIT[eid] or 0) - (WAR.SPIRIT[pid] or 0)
			hurt = math.modf(hurt*(1-(aa/100)))
		end
		if math.random(10) > 8 then
			WAR.SPIRIT[pid] = (WAR.SPIRIT[pid] or 0) - 2
		end	
	end	
	
    if wugong == 11 and (DT(pid,599) or wglw1(pid,11)) then	--摧坚神爪拳系伤害加成
		hurt = hurt + math.modf(JY.Person[pid]["拳掌功夫"] * 1.2)
	    hurt = math.modf(hurt * 2)
    end	
	
    if wugong == 175 and wglw1(pid,175) then  --霹雳火雷暗器伤害加成
		hurt = hurt + math.modf(JY.Person[pid]["暗器技巧"] * 3)
		hurt = math.modf(hurt * 3)
	end		
	
    if wglw1(pid,155) and WAR.ZKSY>0 or DT(pid,665) then
        hurt = hurt + math.modf(JY.Person[pid]["拳掌功夫"]* 0.35)
	    if WAR.CHZ[eid] ~=nil or WAR.LXZT[eid]~=nil then
	        hurt = math.modf(hurt*2)
	    end
    end
	
	if DT(pid,153) and JX(pid) and yongan(wugong) then
        hurt = hurt + math.modf(JY.Person[pid]["暗器技巧"]* 0.35)
	    if WAR.CHZ[eid] ~=nil or WAR.LXZT[eid]~=nil then
	        hurt = math.modf(hurt*2)
	    end
    end
	
	if ((wglw1(pid,77) or ((DT(pid,605) or (DT(pid,627)))and JX(pid))) or ((DT(pid,605) or (DT(pid,627)))and JX(pid))) and WAR.DZDJ==1 then
	    hurt = hurt + math.modf(JY.Person[pid]["御剑能力"]*0.8)
	    hurt = hurt + math.modf(JY.Person[pid]["攻击力"]* 0.5)
	    if WAR.KHCM[eid] ~=nil or WAR.LXZT[eid]~=nil then
	        hurt = math.modf(hurt*2)
	    end
	end
	
	if ((wglw1(pid,77) or ((DT(pid,605) or (DT(pid,627)))and JX(pid))) or ((DT(pid,605) or (DT(pid,627)))and JX(pid))) and WAR.DZDJ==2 then
	    local cc2=math.modf(JY.Person[pid]["内力"]*0.1)
	    hurt = hurt + math.modf(JY.Person[pid]["御剑能力"]* 0.8)
	end
	
	if ((wglw1(pid,77) or ((DT(pid,605) or (DT(pid,627)))and JX(pid))) or ((DT(pid,605) or (DT(pid,627)))and JX(pid))) and WAR.DZDJ==3 then
	    hurt = hurt + math.modf(JY.Person[pid]["耍刀技巧"]* 0.8)
	    hurt = hurt + math.modf(JY.Person[pid]["防御力"]* 0.5)
	    if WAR.CHZ[eid]~=nil then
	        hurt = math.modf(hurt*2)
	    end
	end
	
	if ((wglw1(pid,77) or ((DT(pid,605) or (DT(pid,627)))and JX(pid))) or ((DT(pid,605) or (DT(pid,627)))and JX(pid))) and WAR.DZDJ==4 then
        hurt = hurt + math.modf(JY.Person[pid]["耍刀技巧"]* 0.5)
	end
	
    if wglw1(pid,34) and yongjian(wugong) then
        hurt = hurt + math.modf(JY.Person[pid]["攻击力"]* 0.35)
	    if WAR.KHCM[eid] ~=nil or WAR.LXZT[eid]~=nil then
	        hurt =  math.modf(hurt*2)
	    end
    end
  
    if wglw1(pid,33) and yongjian(wugong) then
        hurt = hurt + math.modf(JY.Person[pid]["防御力"]* 0.35)
	    if WAR.L_NOT_MOVE[eid] ~=nil or WAR.CHZ[eid]~=nil then
	        hurt = math.modf(hurt*2)
	    end
    end
	
	if T11CJR(pid) and juexing() > 2 then --藏镜人天地不容
		hurt = hurt + math.modf(JY.Person[pid]["实战"] * 2)
		if JLSD(10,30,pid) then
		hurt = hurt + math.modf(JY.Person[pid]["实战"] * 20)
		end
	end
	
    if JX(pid) and ((wugong==30 and wglw1(pid,30)) or (wugong==31 and wglw1(pid,31)) or (wugong==32 and wglw1(pid,32)) or (wugong==33 and wglw1(pid,33)) or (wugong==34 and wglw1(pid,34))) then --五岳领悟，五德循环
   		local n = 0;
		for i=1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
			if (JY.Person[pid]["武功"..i] == 30 or JY.Person[pid]["武功"..i] == 31 or JY.Person[pid]["武功"..i] == 32 or JY.Person[pid]["武功"..i] == 33 or JY.Person[pid]["武功"..i] == 34) and JY.Person[pid]["武功等级"..i] >= 999 then
				n = n + 1
			end
		end
		hurt = hurt + math.modf((JY.Person[pid]["御剑能力"]+WAR.SPIRIT[pid])* 0.25*n)
		if n==5 then
		    WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) +750;
  	        AddPersonAttrib(pid, "内力", 750);
		    hurt = math.modf(hurt*5)
		end
    end
	
    --沼跃鱼：张召重火手剑意
    if wugong == 36 and WAR.NSTJ1>0 and DT(pid,80) and JX(pid) and WAR.ACT==1 then
        hurt = hurt + math.modf(JY.Person[pid]["御剑能力"]* 0.1* WAR.NSTJ1);
    end
	
    if DT(pid, 64) and JX(pid) and WAR.ZBT2>0 then
        hurt = math.modf((hurt +WAR.SPIRIT[pid])*(1+WAR.ZBT2*0.25))
    end

    if ((wglw(pid, 107) and PersonGT(pid,107)) or DT(pid,599)) and WAR.ZBT2>0 then
        hurt = math.modf((hurt +WAR.SPIRIT[pid])*(1+WAR.ZBT2*0.25))
    end
  
    if WAR.DJJIAN==1 or WAR.DJGZ==2 or WAR.SHITOUJIAN==1 then --田归农刀剑十杀附加刀剑系数伤害
	    hurt = hurt + math.modf((JY.Person[pid]["御剑能力"])* 0.25)
    end

	if WAR.ZYQT>0  then --田归农刀剑十杀附加刀剑系数伤害
	    hurt = hurt + math.modf((JY.Person[pid]["特殊兵器"])* 0.35)
    end
	
	
	if DT(pid,152) and JX(pid) then --无尘觉醒剑系伤害
	    hurt = hurt + math.modf((JY.Person[pid]["御剑能力"])* 0.25)
    end
	
	
	if WAR.DJDAO==1 or WAR.DJGZ==3 or WAR.SHITOUDAO==1 then --田归农刀剑十杀附加刀剑系数伤害
	    hurt = hurt + math.modf((JY.Person[pid]["耍刀技巧"])* 0.25)
    end
	
	if WAR.DJGZ==4 then --田归农刀剑十杀附加刀剑系数伤害
	    hurt = hurt + math.modf((JY.Person[pid]["用毒能力"])* 1.25)
    end
	
	if WAR.TGLX>=1 then --田归农刀剑十杀附加刀剑系数伤害
	    hurt = math.modf(hurt *(1+0.5*WAR.TGLX))
    end
	
	if XYL(pid) and (WAR.XYLCZ1 == 1 or WAR.XYLCZ == 2) and DWPD() then --豸苗：谢云流附加伤害
	    hurt = hurt + 100
	end
	
    if wugong == 42 and ((DT(pid, 601) or DT(pid, 59)) or wglw1(pid,42)) then  --玉女剑法附加伤害
		hurt = hurt + 150
	end		
	
	if wglw(pid,592) or DT(pid,592) then 
	    if WAR.JQRZ == 2 then 
	        WAR.KHG[eid] = 30
	        hurt = hurt + math.modf(JY.Person[pid]["御剑能力"]/2)
	    end
	end
	if fqdid(pid) and WAR.FQDF > 0 and wugong == 62 then 
	    hurt = hurt + WAR.FQDF*50
	end
    end
    if T4WXS(pid) and WAR.SHITOUJY==2 and DWPD() then --王小石相思销魂・爱恨交缠增加伤害
	   local tmp = math.modf((JY.Person[pid]["生命最大值"]-JY.Person[pid]["生命"])/5)
	   if tmp<120 then tmp=120 end
	   hurt = hurt + tmp
    end
  
    if DT(pid, 639) and DWPD() then
	   local tmp = math.modf((JY.Person[pid]["生命最大值"] - JY.Person[pid]["生命"]) / 5)
	   hurt = hurt + tmp
    end

	--蓝烟清：燃木刀法，普通内功加力额外增加伤害
	if wugong == 65 and WAR.NGJL > 0 then
		hurt  = hurt + math.modf(JY.Wugong[WAR.NGJL]["攻击力10"]/12);
	end
	if (JY.Person[pid]["内力性质"] == 3 or DT(pid, 618) or DT(pid, JY.Person[618]["无用13"]) or JY.Person[pid]["内力性质"] == 0) and WAR.NGJL > 0 then --武骧金星：阴内效果
		hurt = hurt + math.modf(hurt * (JY.Person[pid]["内力"] + JY.Person[pid]["内力最大值"]) / 25000)
	end

    --玄冥火刀
	if WAR.YY~=0 and DWPD() then
		local shanghai=math.random(1,2)
		if WAR.YY==1 then --玄冥内伤
			JY.Person[eid]["受伤程度"]=JY.Person[eid]["受伤程度"]+15		
			hurt=hurt+math.modf(shanghai*JY.Person[eid]["受伤程度"])
		else --火刀上毒
			JY.Person[eid]["中毒程度"]=JY.Person[eid]["中毒程度"]+15			
			hurt=hurt+math.modf(shanghai*JY.Person[eid]["中毒程度"])
		end
	end
	
    --降龙内劲
	if wugong == 26 and (DT(pid, 50) or wglw1(pid,26)) then	
	    JY.Person[eid]["受伤程度"] = JY.Person[eid]["受伤程度"] + 15		
		hurt = hurt + math.modf(hurt * JY.Person[eid]["受伤程度"])
	end	
	
    --黯然销魂
	if wugong == 25 and (DT(pid, 58) or wglw1(pid,25)) and WAR.LQZ[pid] == 100 then
		JY.Person[eid]["受伤程度"] = JY.Person[eid]["受伤程度"] + 10		
		hurt = hurt + math.modf(hurt * JY.Person[eid]["受伤程度"])
		WAR.Person[WAR.CurID][CC.TXWZ3] = "黯然销魂・饮恨吞声"
	end	
	
    if MPPD(pid) == 18 and WAR.KTFT == 1 and JY.Person[pid]["拳掌功夫"] >= 400 and yongquan(wugong) and JLSD(10,45,pid) and PersonGTJL(pid,189,WAR.NGJL) then --崆峒拳系堂主	
		JY.Person[eid]["受伤程度"] = JY.Person[eid]["受伤程度"] + JY.Person[pid]["拳掌功夫"]		
		hurt = hurt + math.modf(hurt * JY.Person[eid]["受伤程度"])
		WAR.Person[WAR.CurID][CC.TXWZ3] = "崆峒神拳・拳倾天下"
	end	
	
    if WAR.FQDS == 5 or WAR.FQDS == 6 then
		JY.Person[eid]["受伤程度"] = JY.Person[eid]["受伤程度"] + 1
		hurt = hurt + math.modf(hurt + JY.Person[eid]["受伤程度"])
	end			
	
	--胡刀苍龙破暴怒
	if wugong == 67 and (wglw1(pid,67) or (DT(pid, 1) and JX(pid)) or (DT(pid, 621) and JX(pid))) and WAR.LQZ[pid] == 100 then
		if WAR.QLP ~= nil and WAR.QLP > 0 then
			local aa = WAR.QLP
			local bb = aa / 2
			hurt = hurt + math.modf(hurt * bb) 
			WAR.QLP = 0
		end
	end	
    
	if NF(pid) and yongdao(wugong) and JLSD(10, 40, pid) then
		JY.Person[eid]["受伤程度"] = JY.Person[eid]["受伤程度"] + 10		
		hurt = hurt + math.modf(hurt * JY.Person[eid]["受伤程度"])
		WAR.Person[WAR.CurID][CC.TXWZ2] = "红杏出墙"
	end 		
	
    --七伤拳	
    if wugong == 23 and ((DT(pid, 8) or DT(pid, 167) or DT(pid, 168) or DT(pid, 603)) or wglw1(pid,23)) then
		JY.Person[eid]["受伤程度"] = JY.Person[eid]["受伤程度"] + 8
	    hurt = hurt + math.modf(hurt * JY.Person[eid]["受伤程度"])
	end
		
	--六脉剑气
    if wugong == 49 and (DT(pid, 53) or wglw1(pid,49)) then
		JY.Person[eid]["受伤程度"] = JY.Person[eid]["受伤程度"] + 20		
		hurt = hurt + (math.modf((hurt + JY.Person[eid]["受伤程度"]) * 6))
	end		
	
    if hasTF(pid, 158) then
		JY.Person[eid]["受伤程度"] = JY.Person[eid]["受伤程度"] + 20
		if JY.Person[eid]["受伤程度"] > 100 then
			JY.Person[eid]["受伤程度"] = 100
		end
	end				
	
	if WAR.YJJS == 1 then
        hurt = hurt + math.modf(JY.Person[eid]["受伤程度"] * 1.5)
	    hurt = math.modf(hurt + (JY.Person[eid]["内力最大值"] / 2))
	    if WAR.HOT[eid] ~=nil and WAR.HOT[eid]>0 then
	        hurt = hurt * 3
	    end	
	end	
	
    if wugong == 26 and (DT(pid,55) or DT(pid,617)) then --郭靖降龙
		local a = 9
	    if JY.Person[eid]["受伤程度"] ~= nil then
	        a = a + JY.Person[eid]["受伤程度"] * 9
	    end
		hurt = math.modf(hurt * a)
		ang = math.modf(ang * a)
	end	
	
	if WAR.BPD[eid] ~= nil and (wglw1(pid,170) or DT(pid,161)) and wugong == 170 then
		local aa = WAR.ICE[eid] or 0
		if aa == 0 then
			hurt = hurt + 0
		else 
			hurt = hurt + math.modf(hurt * aa/20)
		end	
	end			
			
	if DT(pid,161) and JX(pid) and WAR.SPIRIT[pid] >= 120 and wugong == 170 and WAR.Actup[pid] ~= nil then
		hurt = math.modf(hurt * 2)
		if JY.Person[eid]["性别"] == 0 and JY.Person[eid]["品德"] < 60 then
		hurt = math.modf(hurt * 3)
		end
	elseif WAR.Actup[pid] ~= nil and WAR.SPIRIT[pid] >= 140 and wugong == 170 and (wglw1(pid,170) or DT(pid,161))then --冰魄银针领悟大招
		hurt = math.modf(hurt * 2)
	end	
	
    if (wugong ~= 16 or(wugong == 16 and PersonGT(pid,182))) and MPPD(pid) == 4 and WAR.BG[pid] ~= nil and DWPD() then --武当八卦
	    hurt = hurt + math.modf(WAR.BG[pid]*MPDJ(pid))
	    if DT(pid,5) and WAR.TJZX2>1 then
	        hurt = hurt + WAR.BG[pid]*(WAR.TJZX2-1)
	    end
	    if PersonGT(pid, 99) or PersonGT(pid, 182) then
            WAR.BG[pid] = math.modf(WAR.BG[pid]*0.9)
        else		
            WAR.BG[pid] = nil
        end
    end
  
    if MPPD(pid) == 8 and WAR.JD[pid] ~= nil and DWPD() then --武骧金星：白驼山集毒
	    hurt = hurt + WAR.JD[pid] / 2
	    WAR.JD[pid] = nil
    end
  
    if MPPD(pid) == 10 and WAR.JH[pid] ~= nil and DWPD() then --武骧金星：桃花岛九花玉露
	    hurt = hurt + WAR.JH[pid] / 2
	    if hurt < 0 then
	        hurt = 0
	    end
	    WAR.JH[pid] = nil
    end
  
	if DT(pid, 631) then
		--local aa, bb = JX(pid)
	    local aa = JY.Person[578]["拳掌功夫"]--JX(pid)
	    if aa > 100 then 
	        aa = 100 
	    end
	    --if aa then
			hurt = hurt + aa * 5
	    --end
	end
	
	if WAR.GSLE == 1 then --公孙绿萼枣核钉
		hurt = hurt + math.modf(JY.Person[pid]["暗器技巧"] * 0.5)
	end
	
	if WAR.DZDJ2 == 1 then --枣核钉五连发
		hurt = hurt + math.modf(JY.Person[pid]["暗器技巧"] * 0.5)
		JY.Person[pid]["暗器技巧"]=JY.Person[pid]["暗器技巧"]+math.random(3,5)
	end

	if WAR.HXSZ == 1 then --日月神教黑血神针
		hurt = hurt + math.modf(sixi(pid,5) * 0.5)
	end
	
	
	if WAR.GBWZ2 == 1 then
		hurt = hurt + math.modf(JY.Person[pid]["御剑能力"]/2)
	end
	
	if T7DFWM(pid) and WAR.DZXY == 1 and yongan(wugong) and juexing()>1 then --东方未明暗系反击特效
	local xishu=math.modf(sixi(pid,5) * 0.7)
		hurt = hurt + xishu+ JY.Person[eid]["中毒程度"]
	end	 
	
    if wugong == 177 and (DT(pid, 27) or wglw1(pid,177)) then
		local xishu = math.modf(sixi(pid,5) * 1.2)
		hurt = hurt + xishu + JY.Person[eid]["中毒程度"]
	end	

	if wugong == 21 and ((DT(pid, 643) or DT(pid, 644)) or wglw1(pid,21)) then
		local xishu = math.modf(sixi(pid,1) * 2)
		hurt = hurt + xishu + JY.Person[eid]["中毒程度"]
	end
	
    if hasTF(pid, 130) and WAR.NSNS[pid] ~= nil and DWPD() then
	    hurt = hurt + math.modf(WAR.NSNS[pid] * 0.3)
	    WAR.NSNS[pid] = nil
    end

    --沼跃鱼：张三丰，化朽为奇的战意强化
    if DT(pid,5) and WAR.ZSF2 == 1 then
        hurt = math.modf(hurt * 1.2)
	    hurt = hurt+math.modf((WAR.SPIRIT[pid]-100)*10)
    end
	
	if wglw(pid,89) or (PersonKF(pid,89) and DT(pid,19)) then --紫霞剑系
	    if WAR.ZXJQ[pid] ~= nil and WAR.ZXJQ[pid] > 0 then 
	        WAR.ZXJQ[pid] = WAR.ZXJQ[pid] - 1
	    if WAR.ZXJQ[pid] <= 0 then 
	        WAR.ZXJQ[pid] = nil
	    end
	    hurt = hurt + 150
	    ang = ang + 1000
	    end
	end
	
    if NF(pid) then --创刀
	    if WAR.CDDQ[pid] ~= nil and WAR.CDDQ[pid] > 0 then 
	        WAR.CDDQ[pid] = WAR.CDDQ[pid] - 1
	    if WAR.CDDQ[pid] <= 0 then 
	        WAR.CDDQ[pid] = nil
	    end
	    hurt = hurt + 200
	    ang = ang + 500
	    end
	end	
	
    if BJY(pid) then --霍家剑气
	    if WAR.HJJQ[pid] ~= nil and WAR.HJJQ[pid] > 0 then 
	        WAR.HJJQ[pid] = WAR.HJJQ[pid] - 1
	    if WAR.HJJQ[pid] <= 0 then 
	        WAR.HJJQ[pid] = nil
	    end
	    hurt = hurt + 200
	    ang = ang + 1000
	    end
	end		
	
	--非百分比增加伤害
	for i = 1, #CC.ZGT2 do
		if (CC.ZGT2[i][1] == wugong or (T12YMZ(pid) and wugong == 112)) and (PersonGTJL(pid, CC.ZGT2[i][2], WAR.NGJL) or ((PersonGTJL(pid,9999, WAR.NGJL) and (JY.Thing[224]["加攻击力"]) == CC.ZGT2[i][2] or JY.Thing[224]["加防御力"]) == CC.ZGT2[i][2])) then
			hurt = hurt + CC.ZGT2[i][3]
			break
		end
	end
	--1-26-and (PersonGTJL(pid, CC.ZGT2[i][2], WAR.NGJL) or ((PersonGTJL(pid,9999, WAR.NGJL) and (JY.Thing[224]["加攻击力"]) == CC.ZGT2[i][2] or JY.Thing[224]["加防御力"]) == CC.ZGT2[i][2])) then
	for i = 1, #CC.ZGT2 do
		if (CC.ZGT2[i][1] ==  WAR.HLTX or CC.ZGT2[i][2] ==  WAR.HLTX) and (wglw(pid,102) or (DT(pid,38) and PersonKF(pid,102))) then
			hurt = hurt + CC.ZGT2[i][3]
			break
		end
	end
	--豸苗：折梅手非百分比增加伤害
	for i = 1, #CC.ZGT2 do
	    for l = 1,10 do
	    local jl = 15 + math.modf(JY.Person[pid]["实战"] / 20)+ math.modf(JY.Person[pid]["武学常识"] / 10)
	        if wugong == 14 and (JLSD(0,5+jl,pid) or (MPPD(pid)==7 and JLSD(0,15,pid))) and JY.Person[pid]["内力"] >= 7000 then
	            if JY.Person[pid]["武功" .. l] == CC.ZGT2[i][1] then
			        hurt = hurt + CC.ZGT2[i][3]
			        WAR.ZMS = 1
			        break
		        end
		    end
	    end
	end	
	for i = 1, #CC.ZGT13 do --主功体按中毒加伤害
		if (CC.ZGT13[i][1] == wugong or (T12YMZ(pid) and wugong == 112)) and (PersonGTJL(pid, CC.ZGT13[i][2], WAR.NGJL) or ((PersonGTJL(pid,9999,WAR.NGJL) and (JY.Thing[224]["加攻击力"]) == CC.ZGT13[i][2] or JY.Thing[224]["加防御力"]) == CC.ZGT13[i][2])) then
			hurt = hurt + math.modf((CC.ZGT13[i][3] / 100) * JY.Person[eid]["中毒程度"])
			break
		end
	end	
    --and (PersonGTJL(pid, CC.ZGT14[i][2], WAR.NGJL) or ((PersonGTJL(pid,9999,WAR.NGJL) and (JY.Thing[224]["加攻击力"]) == CC.ZGT14[i][2] or JY.Thing[224]["加防御力"]) == CC.ZGT14[i][2])) then
	for i = 1, #CC.ZGT14 do --主功体按内伤加伤害
		if (CC.ZGT14[i][1] == wugong or (T12YMZ(pid) and wugong == 112)) and (PersonGTJL(pid, CC.ZGT14[i][2], WAR.NGJL) or ((PersonGTJL(pid,9999,WAR.NGJL) and (JY.Thing[224]["加攻击力"]) == CC.ZGT14[i][2] or JY.Thing[224]["加防御力"]) == CC.ZGT14[i][2])) then
			hurt = hurt + math.modf((CC.ZGT14[i][3] / 100) * JY.Person[eid]["受伤程度"])
			break
		end
	end
	for i = 1, #CC.ZGT13 do --1-26
		if (CC.ZGT13[i][1] ==  WAR.HLTX or CC.ZGT13[i][2] == WAR.HLTX) and (wglw(pid,102) or (DT(pid,38) and PersonKF(pid,102))) then
			hurt = hurt + math.modf((CC.ZGT13[i][3] / 100) * JY.Person[eid]["中毒程度"])
			break
		end
	end	

	for i = 1, #CC.ZGT14 do --1-26
		if (CC.ZGT14[i][1] ==  WAR.HLTX or CC.ZGT14[i][2] == WAR.HLTX) and (wglw(pid,102) or (DT(pid,38) and PersonKF(pid,102))) then
			hurt = hurt + math.modf((CC.ZGT14[i][3] / 100) * JY.Person[eid]["受伤程度"])
			break
		end
	end
	for i = 1, #CC.ZGT13 do --豸苗：折梅手
	    for l = 1,10 do
	    local jl = 15 + math.modf(JY.Person[pid]["实战"] / 20)+ math.modf(JY.Person[pid]["武学常识"] / 10)
	        if wugong == 14 and (JLSD(0,5+jl,pid) or (MPPD(pid)==7 and JLSD(0,15,pid))) and JY.Person[pid]["内力"] >= 7000 then
	            if JY.Person[pid]["武功" .. l] == CC.ZGT13[i][1] then
			        hurt = hurt + math.modf((CC.ZGT13[i][3] / 100) * JY.Person[eid]["中毒程度"])
			        WAR.ZMS = 1
			        break
		        end
		    end
	    end	
	end

	for i = 1, #CC.ZGT14 do --豸苗：折梅手
	    for l = 1,10 do
	    local jl = 15 + math.modf(JY.Person[pid]["实战"] / 20)+ math.modf(JY.Person[pid]["武学常识"] / 10)
	        if wugong == 14 and (JLSD(0,5+jl,pid) or (MPPD(pid)==7 and JLSD(0,15,pid))) and JY.Person[pid]["内力"] >= 7000 then
	            if JY.Person[pid]["武功" .. l] == CC.ZGT14[i][1] then
			        hurt = hurt + math.modf((CC.ZGT14[i][3] / 100) * JY.Person[eid]["受伤程度"])
			        WAR.ZMS = 1
			        break
		        end
		    end
	    end	
	end
	
	if PersonGT(pid,180) then  --太虚剑意增加剑系破防
	    hurt = hurt + math.modf(JY.Person[pid]["轻功"]/4)
	elseif PersonKF(pid,180) then 
	    hurt = hurt + math.modf(JY.Person[pid]["轻功"]/6)
	end
	if (PersonGT(pid,180) or PersonGT(pid,102)) and yongjian(wugong) then   --太虚剑意增加剑系破防
	    hurt = hurt + math.modf(JY.Person[pid]["轻功"]/4)
	elseif PersonKF(pid,180) then 
	    hurt = hurt + math.modf(JY.Person[pid]["轻功"]/6)
	end
	if PersonGT(pid,181) then  --玄武真功增加全系破防
	    hurt = hurt + math.modf(JY.Person[pid]["攻击力"]/5)
	elseif PersonKF(pid,181) then 
	    hurt = hurt + math.modf(JY.Person[pid]["攻击力"]/7)
	end
	if NF(pid) and yongdao(wugong) then
		hunt = hurt + math.modf(JY.Person[pid]["轻功"]/6)
	end	
	if PersonGT(pid,182) and yongquan(wugong) and yongdao(wugong) then   --太极神功增加拳、刀系破防
		hurt = hurt + math.modf(JY.Person[pid]["轻功"]/4)
	elseif PersonKF(pid,182) then 
	    hurt = hurt + math.modf(JY.Person[pid]["轻功"]/6)
	end	
	if PersonGT(pid,183) and yongte(wugong) and yongan(wugong) then   --洗髓神功增加特、暗系破防
		hurt = hurt + math.modf(JY.Person[pid]["轻功"]/4)
	elseif PersonKF(pid,183) then 
	    hurt = hurt + math.modf(JY.Person[pid]["轻功"]/6)
	end	
    if (wglw(pid,178) or (DT(pid,69) and PersonKF(pid,178)) or T9ZY(pid) or DT(pid,602)) and WAR.KLYH == 1 then --九龙功
		local a = math.modf(ang/30)
		hurt = hurt + a
	end
    if wglw(pid,182) or (DT(pid,5) and PersonGT(pid,182)) then  --太极神功
		local ad = math.modf(ang/20)
		hurt = (hurt + ad) * 1.25
	end 		
	
	--豸苗：碧针清掌
	if DT(pid,164) and ZYJ(pid) and wugong == 18 and DWPD() then
	   if WAR.ACT == 1 then
	        hurt = hurt+math.modf(JY.Person[pid]["内力"]/60)
	   elseif WAR.ACT == 2 and WAR.KHG[eid] ~= nil then
	        hurt = hurt+math.modf(JY.Person[pid]["内力"]/40)
	   end
	end	
	
    if (wglw(pid,95) or ((DT(pid,60) or DT(pid,620))) and PersonKF(pid,95)) and WAR.L_CZJT1 == 1 then--蛤蟆九天17-2-23
	    hurt = hurt + math.modf(WAR.HMJT[pid]/10)
	    WAR.HMJT[pid] = 1000
	end
	
	if MPPD(pid) == 6 then		--密教增加伤害
        local mpdj = MPDJ(pid)
        hurt = hurt + mpdj*75
    end
	
	if MPPD(pid) == 11 or (PersonKF(pid,180) and yongjian(wugong)) then
	    if wglw(pid,592) or DT(pid,592) then 
	        if WAR.JQRZ == 2 then 
	            hurt = hurt + math.modf(JY.Person[pid]["御剑能力"]/2)
	        end
	    end
	    WAR.GQ = hurt 
	end
	
	if wugong == 60 and (wglw1(pid,60) or DT(pid,166)) then
	    WAR.GQ = hurt 
	end
	
	if wugong == 18 and WAR.TZQJ11[pid] ~= nil then
	    WAR.GQ = hurt 
	end
	
	if NF(pid) and yongdao(wugong) then
		hurt = hurt + math.modf(JY.Person[pid]["耍刀技巧"] * 0.5)
    end 
-------------------------------------我就要从这开始计算
	if WAR.BWAX[pid] ~= nil then
	    hurt = math.modf(hurt * 0.5)
	end 
		--豸苗：欧阳锋蛇毒
	if WAR.OYFSD[pid] ~= nil then 
	    hurt = math.modf(hurt * 0.8)
	end
	if WAR.MABI[pid] ~= nil then
		hurt = math.modf(hurt * 0.85)
		if WAR.MABI[pid] > 35 then
			if WAR.BZ[pid] == nil and math.random(10) > 6 then
				WAR.BZ[pid] = 1
			end	
		end
	end	
	
	if WAR.WYWX[pid] ~= nil then --17-3-1 
	    hurt = math.modf(hurt * 0.5)
	end

	for j = 0, WAR.PersonNum - 1 do --沼跃鱼：萧峰帝释天威效果--己方加防
	    if DT(WAR.Person[j]["人物编号"], 50) and (WAR.Person[j]["人物编号"]==0 or WAR.Person[j]["人物编号"]==50) and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] then
		    local aa=WAR.Person[j]["人物编号"]
		    local bb=WAR.SPIRIT[aa]
		    local cc=(math.max(bb,100)-100)/250
		    if cc>0.25 then
		        cc=0.25
		    end
		    if DT(WAR.Person[j]["人物编号"], 50) and (WAR.Person[j]["人物编号"]==0 or WAR.Person[j]["人物编号"]==50) and WAR.LQZ[WAR.Person[j]["人物编号"]]~=nil and WAR.LQZ[WAR.Person[j]["人物编号"]]==100 then
		        cc=cc*2
		    end
		    hurt = math.modf(hurt * (1-cc))
		end
	 end
	 
	for j = 0, WAR.PersonNum - 1 do --沼跃鱼：萧峰帝释天威效果--敌方减攻
	    if DT(WAR.Person[j]["人物编号"], 50) and (WAR.Person[j]["人物编号"]==0 or WAR.Person[j]["人物编号"]==50) and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
		    local aa=WAR.Person[j]["人物编号"]
		    local bb=WAR.SPIRIT[aa]
		    local cc=(math.max(bb,100)-100)/250
		    if cc>0.25 then
		        cc=0.25
		    end
		    if DT(WAR.Person[j]["人物编号"], 50) and (WAR.Person[j]["人物编号"]==0 or WAR.Person[j]["人物编号"]==50) and WAR.LQZ[WAR.Person[j]["人物编号"]]~=nil and WAR.LQZ[WAR.Person[j]["人物编号"]]==100 then
		        cc=cc*2
		    end
		    hurt = math.modf(hurt * (1-cc))
		end
	 end

    for j = 0, WAR.PersonNum - 1 do
        if txjid(WAR.Person[j]["人物编号"]) and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
			local df = WAR.Person[j]["人物编号"] 
			local offset1 = math.abs(WAR.Person[WAR.CurID]["坐标X"] - WAR.Person[j]["坐标X"]) 
            local offset2 = math.abs(WAR.Person[WAR.CurID]["坐标Y"] - WAR.Person[j]["坐标Y"])
			local offset=offset1+offset2	
			if offset1 <= 10 and offset2 <= 10 then
                local a = 20 - offset
		        hurt = math.modf(hurt*(1-a*0.03))
			end
    end
    if txjid(WAR.Person[j]["人物编号"]) and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[emenyid]["我方"] then
		local df = WAR.Person[j]["人物编号"] 
		local offset1 = math.abs(WAR.Person[emenyid]["坐标X"] - WAR.Person[j]["坐标X"]) 
        local offset2 = math.abs(WAR.Person[emenyid]["坐标Y"] - WAR.Person[j]["坐标Y"])
	    local offset=offset1+offset2	
		if offset1 <= 10 and offset2 <= 10 then
            local a = 20 - offset
			hurt = math.modf(hurt*(1+a*0.03))
		end
    end
    end
    if WAR.JTJD[pid] == 1  and JLSD(0,40,pid) then --唐门模式
       WAR.DUO = 1
    end
    if MPPD(pid) == 9 and WAR.ZXJ == 1 and (DT(pid, 93) or yongan(wugong)) then --唐门模式
        if WAR.HXB1[100+eid] ~= nil and WAR.HXB1[100+eid] > 0 then 
	        hurt = hurt + WAR.HXB1[100+eid]*5
		    WAR.HXB1[100+eid] = 50
	    end
        if WAR.HXB1[200+eid] ~= nil and WAR.HXB1[200+eid] > 0 then 
	        hurt = hurt + WAR.HXB1[200+eid]*5
            WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - WAR.HXB1[200+eid]*15;
  	        AddPersonAttrib(eid, "内力", -WAR.HXB1[200+eid]*15);
		    WAR.HXB1[200+eid] = 50
	    end	 
    end
    if MPPD(pid) == 9 and WAR.TMMS[pid] == 2 and (DT(pid, 93) or yongan(wugong)) and JLSD(10,40,pid) then --唐门模式
        if WAR.HXB1[100+eid] ~= nil and WAR.HXB1[100+eid] > 0 then 
	        hurt = hurt + WAR.HXB1[100+eid]*5
		    WAR.HXB1[100+eid] = 50
	    end
        if WAR.HXB1[200+eid] ~= nil and WAR.HXB1[200+eid] > 0 then 
	        hurt = hurt + WAR.HXB1[200+eid]*5
            WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - WAR.HXB1[200+eid]*15;
  	        AddPersonAttrib(eid, "内力", -WAR.HXB1[200+eid]*15);
		    WAR.HXB1[200+eid] = 50
	    end	 
    end
	if wugong == 18 and (DT(pid, 57) or wglw1(pid, 18)) then
		if WAR.TZST[100 + eid] ~= nil and WAR.TZST[100 + eid] > 0 then
			hurt = hurt + WAR.TZSJ[100 + eid] * 6
			WAR.TZST[100 + eid] = 50
		end 	
		if WAR.TZST[200 + eid] ~= nil and WAR.TZST[200 + eid] > 0 then
			hurt = hurt + WAR.TZST[200 + eid] * 6
			WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - WAR.TZST[200 + eid] * 15
			AddPersonAttrib(eid, "内力", -WAR.TZST[200 + eid] * 15)
			WAR.TZST[200 + eid] = 50
		end 
	end 		
	if wugong == 18 and (DT(pid, 57) or wglw1(pid, 18)) then
		if WAR.TZST[100 + eid] ~= nil and WAR.TZST[100 + eid] > 0 then
			hurt = hurt + WAR.TZST[100 + eid] * 6
			WAR.TZST[100 + eid] = 50
		end
		if WAR.TZST[200 + eid] ~= nil and WAR.TZST[200 + eid] > 0 then
			hurt = hurt + WAR.TZST[200 + eid] * 6
			WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - WAR.TZST[200 + eid] * 15
			AddPersonAttrib(eid, "内力", -WAR.TZST[200 + eid] * 15)
			WAR.TZST[200 + eid] = 50
		end 
	end 			
    if (DT(eid, 35) and JX(eid) and JLSD(15, 85, eid)) or --令狐冲 风清扬70%，剑神50%破x式
	    (DT(eid, 140)) or (wglw(eid,592) and PersonKF(eid,47)) or DT(eid,592)
	    or (eid == 0 and putong() == 2 and JLSD(15, 65, eid) 
	    and 120 <= sixi(eid, 2) and PersonKF(0, 45) and PersonKF(0, 47))  
	    and WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
        if JY.Wugong[wugong]["类型"] == 1 then
            WAR.Person[emenyid][CC.TXWZ3] = CC.WARS99
        elseif JY.Wugong[wugong]["类型"] == 2 then
            WAR.Person[emenyid][CC.TXWZ3] = CC.WARS100
        elseif JY.Wugong[wugong]["类型"] == 3 then
            WAR.Person[emenyid][CC.TXWZ3] = CC.WARS101
        elseif JY.Wugong[wugong]["类型"] == 4 then
            WAR.Person[emenyid][CC.TXWZ3] = CC.WARS102
        end
        if yongnei(wugong) then
            WAR.Person[emenyid][CC.TXWZ3] = CC.WARS103
        end
        WAR.Person[emenyid][CC.TXDH] = 83
	    local t = 4 + math.random(3)
	    if DT(eid, 140) then
		    t = t - 2
		    ang = math.modf(ang * (t / 10))
	    end
	    if wglw(eid,592) or DT(eid,592) then
		    t = t - 2
		    ang = math.modf(ang * (t / 10))
	    end
        hurt = math.modf(hurt * (t / 10))
    end
  
    for j = 0, WAR.PersonNum - 1 do
        if qunchao(WAR.Person[j]["人物编号"]) > 0
		and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
            hurt = math.modf(hurt * (1 - qunchao(WAR.Person[j]["人物编号"])))
        end
    end
  
    for j = 0, WAR.PersonNum - 1 do
        if hasTF(WAR.Person[j]["人物编号"], 70)
		and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] then
            hurt = math.modf(hurt * 0.85)
        end
    end		
  
    for j = 0, WAR.PersonNum - 1 do
        if hasTF(WAR.Person[j]["人物编号"], 72)
		and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
            hurt = math.modf(hurt * 0.85)
        end
    end	
	
    if T6XQS(eid) then --萧秋水土掩-30%
	    if WAR.XQS == 5 then
	        local neili=JY.Person[eid]["内力"]
		    hurt = math.modf(hurt * (1-(neili/12000)))
		    ang = math.modf(ang * (1-(neili/12000)))
		    if JLSD(20,20+math.modf(neili/20),eid) then
		        hurt=20
		        ang=0
	            WAR.Person[emenyid][CC.TXWZ1] = "忘情天书・土掩・玄武磐石"
	            WAR.Person[emenyid][CC.TXDH] = 39
		    end
	    end
    end
  	if WAR.WXQQ[pid] == 1 then 
	    hurt = math.modf(hurt * 0.3)
	    WAR.Person[emenyid][CC.TXWZ1] = "化气・无形气墙"
	    WAR.Person[emenyid][CC.TXDH] = 39
	end

	if WAR.DPLX[pid] == 1 then 
	    local fhurt=hurt
	    hurt = 0
	    ang = 0
	    JY.Person[eid]["内力"]=JY.Person[eid]["内力"]+fhurt*5
	    JY.Person[pid]["内力"]=JY.Person[pid]["内力"]-fhurt*5
	    WAR.Person[emenyid][CC.TXWZ1] = "逍遥鹏飞・大鹏逆袭"
	    WAR.Person[emenyid][CC.TXDH] = 109
	end
	
    if WAR.XLDL[pid] == 1 and hurt > 0 then 
  	    hurt = math.modf(hurt * 0.5)
	    ang = math.modf(ang * 0.5)
		WAR.LQZ[eid] = 100
		WAR.FXDS[eid] = nil
		WAR.LXZT[eid] = nil
		WAR.CHZ[eid] = nil
		JY.Person[eid]["受伤程度"] = 0
		JY.Person[eid]["中毒程度"] = 0
  		WAR.Person[emenyid][CC.TXDH] = 140
		WAR.Person[emenyid][CC.TXWZ1] = "擒龙・九龙护体"
    end
    --主角刀系，防御加成5%
    --东方未明刀法防御加成5%
    if (putong() == 3 and eid == 0) or T7DFWM(eid) then
        local askd = wgnumber(eid, 3)
        hurt = math.modf(hurt * (1 - 0.05 * (askd)))
    end    
  
    if MPPD(eid) == 13 then --沼跃鱼：明教防御效果
        local p = JY.Person[eid]
        local tymj2 = p["内力"]
	    if tymj2 >= 7000 then
            hurt = math.modf(hurt * 0.8)
	    elseif tymj2 >= 5000 then
	        hurt = math.modf(hurt * 0.85)
	    elseif tymj2 >= 3000 then
	        hurt = math.modf(hurt * 0.9)	  
	    elseif tymj2 >= 1000 then
	        hurt = math.modf(hurt * 0.95)
	    end
    end 

    if MPPD(eid) == 4 then --武当防御+15%
	    hurt = math.modf(hurt * 0.85)
    end
  
	if hasTF(eid, 49) and WAR.SEVENSTAR[pid] ~= nil and WAR.SEVENSTAR[pid] <= 1 then
		hurt = math.modf(hurt * 0.8)		
	end
	if hasTF(eid, 50) and WAR.SEVENSTAR[pid] ~= nil and WAR.SEVENSTAR[pid] > 1 then
		hurt = math.modf(hurt * 0.8)		
	end	
	
    if (wglw1(pid,38) or (PersonGT(pid,6) and DT(pid,57) and JX(pid))) and yongjian(wugong) then--玉萧领悟
	    local aa=math.modf(JY.Person[eid]["内力"]*0.1)
	    local bb=math.modf(JY.Person[eid]["内力最大值"]*0.1)
	    local bb1=math.modf((bb-aa)*0.7)
	    local cc=math.modf(JY.Person[pid]["内力"]*0.05)
	    hurt = hurt+bb1+cc
	    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - aa;
  	    AddPersonAttrib(eid, "内力", -aa);
	end
	
    if wglw1(pid,155) and yongdao(wugong) or DT(pid,665) then--五指秘刀领悟
	    local cc=math.modf(JY.Person[pid]["内力"]*0.1)
	    hurt = hurt+cc
	end
	
	if WAR.JGZH==3  then
	    hurt = hurt+math.modf(sixi(pid,1)*0.2)
	   	if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+".. "乱击之殇"
		else
			WAR.Person[emenyid][CC.TXWZ2] = "乱击之殇"
		end
	end
	
	if WAR.JGZH==2  then
	    WAR.LHZF[eid]=WAR.LHZF[eid] or 0 + 1
		local aa=WAR.LXZT[eid] or 0 + JY.Person[eid]["受伤程度"]
		WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -2*aa)
		WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -10*aa)
		if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+".. "百花缭乱"
		else
			WAR.Person[emenyid][CC.TXWZ2] = "百花缭乱"
		end
			WAR.Person[emenyid][CC.TXDH] = 53
	end
	
	if WAR.JGZH==1  then
	    local cc2=math.modf(JY.Person[pid]["内力"]*0.1)
	    ang = ang + cc2
	    hurt = hurt+math.modf(ang*0.2)
	    if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+".. "雷霆一拳"
		else
			WAR.Person[emenyid][CC.TXWZ2] = "雷霆一拳"
		end
			WAR.Person[emenyid][CC.TXDH] = 53
	end
	
	if WAR.CYYJ == 1 then
        local cc=math.modf(JY.Person[pid]["内力"]*0.1)
	    hurt = hurt+cc
	    ang = ang + math.modf(cc*3)
    end
	
	if wglw1(pid,12) and WAR.LYBF==1  then
	    WAR.LHZF[eid]=WAR.LHZF[eid] or 0 + 1
	end
	
	if (wglw1(pid,77) or ((DT(pid,605) or (DT(pid,627)))and JX(pid))) and WAR.DZDJ1==1  then
	    WAR.LHZF[eid]=WAR.LHZF[eid] or 0 + 1
	end
	
	if (wglw1(pid,77) or ((DT(pid,605) or (DT(pid,627)))and JX(pid))) and WAR.DZDJ2==1  then
	    WAR.SJTH[eid]=WAR.SJTH[eid] or 0 + 1
	end
	
	if (wglw1(pid,77) or ((DT(pid,605) or (DT(pid,627)))and JX(pid))) and WAR.DZDJ1==3  then
	    WAR.HDGX[eid]=WAR.HDGX[eid] or 0 + 1
	end
	
	if (wglw1(pid,77) or ((DT(pid,605) or (DT(pid,627)))and JX(pid))) and WAR.DZDJ2==2 then
	    WAR.YHZJ[eid]=WAR.YHZJ[eid] or 0 + 1
	end
	
	if (wglw1(pid,77) or ((DT(pid,605) or (DT(pid,627)))and JX(pid))) and WAR.DZDJ2==3 then
        local aa=WAR.LXZT[eid] or 0 + JY.Person[eid]["受伤程度"]
	    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -2*aa)
		WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -10*aa)
	end
	
	if wglw1(pid,12) and WAR.LYBF==2 then
	    WAR.SJTH[eid]=WAR.SJTH[eid] or 0 + 1
	end
	
	if wglw1(pid,12) and WAR.LYBF==3  then
	    WAR.DLYZ[eid]=WAR.DLYZ[eid] or 0 + 1
	    WAR.LYXJ[eid]=WAR.LYXJ[eid] or 0 + 1
	end
	
	if PersonGT(pid,6) and DT(pid,57) and JX(pid) and WAR.LYBF==3 then
	    WAR.LYXJ[eid]=WAR.LYXJ[eid] or 0 + 1
	    local cc=math.modf(JY.Person[pid]["内力"]*0.1)
	    hurt = hurt+cc
	end
	
	if PersonGT(pid,6) and DT(pid,57) and JX(pid) and WAR.LYBF==2 then
	    local cc=math.modf(JY.Person[pid]["内力"]*0.25)
	    local cc2=math.modf(JY.Person[pid]["内力"]*0.1)
	    local dd=math.modf(cc*0.01)
	    ang = ang + cc
	    hurt = hurt+cc2
	    WAR.CYSH[eid] = WAR.CYSH[eid] or 0 + dd
	end
	
    if WAR.XSJS == 1 then	
        local ad = math.modf(JY.Person[pid]["内力"] * 0.05)
	    hurt = hurt + ad
	    ang = ang + math.modf(ad * 2)
	end 		    	
	
	if WAR.LMSJ==1 or WAR.LMSJ==7 then----少商剑
	    local cc=math.modf(JY.Person[pid]["攻击力"]*0.25)
	    ang = ang + cc
	    hurt = hurt+cc
	end
	
	if WAR.LMSJ==6 or WAR.LMSJ==7 then----少泽剑
	    WAR.GTSHAQI = math.modf(hurt*0.25)
	end
	
	if WAR.LMSJ==3 or WAR.LMSJ==7 then----中冲剑
	    local cc=math.modf(JY.Person[pid]["内力"]*0.25)
	    local cc2=math.modf(JY.Person[pid]["内力"]*0.1)
	    ang = ang + cc
	    hurt = hurt+cc2
	end
	
	if WAR.LMSJ==2 or WAR.LMSJ==7 then----商阳剑
        WAR.GTJIQI=WAR.GTJIQI+math.modf(hurt*0.5)
	    WAR.GTPID = pid
	end
	
	if WAR.LMSJ==4 or WAR.LMSJ==7 then----关冲剑
	    local cc=math.modf(JY.Person[pid]["防御力"]*0.25)
	    ang = ang + cc
	    hurt = hurt+cc
	end
	
	if WAR.LMSJ==5 or WAR.LMSJ==7 then----少冲剑
	    local cc=math.modf(JY.Person[pid]["轻功"]*0.25)
	    ang = ang + cc
	    hurt = hurt+cc
	end
	
	local jl=20+math.modf(sixi(pid,2)/10)
	if J1ZBF(pid) and yongjian(wugong) and JLSD(10,jl,pid) then----剑芒
	    local cc=math.modf(JY.Person[pid]["内力"]*0.25)
	    local cc2=math.modf(JY.Person[pid]["内力"]*0.1)
	    ang = ang + cc
	    hurt = hurt+cc2
	    if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
    	    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "一字慧剑・剑芒"
        else
    	    WAR.Person[emenyid][CC.TXWZ2] = "一字慧剑・剑芒"
        end	
	end
	
	if WAR.LMSJ>0 and WAR.SEVENSTAR[pid] ~= nil then----少商剑
        hurt = math.modf(hurt * (1+0.25*WAR.SEVENSTAR[pid]*WAR.LMSJ))
	end
	
	if WAR.LMSJ==7 and DT(pid, 602) and WAR.SEVENSTAR[pid] ~= nil then----六脉齐发
        hurt = math.modf(hurt * (6/(7-WAR.SEVENSTAR[pid])))
	end
	
	if wglw1(pid,12) and WAR.LYBF>=1  and WAR.SEVENSTAR[pid] ~= nil and WAR.SEVENSTAR[pid] > 1 then
	    hurt = math.modf(hurt * (1+0.25*WAR.SEVENSTAR[pid]*WAR.LYBF))
	end
	
	if wglw1(pid,12) and WAR.LYBF>=1  and WAR.SEVENSTAR[pid] ~= nil and WAR.SEVENSTAR[pid] <=1 then
	    hurt = math.modf(hurt * (1+WAR.LYBF))
	end
	
	if (wglw1(pid,43) or (DT(pid,113) and JX(pid))) and WAR.DZXY==1  then
	   local dzlv=math.modf((sixi(pid,1)+sixi(pid,2)+sixi(pid,3)+sixi(pid,4)+sixi(pid,5))*0.15)
	   local jiali= math.modf(JY.Person[pid]["内力"]/10)
	   hurt = hurt+dzlv+jiali
	end
	
	if wglw1(pid,38) and WAR.YXMQ>=1  and WAR.SEVENSTAR[pid] ~= nil and WAR.SEVENSTAR[pid] > 1 then
	    hurt = math.modf(hurt * (1+0.25*WAR.SEVENSTAR[pid]*WAR.YXMQ))
	end
	
	if wglw1(pid,38) and WAR.YXMQ>=1  and WAR.SEVENSTAR[pid] ~= nil and WAR.SEVENSTAR[pid] <=1 then
	    hurt = math.modf(hurt * (1+WAR.YXMQ))
	end
	
		--独孤求败，极意时另外计算
 	if WAR.L_DGQB_X >= 10 and DT(pid , 592) then
		if JY.Person[eid]["生命"] >= 500 then
			hurt = JY.Person[eid]["生命"] - 1;
			--JY.Person[eid]["生命"] = 1;
			if WAR.PJTX == 1 then 
			hurt = hurt +math.modf(JY.Person[eid]["生命最大值"]*0.1)
			--JY.Person[eid]["生命"] = JY.Person[eid]["生命"]- hurt 
			end
			--JY.Person[eid]["生命"] = JY.Person[eid]["生命"]- hurt 
		else
			hurt = JY.Person[eid]["生命"];
			--JY.Person[eid]["生命"] = 0;	
		end	
	elseif XYL(pid) then  --豸苗：谢云流另外计算
	    if WAR.L_JHGC == 1 then 
			hurt = hurt + 100;
		end	
		if XYL(pid) and WAR.DR[eid]~= nil and WAR.DR[eid]> 0 and WAR.DR_X[eid]~= nil and WAR.XYLCZ == 4 then
            if WAR.DR_X[eid]>5 then
	            WAR.DR_X[eid]=5
	        end
            hurt = hurt + WAR.DR_X[eid]*WAR.DR[eid]*2
		end   

		   WAR.DR_X[eid] = nil 
		   WAR.DR[eid] = nil
		   
	--飞影彩蛋：真龙心法增加伤害
	elseif PersonKF(pid, 91) and inteam(pid) and JY.ZLXF == 1 then
		WAR.WS = 1
		local lwjl = math.modf(((JY.Person[pid]["生命最大值"] - JY.Person[pid]["生命"]) / JY.Person[pid]["生命最大值"]) * 100)
		if JLSD(10,20+lwjl,pid) then
			hurt = hurt + math.modf(JY.Person[eid]["内力"] * 0.05)
			JY.Person[eid]["生命"] = JY.Person[eid]["生命"] - hurt
			WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) - hurt 
			if WAR.Person[emenyid][CC.TXWZ3] == nil then
				WAR.Person[emenyid][CC.TXWZ3] = "【真龙破灭击】"
			else
				WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."【真龙破灭击】"
			end
		else

		end
		
	--安七
	elseif DT(pid,456) then
		WAR.WS = 1
		local lwjl = math.modf(((JY.Person[pid]["生命最大值"] - JY.Person[pid]["生命"]) / JY.Person[pid]["生命最大值"]) * 100)
		if JLSD(10,20+lwjl,pid) then
			hurt = hurt + math.modf(JY.Person[eid]["内力"] * 0.05)
			JY.Person[eid]["生命"] = JY.Person[eid]["生命"] - hurt
			if WAR.Person[emenyid][CC.TXWZ3] == nil then
				WAR.Person[emenyid][CC.TXWZ3] = "【真龙破灭击】"
			else
				WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."【真龙破灭击】"
			end
		else

		end	
		   
	elseif DT(pid,614) and wugong == 123 then --12-29-一人一竹
	    local yj = math.modf(limitX((sixi(pid,2)/10 + WGWL(pid,wugong,level)*0.05),50,350))
	    hurt = hurt + yj
	elseif DT(pid,5) and (pid == 0 or pid == 5) and WAR.TLHS == 2 then  ----
	    local a = JY.Person[eid]["生命"]/JY.Person[eid]["生命最大值"]
	    local b = JY.Person[eid]["内力"]/JY.Person[eid]["内力最大值"]	  
	    local c = math.abs(a-b)
	    if a < b then 
            WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -math.modf(c*JY.Person[eid]["内力最大值"]));
	    end
	    if b < a then 
	        hurt = hurt + math.modf(c*JY.Person[eid]["生命最大值"])
	    end
        WAR.TLHS = 0
	elseif DT(pid,592) and WAR.PJTX == 1 then ----
		hurt = hurt +math.modf(JY.Person[eid]["生命最大值"]*0.1)
	elseif jtyl(pid) and (WAR.JTYL == 8 or WAR.JTYL == 9) and ssym == 2 and not jtyl(eid) then --谢无悠
	    hurt = hurt + math.modf(ssym1*JY.Person[eid]["生命"]/2)
	end
	
    if wglw1(eid,12) then
	    local aa=math.modf(hurt * 0.2*0.65)	
	    hurt = math.modf(hurt * 0.8)	
	   	WAR.LXXS[pid] = 1
		WAR.LXZT[pid] = WAR.LXZT[pid] or 0+aa
		if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
    	    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "落英剑意护体"
        else
    	    WAR.Person[emenyid][CC.TXWZ2] = "落英剑意护体"
        end	
	end
	
	if hasTF(eid, 132) and DWPD() then
		hurt = math.modf(hurt * 0.5)		
	end			
	
	if hasTF(eid, 122) and DWPD() then
		hurt = math.modf(hurt * 0.5)		
	end	
	
    if WAR.QFY3[eid] ~= nil and WAR.QFY3[eid] > 0 and DWPD() then --空山鸣涧伤害-20%
	    hurt = math.modf(hurt * 0.8)
        --[[if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
    	  WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "空山鸣涧・防御上升"
        else
    	  WAR.Person[emenyid][CC.TXWZ2] = "空山鸣涧・防御上升"
        end	]]
	      --WAR.QFY3[eid] = nil
    end 
  
    --风花小雪
    if FHXX(eid) then 
        local fhxy = 10
        for i = 1,HHH_GAME_SETTING["WG_COUNT_MAX"] do 
            if JY.Person[eid]["武功"..i] > 0 then 
                fhxy = fhxy -1 
            end
       end
       hurt = math.modf(hurt*(1-fhxy*0.1))
    end

    if DT(eid,583) then
		hurt = math.modf(hurt * 1)
	end	

    ---崆峒弟子减伤
	if MPPD(eid) == 18 then
		hurt = math.modf(hurt * 0.75)
	end	

    --葵花套件
    if KHTZF(eid) then
		hurt = math.modf(hurt * 0.5)
	end		

    if PersonGT(eid, 151) then
	    hurt = math.modf(hurt * 0.85)
    elseif PersonKF(eid, 151) then --金刚不坏减少10%伤害
	    hurt = math.modf(hurt * 0.9)	
    end
  
    --瑜伽密乘减伤
    if PersonGT(eid, 184) then
	    hurt = math.modf(hurt * 0.5)
    elseif PersonKF(eid, 184) then 
	    hurt = math.modf(hurt * 0.4)	
    end

    if wglw(eid,106) or (DT(eid,9) and PersonGT(eid,106)) then --九阳领悟后伤害减少一半
	    hurt = math.modf(hurt * 0.5)
	    if WAR.Person[emenyid][CC.TXWZ3] == nil then
		    WAR.Person[emenyid][CC.TXWZ3] = "他自狠来他自恶・我自一口真气足"
	    else
		    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."+他自狠来他自恶・我自一口真气足"
	    end
    end	

    --欧阳锋  队友伤害减少
    if DT(pid, 60) and WAR.ZDDH == 171 then
        hurt = math.modf(hurt * 0.75)
    end
 
    if WAR.tmp[1000 + eid] == 1 then
        hurt = hurt * 0.7
    end
    --brolycjw: 木岛主
    if DT(eid , 40) then
        hurt = hurt * 0.8
    end

    if (DT(eid, 44)) and JY.Person[0]["品德"] < 30 then --岳老三品德越低防御越高
        hurt = (1 - (30 - JY.Person[0]["品德"]) / 100) * hurt
    end  
 
    if wglw1(eid,63) then
        if WAR.LXZT[eid]~=nil then
	        local aa= WAR.LXZT[eid]
	        hurt = math.modf(hurt * (1-(WAR.LXZT[eid]/200)))
	        WAR.XQFJ[pid]=WAR.XQFJ[pid] or 0 + aa
	    end
	    effect(47,"特效文字1","血神.血盾御敌",500,0)
    end
  
    if eid==0 and putong() == 9 and math.random(10)<=5 then --血手50%以自身流血值抵伤害	
	    if WAR.LXZT[0]==nil then
		    WAR.LXZT[0]=math.modf(hurt/5)
	    else
		    WAR.LXZT[0]=WAR.LXZT[0]+math.modf(hurt/5)
	    end
	    hurt = math.modf(hurt/2)
	    effect(47,"特效文字1","以血还血",500,0)
    end  
  
    hurt = math.modf(hurt) 
  
    --洗髓经消除迟缓、流血、冰封、灼烧
	if PersonGT(eid,183) then
	    WAR.WS = 1;
	    for i = 0, CC.WarWidth - 1 do
	        for j = 0, CC.WarHeight - 1 do
	            local effect = GetWarMap(i, j, 4)
	            if 0 < effect then
	                local emeny = GetWarMap(i, j, 2)
	    			if 0 <= emeny and WAR.Person[emeny]["我方"] == WAR.Person[emeny]["我方"] and emeny ~= WAR.CurID then
	    				local tp = WAR.Person[emeny]["人物编号"];
	    				WAR.CHZ[tp] = nil
					    WAR.LXZT[tp] = nil
						WAR.ICE[tp] = nil
		                WAR.HOT[tp] = nil
	    				SetWarMap(i, j, 4, 2)
	    			end
	    		end
	    	end
	    end
	end

    if wglw(pid,188) or (DT(pid,48) and PersonGT(pid,188)) then  --神足经
		WAR.WS = 1;
	    for i = 0, CC.WarWidth - 1 do
	        for j = 0, CC.WarHeight - 1 do
	            local effect = GetWarMap(i, j, 4)
	            if 0 < effect then
	                local emeny = GetWarMap(i, j, 2)
	    			if 0 <= emeny and WAR.Person[emeny]["我方"] == WAR.Person[emeny]["我方"] and emeny ~= WAR.CurID then
	    				local tp = WAR.Person[emeny]["人物编号"];
	    				WAR.CHZ[tp] = nil
					    WAR.LXZT[tp] = nil
						WAR.ICE[tp] = nil
		                WAR.HOT[tp] = nil
	    				SetWarMap(i, j, 4, 2)
	    			end
	    		end
	    	end
	    end
	end

    --蓝烟清：田伯光，使用戒色指令后减少伤害和增加气防
    if DT3(eid , 29) and WAR.L_TBGZL == 2 then
  	    if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
  		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "・不可不戒"
  	    else
  		   WAR.Person[emenyid][CC.TXWZ2] = "不可不戒"
  	    end
  	       hurt = hurt * 0.9
  	       dng = dng + 500;
    end
    if WAR.tmp[1000 + eid] == 1 then
        hurt = hurt * 0.7
    end
    --brolycjw: 木岛主
    if DT(eid , 40) then
        hurt = hurt * 0.8
    end

    if ((MPPD(eid) == 12 and PersonKF(eid,88) and not PersonGT(eid,105) and GetS(54,0,0,1) == 1) or DT(eid,26)) and MPDJ(eid) > 1 then
        hurt = hurt * 0.5 - 200
  	    dng = dng + 800;
		if WAR.Person[emenyid][CC.TXWZ1] ~= nil then
  		    WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .."+".."星落云散"
  	    else
  		   WAR.Person[emenyid][CC.TXWZ1] = "星落云散"
  	    end
	end	

    if (DT(eid , 44)) and JY.Person[0]["品德"] < 30 then --岳老三品德越低防御越高
        hurt = (1 - (30 - JY.Person[0]["品德"]) / 100) * hurt
    end  

    if (MPPD(eid) == 17 and JY.Person[0]["品德"] > 50) or (GX(eid) and JX(eid)) then --峨眉派品德越高防御越高
        hurt = (1 - (30 - JY.Person[0]["品德"]) / 100) * hurt
    end  

    if wglw1(eid,63) then
        if WAR.LXZT[eid]~=nil then
	        local aa= WAR.LXZT[eid]
		    hurt = math.modf(hurt * (1-(WAR.LXZT[eid]/200)))
		    WAR.XQFJ[pid]=WAR.XQFJ[pid] or 0 + aa
	    end
	    effect(47,"特效文字1","血神.血盾御敌",500,0)
    end
  
    if eid==0 and putong() == 9 and math.random(10)<=5 then --血手50%以自身流血值抵伤害	
	    if WAR.LXZT[0]==nil then
		    WAR.LXZT[0]=math.modf(hurt/5)
	    else
		    WAR.LXZT[0]=WAR.LXZT[0]+math.modf(hurt/5)
	    end
	    hurt = math.modf(hurt/2)
	    effect(47,"特效文字1","以血还血",500,0)
    end  
  
    --蓝烟清：田伯光，使用戒色指令后减少伤害和增加气防
    if DT3(eid , 29) and WAR.L_TBGZL == 2 then
  	    if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
  		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "・不可不戒"
  	    else
  		    WAR.Person[emenyid][CC.TXWZ2] = "不可不戒"
  	    end
  	    hurt = hurt * 0.9
  	    dng = dng + 500;
    end
  
    if WAR.ZBX[eid] ~= nil then --醉八仙伤害/2
	    hurt = math.modf(hurt * 0.5)
    end  
	if getHZ(eid, 7) then   --多情符    
		if JY.Person[pid]["性别"] ~= JY.Person[eid]["性别"] then
			hurt = math.modf(hurt * 0.8)
		end
	end  	
  
	if hasTF(eid, 32) then
		if JY.Person[pid]["性别"] ~= JY.Person[eid]["性别"] then
			hurt = math.modf(hurt * 0.5)
		end	
	end
  
	if hasTF(eid, 41) then
		if JY.Person[pid]["性别"] ~= JY.Person[eid]["性别"] then
			hurt = math.modf(hurt * 0.7)
		end	
	end
  	if JX(eid) and DT(eid, 49) and JLSD(20, 70, eid)  then     
	    hurt = math.modf(hurt * (1-0.0003*(sixi(eid,5)+sixi(eid,1))))
	    WAR.TZ_XZ_SSH[eid]=WAR.TZ_XZ_SSH[eid] or 0 + 1
	    WAR.TZ_XZ_SSH2[eid]=WAR.TZ_XZ_SSH2[eid] or 0 + 2
	    if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "幽冥夜叉.睚眦必报"
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "幽冥夜叉.睚眦必报"
	    end
    end
   
    if DT(eid, 615) then --达摩减伤害	
	    local aa = JY.Person[eid]["生命最大值"]
	    local bb = JY.Person[eid]["生命"]
	    local cc = limitX((aa - bb) / 50, 0, 50)
	    cc = cc / 100
	    hurt = math.modf(hurt * (1 - cc))
    end
  
	if WAR.LWZN[eid] ~= nil and WAR.LWZN[eid] > 0 then --血龙
	    local YNWG = {}
	    local ynwg = 0
	    for i = 0, JY.ThingNum - 1 do
		    if JY.Thing[i]["需内力性质"] == 1 then
			    ynwg = ynwg + 1
			    YNWG[ynwg] = JY.Thing[i]["练出武功"]
		    end
	    end
	    for i = 1, #YNWG do
            if wugong == YNWG[i] then 
	            hurt = math.modf(hurt * (1 + WAR.LWZN[eid]*0.1))
	        end  
        end
	    --hurt = math.modf(hurt * (1 + WAR.LWZN[eid]*0.1))
	end

	if WAR.HYDX[eid] ~= nil and WAR.HYDX[eid] > 0 then --血龙
	    local YNWG = {}
	    local ynwg = 0
	    for i = 0, JY.ThingNum - 1 do
		    if JY.Thing[i]["需内力性质"] == 1 then
			    ynwg = ynwg + 1
			    YNWG[ynwg] = JY.Thing[i]["练出武功"]
		    end
	    end
	    for i = 1, #YNWG do
            if wugong == YNWG[i] then 
	            hurt = math.modf(hurt * (1 + WAR.HYDX[eid]*0.1))
	        end  
        end
	    --hurt = math.modf(hurt * (1 + WAR.LWZN[eid]*0.1))
	end		
	
	--洗髓减伤
    if PersonKF(eid,183) and JLSD(10,30,eid) then	
		if hurt > 600 then
	        hurt = 600
		end 	
		if PersonGT(eid,183) then	
			if hurt > 500 then
	            hurt = 500
			end	
		end
		WAR.Person[emenyid][CC.TXWZ1] = "吹嘘呼吸"	
	end 	
	
    if MPPD(eid)==15 and hurt > 0 and PersonGTHT(eid,152,WAR.NGHT) and JY.Person[eid]["内力"] >= 5000 then --沼跃鱼：大理天南护体
        WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - math.modf(hurt *0.5);
  	    AddPersonAttrib(eid, "内力", -math.modf(hurt * 0.5));
	    hurt = math.modf(hurt*0.5)
  	    if WAR.Person[emenyid][CC.TXWZ3] == nil then
		    WAR.Person[emenyid][CC.TXWZ3] = "大理天南・龙脉代谢"
	    else
		    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "大理天南・龙脉代谢"
	    end
	    WAR.Person[emenyid][CC.TXDH] = 39	
    end
  
    if DT(eid,602) and hurt > 0 and JY.Person[eid]["内力"] >= 5000 then
        WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - math.modf(hurt *0.5);
  	    AddPersonAttrib(eid, "内力", -math.modf(hurt * 0.5));
	    hurt = math.modf(hurt*0.5)
  	    WAR.Person[emenyid][CC.TXWZ3] = "大理天南・龙脉代谢"
	    WAR.Person[emenyid][CC.TXDH] = 39	
    end

    if (wglw(eid,152) or DT(eid, 102) or DT(eid, 65)) and hurt > 0 and PersonGT(eid,152) and JY.Person[eid]["内力"] >= 5000 then --沼跃鱼：大理天南护体
        WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - hurt;
  	    AddPersonAttrib(eid, "内力", -hurt);
	    hurt = 0
	    WAR.GTSHAQI=-WAR.GTSHAQI
	    --local aa=;
	    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", math.random(50,150))
  	    if WAR.Person[emenyid][CC.TXWZ3] == nil then
		    WAR.Person[emenyid][CC.TXWZ3] = "易阳真诀・气脉御心"
	    else
		    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "易阳真诀・气脉御心"
	    end
	        WAR.Person[emenyid][CC.TXDH] = 43	
    end
  
    if DT(eid, 602) and hurt > 0 and JY.Person[eid]["内力"] >= 5000 then 
        WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - hurt;
  	    AddPersonAttrib(eid, "内力", -hurt);
	    hurt = 0
	    WAR.GTSHAQI=-WAR.GTSHAQI
	    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", math.random(50,150))
	    if WAR.Person[emenyid][CC.TXWZ3] == nil then
		    WAR.Person[emenyid][CC.TXWZ3] = "真・易阳真诀・气脉御心"
	    else
		    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "真・易阳真诀・气脉御心"
	    end
	    WAR.Person[emenyid][CC.TXDH] = 43	
    end
  
    if DT(eid, 102) and hurt > 0 and JY.Person[eid]["内力"] >= math.modf(hurt * 2) and 
	    DWPD() and JLSD(10, 40, eid) and DT(eid, 602) then
  	    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - math.modf(hurt * 2);
  	    AddPersonAttrib(eid, "内力", -math.modf(hurt * 2));
	    hurt = 0
	    if WAR.Person[emenyid][CC.TXWZ3] == nil then
		    WAR.Person[emenyid][CC.TXWZ3] = "双树枯荣"
	    else
		    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "双树枯荣"
	    end
	    WAR.Person[emenyid][CC.TXDH] = 39	
    end  
	
	--飞影彩蛋：真龙心法防御效果
	if PersonKF(eid, 91) and inteam(eid) and hurt > 0 and JY.ZLXF == 1 then
		local sbjl = math.modf(((JY.Person[eid]["生命最大值"] - JY.Person[eid]["生命"]) / JY.Person[eid]["生命最大值"]) * 100)
		if JLSD(10, 20+sbjl, eid) then
			hurt = 0
			if WAR.Person[emenyid][CC.TXWZ3] == nil then
				WAR.Person[emenyid][CC.TXWZ3] = "【游龙身法】"
			else
				WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "【游龙身法】"
			end
		elseif hurt > JY.Person[eid]["生命"] and JY.Person[eid]["生命"] > 10 then
			hurt = JY.Person[eid]["生命"] - 10
			if WAR.Person[emenyid][CC.TXWZ3] == nil then
				WAR.Person[emenyid][CC.TXWZ3] = "【不死真龙】"
			else
				WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "【不死真龙】"
			end
		end
	end
	
    --安七
	if DT(eid,456) then
		local sbjl = math.modf(((JY.Person[eid]["生命最大值"] - JY.Person[eid]["生命"]) / JY.Person[eid]["生命最大值"]) * 100)
		if JLSD(10, 20+sbjl, eid) then
			hurt = 0
			if WAR.Person[emenyid][CC.TXWZ3] == nil then
				WAR.Person[emenyid][CC.TXWZ3] = "【游龙身法】"
			else
				WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "【游龙身法】"
			end
		elseif hurt > JY.Person[eid]["生命"] and JY.Person[eid]["生命"] > 10 then
			hurt = JY.Person[eid]["生命"] - 10
			if WAR.Person[emenyid][CC.TXWZ3] == nil then
				WAR.Person[emenyid][CC.TXWZ3] = "【不死真龙】"
			else
				WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "【不死真龙】"
			end
		end
	end	
	
	if DWPD() and PersonGT(eid, 107) and PersonKF(eid, 87) then --阴邪逆转
		local jj = math.modf(JY.Person[eid]["实战"] / 25)
		if JLSD(10, 25 + jj, eid) then
			SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 4, 5)
			WAR.Person[WAR.CurID]["中毒点数"] = (WAR.Person[WAR.CurID]["中毒点数"] or 0) + AddPersonAttrib(pid, "中毒程度", math.random(3, 12))
			--local xnl3 = math.modf(JY.Person[pid]["中毒程度"] / 2 + math.random(30))
			--hurt = hurt - xnl3
			local bl = Rnd(3) + 2
			local n = AddPersonAttrib(pid, "体力", -bl)
			local m = AddPersonAttrib(eid, "体力", bl)
			WAR.Person[WAR.CurID]["体力点数"] = (WAR.Person[WAR.CurID]["体力点数"] or 0) + n
			WAR.Person[emenyid]["体力点数"] = (WAR.Person[emenyid]["体力点数"] or 0) + m			
			WAR.Person[emenyid][CC.TXDH] = 6
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+阴邪逆转"    
			else
				WAR.Person[emenyid][CC.TXWZ2] = "阴邪逆转"
			end  	
		end
	end    
  
  	if DWPD() and MPPD(eid)==1  and PersonKF(eid, 87) then --阴邪逆转
		local jj = MPDJ(eid)*10
		if JLSD(10, 25 + jj, eid) then
			SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 4, 5)
			WAR.Person[WAR.CurID]["中毒点数"] = (WAR.Person[WAR.CurID]["中毒点数"] or 0) + AddPersonAttrib(pid, "中毒程度", math.random(jj-5, jj+5))
			--local xnl3 = math.modf(JY.Person[pid]["中毒程度"] / 2 + math.random(30))
			--hurt = hurt - xnl3
			local bl = math.modf((jj + 2)*20)
			local n = AddPersonAttrib(pid, "内力", -bl)
			local m = AddPersonAttrib(eid, "内力", bl)
			local bl2 = math.modf((jj + 2)*4)
			local n1 = AddPersonAttrib(pid, "生命", -bl2)
			local m1 = AddPersonAttrib(eid, "生命", bl2)
			WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + n1
			WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + m1
			WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + n
			WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + m			
			WAR.Person[emenyid][CC.TXDH] = 40
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+神木毒髓.邪毒侵袭"    
			else
				WAR.Person[emenyid][CC.TXWZ2] = "神木毒髓.邪毒侵袭"
			end  	
		end
	end  
  
    --瑜伽密乘减伤伤害
	if PersonGT(eid,184) or DT(eid,665) then
		hurt = hurt - 300
		if PersonKF(eid,184) then
			hurt = hurt - 200
		end
	end
  
    --崆峒拳系高级弟子
	if MPPD(eid) == 18 and MPDJ(eid) >= 3 and PersonGT(eid,189) then
		local a = JY.Person[pid]["拳掌功夫"] / 2
		hurt = hurt - a
	end	

    --崆峒特系高级弟子
	if MPPD(eid) == 18 and MPDJ(eid) >= 3 and PersonGT(eid,189) then
		local a = JY.Person[pid]["特殊兵器"] / 2
		hurt = hurt - a
	end	
	
	--崆峒暗系高级弟子
	if MPPD(eid) == 18 and MPDJ(eid) >= 3 and PersonGT(eid,189) then
		local a = JY.Person[pid]["暗器技巧"] / 2
		hurt = hurt - a
	end	

    if DT(eid,4) and JX(eid) then
        local aa=math.modf(JY.Person[eid]["用毒能力"]/100)
	    local str=""
  	    if JLSD(10,30+aa*15,eid) then
	        if JLSD(10,30+aa*15,eid) then
	            WAR.QSLZ[pid]=WAR.QSLZ[pid] or 0+1
	            local str="・金丝蟾酥"
	        end
            SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 4, 5)
	        WAR.Person[WAR.CurID]["中毒点数"] = (WAR.Person[WAR.CurID]["中毒点数"] or 0) + AddPersonAttrib(pid, "中毒程度", math.random(aa*10-5, aa*10+5))
	        if WAR.Person[emenyid][CC.TXWZ3] == nil then
		        WAR.Person[emenyid][CC.TXWZ3] = "千金毒方・暗送无常"..str
	        else
		        WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "千金毒方・暗送无常"..str
	        end	
	        WAR.Person[emenyid][CC.TXDH] = 47
	    end
    end
  
    if DWPD() and DT(eid,2)  and JX(eid) then --程灵素毒王
		local jj = math.modf(JY.Person[eid]["用毒能力"]/10)
		if JLSD(10, 25 + jj, eid) then
			SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 4, 5)
			WAR.Person[WAR.CurID]["中毒点数"] = (WAR.Person[WAR.CurID]["中毒点数"] or 0) + AddPersonAttrib(pid, "中毒程度", math.random(jj-5, jj+5))
			local bl = math.modf((jj + 2)*20)
			local n = AddPersonAttrib(pid, "内力", -bl)
			local m = AddPersonAttrib(eid, "内力", bl)
			local bl2 = math.modf((jj + 2)*4)
			local n1 = AddPersonAttrib(pid, "生命", -bl2)
			local m1 = AddPersonAttrib(eid, "生命", bl2)
			WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + n1
			WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + m1
			WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + n
			WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + m			
			WAR.Person[emenyid][CC.TXDH] = 40
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+神木毒王・天星飞舞"    
			else
				WAR.Person[emenyid][CC.TXWZ2] = "神木毒王・天星飞舞"
			end  	
		end
	end  
  
    if DWPD() and T1LEQ(eid) then --零二七苍半无双
		local jj = 25+tianshu()*5
		if JLSD(10, 25 + jj, eid) then
			SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 4, 5)
			WAR.Person[WAR.CurID]["中毒点数"] = (WAR.Person[WAR.CurID]["中毒点数"] or 0) + AddPersonAttrib(pid, "中毒程度", math.random(jj-5, jj+5))
			WAR.Person[WAR.CurID]["内伤点数"] = (WAR.Person[WAR.CurID]["内伤点数"] or 0) + AddPersonAttrib(pid, "受伤程度", math.random(jj-5, jj+5))
			local bl = math.modf((jj + 2)*20)
			local n = AddPersonAttrib(pid, "内力", -bl)
			local m = AddPersonAttrib(eid, "内力", bl)
			local bl2 = math.modf((jj + 2)*4)
			local n1 = AddPersonAttrib(pid, "生命", -bl2)
			local m1 = AddPersonAttrib(eid, "生命", bl2)
			local bl3 = Rnd(3) + 2
			local n2 = AddPersonAttrib(pid, "体力", -bl3)
			local m2 = AddPersonAttrib(eid, "体力", bl3)
			WAR.Person[WAR.CurID]["体力点数"] = (WAR.Person[WAR.CurID]["体力点数"] or 0) + n2
			WAR.Person[emenyid]["体力点数"] = (WAR.Person[emenyid]["体力点数"] or 0) + m2
			WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + n1
			WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + m1
			WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + n
			WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + m			
			WAR.Person[emenyid][CC.TXDH] = 49
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+苍半无双・海纳百川"    
			else
				WAR.Person[emenyid][CC.TXWZ2] = "苍半无双・海纳百川"
			end  	
		end
	end 
  
  	if ((((PersonKF(eid,94) and PersonKF(eid,100)) or T1LEQ(eid)) and JLSD(20,80,eid))) and 0 < JY.Person[eid]["生命"] then
        WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", 80);
	    JY.Person[eid]["中毒程度"] = JY.Person[eid]["中毒程度"] - 20
	    JY.Person[eid]["受伤程度"] = JY.Person[eid]["受伤程度"] - 20
	    if JY.Person[eid]["中毒程度"] < 0 then
	        JY.Person[eid]["中毒程度"] = 0
	    end
	    if JY.Person[eid]["受伤程度"] < 0 then
	        JY.Person[eid]["受伤程度"] = 0
	    end
	    if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
		    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+炼虚化神"    --精气流转・炼虚化神
	    else
		    WAR.Person[emenyid][CC.TXWZ3] = "精气流转・炼虚化神"
	    end
    end
  
	if DWPD() and PersonGT(eid, 108) and PersonKF(eid, 88) then --白罗灭精
		local jj = math.modf(JY.Person[eid]["实战"] / 25)
		if JLSD(10, 25 + jj, eid) then
			SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 4, 5)
			local bl2 = limitX(math.modf(JY.Person[pid]["生命"] / 40), 0, 100)
			local n1 = AddPersonAttrib(pid, "生命", -bl2)
			local m1 = AddPersonAttrib(eid, "生命", bl2)
			WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + n1
			WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + m1		
			WAR.Person[emenyid][CC.TXDH] = 6
			dng = dng + 500
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+白罗灭精"    --白罗灭精
			else
				WAR.Person[emenyid][CC.TXWZ2] = "白罗灭精"
			end
		end
	end    
  
	if DWPD() and PersonGT(eid, 106) and (PersonKF(eid, 85) or T1LEQ(eid)) then --万流归宗
		local jj = math.modf(JY.Person[eid]["实战"] / 25)
		if JLSD(10, 25 + jj, eid) then			  
			dng = dng + 500
			local xnl2 = math.modf(JY.Person[pid]["内力"] / 80 + math.random(20))
			SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 4, 2)	
			WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", -xnl2)
			WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", xnl2)
		end
	end 

    if eid == 0 and T6XQS(0) then --萧秋水木顽内力代替伤害
	    if WAR.XQS == 4 then
	        local neili=JY.Person[eid]["内力"]
		    hurt = math.modf(hurt*(0.5-(neili/30000)));
		    if JLSD(20,20+math.modf(neili/20),eid) then
		        WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + hurt*3
		        AddPersonAttrib(eid, "内力", hurt)
		        WAR.Person[emenyid][CC.TXWZ1] = "忘情天书・木顽・枯木逢春"
	            WAR.Person[emenyid][CC.TXDH] = 39
		    else
		        WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - hurt
		        AddPersonAttrib(eid, "内力", -hurt)
		    end
	    end
    end

    if wglw(eid,94) or (DT(eid,632) and PersonKF(eid,94)) then --神照内力替代伤害	
		hurt = math.modf(hurt/2);
		WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - hurt
		AddPersonAttrib(eid, "内力", - hurt * 5)
	end	  

    if WAR.TQS2==2 and eid==0 and T13TQS(0) then --沼跃鱼：滕青山青龙斗气 内力代替伤害
        hurt = math.modf(hurt/2);
		WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - hurt
		AddPersonAttrib(eid, "内力", -hurt)
	    WAR.TQS2=0
    end
  
    if WAR.TQS2==2 and wssz(eid) then --沼跃鱼：滕青山青龙斗气 内力代替伤害
        hurt = math.modf(hurt/2);
		WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - hurt
		AddPersonAttrib(eid, "内力", -hurt)
	    WAR.TQS2=0
    end
  
    if PersonGT(eid,182) and WAR.Actup[eid] ~= nil then  --太极神功体力替代伤害
	    hurt = math.modf(hurt/10);
		WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - hurt
		AddPersonAttrib(eid, "内力", - hurt * 10)
	end	  	

    if wglw(eid,121) or (DT(eid,59) and PersonKF(eid,121)) or (DT(eid,601)) then --17-3-3-玉女经
        if WAR.LQZ[pid] ~= nil and WAR.LQZ[pid] > 0 then 
	        local a = WAR.LQZ[pid]/100
		    if a < 0.1 then 
		        a = 0.1
		    end   
		       hurt = math.modf(hurt*(1 - a +0.1))
	    end 
	    if WAR.ICE[pid] ~= nil and WAR.ICE[pid] > 0 then 
	        hurt = math.modf(hurt*0.5)
	    end
    end
  
    if T7DFWM(eid) and juexing() >= 1 and DWPD() then --东方未明觉醒后25%几率内力代替伤害
	    if hurt > 10 and JY.Person[eid]["内力最大值"] >= 6500 and 
		    JY.Person[eid]["内力"] >= math.modf(hurt * 1.5) and JLSD(10, 35, eid) then		
		    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - math.modf(hurt * 1.5)
		    AddPersonAttrib(eid, "内力", -math.modf(hurt * 1.5))
		    hurt = 10
		    if WAR.Person[emenyid][CC.TXWZ3] == nil then
			    WAR.Person[emenyid][CC.TXWZ3] = "卸劲护元"
		    else
			    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "卸劲护元"
		    end		
	    end
    end

    if T1LEQ(eid) and juexing() > 1 and DWPD() then --东方未明觉醒后25%几率内力代替伤害
	    if hurt > 10  and JY.Person[eid]["内力"] >= math.modf(hurt * 0.2) and JLSD(10, 35, eid) then		
		    local fhurt=math.modf(hurt*0.2)
		    hurt = math.modf(hurt*0.8)
		    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - fhurt
		    AddPersonAttrib(eid, "内力", -fhurt)
		    if WAR.Person[emenyid][CC.TXWZ3] == nil then
			    WAR.Person[emenyid][CC.TXWZ3] = "逍遥鹏飞决.大鹏展翅"
		    else
			    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "逍遥鹏飞决.大鹏展翅"
		    end
            WAR.Person[emenyid][CC.TXDH] = 131		
	    end
    end
        
	--Ж竹风雨滴：神州最强 倾城之恋  
    --if DT(pid,0) and DWPD() then
		--for j = 0, WAR.PersonNum - 1 do 
            --local x1 = WAR.Person[j]["坐标X"];
			--local y1 = WAR.Person[j]["坐标Y"];
			--for ex = x1 - 99, x1 + 99 do
				--for ey = y1 - 99, y1 + 99 do
					--SetWarMap(ex, ey, 4, 1)
					--if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
						--local ep = GetWarMap(ex, ey, 2)
						--if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[ep]["我方"] then
                            --AddPersonAttrib(WAR.Person[ep]["人物编号"], "生命", -9999)
							--JY.Person[WAR.Person[ep]["人物编号"]]["生命"] = (JY.Person[WAR.Person[ep]["人物编号"]]["生命"] or 0) - 9999
							--if JY.Person[WAR.Person[ep]["人物编号"]]["生命"] <= 0 then
			                    --WAR.Person[ep]["死亡"] = true 						   
							--end   
						--end
					--end
				--end
			--end	
			--if WAR.LXZT[eid] ~= nil then
                --JY.Person[eid]["生命"] = JY.Person[eid]["生命"] - math.random(3) - math.modf(JY.Person[eid]["受伤程度"] / 1)
            --else
                --JY.Person[eid]["生命"] = JY.Person[eid]["生命"] - 1 - math.modf(JY.Person[eid]["受伤程度"] / 1)
                --if JY.Person[eid]["生命"] > 1 then
                    --JY.Person[eid]["生命"] = 1
                --end
            --end
		--end	
		--WAR.QCZL = 1
	--end 	

    if T7DFWM(eid) and juexing() >= 1 and DWPD() then --东方未明觉醒后35%伤害-1/3
	    if JY.Person[eid]["防御力"] >= 550 and JLSD(30, 65, eid) then
		    hurt = math.modf(hurt * (2 / 3))
		    if WAR.Person[emenyid][CC.TXWZ3] == nil then
			    WAR.Person[emenyid][CC.TXWZ3] = "铜身铁臂"
		    else
			    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "铜身铁臂"
		    end
		    WAR.Person[emenyid][CC.TXDH] = 39
	     end
    end  
  
    if T13TQS(eid) then--沼跃鱼：滕青山累计防御上升
        WAR.SWFY=WAR.SWFY+math.modf(tianshu()/2)+1
        local aa=WAR.SWFY
        if aa>10+tianshu() then
            aa=10+tianshu()
        end
        local bb=20+tianshu()*2
        local cc=aa/bb
        hurt = math.modf(hurt * (1-cc))
  	    if WAR.SWFY>4 and juexing()>2 and JLSD(0,20+WAR.SWFY*3,eid) then
	        WAR.HB[eid] = (WAR.HB[eid] or 0) + 1
			--addeffect(WAR.HB, eid, 1)
	    end
    end
  
    if wssz(eid) then--沼跃鱼：滕青山累计防御上升
        WAR.SWFY1=WAR.SWFY1+7
        local aa=WAR.SWFY1
        if aa>15 then
            aa=15
        end
        local bb=20
        local cc=aa/bb
        hurt = math.modf(hurt * (1-cc))
    end
  
    if MZ(eid)==2 then
        local aa=math.modf((JY.Person[eid]["生命最大值"]-JY.Person[eid]["生命"] )/40)
	    local bb=aa*0.01
	    if bb>=0.35 then
	        bb=0.35
	    end
	    hurt = math.modf(hurt * (1-bb))
		if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "血纹奥义・凝血成符"
		else
			WAR.Person[emenyid][CC.TXWZ2] ="血纹奥义・凝血成符"
		end	
		WAR.XUEFU[eid]=WAR.XUEFU[eid] or 0 + math.random(3)
    end
  
    if MZ(eid)==2 and JY.Person[eid]["生命"]<= math.modf(JY.Person[eid]["生命最大值"]*0.25) then
        if WAR.XUEFU[eid]~=nil and WAR.XUEFU[eid]>= 0 then
	        WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid,"生命",math.modf(WAR.XUEFU[eid]*100))
			--JY.Person[eid]["生命"]=JY.Person[eid]["生命"]+WAR.XUEFU[eid]*100
		    if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
			    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "血纹奥义.血气唤醒"
		    else
			    WAR.Person[emenyid][CC.TXWZ2] ="血纹奥义.血气唤醒"
		    end	
		        WAR.XUEFU[eid]=0
	    end
    end
  
  
    if DT(eid, 53) and JX(eid) then
        WAR.LMJQ1=WAR.LMJQ1+math.modf(hurt/100)
        local lqz=WAR.LMJQ1
        if WAR.Person[emenyid][CC.TXWZ1] == nil then
			WAR.Person[emenyid][CC.TXWZ1] = "龙气值"..lqz
		else
			WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" ..  "龙气值"..lqz
		end
    end
  
    if WAR.LMJQ2[eid]~=nil and WAR.LMJQ2[eid]>=0 then
        WAR.LMJQ2[eid]=WAR.LMJQ2[eid]+ math.modf(hurt/100)
        local jqz=WAR.LMJQ2[eid]
        if WAR.Person[emenyid][CC.TXWZ1] == nil then
			WAR.Person[emenyid][CC.TXWZ1] = "剑气值"..jqz
		else
			WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" ..  "剑气值"..jqz
		end
    end
	
    if BJY(eid) then
        WAR.XYQJ = WAR.XYQJ + math.modf(hurt/100)
        local lqz = WAR.XYQJ
        if WAR.Person[emenyid][CC.TXWZ1] == nil then
			WAR.Person[emenyid][CC.TXWZ1] = "虚云劲"
		else
			WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" ..  "虚云劲"
		end
    end
  
    if WAR.PYZJ[eid] ~= nil and WAR.PYZJ[eid]>=0 then
        WAR.PYZJ[eid] = WAR.PYZJ[eid] + math.modf(hurt/100)
        local jqz = WAR.PYZJ[eid]
        if WAR.Person[emenyid][CC.TXWZ1] == nil then
			WAR.Person[emenyid][CC.TXWZ1] = "排云掌劲"
		else
			WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" ..  "排云掌劲"
		end
    end
    --附加狱龙破
	if WAR.YLP[eid] ~= nil and WAR.YLP[eid]>=0 and wugong == 67 and wglw1(pid,67) and (JLSD(10,40,pid) or (JY.Person[pid]["武器"] == 44 and JLSD(10,80,pid))) then
        local bb = math.random(3,6)
		WAR.YLP[eid] = WAR.YLP[eid] + bb
        --local jqz = WAR.YLP[eid]
        if WAR.Person[emenyid][CC.TXWZ2] == nil then
			WAR.Person[emenyid][CC.TXWZ2] = "从云牙・狱龙破"
		else
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+" .."从云牙・狱龙破"
		end
		if WAR.LQZ[eid] == 100 and WAR.SPIRIT[eid] >= 130 then
			WAR.WYQS[eid] = (WAR.WYQS[eid] or 0) + 1
		end	
    end
 
	
	if DT(eid,50) then  --沼跃鱼：萧峰天将底力加强防御
	    local aa=math.modf((JY.Person[eid]["生命最大值"]-JY.Person[eid]["生命"] )/30)
	    local bb=aa*0.01
	    if bb>=0.35 then
	        bb=0.35
	    end
	    if WAR.LQZ[eid] ~= nil and WAR.LQZ[eid]==100 then
	        aa=math.modf(aa*1.5)
	    end
	        hurt = math.modf(hurt * (1-bb))
    end
  
    if DT(eid,1) and JX(eid) and DWPD() then --沼跃鱼：胡斐战意刀气护体
	    local DQ=sixi(eid,3)
		hurt = math.modf(hurt * ((700-DQ) / 700))
		if hurt<50 then
		    hurt=50
		end
		if WAR.Person[emenyid][CC.TXWZ3] == nil then
			WAR.Person[emenyid][CC.TXWZ3] = "战意.刀气护体"
		else
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "战意.刀气护体"
		end
		   WAR.Person[emenyid][CC.TXDH] = 39
           WAR.ZYDQ=DQ		
    end  
  
    --防御状态-20%
    if WAR.Defup[eid] == 1 then
        if PersonKF(eid, 101) then --八荒防御时伤害-30%,主功体-50%
            if PersonGT(eid, 101) then
		        hurt = math.modf(hurt * 0.5)
	        else
		        hurt = math.modf(hurt * 0.7)
	        end
        else
    	     hurt = math.modf(hurt * 0.8)
        end
	    if DT(eid, 40) then --木岛主防御-30%
		    hurt = math.modf(hurt * 0.7)
	    end
		if BJY(eid) and juexing() > 2 then  --防御-70%
			hurt = math.modf(hurt * 0.3)
		end	
		if NF(eid) and juexing() > 0 then   --防御-60%
			hurt = math.modf(hurt * 0.4)
		end
		if PersonKF(eid,182) then  --太极神功减伤30% 主运减伤60%
			hurt = math.modf(hurt * 0.7)
			if PersonGT(eid,182) then
				hurt = math.modf(hurt * 0.4)
			end
		end 	
	
		if (wglw(eid,96) or (eid == 400 and JY.Person[eid]["姓名"] == "慧聪") or DT(eid,38) or DT(eid,615)) then   --罗汉伏魔功防御-60%
			hurt = math.modf(hurt * 0.4)
		end 
        if MPPD(eid)==5 then
            if wglw(eid,151) and PersonGT(eid,151) then
		        local aa=math.modf(dng/10)
		        hurt=hurt-aa
		        if hurt<1 then
		            hurt=1
		        end
		        if WAR.Person[emenyid][CC.TXWZ3] == nil then
			        WAR.Person[emenyid][CC.TXWZ3] = "金刚・仁王"
		        else
			        WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "金刚・仁王"
		        end
		            WAR.Person[emenyid][CC.TXDH] = 39
		    end
        end	  
    end
-----------------------------------------------------------------------------	
    --蓝烟清：DIY修改专用
    local diy_hurt, diy_ang, diy_dng = War_DIY_WugongHurtLife(emenyid, wugong, hurt, ang, dng);
    if diy_hurt == nil then
  	    diy_hurt = 0;
    end
    if diy_ang == nil then
  	    diy_ang = 0;
    end
    if diy_dng == nil then
  	    diy_dng = 0;
    end
    hurt = math.modf(limitX(diy_hurt, 0, 9999));
    ang = math.modf(limitX(diy_ang, 0, 9999));
    dng = math.modf(limitX(diy_dng, 0, 9999));

	--if ang <= 0 then ang = 1 end --杀气最少为1
	
	if PersonKF(eid, 105) and DWPD() then
		local jl = 15
		
		if eid == 0 and WAR.KHNP1[eid] ~= nil then
		    jl = jl + 15
		end	
		
		if PersonGT(eid, 105) then
			jl = jl + 15
		end
		if DT(eid, 27) then
			jl = jl + 45
		end
		if DT(eid, 36) then
			jl = jl + 10
		end	
		if JLSD(10, 10 + jl, eid) then
			if PersonGT(eid, 105) or DT(eid, 27) or DT(eid, 36) then
				hurt = math.modf(hurt / 3)
			else
				hurt = math.modf(hurt / 2)
			end
			ang = 0
			if PersonGTHT(eid, 105, WAR.L_SGHT) == false then
				WAR.Person[emenyid][CC.TXWZ2] = CC.WARS94		--葵花移形
			else
				WAR.Person[emenyid][CC.TXWZ2] = "葵花神功・"..CC.WARS94
			end
			WAR.Person[emenyid][CC.TXDH] = 51			
		end
	end
  
    if WAR.SH[eid] ~= nil or WAR.ZBX[eid] ~= nil or WAR.SH1[eid] ~= nil then --锁喉/醉八仙/状态不被杀气--17-2-18
	    ang = 0
    end
    if jtyl(eid) and PersonKF(eid,115) then 
        hurt = math.modf(hurt*0.7)
    end
    
	if PersonKF(eid,115) and DWPD() then  --梯云纵杀气减半
		if wglw2(eid,115) or DT(eid,5) then
			if MPPD(eid) == 4 and MPDJ(eid) > 3 then
				ang = math.modf(ang / 3)
				if JLSD(10,50,eid) then
				ang = 0
				end
			elseif JLSD(10,70,eid) then
				ang = math.modf(ang / 2)
			end
			if ang <= 0 then
				if WAR.HRXY[eid] == nil then --怀若虚云
					WAR.HRXY[eid] = 1
				else
					WAR.HRXY[eid] = 1
				end	
				if WAR.Person[emenyid][CC.TXWZ2] == nil then
				WAR.Person[emenyid][CC.TXWZ2] = "梯云纵横・怀若虚云"	
				else
					WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+".."怀若虚云"	
				end
					WAR.Person[emenyid][CC.TXDH] = 21
			else
				if eid ~= 5 or eid~= 171 then
					if JLSD(10,60,eid) then
						WAR.ACT = 10
						WAR.ZYHB = 0
						if WAR.Person[emenyid][CC.TXWZ2] == nil then
						WAR.Person[emenyid][CC.TXWZ2] = "梯云纵横・煌煌道威・揽雀尾"	
						else
							WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+".."煌煌道威・揽雀尾"	
						end
						WAR.Person[emenyid][CC.TXDH] = 21
					else
						WAR.KMSHJQ[pid] = WAR.KMSHJQ[pid] or 0 + 2
						if WAR.Person[emenyid][CC.TXWZ2] == nil then
							WAR.Person[emenyid][CC.TXWZ2] = "梯云纵横・煌煌道威・倒卷肱"	
						else
							WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+".."煌煌道威・倒卷肱"	
						end
						WAR.Person[emenyid][CC.TXDH] = 21
						WAR.HHDW1 = 1
					end
				end	
			end	
		else	
			if MPPD(eid) == 4 and MPDJ(eid) > 3 then
				ang = math.modf(ang / 2)
				if JLSD(10,40,eid) then
				ang = 0
				end
			elseif JLSD(10, 10 + attribRandom(eid, 10, 3), eid) then
				if jtyl(eid) then 
				ang = math.modf(ang * 2)
				else   
				ang = math.modf(ang / 2)
				end
			end	
			if WAR.Person[emenyid][CC.TXWZ2] == nil then
				WAR.Person[emenyid][CC.TXWZ2] = "梯云纵横"	
			else
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+".."梯云纵横"	
			end
				WAR.Person[emenyid][CC.TXDH] = 21
		end		
    end
  
    if BJY(eid) and juexing() > 0 then  
        hurt = math.modf(hurt * 0.5)
	    ang = math.modf(ang * 0.5)
	    dng = dng + math.modf(sixi(eid,1) * 10)
	    local ad = math.modf(dng / 2)
        local ab = math.modf(ang / 20)
	    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + ad
	    AddPersonAttrib(eid, "内力", ad)
	    JY.Person[eid]["受伤程度"] = JY.Person[eid]["受伤程度"] - ab
        WAR.HOT[pid] = (WAR.HOT[pid] or 0) + (ab * 2)
        if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "龙元火劲护体"	
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+龙元火劲护体"	
	    end
	end

    if (DT(eid, 5) or wglw1(eid, 16)) and JLSD(10, 40, eid) then --太极拳领悟伤害减半
        hurt = math.modf(hurt * 0.5)
	end

    if PersonKF(eid,116) and DWPD() and (JLSD(10, 10 + attribRandom(eid, 10, 3), eid) --飞天神行伤害减25%
	    or ((DT(eid, 1) or DT(eid, 621)) and math.random(100) <= 5)) then  --胡斐5%二次判定
	    if wglw2(eid,116) or DT(eid, 1) or DT(eid, 621) then
			local aa=JY.Person[eid]["轻功"]
			local hurt1 = 0
			local hurt2 = 0
			hurt1 = math.modf((hurt * (0.75)) - aa)
			if hurt1 > 300 and JLSD(10,50,eid) then
				hurt2 = hurt1 - aa
				hurt = hurt2
				if hurt2 <= 50 then
					if WAR.Person[emenyid].Time < 0 then 
						WAR.Person[emenyid].Time = (aa / 6)
					end
				end	
				WAR.Person[emenyid][CC.TXWZ0] = "超・飞天神行"
			else
				hurt = hurt1
				if WAR.Person[emenyid][CC.TXWZ2] == nil then
					WAR.Person[emenyid][CC.TXWZ2] = "真・飞天神行"	
				else
					WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+".."真・飞天神行"	
				end	
			end
			WAR.Person[emenyid][CC.TXDH] = 59
		else	
			hurt = math.modf(hurt * (0.75))
			if WAR.Person[emenyid][CC.TXWZ2] == nil then
				WAR.Person[emenyid][CC.TXWZ2] = "飞天神行"	
			else
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+飞天神行"	
			end	
				WAR.Person[emenyid][CC.TXDH] = 59
		end		
    end
    --[[  
    if PersonKF(eid,117) and (JLSD(10, 10 + attribRandom(eid, 10, 3), eid) or (DT(eid, 54) and math.random(100) <= 5)) and 
	    WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then  --神行百变集气增加
	    WAR.tmp[9500+eid]=1
	    if WAR.Person[emenyid][CC.TXWZ2]==nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "神行百变"	
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+神行百变"	
	    end		
        WAR.Person[emenyid][CC.TXDH] = 81
    end   
    ]]
	
    if WAR.SHITOUNG == 2 and T4WXS(eid) then --王小石情意绵绵 杀气减半伤害减半
	    hurt = math.modf(hurt/2)
	    ang = math.modf(ang/2)
	    WAR.OYFSD[pid] = (WAR.OYFSD[pid] or 0) +  math.modf(hurt/5)
	    WAR.SHITOUNG=0
    end
	
  	if (wglw(eid,6) and PersonGT(eid,6) and MPPD(eid)==10 ) or (PersonKF(eid,6) and DT(eid,57) and JX(eid)) then
     	local nn=math.modf(JY.Person[eid]["内力"]*0.05)
		local mm=math.modf(JY.Person[pid]["内力"]*0.05)
		local nn2=math.max((nn-mm),0)
        hurt=math.max(hurt-nn2,0)
        ang=math.max(ang-nn,0)
        WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", ang)	
		if WAR.Person[emenyid][CC.TXWZ3] == nil then
			WAR.Person[emenyid][CC.TXWZ3] = "碧海・无量潮生"
		else
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .."碧海・无量潮生"
		end
    end	
  
    if DT(eid, 64) and (WAR.KMSH>0 or JLSD(10, 35, eid)) and DWPD() then
	    hurt = math.modf(hurt * 0.66)
	    ang = math.modf(ang * 0.66)
	    WAR.KMSH=WAR.KMSH-1
	    if WAR.KMSH<=0 then
	        WAR.KMSH=0
	    end
	    WAR.KMSHJQ[pid]=WAR.KMSHJQ[pid] or 0 +1
	    WAR.Person[emenyid][CC.TXWZ3] = "空明守护.卸劲引力"
	    WAR.Person[emenyid][CC.TXDH] = 35
    end 
  
    if BJY(pid) and WAR.LYFH > 0 and DWPD() then
		hurt = math.modf(hurt/2)
	    ang = math.modf(ang/2)
		dng = dng + math.modf(sixi(eid,2) * 10)
		if WAR.Person[emenyid][CC.TXWZ2] == nil then
	        WAR.Person[emenyid][CC.TXWZ2] = "逆道乾坤・周天之力"	
	    else
	        WAR.Person[emenyid][CC.TXWZ2] = "逆道乾坤・周天之力+"..WAR.Person[emenyid][CC.TXWZ2]	
	    end	
	end	
 
    if DT(eid, 129) and WAR.WCY3>0 and DWPD() then--沼跃鱼：重阳真打
	    hurt = math.modf(hurt/2)
	    ang = math.modf(ang/2)
	    dng = dng+math.modf(sixi(eid,2)*10)
        if WAR.Person[emenyid][CC.TXWZ2] == nil then
	        WAR.Person[emenyid][CC.TXWZ2] = "神通技.真打剑罡"	
	    else
	        WAR.Person[emenyid][CC.TXWZ2] = "神通技.真打剑罡+"..WAR.Person[emenyid][CC.TXWZ2]	
	    end	
	    WAR.Person[emenyid][CC.TXDH] = 91
	end
   
    if (wglw(eid, 107) and PersonGTHT(eid,107,WAR.NGHT) and DWPD() and JY.Person[eid]["内力"]>= math.modf(0.75*JY.Person[eid]["内力最大值"]) ) or DT(eid,599)then--沼跃鱼：重阳真打
	    ang = 0
	    dng = 1
	    WAR.GTSHAQI=0
	    if WAR.ZBT2>0 then
	        WAR.GTSHAQI=-300
	    end
	    WAR.ACT=10
	    WAR.ZYHB=0
	    local nn=math.modf(JY.Person[eid]["内力"]*0.015)
	    local mm=math.modf(hurt*0.25)*10
	    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", nn)
	    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", mm)
        if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "九阴奥义.飞絮劲"	
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = "九阴奥义.飞絮劲+"..WAR.Person[emenyid][CC.TXWZ2]	
	    end	
	    WAR.Person[emenyid][CC.TXDH] = 38
	end
   
    if wglw1(eid, 33) and WAR.NGHT>0 and DWPD() and JY.Person[eid]["内力"]>= math.modf(0.8*JY.Person[eid]["内力最大值"]) then--沼跃鱼：重阳真打
	    ang = 0
	    dng = 1
	    WAR.GTSHAQI=0
	    local fhurt=hurt
	    hurt=math.modf(hurt*0.75)
	    local nn=math.modf(JY.Person[eid]["内力"]*0.1)
	    local mm=math.modf(hurt*0.25)*10
	    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) +nn+mm
	    AddPersonAttrib(eid, "内力", nn)
        if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "中央戊土.坚如磐石"	
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = "中央戊土.坚如磐石+"..WAR.Person[emenyid][CC.TXWZ2]	
	    end	
	        WAR.Person[emenyid][CC.TXDH] = 38
	end
	
   	if WAR.SJHB[pid] == 3 then
	    local dzlv=math.modf(sixi(pid,2)*0.15)
	    local jiali= math.modf(JY.Person[pid]["内力"]/50)
	    hurt = hurt+dzlv+jiali
	end	
   
    if DT(pid,601) then
	    local dzlv=math.modf(sixi(pid,4)*0.15)
	    hurt = hurt+dzlv
	end	
   
    if wglw(eid,187) and PersonGT(eid,187) and JLSD(10,45,eid) then
		WAR.ACT = 10
	    WAR.ZYHB = 0
		if WAR.Person[emenyid][CC.TXWZ3] == nil then
			WAR.Person[emenyid][CC.TXWZ3] = "少林九阳・终"	
		else
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."+".."少林九阳・终"	
		end	
	end 	

    if BJY(eid) and juexing() > 2 and DWPD() then --无求易诀
        WAR.ACT = 10
		local aa = math.modf(sixi(eid,1) * 1.5)
		local bb = math.modf(sixi(eid,2) * 1.5)
	    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + aa
	    AddPersonAttrib(eid, "生命", aa)
		WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + bb
	    AddPersonAttrib(eid, "内力", bb)
        if WAR.Person[emenyid][CC.TXWZ1] == nil then
		    WAR.Person[emenyid][CC.TXWZ1] = "有物混成天地生"	
	    else
		    WAR.Person[emenyid][CC.TXWZ1] = "道法自然反之动+"..WAR.Person[emenyid][CC.TXWZ1]	
	    end	
    end        	

    if DT(eid,583) and JLSD(10,45,eid) then
		hurt = 30
		local a = math.modf(sixi(eid,2) / 10)
		dng = dng + math.modf(a * 10)
		AddPersonAttrib(pid, "生命", -a)
		if WAR.Person[emenyid][CC.TXWZ1] == nil then
			WAR.Person[emenyid][CC.TXWZ1] = "玄阴之道・玄阴剑甲"	
		else
			WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1].."+".."玄阴之道・玄阴剑甲"	
		end	
	end 	

    if DT(eid, 129) and JX(eid) and PersonGTHT(eid,100,WAR.NGHT) and DWPD() then--沼跃鱼：重阳真打
	    ang = 0
	    dng = 1
	    WAR.GTSHAQI=0
	    WAR.ACT=10
	    local nn=math.modf(sixi(eid,2)*0.75)
	    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) +nn
	    AddPersonAttrib(eid, "生命", nn)
        if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "先天真气.剑罡护体"	
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = "先天真气.剑罡护体+"..WAR.Person[emenyid][CC.TXWZ2]	
	    end	
	        WAR.Person[emenyid][CC.TXDH] = 78
	end
  
    if DT(eid, 65) and WAR.WCY4>0 and DWPD() then--沼跃鱼：六脉转龙
        hurt = math.modf(hurt * 0.66)
	    ang = math.modf(ang * 0.66)
	    dng = dng+math.modf(sixi(eid,1)*10)
	    local nn=math.modf(dng/2)
        local nn2=math.modf(ang/20)
	    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) +nn
	    AddPersonAttrib(eid, "内力", nn)
	    JY.Person[eid]["受伤程度"]=JY.Person[eid]["受伤程度"]-nn2
        WAR.HOT[pid] = (WAR.HOT[pid] or 0) + (nn2 * 2)
        if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "气脉贯通.六气合一"	
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = "气脉贯通.六气合一+"..WAR.Person[emenyid][CC.TXWZ2]	
	    end	
	        WAR.Person[emenyid][CC.TXDH] = 140
	end 
   
    if DT(eid,58) and JX(eid) and DWPD() then --杨过攻其必救
	    local sp = math.modf(sixi(eid,2)/10)
	    local sp2 = 1-sp/100
        local str="无锋离剑式"	
	    hurt = math.modf(hurt * sp2)
	    if WAR.LQZ[eid] ~= nil then
		    sp= sp + math.modf(WAR.LQZ[eid] * 0.05)
	    end
	    dng = dng+math.modf(sixi(eid,2)*10)
	    if JLSD(10, 40+sp, eid) and WAR.SQFJ ~= 1 then
	        for i = 0, WAR.PersonNum - 1 do
                if DT(WAR.Person[i]["人物编号"],58) and JY.Person[WAR.Person[i]["人物编号"]]["生命"] > 0 then
                    str=".钝击锉剑式"
		            local tmppid = WAR.CurID
		            WAR.CurID = i
		            DIYdisplay("独孤奥义.攻其必救")
                    WAR.SQFJ = 1
                    WarDrawMap(0)
                    CurIDTXDH(i, 2197, 2208)
                    CurIDTXDH(i, 2209, 2219)     
                    --玄铁反击
		            local n = 1
		            for w = 1, HHH_GAME_SETTING["WG_COUNT_MAX_LIMIT"] do
			            if DT(WAR.Person[i]["人物编号"],58) and JY.Person[WAR.Person[i]["人物编号"]]["武功" .. w] == 45 then
				            n = w
				        end
			        end	
                    War_Fight_Sub(i, n, WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"])
		            WAR.BZ[tmppid]=1
		            WAR.KMSHJQ[tmppid]=WAR.KMSHJQ[tmppid] or 0 +1
		            WAR.SQFJ = 0
		            WAR.CurID = tmppid
		            hurt=0
		            WAR.ACT=10
		            WAR.ZYHB=0
		            lib.Delay(200)	
                end
            end    
		else
	    end	
	    if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "玄铁九剑奥义."..str	
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = "玄铁九剑奥义."..str.."+"..WAR.Person[emenyid][CC.TXWZ2]	
	    end	
	        WAR.Person[emenyid][CC.TXDH] = 145
	end
  
    if eid == 0 and zjtype()==4 and JX(eid) and DWPD() and JY.Wugong[JY.Person[eid]["武功" .. 1]]["攻击力" .. 10] > 0 then --风天流时空逆
	    local sp = math.modf(JY.Person[eid]["资质"] / 4)
	    local sp2 = 1-sp/50
        local str=".次元阻隔"
		hurt = math.modf(hurt * sp2)
		if WAR.LQZ[eid] ~= nil then
		    sp= sp + math.modf(WAR.LQZ[eid] * 0.05)
	    end
	        dng = dng+JY.Person[eid]["内力"]
	    if JLSD(10, 40+sp, eid) and WAR.SQFJ == 0 then
	        for i = 0, WAR.PersonNum - 1 do
                if WAR.Person[i]["人物编号"] == 0 and zjtype()==4 and JX(WAR.Person[i]["人物编号"]) and JY.Person[WAR.Person[i]["人物编号"]]["生命"] > 0 then
                    str=".逆次元"
		            local tmppid = WAR.CurID
		            WAR.CurID = i
		            DIYdisplay("扭转时空.寰宇无限")
                    WAR.SQFJ = 1
                    WarDrawMap(0)
                    CurIDTXDH(i, 2197, 2208)
                    CurIDTXDH(i, 2209, 2219)     
                    --反击
		            local n = 1
                    War_Fight_Sub(i, n, WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"])
		            WAR.BZ[tmppid]=1
		            WAR.KMSHJQ[tmppid]=WAR.KMSHJQ[tmppid] or 0 +1
		            WAR.SQFJ = 0
		            WAR.CurID = tmppid
		            hurt=0
		            WAR.ACT=10
		            WAR.ZYHB=0
		            lib.Delay(200)	
                end
            end    
		else
	    end	
	    if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "宇晶流奥义."..str	
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = "宇晶流奥义."..str.."+"..WAR.Person[emenyid][CC.TXWZ2]	
	    end	
	       WAR.Person[emenyid][CC.TXDH] = 145
	end
   
    if DT(eid,517) and JLSD(10, 45, eid) and WAR.SQFJ ~= 1 and DWPD() then----
        WAR.GBWZ1=-1
	    WAR.ACT=10
	    WAR.ZYHB=0
	    if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "秘剑.燕返"	
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = "秘剑.燕返".."+"..WAR.Person[emenyid][CC.TXWZ2]	
	    end	
	        WAR.Person[emenyid][CC.TXDH] = 136    
    end

    --料敌先机
    if (wglw1(eid,47) or DT(eid,592)) and JY.Person[eid]["御剑能力"] >= 500 and WAR.SQF ~= 1 and JLSD(10,40,eid) and DWPD() then
		WAR.JJWS = -1
		WAR.ACT = 10
		WAR.ZYHB = 0
		local ab = math.modf(sixi(eid,2) / 10)
		hurt = math.modf(hurt * ab)
		if WAR.LQZ[eid] ~= nil then
		    ab = ab + math.modf(WAR.LQZ[eid] * 0.5)
	    end
		dng = dng + math.modf(sixi(eid,2) * 10)
		local jl = JY.Person[eid]["轻功"] + JY.Person[pid]["轻功"]
	    if jl < 0 then
	        jl = 0
	    end
	    if jl > 300 then
	        jl = 300
	    end
        local jl2 = 15 + math.modf(jl/20)
        if JLSD(0,60 + jl2,eid) then 
	        hurt = 0
		end	
		DIYdisplay("九剑无双")
	end	

	if wglw1(eid,16)  and WAR.SQFJ ~= 1 and DWPD() and JY.Person[0]["拳掌功夫"] >= 300 and JLSD(10,50,eid) then--
		WAR.TQFJ = -1
		WAR.ACT = 10
		WAR.ZYHB = 0
		local ab = math.modf(sixi(eid,1) / 10)
		hurt = math.modf(hurt / ab)
		if WAR.LQZ[eid] ~= nil then
		    ab = ab + math.modf(WAR.LQZ[eid] * 0.5)
	    end
		dng = dng + math.modf(sixi(eid,1) * 10)
		local jl = JY.Person[eid]["攻击力"] + JY.Person[pid]["攻击力"]
	    if jl < 0 then
	        jl = 0
	    end
	    if jl > 300 then
	        jl = 300
	    end
        local jl2 = 15 + math.modf(jl/20)
        if JLSD(0,60 + jl2,eid) then 
	        hurt = 0
		end	
		DIYdisplay("四两拨开阴阳势")
		DIYdisplay("借彼几分还几分")
	end

	if (wglw1(eid,40) or (DT(eid,91) and JX(eid)) or DT(eid,54) or DT(eid,630)) and WAR.SQFJ ~= 1 and DWPD() then
		local aa = JY.Person[eid]["中毒程度"] or 0
		if JLSD(10,40+(math.modf(aa/5)),eid) then
			WAR.DUO = 1
			WAR.Person[emenyid][CC.TXWZ3] = "金蛇幻蟒"
			if JLSD(10,60,eid) and not DT(eid,54) then
				WAR.JSFJ = -1 
				WAR.ACT = 10
				WAR.ZYHB = 0
				WAR.Person[emenyid][CC.TXWZ4] = "金蛇剑法・幻蟒游身"
				WAR.Person[emenyid][CC.TXDH] = 200
			end	
		end	
	end

    if wugong==11 then ---九阴爪
        hurt = math.modf((1 + math.abs((JY.Person[pid]["品德"] - 50) / 100)) * hurt)
	    ang = math.modf((1 + math.abs((JY.Person[pid]["品德"] - 50) / 100) )* ang)
		if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "九阴摧坚.神魔于心"	
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = "九阴摧坚.神魔于心".."+"..WAR.Person[emenyid][CC.TXWZ2]	
	    end	
	        WAR.Person[emenyid][CC.TXDH] = 136   
    end

    if T9ZY(eid) and juexing() >= 2 and DWPD() then --赵云蛇盘
        WAR.ZYSP=WAR.ZYSP+1
        if JLSD(10,30+WAR.ZYSP*15,eid) then
	        local sp = math.modf(sixi(eid,4)/30)
	        local sp2 = 1-sp/100
            local str="梨花遍身"	
	        hurt = math.modf(hurt * sp2)
	        if WAR.LQZ[eid] ~= nil then
		        sp= sp + math.modf(WAR.LQZ[eid] * 0.1)+WAR.ZYSP*15
	        end
	            dng = dng+math.modf(sixi(eid,4)*10)
	        if JLSD(10, 30+sp, eid) then
			    WAR.ACT = 10
			    WAR.ZYHB = 0
			    WAR.FLHS5 = 1
			    str="豪龙胆"
			    WAR.ZYSP=WAR.ZYSP+1
	        elseif JLSD(10, 30+sp, eid) and WAR.SQFJ ~= 1 then
	            for i = 0, WAR.PersonNum - 1 do
                    if WAR.Person[i]["人物编号"] == 0 and T9ZY(WAR.Person[i]["人物编号"]) and JY.Person[WAR.Person[i]["人物编号"]]["生命"] > 0 then
                        str="逆龙鳞"
		                local tmp = WAR.CurID
                        WAR.CurID = i
                        WAR.SQFJ = 1
                        WarDrawMap(0)
                        CurIDTXDH(i, 2197, 2208)
                        CurIDTXDH(i, 2209, 2219)     
                        --错步剑反击
		                local n = 1
		                for w = 1, HHH_GAME_SETTING["WG_COUNT_MAX_LIMIT"] do
			                if T9ZY(WAR.Person[i]["人物编号"]) and JY.Person[0]["武功" .. w] == 112 then
				                n = w
				            end
			            end	
                        War_Fight_Sub(i, n, WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"])
		                WAR.SQFJ = 0
		                WAR.CurID = tmp
                    end
                end    
	    else
	       end	
	    if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "蛇盘."..str	
	    else
		   WAR.Person[emenyid][CC.TXWZ2] = "蛇盘."..str.."+"..WAR.Person[emenyid][CC.TXWZ2]	
	    end	
	       WAR.Person[emenyid][CC.TXDH] = 145
	    end
    end

    --降龙混劲
	if WAR.XLGJ == 3 or WAR.XLGJ == 5 then
		local TK = nil
	    TK = 5
	    WAR.Person[WAR.CurID]["体力点数"] = AddPersonAttrib(pid, "体力", TK);
    end  
  
  	if ((MPPD(eid)==12 and PersonKF(eid, 88) and not PersonGT(eid, 105) and GetS(54,0,0,1) == 1) or DT(eid,26)) and WAR.XXQG[eid]~=nil and MPDJ(eid)>1 and DWPD() then --日月捧月派气防加成
        local aa=10
	    if DT(eid,26) then
	        aa=aa+5
	    end
	    if WAR.NGHT>0 then
	       aa=aa+5
	    end 
	       ang = math.modf(ang/2)
	       WAR.XXQG[eid]= WAR.XXQG[eid] or 0 +math.modf(ang/10)
	    if WAR.XXQF[eid]~=nil and WAR.XXQF[eid]>=0 then
		    dng=dng+WAR.XXQF[eid]*aa
        end  
	        WAR.Person[emenyid][CC.TXWZ2] = "群星捧月・月汇星光" 
            WAR.Person[emenyid][CC.TXDH] = 81	   
	end
  
    if T1LEQ(eid) and WAR.XXQG[eid]~=nil and DWPD() then --日月捧月派气防加成
        local aa=15
	    if WAR.NGHT>0 then
	        aa=aa+5
	    end 
	        ang = math.modf(ang/2)
	        WAR.XXQG[eid]= WAR.XXQG[eid] or 0 +math.modf(ang/10)
	    if WAR.XXQF[eid]~=nil and WAR.XXQF[eid]>=0 then
		    dng=dng+WAR.XXQF[eid]*aa
        end  
	        WAR.Person[emenyid][CC.TXWZ2] = "苍半无双・月照大江" 
            WAR.Person[emenyid][CC.TXDH] = 73	   
	end
  
  	if MPPD(eid) == 14 and PersonGT(eid,90) and MPDJ(eid)>1 then--沼跃鱼：正气歌主运效果
        local str=".天地有正气"
		local shang=math.modf(JY.Person[eid]["内力"]*0.03)
		dng=dng+math.modf(JY.Person[eid]["内力"]*0.8)
		if dng>= 2000+MPDJ(eid)*1000 then
		    dng=2000+MPDJ(eid)*1000;
		end
		if JLSD(20,45,eid) and PersonGTHT(eid, 90, WAR.NGHT) then
            local tmp=math.modf(JY.Person[eid]["内力"]*MPDJ(eid)*0.05);
		    ang = math.modf(ang/2);
		    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) +tmp;
  	        AddPersonAttrib(eid, "内力", tmp);
		    str=".杂然赋流形"
		else
		 
		end
		if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
    	    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "正气歌"..str
        else
    	    WAR.Person[emenyid][CC.TXWZ3] = "正气歌"..str
        end
	end
  
  	if (wglw(eid,108) and PersonGT(eid,108)) or DT(eid, 615) or DT(eid, 114) or DT(eid, 585) then--沼跃鱼：易筋领悟主运
        local str=".过去弥陀"
		local shang=math.modf(JY.Person[eid]["内力最大值"]*0.03)
		dng=dng+math.modf(JY.Person[eid]["内力"]*0.8)
		if dng>= 2000+math.modf(JY.Person[eid]["内力最大值"]*0.5) then
		    dng=2000+math.modf(JY.Person[eid]["内力最大值"]*0.5);
		end
		if JLSD(20,45,eid) and PersonGTHT(eid, 108, WAR.NGHT) then
		    local tmp=math.modf(JY.Person[eid]["内力"]*0.01);
		    ang = math.modf(ang/2);
		    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) +shang;
		    WAR.MENG[pid]=WAR.MENG[pid] or 0+20
  	        AddPersonAttrib(eid, "受伤程度", -tmp);
		    str=".未来无生"
		else
		 
		end
		if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
    	    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "易筋神髓"..str
        else
    	    WAR.Person[emenyid][CC.TXWZ3] = "易筋神髓"..str
        end
	end
  
    if DT(eid, 457) then  --凡总自带
        local str="・过去弥陀"
		local shang=math.modf(JY.Person[eid]["内力最大值"]*0.03)
		dng=dng+math.modf(JY.Person[eid]["内力"]*0.8)
		if dng>= 2000+math.modf(JY.Person[eid]["内力最大值"]*0.5) then
		    dng=2000+math.modf(JY.Person[eid]["内力最大值"]*0.5);
		end
		if JLSD(20,45,eid) and PersonGTHT(eid, 108, WAR.NGHT) then
		    local tmp=math.modf(JY.Person[eid]["内力"]*0.01);
		    ang = math.modf(ang/2);
		    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) +shang;
		    WAR.MENG[pid]=WAR.MENG[pid] or 0+20
  	        AddPersonAttrib(eid, "受伤程度", -tmp);
		    str="・未来无生"
		else
		 
		end
		if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
    	    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "易筋神髓"..str
        else
    	    WAR.Person[emenyid][CC.TXWZ3] = "易筋神髓"..str
        end
	end

    if T3XYK(pid) and JLSD(10, 60, pid) then   --萧雨客集气增加
		local str="・飞雪漫天"
	    WAR.XYKS = WAR.XYKS + 5
	    if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
    	    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "苍狼疾行"..str
        else
    	    WAR.Person[emenyid][CC.TXWZ2] = "苍狼疾行"..str
        end
    end
      
    --聂风加怒气
	if NF(pid) and juexing() > 0 then
		if WAR.LQZ[pid] == nil then
			WAR.LQZ[pid] = 25
		elseif WAR.LQZ[pid] > 85 and WAR.LQZ[pid] ~= 100 then
			WAR.LQZ[pid] = 100
		elseif WAR.LQZ[pid] < 100 then
			WAR.LQZ[pid] = WAR.LQZ[pid] + 20
		end
	end			
	
    --降龙柔劲加怒气
	if WAR.XLGJ == 2 or WAR.XLGJ == 4 or WAR.XLGJ == 5 then
		if WAR.LQZ[pid] == nil then
			WAR.LQZ[pid] = 30
		elseif WAR.LQZ[pid] > 70 and WAR.LQZ[pid] ~= 100 then
			WAR.LQZ[pid] = 100
		elseif WAR.LQZ[pid]  < 100 then
			WAR.LQZ[pid] = WAR.LQZ[pid] + 30
		end
	end

    --降龙柔劲
    if WAR.XLGJ == 2 or WAR.XLGJ == 4 or WAR.XLGJ == 5 then
	    local haonei = JY.Wugong[wugong]["消耗内力点数"] * (math.modf(level/100)+1)
		if JY.Person[pid]["内力"] + haonei > 10000 then
			JY.Person[pid]["内力"] = 10000
		else
			JY.Person[pid]["内力"] = JY.Person[pid]["内力"] + haonei
		end
	end

    --降龙柔劲
	if WAR.XLGJ == 2 or WAR.XLGJ == 4 or WAR.XLGJ == 5 then
	    if JY.Person[pid]["内力"] <= JY.Person[pid]["内力最大值"] then
			if JY.Person[pid]["内力"] + 620 < 9999 then
			   JY.Person[pid]["内力"] = JY.Person[pid]["内力"] + 620
			else
			   JY.Person[pid]["内力"] = 9999
			end
		end
	end	
  
    if wglw(pid,181) or (PersonGT(pid, 181)) then
		local haonei = JY.Wugong[wugong]["消耗内力点数"] * (math.modf(level/100)+1)
		if JY.Person[pid]["内力"] + haonei > 10000 then
			JY.Person[pid]["内力"] = 10000
		else
			JY.Person[pid]["内力"] = JY.Person[pid]["内力"] + haonei
		end
	end

    if wglw(pid,188) or (DT(pid,48) and PersonGT(pid,188)) then	 --神足经
		local haonei = JY.Wugong[wugong]["消耗内力点数"] * (math.modf(level/100)+1)
		if JY.Person[pid]["内力"] + haonei > 10000 then
			JY.Person[pid]["内力"] = 10000
		else
			JY.Person[pid]["内力"] = JY.Person[pid]["内力"] + haonei
		end
	end	

    if wglw(pid,188) or (DT(pid,48) and PersonGT(pid,188)) then	 --神足经
		local huiful = 2
	    local huifux = 2
		local aa = math.random(2)
		if aa == 1 then
			if JY.Person[pid]["生命"] < JY.Person[pid]["生命最大值"] then
				huiful = math.modf((JY.Person[pid]["生命最大值"] - JY.Person[pid]["生命"]) * 0.5)
				WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid,"生命",huiful)
				--JY.Person[pid]["生命"] = JY.Person[pid]["生命"] + huiful
				huifux ="神足经回血"..huiful
				DrawStrBox(-1,-1,huifux,C_GOLD,CC.Fontbig);
				ShowScreen();
				lib.Delay(1000);
				Cls()
				if JY.Person[pid]["生命"] > JY.Person[pid]["生命最大值"] then
					JY.Person[pid]["生命"] = JY.Person[pid]["生命最大值"]
				end
			end
			--[[if JY.Person[pid]["生命"] > JY.Person[pid]["生命最大值"] then
				JY.Person[pid]["生命"] = JY.Person[pid]["生命最大值"]
			end]]
		elseif aa == 2 then
			if JY.Person[pid]["内力"] < JY.Person[pid]["内力最大值"] then
				huiful = math.modf((JY.Person[pid]["内力最大值"]-JY.Person[pid]["内力"]) * 2)
				WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid,"内力",huiful)
				--JY.Person[pid]["内力"] = JY.Person[pid]["内力"]+huiful
				huifux ="神足经回内"..huiful
				DrawStrBox(-1,-1,huifux,C_GOLD,CC.Fontbig);
				ShowScreen();
				lib.Delay(1000);
				Cls()
				if JY.Person[pid]["内力"] > JY.Person[pid]["内力最大值"] then
					JY.Person[pid]["内力"] = JY.Person[pid]["内力最大值"]
				end
			end
		end
	end

    if DT(eid, 81) then --朱九真30%魅惑100时序
	    if ((pid >= 191 and pid <= 310) or (pid >= 320 and pid <= 409) or (pid >= 441 and pid <= 450) or
		    (pid >= 456 and pid <= 457)) and DWPD() then
		    local tmpcount = 0
		    for i = 0, WAR.PersonNum - 1 do
			    if WAR.Person[i]["死亡"] == false and WAR.Person[i]["我方"] ~= WAR.Person[emenyid]["我方"] then
				    tmpcount = tmpcount + 1
			    end
		    end
		    if tmpcount > 1 and JLSD(30, 60, eid) then --如果战场上敌人大于1, 30%几率魅惑100时序
			    WAR.Person[WAR.CurID]["我方"] = WAR.Person[emenyid]["我方"] 
			    WAR.NPC[pid] = 100 
		    end
	    end
    end
  
    if wugong== 127 and JY.Person[pid]["性别"] == 1 then --美女拳法10%魅惑30时序
	    if ((eid >= 191 and eid <= 310) or (eid >= 320 and eid <= 409) or (eid >= 441 and eid <= 450) or
		    (eid >= 456 and eid <= 457)) and DWPD() then
		    local tmpcount = 0
		    for i = 0, WAR.PersonNum - 1 do
			    if WAR.Person[i]["死亡"] == false and WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				    tmpcount = tmpcount + 1
			    end
		    end
		    if tmpcount > 1 and JLSD(10, 20, pid) then --如果战场上敌人大于1, 30%几率魅惑100时序
			    WAR.Person[emenyid]["我方"] = WAR.Person[WAR.CurID]["我方"] 
			    WAR.NPC[eid] = WAR.NPC[eid] or 0 + 30 
		    end
	    end
    end
	
    if wugong == 47 and (DT(pid, 592) or wglw1(pid, 47)) and JLSD(30, 50, pid) and DWPD() then	
		if WAR.Person[emenyid][CC.TXWZ2] == nil then
			WAR.Person[emenyid][CC.TXWZ2] = "独孤九剑・破尽天下"
		else
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+独孤九剑・破尽天下"
		end
		JY.Person[eid]["拳掌功夫"] = JY.Person[eid]["拳掌功夫"] - 1
		if JY.Person[eid]["拳掌功夫"] < 15 then
			JY.Person[eid]["拳掌功夫"] = 15
		end
	    JY.Person[eid]["御剑能力"] = JY.Person[eid]["御剑能力"] - 1
		if JY.Person[eid]["御剑能力"] < 15 then
			JY.Person[eid]["御剑能力"] = 15
		end
		JY.Person[eid]["耍刀技巧"] = JY.Person[eid]["耍刀技巧"] - 1
		if JY.Person[eid]["耍刀技巧"] < 15 then
			JY.Person[eid]["耍刀技巧"] = 15
		end
		JY.Person[eid]["特殊兵器"] = JY.Person[eid]["特殊兵器"] - 1
		if JY.Person[eid]["特殊兵器"] < 15 then
			JY.Person[eid]["特殊兵器"] = 15
		end
		JY.Person[eid]["暗器技巧"] = JY.Person[eid]["暗器技巧"] - 1
		if JY.Person[eid]["暗器技巧"] < 15 then
			JY.Person[eid]["暗器技巧"] = 15
		end
    end

    if wugong == 45 and (DT(pid, 592) or wglw1(pid, 45)) and JLSD(20, 40, pid) and DWPD() then	
		WAR.Person[emenyid][CC.TXWZ1] = "重剑奥义・一力降十会"
	    WAR.Person[emenyid][CC.TXDH] = 50
		JY.Person[eid]["攻击力"] = JY.Person[eid]["攻击力"] - 10
		if JY.Person[eid]["攻击力"] < 150 then
			JY.Person[eid]["攻击力"] = 150
		end
	    JY.Person[eid]["防御力"] = JY.Person[eid]["防御力"] - 10
		if JY.Person[eid]["防御力"] < 150 then
			JY.Person[eid]["防御力"] = 150
		end
		JY.Person[eid]["轻功"] = JY.Person[eid]["轻功"] - 10
		if JY.Person[eid]["轻功"] < 200 then
			JY.Person[eid]["轻功"] = 200
		end
		JY.Person[eid]["生命最大值"] = JY.Person[eid]["生命最大值"] - 50
		if JY.Person[eid]["生命最大值"] < 500 then
			JY.Person[eid]["生命最大值"] = 500
		end
		JY.Person[eid]["内力最大值"] = JY.Person[eid]["内力最大值"] - 75
		if JY.Person[eid]["内力最大值"] < 1000 then
			JY.Person[eid]["内力最大值"] = 1000
		end
    end		
	
    if DT(pid, 600) and JLSD(10,40,pid) then	
		JY.Person[pid]["拳掌功夫"] = JY.Person[pid]["拳掌功夫"] + 10
		if JY.Person[pid]["拳掌功夫"] > 999 then
			JY.Person[pid]["拳掌功夫"] = 999
		end
	    JY.Person[pid]["御剑能力"] = JY.Person[pid]["御剑能力"] + 10
		if JY.Person[pid]["御剑能力"] > 999 then
			JY.Person[pid]["御剑能力"] = 999
		end
		JY.Person[pid]["耍刀技巧"] = JY.Person[pid]["耍刀技巧"] + 10
		if JY.Person[pid]["耍刀技巧"] > 999 then
			JY.Person[pid]["耍刀技巧"] = 999
		end
		JY.Person[pid]["特殊兵器"] = JY.Person[pid]["特殊兵器"] + 10
		if JY.Person[pid]["特殊兵器"] > 999 then
			JY.Person[pid]["特殊兵器"] = 999
		end
		JY.Person[pid]["暗器技巧"] = JY.Person[pid]["暗器技巧"] + 10
		if JY.Person[pid]["暗器技巧"] > 999 then
			JY.Person[pid]["暗器技巧"] = 999
		end
	end 		
	
    if (wglw(pid,181) or DT(pid, 455)) and PersonGT(pid, 181) and JLSD(10,40,pid) then	
		JY.Person[pid]["拳掌功夫"] = JY.Person[pid]["拳掌功夫"] + 5
		if JY.Person[pid]["拳掌功夫"] > 999 then
			JY.Person[pid]["拳掌功夫"] = 999
		end
	    JY.Person[pid]["御剑能力"] = JY.Person[pid]["御剑能力"] + 5
		if JY.Person[pid]["御剑能力"] > 999 then
			JY.Person[pid]["御剑能力"] = 999
		end
		JY.Person[pid]["耍刀技巧"] = JY.Person[pid]["耍刀技巧"] + 5
		if JY.Person[pid]["耍刀技巧"] > 999 then
			JY.Person[pid]["耍刀技巧"] = 999
		end
		JY.Person[pid]["特殊兵器"] = JY.Person[pid]["特殊兵器"] + 5
		if JY.Person[pid]["特殊兵器"] > 999 then
			JY.Person[pid]["特殊兵器"] = 999
		end
		JY.Person[pid]["暗器技巧"] = JY.Person[pid]["暗器技巧"] + 5
		if JY.Person[pid]["暗器技巧"] > 999 then
			JY.Person[pid]["暗器技巧"] = 999
		end
	end 		
	
    if wugong == 45 and ((DT(pid, 592) or DT(pid, 607)) or wglw1(pid, 45)) and JLSD(10, 60, pid) then	
		WAR.Person[emenyid][CC.TXWZ1] = "玄铁重剑・逆挑"
	    WAR.Person[emenyid][CC.TXDH] = 40
		local s = 1000 + JY.Person[pid]["内力"] - JY.Person[eid]["内力"];
        if s < 0 then
            s = 0;
	    end 
	   	ang = ang+s
  	    AddPersonAttrib(eid, "受伤程度", 30);
        WAR.LXZT[eid] = WAR.LXZT[eid] or 0 + 30
	    if 50 < WAR.LXZT[eid] then
	        WAR.LXZT[eid] = 50
	    end
	end		
	
	if wugong == 45 and ((DT(pid, 592) or DT(pid, 607)) or wglw1(pid, 45)) and JLSD(10, 60, pid) then
		WAR.Person[emenyid][CC.TXWZ1] = "玄铁重剑・顺刺"
	    WAR.Person[emenyid][CC.TXDH] = 30
        if WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
 	        local d = math.modf((JY.Person[pid]["内力"] - JY.Person[eid]["内力"]) / 100)
            if d < 10 then
                d = 10
            end 
  	        WAR.MENG[eid] = limitX((WAR.MENG[eid] or 0) + d, 0, 100)
	        WAR.OYFSD[eid] = limitX((WAR.OYFSD[eid] or 0) + d, 0, 100);
        end
        if WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
            local SN=math.modf(JY.Person[eid]["内力"]/200*sixi(pid,2)*0.01)
	        local SN2=SN*10
	        AddPersonAttrib(eid, "生命", -SN)
	        WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0)+AddPersonAttrib(eid, "生命", -SN)
	        AddPersonAttrib(eid, "内力", -SN2)
	        WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0)+AddPersonAttrib(eid, "内力", -SN2)
        end
	end	
 	
	if wugong == 45 and ((DT(pid, 592) or DT(pid, 607)) or wglw1(pid, 45)) and JLSD(10, 60, pid) then
		WAR.Person[emenyid][CC.TXWZ1] = "玄铁重剑・横削"
	    WAR.Person[emenyid][CC.TXDH] = 20
	    if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emenyid]["我方"] then
	        if math.random(10)<5 then
	            WAR.BZ[eid]=WAR.BZ[eid] or 0 +1
	        end
	        WAR.GUDUVICTIE[eid]=WAR.GUDUVICTIE[eid] or 0 +1
	        local aa=math.modf(JY.Person[eid]["内力"] / 10) 
	        WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -aa);
        end
	end	
	
    if DT(pid,600) and JLSD(10,35,pid) and (not wglw(pid,181)) and DWPD() then --强极十道
	    WAR.WS = 1
		--[[
        JY.Person[eid]["拳掌功夫"] = JY.Person[eid]["拳掌功夫"] - 999
		if JY.Person[eid]["拳掌功夫"] < 1 then
			JY.Person[eid]["拳掌功夫"] = 1
		end
	    JY.Person[eid]["御剑能力"] = JY.Person[eid]["御剑能力"] - 999
		if JY.Person[eid]["御剑能力"] < 1 then
			JY.Person[eid]["御剑能力"] = 1
		end
		JY.Person[eid]["耍刀技巧"] = JY.Person[eid]["耍刀技巧"] - 999
		if JY.Person[eid]["耍刀技巧"] < 1 then
			JY.Person[eid]["耍刀技巧"] = 1
		end
		JY.Person[eid]["特殊兵器"] = JY.Person[eid]["特殊兵器"] - 999
		if JY.Person[eid]["特殊兵器"] < 1 then
			JY.Person[eid]["特殊兵器"] = 1
		end
		JY.Person[eid]["暗器技巧"] = JY.Person[eid]["暗器技巧"] - 999
		if JY.Person[eid]["暗器技巧"] < 1 then
			JY.Person[eid]["暗器技巧"] = 1
		end
		JY.Person[eid]["攻击力"] = JY.Person[eid]["攻击力"] - 999
		if JY.Person[eid]["攻击力"] < 1 then
			JY.Person[eid]["攻击力"] = 1
		end
	    JY.Person[eid]["防御力"] = JY.Person[eid]["防御力"] - 999
		if JY.Person[eid]["防御力"] < 1 then
			JY.Person[eid]["防御力"] = 1
		end
		JY.Person[eid]["轻功"] = JY.Person[eid]["轻功"] - 999
		if JY.Person[eid]["轻功"] < 1 then
			JY.Person[eid]["轻功"] = 1
		end
		JY.Person[eid]["生命最大值"] = JY.Person[eid]["生命最大值"] - 9999
		if JY.Person[eid]["生命最大值"] < 1 then
			JY.Person[eid]["生命最大值"] = 1
		end
		JY.Person[eid]["内力最大值"] = JY.Person[eid]["内力最大值"] - 9999
		if JY.Person[eid]["内力最大值"] < 1 then
			JY.Person[eid]["内力最大值"] = 1
		end	
		]]
		JY.Person[eid]["生命"] = math.min(1, JY.Person[eid]["生命"])
		JY.Person[eid]["内力"] = math.min(1, JY.Person[eid]["内力"])
		JY.Person[eid]["体力"] = math.min(1, JY.Person[eid]["体力"])
		WAR.QJSD1 = 1
	end			
	--[[
    if WAR.WSXW == 1 and DWPD() then
        JY.Person[eid]["攻击力"] = math.min(200, JY.Person[eid]["攻击力"])
		JY.Person[eid]["防御力"] = math.min(200, JY.Person[eid]["防御力"])
		JY.Person[eid]["轻功"] = math.min(200, JY.Person[eid]["轻功"])	
	end	
	]]
    if WAR.XYFQ == 1 then 
		for i = 0, WAR.PersonNum - 1 do 
			if WAR.Person[i]["我方"] == false and WAR.Person[i]["死亡"] == false and i ~= WAR.CurID then
				WAR.Person[i].Time = math.max(WAR.Person[i].Time - 300, -600)
			end
		end 		
	end 		
	
    if wugong == 25 and (DT(pid, 58) or wglw1(pid,25)) and WAR.LQZ[pid] == 100 then	
		local s = 1000 + JY.Person[pid]["内力"] - JY.Person[eid]["内力"];
        if s < 0 then
            s = 0;
	    end 
	   	ang = ang+s
  	    AddPersonAttrib(eid, "受伤程度", 10);
        WAR.LXZT[eid] = WAR.LXZT[eid] or 0 + 30
	    if 30 < WAR.LXZT[eid] then
	        WAR.LXZT[eid] = 30
	    end
		WAR.Person[emenyid][CC.TXWZ1] = "黯然销魂・力不从心"
	end
	
	if wugong == 25 and (DT(pid, 58) or wglw1(pid,25)) and WAR.LQZ[pid] == 100 then	
        if math.random(10)<5 then
	        WAR.BZ[eid]=WAR.BZ[eid] or 0 +1
	    end	
		WAR.Person[emenyid][CC.TXWZ2] = "黯然销魂・徘徊空谷"
	end	
	
    if wugong == 66 and ((DT(pid, 103) or DT(pid, 595)) or wglw1(pid,66)) and JLSD(10, 60, pid) then --火焰刀封穴
		WAR.WS = 1
        for i = 0, WAR.PersonNum - 1 do 
			if WAR.Person[i]["我方"] == false and WAR.Person[i]["死亡"] == false and i ~= WAR.CurID then
				WAR.Person[i].Time = math.max(WAR.Person[i].Time - 200, -500)
				WAR.FXXS[WAR.Person[i]["人物编号"]] = 1 
			if WAR.FXDS[WAR.Person[i]["人物编号"]] ~= nil then
				WAR.FXDS[WAR.Person[i]["人物编号"]] = WAR.FXDS[WAR.Person[i]["人物编号"]] + math.random(30,60)
			else
				WAR.FXDS[WAR.Person[i]["人物编号"]] = math.random(30,60)
			end
			end
		end
		WAR.Person[WAR.CurID][CC.TXWZ2] = "火焰刀・凝集"
        WAR.Person[WAR.CurID][CC.TXDH] = 120
	end		
	
	if wugong == 66 and ((DT(pid, 103) or DT(pid, 595)) or wglw1(pid,66)) and JLSD(10, 60, pid) then --火焰刀杀气
        for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
		        local nl = math.modf((JY.Person[pid]["内力"] * 2 + JY.Person[pid]["内力最大值"])/3)
                local tmpid=WAR.Person[j]["人物编号"]
		        local enemynl = math.modf(JY.Person[tmpid]["内力"] * 0.8)
		        local tmpshaqi = math.modf((nl - enemynl)/40)
		        if tmpshaqi < 0 then tmpshaqi = 0 end
		            WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - 100 - tmpshaqi
                end
            end
        WAR.Person[emenyid][CC.TXWZ2] = "火焰刀・虚无缥缈"
        WAR.Person[emenyid][CC.TXDH] = 119
	end
	
	if wugong == 66 and ((DT(pid, 103) or DT(pid, 595)) or wglw1(pid,66)) and JLSD(10, 60, pid) then
        local x1 = WAR.Person[WAR.CurID]["坐标X"];
		local y1 = WAR.Person[WAR.CurID]["坐标Y"];
		for ex = x1 - 10, x1 + 10 do
			for ey = y1 - 10, y1 + 10 do
				SetWarMap(ex, ey, 4, 1)
				if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
				local ep = GetWarMap(ex, ey, 2)
					if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[ep]["我方"] then
						WAR.L_WNGZL[WAR.Person[ep]["人物编号"]] = 50;
						SetWarMap(ex, ey, 4, 4)
						WAR.Person[emenyid][CC.TXWZ2] = "火焰刀・虚劲伤人"
                         WAR.Person[emenyid][CC.TXDH] = 120
					end
				end
			end
		end	
    end	 		
	
	if wugong == 86 and (DT(pid, 615) or wglw1(pid,86)) and WAR.LQZ[pid] == 99 then	
	    WAR.BZ[eid] = 2	
		if WAR.LQZ[pid] ~= nil then
		   dng = 0
		   hurt = math.modf(hurt * 2)
	       ang = ang + 2500 + math.modf((WAR.LQZ[pid] or 0) * 100)
	    else
	       ang = ang + 2500
	    end
		if WAR.LQZ[pid] ~= nil and WAR.LQZ[pid] >= 99 then
		hurt = math.modf(hurt * 2)
	    end
		if WAR.Person[WAR.CurID][CC.TXWZ1] ~= nil then
			WAR.Person[WAR.CurID][CC.TXWZ1] = WAR.Person[WAR.CurID][CC.TXWZ1] .."+伏魔杖法・金刚护法"
		else
			WAR.Person[WAR.CurID][CC.TXWZ1] = "伏魔杖法・金刚护法"
		end
	end
    	
	if wugong == 86 and (DT(pid, 615) or wglw1(pid,86)) and JLSD(10, 40, pid) then	
	    for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then				
				local tmppid = WAR.Person[j]["人物编号"]
				WAR.L_NOT_MOVE[tmppid]=WAR.L_NOT_MOVE[tmppid] or 0 + 1
			end
		end		
		if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .."+伏魔杖法・大鹏展翅"
		else
			WAR.Person[emenyid][CC.TXWZ3] = "伏魔杖法・大鹏展翅"
		end
	end		
	
    if wugong == 86 and DT(pid, 457) and WAR.LQZ[pid] == 99 then	--凡总自带
	    WAR.BZ[eid] = 2	
		if WAR.LQZ[pid] ~= nil then
		   dng = 0
		   hurt = math.modf(hurt * 2)
	       ang = ang + 2500 + math.modf((WAR.LQZ[pid] or 0) * 100)
	    else
	       ang = ang + 2500
	    end
		if WAR.LQZ[pid] ~= nil and WAR.LQZ[pid] >= 99 then
		hurt = math.modf(hurt * 2)
	    end
		if WAR.Person[WAR.CurID][CC.TXWZ1] ~= nil then
			WAR.Person[WAR.CurID][CC.TXWZ1] = WAR.Person[WAR.CurID][CC.TXWZ1] .."+伏魔杖法・金刚护法"
		else
			WAR.Person[WAR.CurID][CC.TXWZ1] = "伏魔杖法・金刚护法"
		end
	end
    	
	if wugong == 86 and DT(pid, 457) then	--凡总自带
	    for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then				
				local tmppid = WAR.Person[j]["人物编号"]
				WAR.L_NOT_MOVE[tmppid]=WAR.L_NOT_MOVE[tmppid] or 0 + 1
			end
		end		
		if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .."+伏魔杖法・大鹏展翅"
		else
			WAR.Person[emenyid][CC.TXWZ3] = "伏魔杖法・大鹏展翅"
		end
	end		
	
    if wugong == 8 and ((DT(pid, 618) or DT(pid, 116)) or wglw1(pid,8)) and WAR.LQZ[pid] == 100	 then 
		local a = math.modf(JY.Person[pid]["内力"] * 6) 
	    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -a);
  	    AddPersonAttrib(eid, "受伤程度", 100);
		if WAR.Person[emenyid][CC.TXWZ3] == nil then
			WAR.Person[emenyid][CC.TXWZ3] = "落日熔金"
	    else
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."+落日熔金"
	    end	
	end		
	
    if wugong == 8 and ((DT(pid, 618) or DT(pid, 116)) or wglw1(pid,8)) and JLSD(10, 60, pid) then
        if JY.Person[eid]["内力性质"] == 0 then
			WAR.KHBX = 2	        
	    elseif JY.Person[eid]["内力性质"] == 1 then
	        WAR.L_NOT_MOVE[eid] = 1     
		end  
		if JY.Person[eid]["内力性质"] >= 2 then
	        WAR.LHZF[eid] = WAR.LHZF[eid] or 0 + 1
	    end
		if WAR.Person[emenyid][CC.TXWZ3] == nil then
			WAR.Person[emenyid][CC.TXWZ3] = "天山阴阳掌"
	    else
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."+天山阴阳掌"
	    end	
	end		
	
	if wugong == 8 and ((DT(pid, 618) or DT(pid, 618)) or wglw1(pid,8)) and JLSD(10, 60, pid) then
        hurt = math.modf(hurt * 2)
	    ang = math.modf(ang * 2)
	    dng = dng+math.modf(sixi(eid,1) * 15)
	    local a1 = math.modf(dng/2)
        local a2 = math.modf(ang/20)
	    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + a1
	    AddPersonAttrib(eid, "内力", a1)
	    JY.Person[pid]["受伤程度"] = JY.Person[pid]["受伤程度"] - a2
	    WAR.HOT[eid] = (WAR.HOT[eid] or 0) + (a2 * 2)	
		WAR.Person[emenyid][CC.TXWZ2] = "真・阳歌天钧"
	end 
	
	if wugong == 8 and ((DT(pid, 618) or DT(pid, 116)) or wglw1(pid,8)) and JLSD(10, 60, pid) then
	    dng = 0
	    if math.random(10)<5 then
	        WAR.BZ[eid]=WAR.BZ[eid] or 0 +1
	    end
	        WAR.Person[emenyid][CC.TXWZ2] = "真・阳春白雪"
	end	
		
	if wugong == 8 and ((DT(pid, 618) or DT(pid, 116)) or wglw1(pid,8)) and JLSD(10, 60, pid) then	
        WAR.DLYZ[eid]=WAR.DLYZ[eid] or 0 + 1
		WAR.Person[emenyid][CC.TXWZ2] = "真・阳关三叠"
	end	
	
    if wugong == 8 and ((DT(pid, 618) or DT(pid, 116)) or wglw1(pid,8)) and JLSD(10, 60, pid) then
		local a1 = math.modf(sixi(pid, 1) / 5)
		local a2 = math.modf(sixi(pid, 1) / 5)
		local a3 = limitX(math.random(a1, a2), 1, 24)
		hurt = hurt +  math.modf(a3 * 20)				
		hurt = hurt + math.modf(hurt * (1-JY.Person[eid]["内力"] / JY.Person[eid]["内力最大值"]) * (3 * a3))
		if JY.Person[pid]["内力"] >= JY.Person[eid]["内力"] then
		    hurt = hurt+math.modf((JY.Person[pid]["内力"] - JY.Person[eid]["内力"]) / 20 * (3 * a3))
		end
	    if WAR.Person[emenyid][CC.TXWZ1] == nil then
			WAR.Person[emenyid][CC.TXWZ1] = "云霞出海曙 白日参辰现"
	    else
			WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1].."+云霞出海曙 白日参辰现"
	    end	
	end
	--胡刀战意技
	if wugong == 67 and (wglw1(pid,67) or (DT(pid, 1) and JX(pid)) or (DT(pid, 621) and JX(pid))) and WAR.LQZ[pid] == 100 and WAR.SPIRIT[pid] >= 140 then--
		local a1 = WAR.QLP or 0
		local a2 = WAR.YLP[eid] or 0
		local a3 = math.modf(JY.Person[pid]["攻击力"] * 0.1)
		local a4 = math.modf(JY.Person[pid]["防御力"] * 0.1)
		local a5 = math.modf(JY.Person[pid]["轻功"] * 0.1)
		local a6 = a3+a4+a5
		hurt = hurt + math.modf((hurt * a1 * a2 * a6)*0.7)
		if sixi(pid,3) >= sixi(eid,3) then
		    hurt = hurt+math.modf((hurt * a1 * a2 * a6 * (sixi(pid,3)/10))*0.7)
		end
		WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) +	AddPersonAttrib(eid, "生命", -(hurt*0.3))
	end	
	
    if wugong == 17 and ((DT(pid, 65) or DT(pid, 602)) or wglw1(pid,17)) and JLSD(10, 60, pid) then	
	    for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - 150
				local tmppid = WAR.Person[j]["人物编号"]
				WAR.LXZT[tmppid]=WAR.LXZT[tmppid] or 0 + math.random(10,30)
				local bb=WAR.LXZT[tmppid]
				AddPersonAttrib(tmppid, "受伤程度", bb)
			end
		end		
	    WAR.Person[emenyid][CC.TXWZ1] = "变化无穷 虚实莫测"	
	end
	
	if wugong == 17 and ((DT(pid, 65) or DT(pid, 602)) or wglw1(pid,17)) and DWPD() == false then	
	    local fhurt = math.modf(hurt * 1.5) + Rnd(10)
		hurt = 0
		AddPersonAttrib(eid, "生命", fhurt)
		WAR.Person[emenyid]["真伤点数"] = fhurt
        AddPersonAttrib(eid, "受伤程度", -20)	
		WAR.Person[WAR.CurID][CC.TXWZ2] = "声东击西 欲虚反实"		   
	end
	
	if wugong == 17 and ((DT(pid, 65) or DT(pid, 602)) or wglw1(pid,17)) and JLSD(10, 60, pid) and DWPD() then	
	    if math.random(10)<5 then
	        WAR.BZ[eid]=WAR.BZ[eid] or 0 +1
	    end
		WAR.Person[WAR.CurID][CC.TXWZ3] = "空手进招 暗点大穴"
	end	
		
    if wugong == 17 and ((DT(pid, 65) or DT(pid, 602)) or wglw1(pid,17)) and JLSD(10, 60, pid) then			
		WAR.DLYZ[eid]=WAR.DLYZ[eid] or 0 + 1
		WAR.Person[WAR.CurID][CC.TXWZ1] = "动若江河 静如山岳"
	end 	
		
    if wugong == 11 and (DT(pid,599) or wglw1(pid,11)) and JLSD(10,45,pid) then	
	    for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then				
				local tmppid = WAR.Person[j]["人物编号"]
				WAR.L_NOT_MOVE[tmppid] = WAR.L_NOT_MOVE[tmppid] or 0 + 1
			end
		end		
		if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .."+".."摧坚神爪・无坚不破"
		else
			WAR.Person[emenyid][CC.TXWZ3] = "摧坚神爪・无坚不破"
		end
	end				
		
    if wugong == 11 and (DT(pid,599) or wglw1(pid,11)) and JLSD(10,45,pid) and DWPD() then
		WAR.ACT = 10
		for j = 0, WAR.PersonNum - 1 do
		    local tmppid = WAR.Person[j]["人物编号"]
		    WAR.YHDF[tmppid] = 1    
			WAR.YHDF[eid] = 1
		end
		WAR.Person[emenyid][CC.TXWZ2] = "摧坚神爪・摧敌首脑"
	end		
	
	if wugong == 83 and wglw1(pid,83) and DWPD() then
		WAR.ACT = 10
	end
	
	if wugong == 11 and (DT(pid,599) or wglw1(pid,11)) and JLSD(10,45,pid) then		
        for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then				
				local tmppid = WAR.Person[j]["人物编号"]
				WAR.HOT[tmppid] = WAR.HOT[tmppid] or 0 + 30
				local aa = WAR.HOT[tmppid] * 9
				AddPersonAttrib(tmppid, "生命", -aa)
			end
		end				
	    if WAR.Person[emenyid][CC.TXWZ1] ~= nil then
			WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .."+摧坚神爪・如穿腐土"
		else
			WAR.Person[emenyid][CC.TXWZ1] = "摧坚神爪・如穿腐土"
		end
	end			
		
    if wglw(pid,185) or (PersonGT(pid,185) and DT(pid,5)) or DT(pid,666) and (JLSD(40,70,pid) or WAR.LQZ[pid] == 100) then	
		   dng = 0
		   hurt = math.modf(hurt * 3)
	       ang = ang + 3000 + math.modf((WAR.LQZ[pid] or 0) * 100)
		if WAR.Person[WAR.CurID][CC.TXWZ1] ~= nil then
			WAR.Person[WAR.CurID][CC.TXWZ1] = WAR.Person[WAR.CurID][CC.TXWZ1] .."+武当九阳・后劲"
		else
			WAR.Person[WAR.CurID][CC.TXWZ1] = "武当九阳・后劲"
		end
	end		
		
    if (wglw(pid,188) or (DT(pid,48) and PersonGT(pid,188))) and JLSD(10,40,pid) then --神足经	
		for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then				
				local tmppid = WAR.Person[j]["人物编号"]
				WAR.HOT[tmppid] = WAR.HOT[tmppid] or 0 + 30
				local a = WAR.HOT[tmppid] * 5
				WAR.ICE[tmppid] = WAR.ICE[tmppid] or 0 + 30
				local b = WAR.ICE[tmppid] * 5
				AddPersonAttrib(tmppid, "生命", -a)
				AddPersonAttrib(tmppid, "内力", -b)
			end
		end				
	    if WAR.Person[emenyid][CC.TXWZ1] ~= nil then
			WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .."+神足经・勘破人相"
		else
			WAR.Person[emenyid][CC.TXWZ1] = "神足经・勘破人相"
		end
	end	

	--逍遥游领悟
	if wglw2(pid,197) and WAR.XYYLW2[pid] ~= nil and WAR.XYYLW2[pid] >= 8 then
		if JLSD(10,50,pid) then
			DIYdisplay("逍遥醉步・八仙神降")
			WAR.XYYLW2[pid] = nil
			WAR.ZBX[pid] = 9
		end
	end	
	--追魂无影领悟
	if wglw2(eid,191) and PersonKF(eid,191) and JLSD(10,60,eid) then
		local lx = WAR.LXZT[eid] or 0
		hurt = hurt * math.modf(1-(lx/105))
	end
		
  	--无九阴逆运走火，普通角色不再走火
    if PersonKF(eid, 104) and not PersonKF(eid, 107) then
		if WAR.tmp[1000 + eid] ~= 1 and WAR.ZDDH ~= 171 and (DT(eid, 60) or DT(eid, 620)) then
			if JY.Person[eid]["体力"] > 50 then
			    WAR.Person[emenyid][CC.TXDH] = math.fmod(wugong, 10) + 85
			    if (DT(eid, 60) or DT(eid, 620)) then
			      WAR.Person[emenyid][CC.TXWZ1] = CC.WARS108		--真--逆运筋脉走火入魔
			    else
			    	WAR.Person[emenyid][CC.TXWZ1] = CC.WARS109
			    end
			    WAR.tmp[1000 + eid] = 1
			end
		end		
	end
  
    if wglw(eid,43) or (DT(eid,666) and PersonKF(eid,43)) and JLSD(10,50,eid) and DWPD() then
		WAR.FLHS4 = 1
	    WAR.ACT = 10
	    WAR.ZYHB = 0
		if WAR.FXDS[eid] == nil then
		    if WAR.FXDS[pid] == nil then
			    WAR.FXDS[pid] = 20
		    else
			    WAR.FXDS[pid] = WAR.FXDS[pid] + 80
		    end
		end 	
		if WAR.LXZT[eid] == nil then
		    if WAR.LXZT[pid] == nil then
			    WAR.LXZT[pid] = 20
		    else
			    WAR.LXZT[pid] = WAR.LXZT[pid] + 80
		    end	
		end 
		if WAR.CHZ[eid] == nil then
		    if WAR.CHZ[pid] == nil then
			    WAR.CHZ[pid] = 20
		    else
			    WAR.CHZ[pid] = WAR.CHZ[pid] + 80
		    end		
		end 		
		if WAR.ICE[eid] == nil then
			if WAR.ICE[pid] == nil then
				WAR.ICE[pid] = 0
			else
			    WAR.ICE[pid] = WAR.ICE[pid] + 80	
			end
		end	
		if WAR.HOT[eid] == nil then
			if WAR.HOT[pid] == nil then
				WAR.HOT[pid] = 0
			else
			    WAR.HOT[pid] = WAR.HOT[pid] + 80	
			end
		end	
		AddPersonAttrib(eid, "受伤程度", -100)
		AddPersonAttrib(eid, "中毒程度", -100) 
	    AddPersonAttrib(pid, "受伤程度", 100)
		AddPersonAttrib(pid, "中毒程度", 100) 
		if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "星月交辉"
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "星月交辉"
	    end	
    end

    if ((MPPD(eid) == 12 and PersonKF(eid,88) and not PersonGT(eid,105) and GetS(54,0,0,1) == 1) or DT(eid,26)) and MPDJ(eid) > 1 and DWPD() then
        if WAR.FXDS[eid] == nil then
		    if WAR.FXDS[pid] == nil then
			    WAR.FXDS[pid] = 10
		    else
			    WAR.FXDS[pid] = WAR.FXDS[pid] + 8
		    end
		end 	
		if WAR.LXZT[eid] == nil then
		    if WAR.LXZT[pid] == nil then
			    WAR.LXZT[pid] = 10
		    else
			    WAR.LXZT[pid] = WAR.LXZT[pid] + 8
		    end	
		end 
		if WAR.CHZ[eid] == nil then
		    if WAR.CHZ[pid] == nil then
			    WAR.CHZ[pid] = 2
		    else
			    WAR.CHZ[pid] = WAR.CHZ[pid] + 8
		    end		
		end 		
		if WAR.ICE[eid] == nil then
			if WAR.ICE[pid] == nil then
				WAR.ICE[pid] = 0
			else
			    WAR.ICE[pid] = WAR.ICE[pid] + 8	
			end
		end	
		if WAR.HOT[eid] == nil then
			if WAR.HOT[pid] == nil then
				WAR.HOT[pid] = 0
			else
			    WAR.HOT[pid] = WAR.HOT[pid] + 8	
			end
		end	
		if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "星离雨散"
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "星离雨散"
	    end	
    end  

    --[[if DWPD() and JY.Person[eid]["防具"] == 253 and JLSD(10, 50, eid) then
	SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 4, 5)
	WAR.Person[WAR.CurID]["中毒点数"] = (WAR.Person[WAR.CurID]["中毒点数"] or 0) + AddPersonAttrib(pid, "中毒程度", math.random(2, 5))
	if WAR.Person[emenyid][CC.TXWZ1] ~= nil then
		WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" .."七心海棠护身"
	else
		WAR.Person[emenyid][CC.TXWZ1] = "七心海棠护身"
	end  
    end]]
  
  	if MPPD(eid) == 13 then	
		if WAR.Person[WAR.CurID]["我方"] ~=true then		
			effect(77,"特效文字2","焚我残躯",0,0)
			JY.Person[pid]["生命"] = JY.Person[pid]["生命"]- (MPDJ(eid) * 30)
			JY.Person[pid]["受伤程度"]=JY.Person[pid]["受伤程度"]+(MPDJ(eid) * 5)
			WAR.HOT[pid] = (WAR.HOT[pid] or 0) + (MPDJ(eid) * 5)
			if WAR.MJBCJ[pid] ~=nil then
				JY.Person[pid]["生命"] = JY.Person[pid]["生命"]- (WAR.MJBCJ[pid] * 50)
				JY.Person[pid]["受伤程度"]=JY.Person[pid]["受伤程度"]+(WAR.MJBCJ[pid] * 10)
			end		
		end
	end
  
    if wglw(eid,89) or (DT(eid,19) and PersonKF(eid,89)) then --紫霞剑系
        if WAR.ZXJQ[eid] ~= nil and WAR.ZXJQ[eid] > 0 then
            dng = dng + WAR.ZXJQ[eid]*300
	   end
    end
  
    if NF(eid) then --创刀
        if WAR.CDDQ[eid] ~= nil and WAR.CDDQ[eid] > 0 then
            dng = dng + WAR.CDDQ[eid]*300
	    end
    end

    if BJY(eid) then --霍家剑气
		if WAR.HJJQ[eid] ~= nil and WAR.HJJQ[eid] > 0 then
            dng = dng + WAR.HJJQ[eid]*300
	    end
    end

    if wglw(eid,43) or (DT(eid,666) and PersonKF(eid,43)) and JLSD(10,60,eid) and DWPD() then  
		WAR.FLHS4 = 1
	    WAR.ACT = 10
	    WAR.ZYHB = 0
	    WAR.LHFM[pid] =	limitX((WAR.LHFM[pid] or 0) + 30, 0, 100)
		if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "星流霆击"
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "星流霆击"
	    end	
	end

    if (PersonGTHT(eid, 105, WAR.HGHT) and (DT(eid, 455))) or (PersonGTHT(eid, 105, WAR.HGHT) and wglw(eid, 105) and JLSD(20, 70, eid)) or DT(eid,617) then  --葵花领悟后消耗内力免杀气、降低伤害
        WAR.Person[emenyid][CC.TXWZ3] = "葵花涅・延祸苍生"
        WAR.Person[emenyid][CC.TXDH] = 144
        dng = 1
        if hurt > 150 and JY.Person[eid]["内力"] >= 500 then
            WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - 500
	        AddPersonAttrib(eid, "内力", -500)
	        hurt=math.modf(hurt * 0.5)
            if hurt > 100 and JLSD(20, 70, eid) then
                hurt = 100
            end
	    end
	end

    if (PersonGTHT(eid,106,WAR.HGHT) and (DT(eid,9))) or (PersonGTHT(eid,106,WAR.HGHT) and wglw(eid,106) and JLSD(20,70,eid)) then  --九阳领悟后消耗内力免杀气、降低
        if WAR.Person[emenyid][CC.TXWZ3] == nil then
			WAR.Person[emenyid][CC.TXWZ3] = "他强由他强・清风拂山岗"
	     else
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."+他强由他强・清风拂山岗"
	    end	
        dng = 1
        if hurt > 150 and JY.Person[eid]["内力"]>=500 then
            WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - 500
	        AddPersonAttrib(eid, "内力", -500)
	        hurt=math.modf(hurt*0.5)
            if hurt > 50 and JLSD(20, 70, eid) then
                hurt = 50
            end
	    end
	end

    if WAR.KTAY2 == 1 then
		if hurt > 150 and JY.Person[eid]["内力"]>=500 then
            WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - 500
	        AddPersonAttrib(eid, "内力", -500)
	        hurt=math.modf(hurt*0.5)
            if hurt > 50 then
                hurt = 50
            end
	    end
	end 	

    --沼跃鱼：明教圣火阵
    if MPPD(eid) == 13 then
        local xg = MPDJ(eid)
	    local shz = 0
        for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] then
                shz = shz + 1
            end
        end
        if shz >= 2 then
    	    hurt = math.modf(hurt * (1 - (shz)*0.02*xg))
    	    dng = dng + (shz) * 40 * xg
  	    end
	    if shz > 8 then
	        shz = 8
	    end
    end
  
    --沼跃鱼：全真七星北斗阵
    if MPPD(eid) == 16 then
        local xg = MPDJ(eid)
	    local shz = 0
        for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] then
                shz = shz + 1
            end
        end
	    if shz > 8 then
	        shz = 8
	    end
        if shz >= 2 then
    	    dng = dng + (shz) * 100 * xg
  	    end
    end
  
    if MPPD(eid)==16 and PersonGTHT(eid,100,WAR.NGHT) and JLSD(20,50,eid) then ----气罡剑法
	   hurt = hurt - math.modf(dng * 0.05)
        if hurt<= 1 then
	        hurt=1
        end	   
	    if WAR.Person[emenyid][CC.TXWZ3] == nil then
		    WAR.Person[emenyid][CC.TXWZ3] = "紫阳剑罡.紫气护体"
	    else
		    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "紫阳剑罡.紫气护体"
	    end	
	    WAR.Person[emenyid][CC.TXDH] = 101
	end 

	if MPPD(eid) == 1 and DWPD() then
		WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", math.random(3, 10))
	end
	
	if MPPD(eid) == 8 and DWPD() and PersonGTHT(eid,95,WAR.NGHT) then--白驼山主运蛤蟆
		WAR.Person[WAR.CurID]["中毒点数"] = (WAR.Person[WAR.CurID]["中毒点数"] or 0) + AddPersonAttrib(pid, "中毒程度", math.random(3, 10))
		WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", math.random(3, 10))
	    if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "蟾毒秘要・万毒缠身"
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+万毒缠身"
	    end
	        WAR.Person[emenyid][CC.TXDH] = 112
	end
	
	if DT(eid, 619) then --耶律齐额外气防
		dng = dng + math.modf(hurt * math.random(5, 10))
	end
	
    --豸苗：谢云流一刀流防御+500
    if MPPD(eid) == 11 then 
		dng = dng + 500
	end
	  
	if PersonGT(eid,180) and XYL(eid) then
	    dng = dng + 500
	end

    if PersonGT(eid,181) then
		dng = dng + 600
	end

    --魔音・碧海潮生
	if wglw(eid,6) or (PersonKF(eid,6) and DT(eid,57)) then
	    dng = dng + WAR.BHZC*400
	end	
	
	--谢烟客气防
	if DT(eid,164) and WAR.BZQZ ~= 0 then
	    if ZYBF(eid) then 
	       dng = dng + WAR.BZQZ*5
		else
		   dng = dng + WAR.BZQZ*3
		end   
	end
	
    -- 三千越甲不可敌12-29-
	if DT(eid,614) then 
	    local dfnum = 0
	    for j = 0, WAR.PersonNum - 1 do
	        if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
	    	    dfnum = dfnum + 1
	        end
	    end
	    dng = dng + limitX(2200-dfnum*200,400,2000)
	end
	
	if T13TQS(eid) then --沼跃鱼：气防与刀系数有关
	    local xishu=sixi(eid,3)
        dng=dng+xishu*15 
    end   	
	
	if wssz(eid) then --沼跃鱼：气防与刀系数有关
	    local xishu=sixi(eid,3)
        dng=dng+xishu*15 
    end  
	
    if NF(eid) then	
		local xishu = sixi(eid,3)
		dng = dng + xishu * 20
	end	
	
	if (wglw(eid,101) or (DT(eid,117) and PersonKF(eid,101))) and WAR.Defup[eid] == 1 then	--唯我独尊--17-2-27
        dng = dng*2
	end
	
	if wugong == 176 and (DT(pid, 117) or wglw1(pid,176)) or DT(pid,618) then 
	    dng = dng*2
	end
	
    if BJY(eid) and juexing() > 2 then
		dng = dng * 2 
	end 		
	
	if txjid(pid) then 
	    dng = math.modf(dng/2)
	end
	if wglw(pid,101) or (DT(pid,117) and PersonKF(pid,101)) then	--唯我独尊--17-2-27
	    local a = math.modf(dng/10)
	    hurt = hurt + a
	end
	
    if wugong == 176 and (DT(pid, 117) or wglw1(pid,176)) or DT(pid,618) then
	    local a = math.modf(dng/5)
	    hurt = hurt + a
	end	
	
	if MPPD(eid) == 2 and hurt > 10 then --丐帮打狗棍阵
		for j = 0, WAR.PersonNum - 1 do
			local tmppid = WAR.Person[j]["人物编号"]
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"]
				and MPPD(tmppid) == 2 and tmppid ~= eid then
				hurt = math.modf(hurt * 0.33)
				--JY.Person[tmppid]["生命"] = JY.Person[tmppid]["生命"] - hurt	
				WAR.Person[emenyid][CC.TXWZ3] = "打狗棍阵"
				WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(tmppid,"生命",-hurt);
				if WAR.Person[j]["真伤点数"] > JY.Person[tmppid]["生命最大值"] then WAR.Person[j]["真伤点数"] = JY.Person[tmppid]["生命最大值"] end
				SetWarMap(WAR.Person[j]["坐标X"], WAR.Person[j]["坐标Y"], 4, 2);
				break
			end
		end		
	end
	
	if TGLX(eid) and hurt > 10 then --丐帮打狗棍阵
		local n=0
		for j = 0, WAR.PersonNum - 1 do
			local tmppid = WAR.Person[j]["人物编号"]
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"]
				and TGLX(tmppid) and tmppid ~= eid then
				n=n+1
			end
		end
		if n>=1 then
		hurt=math.modf(hurt * 1/(n+1))
		for j = 0, WAR.PersonNum - 1 do
			local tmppid = WAR.Person[j]["人物编号"]
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"]
				and TGLX(tmppid) and tmppid ~= eid then
				local fhurt = hurt
				--JY.Person[tmppid]["生命"] = JY.Person[tmppid]["生命"] - fhurt	
				WAR.Person[emenyid][CC.TXWZ3] = "六仙联防"
				WAR.Person[j]["生命点数"] = (WAR.Person[j]["生命点数"] or 0) + AddPersonAttrib(tmppid,"生命",-fhurt);
				SetWarMap(WAR.Person[j]["坐标X"], WAR.Person[j]["坐标Y"], 4, 2);
				n=n+1
			end
		end
		end
	end
	
    if WAR.WYLW5==2 and hurt > 10 then --华山领悟
		local n=0
		for j = 0, WAR.PersonNum - 1 do
			local tmppid = WAR.Person[j]["人物编号"]
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] then
				n=n+1
			end
		end
		local aa=1
		if WAR.SEVENSTAR[pid]~=nil and WAR.SEVENSTAR[pid]>0 then
		aa=WAR.SEVENSTAR[pid]
		end	
        local fhurt=math.modf((sixi(pid,2)+JY.Person[pid]["攻击力"])/50*aa)
		for j = 0, WAR.PersonNum - 1 do
			local tmppid = WAR.Person[j]["人物编号"]
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] and tmppid ~= eid then
				--JY.Person[tmppid]["生命"] = JY.Person[tmppid]["生命"] - fhurt	
				WAR.Person[j]["生命点数"] = (WAR.Person[j]["生命点数"] or 0) + AddPersonAttrib(tmppid,"生命",-fhurt);
				SetWarMap(WAR.Person[j]["坐标X"], WAR.Person[j]["坐标Y"], 4, 2);
			end
		end
	end

    if (wglw(pid,97) or (DT(pid, 9) and JX(pid)) or (T7DFWM(pid) and juexing() >= 2)) and (PersonGTJL(pid,97,WAR.NGJL)  and WAR.ACT==1)  and WAR.BG[pid]~=nil then --乾坤领悟气劲
		local fhurt = 0
		DHdisplay(1070, 1089, "明尊白莲.乾坤易理")
		fhurt=WAR.BG[pid]
		for j = 0, WAR.PersonNum - 1 do
			local tmppid = WAR.Person[j]["人物编号"]
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] then
				WAR.Person[j]["生命点数"] = (WAR.Person[j]["生命点数"] or 0) + AddPersonAttrib(tmppid,"生命",-fhurt)
				SetWarMap(WAR.Person[j]["坐标X"], WAR.Person[j]["坐标Y"], 4, 2);
	            WAR.Person[j][CC.TXDH] = 158
			end
		end		
        WAR.BG[pid]=nil
	end	
	
    if wglw1(pid,43) or ((DT(pid , 51) or DT(pid,113)) and JX(pid)) and WAR.DZPZ==3 then
	    if WAR.SEVENSTAR[pid]~=nil and WAR.SEVENSTAR[pid]==1 then
		    for j = 0, WAR.PersonNum - 1 do
			    local tmppid = WAR.Person[j]["人物编号"]
			    if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"]
				and tmppid ~= eid then
				local fhurt = hurt
				WAR.Person[j]["生命点数"] = (WAR.Person[j]["生命点数"] or 0) + AddPersonAttrib(tmppid,"生命",-fhurt)
				SetWarMap(WAR.Person[j]["坐标X"], WAR.Person[j]["坐标Y"], 4, 2);
			    end
		    end
	    end
    end	
 
	
    if wugong == 176 and ((DT(pid, 117) or wglw1(pid,176)) and JLSD(10, 40, pid)) or (DT(pid,618) and JLSD(10, 40, pid)) and (PersonKF(eid,8) or wglw1(eid,8)) == false then
		--WAR.SSF[3000+pid] = 92
	    local a = math.modf((ang+100)/1000)
		if a > 10 then 
		   a = 10 
		elseif a < 1 then 
           a = 1		   
		end   
	    hurt = math.modf(hurt*a)
        if WAR.Person[emenyid][CC.TXWZ1] == nil then
           WAR.Person[emenyid][CC.TXWZ1] = "生死符・乱"
        else
           WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "生死符・乱"
        end
	       WAR.Person[emenyid][CC.TXDH] = 144
	end
	
    hurt = hurt + (atk) / 5 + (mywuxue - emenywuxue) / 2 - (def) / 5
    if MPPD(pid)==1 then --星宿派攻击和毒的关系
        hurt = hurt + JY.Person[pid]["体力"] / 5 - JY.Person[eid]["体力"] / 5 + JY.Person[eid]["中毒程度"] / 2 + JY.Person[pid]["中毒程度"] 
    elseif MPPD(eid)==1 then--星宿派防御和毒的关系
        hurt = hurt + JY.Person[pid]["体力"] / 5 - JY.Person[eid]["体力"] / 5 - JY.Person[eid]["中毒程度"]  - JY.Person[pid]["中毒程度"] / 2
    else
        hurt = hurt + JY.Person[pid]["体力"] / 5 - JY.Person[eid]["体力"] / 5 + JY.Person[eid]["中毒程度"] - JY.Person[pid]["中毒程度"] 
    end
        hurt = (hurt) * (atk) / (atk + def)

    local hurt2 = 0
    local hurt2js = 0
    --难度判断
    if JY.Thing[202][WZ7] == 1 then
        hurt2js = 5
    elseif JY.Thing[202][WZ7] == 2 then
        hurt2js = 4
    elseif JY.Thing[202][WZ7] == 3 then
        hurt2js = 3
    else
        hurt2js = 2
    end
  
    --[[ 
    if inteam(pid) then --不破防则二次判定
       hurt2 = math.modf(math.random(5) + (atk) / 7)
    else
       hurt2 = math.modf(math.random(20) + (atk) / hurt2js)
    end]]
    --最终伤害判定
	if inteam(pid) then
	    hurt2=math.modf(math.random(5,15)+atk/20-def/(hurt2js*10)+diypofang/10)
		--diyhurt3=math.modf(math.random(10)+atk/7)
		--if diyhurt3>hurt2 then hurt2=diyhurt3 end --三次判定...
	else
	    hurt2=math.modf(math.random(10,30)+atk/(hurt2js*10)-def/20+diypofang/10)
		--diyhurt3=math.modf(math.random(20)+atk/hurt2js)
		--hurt2=math.modf(math.random(20)+atk/hurt2js)
	end	
  
	if hurt < hurt2 then
        hurt = hurt2
	    if hasTF(pid, 55) then
		    hurt = math.modf(hurt * 1.5)
	    end
 	    if xiaobin(pid) and JY.Thing[202][WZ7] > 2 then
		    hurt = math.modf(hurt * 1.2)
	    end	
    end
  
 -----------------------伤害最终调整
    --[[if hurt > 200 then 
        local a = hurt 
	    if a > 200 then
	        a = math.modf((a-100)/1.5) + 200
	    end
	    if a > 300 then
	        a = math.modf((a-150)/2) + 300
	    end
	    if a > 400 then
	        a = math.modf((a-200)/3) + 400
	    end
	    if a > 600 then
	        a = math.modf((a-300)/4) + 600
	    end
	    if a > 800 then
	        a = math.modf((a-400)/6) + 800
	    end
	    if a > 1000 then
	        a = math.modf((a-500)/8) + 1000
	    end
	    if a > 1200 then
	        a = math.modf((a-600)/10) + 1200
	    end
	    if a > 1400 then
	        a = math.modf((a-700)/12) + 1400
	    end
	    if a > 1600 then
	        a = math.modf((a-800)/14) + 1600
	    end

	    if a >= 200 then 
	        a = math.modf(a/2) + 100
	    end 
	    if a >= 400 then 
	        a = math.modf(a/2) + 200
	    end  
	    if a >= 800 then 
	        a = math.modf(a/2) + 400
	    end  	   
	    hurt = a
    end 
    hurt=math.modf(hurt)]]

    --魔音・碧海潮生
	if wglw(eid,6) or (PersonKF(eid,6) and DT(eid,57)) then
	    hurt = math.modf(hurt*(1- WAR.BHZC*0.15))
	end	
	
	--湿婆附体伤害1.2倍伤害
	if DT(pid,582) and WAR.MWQ1 == 1 then
	  hurt = math.modf(hurt*1.2)
	end
	
	--摩诃迦罗最终一刀
	if WAR.MWQ4 == 1 and DT(pid,582) then
	  hurt = hurt + 2020
	  WAR.SPIRIT[pid] = 0
	  WAR.MWQ4 = 0
	end
	if WAR.TMT[eid] ~= nil then 
	    hurt = math.modf(hurt*0.2)
	end
	
	if XYL(eid) and PersonGT(eid,180) then
	    hurt = math.modf(hurt*0.8)
	    WAR.Person[emenyid][CC.TXWZ1] = "太虚剑气护体"
	    WAR.Person[emenyid][CC.TXDH] = 158
	end
	for i = 1, JY.WugongNum-1 do 
	    if jtyl(eid) and PersonTFGT(eid,i) then --谢无悠
	        hurt = math.modf(hurt*0.7)
	        WAR.Person[emenyid][CC.TXWZ1] = "九天一流・切返"
	        WAR.Person[emenyid][CC.TXDH] = 158
	    end
	end
	if WAR.ZQK[eid] ~= nil then
	    hurt = math.modf(hurt*0.4)
	end
	
	--豸苗：洪七公丐王真气
	if DT(eid,69) and JLSD(0,70,eid) then
	    hurt =  math.modf(hurt*0.8)
	    if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "丐王真气"
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+丐王真气"
	    end
	end	
	--豸苗：欧阳锋蛇毒
	if WAR.OYFSD[eid] ~= nil then 
	    hurt = math.modf(hurt * 1.2)
	end  	

	--豸苗：白马切JJ惩罚
	if eid == 0 and GetS(86,15,15,5) == 1 then
	    hurt = math.modf(hurt * 1.15)
	end
	--豸苗：太玄经
	if WAR.TXJ2[eid] ~= nil then
	    hurt = math.modf(hurt * 1.5)
	end
	
	if MPPD(eid) == 12 then
	local mpdj=MPDJ(eid)
	    hurt = math.modf(hurt*(1-JY.Person[eid]["防御力"]/12000*mpdj)) 
	end--日月神教
	
    if DT(eid,617) then
	    hurt = math.modf(hurt*(1-JY.Person[eid]["防御力"]/12000)) 
	end	
	
	if wglw(eid,100) or (DT(eid,129) and PersonKF(eid,100)) then--豸苗：先天领悟
	    local a = math.modf(JY.Person[eid]["生命最大值"]*0.6)
	    if JY.Person[eid]["生命"] > a then
		   hurt = math.modf(hurt * 0.8)
		end   
	end
	if eid == 0 and WAR.XTG == 1 and WAR.WCY2 == 1  then
	    hurt = math.modf(hurt * 0.7)
	end
 
	for i = 1, JY.WugongNum-1 do 
	    if eid == 0 and putong() == 5 and PersonTFGT(eid,i) then --天罡
	        hurt = math.modf(hurt*0.97)
	        WAR.Person[emenyid][CC.TXWZ1] = "罡气护体"
	        WAR.Person[emenyid][CC.TXDH] = 6
	    end
	end
	
	if DT(eid,114) and hurt > 0 and DWPD() then  --17-2-9
	    if JLSD(0,30,eid) then 
	        hurt = math.modf(hurt*0.1)
	        WAR.Person[emenyid][CC.TXWZ1] = "真・无形气墙"
	    elseif WAR.SDQQ > 0 then
	        hurt = math.modf(hurt*(1-WAR.SDQQ*0.1))
	        WAR.Person[emenyid][CC.TXWZ1] = "无形气墙"
	        WAR.SDQQ = WAR.SDQQ - 1
	    if WAR.SDQQ <= 0 then 
	        WAR.SDQQ = 0
	    end
	    end	  
	end
	--[[豸苗：扫地僧如山
    if DT(eid, 114) and WAR.FD == 0 then 
        hurt = math.modf(hurt*(0.3+(WAR.CB2*0.1)))
	    WAR.Person[emenyid][CC.TXWZ1] = "无形气墙"	
	    if ZYBF(eid) and JLSD(0,30,eid) then
            hurt = math.modf(hurt*0.3)
	        WAR.Person[emenyid][CC.TXWZ1] = "真・无形气墙"
        end
	end
	--豸苗：扫地僧如山
    if DT(eid, 114) and WAR.FD ~= 0 then
      	if WAR.CB < 7 then 
           hurt = math.modf(hurt*(0.2+(WAR.CB*0.1)))
		 elseif WAR.CB >= 7 then  
		   hurt = math.modf(hurt*0.8)	 
		end   
	WAR.Person[emenyid][CC.TXWZ1] = "无形气墙"
	if ZYBF(eid) and JLSD(0,30,eid) then
       hurt = math.modf(hurt*0.2)
	   WAR.Person[emenyid][CC.TXWZ1] = "真・无形气墙"
    end
	end]]

    if hasTF(eid, 28) then
	    hurt = math.modf(hurt * 0.9)
    end  
  
    if hasTF(eid, 29) then
	    hurt = math.modf(hurt * 0.7)
    end    
  
	if wglw(eid,103) or (PersonGT(eid, 103) and (DT(eid, 62) or DT(eid, 594))) then --or (DT(pid,9) and PersonKF(pid,106))then --17-2-8血龙出渊
	    local YNWG = {}
	    local THWG = {}
	    local ynwg = 0
	    local thwg = 0
	    for i = 0, JY.ThingNum - 1 do
		    if JY.Thing[i]["需内力性质"] == 1 then
			    ynwg = ynwg + 1
			    YNWG[ynwg] = JY.Thing[i]["练出武功"]
		    end
	    end
	    for i = 0, JY.ThingNum - 1 do
		    if JY.Thing[i]["需内力性质"] ~= 1 and JY.Thing[i]["需内力性质"] ~= 0 then
			    thwg = thwg + 1
			    THWG[thwg] = JY.Thing[i]["练出武功"]
		    end
	    end
	    for i = 1, #YNWG do
            if wugong == YNWG[i] then 
	            hurt = math.modf(hurt * 0.3)
	        end  
        end	
	    for i = 1, #THWG do
            if wugong == THWG[i] then 
	            hurt = math.modf(hurt * 0.6)
	        end  
        end
	    if WAR.Person[emenyid][CC.TXWZ1] == nil then
			WAR.Person[emenyid][CC.TXWZ1] = "血龙炎劲"
		else
			WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1].."+血龙炎劲"
		end
		WAR.Person[emenyid][CC.TXDH] = 135
	end
	
    if DT(eid, 58) or wglw1(eid,25) then --1-29-
	    hurt = math.modf(hurt*0.7)
	    ang = math.modf(ang*0.7)
	    if WAR.Person[emenyid][CC.TXWZ3] == nil then
			WAR.Person[emenyid][CC.TXWZ3] = "黯然销魂・倒行逆施"
		else
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."+黯然销魂・倒行逆施"
		end
	end		
	
	if (wglw1(eid,60) or DT(eid,166)) then
		local aa = sixi(eid,2)
		local bb = sixi(eid,3)
	    hurt = hurt - math.modf((aa+bb)*0.6)
	    ang = ang - math.modf((aa+bb)*0.4)
	    if WAR.Person[emenyid][CC.TXWZ3] == nil then
			WAR.Person[emenyid][CC.TXWZ3] = "阴阳一气・晦涩难明"
		else
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."+阴阳一气・晦涩难明"
		end
	end
	
	if WAR.LYDJLW2[eid] ~= nil and WAR.LYDJLW2[eid] > 0 then --1-29-
	    hurt = math.modf(hurt*2)
	end	
	
	if (wglw1(pid,40) or (DT(pid,91)and JX(pid)) or DT(pid,54) or DT(pid,630)) then
		local aa = sixi(pid,2)
		local bb = sixi(pid,5)
		if wugong == 40 then
			hurt = hurt*(1+math.modf(aa/100))+bb
		elseif wugong == 173 then
			hurt = hurt*(1+math.modf(bb/50))+bb
		end	
	end
	
    -- 三千越甲不可敌12-29
	if DT(eid,614)  then 
	    local dfnum = 0
	    for j = 0, WAR.PersonNum - 1 do
	        if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
	    	    dfnum = dfnum + 1
	        end
	    end
	    hurt = math.modf((limitX(hurt*(0.15+dfnum*0.05),hurt*0.2,hurt)))
		WAR.Person[emenyid][CC.TXWZ1] = "三千越甲不可敌"
	end
	--豸苗：太玄经
	if (PersonGT(eid, 102) and ((JLSD(0,50,eid) and JY.Person[eid]["资质"] < 31) or DT(eid,38) or wglw(eid,102))) or (T5BCF(eid) and juexing()>0) then --1-29-
	    if math.random(3) == 1 then
			hurt = math.modf(hurt*0.5)
			if WAR.Person[emenyid][CC.TXWZ3] == nil then
				WAR.Person[emenyid][CC.TXWZ3] = "纵死侠骨香 不惭世上英"
			else
				WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."+纵死侠骨香 不惭世上英"
			end
			WAR.TXPF = 1
		elseif 	math.random(3) == 2 then
			WAR.DUO = 1
			WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + 500
			if WAR.Person[emenyid][CC.TXWZ3] == nil then
				WAR.Person[emenyid][CC.TXWZ3] = "眼花耳热后 意气素霓生"
			else
				WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."+眼花耳热后 意气素霓生"
			end
		else
			local aa = JY.Person[eid]["受伤程度"] or 0
			local bb = JY.Person[eid]["中毒程度"] or 0
			local cc = WAR.ICE[eid] or 0
			local dd = WAR.HOT[eid] or 0
			local ee = WAR.CHZ[eid] or 0
			local ff = WAR.LXZT[eid] or 0
			local gg = WAR.FXDS[eid] or 0
			local hh = aa+bb+cc+dd+ee+ff+gg
			if hh < 50 then hh = 50 end
			hurt = hurt - (hh*10)
			WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - 500 
			if JLSD(10,35,eid) then
				WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - 500 
				JY.Person[eid]["受伤程度"] = 0
				JY.Person[eid]["中毒程度"] = 0
				WAR.ICE[eid] = 0
				WAR.HOT[eid] = 0
				WAR.CHZ[eid] = 0
				WAR.LXZT[eid] = 0
				WAR.FXDS[eid] = 0
			end
			if WAR.Person[emenyid][CC.TXWZ3] == nil then
				WAR.Person[emenyid][CC.TXWZ3] = "千秋二壮士 @赫大梁城"
			else
				WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."+千秋二壮士 @赫大梁城"
			end
		end	
	end	
	--豸苗：童姥返老还童
	if DT(eid,117) then
        if WAR.FLHT >= 100 and WAR.FLHT < 190 then
	        hurt = math.modf(limitX(hurt*(2.5 - WAR.FLHT/100),hurt*0.7,hurt*1.5))
		elseif WAR.FLHT >= 190 then
		    hurt = math.modf(hurt*0.7)
	    end
	end
	
    if DT(eid, 602) then --段思平减伤
		hurt = math.modf(hurt * 0.5);
	end	
	
    if DT(eid, 585) then --小二减伤
		hurt = math.modf(hurt * 0.1)
	end		
	
    if T3XYK(eid) then --萧雨客减伤
		hurt = math.modf(hurt * 0.5);
	end		
	
    if T2SQ(eid) then --水镜四奇减伤
		hurt = math.modf(hurt * 0.5);
	end	   	
	
    if BJY(eid) then --步惊云减伤70%
		hurt = math.modf(hurt * 0.3);
	end	 	
	
	if PersonGT(eid, 106)  then --九阳主功体减伤30%，否则减10%
		hurt = math.modf(hurt * 0.7);
	elseif PersonKF(eid, 106) then
		hurt = math.modf(hurt * 0.9)
	end

    if PersonGT(eid, 181) then
		hurt = math.modf(hurt * 0.7);
	elseif PersonGT(eid, 181) then
	    hurt = math.modf(hurt * 0.9)
	end

	if wglw(eid,106) or (DT(eid,9) and PersonKF(eid,106)) then --17-2-8
        hurt = math.modf(hurt * 0.8);
	    local nn=math.modf((JY.Person[eid]["内力"]-JY.Person[pid]["内力"])/2500)
	    if nn<0 then
	        nn=0
	    end
	    if JLSD(10,20+10*nn,eid) and nn>0 then
	        WAR.KMSHJQ[pid]= nn   
	   	    if WAR.Person[emenyid][CC.TXWZ3] == nil then
			    WAR.Person[emenyid][CC.TXWZ3] = CC.WARS110
		    else
			    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."+"..CC.WARS110
		    end
	    end
	end   
	
	if (wglw(eid,99) or ((DT(eid,5) or DT(eid,666)) and PersonKF(eid,99))) and WAR.LSQL1 == 1 then 
	     hurt = math.modf(hurt * 0.7)
	end
    local zhangsanfeng = 0 --改掉了张三丰的判定顺序
    if DT(eid, 5) and JLSD(10, 60+WAR.TJZX*10, eid) then
		zhangsanfeng = 1
    end
   
    --沼跃鱼：张三丰无根无形 伤害减少至少20%
    if DT(eid, 5) and zhangsanfeng == 1 then
	    hurt = math.modf(hurt * 0.8)
	    if JLSD(10, 10+WAR.TJZX * 5, eid) then
	        hurt = math.modf(hurt * 0.3)
	        WAR.Person[emenyid][CC.TXWZ3] = "阴阳无极"
	        WAR.Person[emenyid][CC.TXDH] = 21
	    else
            WAR.Person[emenyid][CC.TXWZ3] = CC.WARS93
	        WAR.Person[emenyid][CC.TXDH] = 21
	   end
    end 
	
	if WAR.BXJFDZ1[pid] ~= nil then
		hurt = math.modf(hurt * 0.4)
		WAR.KMSHJQ[pid] = 1
		WAR.ATKDOWN[pid] = 50
		if WAR.Person[emenyid][CC.TXWZ3] == nil then
			WAR.Person[emenyid][CC.TXWZ3] = "分水・江上弄笛"
		else
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."+".."分水・江上弄笛"
		end
		WAR.BXJFDZ1[pid] = nil
	end
	 	
	 
	
	--[[豸苗：扫地僧隐忍
	if DT(eid, 114) and WAR.FD ~= 0 then 
	       WAR.CB = WAR.CB +1
	    if WAR.CB >= 10 then 
	       WAR.CB = 10
        elseif WAR.RLSZ > 2 then
		   WAR.CB = 10
		end   
	end
	--豸苗：扫地僧隐忍
	if DT(eid,114) and WAR.FD == 0 then
			WAR.CB2 = WAR.CB2 +1
	    if WAR.CB2 >= 5 then 
	        WAR.CB2 = 5
	    end
	end	]]

	--蓝烟清：独孤求败，被攻击时额外判断
	if DT(eid , 592) then
	
		local wgtype = JY.Wugong[wugong]["类型"];
		
		--brolycjw: 内功类型 武骧金星：增加判定
		if yongquan(wugong) then
			wgtype = 1
		elseif yongjian(wugong) then
			wgtype = 2
		elseif yongdao(wugong) then
			wgtype = 3
		elseif yongte(wugong) then
			wgtype = 4
		elseif yongnei(wugong) then
			wgtype = 5
		elseif yongan(wugong) then
			wgtype = 6
		end
		
		--重复使用相同的武功攻击时，攻击无效
		if wgtype == WAR.L_DGQB_DEF then
			hurt = 0;
			ang = 0;
			WAR.L_DGQB_X = WAR.L_DGQB_X + 1;
			
		--拳防御，被剑攻击，  剑防御刀攻击，  刀防御拳攻击， 特防御内功攻击，内功攻击后再改其它武功，时伤害和杀集气为1.5倍
		elseif (WAR.L_DGQB_DEF == 1 and wgtype == 2) or (WAR.L_DGQB_DEF == 2 and wgtype == 3) or (WAR.L_DGQB_DEF == 3 and wgtype == 4) or (WAR.L_DGQB_DEF == 4 and wgtype == 1) or (WAR.L_DGQB_DEF == 6 and wgtype == 5) or (WAR.L_DGQB_DEF == 5 and wgtype ~= 5)then --武骧金星：添加暗器判定
			hurt = math.modf(hurt*(1-WAR.L_DGQB_X/10));
			if hurt < 0 then
				hurt = 0;
			else
				
			end
			WAR.L_DGQB_X = WAR.L_DGQB_X - 1;
		else
			hurt = math.modf(hurt*(1-WAR.L_DGQB_X/10));
			ang = 0;
			WAR.L_DGQB_X = WAR.L_DGQB_X + 1;
		end
		
		--brolycjw: 改变防御类型
		if wgtype > 0 then 
			WAR.L_DGQB_DEF = wgtype;
		end
		
		--连击无效，可以左右
		WAR.ACT = 10;
		if WAR.L_DGQB_X <= 0 then
			WAR.L_DGQB_X = 1;
		end
		if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" ..WAR.L_DGQB_DEF_STR[WAR.L_DGQB_DEF]
		else
			WAR.Person[emenyid][CC.TXWZ2] = WAR.L_DGQB_DEF_STR[WAR.L_DGQB_DEF]
		end
		
		WAR.Person[emenyid][CC.TXDH] = 96
	end
	   
    --死亡
    if JY.Person[pid]["生命"] <= 0 then
        JY.Person[pid]["生命"] = 0
    end
    
    --蓝烟清：装备倚天剑，必流血，有20%机率封穴 --改成0%
    if JY.Person[pid]["武器"] == 37 and yongjian(wugong) then
  	    WAR.L_YTJ1 = 1;
  	  --[[if JLSD(50,50,pid) then
  		WAR.L_YTJ2 = 1;
  	    end]]
    end
  
    --打到自己人
    if WAR.Person[WAR.CurID]["我方"] == WAR.Person[emenyid]["我方"] or WAR.HIDE[eid] ~= nil then
	    if WAR.CONFUSE[pid] ~= nil and WAR.CONFUSE[pid] > 0 then
		elseif wglw1(pid,58) and WAR.LQZ[pid]~=nil and WAR.LQZ[pid]==100 then	
	    else
		    if WAR.Person[WAR.CurID]["我方"] then  --己方误伤中，效果发生在攻击方
			    if WAR.L_NYZH[pid] ~= nil then --蓝烟清：新逆运走火，打到已方伤害提高
				    hurt = math.modf(hurt * 0.5) + Rnd(10)
			    elseif(MPPD(pid) == 15 or DT(pid,104)) then --大理气疗与阿朱
			        local fhurt=math.modf(hurt * 1.5) + Rnd(10)
			        hurt = 0
			        AddPersonAttrib(eid, "生命", fhurt)
			        WAR.Person[emenyid]["真伤点数"]=fhurt
                    AddPersonAttrib(eid, "受伤程度", -20)			   
			    elseif WAR.SSNS[pid] ~= nil then --日月神教三尸脑神丹
			        hurt = math.modf(hurt * 0.5) + Rnd(10)
			    elseif WAR.JTQF[pid] == 1 then 
			        hurt = math.modf(hurt * 1.1) + Rnd(10)
			    elseif WAR.WXXY1==1 then
			        hurt = math.modf(hurt * 1) + Rnd(10)
				elseif WAR.HIDE[eid] ~= nil and (DT(pid,614) or hasTF(pid,142) or (wglw2(pid,194) and PersonKF(pid,194))) then
					hurt = math.modf(hurt * 1) + Rnd(10)
				else
				    hurt = math.modf(hurt * 0.3) + Rnd(20)
			    end
			else--己方误伤中，效果发生在被攻击方
				if WAR.BPD[eid] ~= nil then
					WAR.Person[pid]["中毒点数"] = (WAR.Person[pid]["中毒点数"] or 0) + AddPersonAttrib(pid, "中毒程度", 50)
					WAR.BZ[pid] = 1
				end
				if (MPPD(eid) == 15 or DT(eid,104) or DT(eid,602)) and WAR.HIDE[eid] ~= nil then--
					local fhurt=math.modf(hurt * 1.5) + Rnd(10)
					hurt = 0
					AddPersonAttrib(eid, "生命", fhurt)
					WAR.Person[emenyid]["真伤点数"]=fhurt
					AddPersonAttrib(eid, "受伤程度", -20)
				elseif (MPPD(eid) == 13 or (wglw(eid,93) and hasTF(eid,64))) and WAR.HIDE[eid] ~= nil then
					if DT(pid,599) then
						WAR.HIDE[eid] = nil
						AddPersonAttrib(eid, "受伤程度", 20)
					elseif wglw(eid,93) and hasTF(eid,64) then
						local fhurt=math.modf(hurt * 1.5) + Rnd(10)
						hurt = 0
						AddPersonAttrib(eid, "生命", fhurt)
						if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
						   WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .."幻光游世.万象天隐"
						else
						   WAR.Person[emenyid][CC.TXWZ2] = "幻光游世.万象天隐"
						end
					else
						hurt = 0
						if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
						   WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .."焚影圣诀.海市蜃楼"
						else
						   WAR.Person[emenyid][CC.TXWZ2] = "焚影圣诀.海市蜃楼"
						end
					end
					WAR.Person[emenyid][CC.TXDH] = 96
				else
				hurt = math.modf((hurt) * 0.2) + Rnd(10)	
				end
		end
	end
	    if nows(pid) then
		    hurt = 1
	    end
    end   
	
	
	if T13TQS(eid) and WAR.BJ == 1 and juexing()>1 and DWPD()  then --沼跃鱼：滕青山被暴击回血
		WAR.SWFY=WAR.SWFY+1
		hurt=math.modf(hurt*5/WAR.SWFY)
		local xue=WAR.SWFY*30
		AddPersonAttrib(eid, "生命", xue)
		if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+凶兽之心.御"
		else
			WAR.Person[emenyid][CC.TXWZ2] = "凶兽之心.御"
		end	
		WAR.Person[emenyid][CC.TXDH] = 75
	    if WAR.SWFY>4 and juexing()>2 and JLSD(0,20+WAR.SWFY*3,eid) then
	        WAR.HB[eid] = (WAR.HB[eid] or 0) + 1
			--addeffect(WAR.HB, eid, 1)
	    end
	end  

	if wssz(eid) and (WAR.BJ == 1 or hurt>=300) and DWPD()  then --沼跃鱼：滕青山被暴击回血
		WAR.SWFY1=WAR.SWFY1+1
		hurt=math.modf(hurt*5/WAR.SWFY1)
		local xue=WAR.SWFY1*50
		AddPersonAttrib(eid, "生命", xue)
		if hurt>=300 then
		    AddPersonAttrib(eid, "生命", xue)
		end
		    WAR.HB[eid] = (WAR.HB[eid] or 0) + 1
			--addeffect(WAR.HB, eid, 1)
		if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+凶兽之心.御"
		else
			WAR.Person[emenyid][CC.TXWZ2] = "凶兽之心.御"
		end	
		    WAR.Person[emenyid][CC.TXDH] = 75
	end  
	
	if MPPD(eid) == 13 and PersonGT(eid, 93)  then --沼跃鱼:明教焚影圣诀气息遮断
        if JLSD(10, 30+MPDJ(eid)*8, eid) and PersonKF(eid,193) then
			WAR.HIDE[eid] = WAR.HIDE[eid] or 0 +10*(MPDJ(eid)+1)
		elseif JLSD(10, 30+MPDJ(eid)*5, eid) then
			WAR.HIDE[eid] = WAR.HIDE[eid] or 0 +10*(MPDJ(eid)+1)
		end
		if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+焚影圣诀.暗影封息"
		else
			WAR.Person[emenyid][CC.TXWZ2] = "焚影圣诀.暗影封息"
		end	
		    WAR.Person[emenyid][CC.TXDH] = 75
	end
	
	if PersonKF(eid,194) and JLSD(10,40,eid) then -- 暗影迷踪
		if MPPD(eid) == 13 and PersonGT(eid,93) then
		else
			if WAR.HIDE[eid] == nil then
				WAR.HIDE[eid] = 15
			end
		end	
	end	
	
    if DT(eid,104) and JX(eid) then --沼跃鱼:乾达婆
        if WAR.HIDE[eid]==nil or WAR.HIDE[eid]<=0 then
            local fhurt1=math.modf(hurt*0.2)
			local fhurt2=math.modf((WAR.SPIRIT[eid]-100)*3)
		    for j = 0, WAR.PersonNum -1 do
		        if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] then
			        local tid = WAR.Person[j]["人物编号"]
			        JY.Person[WAR.Person[j]["人物编号"]]["生命"] = JY.Person[WAR.Person[j]["人物编号"]]["生命"] + fhurt1
				    WAR.QFY2[tid]=WAR.QFY2[tid] or 0 + fhurt2
				    WAR.QFY3[tid]=WAR.QFY3[tid] or 0 + fhurt2
		        end
		    end		
        if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+乾达婆.天人战舞"
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = "乾达婆.天人战舞"
		end	
		WAR.Person[emenyid][CC.TXDH] = 85
		end
	end
	
	if DT(eid,582) and WAR.MWQ1 == 1 then --湿婆降临被打回复一半生命
	   local xx = math.modf(hurt*0.5)
	   AddPersonAttrib(eid, "生命", xx)
	end
	
	if DT(eid,582) and WAR.MWQ3 == 1 then -- 开眼后回满血且直接进入4阶段
      local xx = hurt
	  AddPersonAttrib(eid, "生命", xx)
	  WAR.SPIRIT[eid] = 200
	  WAR.MWQ3 = 0
	end
	
	if DT(eid,104) and JX(eid) then --沼跃鱼:乾达婆
        if JLSD(10, 45+math.modf((WAR.SPIRIT[eid]-100)*1.25), eid) or WAR.BJ == 1 then
			WAR.HIDE[eid] = WAR.HIDE[eid] or 0 +math.modf((WAR.SPIRIT[eid]-100)*3)
			WAR.QFY1[eid] = WAR.QFY1[eid] or 0 +math.modf((WAR.SPIRIT[eid]-100)*3)
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
			   WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+乾达婆.舞法神隐"
		    else
			   WAR.Person[emenyid][CC.TXWZ2] = "乾达婆.舞法神隐"
		    end	
		       WAR.Person[emenyid][CC.TXDH] = 75
		end
	end
	--暗影迷踪领悟
	if wglw2(pid,194) and PersonKF(pid,194) then
		if WAR.HIDE[eid] ~= nil then
			local aa = WAR.HIDE[eid]
			AddPersonAttrib(eid,"生命",-aa)
			if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
			   WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+影武乱世"
		    else
			   WAR.Person[emenyid][CC.TXWZ3] = "影武乱世"
		    end
			WAR.HIDE[eid] = nil
		end
	end	
	
	if T13TQS(eid) and WAR.ACT >1 and juexing()>1 and DWPD() then --沼跃鱼：滕青山被连击降低伤害
		hurt = math.modf(hurt*(10/(WAR.ACT*WAR.SWFY)))
		WAR.SWFY=WAR.SWFY+1
		if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+凶兽之心.灵"
		else
			WAR.Person[emenyid][CC.TXWZ2] = "凶兽之心.灵"
		end	
		WAR.Person[emenyid][CC.TXDH] = 76
	    if WAR.SWFY>4 and juexing()>2 and JLSD(0,20+WAR.SWFY*3,eid) then
	        WAR.HB[eid] = (WAR.HB[eid] or 0) + 1
			--addeffect(WAR.HB, eid, 1)
	    end
	end  
	if wssz(eid) and WAR.ACT >1 and DWPD() then --沼跃鱼：滕青山被连击降低伤害
		hurt = math.modf(hurt*(10/(WAR.ACT*WAR.SWFY1)))
		WAR.SWFY1=WAR.SWFY1+1
		local xue=WAR.SWFY1*50
		AddPersonAttrib(eid, "生命", xue)
		if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+凶兽之心.灵"
		else
			WAR.Person[emenyid][CC.TXWZ2] = "凶兽之心.灵"
		end	
		WAR.Person[emenyid][CC.TXDH] = 76
	end 
	
    if NF(eid) and juexing() > 0 then 
		WAR.HIDE[eid] = WAR.HIDE[eid] or 0 + 10 * 10
		if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+动风云"
		else
			WAR.Person[emenyid][CC.TXWZ2] = "动风云"
		end	
	end
	
	if BJY(eid) and juexing() > 2 then 
		WAR.HIDE[eid] = WAR.HIDE[eid] or 0 + 10 * 10 
		if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+易转化物"
		else
			WAR.Person[emenyid][CC.TXWZ2] = "易转化物"
		end	
	end	
	
	  --被刺目，40%伤害为0 辟邪葵花必为0
    if (WAR.KHCM[pid] == 1 and JLSD(30,70,pid)) or WAR.KHCM[pid] == 2 then
	    if DT(pid, 13) or DT(pid, 78) or DT(pid, 130) or DT(pid, 662) or hasTF(pid, 142) or MPPD(pid)  == 9 then 
	        elseif not nomiss(pid) then
		    hurt = 0
	    end
    end
	
	if hurt ~= 0 and DWPD() then --被打到减战意	
		if PersonGT(eid, 178) or T9ZY(eid) then --擒龙功战意
			zhanyi(eid, 1, 1)
		elseif PersonKF(eid, 178) then
  
        elseif WAR.XLFH[eid] ~= nil then
		
		elseif JX(eid) then
		    zhanyi(eid, -0.1)
		elseif MPPD(eid) == 19 then
			local aa = math.modf((sixi(eid,2) + sixi(eid,3))/20)
			local bb = math.modf(MPDJ(eid)*5)
			if aa > 60 then aa = 60 end
			if JLSD(10,aa+bb,eid) then
				zhanyi(eid, 0, 1)
			end	
		else
			if DT(pid, 70) then
				zhanyi(eid, -0.5)
			else
				zhanyi(eid, -0.2)
			end
		end
	end
	
	if DT(pid, 70) and hurt ~= 0 and DWPD() then	
		zhanyi(pid, 1, 1)
	end
    
	if DT(pid,114) and WAR.HQWW2 == 1 and DWPD() then --17-2-9
	   zhanyi(eid, -3)
	end
	if jtyl(pid) and (WAR.JTYL == 6 or WAR.JTYL == 9) and hurt ~= 0 and DWPD() then --谢无悠 
	   zhanyi(eid, -5)
	end
	if hasTF(eid, 45) and hurt ~= 0 and DWPD() then
		zhanyi(pid, -1.5)
		if WAR.LQZ[pid] ~= nil and WAR.LQZ[pid] < 100 then
			WAR.LQZ[pid] = limitX(WAR.LQZ[pid] - math.random(10), 0, 100)
		end
	end
  
	if DWPD() and WAR.SQFJ == 0 and WAR.DZXY == 0 then --非反击时连锁增加
		if WAR.Person[WAR.CurID]["我方"] then
			WAR.URCHAIN = 0
			if WAR.MYCHAINADD == 0 then
				WAR.MYCHAINADD = 1
				if WAR.MYCHAIN < 2 then
					WAR.MYCHAIN = WAR.MYCHAIN + 1
				else
					WAR.MYCHAIN = WAR.MYCHAIN + 1
				end
				if DT(pid, 626) then
					WAR.MYCHAIN = WAR.MYCHAIN + 1
				end
				if WAR.MYCHAIN > 30 then WAR.MYCHAIN = 30 end
			end
		else
			WAR.MYCHAIN  = 0
			if WAR.URCHAINADD == 0 then
				WAR.URCHAINADD = 1
				if WAR.URCHAIN < 2 then
					WAR.URCHAIN = WAR.URCHAIN + 1
				else
					WAR.URCHAIN = WAR.URCHAIN + 1
				end
				if DT(pid, 626) then
					WAR.URCHAIN = WAR.URCHAIN + 1
				end				
				if WAR.URCHAIN > 30 then WAR.URCHAIN = 30 end
			end		
		end	
	end

	if WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and hurt > 10 then --and not DT(eid, 89) then --武骧金星：食神MT
		for j = 0, WAR.PersonNum - 1 do
			local jid = WAR.Person[j]["人物编号"]
			if DT(jid, 89) and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] then 
				local MT = math.modf(hurt * 0.2) --这个用来储存挡刀的伤害值
				hurt = hurt - MT --这里要注意，hurt是当前被打的那个人受到的伤害，跟人厨子没有关系
				if JY.Person[jid]["体力"] > math.modf(MT * 0.05) then --我觉得扣减的体力和伤害直接挂钩比较好
					AddPersonAttrib(jid, "体力", math.modf(MT * -0.05))
				else
					MT = MT - JY.Person[jid]["体力"] * 20
					AddPersonAttrib(jid, "生命", MT * -1)
					JY.Person[jid]["体力"] = 0
				end
			end
		end
	end--你那个鲲鹏扶摇我没法理解到底是干嘛的……你解释一下我再写吧ORZ
	
	if WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then --杨妙真特效
		if WAR.LQZ[pid] == 100 and WAR.DZXY ~= 1 and WAR.SQFJ ~= 1 and T12YMZ(eid) then hurt = 0 end
		if T12YMZ(eid) and hurt >= JY.Person[eid]["生命"] and math.random(100) <= 25 + math.modf(JY.Person[eid]["实战"] / 20) then hurt = 0 end
		if T12YMZ(pid) and DWPD() and hurt > 10 and math.random(100) <= (WAR.LQZ[eid] or 0) / 6 - 5 then 
			hurt = 9999
			WAR.Person[emenyid]["死亡"] = true
		end	
	end
	
    if wglw(eid,182) or (DT(eid,5) and PersonGT(eid,182)) then	--太极神功
	    if WAR.FXDS[eid] ~= nil and WAR.FXDS[eid] > 0 then 
	        hurt = math.modf(hurt * 0.2) - WAR.FXDS[eid] * 3
	        WAR.FXDS[eid] = 1
	    end
        if WAR.Person[emenyid][CC.TXWZ1] == nil then
            WAR.Person[emenyid][CC.TXWZ1] = "如封似闭"
        else
            WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+如封似闭"
        end
    end
	
    --[[伤害限制
    if hurt > 100 then 
       local a = hurt 
	   a = math.modf((a-100)/2) + 100
	   if a > 200 then
	   a = math.modf((a-200)/2.5) + 200
	   end
	   if a > 300 then
	   a = math.modf((a-300)/3) + 300
	   end
	   if a > 400 then
	   a = math.modf((a-400)/3.5) + 400
	   end
	   hurt = a
    end ]]
  
  
    if wglw(eid,178) or (DT(eid,69) and PersonKF(eid,178)) or T9ZY(eid) or DT(eid,602) then --九龙功
        if WAR.FXDS[eid] ~= nil and WAR.FXDS[eid] > 0 then 
	        hurt = math.modf(hurt*0.5) - WAR.FXDS[eid]*3
	        WAR.FXDS[eid] = 1
	    end
        if WAR.Person[emenyid][CC.TXWZ1] == nil then
            WAR.Person[emenyid][CC.TXWZ1] = "困龙升天"
        else
            WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+困龙升天"
        end
    end
	--豸苗：武功到极
	local wgdj2 = 0 
	for i = 1,HHH_GAME_SETTING["WG_COUNT_MAX"] do
	    if JY.Person[eid]["武功"..i] > 0 and JY.Person[eid]["武功等级"..i] >= 999 then
	        wgdj2 = wgdj2 + 1
	    end	
	end
	hurt = math.modf(hurt*(1-wgdj2*0.04))
	
        --天赋功体减伤
    if JY.Person[eid]["声望"] ~= 0 then
		local v = JY.Person[eid]["声望"]
		if PersonTFGT(eid, v) then 
		    if inteam(eid) then
		       hurt = math.modf(hurt * 0.85)
			else
			   hurt = math.modf(hurt * 0.7)
			end	 
		end
    end
		
	if not inteam(eid) then 
	    if JY.Thing[203][WZ6] > 0 then 
	        local a = JY.Thing[203][WZ6]
	        if a > 25 then 
		        a = 25
		    end
	        hurt = math.modf(hurt * (1-a*0.02))
        end	   
    end	
	
    if hasTF(eid, 48) then
	    hurt = math.modf(hurt * (1 - JY.Person[eid]["受伤程度"] * 0.0075))
    end  
   
	if wglw(eid,101) or (DT(eid,117) and PersonKF(eid,101)) then --唯我独尊--17-2-27
	    WAR.bhbm[3000+pid] = 92
	    local a = math.modf((ang+1000)/800)
		if a > 10 then 
		   a = 10 
		elseif a < 1 then 
           a = 1		   
		end   
	    hurt = math.modf(hurt*(1-a*0.1))
        if WAR.Person[emenyid][CC.TXWZ1] == nil then
            WAR.Person[emenyid][CC.TXWZ1] = "唯我独尊"
        else
            WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+唯我独尊"
        end
	        WAR.Person[emenyid][CC.TXDH] = 144
	end
	
    if DT(eid,117) and hurt > 0 and JLSD(10, 60, eid) then --豸苗：童姥八荒唯我17-3-2
        if JY.Person[eid]["内力"] > math.modf(hurt*0.2) then 
            WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - math.modf(hurt *0.6);
  	        AddPersonAttrib(eid, "内力", -math.modf(hurt * 0.6));
	        hurt = math.modf(hurt*0.8)
  	        if WAR.Person[emenyid][CC.TXWZ3] == nil then
		        WAR.Person[emenyid][CC.TXWZ3] = "八荒唯我"
	        else
		        WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "八荒唯我"
	        end
        end
    end

    if BJY(eid) and hurt > 0 and juexing() > 2 then
	    WAR.bhbm[3000+pid] = 92
	    local a = math.modf((ang+1000)/800)
		if a > 10 then 
		   a = 10 
		elseif a < 1 then 
           a = 1		   
		end   
	    hurt = math.modf(hurt*(1-a*0.1))
        if WAR.Person[emenyid][CC.TXWZ1] == nil then
            WAR.Person[emenyid][CC.TXWZ1] = "大成若缺盈若冲"
        else
            WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+大成若缺盈若冲"
        end
	        WAR.Person[emenyid][CC.TXDH] = 144
	end

    if BJY(eid) and hurt > 0 and juexing() > 2 then
        if JY.Person[eid]["内力"] > math.modf(hurt*0.2) then 
            WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) - math.modf(hurt *0.6);
  	        AddPersonAttrib(eid, "内力", -math.modf(hurt * 0.6));
	        hurt = math.modf(hurt*0.8)
  	        if WAR.Person[emenyid][CC.TXWZ3] == nil then
		        WAR.Person[emenyid][CC.TXWZ3] = "万物归一气自化"
	        else
		        WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "万物归一气自化"
	        end
        end
    end

	if (JY.Person[eid]["内力性质"] == 3 or DT(eid, 618) or DT(eid, JY.Person[618]["无用13"]) or JY.Person[eid]["内力性质"] == 1) and WAR.NGHT > 0 then --武骧金星：阳内效果
		 hurt = hurt - math.modf(hurt * (JY.Person[eid]["内力"] + JY.Person[eid]["内力最大值"]) / 36000)
	end
	
	if DT(eid, 38) and WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and hurt > 10 then --eid == 38 武骧金星：单通判定修正
		for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["人物编号"] == 591 and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] then
				hurt = math.modf(hurt*0.33)
				WAR.Person[j]["生命点数"] = (WAR.Person[j]["生命点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"],"生命",-hurt)	
				WAR.Person[emenyid][CC.TXWZ3] = "本是同根生"
				--WAR.Person[j]["生命点数"] = (WAR.Person[j]["生命点数"] or 0)-hurt;
				SetWarMap(WAR.Person[j]["坐标X"], WAR.Person[j]["坐标Y"], 4, 2);
			end
		end
	end		
 	 --brolycjw: 石破天与石中玉被攻击时伤害分散
	if DT(eid, 591) and WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and hurt > 10  then --eid == 591 武骧金星：单通判定修正
		for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["人物编号"] == 38 and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] then
				hurt = math.modf(hurt*0.33)
				--JY.Person[38]["生命"] = JY.Person[38]["生命"] - hurt	
				WAR.Person[emenyid][CC.TXWZ3] = "本是同根生"
				WAR.Person[j]["生命点数"] = (WAR.Person[j]["生命点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"],"生命",-hurt)
				SetWarMap(WAR.Person[j]["坐标X"], WAR.Person[j]["坐标Y"], 4, 2);
			end
		end
	end	 
	--穆念慈分担杨康伤害
	if DT(eid, 616) and WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and hurt > 10 then --eid == 616 武骧金星：单通判定修正
		for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["人物编号"] == 635 and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] then
				hurt = math.modf(hurt*0.33)
				WAR.Person[j]["生命点数"] = (WAR.Person[j]["生命点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"],"生命",-hurt)
				SetWarMap(WAR.Person[j]["坐标X"], WAR.Person[j]["坐标Y"], 4, 2);
			end
		end
	end	

    --主角 其徐如林
	if eid == 0 and WAR.FLHS2 > 0 then 
		if JY.Person[eid]["生命"] > 0 then
			WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", 50)
		end
		WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", 500)
		WAR.Person[emenyid]["体力点数"] = (WAR.Person[emenyid]["体力点数"] or 0) + AddPersonAttrib(eid, "体力", 6)
		WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "受伤程度", -20)
		WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", -20)
	end 		
	
    if WAR.SJRL == 1 then
		if JY.Person[eid]["生命"] > 0 then
			WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", 25)
		end
		WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", 250)
		WAR.Person[emenyid]["体力点数"] = (WAR.Person[emenyid]["体力点数"] or 0) + AddPersonAttrib(eid, "体力", 3)
		WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "受伤程度", -10)
		WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", -10)
	end		
	
    --主角 不动如山
    if eid == 0 and WAR.FLHS4 > 0 and hurt > 0 then
        hurt = 10
    end

    if hasTF(eid, 155) and JLSD(0, 50, eid) then
		hurt = 30
		DHdisplay(1251, 1257, "不动如山")
	end	  

    if DT(eid, 662) and JLSD(10, 60, eid) then
		hurt = 100
		WAR.SJRS = 1
		if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .."+".."策・不动如山"
		else
			WAR.Person[emenyid][CC.TXWZ3] = "策・不动如山"
		end
	end	  

    if DT(eid, 457) and JY.Person[pid]["内力"] >= 9000 then
		hurt = 0
		if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .."+".."秘技・金刚不坏"
		else
			WAR.Person[emenyid][CC.TXWZ3] = "秘技・金刚不坏"
		end
	end	  

    if DT(eid, 583) and JY.Person[pid]["内力"] >= 8000 then
		hurt = 0
		WAR.ACT = 10
		WAR.ZYHB = 0
		if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .."+".."寂灭之道・寂灭气甲"
		else
			WAR.Person[emenyid][CC.TXWZ2] = "寂灭之道・寂灭气甲"
		end
	end	 

    if DT(eid,583) then
		if hurt > 300 then
		    hurt = 300
		end 	
	end 	

    if DT(eid,603) then
		if hurt > 200 then
		    hurt = 200
		end 	
	end 	

    if DT(eid,617) then
		if hurt > 100 then
		    hurt = 100
		end 	
	end 	
	
    if wglw1(eid,43) and WAR.FLHS4 > 0 and hurt > 0 then
        hurt = 1
	    WAR.GTSHAQI=0
    end
  
    if MPPD(eid) == 5 and WAR.JG[eid] ~= nil then --金刚不坏
	    if hurt > 0 then
		    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -hurt)
		    hurt = 0	
		    if JY.Person[eid]["内力"] < 1000 then
		  	    WAR.JG[eid] = nil
		    end
	    end
    end
  
	if WAR.TZQJ9[eid] ~= nil and wglw1(eid,18) then --金刚不坏
	    if hurt > 0 then
		    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -math.modf(hurt*0.8))
		    hurt = 0	
		    if JY.Person[eid]["内力"] < 1000 then
		  	    WAR.TZQJ9[eid] = nil
		    end
			dng = 1
	    end
    end
  
    if wglw(eid,184) and PersonGT(eid,184) or DT(eid,665) then --瑜伽密乘减伤
	    if hurt > 0 then
		    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -hurt)
		    hurt = 100	
		    if JY.Person[eid]["内力"] < 1000 then
		  	    WAR.YJMC[eid] = nil
		    end
	    end
    end

	local t, s = maxhurt(eid)
    if t ~= -1 and hurt > t then
	    hurt = t
        if WAR.Person[emenyid][CC.TXWZ3] == nil then
            WAR.Person[emenyid][CC.TXWZ3] = s		
        else
            WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. s
        end
            WAR.Person[emenyid][CC.TXDH] = 6	
    end    
  
    --天罡大招
    if eid == 0 and WAR.JSTG > 0 then
        if hurt <= WAR.JSTG then
            WAR.JSTG = WAR.JSTG - hurt
            hurt = 5 + Rnd(6)
            ang = math.modf(ang / 2)
        else
            hurt = hurt - WAR.JSTG
            WAR.JSTG = 0
        end
        if WAR.Person[emenyid][CC.TXWZ3] == nil then
            WAR.Person[emenyid][CC.TXWZ3] = CC.WARS104		--天罡护体
        else
            WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. CC.WARS105
        end
            WAR.Person[emenyid][CC.TXDH] = 6
    end
  
    if MPPD(eid) == 14 and WAR.ACT > 1 then --五岳剑派抗连击
        local mpdj = MPDJ(eid) * 0.1
	    hurt = math.modf(hurt*(1-mpdj))
	    WAR.Person[emenyid][CC.TXWZ3] = "吞气入体・气脉悠长"	
	    WAR.Person[emenyid][CC.TXDH] = 11 
    end
  
    if eid == 0 and putong() == 8 then
	    hurt = hurt - JY.Person[eid]["中毒程度"]  
    end
  
    if MPPD(eid) == 6 then		--密教减少伤害
        local mpdj = MPDJ(eid)
        hurt = hurt - mpdj * 15
        if hurt < 1 then
            hurt = 1
	    end   
    end
	
	if MPPD(eid) == 6 and PersonKF(eid,195) then
		dng = dng + (WAR.TSWH[eid] or 0)
		if WAR.TSWH[eid] ~= nil and WAR.TSWH[eid] > 3000 and JLSD(10,40,eid) then
			dng = 1
		end
	end	
	
	
    if wglw(eid,184) and PersonGT(eid,184) or DT(eid,665) then --瑜伽密乘减伤
		hurt = math.modf(hurt * 0.5) -100
		local str = "瑜伽・心如止水"
		if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
    	   WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. str
        else
    	   WAR.Person[emenyid][CC.TXWZ3] = str
        end
	end		

    if wglw(eid,188) or (DT(eid,48) and PersonGT(eid,188)) then --神足经	
		hurt = math.modf(hurt * 0.1)
		if JLSD(10,55,eid) and hurt > 300 then 
		    hurt = 300 	
        end
		local str = "神足经・勘破我相"
		if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. str
		else
			WAR.Person[emenyid][CC.TXWZ3] = str
		end
	end		

    if wglw(eid,151) or DT(eid,615) then --17-2-18-金刚调整
        local a = 0
        for i = 1,HHH_GAME_SETTING["WG_COUNT_MAX"] do
	        if JY.Person[eid]["武功"..i] > 0 and yongnei(JY.Person[eid]["武功"..i]) then
		        a = a + 1 
		    end
	    end	
	    hurt = math.modf(hurt*(1-a*0.05)* 0.7) - 30
       -- hurt = math.modf(hurt * 0.7) - 30
		local str = "金刚不坏"
		if DT(eid,618) then 
	    str = "无相・金刚不坏"
		end
	    if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
    	   WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. str
        else
    	   WAR.Person[emenyid][CC.TXWZ3] = str
        end
	    WAR.Person[emenyid][CC.TXDH] = 6
    end

    --豸苗：金刚不坏
	if WAR.JGBH[eid] ~= nil then
	    hurt = hurt - 80
	   	if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
    	    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "金刚不坏护体"
        else
    	    WAR.Person[emenyid][CC.TXWZ3] = "金刚不坏护体"
        end
	end
  
	if (wglw(eid,151) and PersonGTHT(eid, 151, WAR.NGHT)) or (DT(eid,615) and JLSD(20,50,eid)) then--沼跃鱼：不动明王主运效果
		local SN2=JY.Person[eid]["受伤程度"]
		if SN2 < 10 then SN2 = 10 end
		WAR.Person[WAR.CurID]["内伤点数"] = (WAR.Person[WAR.CurID]["内伤点数"] or 0) + AddPersonAttrib(pid, "受伤程度", SN2)
		JY.Person[eid]["受伤程度"]=0
		local SN=math.modf(JY.Person[pid]["受伤程度"]*2.5)
		if JY.Person[eid]["防具"] == 62 then
			SN=SN+50
		end	
		WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) -AddPersonAttrib(pid, "生命", -SN);
		if JY.Person[eid]["内力"] < JY.Person[eid]["内力最大值"] then
		SN=SN*10
  	    
		WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", SN)
		end
		if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
    	    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "不坏金身・罡气反噬"
        else
    	    WAR.Person[emenyid][CC.TXWZ3] = "不坏金身・罡气反噬"
        end
		WAR.Person[emenyid][CC.TXDH] = 202
	end

	if (MPPD(eid) == 5 and PersonGT(eid,151)) or (DT(eid,615) and JLSD(20,50,eid)) then--沼跃鱼：不动明王主运效果
		local bb = 0
		local WZTS = {"一","二","三","四","五","六","七","八","九","十","十一"}
		if JY.Person[eid]["防具"] == 62 then
			bb = 5*MPDJ(eid)
		end	
		if wglw(eid,151) then
			bb = bb +5
		end	
		if JLSD(10,55+bb,eid) and ((PersonGTHT(eid, 151, WAR.NGHT) and MPDJ(eid) > 1) or (DT(eid,615) and JLSD(20,60,eid))) then
		    local tmp=math.modf(hurt*MPDJ(eid));
		    local tmp1=math.modf(hurt*MPDJ(eid)/20);
		    hurt=1;
		    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", tmp)
			if wglw(eid,151) then
				WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", (math.modf(12*5*MPDJ(eid))));
			end
		    AddPersonAttrib(pid, "受伤程度", tmp1);
		    WAR.Person[emenyid][CC.TXWZ4] ="刚相金身・金钟十二关・馈内震外"
			WAR.Person[emenyid][CC.TXDH] = 202
		else	
			WAR.JZSEG = math.random(11)
			if hurt>= MPDJ(eid)*50 then
		        hurt=hurt-math.modf(MPDJ(eid)*50*WAR.JZSEG);
		    else
		        hurt=WAR.JZSEG
		    end
			if wglw(eid,151) then
				WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", (math.modf(WAR.JZSEG*5*MPDJ(eid))));
			end
			if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
    	    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "刚相金身・金钟"..WZTS[WAR.JZSEG].."关"
			else
				WAR.Person[emenyid][CC.TXWZ3] = "刚相金身・金钟"..WZTS[WAR.JZSEG].."关"
			end
		end
	end
	
	if T11CJR(eid) and juexing() > 2 and JLSD(20,70,eid) then--藏镜人三觉效果
		local aa = JY.Person[eid]["实战"]
		if JLSD(10,55,eid) then
		    hurt=10;
		    if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
    	    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "护女狂魔"
			else
    	    WAR.Person[emenyid][CC.TXWZ3] = "护女狂魔"
			end
		else
		    if hurt>= 300 then
		        hurt=hurt - aa / 10;
		    else
		        hurt=10
		    end
			if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
    	    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "正邪无用"
			else
    	    WAR.Person[emenyid][CC.TXWZ3] = "正邪无用"
			end
		end
	end
	
	--踏雪无痕领悟
	if wglw2(pid,195) and PersonKF(pid,195) then
		if WAR.Person[emenyid].Time < 250 and WAR.SPIRIT[eid] < 100 and JLSD(10,50,pid) then
			WAR.XSKJ[eid] = 30
		end
	end	
	--君子风领悟		
	if wglw2(pid,198) and WAR.JZFLW == 1 then
		if WAR.JZFLW1[pid] ~= nil then
			hurt = hurt + WAR.JZFLW1[pid]
			WAR.JZFLW1[pid] = nil
		end
	end	
	if wglw2(eid,198) and PersonKF(eid,198) then
		hurt = math.modf(hurt*0.8) - JY.Person[eid]["实战"]
		if JLSD(10,50,eid) then
			local bb = JY.Person[eid]["品德"]
			for w = 0 , WAR.PersonNum-1 do
				if WAR.Person[w]["我方"] == WAR.Person[emenyid]["我方"] then
					local wid = WAR.Person[w]["人物编号"]
					WAR.XNXS[wid] = 1
					WAR.Person[w]["真伤点数"] = (WAR.Person[w]["真伤点数"] or 0) + AddPersonAttrib(wid,"生命",bb*2)
					WAR.Person[w]["内力点数"] = (WAR.Person[w]["内力点数"] or 0) + AddPersonAttrib(wid,"内力",bb*20)
					SetWarMap(WAR.Person[w]["坐标X"], WAR.Person[w]["坐标Y"], 4, 2);
				end
			end
		end
		if WAR.Person[emenyid][CC.TXWZ1] ~= nil then
    	    WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" .. "君子风・修身齐家"
        else
    	    WAR.Person[emenyid][CC.TXWZ1] = "君子风・修身齐家"
        end
	end	
    if NF(eid) and juexing() > 0 then  --聂风刀气护体
		local bb = JY.Person[eid]["受伤程度"]
		WAR.Person[WAR.CurID]["内伤点数"] = (WAR.Person[WAR.CurID]["内伤点数"] or 0) + AddPersonAttrib(pid, "受伤程度", bb)
		local aa = math.modf(JY.Person[pid]["受伤程度"] * 7)
		WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", -aa)
		JY.Person[eid]["受伤程度"] = 0
		aa = aa * 10
  	    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", aa);
		if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
    	    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "刀气护体"
        else
    	    WAR.Person[emenyid][CC.TXWZ2] = "刀气护体"
        end
	end	
	
	if (wglw(eid,999) or DT(eid,64)) and WAR.Person[emenyid].Time <= 999 then 
	    local a = math.abs(WAR.Person[emenyid].Time)
	    hurt = hurt - math.modf(a/4)
		if WAR.Person[emenyid][CC.TXWZ1] ~= nil then
    	    WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" .. "空明互搏・守"
        else
    	    WAR.Person[emenyid][CC.TXWZ1] = "空明互搏・守"
		end
	end
 
    if txjid(eid) then 
        local a = 1-JY.Person[eid]["御剑能力"]/999
	    if a < 0.1 then 
	        a = 0.1 
	    end
        --if JY.Person[eid]["御剑能力"] > JY.Person[pid]["御剑能力"] and JY.Person[eid]["御剑能力"] > JY.Person[pid]["拳掌功夫"] and JY.Person[eid]["御剑能力"] > JY.Person[pid]["耍刀技巧"] 
	    --and JY.Person[eid]["御剑能力"] > JY.Person[pid]["特殊兵器"] and JY.Person[eid]["御剑能力"] > JY.Person[pid]["暗器技巧"] then 
	      hurt = math.modf(hurt*a) -- math.modf(JY.Person[eid]["御剑能力"]*0.2)
	    --end
		if WAR.Person[emenyid][CC.TXWZ1] ~= nil then
    	    WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" .. "剑意・守"
        else
    	    WAR.Person[emenyid][CC.TXWZ1] = "剑意・守"
		end
    end
  
	if DT(eid, 615) and WAR.BJ == 1 and DWPD() then --达摩免疫暴击
		hurt = 1
		if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+菩提金身"
		else
			WAR.Person[emenyid][CC.TXWZ2] = "菩提金身"
		end	
		WAR.Person[emenyid][CC.TXDH] = 75
	end 
	
    if (wglw(eid,183) or (DT(eid,615) and PersonGT(eid,183))) and JLSD(10,60,eid) then	
	    hurt = 1
		if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+凡圣同归"
		else
			WAR.Person[emenyid][CC.TXWZ2] = "凡圣同归"
		end	
    end	
		
    if T2SQ(eid) and JLSD(10,60,eid) and juexing() > 0 then	
		hurt = 1 
		if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+凤凰投火"
		else
			WAR.Person[emenyid][CC.TXWZ2] = "凤凰投火"
		end	
    end			
	
	--峨眉九阳
	if (wglw(eid,186) and PersonGT(eid,186)) and JLSD(10,45,eid) then	
        WAR.MENG[pid] = 50	
		WAR.CHXS[pid] = 1
		WAR.CHZ[pid] = 50
		if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+金顶佛光梵心魔"
		else
			WAR.Person[emenyid][CC.TXWZ2] = "金顶佛光梵心魔"
		end	
	end	
		
    --峨眉九阳
	if (wglw(eid,186) and PersonGT(eid,186)) and JLSD(10,45,eid) then	
	    WAR.HOTXS[pid] = 1
		WAR.HOT[pid] = 100
		WAR.ICEXS[pid] = 1
		WAR.ICE[pid] = 100
		if WAR.Person[emenyid][CC.TXWZ1] ~= nil then
			WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+三阳开泰气呈祥"
		else
			WAR.Person[emenyid][CC.TXWZ1] = "三阳开泰气呈祥"
		end	
	end		
		
    if (DT(eid,5) or DT(eid,9) or DT(eid,666)) or wglw1(eid,46) then
        if JY.Person[pid]["内力性质"] == 0 then
			WAR.MENG[pid] = 30
	    elseif JY.Person[pid]["内力性质"] == 1 then
	        WAR.PEACE[pid] = WAR.PEACE[pid] or 0 + 100  
		end  
		if JY.Person[pid]["内力性质"] >= 2 then
	        if WAR.LQZ[pid] == 100 then
	            WAR.LQZ[pid] = WAR.LQZ[pid] - 10
            end 
	    end
		if WAR.Person[emenyid][CC.TXWZ3] == nil then
			WAR.Person[emenyid][CC.TXWZ3] = "太极剑法・阴阳动静"
	    else
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."+太极剑法・阴阳动静"
	    end	
	end			
		
	
	--最终伤害限制
	if hurt > 200 then 
        local a = hurt 
	    if a > 200 then
	        a = math.modf((a-100)/3) + 200
	    end
	    if a > 400 then
	        a = math.modf((a-300)/4) + 400
	    end
	    if a > 800 then
	        a = math.modf(a/5) + 600
	    end
	    if a > 1000 then
	        a = math.modf(a/6) + 800
		end
	    --[[if a > 1200 then
	        a = math.modf((a-600)/8) + 1200
	    end]]  
	    hurt = a
    end 
    if hurt > 1000 then
		hurt = hurt + hurt2
	end	
	--hurt=math.modf(hurt)
	--[[if hurt > 400 then
		local a = hurt
		--local c = math.modf(JY.Thing[202][WZ7]/50)
		if a > 50000 then a = 50000 end
		if a > 10000 then
			a = math.modf(a/10) + 1000
		end	
		if a > 400 then
	        a = math.modf((a-400)/3) + 400
	    end
	    if a > 600 then
	        a = math.modf((a-600)/4) + 600
	    end
		if  a > 500 then	
			a = math.modf((a-500)/5) + 500   
		end
		hurt = a
	end	]]
	
	
    if WAR.HSBS2[pid] == 1 then 
		local neili=JY.Person[eid]["内力"]
	    local neili2=JY.Person[eid]["内力最大值"]
	    local fhurt=math.modf((WAR.SWHH1+WAR.SWFY1)*10 * (neili/neili2))
	    hurt = 0
	    ang = 0
	    WAR.GTSHAQI=0
		WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0 ) + AddPersonAttrib(eid,"内力",fhurt*5)
		WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0 ) + AddPersonAttrib(eid,"生命",(WAR.SWHH1+WAR.SWFY1)*50)
        SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 4, 2);	--反弹者标识为被命中  	
        WAR.Person[WAR.CurID]["生命点数"] = (WAR.Person[WAR.CurID]["生命点数"] or 0) + AddPersonAttrib(pid,"生命",-fhurt)
        --JY.Person[WAR.Person[WAR.CurID]["人物编号"]]["生命"] = JY.Person[WAR.Person[WAR.CurID]["人物编号"]]["生命"] - fhurt
	    WAR.Person[emenyid][CC.TXWZ1] = "兽王心经.龙虎啸"
	    WAR.Person[emenyid][CC.TXDH] = 97
	end
  
    if WAR.HSBS[pid] == 1 then 
	    local thurt = hurt * 2
		local neili=JY.Person[eid]["内力"]
	    local neili2=JY.Person[eid]["内力最大值"]
	    local fhurt=math.modf(math.abs(thurt) * (neili/neili2))
	    hurt = 0
	    ang = 0
	    WAR.GTSHAQI=0
		WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0 ) + AddPersonAttrib(eid,"内力",fhurt*5)
        SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 4, 2);	--反弹者标识为被命中  	
        WAR.Person[WAR.CurID]["生命点数"] = (WAR.Person[WAR.CurID]["生命点数"] or 0) + AddPersonAttrib(pid,"生命",-fhurt)
	    WAR.Person[emenyid][CC.TXWZ1] = "以彼之道・还施彼身"
	    WAR.Person[emenyid][CC.TXDH] = 99
	end
	
    if WAR.TJXL[pid] == 1  then
	    local h = 0
		h = math.modf(hurt*0.3)
		hurt = math.modf(hurt*0.3)
		WAR.TJYL[pid] = 1
	--	h = math.modf(hurt*2)
    	SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 4, 2);	--反弹者标识为被命中  	
        WAR.Person[WAR.CurID]["生命点数"] = (WAR.Person[WAR.CurID]["生命点数"] or 0) + AddPersonAttrib(pid,"生命",-h)
		if WAR.Person[emenyid][CC.TXWZ1] == nil then
			WAR.Person[emenyid][CC.TXWZ1] = "以静制动"
		else
			WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1].."+以静制动"
		end
	        WAR.Person[emenyid][CC.TXDH] = 21
	end	
	
    --豸苗：谢云流坐忘无我
	if XYL(eid) and WAR.ZWWW > 0 and PersonGT(eid,180) and juexing() > 1 then 
	    SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 4, 2)
        local selfhurt = math.modf(hurt/2)
        --JY.Person[pid]["生命"] = JY.Person[pid]["生命"] - selfhurt
		if WAR.ZWWW >= math.modf(hurt/2) then 
		   WAR.Person[WAR.CurID]["生命点数"] = (WAR.Person[WAR.CurID]["生命点数"] or 0) + AddPersonAttrib(pid,"生命",-selfhurt)
		   WAR.ZWWW = WAR.ZWWW - math.modf(hurt/2)
		   hurt = 0
		elseif WAR.ZWWW < math.modf(hurt/2) then 
		   WAR.Person[WAR.CurID]["生命点数"] = (WAR.Person[WAR.CurID]["生命点数"] or 0) + AddPersonAttrib(pid,"生命",-WAR.ZWWW)
		   hurt = math.modf(hurt/2) - WAR.ZWWW
		   WAR.ZWWW = 0
		end   
		if JY.Person[pid]["生命"] <= 0 then		--弹不死
			JY.Person[pid]["生命"] = 1;
			WAR.FXXS[pid]=1 
			WAR.FXDS[pid]=50 
			WAR.SZWH[pid] = 50
		end
		if WAR.Person[emenyid][CC.TXWZ3] == nil then
		  WAR.Person[emenyid][CC.TXWZ3] = "坐忘无我"
		else
		  WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+坐忘无我"
		end
		WAR.Person[emenyid][CC.TXDH] = 75
		SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 4, 2)
		--WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0)-selfhurt
    end
  
    if WAR.SHITOUNG==3 and eid==0 and T4WXS(0) then --王小石爱恨交织 敌我皆伤50/50
        SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 4, 2)
        local aa=math.max(WAR.SPIRIT[eid]-100,20)
	    local selfhurt = math.modf(hurt*(0.3+aa/100))
	    hurt = hurt-selfhurt
	    if hurt<1 then
	        hurt=1
	    end
       -- JY.Person[pid]["生命"] = JY.Person[pid]["生命"] - selfhurt
	    if JY.Person[pid]["生命"] <= 0 then		--弹不死
      	    JY.Person[pid]["生命"] = 1;
		    WAR.FXXS[pid]=1 
		    WAR.FXDS[pid]=50 
	    end
        WAR.Person[WAR.CurID]["生命点数"] = (WAR.Person[WAR.CurID]["生命点数"] or 0) + AddPersonAttrib(pid,"生命",-selfhurt)
	    SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 4, 2)
		WAR.SHITOUNG=0
    end
  
    if WAR.TQS2==4 and eid==0 and T13TQS(0) then --滕青山玄武斗气 敌我皆伤50/50
        SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 4, 2)
        local selfhurt = math.modf(hurt/2)
	    hurt = math.modf(hurt/2)
        --JY.Person[pid]["生命"] = JY.Person[pid]["生命"] - selfhurt
	    if JY.Person[pid]["生命"] <= 0 then		--弹不死
      	    JY.Person[pid]["生命"] = 1;
		    WAR.FXXS[pid]=1 
		    WAR.FXDS[pid]=50 
	    end
        WAR.Person[WAR.CurID]["生命点数"] = (WAR.Person[WAR.CurID]["生命点数"] or 0) + AddPersonAttrib(pid,"生命",-selfhurt)
	    SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 4, 2)
		WAR.TQS2=0
    end
  
    if WAR.FS2>1 and DT(eid,50) and ZYJ(eid) and DWPD() then --萧峰逆鳞反击
        SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 4, 2)
        local aa=math.min(WAR.SPIRIT[eid]-100,20)
	    local selfhurt = math.modf(hurt*(1+aa/100))
        WAR.Person[WAR.CurID]["生命点数"] = (WAR.Person[WAR.CurID]["生命点数"] or 0) + AddPersonAttrib(pid,"生命",-selfhurt)
	    SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 4, 2)
		if JY.Person[pid]["生命"] <= 0 then		--弹不死
      	    JY.Person[pid]["生命"] = 1;
		    WAR.FXXS[pid]=1 
		    if WAR.FXDS[pid] ==nil or (WAR.FXDS[pid] ~= nil and WAR.FXDS[pid]<60) then
		        WAR.FXDS[pid]=WAR.FXDS[pid]+40
		    else
		        WAR.FXDS[pid]=100
            end		
	    end
    end
  
    --蓝烟清：装备软o甲反弹拳系武功10%伤害，非拳系则减伤10%，弹不死
    if WAR.Person[emenyid]["我方"] and JY.Person[eid]["防具"] == 58 then
  	    if yongquan(wugong) then		--拳系武功
  		    local selfhurt = math.modf(hurt/10)
  		    if WAR.Person[emenyid][CC.TXWZ1] ~= nil then
  			    WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+" ..JY.Thing[58]["名称"]..CC.WARS106
  		    else
  			    WAR.Person[emenyid][CC.TXWZ1] = JY.Thing[58]["名称"]..CC.WARS106
  		    end
  		    if WAR.Person[emenyid][CC.TXDH] == -1 then
			    WAR.Person[emenyid][CC.TXDH] = math.fmod(97, 10) + 85
		    end
            SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 4, 2)
            JY.Person[pid]["生命"] = JY.Person[pid]["生命"] - selfhurt;
            if JY.Person[pid]["生命"] <= 0 then		--弹不死
      	        JY.Person[pid]["生命"] = 1;
	        end
    	    WAR.Person[WAR.CurID]["生命点数"] = (WAR.Person[WAR.CurID]["生命点数"] or 0) + AddPersonAttrib(pid,"生命",-selfhurt)
  	else --非拳系减伤5% 		
		    hurt=math.modf(hurt*0.9)
  	    end
    end
  
    if (wglw(eid,106) or (DT(eid,9) and PersonGT(eid,106))) and  JLSD(20, 40, eid) then --九阳神功领悟后反弹伤害
	    local selfhurt = math.modf(hurt/4)
  	    if WAR.Person[emenyid][CC.TXWZ2] == nil then
			WAR.Person[emenyid][CC.TXWZ2] = "他横任他横・明月照大江"
	    else
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+他横任他横・明月照大江"
	    end	
  		if WAR.Person[emenyid][CC.TXDH] == -1 then
			WAR.Person[emenyid][CC.TXDH] = math.fmod(97, 10) + 85
		end
        SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 4, 2)
        JY.Person[pid]["生命"] = JY.Person[pid]["生命"] - selfhurt;
        if JY.Person[pid]["生命"] <= 0 then		--弹不死
      	    JY.Person[pid]["生命"] = 1;
	    end
    	WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0)-selfhurt
    end

    if (wglw(eid,182) or (DT(eid,5) and PersonGT(eid,182))) then --太极反弹伤害
	    local aa = 0
		if wglw1(eid,16) then
			aa = aa + 15
		end	
		local selfhurt = math.modf(hurt * 1.15)
		if JLSD(0,50 + aa,eid)	then
			if wglw1(eid,16) and math.random(10) > 4 then
				WAR.WJ[eid] = math.modf((WAR.WJ[eid] or 0)*0.5)
				selfhurt = selfhurt + math.random(100,300)
			end	
			if WAR.Person[WAR.CurID][CC.TXWZ3] == nil then
				WAR.Person[WAR.CurID][CC.TXWZ3] = "太极・无极阴阳"
			else
				WAR.Person[WAR.CurID][CC.TXWZ3] = WAR.Person[WAR.CurID][CC.TXWZ3].."+太极・无极阴阳"
			end	
			SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 4, 2)
			JY.Person[pid]["生命"] = JY.Person[pid]["生命"] - selfhurt;
			WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) -selfhurt
		end	
    end
	
	if KHTJF(eid) then
		hurt = math.modf(hurt * 0.7)
		SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 4, 2)
		WAR.Person[WAR.CurID]["生命点数"] = (WAR.Person[WAR.CurID]["生命点数"] or 0) + AddPersonAttrib(pid, "生命", -(math.modf(hurt * 0.3)))
	end

    if (wglw(eid,183) or (DT(eid,615) and PersonGT(eid,183))) and JLSD(20,70,eid) and WAR.DWRY ~= 1 then --洗髓反弹伤害
		local selfhurt = math.modf(hurt * 1.25) 
  	    if WAR.Person[WAR.CurID][CC.TXWZ3] == nil then
			WAR.Person[WAR.CurID][CC.TXWZ3] = "洗髓・蒸腾雨露"
	    else
			WAR.Person[WAR.CurID][CC.TXWZ3] = WAR.Person[WAR.CurID][CC.TXWZ3].."+洗髓・蒸腾雨露"
	    end	
        SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 4, 2)
        JY.Person[pid]["生命"] = JY.Person[pid]["生命"] - selfhurt;
    	WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) -selfhurt
    end
	
    if (MPPD(eid) == 13 or (wglw(eid,93) and hasTF(eid,64))) and WAR.HIDE[eid] ~= nil and DWPD() then
		if DT(pid,599) then
			WAR.HIDE[eid] = nil
			WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "受伤程度", -20)
		elseif wglw(eid,93) and hasTF(eid,64) then
			local fhurt=math.modf(hurt * 1.5) + Rnd(10)
			hurt = 0
			WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", fhurt)
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
			   WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .."幻光游世・万象天隐"
			else
			   WAR.Person[emenyid][CC.TXWZ2] = "幻光游世・万象天隐"
			end
		else
			if JLSD(10,40,eid) and MPDJ(eid) > 3 then
				hurt = 0
				if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				   WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .."焚影圣诀・海市蜃楼"
				else
				   WAR.Person[emenyid][CC.TXWZ2] = "焚影圣诀・海市蜃楼"
				end
			end	
		end
		WAR.Person[emenyid][CC.TXDH] = 96
	end
	--少林九阳
	if wglw(eid,187) and PersonGT(eid,187) and JLSD(10,60,eid) then	
		WAR.DUO = 1
		if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
    	    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "少林九阳・闪"
        else
    	    WAR.Person[emenyid][CC.TXWZ2] = "少林九阳・闪"
        end
	end 		
	
	--祖千秋
    if DT(eid , 88) and JLSD(35, 65, eid) then
        WAR.DUO=1
        WAR.Person[emenyid][CC.TXWZ2] = CC.WARS95	--酒神秘踪步
        WAR.Person[emenyid][CC.TXDH] = 89
    end
  
  	--祖千秋
    if GB(eid)==2 and JLSD(10, 20+(math.modf(WAR.GBLJ[eid] or 0)*5 ), eid) then
        WAR.DUO=1
        WAR.Person[emenyid][CC.TXWZ2] = "净衣.衣袂破风"	--酒神秘踪步
        WAR.Person[emenyid][CC.TXDH] = 95
    else
        WAR.GBLJ[eid]=WAR.GBLJ[eid] or 0+1
    end
  
	if wglw1(eid,78) and JLSD(35, 55, eid) then
        WAR.DUO=1
        WAR.Person[emenyid][CC.TXWZ2] = "沙狱・蜃楼幻光"	--沙狱・蜃楼幻光
        WAR.Person[emenyid][CC.TXDH] = 89
    end
  
    if eid == 0 and zjtype()==1 and tianshu()>=0 and (JLSD(10,30+math.modf(JY.Person[eid]["资质"]/3),eid) or WAR.JYS>0) then 
        WAR.DUO=1
		hurt = 0
        WAR.Person[emenyid][CC.TXWZ2] = "风天流.绝影闪"	--标主绝影闪
        WAR.Person[emenyid][CC.TXDH] = 98
	    --[[local tmppid=WAR.CurID
		WAR.CurID= eid
		DHdisplay(1552, 1572, "风天流.绝影闪") 			
        WAR.CurID=tmppid			
		end]]
	    if WAR.JYS>0 then
	        WAR.JYS=WAR.JYS-1
	    end
	end--12.27改	
  
    if eid == 0 and zjtype()==4 and tianshu()>=0 and (JLSD(10,30+math.modf(JY.Person[eid]["资质"]/3),eid) or WAR.JYS>0) then 
        WAR.DUO=1
		hurt = 0
        WAR.Person[emenyid][CC.TXWZ2] = "宇晶流.幻音闪"	--自创宇天流
        WAR.Person[emenyid][CC.TXDH] = 98
	    --[[local tmppid=WAR.CurID
		WAR.CurID= eid
		DHdisplay(1552, 1572, "风天流.绝影闪") 			
        WAR.CurID=tmppid			
		end]]
	    WAR.MENG[pid] = 50
	    if WAR.JYS>0 then
	        WAR.JYS=WAR.JYS-1
	    end
	end--12
  
    if DT(eid , 51) and WAR.WJDZ3>0 then--慕容复身形无间
        WAR.DUO=1
	    WAR.WJDZ3=WAR.WJDZ3-1
	    WAR.WJDZ2=WAR.WJDZ2+1
        WAR.Person[emenyid][CC.TXWZ2] = "身形无间.森罗灭形"
        WAR.Person[emenyid][CC.TXDH] = 112
    end

    if MPPD(eid)==10 and WAR.BHMJ>0  then
        WAR.DUO=1
        WAR.Person[emenyid][CC.TXWZ2] = "桃花阵图.碧海幻境"	----沼跃鱼：碧海幻境
        WAR.Person[emenyid][CC.TXDH] = 89
	    WAR.BHMJ=WAR.BHMJ-1
    end
  
    --韦小宝
    if DT(eid, 664) and JLSD(10, 30, eid) then
        WAR.DUO=1
        WAR.Person[emenyid][CC.TXWZ2] = "天魁地宝"	
        WAR.Person[emenyid][CC.TXDH] = 89
    end  
    if wglw2(eid,197) and WAR.XYYLW2[eid] ~= nil then
		local aa = WAR.XYYLW2[eid]
		if JLSD(0,6*aa,eid) then
			WAR.DUO=1
			WAR.Person[emenyid][CC.TXWZ2] = "逍遥醉步・形醉"	
			WAR.Person[emenyid][CC.TXDH] = 89
		end
	end	
	--李秋水传音搜魂
    if WAR.CYSH[pid] ~= nil and JLSD(10, 30, pid) then
        WAR.DUO=1
        WAR.Person[WAR.CurID][CC.TXWZ2] = "头晕目眩"
        WAR.Person[WAR.CurID][CC.TXDH] = 89
    end
	
     if (WAR.HOT[pid] or 0) >= 20 and JLSD(10, 20, pid) then
		if wglw1(pid,176) or (DT(pid,49) and PersonKF(pid,176)) or DT(pid,116)then
		
		elseif wglw1(pid,68) and JY.Person[pid]["内力"] > (math.modf(JY.Person[pid]["内力最大值"]/5)) then
		
		else
			WAR.DUO=1
			WAR.Person[WAR.CurID][CC.TXWZ2] = "重度灼烧.头晕目眩"
			WAR.Person[WAR.CurID][CC.TXDH] = 89
		end	
    end
  
    --韦小宝
    if DT(pid, 664) and JLSD(10, 30, pid) then
        WAR.DUO=1
        WAR.Person[WAR.CurID][CC.TXWZ2] = "天魁地宝"
        WAR.Person[WAR.CurID][CC.TXDH] = 89
    end    
	if wglw2(pid,197) and WAR.XYYLW2[pid] ~= nil then
		local aa = WAR.XYYLW2[pid]
		if JLSD(0,3*aa,pid) then
			WAR.DUO=1
			WAR.Person[WAR.CurID][CC.TXWZ2] = "逍遥醉步・意醉"	
			WAR.Person[WAR.CurID][CC.TXDH] = 89
		end
	end
	
	if WAR.ZDDH == 205 then
		if DT(pid,141) and DT(eid,35) then
			hurt = 0
			JY.Person[141]["生命"] = 0
		end
	end	
	
	--胡刀天生牙
	if wugong == 67 and (wglw1(pid,67) or (DT(pid, 1) and JX(pid)) or (DT(pid, 621) and JX(pid))) and JLSD(10, 20, eid) and JY.Person[eid]["生命"] < 50 then
        WAR.DUO=1
        for j = 0, WAR.PersonNum -1 do
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
				local tid = WAR.Person[j]["人物编号"]
				WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"],"生命",100)
				WAR.Person[j]["内力点数"] = (WAR.Person[j]["内力点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"],"内力",300)
				WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
			end
		end		
		WAR.Person[WAR.CurID][CC.TXWZ2] = "天生牙・仁刀"
        WAR.Person[WAR.CurID][CC.TXDH] = 89
    end
	
	if eid == 0 then
        if (WAR.KHNP1[eid] == 2 and JLSD(10, 35, eid)) or (wglw1(eid,18) and WAR.TZQJ6[eid] ~= nil and JLSD(10,50,eid)) then
            WAR.DUO=1
	        WAR.Person[emenyid][CC.TXWZ2] = "葵花魅影"
	        WAR.Person[emenyid][CC.TXDH] = 88
			if JLSD(10,60,eid) and wglw2(eid,196) and PersonKF(eid,196) and WAR.AXZX == 0 then
				for j = 0, WAR.PersonNum -1 do
					if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
						local tid = WAR.Person[j]["人物编号"]
						local anxiang = math.random(2)
						if anxiang == 1 and WAR.AXSY1[tid] == nil then
							WAR.AXSY1[tid] = 30
						elseif anxiang == 2 and WAR.AXSY2[tid] == nil then
							WAR.AXSY2[tid] = 3	
						end
					end	
				end
				WAR.AXZX = 1
			elseif JLSD(10,60,eid) and wglw2(eid,196) and PersonKF(eid,196) and WAR.AXZY == 0 then
				for j = 0, WAR.PersonNum -1 do
					if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
					local tid = WAR.Person[j]["人物编号"]
						WAR.AXSY3[tid] = 10	
					end	
				end
				WAR.AXZY = 1
			end
	    elseif WAR.KHNP1[eid] == 3 and GetS(86,15,15,5) == 1 and JLSD(0,35,eid) then
	        WAR.DUO=1
            WAR.Person[emenyid][CC.TXWZ2] = "葵花诡影"
            WAR.Person[emenyid][CC.TXDH] = 89
			if JLSD(10,60,eid) and wglw2(eid,196) and PersonKF(eid,196) and WAR.AXZX == 0 then
				for j = 0, WAR.PersonNum -1 do
					if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
						local tid = WAR.Person[j]["人物编号"]
						local anxiang = math.random(2)
						if anxiang == 1 and WAR.AXSY1[tid] == nil then
							WAR.AXSY1[tid] = 30
						elseif anxiang == 2 and WAR.AXSY2[tid] == nil then
							WAR.AXSY2[tid] = 3	
						end
					end	
				end
				WAR.AXZX = 1
			elseif JLSD(10,60,eid) and wglw2(eid,196) and PersonKF(eid,196) and WAR.AXZY == 0 then
				for j = 0, WAR.PersonNum -1 do
					if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
					local tid = WAR.Person[j]["人物编号"]
						WAR.AXSY3[tid] = 10	
					end	
				end
				WAR.AXZY = 1
			end
	    elseif WAR.KHNP1[eid] == 1 and JLSD(10,25,eid) then
			WAR.DUO=1
            WAR.Person[emenyid][CC.TXWZ2] = "葵花诡影"
            WAR.Person[emenyid][CC.TXDH] = 89
			if JLSD(10,60,eid) and wglw2(eid,196) and PersonKF(eid,196) and WAR.AXZX == 0 then
				for j = 0, WAR.PersonNum -1 do
					if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
						local tid = WAR.Person[j]["人物编号"]
						local anxiang = math.random(2)
						if anxiang == 1 and WAR.AXSY1[tid] == nil then
							WAR.AXSY1[tid] = 30
						elseif anxiang == 2 and WAR.AXSY2[tid] == nil then
							WAR.AXSY2[tid] = 3	
						end
					end	
				end
				WAR.AXZX = 1
			elseif JLSD(10,60,eid) and wglw2(eid,196) and PersonKF(eid,196) and WAR.AXZY == 0 then
				for j = 0, WAR.PersonNum -1 do
					if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
					local tid = WAR.Person[j]["人物编号"]
						WAR.AXSY3[tid] = 10	
					end	
				end
				WAR.AXZY = 1
			end
		end
    end

	if JLSD(0,30,eid) and wglw2(eid,196) and PersonKF(eid,196) and WAR.AXZX == 0 then
		for j = 0, WAR.PersonNum -1 do
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
			local tid = WAR.Person[j]["人物编号"]
			local anxiang = math.random(2)
				if anxiang == 1 and WAR.AXSY1[tid] == nil then
					WAR.AXSY1[tid] = 30
				elseif anxiang == 2 and WAR.AXSY2[tid] == nil then
					WAR.AXSY2[tid] = 3	
				end
			end
		end
		WAR.AXZX = 1
	elseif JLSD(10,40,eid) and wglw2(eid,196) and PersonKF(eid,196) and WAR.AXZY == 0 then
		for j = 0, WAR.PersonNum -1 do
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				local tid = WAR.Person[j]["人物编号"]
				WAR.AXSY3[tid] = 10	
			end	
		end
		WAR.AXZY = 1
	end 

    --日月神教
    if (MPPD(eid) == 12 and JLSD(10, 30, eid) and GetS(54,0,0,1) == 2 and not (DT(eid,27) and JY.Person[eid]["性别"]==1) and PersonGT(eid,105)) or (DT(eid,618) and PersonKF(eid, 98) and JLSD(10, 30, eid)) or (DT(eid,617) and JLSD(10,30,eid)) then
        WAR.DUO=1
		if DT(eid,618) or DT(eid,617) then
            WAR.Person[emenyid][CC.TXWZ2] = "无相・葵花诡影"
		else
		    WAR.Person[emenyid][CC.TXWZ2] = "葵花诡影"
		end
            WAR.Person[emenyid][CC.TXDH] = 89
	end
	--日月神教
    if DT(eid,27) and JY.Person[eid]["性别"] == 1 and JLSD(10, 50, eid) then
        WAR.DUO=1
		WAR.Person[emenyid][CC.TXWZ2] = "葵花魅影"
        WAR.Person[emenyid][CC.TXDH] = 89
		if JLSD(0,30,eid) and wglw2(eid,196) and PersonKF(eid,196) and WAR.AXZX == 0 then
			for j = 0, WAR.PersonNum -1 do
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				local tid = WAR.Person[j]["人物编号"]
				local anxiang = math.random(2)
					if anxiang == 1 and WAR.AXSY1[tid] == nil then
						WAR.AXSY1[tid] = 30
					elseif anxiang == 2 and WAR.AXSY2[tid] == nil then
						WAR.AXSY2[tid] = 3	
					end
				end	
			end
			WAR.AXZX = 1
		elseif JLSD(10,40,eid) and wglw2(eid,196) and PersonKF(eid,196) and WAR.AXZY == 0 then
			for j = 0, WAR.PersonNum -1 do
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				local tid = WAR.Person[j]["人物编号"]
					WAR.AXSY3[tid] = 10	
				end	
			end
			WAR.AXZY = 1
		end
	end
	
	if WAR.AXSY1[pid] ~= nil and WAR.AXSY1[pid] > 0 then
		if JLSD(10,45,pid) then
			WAR.DOU = 1
		end
		if JLSD(10,85,pid) then
			for j = 0, WAR.PersonNum -1 do
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				local tid = WAR.Person[j]["人物编号"]
					if wglw2(tid,196) then
						local ab = math.random(2)
						if ab == 1 then
							WAR.Person[j]["真伤点数"]= (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(tid,"生命",100)
							WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
						elseif ab == 2 then	
							WAR.Person[j]["内力点数"]=(WAR.Person[j]["内力点数"] or 0) + AddPersonAttrib(tid,"内力",300)
							WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
						end	
					end	
				end	
			end
		end
	end

	if WAR.AXSY2[pid] ~= nil and WAR.AXSY2[pid] > 0 and WAR.ACT < 4 then
		WAR.SPIRIT[pid] = (WAR.SPIRIT[pid] or 0) - math.random(3,5)
	end	
	
	--弹指玉女劲	
	if WAR.TZQJ8[eid] ~= nil and wglw1(eid,18) and WAR.LQZ[pid] ~= nil and WAR.LQZ[pid] >= 100 then
		WAR.DUO = 1
	end	
	
	if DT(eid,47) and JX(eid) then--阿紫闪避
	    for j = 0, WAR.PersonNum - 1 do
		    if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
		        local tid = WAR.Person[j]["人物编号"]
		        local tl= math.modf(JY.Person[tid]["受伤程度"]+JY.Person[tid]["中毒程度"])
		        WAR.AZ2=WAR.AZ2+tl
            end
        end
	    if WAR.AZ2<=200 then
	        WAR.AZ2=200
	    end
	    local jl=math.modf(WAR.AZ2/8)
		WAR.AZ2=0
		if JLSD(10, jl, eid) then
		    WAR.DUO=1
		    WAR.Person[emenyid][CC.TXWZ2] = "苦痛颂歌.心灵破绽"
            WAR.Person[emenyid][CC.TXDH] = 59
		else
		    local sting=math.modf(hurt/20)
			WAR.Person[WAR.CurID]["内伤点数"] = (WAR.Person[WAR.CurID]["内伤点数"] or 0) + AddPersonAttrib(pid, "受伤程度", sting)
		    WAR.Person[WAR.CurID]["中毒点数"] = (WAR.Person[WAR.CurID]["中毒点数"] or 0) + AddPersonAttrib(pid, "中毒程度", sting)
		   WAR.Person[emenyid][CC.TXWZ2] = "苦痛颂歌.心灵链接"
           WAR.Person[emenyid][CC.TXDH] = 42	    end	
	end

    if DT(eid, 602) and JLSD(10, 60, eid) then 
	    WAR.Person[emenyid][CC.TXWZ2] = "龙行虎步"
	    WAR.Person[emenyid][CC.TXDH] = 88
	    hurt = 0
	    WAR.ACT = 10
	    WAR.ZYHB = 0
	end

	
	--凌波微步，一般效果及领悟效果
	 if PersonKF(eid,179) then
		if wglw2(eid,179) or DT(eid,118) then
			local jl = 50
			if WAR.LQSLB == 1 then jl = jl + 50 end
			if JLSD(10,jl,eid) then
			WAR.DUO = 1
				if JY.Person[eid]["性别"] == 0 and JLSD(10,jl,eid) then
					WAR.QFY3[eid]=limitX((WAR.QFY3[eid] or 0) + 15, 0, 30)
					WAR.QFY1[eid]=limitX((WAR.QFY1[eid] or 0) + 15, 0, 30)
					WAR.L_HQNZL[eid]=limitX((WAR.L_HQNZL[eid] or 0) + 15, 0, 30)
					if WAR.Person[emenyid][CC.TXWZ2] == nil then
						WAR.Person[emenyid][CC.TXWZ2] = "凌波微步・烟雨谪仙"
					else
						WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .."烟雨谪仙"
					end
				elseif JY.Person[eid]["性别"] == 1 then
						WAR.XYLS[pid] = 20
						if DWPD() then	
							if JY.Person[pid]["性别"] == 0 and JLSD(10,jl-10,eid)then
								local tmpcount = 0
								for i = 0, WAR.PersonNum - 1 do
									if WAR.Person[i]["死亡"] == false and WAR.Person[i]["我方"] ~= WAR.Person[emenyid]["我方"] then
										tmpcount = tmpcount + 1
									end
								end
								if tmpcount > 1 then --如果战场上敌人大于1, 30%几率魅惑100时序
									WAR.Person[WAR.CurID]["我方"] = WAR.Person[emenyid]["我方"] 
									WAR.NPC[pid] = 60
								end
							elseif JY.Person[pid]["性别"] == 1 and JLSD(10,jl+20,eid) then
								local tmpcount = 0
								for i = 0, WAR.PersonNum - 1 do
									if WAR.Person[i]["死亡"] == false and WAR.Person[i]["我方"] ~= WAR.Person[emenyid]["我方"] then
										tmpcount = tmpcount + 1
									end
								end
								if tmpcount > 1 then --如果战场上敌人大于1, 30%几率魅惑100时序
									WAR.Person[WAR.CurID]["我方"] = WAR.Person[emenyid]["我方"] 
									WAR.NPC[pid] = 30
								end
							end	
						end
						if WAR.Person[emenyid][CC.TXWZ2] == nil then
							WAR.Person[emenyid][CC.TXWZ2] = "凌波微步・羞月洛神"
						else
							WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .."羞月洛神"
						end	
				elseif JY.Person[eid]["性别"] == 2 and JLSD(10,jl,eid )then
					WAR.L_NOT_MOVE[pid] = 1
					WAR.CYSH[pid] = 20
					if WAR.Person[emenyid][CC.TXWZ2] == nil then
						WAR.Person[emenyid][CC.TXWZ2] = "凌波微步・邪魅苍生"
					else
						WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .."邪魅苍生"
					end
				end
			end		
		elseif DT(eid, 53) then
			if WAR.TZ_DY == 1 and JLSD(10, 100, eid) then --80%
				WAR.DUO=1
				WAR.Person[emenyid][CC.TXWZ2] = CC.WARS96		--凌波微步
				WAR.Person[emenyid][CC.TXDH] = 88
			elseif JLSD(30, 60, eid) then --30%
				WAR.DUO=1
				WAR.Person[emenyid][CC.TXWZ2] = CC.WARS96
				WAR.Person[emenyid][CC.TXDH] = 88
			end
		else
	        if JLSD(20, 40, eid) then --30%
                WAR.DUO=1
	            WAR.Person[emenyid][CC.TXWZ2] = CC.WARS96
	            WAR.Person[emenyid][CC.TXDH] = 88
		    end
	    end
	end
    
	--逍遥游轻功
	--[[if PersonKF(eid,2) then
		if JY.Person[eid]["生命"] < math.modf(JY.Person[eid]["生命"] / 2 ) then
	end]]
	if WAR.QSLB[eid] ~= nil and WAR.QSLB[eid] < 3 and hurt > 0 then --逍遥三圣
        WAR.DUO=1
	    WAR.Person[emenyid][CC.TXWZ2] = "秋水凌波"
	    WAR.Person[emenyid][CC.TXDH] = 88
        WAR.QSLB[eid] = WAR.QSLB[eid] + 1
    end
	--流云逐月领悟
	if wglw2(eid,190) and PersonKF(eid,190) and MPPD(eid) ~= 17 then
		local aa = JY.Person[eid]["轻功"] - JY.Person[pid]["轻功"]
		if aa < 0 then aa = 0 end
		if JLSD(10,40,eid) then
			WAR.DUO = 1
			AddPersonAttrib(eid,"生命",aa)
			WAR.Person[emenyid][CC.TXWZ4] = "追月云身"
		end
	end	
	if (MPPD(eid) == 17 or (GX(eid) and JX(eid))) and WAR.ACT > 1 then --峨眉派闪避
		local aa = JY.Person[eid]["轻功"] - JY.Person[pid]["轻功"]
		if aa < 0 then aa = 0 end
		if PersonKF(eid,190) and JLSD(20,70,eid) then
			WAR.DUO = 1
			WAR.QFY1[eid]=limitX((WAR.QFY1[eid] or 0) + 15, 0, 30)
			if wglw2(eid,190) then
				WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid,"生命",aa)
				WAR.Person[emenyid][CC.TXWZ4] = "两仪微尘・追月云身"
			else
				WAR.Person[emenyid][CC.TXWZ4] = "两仪微尘"
			end	
		elseif JLSD(20,50,eid) then 
            WAR.DUO = 1
	        WAR.Person[emenyid][CC.TXWZ4] = "两仪微尘"
		end	
    end

    if BJY(eid) and JLSD(10,50,eid) then  
		WAR.ACT = 10
        WAR.DUO = 1
	    WAR.Person[emenyid][CC.TXWZ2] = "云踪魅影"
    end

    if DT(eid, 600) and JY.Person[eid]["生命"] <= 2000 and JY.Person[eid]["生命"] >0 then
        WAR.Person[emenyid][CC.TXDH] = 119
        WAR.Person[emenyid][CC.TXWZ1]="真・玄武罡气护体"
        WAR.Person[emenyid][CC.TXWZ2]="真・玄武真气护体" 
        WAR.Person[emenyid][CC.TXWZ3]="真・玄武气劲护体" --红
        JY.Person[eid]["生命"] = JY.Person[eid]["生命最大值"]
        JY.Person[eid]["内力"] = JY.Person[eid]["内力最大值"]
        JY.Person[eid]["中毒程度"] = 0
        JY.Person[eid]["受伤程度"] = 0
        JY.Person[eid]["体力"] = 100
        WAR.Person[emenyid].Time = 999
    end 

    if DT(eid,600) and 0 < JY.Person[eid]["生命"] then 	
	    WAR.FXDS[eid] = nil
	    WAR.LXZT[eid] = nil
	    WAR.CHZ[eid] = nil
	    dng = dng + 800
	    if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+玄武罡气护体"    
		else
			WAR.Person[emenyid][CC.TXWZ3] = "玄武罡气护体"
		end
    end

   if (PersonGT(eid,181) and (DT(eid,455))) or (wglw(eid,181) and JLSD(10,40,pid)) then
	    WAR.FXDS[eid] = nil
	    WAR.LXZT[eid] = nil
	    WAR.CHZ[eid] = nil
	    dng = dng + 400
	    if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+玄武罡气护体"    
		else
			WAR.Person[emenyid][CC.TXWZ3] = "玄武罡气护体"
		end
    end

    if DT(eid, 600) then 
		WAR.ACT = 10
		WAR.Person[emenyid][CC.TXDH] = 144
		if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+梅花无痕"
		else
			WAR.Person[emenyid][CC.TXWZ2] = "梅花无痕"
		end	
	end
	
    if DT(eid , 600) then
        if WAR.Person[emenyid][CC.TXWZ3] == nil then
			WAR.Person[emenyid][CC.TXWZ3]="玄武真气护体"
			WAR.Person[emenyid][CC.TXDH] = 120
		else
			WAR.Person[emenyid][CC.TXWZ3]=WAR.Person[emenyid][CC.TXWZ3].."+玄武真气护体"
			WAR.Person[emenyid][CC.TXDH] = 120
		end
		WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid,"生命",1000)
		JY.Person[eid]["受伤程度"] = math.floor(JY.Person[eid]["受伤程度"]/5)
		if JY.Person[eid]["生命"] > JY.Person[eid]["生命最大值"] then JY.Person[eid]["生命"] = JY.Person[eid]["生命最大值"] end
    end

    if hasTF(eid, 147) and JLSD(10, 40, eid) or T3XYK(eid) then
		if JY.Person[eid]["生命"] + 150 > JY.Person[eid]["生命最大值"] then
			JY.Person[eid]["生命"] = JY.Person[eid]["生命最大值"]
		else
			JY.Person[eid]["受伤程度"] = math.floor(JY.Person[eid]["受伤程度"]/2)
			WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid,"生命",100)
		end
        if WAR.Person[emenyid][CC.TXWZ3] == nil then
			WAR.Person[emenyid][CC.TXWZ3]="回春妙手"
			WAR.Person[emenyid][CC.TXDH] = 30
		else
			WAR.Person[emenyid][CC.TXWZ3]=WAR.Person[emenyid][CC.TXWZ3].."+回春妙手"
			WAR.Person[emenyid][CC.TXDH] = 30
		end
    end

    --洗髓经恢复生命
    if PersonGT(eid,183) and JLSD(10,40,eid) then  
		if JY.Person[eid]["生命"] + 200 > JY.Person[eid]["生命最大值"] then
			JY.Person[eid]["生命"] = JY.Person[eid]["生命最大值"]
		else
			JY.Person[eid]["受伤程度"] = math.floor(JY.Person[eid]["受伤程度"]/3)
			WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid,"生命",150)
		end
        if WAR.Person[emenyid][CC.TXWZ3] == nil then
			WAR.Person[emenyid][CC.TXWZ3] = "吐故纳新"
			WAR.Person[emenyid][CC.TXDH] = 1
		else
			WAR.Person[emenyid][CC.TXWZ3]=WAR.Person[emenyid][CC.TXWZ3].."+吐故纳新"
			WAR.Person[emenyid][CC.TXDH] = 1
		end
    end

    if (((MPPD(eid) == 17 and MPDJ(eid) >=2)) or ((GX(eid) and JX(eid)))) and WAR.BJ == 1 then --峨眉派掌门限定
        hurt = hurt * 0.8
		if (GX(eid) and JLSD(10,60,eid)) or (MPPD(eid) == 17 and JLSD(10,40,eid)) then
			if JY.Person[eid]["生命"] + 50 > JY.Person[eid]["生命最大值"] then
				JY.Person[eid]["生命"] = JY.Person[eid]["生命最大值"]
			else
				JY.Person[eid]["受伤程度"] = math.floor(JY.Person[eid]["受伤程度"]/1)
				WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid,"生命",50)
			end
			if WAR.Person[emenyid][CC.TXWZ1] == nil then
				WAR.Person[emenyid][CC.TXWZ1]="玉女素心妙入神"
				WAR.Person[emenyid][CC.TXDH] = 10
			else
				WAR.Person[emenyid][CC.TXWZ1]=WAR.Person[emenyid][CC.TXWZ1].."+玉女素心妙入神"
				WAR.Person[emenyid][CC.TXDH] = 10
			end
		end	
	end	

    if NF(eid) and JLSD(10,40,eid) and juexing() > 2 then
	    if WAR.YINGSHA == 1 then
		    return 0
	    end
		local x, y = WE_xy(WAR.Person[emenyid]["坐标X"], WAR.Person[emenyid]["坐标Y"] - 1)
		NewWARPersonZJ(pid, true, x, y, false, 2);
		local s = nil
		s = emenyid
	    emenyid = WAR.PersonNum - 1
		Talk("万物随心转・魔心为己用", eid)  
		emenyid = s
		WAR.YINGSHA = 1
		return 1 	
	end	

    if hasTF(eid, 149) and JLSD(10, 40, pid) then
		WAR.Person[WAR.CurID].Time = WAR.Person[WAR.CurID].Time - 1000
        WAR.Person[WAR.CurID][CC.TXWZ3] = "釜底抽薪"
    end

    if (wglw(eid,182) or (DT(eid,5) and PersonGT(eid,182))) and JLSD(10,60,eid) then --太极神功	 
        WAR.Person[WAR.CurID].Time = WAR.Person[WAR.CurID].Time - 500
        WAR.Person[WAR.CurID][CC.TXWZ2] = "太极・白鹤亮翅"
	end
		
    if BJY(eid) and juexing() > 2 then
		WAR.Person[WAR.CurID].Time = WAR.Person[WAR.CurID].Time - 500
        WAR.Person[WAR.CurID][CC.TXWZ3] = "道法自然反之动"
    end

    if MPPD(eid) == 18 and MPDJ(eid) >= 5 then --崆峒掌派
		WAR.Person[WAR.CurID].Time = WAR.Person[WAR.CurID].Time - 250
	end	

    if WAR.FXHJ4 == 1 then
        local a = math.modf(JY.Person[pid]["内力"])
  	    WAR.HOT[eid] = 1
	    WAR.HOTXS[eid] = limitX((WAR.HOT[eid] or 0) + a, 0, 100)
	    WAR.ICE[eid] = 1
	    WAR.ICEXS[eid] = limitX((WAR.ICE[eid] or 0) + a, 0, 100)
		hurt = hurt * math.modf(JY.Person[eid]["内力最大值"] * 1 + a)
	end 	

    if DT(pid,583) and WAR.LQZ[pid] == 100 then 
	    local a = math.modf(JY.Person[pid]["内力"] /10)
	    hurt = hurt * math.modf(JY.Person[eid]["内力最大值"] * 1 * a)
	    WAR.Person[emenyid][CC.TXWZ2] = "万道莫名"
    end

    if DT(pid, 602) and JLSD(10, 60, pid) then 
	    local a = math.modf(JY.Person[pid]["内力"] /10)
  	    WAR.HOT[eid] = 1
	    WAR.HOTXS[eid] = limitX((WAR.HOT[eid] or 0) + a, 0, 100)
	    hurt = hurt * math.modf(JY.Person[eid]["内力最大值"] * 1 * a)
	    WAR.ICE[eid]=1
	    WAR.ICEXS[eid] = limitX((WAR.ICE[eid] or 0) + a, 0, 100)
	    WAR.Person[emenyid][CC.TXWZ2] = "六脉真意"
    end
	
	if NF(pid) and JLSD(10,30,pid) and yongdao(wugong) and juexing() > 0 then 
	    local a = math.modf(JY.Person[pid]["内力"] /30)
	    WAR.ICE[eid] = 1
	    WAR.ICEXS[eid] = limitX((WAR.ICE[eid] or 0) + a, 0, 30)
		hurt = hurt * math.modf(JY.Person[eid]["内力最大值"] * 1 * a)
	    WAR.Person[emenyid][CC.TXWZ2] = "傲寒六诀・冷刃冰心"
    end		
	
    if BJY(pid) and JLSD(10,30,pid) and juexing() > 1 then 
	    local a = math.modf(JY.Person[pid]["内力"] /40)
	    WAR.HOT[eid] = 1
	    WAR.HOT[eid] = limitX((WAR.ICE[eid] or 0) + a, 0, 30)
		hurt = hurt * math.modf(JY.Person[eid]["内力最大值"] * 1 * a)
	    WAR.Person[emenyid][CC.TXWZ2] = "天道无极"
    end	
	
    if MPPD(eid) == 16 then
        local xg = MPDJ(eid)
	    local shz = 0
	    local jl=10
        for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] then
                shz = shz + 1
            end
        end
	    if shz > 7 then
	        shz = 7
	    end
        if shz >= 2 then
    	    jl = jl + (shz)* (xg-1)
  	    end
	    if JLSD(10,5+jl,eid) then 
	        hurt = 0
	        WAR.Person[emenyid][CC.TXWZ2] =  "七星.天罡阵步"
	        WAR.Person[emenyid][CC.TXDH] = 88
	    end
    end
  
    if hasTF(eid, 145) and JLSD(10, 40, eid) then 
		WAR.ACT = 10
		WAR.Person[emenyid][CC.TXDH] = 66
		if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+步步为营"
		else
			WAR.Person[emenyid][CC.TXWZ2] = "步步为营"
		end	
	end

    if DT(eid, 617) then 
		WAR.ACT = 10
	end

    if T2SQ(eid) and JLSD(10, 40, eid) and juexing() > 1 then 
		WAR.ACT = 10
		if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+慈鸦哀歌"
		else
			WAR.Person[emenyid][CC.TXWZ2] = "慈鸦哀歌"
		end	
	end

    if (wglw(eid,182) or (DT(eid,5) and PersonGT(eid,182))) and JLSD(10,40,eid) then 
        WAR.ACT = 10
    end 		
		
    if DT(eid,152) then
        local jl = JY.Person[eid]["轻功"]-JY.Person[pid]["轻功"]
	    if jl<0 then
	        jl=0
	    end
	    if jl>300 then
	        jl=300
	    end
        local jl2 = 15 + math.modf(jl/20)
        if JLSD(0,15+jl2,eid) then 
	        WAR.DUO = 1
	        WAR.Person[emenyid][CC.TXWZ2] = "鬼影迷踪腿"
	        WAR.Person[emenyid][CC.TXDH] = 73
	    end
    end
  
    if NF(eid) then
        local jl = JY.Person[eid]["轻功"] + JY.Person[pid]["轻功"]
	    if jl < 0 then
	        jl = 0
	    end
	    if jl > 300 then
	        jl = 300
	    end
        local jl2 = 15 + math.modf(jl/20)
        if JLSD(0,60 + jl2,eid) then 
	        hurt = 0
	        WAR.Person[emenyid][CC.TXWZ2] = "捕风捉影"
	        WAR.Person[emenyid][CC.TXDH] = 142
	    end
    end 

    if DT(eid,153) and JLSD(10,60,eid) then
        if yongan(wugong) then 
	        hurt = 0
	        WAR.Person[emenyid][CC.TXWZ2] = "千臂如来.暗器百劫"
	        WAR.Person[emenyid][CC.TXDH] = 73
	    end
    end
 
    --降龙内劲
	if wugong == 26 and ((DT(pid, 50) or DT(pid,617)) or wglw1(pid,26)) then	
        WAR.ICE[eid] = (WAR.ICE[eid] or 0) + math.modf(hurt/15)
		WAR.ICEXS[eid] = 1
	    if WAR.ICE[eid] > 30 then
	        WAR.ICE[eid] = 30
	    end 
    end

    --虚竹降龙掌冰封
    if wugong == 26 and (DT(pid,49) or DT(pid,617)) then
		WAR.ICE[eid] = (WAR.ICE[eid] or 0) + math.modf(hurt/15)
		WAR.ICEXS[eid] = 1
		if WAR.ICE[eid] > 20 then
			WAR.ICE[eid] = 20
		end
	end 		

    if WAR.XYBQ == 1 then 
		WAR.ICE[eid] = 1
		if WAR.ICE[eid] > 80 then
			WAR.ICE[eid] = 100
		end
	end 			

    --七伤拳
	if wugong == 23 and ((DT(pid, 8) or DT(pid, 167) or DT(pid, 168) or DT(pid, 603)) or wglw1(pid,23)) then
		WAR.ICE[eid] = (WAR.ICE[eid] or 0) + math.modf(hurt/18)
		WAR.ICEXS[eid] = 1
		if WAR.ICE[eid] > 25 then
			WAR.ICE[eid] = 25
		end
	end 		

    --玉女剑法攻击冰封
    if wugong == 42 and ((DT(pid, 601) or DT(pid, 59)) or wglw1(pid,42)) then
		WAR.ICE[eid] = (WAR.ICE[eid] or 0) + math.modf(hurt/20)
		WAR.ICEXS[eid] = 1
		if WAR.ICE[eid] > 50 then
		    WAR.ICE[eid] = 50
		end
	end		

    --弹指神通
	if wugong == 18 and (DT(pid, 57) or wglw1(pid, 18)) then	
        WAR.ICE[eid] = (WAR.ICE[eid] or 0) + math.modf(hurt/15)
		WAR.ICEXS[eid] = 1
	    if WAR.ICE[eid] > 20 then
	        WAR.ICE[eid] = 20
	    end 
    end

    if MPPD(pid) == 18 and MPDJ(pid) >= 2 and JY.Person[pid]["暗器技巧"] >= 200 and yongan(wugong) and PersonGT(pid,189)then --崆峒暗系高级弟子
        WAR.ICE[eid] = (WAR.ICE[eid] or 0) + math.modf(hurt/20)
		WAR.ICEXS[eid] = 1
		if WAR.ICE[eid] > 50 then
		    WAR.ICE[eid] = 50
		end
	end		
	
	if wugong == 140 and (wglw1(pid,140) or DT(pid,558)) then
		WAR.ICEXS[eid] = 1
	    WAR.ICE[eid] = limitX((WAR.ICE[eid] or 0) + (math.modf(hurt/30)), 0, 100)
	end

    if JY.Person[pid]["武器"] == 45 and JLSD(10,40,pid) then  --冷月宝刀
		WAR.ICE[eid] = (WAR.ICE[eid] or 0) + math.modf(hurt/30)
		WAR.ICEXS[eid] = 1
		if WAR.ICE[eid] > 20 then
			WAR.ICE[eid] = 30
		end
	end

    --聂风攻击冰封
    if NF(pid) and WAR.ICEXS[eid] == nil then
		WAR.ICE[eid] = (WAR.ICE[eid] or 0) + math.modf(hurt/20)
		WAR.ICEXS[eid] = 1
		if WAR.ICE[eid] > 100 then
			WAR.ICE[eid] = 100
		end
	end

     --聂风风神怒生命值低于100 全恢复
    if NF(eid) and JY.Person[eid]["生命"] <= 100 then
        WAR.ACT = 10
		WAR.Person[emenyid][CC.TXDH] = 119
        WAR.Person[emenyid][CC.TXWZ1] = "风神怒号"
        JY.Person[eid]["生命"] = JY.Person[eid]["生命最大值"]
        JY.Person[eid]["内力"] = JY.Person[eid]["内力最大值"]
        JY.Person[eid]["中毒程度"] = 0
        JY.Person[eid]["受伤程度"] = 0
        JY.Person[eid]["体力"] = 100
        WAR.Person[emenyid].Time = 1001
        WAR.Person[emenyid].Time = WAR.Person[emenyid].Time + 900
    end 

     --聂风1觉后，根据剑、刀、特系增加伤害
    if NF(pid) and JLSD(10, 40, pid) and juexing() > 0 then
        local SN=math.modf(JY.Person[eid]["内力"]/300*sixi(pid,2)*0.05) and (JY.Person[eid]["内力"]/300*sixi(pid,3)*0.05) and (JY.Person[eid]["内力"]/300*sixi(pid,4)*0.05)
	    local SN2=SN*10
		WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -SN)
        WAR.Person[emenyid][CC.TXWZ2] = "风神怒・神清气足丹田雄"	
	    WAR.Person[emenyid][CC.TXDH] = 11 
    end  

    local fpgz = 70 - JY.Person[eid]["资质"]
	if (PersonGT(eid,102) and JLSD(10,20+fpgz,eid) and JY.Person[eid]["左右互搏"] == 1) or (T5BCF(eid) and JLSD(10,60,eid))  then
	    if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
	        WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."+飒沓流星"
	    else
		    WAR.Person[emenyid][CC.TXWZ3] = "返璞归真・飒沓流星"
	    end
	    hurt = math.modf(hurt * (3 + math.random(3)) / 10) 
	    WAR.BMGX = 1
	    WAR.ACT = 10
	    WAR.ZYHB = 0
    end	  
	  
	--李逍遥仙风云体
    if T8LXY(eid) then
  	    if WAR.LXYXF > 0 and JLSD(10, 80, eid) then --70%
		    WAR.DUO = 1
	        WAR.Person[emenyid][CC.TXWZ2] = "仙风云体术"		
	        WAR.Person[emenyid][CC.TXDH] = 88
	    elseif JLSD(30, 45, eid) then --15%
		    WAR.DUO = 1
	        WAR.Person[emenyid][CC.TXWZ2] = "仙风云体术"
	        WAR.Person[emenyid][CC.TXDH] = 88
	    end
    end  
 
    if T7DFWM(eid) and juexing() >= 1 then --东方未明觉醒后25%几率闪避
	    if JY.Person[eid]["轻功"] >= 550 and JLSD(30, 55, eid) then 
		    WAR.Person[emenyid][CC.TXDH] = 88
		    WAR.DUO = 1
		    if WAR.Person[emenyid][CC.TXWZ3] == nil then
			    WAR.Person[emenyid][CC.TXWZ3] = "逍遥游步"
		    else
			    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "逍遥游步"
		    end				
	    end
    end

    local t, s = miss(eid)
    if t then
	    WAR.DUO = 1
	    WAR.Person[emenyid][CC.TXDH] = 88
	    if WAR.Person[emenyid][CC.TXWZ3] == nil then
		    WAR.Person[emenyid][CC.TXWZ3] = s
	    else
		    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. s
	    end		
    end
 
    --主角 特系
    if putong() == 4 and eid == 0 then
        local gctj = wgnumber(eid, 4)
        local tjsf = 10 + (gctj) * 5
        if JLSD(30, 30 + tjsf, eid) then
		    WAR.DUO = 1
	        WAR.Person[emenyid][CC.TXWZ3] = CC.WARS98		--天机身法
	        WAR.Person[emenyid][CC.TXDH] = 88
  	    end
    end
	
	if WAR.ACT == WAR.TXY then --神游太虚印
		local wuyuejzf = JY.Person[eid]["品德"] or 0
		if hasTF(eid, 116) or getHZ(eid, 24) then
			WAR.DUO= 1
			WAR.Person[emenyid][CC.TXWZ3] = "神游太虚"	
			WAR.Person[emenyid][CC.TXDH] = 88  
			WAR.TXY = 0
		elseif (DT(eid,19) or (MPPD(eid) == 14 and wuyuejzf <= 5)) and JLSD(15,80,eid) and PersonKF(eid,198) then
			WAR.DUO= 1
			WAR.Person[emenyid][CC.TXWZ3] = "伪・君子风"	
			WAR.Person[emenyid][CC.TXDH] = 88  
			WAR.TXY = 0
		elseif MPPD(eid) == 14 and JLSD(5,wuyuejzf,eid) and PersonKF(eid,198) then
			WAR.DUO= 1
			WAR.Person[emenyid][CC.TXWZ3] = "真・君子风"	
			WAR.Person[emenyid][CC.TXDH] = 88  
			WAR.TXY = 0
		end	
    end
	
	if MPPD(eid) == 14 and PersonKF(eid,198) then--五岳君子风
		local wuyuejzf = JY.Person[eid]["品德"] or 0
		for i = 0, WAR.PersonNum - 1 do 
			if DT(eid,19) or wuyuejzf <= 5 then
				local aa = math.random(50,150) 
				if math.random(10) > 5  then 
					if WAR.Person[i]["我方"] == false and WAR.Person[i]["死亡"] == false and i ~= WAR.CurID then
						WAR.Person[i].Time = WAR.Person[i].Time - aa
					end
				else
					WAR.Person[emenyid].Time = WAR.Person[emenyid].Time + aa
				end
				WAR.Person[emenyid][CC.TXWZ1] = "人面兽心"
			else
				if math.random(10) > 5 then
					if WAR.Person[i]["我方"] == false and WAR.Person[i]["死亡"] == false and i ~= WAR.CurID then
					WAR.Person[i].Time = WAR.Person[i].Time - wuyuejzf
					end
				else
					WAR.Person[emenyid].Time = WAR.Person[emenyid].Time + math.modf(wuyuejzf*1.5)
				end
				WAR.Person[emenyid][CC.TXWZ1] = "气节服人"
			end	
		end
	end
  
    --[[
    if DT(eid, 614) and WAR.ACT > 1 then --阿青免疫连击
	    hurt = 0
	    WAR.Person[emenyid][CC.TXWZ3] = "镜心通明"	
	    WAR.Person[emenyid][CC.TXDH] = 115  
	    WAR.TXY = 0  
    end]]	

    --蓝烟清：田伯光 
    if DT(eid , 29) and WAR.L_TBGZL == 1 and JLSD(30,60,pid) then
        WAR.DUO = 1
		WAR.Person[emenyid][CC.TXWZ2] = "风骚惊天下"
		WAR.Person[emenyid][CC.TXDH] = 88
    end	
  
    if hasTF(eid, 150) and JLSD(10,45,pid) then
		WAR.DUO = 1
		WAR.WLKH = 1
		WAR.Person[emenyid][CC.TXWZ2] = "雾里看花"
	end	

    if ((wglw(eid,95) and PersonGTHT(eid,95,WAR.NGHT)) or ((DT(eid,60) or DT(eid,620)) and PersonKF(eid,95))) and WAR.HMJT[eid] ~= nil and WAR.HMJT[eid] > 0 then --蛤蟆九天17-2-23
        local a = math.modf(hurt * 0.5)
        WAR.HMJT[eid] = WAR.HMJT[eid] - a
	    if WAR.HMJT[eid] <= 0 then 
	        WAR.HMJT[eid] = nil 
	    end	  
        hurt = math.modf(hurt * 0.5)
        if WAR.Person[emenyid][CC.TXWZ1] == nil then 
            WAR.Person[emenyid][CC.TXWZ1] = "气吞山河・御"
	    else 
 	        WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1].."+气吞山河・御"
	    end   
    end
  
	--豸苗：碧针清掌
	if DT(eid,164) and WAR.BZQZ > 0 then
	    if ZYBF(eid) then 
		    hurt = math.modf(hurt * 0.7)
		end
	    if hurt >= WAR.BZQZ then
	        hurt = hurt - WAR.BZQZ
	        WAR.BZQZ = 0
	    elseif hurt < WAR.BZQZ then
	        WAR.BZQZ = WAR.BZQZ- hurt
		    hurt = 0 
	    end
	end 
	
	if DT(eid,558) and JLSD(0,30,eid) then
	    local d = 0
		for j = 0, WAR.PersonNum - 1 do
		    if not WAR.Person[j]["死亡"] and not WAR.Person[j]["我方"] then
			    d = d + 1
		    end
		end
		if d > 1 then
			for j = 0, WAR.PersonNum - 1 do
				if not WAR.Person[j]["死亡"] and not WAR.Person[j]["我方"] and j ~= WAR.CurID then
					SetWarMap(WAR.Person[j]["坐标X"],WAR.Person[j]["坐标Y"],4,1)
				end
			end
			if WAR.Person[emenyid][CC.TXWZ1] ~= nil then
			WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+".."阿萨辛秘技・妄想心音"
		else
			WAR.Person[emenyid][CC.TXWZ1] = "阿萨辛秘技・妄想心音"
		end
			WAR.Person[emenyid][CC.TXDH] = 87
			WAR.WXXY1 = 1
		end
	end
	
	if (wglw(eid,97) and not DT(eid,558)) and JLSD(0,30,eid) then
	    local d = 0
		for j = 0, WAR.PersonNum - 1 do
		  if not WAR.Person[j]["死亡"] and not WAR.Person[j]["我方"] then
			d = d + 1
		  end
		end
		if d > 1 then
			for j = 0, WAR.PersonNum - 1 do
				if not WAR.Person[j]["死亡"] and not WAR.Person[j]["我方"] and j ~= WAR.CurID then
					SetWarMap(WAR.Person[j]["坐标X"],WAR.Person[j]["坐标Y"],4,1)
				end
			end
			if WAR.Person[emenyid][CC.TXWZ1] ~= nil then
			WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+".."明尊白莲・无相天音"
		else
			WAR.Person[emenyid][CC.TXWZ1] = "明尊白莲・无相天音"
		end
			WAR.Person[emenyid][CC.TXDH] = 87
			WAR.WXXY1 = 1
		end
	end	
	
    if wglw(eid,182) or (DT(eid,5) and PersonGT(eid,182)) then
        if WAR.LQZ[eid] == nil then
			WAR.LQZ[eid] = 25
		elseif WAR.LQZ[eid] > 85 and WAR.LQZ[eid] ~= 100 then
			WAR.LQZ[eid] = 100
		elseif WAR.LQZ[eid]  < 100 then
			WAR.LQZ[eid] = WAR.LQZ[eid] + 20
		elseif WAR.LQZ[eid] > 100 then
			WAR.LQZ[eid] = 100
		end
        hurt = math.modf(hurt * 0.5)
        if WAR.Person[emenyid][CC.TXWZ1] == nil then 
            WAR.Person[emenyid][CC.TXWZ1] = "太极・后发先至"
	    else 
 	        WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1].."+太极・后发先至"
	    end   
    end	
	
    if WAR.JYHT[eid] ~= nil and hurt > 0 and DWPD() and (wglw1(eid,18) or (wglw(eid,106) or (PersonKF(eid,106) and DT(eid,9))) and PersonGTHT(eid,106,WAR.NGHT)) then --17-2-8
	    local cs = ""
		local names = 
		{{1,"一" },
		{2, "二"},
		{3,"三" },
		{4, "四"},
		{5, "五"},	
		}
		for i,v in ipairs(names) do
			if v[1] == WAR.JYHT[eid] then
				cs = v[2]
				break
			end
		end
		if WAR.JYHT[eid] ~= nil then
			if WAR.Person[emenyid][CC.TXWZ1] ~= nil then
				WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+九阳真气护体"..cs.."层"
			else
				WAR.Person[emenyid][CC.TXWZ1] = "九阳真气护体"..cs.."层"
			end
		else
			if WAR.Person[emenyid][CC.TXWZ1] ~= nil then
				WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "+九阳真气护体"
			else
				WAR.Person[emenyid][CC.TXWZ1] = "九阳真气护体"
			end
		end
		WAR.Person[emenyid][CC.TXDH] = 51
        WAR.JYHT[eid] = WAR.JYHT[eid] - 1
	    hurt = 0
	    if WAR.JYHT[eid] == 0 then 
	        WAR.JYHT[eid] = nil 
	    end
    end
    
	if wglw1(eid,68) and WAR.YQHT[eid] ~= nil then
		hurt = 0
		WAR.YQHT[eid] = 2
		if WAR.Person[emenyid][CC.TXWZ1] ~= nil then
			WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. "燎原百击・枪焰护体"
		else
			WAR.Person[emenyid][CC.TXWZ1] = "燎原百击・枪焰护体"
		end
	end
	
	local qiankun = 0 --乾坤判定，普通几率40%，主功体+20%
    if (PersonKF(eid, 97) ) and DWPD() and (JY.Person[eid]["内力"] >= 3000 or wglw(eid,97) or (DT(eid, 9) and JX(eid))) 
		and not (D1GHYD(pid) and yongdao(wugong)) and not (wugong == 18 and WAR.TZQJ13[pid] == 1) and WAR.DWRY ~= 1 then
	    if T7DFWM(eid) and WAR.DFWM3 == 1 then
		    qiankun = 1
	    end
		if WAR.TZQJ1[eid] ~= nil and wglw1(eid,18) and JLSD(10,40,eid) then
			qiankun = 1
		end	
		local jl = 40
		if PersonGT(eid, 97) then
			jl = jl + 20
		end
		
		if MPPD(eid)==13 then
			jl = jl + 5*MPDJ(eid)
		end
		
		if DT(eid, 9) then
			jl = jl + 15
		end
		
		if wglw(eid,97) or (DT(eid, 9) and JX(eid)) then
			jl = jl + 25
		end
		
		if DT(eid, 11) then
			jl = jl + 10
		end
		if JLSD(10, 10 + jl, eid) then
			qiankun = 1
		end
    end

    --乾坤大挪移防护，反弹伤害，减少受到的伤害
    if qiankun == 1 and not (qkfy(pid) and not(wglw(eid,97) or (DT(eid, 9) and JX(eid)))) then 
        if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "乾坤挪移"
	    end
        if not (PersonKF(pid,43) and not(wglw(eid,97) or (DT(eid, 9) and JX(eid))))then 
	        WAR.fthurt = 0  
            local nydx = {}
            local nynum = 1
            for i = 0, WAR.PersonNum - 1 do
                if WAR.Person[i]["我方"] ~= WAR.Person[emenyid]["我方"] and WAR.Person[i]["死亡"] == false then
                    nydx[nynum] = i
                    nynum = nynum + 1
                end
            end
            local nzdz = {}
            local nznum = 1
            for i = 0, WAR.PersonNum - 1 do
                if WAR.Person[i]["我方"] == WAR.Person[emenyid]["我方"] and WAR.Person[i]["死亡"] == false then
                    nzdz[nznum] = i
                    nznum = nznum + 1
                end
            end
	        local nzft = nzdz[math.random(nznum - 1)]
	        local mzll = 0
            local nyft = nydx[math.random(nynum - 1)]
            local nyft2 = nydx[math.random(nynum - 1)]
            local str=""
            local h = 0;
	        local h2 = 0;
	        local panding1=math.modf(JY.Person[eid]["内力"]/20)
	        local panding2=math.modf(JY.Person[eid]["内力"]/15)
	        local panding3=math.modf(JY.Person[eid]["内力"]/10)
            if wglw(eid,97) or (DT(eid, 9) and JX(eid)) then----
	            panding1=10000
	            panding2=10000
	            panding3=10000
	        end
			--如果已经被反则反弹时只减少30%伤害
			if WAR.L_QKDNY[WAR.Person[nyft]["人物编号"]] ~= nil	and not DT(eid, 9) and not DT(eid, 11) and not wglw(eid,97) then
				hurt = math.modf((hurt) * 70 / 100)
				if WAR.Person[nyft][CC.TXDH] == -1 then
					WAR.Person[nyft][CC.TXDH] = 85;
				end
			else
				local mpdj=MPDJ(eid)
				if DT(eid, 9) then
					mpdj=5
				elseif DT(eid, 11) then
					mpdj=4
				end
				if DT(eid, 11) then --杨逍必反40%，有指令则100%
					if WAR.YX == 0 then
						if JLSD(20,40+mpdj*5,eid) and PersonGT(eid, 97) then
							WAR.fthurt = hurt
							hurt = 1
							str=".明尊无极" 
							panding3=math.modf(JY.Person[eid]["内力"]/5)
						else
							WAR.fthurt = math.modf(hurt*0.4)
							hurt = math.modf(hurt*0.6)
							--WAR.fthurt = math.modf(hurt*0.4)
						end
						if WAR.fthurt>=panding3 then
							WAR.fthurt=panding3
						end	
					else
						if (JY.Person[eid]["内力"] > math.modf(hurt * 2) and JY.Person[eid]["内力"] > 1000) or wglw(eid,97) then 
							WAR.fthurt = hurt
							hurt = 1
								for i = 0, WAR.PersonNum - 1 do 
									if WAR.Person[i]["我方"] == false and WAR.Person[i]["死亡"] == false and i ~= WAR.CurID then
										WAR.Person[i].Time = math.max(WAR.Person[i].Time - fhurt, -500)
										WAR.Person[i]["内伤点数"] = (WAR.Person[i]["内伤点数"] or 0) + AddPersonAttrib(WAR.Person[i]["人物编号"],"受伤程度", math.random(10,20))
										WAR.FXXS[WAR.Person[i]["人物编号"]] = 1
										WAR.FXDS[WAR.Person[i]["人物编号"]]= WAR.FXDS[WAR.Person[i]["人物编号"]] or 0 + math.random(20,30)
										WAR.XNXS[WAR.Person[i]["人物编号"]] = 1
									end
								end
							WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -math.modf(WAR.fthurt * 2))		
							WAR.YX = WAR.YX - 1
							if JY.Person[eid]["内力"] <= 1000 then
								WAR.YX = 0
							end					
						else
							WAR.fthurt = math.modf(hurt * 0.4)
							hurt = math.modf(hurt * 0.6)	
							--WAR.fthurt = math.modf(hurt*0.4)
							WAR.YX = 0
						end
						if WAR.fthurt>=panding3 then
						WAR.fthurt=panding3
						end
					end
				elseif DT(eid, 9) or (MPPD(eid) == 13 and MPDJ(eid) > 4) then		--张无忌或明教教主级别反一半伤害，几率明尊琉璃减伤为1
					WAR.fthurt = math.modf(hurt*0.5)
					if PersonKF(eid,194) then
						if JLSD(20,40+(MPDJ(eid) or 0)*7,eid) and PersonGT(eid, 97) then
						  hurt = 1
						  str=".明尊琉璃" 
						  mzll = 1
						else
						  hurt = math.modf(hurt*0.5)
						end
					else
						if JLSD(20,40+(MPDJ(eid) or 0)*5,eid) and PersonGT(eid, 97) then
						  hurt = 1
						  str=".明尊琉璃" 
						  mzll = 1
						else
						  hurt = math.modf(hurt*0.5)
						end
					end	
					if WAR.fthurt>=panding3 then
					   WAR.fthurt=panding3
					end
					--	WAR.fthurt = math.modf(hurt*0.5)
				elseif MPPD(eid) == 13 and MPDJ(eid) > 2  then		--明教高层非教主反40%，几率明尊琉璃减伤为1
					WAR.fthurt = math.modf(hurt*0.4)	
					if PersonKF(eid,194) then
						if JLSD(20,40+(MPDJ(eid) or 0)*7,eid) and PersonGT(eid, 97) then
						  hurt = 1
						  str=".明尊琉璃" 
						  mzll = 1
						else
						  hurt = math.modf(hurt*0.6)
						end
					else
						if JLSD(20,40+(MPDJ(eid) or 0)*5,eid) and PersonGT(eid, 97) then
						  hurt = 1
						  str=".明尊琉璃" 
						  mzll = 1
						else
						  hurt = math.modf(hurt*0.6)
						end
					end
					if WAR.fthurt>=panding2 then
						WAR.fthurt=panding2
					end
				--	WAR.fthurt = math.modf(hurt*0.4)
				else 
					WAR.fthurt = math.modf(hurt*0.3)
					if PersonGT(eid, 97) then
						hurt = math.modf(hurt*0.7)
					else
						hurt = math.modf(hurt*0.85)
					end
					if WAR.fthurt>=panding1 then
					   WAR.fthurt=panding1
					end
					--	WAR.fthurt = math.modf(hurt*0.3)
					if wglw(eid,97) or (DT(eid, 9) and JX(eid)) then
					   if JLSD(20,60,eid) and PersonGT(eid, 97) then
						  hurt = 1
						  str=str..".明尊天地返"
						else
						  hurt = math.modf(hurt*0.6)
						end
					end
				end
		
				if DT(eid,456) and JLSD(10,90,eid)then  --安七
					hurt = 1
					hurt = math.modf(hurt * 0.6)
				end		
				
				--飞影彩蛋：真龙心法乾坤变回血
				if PersonKF(pid,91) and JY.ZLXF == 1 then
					WAR.fthurt = - WAR.fthurt
				end
				
				--安七
				if DT(pid,456) then
					WAR.fthurt = - WAR.fthurt
				end		
				
				h = WAR.fthurt
			--[[    if ((MPPD(eid)==13 and MPDJ(eid) > 2) or DT(eid, 9)) and h>=math.modf(JY.Person[eid]["内力"]/5) then
				   h =math.modf(JY.Person[eid]["内力"]/5)
				   if h>=200+MPDJ(eid)*100 then
				   h=200+MPDJ(eid)*100
				   elseif DT(eid, 9) and h>=500 then
				   h=500
				   end
				elseif h>=math.modf(JY.Person[eid]["内力"]/10) then
				   h= math.modf(JY.Person[eid]["内力"]/10)
				   if h>=300 then
				   h=300
				   end
				end	]]	
				h2 = math.modf(h*(1+0.1*MPDJ(eid)))
				if DT(eid, 9) then
				h2 = math.modf(h*math.random(3,4)/2)
				end
				SetWarMap(WAR.Person[nyft]["坐标X"], WAR.Person[nyft]["坐标Y"], 4, 2);	--反弹者标识为被命中  	
				WAR.L_QKDNY[WAR.Person[nyft]["人物编号"]] = 1;
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .."・".. CC.WARS106..str		
			end
			if not qkfy(WAR.Person[nyft2]["人物编号"]) then
				if PersonKF(WAR.Person[nyft]["人物编号"],43) and not(wglw(eid,97) or (DT(eid, 9) and JX(eid))) then
					WAR.L_QKDNY[WAR.Person[nzft]["人物编号"]] = 1;
					SetWarMap(WAR.Person[nzft]["坐标X"], WAR.Person[nzft]["坐标Y"], 4, 2);
					if eid == WAR.Person[nzft]["人物编号"] then 
					hurt = hurt + h 
					else
					WAR.Person[nzft]["生命点数"] = (WAR.Person[nzft]["生命点数"] or 0) + AddPersonAttrib(WAR.Person[nzft]["人物编号"],"生命",-h);
					--JY.Person[WAR.Person[nzft]["人物编号"]]["生命"] = JY.Person[WAR.Person[nzft]["人物编号"]]["生命"] - h
					end
				else --not (PersonKF(WAR.Person[nyft]["人物编号"],16) and PersonKF(WAR.Person[nyft]["人物编号"],46)) then
					WAR.Person[nyft]["生命点数"] = (WAR.Person[nyft]["生命点数"] or 0) + AddPersonAttrib(WAR.Person[nyft]["人物编号"],"生命",-h);
					--JY.Person[WAR.Person[nyft]["人物编号"]]["生命"] = JY.Person[WAR.Person[nyft]["人物编号"]]["生命"] - h
				end   
			end
			if JY.Person[WAR.Person[nyft]["人物编号"]]["生命"] <= 0 then
			  JY.Person[WAR.Person[nyft]["人物编号"]]["生命"] = 1
			  --WAR.FXXS[WAR.Person[nyft]["人物编号"]]=1 
			  --WAR.FXDS[WAR.Person[nyft]["人物编号"]]=50
			end
			--沼跃鱼：明教高层可以几率反弹2人，张无忌必反弹2人,且伤害随机2-3倍
			if (DT(eid, 9) or (MPPD(eid)==13 and MPDJ(eid)> 2 and mzll == 1)) and nyft ~= nyft2 then
				if not qkfy(WAR.Person[nyft2]["人物编号"]) then
					if PersonKF(WAR.Person[nyft2]["人物编号"],43) and not(wglw(eid,97) or (DT(eid, 9) and JX(eid))) then
					   SetWarMap(WAR.Person[nzft]["坐标X"], WAR.Person[nzft]["坐标Y"], 4, 2);
						if eid == WAR.Person[nzft]["人物编号"] then 
						hurt = hurt + h2 
						else
						WAR.Person[nzft]["生命点数"] = (WAR.Person[nzft]["生命点数"] or 0) + AddPersonAttrib(WAR.Person[nzft]["人物编号"],"生命",-h2);
						end
					else --not (PersonKF(WAR.Person[nyft]["人物编号"],16) and PersonKF(WAR.Person[nyft]["人物编号"],46)) then
					   WAR.Person[nyft2]["生命点数"] = (WAR.Person[nyft2]["生命点数"] or 0) + AddPersonAttrib(WAR.Person[nyft2]["人物编号"],"生命",-h2);
					   --WAR.Person[nyft2]["生命点数"] = (WAR.Person[nyft2]["生命点数"] or 0) - h2;
					   --JY.Person[WAR.Person[nyft2]["人物编号"]]["生命"] = JY.Person[WAR.Person[nyft2]["人物编号"]]["生命"] - h2;
					end   
				end
				if JY.Person[WAR.Person[nyft2]["人物编号"]]["生命"] <= 0 then
					JY.Person[WAR.Person[nyft2]["人物编号"]]["生命"] = 1
					WAR.FXXS[WAR.Person[nyft2]["人物编号"]]=1 
					WAR.FXDS[WAR.Person[nyft2]["人物编号"]]=50 
				end
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. CC.WARS107
				SetWarMap(WAR.Person[nyft2]["坐标X"], WAR.Person[nyft2]["坐标Y"], 4, 2);	--反弹者标识为被命中
				mzll = 0
			end
			if (wglw(eid,97) or (DT(eid, 9) and JX(eid)) or (T7DFWM(eid) and juexing() >= 2)) and PersonGT(eid,97) then ---沼跃鱼：乾坤领悟弹其他的所有人
				local qiankun2 =0
				if T7DFWM(eid) and WAR.DFWM3 == 1 then
					qiankun2 = 1
				end
				local jl = 40
				if PersonGT(eid, 97) then
					jl = jl + 20
				end
				
				if MPPD(eid)==13 then
					jl = jl + 5*MPDJ(eid)
				end
				
				if wglw(eid,97) or (DT(eid, 9) and JX(eid)) then
					jl = jl + 25
				end
				
				if DT(eid, 9) then
					jl = jl + 15
				end
				if DT(eid, 11) then
					jl = jl + 10
				end
				if JLSD(10, 10 + jl, eid) then
					qiankun2 = 1
				end
				if qiankun2 == 1 then
					for i = 0, WAR.PersonNum - 1 do
						if WAR.Person[i]["我方"] ~= WAR.Person[emenyid]["我方"] and WAR.Person[i]["死亡"] == false and i~= nyft2 and i~= nyft then
							
							WAR.Person[i]["生命点数"] = (WAR.Person[i]["生命点数"] or 0) + AddPersonAttrib(WAR.Person[i]["人物编号"],"生命",-h2);
							--JY.Person[WAR.Person[i]["人物编号"]]["生命"] = JY.Person[WAR.Person[i]["人物编号"]]["生命"] - h2;
							if JY.Person[WAR.Person[i]["人物编号"]]["生命"] <= 0 then
								JY.Person[WAR.Person[i]["人物编号"]]["生命"] = 1
								WAR.FXXS[WAR.Person[i]["人物编号"]]=1 
								WAR.FXDS[WAR.Person[i]["人物编号"]]=50 
							end
							if WAR.Person[emenyid][CC.TXWZ1] == nil then
								WAR.Person[emenyid][CC.TXWZ1] = "明尊白莲.天地无情"
							end
								SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 2);	--反弹者标识为被命中
						end
					end
				end
			end
	
		else--17-1-1 
			local nzdz = {}
			local nznum = 1
			for i = 0, WAR.PersonNum - 1 do
				if WAR.Person[i]["我方"] == WAR.Person[emenyid]["我方"] and WAR.Person[i]["死亡"] == false then
					nzdz[nznum] = i
					nznum = nznum + 1
				end
			end
			local nzft = nzdz[math.random(nznum - 1)]
			SetWarMap(WAR.Person[nzft]["坐标X"], WAR.Person[nzft]["坐标Y"], 4, 2);	--反弹者标识为被命中  	
			WAR.L_QKDNY[WAR.Person[nzft]["人物编号"]] = 1;
			if eid == WAR.Person[nzft]["人物编号"] then 
				hurt = hurt * 2 
			else
				WAR.Person[nzft]["生命点数"] = (WAR.Person[nzft]["生命点数"] or 0) + AddPersonAttrib(WAR.Person[nzft]["人物编号"],"生命",-hurt);
				--JY.Person[WAR.Person[nzft]["人物编号"]]["生命"] = JY.Person[WAR.Person[nzft]["人物编号"]]["生命"] - hurt
			end
			if WAR.Person[WAR.CurID][CC.TXWZ3] == nil then
				WAR.Person[WAR.CurID][CC.TXWZ3] = "斗转星移・乾坤逆转"
			end
		end
		if T7DFWM(eid) and WAR.DFWM3 ~= 1 and PersonKF(eid, 43) and JY.Person[eid]["体力"] > 10
			and juexing() >= 2 and WAR.Person[emenyid]["反击武功"] == -1 and WAR.Person[WAR.CurID]["反击武功"] == -1 then --东方未明斗转乾坤,尝试修复斗转弹来弹去
			local p = JY.Person[eid]
			local dzlv = sixi(eid, 1) + sixi(eid, 2) + sixi(eid, 3) + sixi(eid, 4) + sixi(eid, 5) 
			local dzwz = nil
			local dzfj = nil

			if dzlv >= 360 then      
				dzwz = CC.WARS88			--离合参商
				WAR.DZXYLV[eid] = 3
			elseif dzlv >= 280 then
				dzwz = CC.WARS89			--斗转星移
				WAR.DZXYLV[eid] = 2
			else
				dzwz = CC.WARS90			--北斗移辰
				WAR.DZXYLV[eid] = 1
			end
			if yongquan(wugong) then
			WAR.DFWM3P=1
			dzfj=".真拳荡江湖"
			end		
			if yongjian(wugong) then
			WAR.DFWM3P=2
			dzfj=".傲剑镇山河"			
			end
			if yongdao(wugong) then
			WAR.DFWM3P=3
			dzfj=".狂刀破苍穹"			
			end		
			
			if yongte(wugong) then
			WAR.DFWM3P=4
			dzfj=".天机动乾坤"			
			end
			
			if yongan(wugong) then
			WAR.DFWM3P=5
			dzfj=".千手变星辰"			
			end
			
			if yongnei(wugong) then
			WAR.DFWM3P=6
			dzfj=".罡气乱天下"			
			end
			
			if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. dzwz..dzfj
			else
				WAR.Person[emenyid][CC.TXWZ2] = dzwz..dzfj
			end
			if WAR.Person[emenyid][CC.TXDH] == nil then
				WAR.Person[emenyid][CC.TXDH] = math.fmod(kfid, 10) + 85
			end
			WAR.Person[emenyid]["反击武功"] = wugong
			JY.Person[eid]["体力"] = JY.Person[eid]["体力"] - 3
		end
    end
  

    if WAR.DZXF[pid] == 1 then
        local a1 = math.modf(sixi(eid, 1) * 0.005)
		local a2 = math.modf(sixi(eid, 2) * 0.005)
		local a3 = math.modf(sixi(eid, 3) * 0.005)
		local a4 = math.modf(sixi(eid, 4) * 0.005)
		local a5 = math.modf(sixi(eid, 5) * 0.005)
	    local a6 = math.modf(hurt + (a1 + a2 + a3 + a4 + a5))
	    hurt = 0
	    ang = 0
	    WAR.GTSHAQI = 0
		JY.Person[eid]["内力"] = JY.Person[eid]["内力"] + a6 
        SetWarMap(WAR.Person[emenyid]["坐标X"], WAR.Person[emenyid]["坐标Y"], 4, 2);	--反弹者标识为被命中  	
		JY.Person[pid]["生命"] = JY.Person[pid]["生命"] - a6;
    	WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) -a6
	end 	

    if MPPD(pid) == 11 then --一刀流回气
        WAR.YDZM = WAR.YDZM + hurt
    end	
    if jtyl(eid) then --1-26-
        WAR.SJSM[200+eid] = hurt
	end  
	
	if wssz(eid) then --1-26-
        WAR.SSFN[200+eid] = hurt
	end   
	
	if MPPD(pid) == 4 and wglw(pid,182) and wglw1(pid,46) and wugong == 46 and JLSD(10,70,pid) and DWPD() then
		local aa = JY.Person[eid]["受伤程度"] or 0
		if WAR.BG[pid] == nil then
			WAR.BG[pid] = 0
		else
			hurt = hurt + math.modf((WAR.BG[pid] or 0) * math.random(2,5))
			if WAR.WDTJTJ == 1 then
				WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -aa)
			end	
		end
	end	
	
	if MPPD(pid) == 4 and wglw(pid,182) and wglw1(pid,16) and wugong == 16 and DWPD() then
		local aa = JY.Person[eid]["受伤程度"] or 0
		if WAR.BG[pid] == nil then
			WAR.BG[pid] = 0
		else
			hurt = hurt + math.modf((WAR.BG[pid] or 0) * math.random(2,5))
			if WAR.WDTJTQ == 1 then
				WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -aa)
			end	
		end
	end
	
	--四初武加成
	if PersonKF(pid,1) and PersonKF(pid,27) and PersonKF(pid,50) and PersonKF(pid,68) and MPPD(pid) == 0 then 
		if wglw1(pid,996) then
			if wugong == 1 then
				hurt = math.modf(hurt + sixi(pid,1))
			elseif wugong == 27 then
				hurt = math.modf(hurt + sixi(pid,2))
			elseif wugong == 50 then
				hurt = math.modf(hurt + sixi(pid,3))
			elseif wugong == 68 then
				hurt = math.modf(hurt + sixi(pid,4))
			end
		else
			if wugong == 1 then
				local aa = math.modf(sixi(pid,1)/4)
				hurt = math.modf(hurt + math.random(aa,aa*2))
			elseif wugong == 27 then
				local aa = math.modf(sixi(pid,2)/4)
				hurt = math.modf(hurt + math.random(aa,aa*2))
			elseif wugong == 50 then
				local aa = math.modf(sixi(pid,3)/4)
				hurt = math.modf(hurt + math.random(aa,aa*2))
			elseif wugong == 68 then
				local aa = math.modf(sixi(pid,4)/4)
				hurt = math.modf(hurt + math.random(aa,aa*2))
			end
		end	
	end	
	
	if PersonGT(pid,181) then  --玄武真功增加全系破防
	    hurt = hurt + math.modf(JY.Person[pid]["攻击力"]/4)
	elseif PersonKF(pid,181) then 
	    hurt = hurt + math.modf(JY.Person[pid]["攻击力"]/6)
	--[[else
		if PersonGT(pid,182) and yongquan(wugong) then   --太极神功增加拳系破防
			hurt = hurt + math.modf(JY.Person[pid]["轻功"]/4)
		elseif PersonKF(pid,182) and yongquan(wugong) then 
			hurt = hurt + math.modf(JY.Person[pid]["轻功"]/6)
		end
		if PersonGT(pid,203) and yongjian(wugong) then   --怒海剑涛增加剑系破防
			hurt = hurt + math.modf(JY.Person[pid]["轻功"]/4)
		elseif PersonKF(pid,203) and yongjian(wugong) then 
			hurt = hurt + math.modf(JY.Person[pid]["轻功"]/6)
		end	
		if PersonGT(pid,106) and yongdao(wugong) then   --九阳神功增加刀系破防
			hurt = hurt + math.modf(JY.Person[pid]["轻功"]/4)
		elseif PersonKF(pid,106) and yongdao(wugong) then 
			hurt = hurt + math.modf(JY.Person[pid]["轻功"]/6)
		end
		if PersonGT(pid,103) and yongte(wugong) then   --龙象增加特系破防
			hurt = hurt + math.modf(JY.Person[pid]["轻功"]/4)
		elseif PersonKF(pid,103) and yongte(wugong) then 
			hurt = hurt + math.modf(JY.Person[pid]["轻功"]/6)
		end
		if PersonGT(pid,107) and  yongan(wugong) then   --九阴神功增加暗系破防
			hurt = hurt + math.modf(JY.Person[pid]["轻功"]/4)
		elseif PersonKF(pid,183) and  yongan(wugong) then 
			hurt = hurt + math.modf(JY.Person[pid]["轻功"]/6)
		end	
		if PersonGT(pid,108) and yongnei(wugong) then   --易筋经增加内功攻击破防
			hurt = hurt + math.modf(JY.Person[pid]["轻功"]/4)
		elseif PersonKF(pid,183) and yongnei(wugong) then 
			hurt = hurt + math.modf(JY.Person[pid]["轻功"]/6)
		end	]]
	end
	
	
	if WAR.DUO == 1 then
		if MPPD(pid) == 11 then
			hurt = math.modf(hurt*0.3)
		elseif PersonKF(pid,180) then
			hurt = math.modf(hurt*0.5)
		elseif nomiss(pid) then
			if wglw2(eid,179) and JLSD(10,20,eid) and PersonKF(eid,179) then
				hurt = 0
				if WAR.Person[emenyid][CC.TXWZ3] == nil then
					WAR.Person[emenyid][CC.TXWZ3] = "覆海鹏穹"
				else
					WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."凌波微步・覆海鹏穹"
				end
			else
			end	
		elseif WAR.TLDW[eid] == 1 and JLSD(10,80,eid) then
		else
			hurt = 0
			WAR.DUO = 0
		end
	end	
	
	
	if MPPD(pid) == 11 then --一刀流格切1-25-
	    local dj = MPDJ(pid)
	    local sh = 0
	    local a = 0
	    if WAR.JQ[pid] ~= nil and WAR.JQ[pid] > 0 then 
	        a = WAR.JQ[pid]+1
	    end
	    sh = WAR.GQ - hurt
	    if PersonGT(pid,180) then 
            hurt = hurt + math.modf(sh*0.1)
	    elseif PersonKF(pid,180) then
            hurt = hurt + math.modf(sh*0.05)
	    end  
	        --hurt = hurt + math.modf(sh*0.05*a)
	    if WAR.HQJK == 1 then
	        if jtyl(pid) then 
	            hurt = hurt + math.modf(sh*0.03*a)
	        else 
	            hurt = hurt + math.modf(sh*0.02*a)
	        end
	    else
	        if jtyl(pid) then 
	            hurt = hurt + math.modf(sh*0.02*a)
	        else 
	            hurt = hurt + math.modf(sh*0.01*a)
	        end
	    end
	        WAR.GQ = 0
	else  
	    if PersonGT(pid,180) and wugong ~= 18 then 
	        local sh = 0
	        sh = WAR.GQ - hurt
	        hurt = hurt + math.modf(sh*0.08)
	    elseif PersonKF(pid,180) or (wugong == 60 and (wglw1(pid,60) or DT(pid,166))) then  -- 
	        local sh = 0
	        sh = WAR.GQ - hurt
	        hurt = hurt + math.modf(sh*0.04)
		elseif wugong == 18 and WAR.TZQJ11[pid] ~= nil then
			local sh = 0
	        sh = WAR.GQ - hurt
	        hurt = hurt + math.modf(sh*0.03)	
	    end
		WAR.GQ = 0
	end 
	
	--生命与hurt之间的关系
	if hurt < 0 then hurt = 0 end
	hurt = math.min(hurt, JY.Person[eid]["生命"] or 0)	
	
    if (wglw(pid,592) or DT(pid,592)) and WAR.DGJY[pid] ~= nil then --17-2-10
	    hurt = hurt + math.modf(JY.Person[eid]["生命最大值"]*0.04)
	    WAR.Person[emenyid]["生命点数"] = (WAR.Person[emenyid]["生命点数"] or 0) + AddPersonAttrib(eid,"生命",-hurt)
		--JY.Person[eid]["生命"] = JY.Person[eid]["生命"] - hurt
    elseif (wglw(pid,107) or DT(pid,599)) and WAR.JYZQ[pid] ~= nil then --17-2-10
	    hurt = hurt + math.modf(JY.Person[eid]["生命最大值"]*0.04)
	    WAR.Person[emenyid]["生命点数"] = (WAR.Person[emenyid]["生命点数"] or 0) + AddPersonAttrib(eid,"生命",-hurt)
	elseif (getHZ(eid, 9) or hasTF(eid, 27)) and JLSD(10, 20, eid) then --长生符
		WAR.Person[emenyid]["生命点数"] = (WAR.Person[emenyid]["生命点数"] or 0) + AddPersonAttrib(eid,"生命",hurt)
		WAR.CSF[emenyid] = hurt
		if WAR.Person[emenyid][CC.TXWZ3] == nil then
			WAR.Person[emenyid][CC.TXWZ3] = "长生不息"
		else
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."长生不息"
		end
	elseif wglw1(pid,48) and wugong == 48 then
		for j = 0, WAR.PersonNum-1 do 
			local df = WAR.Person[j]["人物编号"] 
			local offset1 = math.abs(WAR.Person[WAR.CurID]["坐标X"] - WAR.Person[j]["坐标X"]) 
            local offset2 = math.abs(WAR.Person[WAR.CurID]["坐标Y"] - WAR.Person[j]["坐标Y"])
			--local offset=offset1+offset2		
			if WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[j]["死亡"] == false and offset1 <= 6 and offset2 <= 6 then
			   WAR.Person[j]["生命点数"] = (WAR.Person[j]["生命点数"] or 0) + AddPersonAttrib(df,"生命",-hurt)
			   SetWarMap(WAR.Person[j]["坐标X"], WAR.Person[j]["坐标Y"], 4, 2);
			end
        end
	else
		if kill(pid, eid) then
			hurt = JY.Person[eid]["生命"]
			JY.Person[eid]["生命"] = 0			
		end
		WAR.Person[emenyid]["生命点数"] = (WAR.Person[emenyid]["生命点数"] or 0) + AddPersonAttrib(eid,"生命",-hurt)
	end
	
	if WAR.UNDEAD[eid] ~= nil and WAR.UNDEAD[eid] > 0 then
		JY.Person[eid]["生命"] = 1
	end
    if jtyl(eid) and  DWPD() then --1-26-
        WAR.SJSM[eid] = WAR.SJSM[100+eid] - WAR.SJSM[200+eid]
	    if JY.Person[eid]["生命"] < WAR.SJSM[eid] then
	        WAR.Person[emenyid][CC.TXWZ3] = "九天一流・大悟晦"
	    end
	    JY.Person[eid]["生命"] = WAR.SJSM[eid]
	    WAR.SJSM[eid] = nil
	    WAR.SJSM[100+eid] = nil
	    WAR.SJSM[200+eid] = nil
	    WAR.SJSM[1000+eid] = JY.Person[eid]["生命"]
	end

	if wssz(eid) and  DWPD() then --1-26-
        WAR.SSFN[eid] = WAR.SSFN[100+eid] - WAR.SSFN[200+eid]
	    if JY.Person[eid]["生命"] < WAR.SSFN[eid] then
	        WAR.Person[emenyid][CC.TXWZ3] = "兽神心经・麒麟降世"
	    end
	    JY.Person[eid]["生命"] = WAR.SSFN[eid]
	    WAR.SSFN[eid] = nil
	    WAR.SSFN[100+eid] = nil
	    WAR.SSFN[200+eid] = nil
	    WAR.SSFN[1000+eid] = JY.Person[eid]["生命"]
	end
	
    if (DT(eid,618) or jtyl(eid)) and JY.Person[eid]["生命"] <= 0 and JY.Person[eid]["体力"] >= 10 and hurt > 0 then
        JY.Person[eid]["生命"] = 1
		--JY.Person[eid]["死亡"] = false
	   	WAR.Person[emenyid]["体力点数"] = (WAR.Person[emenyid]["体力点数"] or 0) + AddPersonAttrib(eid, "体力", -20)
	end
    if (wglw(eid,90) and not (NF(eid) or DT(eid,618))) and JY.Person[eid]["生命"] <= 0 and JY.Person[eid]["体力"] >= 40 and hurt > 0 then
        JY.Person[eid]["生命"] = 1
		--JY.Person[eid]["死亡"] = false
	   	WAR.Person[emenyid]["体力点数"] = (WAR.Person[emenyid]["体力点数"] or 0) + AddPersonAttrib(eid, "体力", -40)
	end
	
    --太极拳，借力打力
    if PersonKF(eid, 16) and DWPD() then
        if WAR.tmp[3000 + eid] == nil then
            WAR.tmp[3000 + eid] = 0
        end
        WAR.tmp[3000 + eid] = hurt + WAR.tmp[3000 + eid]
	    if DT(eid,5) then
	        if WAR.tmp[3000 + eid] > 100 and WAR.tmp[3000 + eid] <= 200 then
                WAR.JLDL2 = 1
	        elseif WAR.tmp[3000 + eid] > 200 and WAR.tmp[3000 + eid] <= 300 then
                WAR.JLDL2 = 2
	        elseif WAR.tmp[3000 + eid] > 300 and WAR.tmp[3000 + eid] <= 400 then
                WAR.JLDL2 = 3
	        elseif WAR.tmp[3000 + eid] > 400 then
                WAR.JLDL2 = 4
	        end
	    end	  
    end
	
	--铁碎牙暴流破储存伤害
	if PersonKF(eid, 67) and (wglw1(eid,67) or (DT(eid, 1) and JX(eid)) or (DT(eid, 621) and JX(eid))) and DWPD() then
        if WAR.tmp[3000 + eid] == nil then
            WAR.tmp[3000 + eid] = 0
        end
		WAR.tmp[3000 + eid] = hurt + WAR.tmp[3000 + eid]
	end	
	
	if DT(eid,5) and JLSD(0,50,eid) and DWPD() then --1-27-
	    WAR.TJYL[pid] = 1
		if WAR.Person[emenyid][CC.TXWZ2] == nil then
			WAR.Person[emenyid][CC.TXWZ2] = "以静制动"
		else
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+以静制动"
		end
	end
    --借力打力
    if DT(eid,5) then 
        WAR.JLDL = hurt + WAR.JLDL
        if WAR.JLDL > 400 then 
		    WAR.Person[emenyid].TimeAdd = 999
		    WAR.Person[emenyid].Time = 1005
	    end
    end 
  
    --太极神功借力打力
    if PersonKF(pid,182) and DWPD() then
		if WAR.tmp[3000+eid] == nil then
			WAR.tmp[3000+eid] = 0
		else
			WAR.tmp[3000 + eid] = hurt + WAR.tmp[3000 + eid]
		end
	end	

    if (MPPD(eid) == 4  or wglw(eid,97)) and DWPD() then --武当八卦储伤害
	    if WAR.BG[eid] == nil then
		    WAR.BG[eid] = hurt
	    else
		    WAR.BG[eid] = WAR.BG[eid] + hurt
	    end
		if wglw(eid,97)  then
		elseif wglw(eid,182) and (wglw1(eid,16) or wglw1(eid,46)) then
		elseif DT(eid,5) then
		elseif WAR.BG[eid] > math.modf(MPDJ(eid) * 50) then
			 WAR.BG[eid] = math.modf(MPDJ(eid) * 50)
		end
    end
  
    if hasTF(eid, 130) and DWPD() then
	    WAR.NSNS[eid] = hurt
    end
  
    --获取得经验
    WAR.Person[WAR.CurID]["经验"] = WAR.Person[WAR.CurID]["经验"] + math.modf((hurt) / 5)
  
    --神照重生
    if (not hasTF(pid, 83)) and WAR.LMJQ ~= 4 and JY.Person[eid]["生命"] <= 0 and T5BCF(eid) == false then
       --for i = 1, 10 do
       --local kfid = JY.Person[eid]["武功" .. i] kfid == 94
            if PersonKF(eid, 94) and WAR.tmp[2000 + eid] == nil then
                WAR.Person[emenyid][CC.TXDH] = math.fmod(94, 10) + 85
                WAR.Person[emenyid][CC.TXWZ1] = JY.Wugong[94]["名称"] .. CC.WARS111
                --local lv = math.modf(JY.Person[eid]["武功等级" .. i] / 100) + 1
		        --if lv > 10 then lv = 10 end
                    if DT(eid, 37) or PersonGT(eid, 94) then --神照主功体全恢复
                        JY.Person[eid]["生命"] = JY.Person[eid]["生命最大值"]
                    else
                        JY.Person[eid]["生命"] = math.modf(JY.Person[eid]["生命最大值"] / 2)
                    end
        if PersonGT(eid, 94) then 
			JY.Person[eid]["内力"] = JY.Person[eid]["内力最大值"]
			JY.Person[eid]["体力"] = 100
			WAR.Person[emenyid].Time = 990	
			JY.Person[eid]["中毒程度"] = 0
			JY.Person[eid]["受伤程度"] = 0	
			WAR.FXDS[eid] = nil
			WAR.LXZT[eid] = nil
			WAR.CHZ[eid] = nil
		else
			JY.Person[eid]["内力"] = math.modf((JY.Person[eid]["内力"] + JY.Person[eid]["内力最大值"]) / 2)
			JY.Person[eid]["体力"] = math.modf((JY.Person[eid]["体力"] + 100) / 2)
			JY.Person[eid]["中毒程度"] = 0
			JY.Person[eid]["受伤程度"] = 0	
			WAR.FXDS[eid] = nil
			WAR.LXZT[eid] = nil
			WAR.CHZ[eid] = nil
			WAR.Person[emenyid].Time = WAR.Person[emenyid].Time + 500
		end
        if DT(eid , 37) then
          WAR.Person[emenyid].Time = 990
          WAR.DYSZ = 1
        end
        if WAR.Person[emenyid].Time > 990 then
          WAR.Person[emenyid].Time = 990
        end
		
        zhanyi(eid, -5) ---复活减战意
		
		if PersonGT(eid, 94) then --神照主功体10%重置，否则5%
			if math.random(10) ~= 5 then		
		      WAR.tmp[2000 + eid] = 1
			  --if T9ZY(eid) then
				--WAR.tmp[2000 + 0] = 1
				--WAR.tmp[2000 + 582] = 1
			  --end
		    end
		else
			if math.random(20) ~= 10 then		
		      WAR.tmp[2000 + eid] = 1
			  --if T9ZY(eid) then
				--WAR.tmp[2000 + 0] = 1
				--WAR.tmp[2000 + 582] = 1
			  --end			  
		    end
		end
	  end
    --end
   end

    --王重阳，复活,沼跃鱼：论剑模式开启
    if (not hasTF(pid, 83)) and WAR.LMJQ ~= 4 and JY.Person[eid]["生命"] <= 0 and DT(eid, 129) and WAR.WCY < 1 then
        WAR.Person[emenyid][CC.TXDH] = 19
        WAR.Person[emenyid][CC.TXWZ1] = CC.WARS112
        WAR.WCY = WAR.WCY + 1
        JY.Person[eid]["生命"] = JY.Person[eid]["生命最大值"]
        JY.Person[eid]["内力"] = JY.Person[eid]["内力最大值"]
        JY.Person[eid]["中毒程度"] = 0
        JY.Person[eid]["受伤程度"] = 0
        JY.Person[eid]["体力"] = 100
        WAR.Person[emenyid].Time = 980
	    zhanyi(eid, -5) ---复活减战意
	    WAR.LQZ[eid]=WAR.LQZ[eid] or 0 + 100
	    if WAR.LQZ[eid]>=100 then
	        WAR.LQZ[eid]=100
	    end
	    WAR.FXDS[eid] = nil
	    WAR.LXZT[eid] = nil
	    WAR.CHZ[eid] = nil
	    WAR.WCY3 = 7
    end
  
    --一灯，复活，沼跃鱼：六脉转龙
    if (not hasTF(pid, 83)) and WAR.LMJQ ~= 4 and JY.Person[eid]["生命"] <= 0 and DT(eid , 65) and WAR.WCY1 < 1 then
        WAR.Person[emenyid][CC.TXDH] = 108
        WAR.Person[emenyid][CC.TXWZ2] = "先天一灯.气指如剑"
        WAR.WCY1 = WAR.WCY1 + 1
        JY.Person[eid]["生命"] = JY.Person[eid]["生命最大值"]
        JY.Person[eid]["内力"] = JY.Person[eid]["内力最大值"]
        JY.Person[eid]["中毒程度"] = 0
        JY.Person[eid]["受伤程度"] = 0
        JY.Person[eid]["体力"] = 100
        WAR.Person[emenyid].Time = 980
	    zhanyi(eid, -5) ---复活减战意
	    WAR.LQZ[eid]=WAR.LQZ[eid] or 0 + 100
	    if WAR.LQZ[eid]>=100 then
	        WAR.LQZ[eid]=100
	    end
	    WAR.FXDS[eid] = nil
	    WAR.LXZT[eid] = nil
	    WAR.CHZ[eid] = nil
	    WAR.WCY4 = 6
    end
  
    --豸苗：先天领悟
    if (not hasTF(pid, 83)) and WAR.LMJQ ~= 4 and JY.Person[eid]["生命"] <= 0 and WAR.WCY2 < 1 and wglw(eid,100) then--豸苗：先天领悟
        WAR.Person[emenyid][CC.TXDH] = 109
        WAR.Person[emenyid][CC.TXWZ2] = "先天重阳.北斗装攻"
        WAR.WCY2 = WAR.WCY2 + 1
        JY.Person[eid]["生命"] = JY.Person[eid]["生命最大值"]
        JY.Person[eid]["内力"] = JY.Person[eid]["内力最大值"]
        JY.Person[eid]["中毒程度"] = 0
        JY.Person[eid]["受伤程度"] = 0
        JY.Person[eid]["体力"] = 100
        WAR.Person[emenyid].Time = 999
	    WAR.Person[emenyid].TimeAdd = 999
	    dng = 1
	    WAR.ACT = 10
    end
  
    --豸苗：神照重生
    if (not hasTF(pid, 83)) and WAR.LMJQ ~= 4 and JY.Person[eid]["生命"] <= 0 and WAR.RZSZ[eid] == 1 then--豸苗：先天领悟
        WAR.Person[emenyid][CC.TXDH] = 19
        WAR.Person[emenyid][CC.TXWZ1] = "神照重生"
        JY.Person[eid]["生命"] = JY.Person[eid]["生命最大值"]
        JY.Person[eid]["内力"] = JY.Person[eid]["内力最大值"]
        JY.Person[eid]["中毒程度"] = 0
        JY.Person[eid]["受伤程度"] = 0
        JY.Person[eid]["体力"] = 100
        WAR.Person[emenyid].Time = 999
	    WAR.Person[emenyid].TimeAdd = 999
	    dng = 1
	    WAR.ACT = 10
	    WAR.RZSZ[eid] = 0
    end
  
    if (not hasTF(pid, 83)) and WAR.LMJQ ~= 4 and JY.Person[eid]["生命"] <= 0 and getHZ(eid, 31) and WAR.XTY[eid] == nil then --先天印
        WAR.Person[emenyid][CC.TXDH] = 19
        WAR.Person[emenyid][CC.TXWZ1] = CC.WARS112
        WAR.XTY[eid] = 1
        JY.Person[eid]["生命"] = 500
	    zhanyi(eid, -5) ---复活减战意
    end

    --葵花领悟复活
    if (not hasTF(pid, 83)) and WAR.LMJQ ~= 4 and JY.Person[eid]["生命"] <= 0 and WAR.KHCS < 1 and (wglw(eid,105) and PersonGT(eid, 105)) or (PersonGT(eid, 105) and (DT(eid, 455))) and JLSD(10, 60, eid) then
        WAR.KHCS = WAR.KHCS + 1 
        WAR.Person[emenyid][CC.TXDH] = 144
        WAR.Person[emenyid][CC.TXWZ1] = "天人化生・万物滋长"
        JY.Person[eid]["生命"] = JY.Person[eid]["生命最大值"]
        JY.Person[eid]["内力"] = JY.Person[eid]["内力最大值"]
        JY.Person[eid]["中毒程度"] = 0
        JY.Person[eid]["受伤程度"] = 0
        JY.Person[eid]["体力"] = 100
        WAR.Person[emenyid].Time = 980
    elseif JY.KHCSJL > 0 then
        JY.Person[eid]["生命"] = math.modf(JY.Person[eid]["生命最大值"] * JY.KHCSJL / 50)
        JY.Person[eid]["内力"] = math.modf((JY.Person[eid]["内力"] + JY.Person[eid]["内力最大值"]) / 2)
        JY.Person[eid]["体力"] = math.modf((JY.Person[eid]["体力"] + 50) / 2)
        JY.Person[eid]["中毒程度"] = math.modf(JY.Person[eid]["中毒程度"] / 2)
        JY.Person[eid]["受伤程度"] = math.modf(JY.Person[eid]["受伤程度"] / 2)
        WAR.Person[emenyid].Time = WAR.Person[emenyid].Time + 500
    end

    if (not hasTF(pid, 83)) and WAR.LMJQ ~= 4 and JY.Person[eid]["生命"] <= 0 and WAR.LYCS < 1 and BJY(eid) and juexing() > 0 then
		WAR.LYCS = WAR.LYCS + 1 
        WAR.Person[emenyid][CC.TXDH] = 120
        WAR.Person[emenyid][CC.TXWZ1] = "龙元重生・逆道乾坤"
        JY.Person[eid]["生命"] = JY.Person[eid]["生命最大值"]
        JY.Person[eid]["内力"] = JY.Person[eid]["内力最大值"]
        JY.Person[eid]["中毒程度"] = 0
        JY.Person[eid]["受伤程度"] = 0
        JY.Person[eid]["体力"] = 100
        WAR.Person[emenyid].Time = 980
	    zhanyi(eid, -5) ---复活减战意
	    WAR.LQZ[eid] = WAR.LQZ[eid] or 0 + 100
	    if WAR.LQZ[eid] >= 100 then
	        WAR.LQZ[eid] = 100
	    end
	    WAR.FXDS[eid] = nil
	    WAR.LXZT[eid] = nil
	    WAR.CHZ[eid] = nil
		WAR.LYFH = 3
    end 

    --薛慕华 复活一个人
    if (not hasTF(pid, 83)) and WAR.LMJQ ~= 4 and JY.Person[eid]["生命"] <= 0 and WAR.XMH == 0 and T5BCF(eid) == false then
        for i = 0, WAR.PersonNum - 1 do
            if DT(WAR.Person[i]["人物编号"], 45) and WAR.Person[i]["死亡"] == false and WAR.Person[i]["我方"] == WAR.Person[ emenyid]["我方"] then --武骧金星：单通判定修正
                WAR.Person[emenyid][CC.TXDH] = 89
                WAR.Person[emenyid][CC.TXWZ1] = CC.WARS113		--阎王敌 重生
                JY.Person[eid]["生命"] = JY.Person[eid]["生命最大值"]
                JY.Person[eid]["内力"] = JY.Person[eid]["内力最大值"]
                JY.Person[eid]["中毒程度"] = 0
                JY.Person[eid]["受伤程度"] = 0
                JY.Person[eid]["体力"] = 100
                WAR.FXDS[eid] = nil
                WAR.LXZT[eid] = nil
		        WAR.CHZ[eid] = nil
                WAR.XMH = 1
		        zhanyi(eid, -5) ---复活减战意
			end
		end
	
		if (not hasTF(pid, 83)) and WAR.LMJQ ~= 4 and DT1(eid, 45) then
			WAR.Person[emenyid][CC.TXDH] = 89
			WAR.Person[emenyid][CC.TXWZ1] = CC.WARS113		--阎王敌 重生
			JY.Person[eid]["生命"] = JY.Person[eid]["生命最大值"]
			JY.Person[eid]["内力"] = JY.Person[eid]["内力最大值"]
			JY.Person[eid]["中毒程度"] = 0
			JY.Person[eid]["受伤程度"] = 0
			JY.Person[eid]["体力"] = 100
			WAR.FXDS[eid] = nil
			WAR.LXZT[eid] = nil
			WAR.CHZ[eid] = nil
			WAR.XMH = 1
			zhanyi(eid, -5) ---复活减战意
		end
	end

	if (not hasTF(pid, 83)) and WAR.LMJQ ~= 4 and JY.Person[eid]["生命"] <= 0 and T5BCF(eid) and juexing() >= 1 then --白愁飞觉醒后两次复活
		if WAR.BCFFH == 0 then
			WAR.Person[emenyid][CC.TXDH] = 89
			WAR.Person[emenyid][CC.TXWZ1] = "龙飞九天，岂惧亢龙有悔"
			JY.Person[eid]["生命"] = JY.Person[eid]["生命最大值"]
			JY.Person[eid]["内力"] = JY.Person[eid]["内力最大值"]
			JY.Person[eid]["中毒程度"] = 0
			JY.Person[eid]["受伤程度"] = 0
			JY.Person[eid]["体力"] = 100
			WAR.FXDS[eid] = nil
			WAR.LXZT[eid] = nil
			WAR.CHZ[eid] = nil		
			WAR.Person[emenyid].Time = 990
			WAR.BCFFH = 1	
			zhanyi(eid, -5) ---复活减战意	
		elseif WAR.BCFFH == 1 then
			WAR.Person[emenyid][CC.TXDH] = 89
			WAR.Person[emenyid][CC.TXWZ1] = "鹰飞九霄，未恐高不胜寒"
			JY.Person[eid]["生命"] = math.modf(JY.Person[eid]["生命最大值"] * 0.5)
			JY.Person[eid]["内力"] = math.modf(JY.Person[eid]["内力最大值"] * 0.5)
			JY.Person[eid]["中毒程度"] = 0
			JY.Person[eid]["受伤程度"] = 0
			JY.Person[eid]["体力"] = 50
			WAR.FXDS[eid] = nil
			WAR.LXZT[eid] = nil
			WAR.CHZ[eid] = nil		
			WAR.Person[emenyid].Time = 500
			WAR.BCFFH = 2
			zhanyi(eid, -5) ---复活减战意
		end	
	end	

    if (not hasTF(pid, 83)) and WAR.LMJQ ~= 4 and DT(eid, 600) and JY.Person[eid]["生命"] <= 0 then
        WAR.Person[emenyid][CC.TXDH] = 144
        WAR.Person[emenyid][CC.TXWZ1] = "天命心法"
        JY.Person[eid]["生命"] = JY.Person[eid]["生命最大值"]
        JY.Person[eid]["内力"] = JY.Person[eid]["内力最大值"]
        JY.Person[eid]["中毒程度"] = 0
        JY.Person[eid]["受伤程度"] = 0
        JY.Person[eid]["体力"] = 100
        WAR.Person[emenyid].Time = 980
        WAR.Person[emenyid].Time = WAR.Person[emenyid].Time + 500
    end

    if (not hasTF(pid, 83)) and WAR.LMJQ ~= 4 and DT(eid, 456) and JY.Person[eid]["生命"] <= 0 then
        WAR.Person[emenyid][CC.TXDH] = 109
        WAR.Person[emenyid][CC.TXWZ1] = "第七奇迹"
        JY.Person[eid]["生命"] = JY.Person[eid]["生命最大值"]
        JY.Person[eid]["内力"] = JY.Person[eid]["内力最大值"]
        JY.Person[eid]["中毒程度"] = 0
        JY.Person[eid]["受伤程度"] = 0
        JY.Person[eid]["体力"] = 100
        WAR.Person[emenyid].Time = 980
        WAR.Person[emenyid].Time = WAR.Person[emenyid].Time + 500
    end

    --小日本
    if (not hasTF(pid, 83)) and WAR.LMJQ ~= 4 and DT(eid, 553) and JY.Person[eid]["生命"] <= 0 then
       WAR.YZB = 1
    end
  
    if (not hasTF(pid, 83)) and WAR.LMJQ ~= 4 and JY.Person[eid]["生命"] <= 0 and eid ~= 0 and putong() == 11 and WAR.PLJZ3 == 0 then
	    local haszj = 0
	    for k = 0, WAR.PersonNum - 1 do
		    local tmppid = WAR.Person[k]["人物编号"]
		    if tmppid == 0 and WAR.Person[k]["死亡"] == false and 
			    WAR.Person[emenyid]["我方"] == WAR.Person[k]["我方"] then
			    haszj = 1
			    break
		end
	end
	    if haszj == 1 then
		    WAR.PLJZ3 = eid
	    end	
    end
  
    if JY.Person[eid]["生命"] <= 0 then
        JY.Person[eid]["生命"] = 0
        WAR.Person[WAR.CurID]["经验"] = WAR.Person[WAR.CurID]["经验"] + JY.Person[eid]["等级"] * 5
        WAR.Person[emenyid]["反击武功"] = -1
    end
    if fqdid(pid) and wugong == 62 then 
        ang = ang + WAR.FQDF*500
    end
	if JY.Person[pid]["武器"] == 243 and JLSD(10,40,pid)  then --铂丝掌套
		ang = ang + 600
	end	
    --计算是否破防，dng为0表示被破防
    ang = ang - dng
    if 0 < ang then
       dng = 0
    else
       dng = -ang
       ang = 0
    end
     
    if (getHZ(eid, 26) and JLSD(10, 60, eid)) or DT(eid, 114) then
	    if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = CC.WARS114	--天地独尊
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+"..CC.WARS114	
	    end
        WAR.Person[emenyid][CC.TXDH] = 39
        dng = 1
    end  
  
    if wglw(eid,108) or DT(eid, 615) or DT(eid, 114) or DT(eid,585) then
	    if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "易筋真谛"
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+".."易筋真谛"
	    end
            WAR.Person[emenyid][CC.TXDH] = 39
            dng = 1
    end  
	
    if DT(eid,457) then
	    if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "易筋真谛"
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+".."易筋真谛"
	    end
            WAR.Person[emenyid][CC.TXDH] = 39
        dng = 1
    end  	
	
	--武无敌免杀气 
    if DT(eid, 600) then
        dng = 1
    end
  
    --聂风3觉免杀气
    if NF(eid) and juexing() > 2 then 
	    dng = 1
	end

    if wglw(eid,94) or (DT(eid,632) and PersonKF(eid,94)) then
		dng = 1
	end	

    --伤害小于20 免内伤，免杀气 
    if hurt < 20 then
        dng = 1
    end
  
    --狄云复活第一回合，免内伤，免杀气 
    if DT(eid , 37) and WAR.DYSZ == 1 then
        dng = 1
        WAR.DYSZ = 0
    end
  
    --不动如山 免内伤，免杀气 
    if eid == 0 and 0 < WAR.FLHS4 then
        dng = 1
    end
  
    --段思平免杀气
    if DT(eid, 602) then
	    dng = 1
    end 

    --木灵子免杀气
	if DT(eid, 603) then
	    dng = 1
    end 

    --小二免杀气
    if DT(eid, 585) then
	    dng = 1
    end 

	--踏雪无痕领悟
	if wglw2(eid,195) and PersonKF(eid,195) then
		if JY.Person[pid]["轻功"] <= JY.Person[eid]["轻功"] and JLSD(10,80,eid) then
			dng = 1
		end
	end	
	
	if wglw1(eid,18) and WAR.TZQJ7[eid] ~= nil then
		dng = 1
	end	

    --豸苗：盖世无双
    if PersonKFJ(eid, 26) and PersonKFJ(eid, 80) and DT(eid, 69) and JLSD(10,80,eid) then
	    if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "丐世无双"
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+丐世无双"
	    end
            WAR.Person[emenyid][CC.TXDH] = 68
        dng = 1
    end  
    
    --无求易诀
    if BJY(eid) and juexing() > 2 then
	    if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "无求易转"
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+无求易转"
	    end
            WAR.Person[emenyid][CC.TXDH] = 70
        dng = 1
    end  	 	
	
    if (wglw(eid,188) or (DT(eid,48) and PersonGT(eid,188)))	and JLSD(10,60,eid) then
		if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "欲三摩地"
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+欲三摩地"
	    end
        dng = 1
    end  		
	
    if DT(eid,583) then
        dng = 1
    end  		
	
    if WAR.SJRS == 1 then
		dng = 1
	end		
	
    if DT(eid,617) then
		dng = 1
	end 		
	
    if WAR.WLKH == 1 then
		dng = 1
	end 		
	
    --太极奥义，免免内伤，免杀气 
    if (WAR.TJAY or 0) < 2 then	--武骧金星：赵半山特效
	    if DT(eid, 153) then WAR.TJAY = 2 end
		for j = 0, WAR.PersonNum - 1 do
			local jid = WAR.Person[j]["人物编号"]
			if DT(jid, 153) and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] and math.random(100) <= 35 then 
				WAR.TJAY = 2
			end
		end	
    end
	if JLSD(10,25*(WAR.TJAY or 0) +math.modf(JY.Person[eid]["资质"]/3),eid) then
		for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
			if (JY.Person[eid]["武功" .. i] == 16 or JY.Person[eid]["武功" .. i] == 46) and JY.Person[eid]["武功等级" .. i] >= 999 then
				WAR.TJAY = WAR.TJAY + 1
			end
		end
		if WAR.TJAY == 1 and MPPD(eid) == 4 and (PersonGT(eid,99) or PersonGT(eid,182)) then	
			WAR.TJAY = 2
		end
		if WAR.TJAY == 1 and DT(eid,80) and JX(pid) then
			WAR.TJAY = 2
		end	
	end	
	if DT(eid, 5) and zhangsanfeng == 1 then
		WAR.TJAY = 2
	end
	if (DT(eid, 171) or DT(eid, 172)) and JLSD(10, 30, eid) then
		WAR.TJAY = 2
	end	
    if (wglw(eid,182) or (DT(eid,5) and PersonGT(eid,182)))	then
		local wdjl = 0
		if MPPD(eid) == 4 then
			wdjl = 10 
		end
		if JLSD(10,60+wdjl,eid) then
			WAR.TJAY = 2
		end	
		if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "太极奥义"
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+太极奥义"
	    end
    end 
	if WAR.TJAY == 2 then --太奥40 + 资质/3
	    local str = "太极奥义"
	    local str1 = ""
	    local TQ=0
	    local TJ=0
	    if wglw(eid,99) or DT(eid,5) or DT(eid,666) then 
	        WAR.LSQL1 = 1
	        str = "太极奥义・万物无极"
	    else   
	        dng = 1
	    end
	    if PersonKFJ(eid,16) or PersonKFJ(eid,7) then
			TQ = 1
		end	
        if PersonKFJ(eid,46) or PersonKFJ(eid,134) or PersonKFJ(eid,36) then
			TJ = 1
		end	
		--太极功主运特效
		if (TJ==1 and MPPD(eid)==4 and PersonGT(eid,182)) and (JLSD(10,25*WAR.TJAY+math.modf(JY.Person[eid]["资质"]/3),eid)) or
			((DT(eid, 171) or DT(eid, 172) or DT(eid, 5) or (DT(eid, 80) and JX(eid)) and JLSD(10, 30, eid))) then --太奥40 + 资质/3n
			WAR.ACT = 10
			WAR.ZYHB = 0
			str1 = str1.."・揽雀尾"
			if DT(eid, 5) then
				WAR.TJZX=WAR.TJZX+2
			end
			if wglw1(eid,16) then
				WAR.tmp[3000 + eid] = WAR.tmp[3000 + eid] + 250
			end
		end
		if (TQ==1 and MPPD(eid)==4 and PersonGT(eid,182)) and (JLSD(10,25*WAR.TJAY+math.modf(JY.Person[eid]["资质"]/3),eid)) or
			((DT(eid, 171) or DT(eid, 172) or (DT(eid, 5)) and JLSD(10, 30, eid))) then --太奥40 + 资质/3n
			WAR.KMSHJQ[pid] = WAR.KMSHJQ[pid] or 0 +2
			str1 = str1.."・倒卷肱"
			if wglw1(eid,16) then
				WAR.tmp[3000 + eid] = WAR.tmp[3000 + eid] + 250
			end
		end
		--纯阳功主运特效
		if (TJ == 1 and MPPD(eid)==4 and PersonGT(eid,99)) and (JLSD(10,25*WAR.TJAY+math.modf(JY.Person[eid]["资质"]/3),eid)) or
			((DT(eid, 171) or DT(eid, 172) or DT(eid, 5) or (DT(eid, 80) and JX(eid)) and JLSD(10, 30, eid))) then
			--WAR.CYZY[eid] = (WAR.CYZY[eid] or 0) + math.random(2)--纯阳之意
			local aa = math.modf(JY.Person[eid]["受伤程度"]/2)
			if JY.Person[eid]["受伤程度"] ~= nil and JY.Person[eid]["受伤程度"] > 0 then
				WAR.Person[WAR.CurID]["内伤点数"] = (WAR.Person[WAR.CurID]["内伤点数"] or 0) + AddPersonAttrib(eid,"受伤程度",-aa)
				WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(eid,"生命",aa*2)
				if WAR.LQZ[eid] ~= nil and WAR.LQZ[eid] >= 100 then
					WAR.FXDS[eid] = 0
					WAR.CHZ[eid] = 0
				end	
				str1 = str1.."・定阳针"
			end	
		end
		if (TQ==1 and MPPD(eid)==4 and PersonGT(eid,99)) and (JLSD(10,25*WAR.TJAY+math.modf(JY.Person[eid]["资质"]/3),eid)) or
			((DT(eid, 171) or DT(eid, 172) or (DT(eid, 5)) and JLSD(10, 30, eid))) then --太奥40 + 资质/3n
			local nohot = (WAR.HOT[eid] or 0)
			if WAR.HOT[pid] == nil then
				WAR.HDGX[pid] = 1
				WAR.HOTXS[pid] = 1
				WAR.HOT[pid] = math.modf(2*nohot)
			else
				WAR.HOTXS[pid] = 1
				WAR.HOT[pid] = (WAR.HOT[pid] or 0) + math.modf(2*nohot)
			end	
			WAR.HOT[eid] = nil
			str1 = str1.."・昊阳体"
		end
		if DT(eid, 80) and JX(eid) then
			WAR.NSTJ = WAR.NSTJ+2
			str ="太极奥义・火手无情"
			WAR.Person[WAR.CurID]["内伤点数"] = (WAR.Person[WAR.CurID]["内伤点数"] or 0) + AddPersonAttrib(pid, "受伤程度", math.random(10,30))
		end
		if WAR.Person[emenyid][CC.TXWZ1] ~= nil and WAR.Person[emenyid][CC.TXWZ1] ~= " " then
			WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .."+".. str..str1
		else
			WAR.Person[emenyid][CC.TXWZ1] = str..str1
		end
		if DT(eid, 80) and JX(eid)  then
			WAR.Person[emenyid][CC.TXDH] = 116
		else
			WAR.Person[emenyid][CC.TXDH] = 21
		end
		if DT(eid, 5) and zhangsanfeng == 1 then
			WAR.TJZX = WAR.TJZX + 1 --沼跃鱼：太极之形计算
		end
	end
    WAR.TJAY = 0
	
    if BJY(eid) and juexing() > 2 then
        if WAR.Person[WAR.CurID]["我方"]~=WAR.Person[emenyid]["我方"] then
		    if math.random(1000) + JY.Person[eid]["防御力"] > 200 then
			    if ang < 0 then
				    ang = 0
			    end
			    for j=0,WAR.PersonNum-1 do
				    if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"]~=WAR.Person[emenyid]["我方"] then
					    local x0 = WAR.Person[WAR.CurID]["坐标X"];
					    local y0 = WAR.Person[WAR.CurID]["坐标Y"];
					    local dx = WAR.Person[j]["坐标X"] - x0
					    local dy = WAR.Person[j]["坐标Y"] - y0
					    local rx = CC.XScale * (dx - dy) + CC.ScreenW / 2
					    local ry = CC.YScale * (dx + dy) + CC.ScreenH / 2
					    local w,h=CC.Fontsmall,CC.Fontsmall+5;
					    local len=string.len("雪涌自化转乾坤")/2
					    local fx=rx-len*w/2
					    local fy=ry-h*1
					    DrawString(fx,fy,"雪涌自化转乾坤",C_GOLD,CC.Fontsmall)
					    ShowScreen()
					    if ang ~= 0 then
						    WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - math.floor(ang/5)
					    end
				    end
			    end
			    local x0 = WAR.Person[WAR.CurID]["坐标X"];
			    local y0 = WAR.Person[WAR.CurID]["坐标Y"];
			    local dx = WAR.Person[emenyid]["坐标X"] - x0
			    local dy = WAR.Person[emenyid]["坐标Y"] - y0
			    local rx = CC.XScale * (dx - dy) + CC.ScreenW / 2
			    local ry = CC.YScale * (dx + dy) + CC.ScreenH / 2
			    local w,h=CC.Fontsmall,CC.Fontsmall+5;
			    local len=string.len("虚怀若谷无崖岸")/2 + string.len(ang)
			    local fx=rx-len*w/2
			    local fy=ry-h*2
			    DrawString(fx,fy,"虚怀若谷无崖岸"..ang,C_RED,CC.Fontsmall)
			    ShowScreen()
			    lib.Delay(1000)
			    Cls()
		    end
	    end
	    if WAR.tmp[7500+WAR.CurID] == 1 and WAR.Person[WAR.CurID]["Time"]>=1000  then
		    WAR.Person[WAR.CurID]["Time"] = WAR.Person[WAR.CurID]["Time"] - 500
	    end	
    end	

    if ((DT(eid, 5) or DT(eid, 9) or DT(eid, 666)) or wglw1(eid,46)) and JLSD(10, 60, eid) then
        if WAR.Person[WAR.CurID]["我方"]~=WAR.Person[emenyid]["我方"] then
		    if math.random(1000) + JY.Person[eid]["防御力"] > 200 and ang > 0 then
			    if ang < 0 then
				    ang = 0
			    end
				local aa = 0
				if MPPD(eid) == 4 and wglw1(eid,46) and wglw(eid,182) and WAR.WJ[eid] ~= nil and math.random(10) > 3 then
					aa = aa + math.random(50,150)
					WAR.WJ[eid] = math.modf(WAR.WJ[eid]*0.5)
				end	
			    for j=0,WAR.PersonNum-1 do
				    if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"]~=WAR.Person[emenyid]["我方"] then
					    local x0 = WAR.Person[WAR.CurID]["坐标X"];
					    local y0 = WAR.Person[WAR.CurID]["坐标Y"];
					    local dx = WAR.Person[j]["坐标X"] - x0
					    local dy = WAR.Person[j]["坐标Y"] - y0
					    local rx = CC.XScale * (dx - dy) + CC.ScreenW / 2
					    local ry = CC.YScale * (dx + dy) + CC.ScreenH / 2
					    local w,h=CC.Fontsmall,CC.Fontsmall+5;
					    local len=string.len("太极剑法・以慢打快")/2
					    local fx=rx-len*w/2
					    local fy=ry-h*1
					    DrawString(fx,fy,"太极剑法・以慢打快",C_GOLD,CC.Fontsmall)
					    ShowScreen()
					    if ang ~= 0 then 
							WAR.Person[j]["TimeAdd"] = WAR.Person[j]["TimeAdd"] - math.floor((ang)/5) - aa
					    end
				    end
			    end
			    local x0 = WAR.Person[WAR.CurID]["坐标X"];
			    local y0 = WAR.Person[WAR.CurID]["坐标Y"];
			    local dx = WAR.Person[emenyid]["坐标X"] - x0
			    local dy = WAR.Person[emenyid]["坐标Y"] - y0
			    local rx = CC.XScale * (dx - dy) + CC.ScreenW / 2
			    local ry = CC.YScale * (dx + dy) + CC.ScreenH / 2
			    local w,h=CC.Fontsmall,CC.Fontsmall+5;
			    local len=string.len("太极剑法・后发先至")/2 + string.len(ang)
			    --local fx=rx-len*w/2
			    --local fy=ry-h*2
			    DrawString(rx,ry,"太极剑法・后发先至",C_RED,CC.Fontsmall)
			    ShowScreen()
			    lib.Delay(1000)
			    Cls()
		    end
	    end
	    if WAR.tmp[7500+WAR.CurID] == 1 and WAR.Person[WAR.CurID]["Time"]>=1000  then
		    WAR.Person[WAR.CurID]["Time"] = WAR.Person[WAR.CurID]["Time"] - 500
	    end	
    end	

    if NF(pid) and yongdao(wugong) and JLSD(10, 40, pid) then
		WAR.Person[emenyid][CC.TXWZ2] = "冰封三尺"
	    if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emenyid]["我方"] then
	        if math.random(10)<5 then
	           WAR.BZ[eid]=WAR.BZ[eid] or 0 +1
	        end 
        end
	end

    if BJY(pid) and yongquan(wugong) and JY.Person[0]["拳掌功夫"] > 250 and JLSD(10,40,pid) then 
		if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emenyid]["我方"] then
	        if math.random(10)<5 then
	           WAR.BZ[eid]=WAR.BZ[eid] or 0 +1
	        end 
        end
		WAR.Person[emenyid][CC.TXWZ2] = "排云掌・殃云天降"
	end	

    if ((DT(pid, 5) or DT(pid, 9) or DT(pid, 666)) or wglw1(pid, 46)) and JLSD(10, 40, pid) then
		WAR.Person[emenyid][CC.TXWZ1] = "意在剑先・连绵不绝"
	    WAR.Person[emenyid][CC.TXDH] = 44
	    if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emenyid]["我方"] then
	        if math.random(10)<5 then
	            WAR.BZ[eid]=WAR.BZ[eid] or 0 +1
	        end
	        WAR.GUDUVICTIE[eid]=WAR.GUDUVICTIE[eid] or 0 +1
	        local aa=math.modf(JY.Person[eid]["内力"] / 10) 
	        WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -aa);
        end
	end 

    if wugong == 26 and (DT(pid,55) or DT(pid,617)) and JLSD(10,45,pid) then --郭靖降龙
		WAR.BZ[eid] = 1
	end 	

    if hurt < 0 then hurt = 0 end
	
	hurt = math.floor(hurt)

    --蚊须针
	if wugong == 166 and (DT(pid,13) or wglw1(pid,166)) and JLSD(10,60,pid) then
	    if WAR.MENG[eid] == nil then
		   WAR.MENG[eid] = 35
	    end
		WAR.Person[WAR.CurID][CC.TXWZ1] = "蚊须针・心痒难搔"
	end	

    if wugong == 16 and (DT(pid, 5) or wglw1(pid, 16)) and JLSD(10, 60, pid) then
	    if WAR.MENG[eid] == nil then
		   WAR.MENG[eid] = 50
	    end
		if WAR.LQZ[eid] ~= nil then
			if WAR.LQZ[eid] < 40 then
				WAR.LQZ[eid] = 0
			elseif WAR.LQZ[eid] < 100 then
				WAR.LQZ[eid] = WAR.LQZ[eid] - 20
			end
		end
		WAR.Person[WAR.CurID][CC.TXWZ1] = "太极拳・以柔克刚"
        WAR.Person[WAR.CurID][CC.TXDH] = 85
    end

    if wugong == 16 and (DT(pid, 5) or wglw1(pid, 16)) and JLSD(10, 50, pid) then
		WAR.CYSH[eid] = 50
		if (JY.Person[emenyid]["受伤程度"] ~= nil and JY.Person[emenyid]["受伤程度"] < 50) or JY.Person[emenyid]["受伤程度"] == nil then
			WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid,"受伤程度",50)
		else
			JY.Person[emenyid]["受伤程度"] = 100
			WAR.Person[emenyid]["内伤点数"] = 100
		end
		WAR.Person[WAR.CurID][CC.TXWZ1] = "太极拳・以刚克柔"
        WAR.Person[WAR.CurID][CC.TXDH] = 85
	end

    if DT(pid,583) then
		local chihuan = hurt / 60
		if halfch(eid) then
			chihuan =chihuan / 2
		end
			chihuan = math.modf(chihuan)						
		if WAR.CHZ[eid] == nil then
			WAR.CHZ[eid] = chihuan
		else
			WAR.CHZ[eid] = WAR.CHZ[eid] + chihuan
		end
		if 50 < WAR.CHZ[eid] then
			WAR.CHZ[eid] = 50
		end	
			WAR.CHXS[eid] = 1
	end		

    if ((wglw(pid,105) and PersonGT(pid,105)) or (PersonGT(pid,105) and (DT(pid,455)))) and JLSD(20,70,pid) or (DT(pid,617) and JLSD(10,60,pid)) then  --葵花领悟后几率迟缓
        local chihuan = hurt / 60
		if halfch(eid) then
			chihuan =chihuan / 2
		end
			chihuan = math.modf(chihuan)						
		if WAR.CHZ[eid] == nil then
			WAR.CHZ[eid] = chihuan
		else
			WAR.CHZ[eid] = WAR.CHZ[eid] + chihuan
		end
		if 50 < WAR.CHZ[eid] then
			WAR.CHZ[eid] = 50
		end	
			WAR.CHXS[eid] = 1
    end
	
    if WAR.XLGJ == 2 or WAR.XLGJ == 4 or WAR.XLGJ == 5 then	--降龙柔劲必迟缓
		local chihuan = hurt / 60
		if halfch(eid) then
			chihuan =chihuan / 2
		end
			chihuan = math.modf(chihuan)						
		if WAR.CHZ[eid] == nil then
			WAR.CHZ[eid] = chihuan
		else
			WAR.CHZ[eid] = WAR.CHZ[eid] + chihuan
		end
		if 50 < WAR.CHZ[eid] then
			WAR.CHZ[eid] = 50
		end	
			WAR.CHXS[eid] = 1
	end	
	
    if wugong == 11 and (DT(pid,599) or wglw1(pid,11)) then	--摧坚神爪必迟缓
		local chihuan = hurt / 60
		if halfch(eid) then
			chihuan =chihuan / 2
		end
			chihuan = math.modf(chihuan)						
		if WAR.CHZ[eid] == nil then
			WAR.CHZ[eid] = chihuan
		else
			WAR.CHZ[eid] = WAR.CHZ[eid] + chihuan
		end
		if 50 < WAR.CHZ[eid] then
			WAR.CHZ[eid] = 50
		end	
			WAR.CHXS[eid] = 1
    end
	
    if BJY(pid) and yongquan(wugong) and JLSD(10,40,pid) then
		local chihuan = hurt / 60
		if halfch(eid) then
			chihuan =chihuan / 2
		end
			chihuan = math.modf(chihuan)						
		if WAR.CHZ[eid] == nil then
			WAR.CHZ[eid] = chihuan
		else
			WAR.CHZ[eid] = WAR.CHZ[eid] + chihuan
		end
		if 50 < WAR.CHZ[eid] then
			WAR.CHZ[eid] = 50
		end	
			WAR.CHXS[eid] = 1
	end 	
	
   if MPPD(pid) == 18 and WAR.KTFT == 3 and JY.Person[pid]["暗器技巧"] >= 300 and yongan(wugong) and PersonGT(pid,189) then --崆峒暗系高级弟子
		local chihuan = hurt / 60
			if halfch(eid) then
				chihuan =chihuan / 2
			end
				chihuan = math.modf(chihuan)						
			if WAR.CHZ[eid] == nil then
				WAR.CHZ[eid] = chihuan
			else
				WAR.CHZ[eid] = WAR.CHZ[eid] + chihuan
			end
			if 50 < WAR.CHZ[eid] then
				WAR.CHZ[eid] = 50
			end	
		WAR.CHXS[eid] = 1
		if JLSD(10,45,pid) then
			WAR.YJQS[eid] = 30
			WAR.Person[emenyid][CC.TXWZ2] = "一劲七伤"
		end
	end 	
	
    if WAR.FXHJ3 == 1 then
		local a = 0
		for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
                local tmppid = WAR.Person[j]["人物编号"]
		        WAR.CHXS[tmppid] = 1
		        WAR.CHZ[tmppid] = limitX((WAR.CHZ[tmppid] or 0) + a, 0, 100)
            end
        end
	end		
	
	if ((wglw(pid,105) and PersonGT(pid, 105)) or (PersonGT(pid, 105) and (DT(pid, 455)))) or DT(pid,617) then  --葵花领悟后必破防
        dng = 0
    end

    if wglw(pid,188) or (DT(pid,48) and PersonGT(pid,188)) then --神足经
		dng = 0
    end 

    if hasTF(pid, 154) then --侵略如火
		dng = 0
	end 	

    if JY.Person[pid]["武器"] == 36 then --玄铁剑
		dng = 0 
	end 	

    if JY.Person[pid]["武器"] == 303 and JLSD(10,40,pid) then  --紫薇软剑
		dng = 0
	end 	

    if DT(pid, 592) or wglw1(pid, 45) then --领悟重剑破防 	
	   dng = 0
	end	

    if DT(pid, 615) or wglw1(pid,86) then --伏魔杖法领悟破防
		dng = 0
	end

    if wugong == 11 and (DT(pid,599) or wglw1(pid,11)) then --摧坚神爪破防
		dng = 0
	end	

    if wugong == 175 or wglw(pid,175) then --霹雳火雷破防
		dng = 0
	end	

    if wugong == 148 and (DT(pid, 55) or wglw1(pid,148)) then --白羽箭法破防
		dng = 0
	end 	

    if WAR.HYZF > 0 then --幻阴指破防
		dng = 0
	end 	

    if wugong == 23 and ((DT(pid, 8) or DT(pid, 167) or DT(pid, 168)) or wglw1(pid,23) or DT(pid, 603)) then --领悟七伤拳破防
		dng = 0
	end 	

    --刀系大招 直接破防
    if WAR.ASKD == 1 then
        dng = 0
    end
  
    if WAR.DUOMINGJIAN == 14 then
        dng = 0
    end
  
    if WAR.CJSZ == 1 then
        dng = 0
    end
  
    if WAR.CYYJ == 1 then
        dng = 0
    end
  
    if WAR.JSTG2 == 1 then
        dng = math.modf(dng/4)
    end
  
    if WAR.ASKD1 == 1 then
        dng = 0
    end
  
    if WAR.LYBF == 3 then
        dng = 0
    end	
  
    if WAR.XSJS == 1 then
		dng = 0
	end 	

   --沼跃鱼：战意组件 直接破防
    if WAR.ZCDZ ==1 and hasDZ(pid,3) then
        dng = 0
    end 
  
    --沼跃鱼：胡斐战意技 直接破防
    if WAR.HDYD >0 then
        dng = 0
    end
  
    if WAR.XTDJ >0 then
        dng = 0
    end
  
    if WAR.LSQL == 1 then 
        dng = 0
    end
	
    --沼跃鱼：李逍遥剑神破防
    if WAR.LXYYJ==4 then
        dng = 0
    end
  
    --降龙领悟破防
    if WAR.XLGJ > 0 then
	    dng = 0
    end	 

    --六脉领悟破防
    if WAR.LMJQ > 0 then
	    dng = 0
    end 

    if MPPD(pid) == 11 and wugong == 131 and WAR.SJL == 3 then --豸苗：森九岚破防
        dng = 0
    end
  
    if WAR.NS[pid] ~= nil then 
        dng = 1----日月神教
    end
  
    if DT(pid,617) then
		dng = 1
	end 	

    if WAR.WXQQ[pid] == 1 then 
        dng = 1
    end
	
    if XYL(pid) and (WAR.XYLCZ == 3 or WAR.XYLCZ1 == 2) then --豸苗：谢云流万剑直接破防
        dng = 0
    end
	
    if wugong == 42 and ((DT(pid, 601) or DT(pid, 59)) or wglw1(pid,42)) then  --玉女剑法破防
		dng = 0
	end 		
	
    --豸苗：太玄经
    if (PersonKF(pid, 102) or  (T5BCF(pid) and juexing()>0)) and (WAR.TXTX == 2 or WAR.TXTX == 6) then 
        dng = 0
    end	
  
    if DT(pid, 114) and WAR.HQWX == 1 then --豸苗：扫地僧附加伤害 --17-2-9
	    dng = 0
    end
	
    if T7DFWM(pid) and WAR.DZXY == 1 and yongdao(wugong) and juexing()>1 then --沼跃鱼：东方未明刀系反击特效
	    dng=0
	end  
  
    if T5BCF(pid) and WAR.BCFZL == 1 then --破煞破防
	    dng = 0
    end
  
    if NF(pid) and juexing() > 2 then --聂风必破防
	    dng = 0
	end

    if BJY(pid) and juexing() > 1 then --步惊云必破防
	    dng = 0
	end

    if DT(pid, 600) then
	    dng = 0
    end

    if WAR.SHITOUJY==3 then --王小石天地逆转・乾坤震爆直接破防
	    dng = 0
    end
  
    if WAR.DJSX==1 then --田归农刀剑十杀
	    dng = 0
    end
  
    if WAR.ZJWF == 1 then--举重若轻
	    dng = 0
    end
 
    if WAR.DGJY1 == 1 then --独孤剑意
		dng = 0
	end		
	
	if WAR.TSYXL == 3 then
		dng = 0
	end	
	
    if WAR.MMBT == 1 then --莫名悲痛
		dng = 0
	end		
	
	if wglw2(pid,194) and WAR.AYMZ == 1 then
		dng = 0
	end	
	
	if (wglw1(pid,40) or (DT(pid,91)and JX(pid)) or DT(pid,54) or DT(pid,630)) and WAR.JSJZ3 == 1 then
		dng = 0
		WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid,"受伤程度",15)
	end
	
	if wugong == 140 and (wglw1(pid,140) or DT(pid,558)) and WAR.YHZJ[eid]~=nil and WAR.YHZJ[eid]>0 then
		dng = dng /100
		if WAR.LQZ[pid] == 100 then
		dng = 0
		end
	end	
	
	if WAR.HSYFD == 1 then
		dng = 0
	end
	
    if T13TQS(pid) and WAR.TQS3 == 3 then --沼跃鱼：滕青山啸天苍狼特效
	    dng=0
	    local n = 1000 + JY.Person[pid]["内力"] - JY.Person[eid]["内力"];
  	    if n < 0 then
  		    n = 0;
  	    end
	    ang=ang+n
  	    WAR.CHXS[eid] = 1
		WAR.CHZ[eid] = WAR.CHZ[eid] or 0 + limitX(math.modf(ang/100),0,100);
    end  
  
    if wssz(pid) and WAR.TQS3 == 3 then --沼跃鱼：滕青山啸天苍狼特效
	    dng=0
	    local n = 1000 + JY.Person[pid]["内力"] - JY.Person[eid]["内力"];
  	    if n < 0 then
  		    n = 0;
  	    end
	    ang=ang+n
  	    WAR.CHZ[eid] = WAR.CHZ[eid] or 0 + limitX(math.modf(ang/100),0,100);
    end 
  
    if T9ZY(pid) and WAR.ZYQT==2 then --沼跃鱼：赵云枪出如龙
	    dng=0
	    local n = JY.Person[pid]["内力"] - JY.Person[eid]["内力"];
  	    if n < 0 then
  		    n = 0;
  	    end
	    n=n+sixi(pid,4)*10
	    ang=ang+n
	    WAR.CHXS[eid]=1
  	    WAR.CHZ[eid] = WAR.CHZ[eid] or 0 + limitX(math.modf(ang/100),0,100);
	end

    local ttt, sss = pofang(pid)
    if dng > 0 and ttt then
	    dng = 0
	    if WAR.Person[WAR.CurID][CC.TXWZ1] == nil then
		    WAR.Person[WAR.CurID][CC.TXWZ1] = sss
	    else
		    WAR.Person[WAR.CurID][CC.TXWZ1] = WAR.Person[WAR.CurID][CC.TXWZ1].."+"..sss
	    end
    end
  
    --蓝烟清：狮吼功，直接破防杀集气，并对敌人造成迟缓
     --[[ if wugong == 92 then
  	dng = 0;
  	local n = 1000 + JY.Person[pid]["内力"] - JY.Person[eid]["内力"];
  	ang = n;
  	if ang < 0 then
  		ang = 0;
  	end
  	
  	WAR.CHZ[eid] = 10 + math.modf(ang/100);
    end]]
  
    local lixiaoyao = 0
	--李逍遥真元护体
    if T8LXY(eid) and DWPD() then
	    local panding = 0
	    if WAR.LQZ[pid] ~= nil and WAR.LQZ[pid] >= 100 then
		    panding = 1
	    end
  	if JLSD(10, 10 + math.modf(15 + (5 * wgnumber(0, 5))), eid) or panding == 1 then --15%，每多一个内功+5%
	    if hurt ~= 0 then
			if WAR.Person[emenyid][CC.TXWZ2] == nil then
				WAR.Person[emenyid][CC.TXWZ2] = "真元护体"
			else
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+真元护体"
			end
			WAR.Person[emenyid][CC.TXDH] = 78
		end
		lixiaoyao = 1
	elseif ZYBF(eid) then--沼跃鱼：李逍遥元灵归心术
	    WAR.L_HQNZL[eid]=10
			if WAR.Person[emenyid][CC.TXWZ2] == nil then
				WAR.Person[emenyid][CC.TXWZ2] = "元灵归心术"
			else
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+元灵归心术"
			end
			WAR.Person[emenyid][CC.TXDH] = 78
	        else
	    end
    end 

    --1-10-寒冰真气
    if wglw(eid,124) or (PersonKF(eid,124) and DT(eid,22)) then 
	    if WAR.Person[emenyid][CC.TXWZ3] == nil then
	        WAR.Person[emenyid][CC.TXWZ3] = "寒气侵体"
	    else
	        WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."+寒气侵体"
		end
		WAR.ICE[pid] = (WAR.ICE[pid] or 0) + 20
		if WAR.ICE[pid] > 100 then WAR.ICE[pid] = 100 end
		WAR.ICEXS[pid] = 1
    end
	
    if wugong == 176 and ((DT(pid, 117) or wglw1(pid,176)) and JLSD(10, 40, pid)) or (DT(pid,618) and JLSD(10, 40, pid)) and (PersonKF(eid,8) or wglw1(eid,8)) == false then
        if WAR.Person[emenyid][CC.TXWZ2] == nil then
	        WAR.Person[emenyid][CC.TXWZ2] = "生死符・寒气入体"
	    else
	        WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+生死符・寒气入体"
	    end
		    WAR.ICE[pid] = (WAR.ICE[pid] or 0) + 20
	    if WAR.ICE[pid] > 50 then WAR.ICE[pid] = 50 end
		    WAR.ICEXS[pid] = 1
    end		
	
    if (wglw(pid,181) or DT(pid, 600)) and (PersonGT(pid, 181) and yongquan(wugong) and JLSD(10, 60, pid)) then 	
        if WAR.Person[emenyid][CC.TXWZ2] == nil then
	        WAR.Person[emenyid][CC.TXWZ2] = "山海拳经・龙麟破日"
	    else
	        WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+山海拳经・龙麟破日"
	    end
		    WAR.HOT[eid] = (WAR.HOT[eid] or 0) + 20
	    if WAR.HOT[eid] > 100 then WAR.HOT[eid] = 100 end
		    WAR.HOTXS[eid] = 1
    end			
	
    if BJY(pid) and yongquan(wugong) and JLSD(10,60,pid) and JY.Person[0]["拳掌功夫"] > 250 and juexing () > 2 then 	
        if WAR.Person[emenyid][CC.TXWZ2] == nil then
	        WAR.Person[emenyid][CC.TXWZ2] = "山海拳经・龙麟破日"
	    else
	        WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+山海拳经・龙麟破日"
	    end
		    WAR.HOT[eid] = (WAR.HOT[eid] or 0) + 20
	    if WAR.HOT[eid] > 100 then WAR.HOT[eid] = 100 end
		    WAR.HOTXS[eid] = 1
    end		
	
	if (wglw(pid,181) or DT(pid, 600)) and (PersonGT(pid, 181) and yongjian(wugong) and JLSD(10, 60, pid)) then 	
        if WAR.Person[emenyid][CC.TXWZ2] == nil then
	        WAR.Person[emenyid][CC.TXWZ2] = "天命剑道・剑河雪涌"
	    else
	        WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+天命剑道・剑河雪涌"
	    end
		    WAR.ICE[eid] = (WAR.ICE[eid] or 0) + 20
	    if WAR.ICE[eid] > 100 then WAR.ICE[eid] = 100 end
		    WAR.ICEXS[eid] = 1
    end		
	
    if (wglw(pid,181) or DT(pid, 600)) and (PersonGT(pid, 181) and yongdao(wugong) and JLSD(10, 60, pid)) then 
	    local ad = math.random(3,5)
	    local ab = ad * 10
        for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
                if JY.Person[WAR.Person[j]["人物编号"]]["内力"] > 100 * ad then
                    JY.Person[WAR.Person[j]["人物编号"]]["内力"] = JY.Person[WAR.Person[j]["人物编号"]]["内力"] - 100 * ad
                    WAR.Person[j]["内力点数"] = (WAR.Person[j]["内力点数"] or 0) - 100 * ad;
                else
          	        WAR.Person[j]["内力点数"] = (WAR.Person[j]["内力点数"] or 0) - JY.Person[WAR.Person[j]["人物编号"]]["内力"];
          	        JY.Person[WAR.Person[j]["人物编号"]]["内力"] = 0
          	        JY.Person[WAR.Person[j]["人物编号"]]["生命"] = JY.Person[WAR.Person[j]["人物编号"]]["生命"] - 100 * ad
          	        WAR.Person[j]["生命点数"] = (WAR.Person[j]["生命点数"] or 0) - 100 * ad;
                end
            end
        end
        if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
	        WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+无二刀法・云断青天"
	    else
	        WAR.Person[emenyid][CC.TXWZ2] = "无二刀法・云断青天"
        end
	end
	
	if (wglw(pid,181) or DT(pid, 600)) and (PersonGT(pid, 181) and yongte(wugong) and JLSD(10, 60, pid)) then
    	for j = 0, WAR.PersonNum - 1 do
			local tmppid = WAR.Person[j]["人物编号"]
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"]
			   and tmppid ~= eid then
			   local fhurt = hurt
			   JY.Person[tmppid]["生命"] = JY.Person[tmppid]["生命"] - fhurt	
			   WAR.Person[j]["生命点数"] = (WAR.Person[j]["生命点数"] or 0) - fhurt;
			   SetWarMap(WAR.Person[j]["坐标X"], WAR.Person[j]["坐标Y"], 4, 2);
			end
		end	
	    if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
		   WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+虎啸棍集・群虎下岗"
	    else
		   WAR.Person[emenyid][CC.TXWZ2] = "虎啸棍集・群虎下岗"
	    end 
	end
	
	if (wglw(pid,181) or DT(pid, 600)) and (PersonGT(pid, 181) and yongan(wugong) and JLSD(10, 60, pid)) then
        WAR.GTSHAQI = WAR.GTSHAQI + 1000
		WAR.GTPID2 = pid 	
		if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+圆融金指・一念圆融"
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = "圆融金指・一念圆融"
	    end
	end		
	
	if WAR.SQHY == 1 then
		WAR.HOT[eid] = (WAR.HOT[eid] or 0) + 20
	    if WAR.HOT[eid] > 100 then WAR.HOT[eid] = 100 end
		    WAR.HOTXS[eid] = 1
		WAR.ICE[eid] = (WAR.ICE[eid] or 0) + 20
	    if WAR.ICE[eid] > 100 then WAR.ICE[eid] = 100 end
		    WAR.ICEXS[eid] = 1			
        for j = 0, WAR.PersonNum - 1 do
			local tmppid = WAR.Person[j]["人物编号"]
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"]
			   and tmppid ~= eid then
			   local fhurt = hurt
			   --JY.Person[tmppid]["生命"] = JY.Person[tmppid]["生命"] - fhurt	
			   WAR.Person[j]["生命点数"] = (WAR.Person[j]["生命点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"],"生命",-fhurt);
			   SetWarMap(WAR.Person[j]["坐标X"], WAR.Person[j]["坐标Y"], 4, 2);
			end
		end
		WAR.GTSHAQI = WAR.GTSHAQI + 1000
		WAR.GTPID2 = pid 	
	end 	
 

    --破防后内伤计算
    --龙象般若功加力30%内伤 取消了
    if (dng == 0) and hurt > 0 and 
	WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emenyid]["我方"] and (T8LXY(eid) == false or lixiaoyao == 0) then 	
	local n = 0;		--内伤点数值
    if inteam(eid) then		--队友内伤计算
		n = myrnd((hurt) / 10);
   	else
   		--计算敌方内伤
	  	 n = myrnd((hurt) / 16);
  	end
  	
	if DT(pid, 80) then --张召重攻击，内伤加倍
	    local m = math.modf(JY.Person[pid]["御剑能力"]/100)
		n=n + m
		n = n * 2
	end
	
	if PersonGT(pid, 6) then --碧海加内伤
		n = n * 1.6
	elseif PersonKF(pid, 6) then
		n = n * 1.3
	end
	
	if DT(pid, 24) then
		n = n + 10
	end
	
	if wugong==22 then
		local m = math.modf(JY.Person[pid]["拳掌功夫"]/100)
		n=n + m
		n = n * 2
	end
	
	if halfns(eid) then
		n = math.modf(n * 0.5)
	end
	
  	--先天功内伤减25-50%
  	if PersonGT(eid, 100) then
		n = math.modf(n * 0.5);
	elseif PersonKF(eid, 100) then
  		n = math.modf(n * 0.75);
  	end
  	
    --少林九阳功	
	if PersonKF(eid, 187) then
		n = math.modf(n * 0.75);
	elseif PersonGT(eid, 187) then
  		n = math.modf(n * 0.5);
  	end
	
	--乾坤内伤-30%
  	if PersonGT(eid, 97) then
		n = math.modf(n * 0.7);
	elseif PersonKF(eid, 97) then
		n = math.modf(n * 0.9);
  	end		
	
	if eid == 0 and putong() == 3 then --刀系每练1刀内伤-3%
		n = math.modf(n * (1 - (0.03 * wgnumber(0, 3))))
	end

    if (MPPD(eid) == 17 and MPDJ(eid) >= 3) or (GX(eid) and JX(eid)) then --峨眉减内伤
		AddPersonAttrib(eid, "受伤程度", n)
	end	

	if JY.Person[eid]["防具"]==59 then --乌蚕衣-内伤5
		n = n - 5
		if n < 0 then n = 0 end
	end		
	
	if wglw(eid,151) or (DT(eid,615) and PersonKF(eid,151)) then --豸苗：金刚不坏奥义免内伤
		n = 0
	end	
	
    if wglw(eid,184) and PersonGT(eid,184) or DT(eid,665) then --瑜伽密乘免内伤
		n = 0
	end		
	
	if getHZ(eid, 20) or hasTF(eid, 118) then --止水印
		n = 0
	end

	if hasTF(eid, 121) and n ~= 0 then
		if JY.Person[pid]["内力"] < JY.Person[eid]["内力"] then
			AddPersonAttrib(pid, "受伤程度", n)
			n = 0		
		end
	end
	
	if hasTF(pid, 126) and n > 0 then
		AddPersonAttrib(pid, "受伤程度", -math.modf(n * 0.5))
	end
		
	n = math.modf(n)
	
  	--太玄神功，把受到的内伤一半转为回复内伤
    -- if PersonGTHT(eid, 102, WAR.L_SGHT) then 
    --	WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) - math.modf(n/2);
  	--	AddPersonAttrib(eid, "受伤程度", -math.modf(n/2));
     -- else
    	WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "受伤程度", n);
    --  end
    end

    if (DT(eid,9) or wglw(eid,106)) and PersonGT(eid,106) and JLSD(10,40,eid) then
	    local str = "・氤氲紫气"
		local a = math.modf(hurt * 9);
		local b = math.modf(hurt * 9);
		if JY.Person[eid]["受伤程度"] ~= nil and JY.Person[eid]["受伤程度"] > 0 then
			a = a + math.modf(JY.Person[eid]["受伤程度"]*math.random(2,4))
		end	
		dng = 1;
		WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", a);
		WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", a);
		WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) +AddPersonAttrib(eid, "受伤程度", -b);
		WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) +AddPersonAttrib(eid, "中毒程度", -b);
		if ang >= 9 * 500 then
		    ang = ang - 9 * 500;
		else
		    ang = 0
		end
		if WAR.Person[emenyid][CC.TXWZ2] ~= nil then
    	    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "真气护体"..str
        else
    	    WAR.Person[emenyid][CC.TXWZ2] = "真气护体"..str
        end
	end

	--九阳内力底线实装
	if (DT(eid,9) or wglw(eid,106)) and PersonGT(eid,106) then
		local jynl = math.modf((JY.Person[eid]["内力最大值"] or 0)*0.3)
		if JY.Person[eid]["内力"] < jynl then
			JY.Person[eid]["内力"] = jynl
			if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
				WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "九阳圆满・生生不息"
			else
				WAR.Person[emenyid][CC.TXWZ3] = "九阳圆满・生生不息"
			end
		end	
	end	
			

    if ((MPPD(eid) == 17 and MPDJ(eid) >= 2) and JLSD(10,40,eid) and PersonGT(eid,153) and PersonKF(eid,186)) 
		or ((GX(eid) and JX(eid)) and JLSD(10,60,eid)) then  --峨眉派掌门限定 
		local str = "・转危为安"
		local a = math.modf(hurt * MPDJ(eid));
		local b = math.modf(hurt * MPDJ(eid)/20);
		dng = 1;
		WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + a;
		WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + a;
		AddPersonAttrib(eid, "生命", a);
		AddPersonAttrib(eid, "内力", a);
		AddPersonAttrib(eid, "受伤程度", -b);
		AddPersonAttrib(eid, "中毒程度", -b);
		if ang >= MPDJ(eid) * 500 then
			ang = ang - MPDJ(eid) * 500;
		else
			ang = 0
		end
		if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "峨眉九阳功"..str
		else
			WAR.Person[emenyid][CC.TXWZ3] = "峨眉九阳功"..str
		end
	end

    --峨眉九阳
    if wglw(eid,186) and PersonGT(eid,186) and JLSD(10,40,eid) then
        WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", 200);
		WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", 400);
		WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "受伤程度", -10);
		WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", -10);
        if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "转危为安"
		else
			WAR.Person[emenyid][CC.TXWZ3] = "转危为安"
		end
	end 	

	if DT(eid, 114) then
		dng = 1
		ang = 0
	end
  
  	if DT(eid, 64) and JX(eid) then
	    if WAR.ZBT1>0 then
	        dng = 0
		    ang = ang + 500 * WAR.ZBT1
		    WAR.ZBT1 = 0
	    end
	end
  
    if MPPD(eid) == 6 and MZ(eid)==3 and MPDJ(eid)>1 then--沼跃鱼：大力龙象主运效果
        local str=""
		if JLSD(20,45,eid) and PersonGTHT(eid, 103, WAR.NGHT) then
		    local tmp=math.modf(hurt*MPDJ(eid));
		    local tmp1=math.modf(hurt*MPDJ(eid)/20);
		    dng=1;
		    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", tmp);
		    WAR.Person[WAR.CurID]["内伤点数"] = (WAR.Person[WAR.CurID]["内伤点数"] or 0) + AddPersonAttrib(pid, "受伤程度", tmp1);
			WAR.L_HQNZL[eid]=50+tmp1
		    str="・绝对霸体"
		else
		    if ang>= MPDJ(eid)*300 then
		        ang=ang-MPDJ(eid)*300;
		    else
		        ang=0
		    end
		end
		if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
    	    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "密宗龙象・苦修瑜伽"..str
        else
    	    WAR.Person[emenyid][CC.TXWZ3] = "密宗龙象・苦修瑜伽"..str
        end
		    WAR.Person[emenyid][CC.TXDH] = 115	
	end
	
	
    if (PersonGT(eid, 121) and MPPD(eid)==3) or DT(eid,601) then ----沼跃鱼：玉女清心诀
        local SN=0
	    if WAR.LQZ[eid]~=nil and WAR.LQZ[eid]>=0 and not (wglw(eid,121) or DT(eid,59) or DT(eid,601)) then
	        SN=WAR.LQZ[eid]*5
	    else
	        SN=250
	    end
	    local str=".一笑倾人城"
	    if (JLSD(20,45,eid) and PersonGTHT(eid, 121, WAR.NGHT))  and not (wglw(eid,121) or DT(eid,59) or DT(eid,601) )then
		    local tmp1=math.modf(hurt*MPDJ(eid)/100);
		    local tmp2=0 
		    if WAR.LQZ[pid] ~= nil and WAR.LQZ[pid]> 0 then 
		        tmp2 = WAR.LQZ[pid]
		    end	
		       WAR.Person[WAR.CurID]["内伤点数"] = (WAR.Person[WAR.CurID]["内伤点数"] or 0) + AddPersonAttrib(pid, "受伤程度", tmp2);
		       dng=1;
		       WAR.Person[emenyid]["体力点数"] = (WAR.Person[emenyid]["体力点数"] or 0) + AddPersonAttrib(eid, "体力", tmp1);
		    if WAR.LQZ[pid] ~= nil and WAR.LQZ[pid] > 0 then 
                if WAR.LQZ[pid]>=50 then
	                WAR.LQZ[pid]=0
	            else
	                WAR.LQZ[pid]=math.modf(WAR.LQZ[pid]/2)
	            end
		    end
		    str=".再笑倾人国"
		    elseif (wglw(eid,121) or DT(eid,59) or DT(eid,601)) and (PersonGTHT(eid, 121, WAR.NGHT) or DT(eid,601)) then
		        local tmp1=math.modf(hurt*MPDJ(eid)/100);
		        local tmp2=0 
		        if WAR.LQZ[pid] ~= nil and WAR.LQZ[pid]> 0 then 
		            tmp2 = WAR.LQZ[pid]
		        end	
		        WAR.Person[WAR.CurID]["内伤点数"] = (WAR.Person[WAR.CurID]["内伤点数"] or 0) + AddPersonAttrib(pid, "受伤程度", tmp2);
		        dng=1;
		        WAR.Person[emenyid]["体力点数"] = (WAR.Person[emenyid]["体力点数"] or 0) + AddPersonAttrib(eid, "体力", tmp1);
		        WAR.MENG[pid]= (WAR.MENG[pid] or 0) + tmp2
		        str=".烽火戏诸侯"
		        else

		        end
		        if hurt>= SN then
		            hurt=math.modf(hurt*0.65);
		        else
		            hurt=math.modf(hurt*0.8)
		       end
	           WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", SN);
	            if WAR.Person[emenyid][CC.TXWZ2] == nil then
		            WAR.Person[emenyid][CC.TXWZ2] = "玉女清心诀"..str
	            else
		            WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. "玉女清心诀"..str
	            end	
	            WAR.Person[emenyid][CC.TXDH] = 131
    end
  
	--功体追杀集气或武器追杀集气 
    --破防杀集气计算
    if (dng == 0 or WAR.GTSHAQI > 0)and hurt > 0 and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emenyid]["我方"] then
        local killsq = 0
        if JY.Thing[202][WZ7] == 1 then				--1难度
		    killsq = 9
        elseif JY.Thing[202][WZ7] == 2 then		--2难度
            killsq = 8
    else				--3难度
		    killsq = 7
    end
    
    local killjq = 0
    if inteam(eid) then  
    	killjq = math.modf(ang / killsq)
    else
    	killjq = math.modf(ang / 8)
    end
	
    --天赋功体加杀气
    if JY.Person[pid]["声望"] ~= 0 then
		local v = JY.Person[pid]["声望"]
		if PersonTFGT(pid, v) then 
		    if inteam(pid) then
		        killjq = math.modf(killjq * 1.2)
			else
			    killjq = math.modf(killjq * 1.4)
			end	 
		end
	end
		
    --受伤害额外杀集气
    local spdhurt = 0
    if inteam(eid) then
        spdhurt = math.modf(hurt * 0.5)
	end
	
    if not inteam(pid) then
	local a = JY.Thing[202][WZ7]
        spdhurt = spdhurt + math.modf(hurt * 0.05*a)
	end
	
	if PersonKF(pid, 103) then	--龙象普通伤害追杀集气
		spdhurt = spdhurt + math.modf(hurt * 0.5)
	end		
	
    if WAR.JWDF == 3 then
		spdhurt = spdhurt + math.modf(hurt * 6)	
	end 	
	
	if PersonKF(pid,191) then -- 追命无影追加杀气
		if WAR.LXZT[eid] == nil or WAR.LXZT[eid] <= 0 then
			spdhurt = spdhurt + 1
		elseif 	WAR.LXZT[eid] ~= nil or WAR.LXZT[eid] >= 0 then
			if WAR.LXZT[eid] <= 50 then
				spdhurt = spdhurt * 2
			else 
				spdhurt = spdhurt * 3
			end
		end
	end	
	
	if PersonKF(eid,193) and MPPD(eid) == 10 then
		spdhurt = spdhurt/3
	end	
	
    if MPPD(pid) == 18 and WAR.KTFT == 2 and JY.Person[pid]["特殊兵器"] >= 400 and yongte(wugong) and JLSD(10,45,pid) and PersonGTJL(pid,189,WAR.NGJL) then --崆峒特系堂主		
		local a = JY.Person[pid]["特殊兵器"] + 100
		spdhurt = spdhurt + math.modf(hurt * a)	
		WAR.Person[WAR.CurID][CC.TXWZ2] = "崆峒奇兵・七星游龙"
	end	
	
	if PersonKF(eid, 101) then --如果学了八荒六不受伤害杀集气
		spdhurt = 0
	end
	
    if BJY(eid) and juexing() > 2 then
		spdhurt = 0
	end	
	
    killjq = killjq + spdhurt
	
	if WAR.GTSHAQI > 0 then
		if dng == 0 then
			killjq = killjq + WAR.GTSHAQI
		else 
			killjq = WAR.GTSHAQI
		end
	end	  
	
    if hurt >= math.modf(JY.Person[eid]["生命最大值"]*0.4) and (wglw(eid,151) or (DT(eid,615) and PersonKF(eid,151))) then
        killjq = math.modf(killjq * 0.6)
    end
		
	if PersonKF(eid, 151) then --金刚不坏体杀集气-15%
		if PersonGT(eid, 151) then
			killjq = math.modf(killjq * 0.7)  
		else  
			killjq = math.modf(killjq * 0.85)  
		end
	end
	if wglw(eid,184) and PersonGT(eid,184) or DT(eid,665) then --瑜伽密乘减杀气
		killjq = math.modf(killjq * 0.5)  
	end 	
	--豸苗：太玄经
	if PersonGT(eid, 102) and WAR.TXPF == 1 then
	    killjq = math.modf(killjq * 0.5)
        WAR.Person[emenyid][CC.TXDH] = 75
	end 
	
	if PersonGT(pid, 150) then --金关玉锁诀杀集气+15%-30%
		killjq = math.modf(killjq * 1.3)
	elseif PersonKF(pid, 150) then
		killjq = math.modf(killjq * 1.15)
	end
	
	if hasTF(pid, 35) then
		killjq = math.modf(killjq * 1.5)
	end

	if eid == 0 and putong() == 1 then --拳系主角每1拳被杀集气少5%
		killjq = math.modf(killjq * (1 - (0.05 * wgnumber(0, 1))))
	end
	
	if T5BCF(pid) and WAR.BCFZL == 1 then --破煞杀气*2
		killjq = math.modf(killjq * 2)
	end
    --豸苗：太玄经
    if (PersonKF(pid, 102) or  (T5BCF(pid) and juexing()>0)) and (WAR.TXTX == 2 or WAR.TXTX == 6) then
	    killjq = killjq + 300
	end	
	if pid == 0 and putong() == 4 then --特系每练1特杀气+5%
		killjq = math.modf(killjq * (1 + (0.05 * wgnumber(0, 4))))
	end
	
	if DT(pid, 18) then
		killjq = math.modf(killjq * 1.5)
	end	
	
	if WAR.XMSSZ > 0 then
	   killjq = killjq + 490
	end
	
	if WAR.CYANGZ > 0 then
	   killjq = killjq + 400
	end
	if WAR.CYINZ > 0 then
	   killjq = killjq + 400
	end
    if WAR.ARJX > 0 then
	   killjq = killjq + 500
	end	
	
    if wugong == 45 and (DT(pid, 592) or wglw1(pid,45)) then	
		killjq = killjq + 600
	end	
	
    if wugong == 66 and ((DT(pid, 103) or DT(pid, 595)) or wglw1(pid,66)) then	
		killjq = killjq + 500
	end		
	
	--龙木岛主 
	if eid == 39 or eid == 40 then 
	    for j = 0 ,WAR.PersonNum-1 do 
	        if WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] and WAR.Person[j]["死亡"] == false and (WAR.Person[j]["人物编号"] == 39 or WAR.Person[j]["人物编号"] == 40) and eid ~= j then 
		        WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd + killjq
		    end   
	    end 
    end	
	
	if hasTF(eid, 114) then
		if WAR.Person[emenyid][CC.TXWZ2] == nil then
			WAR.Person[emenyid][CC.TXWZ2] = "立心天地"
		else
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+立心天地"
		end	
		WAR.Person[emenyid][CC.TXDH] = 39
	end
	
    if (wglw(eid,183) or (DT(eid,615) and PersonGT(eid,183))) and JLSD(10,60,eid) then
		if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "元气氤氲"
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+元气氤氲"
	    end
            killjq = 0
    end  		
	
    if DT(eid,662) and JLSD(10,60,eid) then
		if WAR.Person[emenyid][CC.TXWZ3] == nil then
		    WAR.Person[emenyid][CC.TXWZ3] = "风后八阵"
	    else
		    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."+风后八阵"
	    end
            killjq = 0
    end  		
	
    if T2SQ(eid) and JLSD(10,60,eid) and juexing() > 0 then	
		if WAR.Person[emenyid][CC.TXWZ3] == nil then
		    WAR.Person[emenyid][CC.TXWZ3] = "风后八阵"
	    else
		    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."+风后八阵"
	    end
            killjq = 0
    end  		
	 
	if DT(eid, 112) then --萧远山怒气爆发免杀气
		if WAR.LQZ[eid] ~= nil and WAR.LQZ[eid] >= 100 then
			killjq = 0
		end
	end
		
	if MPPD(eid) == 8 and wglw(eid,104) then --萧远山怒气爆发免杀气
		killjq = 0
	end	
	
	if DT(eid , 25) then --蓝凤凰免杀气
		local jilv = math.modf(JY.Person[eid]["受伤程度"] / 2)
		if JLSD(10, 20 + jilv, eid) then
			if WAR.Person[emenyid][CC.TXWZ2] == nil then
				WAR.Person[emenyid][CC.TXWZ2] = "凤凰于飞 其羽"
			else
				WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+凤凰于飞 其羽"
			end
			WAR.Person[emenyid][CC.TXDH] = 111	
			killjq = 0
		end
	end

	if DT(eid, 638) then
		if WAR.ACT > 1 then
			killjq = 0
		end
	end
		
	if WAR.SH[eid] ~= nil or WAR.ZBX[eid] ~= nil or WAR.YJZD[eid] ~= nil or WAR.SH1[eid] ~= nil then --锁喉/醉八仙/以静制动状态不被杀气--17-2-18
		killjq = 0
	end
  
	if eid == 0 and putong() == 8 and JY.Person[eid]["中毒程度"] > 0 and WAR.YTML == 0 then
		killjq = math.modf(killjq * (1 - (JY.Person[eid]["中毒程度"] / 100)))
		JY.Person[eid]["中毒程度"] = math.modf(JY.Person[eid]["中毒程度"] * (math.random(4, 8) * 0.1))
	end	
	
	if PersonGT(eid, 97) and (WAR.Person[emenyid].Time <= -300) and killjq > 0 and 
		JY.Person[eid]["内力"] >= killjq then --乾坤主功体时集气-300以下免疫杀气
		JY.Person[eid]["内力"] = math.modf(JY.Person[eid]["内力"] - killjq)
		killjq = 0
	elseif PersonGT(eid, 97) and (WAR.Person[emenyid].Time - killjq) <= -300 and 
		JY.Person[eid]["内力"] >= killjq then
		local tmpkill = killjq - (300 + WAR.Person[emenyid].Time)
		killjq = math.modf(300 + WAR.Person[emenyid].Time)
		JY.Person[eid]["内力"] = math.modf(JY.Person[eid]["内力"] - tmpkill)			
	end    	

 	if MPPD(eid) == 4 and MPDJ(eid) >= 2 then --武当无极
		if WAR.WJ[eid] == nil then
			WAR.WJ[eid] = killjq
		else
			if killjq >= WAR.WJ[eid] then
				if wglw(eid,182) and (wglw1(eid,16) or wglw1(eid,46)) then
					WAR.WJ[eid] = (WAR.WJ[eid] or 0) + killjq
				else
					WAR.WJ[eid] = killjq
				end	
			end	
		end
	end
	
    --天赋功体减杀气
    if JY.Person[eid]["声望"] ~= 0 then
		local v = JY.Person[eid]["声望"]
		if PersonTFGT(eid, v) then 
		    if inteam(eid) then
		        killjq = math.modf(killjq * 0.85)
			else
			    killjq = math.modf(killjq * 0.7)
			end	 
		end
	end
		
	if (wglw(eid,95) or ((DT(eid, 60) or DT(eid, 620)) and PersonKF(eid,95))) and JLSD(10,60,eid) then --蛤蟆九天17-2-23
		if WAR.HMJT[eid] == nil or WAR.HMJT[eid] == 0 then
			WAR.HMJT[eid] = killjq*2 + 200;
		else
			WAR.HMJT[eid] = WAR.HMJT[eid] + killjq*2 + 200;
		end
		if  WAR.HMJT[eid] > 5000 then 
		    WAR.HMJT[eid] = 5000 
		end	
		if WAR.Person[emenyid][CC.TXWZ1] == nil then
			WAR.Person[emenyid][CC.TXWZ1] = "气吞山河・吞"
		else
			WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1].."+气吞山河・吞"
		end
		killjq = 0
	end
	
	if ((wglw(pid,150) and PersonGT(pid,150)) or (DT(pid, 619) and PersonKF(pid,150))) and JLSD(10,60,pid) then --金关领悟 杀意波动
        killjq =math.modf(killjq*2)
		local aa=killjq
		JY.Person[eid]["内力"] = math.modf(JY.Person[eid]["内力"] - killjq)
		if (WAR.Person[emenyid].Time - killjq) <= -300 then
		    WAR.SZWH[eid]=WAR.SZWH[eid] or 0 + 10
		    if WAR.SZWH[eid]>50 then
		        WAR.SZWH[eid]=50
		    end
		end
		if WAR.Person[emenyid][CC.TXWZ1] == nil then
			WAR.Person[emenyid][CC.TXWZ1] = "杀意波动・凝气破脉"
		else
			WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1].."+杀意波动・凝气破脉"
		end
	end
	
    if wglw(eid,182) or (DT(eid,5) and PersonGT(eid,182)) then
		if WAR.TJSG[eid] == nil or WAR.TJSG[eid] == 0 then
			WAR.TJSG[eid] = killjq * 2 + 200;
		else
			WAR.TJSG[eid] = WAR.TJSG[eid] + killjq * 2 + 200;
		end
		if  WAR.TJSG[eid] > 5000 then 
		    WAR.TJSG[eid] = 5000 
		end	
		if WAR.Person[emenyid][CC.TXWZ1] == nil then
			WAR.Person[emenyid][CC.TXWZ1] = "太极・后发制人"
		else
			WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1].."+太极・后发制人"
		end
		killjq = 0
	end	
	
	if (wglw(eid,99) or ((DT(eid,5) or DT(eid,666)) and PersonKF(eid,99))) and WAR.LSQL1 == 1 then
	    local sqzy = {}
		local sqzy1 = 0
	    for j = 0,WAR.PersonNum-1 do 
		    if WAR.Person[j]["我方"] ~= WAR.Person[emenyid]["我方"] and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
		        sqzy1 = sqzy1 + 1
		        sqzy[sqzy1] = j
		    end
		end
		local n = sqzy[math.random(sqzy1)]
		WAR.Person[n].TimeAdd = WAR.Person[n].TimeAdd - math.modf(killjq * 1.5)
		killjq = 0
	end
	
	if WAR.ZJWF == 1 then 
	   killjq = killjq + 150
	end
	if WAR.SHITOUNG == 4 and T4WXS(eid) then
	    WAR.GTSHAQI=0
		killjq = killjq + math.random(200, 250)
		killjq = -killjq
		WAR.SHITOUNG = 0	
	elseif MPPD(eid) == 11 then --豸苗：谢云流杀气变集气
	    local dj = MPDJ(eid)
		local aa = 0 
		if WAR.JQ[eid] ~= nil and WAR.JQ[eid] > 0 then 
		aa = WAR.JQ[eid]*3+3
		end
		if dj > 4 then 
		   dj = 4 
		end   
	    if JLSD(0, dj * 10+aa, pid) or (XYL(eid) and JLSD(0,40,eid)) or jtyl(eid) then--谢无悠
		killjq = -killjq
		if WAR.Person[emenyid][CC.TXWZ2] == nil then
			WAR.Person[emenyid][CC.TXWZ2] = "逆流"
		else
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+逆流"
		end
		if jtyl(eid) then 
		WAR.Person[emenyid][CC.TXDH] = 158
		else
        WAR.Person[emenyid][CC.TXDH] = 75	
        end		
		else
		killjq = killjq/2
		end
	elseif eid == 0 and putong() == 8 and WAR.YTML == 1 then
		killjq = -killjq
		JY.Person[eid]["中毒程度"] = math.modf(JY.Person[eid]["中毒程度"] * (math.random(2, 7) * 0.1))	
	elseif PersonKF(eid, 602) and WAR.tmp[9500 + eid] ~= nil and WAR.tmp[9500 + eid]==1 then
	    if jtyl(pid) then 
		killjq = math.modf(killjq * 1.5)
		else
		killjq = math.modf(killjq * 0.5)
		killjq = -killjq
		end
	elseif NF(eid) and juexing() > 2 then --聂风3觉杀气变集气
	    	killjq = (-1) * math.modf(killjq * 5)
			
    elseif BJY(eid) then --步惊云杀气变集气
	    	killjq = (-1) * math.modf(killjq * 2.5)		
			
    elseif wglw(eid,106) or (DT(eid,9) and PersonKF(eid,106)) then --九阳领悟杀气变集气
	    	killjq = (-1) * math.modf(killjq * 1)
		
	--飞影彩蛋：真龙心法杀气变两倍集气
	elseif PersonKF(eid, 91) and inteam(eid) and JY.ZLXF == 1 then 
		killjq = (-1) * math.modf(killjq * 2)
   
    --安七
	elseif DT(eid, 456) then 
		killjq = (-1) * math.modf(killjq * 2)

    --段思平
	elseif DT(eid, 602)  then 
		killjq = (-1) * math.modf(killjq * 3)
		
	--木灵子
	elseif DT(eid, 603)  then 
		killjq = (-1) * math.modf(killjq * 2)	

    elseif DT(eid, 592) or wglw1(eid, 47) then	
        killjq = (-1) * math.modf(killjq * 2.5)	
	elseif wglw(eid,189) and WAR.YSZL[eid] ~= nil and WAR.YSZL[eid] > 0 then --阴圣再临
		killjq = (-1) * math.modf(killjq * 2)		
	elseif WAR.TQS2==5 and eid==0 and T13TQS(0) then --沼跃鱼：滕青山朱雀斗气 杀气变集气
		killjq = killjq + math.random(20, 30)*WAR.SWFY
		killjq = -killjq
	    WAR.TQS2=0
	elseif WAR.TQS2==5 and wssz(eid) then --沼跃鱼：滕青山朱雀斗气 杀气变集气
		killjq = killjq + math.random(20, 30)*WAR.SWFY1
		killjq = -killjq
	    WAR.TQS2=0
	elseif PersonKF(eid,117) then 
	    local jl = 40
		if MPPD(eid) == 18 and MPDJ(eid) >= 3 then
			jl = jl +20
			if jl > 100 then jl = 100 end
		end	
		if JLSD(10,jl,eid) then
			if wglw2(eid,117) or DT(eid,617) then
				killjq = -(killjq*2)
				if WAR.Person[emenyid][CC.TXWZ2] == nil then
					WAR.Person[emenyid][CC.TXWZ2] = "真・神行百变"
				else
					WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+".."真・神行百变"
				end
			else
				killjq = -killjq
				if WAR.Person[emenyid][CC.TXWZ2] == nil then
					WAR.Person[emenyid][CC.TXWZ2] = "神行百变"
				else
					WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+".."神行百变"
				end
			end	
		end	
    end
    if MPPD(pid) == 9 and WAR.TMMS[pid] == 1 and WAR.ACT == 1 and (DT(pid, 93) or yongan(wugong)) then --唐门模式
	    killjq = killjq + 200
	end
	if jtyl(pid) then 
	    if killjq < 0 then 
	        killjq = - killjq 
		elseif killjq > 0 then 
	        killjq = math.modf(killjq * 1.5)
	    end 
    end		
	if DT(pid, 57) or wglw1(pid, 18) then
		killjq = killjq + 100
	end 
	--暗影迷踪领悟	
	if wglw2(eid,194) and PersonKF(eid,194) and WAR.HIDE[eid] ~= nil then
		local aa = JY.Person[eid]["实战"]
		killjq = killjq - aa
	end	
	if wglw2(pid,198) and PersonKF(pid,198) then
		if WAR.JZFLW1[pid] == nil then
			WAR.JZFLW1[pid] = killjq
		else
			WAR.JZFLW1[pid] = (WAR.JZFLW1[pid] or 0) + killjq
		end
	end	
	--[[if nokillspeed(eid) then 
		killjq = 0
	end]]
	if wglw(eid,151) and MPPD(eid)==5 and hurt<math.modf(JY.Person[eid]["生命最大值"]*0.4) then 
		killjq = -250
		local aa=math.modf(JY.Person[eid]["生命最大值"]*0.1)
		AddPersonAttrib(eid,"生命",aa)
	end
	if nokillspeed(eid) then
		local aa = 80
		if DT(eid,114) then aa = aa + 10 end
		if killjq < 0 then
			WAR.Person[emenyid].TimeAdd = WAR.Person[emenyid].TimeAdd - killjq
		else
			if JLSD(0,aa,eid) then
				WAR.Person[emenyid].TimeAdd = WAR.Person[emenyid].TimeAdd - 0
			else
				WAR.Person[emenyid].TimeAdd = WAR.Person[emenyid].TimeAdd - (math.modf(killjq*0.8))
			end	
		end
	else
		WAR.Person[emenyid].TimeAdd = WAR.Person[emenyid].TimeAdd - killjq
	end	
	WAR.Person[emenyid].TimeAdd = limitX(WAR.Person[emenyid].TimeAdd, -999, 999)
	
	if DT(eid, 585) then WAR.Person[emenyid].TimeAdd = 999 end --武骧金星：神秘小二被攻击后立即行动
	if DT(eid, 600) then WAR.Person[emenyid].TimeAdd = 700 end 
	if DT(eid, 602) then WAR.Person[emenyid].TimeAdd = 300 end 
    if DT(eid, 592) or wglw1(eid, 47) then WAR.Person[emenyid].TimeAdd = 700 end
	if BJY(eid) and juexing() > 2 then WAR.Person[emenyid].TimeAdd = 300 end 	

    --太极神功
    if (wglw(eid, 182) or (DT(eid, 5) and PersonGT(eid, 182))) and WAR.LQZ[eid] >= 100 then	
		WAR.Person[emenyid].TimeAdd = 1000
	end			
		
	if WAR.HYYQ[eid] == 1 and PersonKF(eid,117) then WAR.Person[emenyid].TimeAdd = WAR.Person[emenyid].TimeAdd + 100 end 
	
	--金关领悟		
	if ((wglw(eid,150) and PersonGT(eid,150)) or (DT(eid,619) and JX(eid) and PersonKF(eid,150))) and JLSD(10,45,eid) then
        local aa=math.modf(JY.Person[eid]["内力"]*0.45)	
	    WAR.Person[emenyid].TimeAdd = WAR.Person[emenyid].TimeAdd+aa 
	    WAR.Person[emenyid].TimeAdd = limitX(WAR.Person[emenyid].TimeAdd, -999, 999)
		if WAR.Person[emenyid][CC.TXWZ2] == nil then
			WAR.Person[emenyid][CC.TXWZ2] = "杀意波动.气脉回旋"
		else
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+杀意波动.气脉回旋"
		end
		WAR.Person[emenyid][CC.TXDH] = 115	
	end 
	
	if DT(eid, 633) and WAR.LSH2 == 0 and 
		(WAR.Person[emenyid].Time + WAR.Person[emenyid].TimeAdd < -200) and
		200 < JY.Person[eid]["生命"] then
		if WAR.Person[emenyid][CC.TXWZ2] == nil then
			WAR.Person[emenyid][CC.TXWZ2] = "淡菊傲霜"
		else
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+淡菊傲霜"
		end
		WAR.Person[emenyid][CC.TXDH] = 115				
		WAR.LSH2 = 1
	end		
  end

    if (DT(eid, 5) or DT(eid, 9) or DT(eid, 666)) or wglw1(eid,46) then
	    WAR.Person[emenyid].TimeAdd = 150 
	    WAR.Person[emenyid][CC.TXWZ1] = "神在剑先・连绵不绝"
	    WAR.Person[emenyid][CC.TXDH] = 21
    end	

    if WAR.KHZJ[eid] then
		WAR.Person[emenyid].TimeAdd = 150 
	end  	

    if wglw(eid,592) or DT(eid,592) then
	    WAR.Person[emenyid].TimeAdd = 350 
	    WAR.Person[emenyid][CC.TXWZ1] = "独孤剑意・有进无退"
        WAR.DGJY1 = 1
    end	

    if BJY(eid) and juexing() > 2 then
		WAR.Person[emenyid].TimeAdd = 200 
	    WAR.Person[emenyid][CC.TXWZ1] = "怒涛拍岸"
	    WAR.Person[emenyid][CC.TXDH] = 21
	end	

    WAR.tmp[9500 + eid] = nil --重置神行百变
  
    --豸苗：谢云流逆返--一刀流切返1-25-
	if XYL(eid) and JLSD(0,40,eid) and juexing() > 0 then
	    WAR.Person[emenyid][CC.TXWZ1] = "秘剑・封步剑"
	    WAR.Person[emenyid][CC.TXDH] = 75
		WAR.ACT = 10
		WAR.ZYHB = 0
		WAR.JQNF[pid] = 1
		if WAR.QF[eid] == nil then 
		    WAR.QF[eid] = 1
		else 
		    WAR.QF[eid] = WAR.QF[eid]+1
		end
	end
    if jtyl(eid) and JLSD(0,30,eid) then 
	    WAR.JTWW = 1 
		WAR.ACT = 10
		WAR.ZYHB = 0
		if WAR.QF[eid] == nil then 
		    WAR.QF[eid] = 1
		else 
		    WAR.QF[eid] = WAR.QF[eid]+1
		end
	       WAR.Person[emenyid][CC.TXWZ1] = "九天一流・万物两断"
	       WAR.Person[emenyid][CC.TXDH] = 158
	end
	--一刀流切返1-25-
	if MPPD(eid) == 11 then 
	local dj = MPDJ(eid)
		local aa = 0 
		if WAR.JQ[eid] ~= nil and WAR.JQ[eid] > 0 then 
		    aa = WAR.JQ[eid]*3+3
		end
	    if dj > 4 then 
	        dj = 4
	   end	  
	    if JLSD(0,dj*10+aa,eid) or WAR.PD[eid] ~= nil then  
		    WAR.ACT = 10
		    WAR.ZYHB = 0
		    if WAR.QF[eid] == nil then 
		        WAR.QF[eid] = 1
		    else 
		        WAR.QF[eid] = WAR.QF[eid]+1
		    end
	        WAR.Person[emenyid][CC.TXDH] = 75	  
	        if XYL(eid) then 	  
	            WAR.JQNF[pid] = 1
	            WAR.Person[emenyid][CC.TXWZ1] = "秘剑・封步剑"
	        elseif jtyl(eid) then 
	            WAR.JTWW = 1
	            WAR.Person[emenyid][CC.TXWZ1] = "九天一流・万物两断"
	            WAR.Person[emenyid][CC.TXDH] = 158
	        else
	            WAR.Person[emenyid][CC.TXWZ1] = "秘剑・切返"
	        end
	    end
	end
	
	--豸苗：欧阳锋蛇毒
	--[[if (DT(eid, 60) or DT(eid, 620)) and DWPD() and JLSD(0,30,eid) and WAR.OYFSD[pid] == nil then
	    WAR.Person[emenyid][CC.TXWZ3] = "灵蛇杖毒"
	    WAR.Person[emenyid][CC.TXDH] = 112
	    WAR.OYFSD[pid] = 100
	end]]	

	--豸苗：谢烟客控鹤功
	if DT(eid, 164) and DWPD() and JLSD(0,30,eid) then
	    WAR.Person[emenyid][CC.TXWZ3] = "控鹤功・隔空控鹤"
	    WAR.Person[emenyid][CC.TXDH] = 75
	    WAR.KHG[pid] = 20
	end		
	
    --小龙女死掉，杨过吼
    if DT(eid, 59) and JY.Person[eid]["生命"] <= 0 then
       WAR.XK = 1
       WAR.XK2 = WAR.Person[emenyid]["我方"]
    end
  
    if wglw(eid,95) or ((DT(eid,60) or DT(eid,620)) and PersonKF(eid,95)) then --蛤蟆九天17-2-23
        local a = math.random(3)
        local str = ""
		for j = 0, WAR.PersonNum-1 do 
			local df = WAR.Person[j]["人物编号"] 
			local offset1 = math.abs(WAR.Person[emenyid]["坐标X"] - WAR.Person[j]["坐标X"]) 
            local offset2 = math.abs(WAR.Person[emenyid]["坐标Y"] - WAR.Person[j]["坐标Y"])
			--local offset=offset1+offset2		
			if WAR.Person[j]["我方"] ~= WAR.Person[emenyid]["我方"] and WAR.Person[j]["死亡"] == false and offset1 <= 8 and offset2 <= 8 then
			   if a == 1 then 
               WAR.Person[j]["中毒点数"] = (WAR.Person[j]["中毒点数"] or 0) + AddPersonAttrib(df, "中毒程度", 50)
			   str = "毒蟾・毒"
			   elseif a == 2 then 
			   WAR.HOTXS[df] = 1
			   WAR.HOT[df] = (WAR.HOT[df] or 0) + 30  
			   str = "火蟾・火"
			   elseif a == 3 then
			   WAR.ICEXS[df] = 1
			   WAR.ICE[df] = (WAR.ICE[df] or 0) + 30	
			   str = "冰蟾・冰"
			   end
			end
        end
		if WAR.Person[emenyid][CC.TXWZ2] == nil and str ~= "" then
			WAR.Person[emenyid][CC.TXWZ2] = str
		elseif WAR.Person[emenyid][CC.TXWZ2] ~= nil and str ~= "" then
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2].."+"..str
		end
    end
  
    if MPPD(pid) == 11 and WAR.LHWH == 1 then --17-3-1
    --local a = math.random(3)
		for j = 0, WAR.PersonNum-1 do 
			local df = WAR.Person[j]["人物编号"] 
			local offset1 = math.abs(WAR.Person[emenyid]["坐标X"] - WAR.Person[j]["坐标X"]) 
            local offset2 = math.abs(WAR.Person[emenyid]["坐标Y"] - WAR.Person[j]["坐标Y"])
			--local offset=offset1+offset2		
			if WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] and WAR.Person[j]["死亡"] == false and offset1 <= 8 and offset2 <= 8 and WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
			   if eid ~= df then
               WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(df, "生命", -math.modf(hurt/5))
			   end
			  -- str = "毒蟾・毒"
			end
        end
    end
  
  --欧阳锋  攻击中毒+30
    if DT(pid, 60) or DT(pid, 620) and DWPD() then
        WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", 30)
    end

    --武骧金星：白驼山弟子攻击中毒+10
    if MPPD(pid) == 8 and DWPD() then
		local aa = math.random(3)
        WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", (10*aa))
	    if PersonGTJL(pid, 95, WAR.NGJL) or (PersonGT(pid,95) and (DT(pid,60) or DT(pid,61) or DT(pid,620))) then
	        local NS=math.modf(JY.Person[eid]["中毒程度"]*MPDJ(pid)*0.5)
		    local XK=NS*5
		    local NK=XK*5
		    WAR.Person[WAR.CurID]["真伤点数"]=WAR.Person[WAR.CurID]["真伤点数"] or 0 +AddPersonAttrib(pid, "生命", XK);
		    WAR.Person[WAR.CurID]["内力点数"]=WAR.Person[WAR.CurID]["内力点数"] or 0 +AddPersonAttrib(pid, "内力", NK);
	        WAR.Person[emenyid][CC.TXWZ1] = "蟾毒秘要・引毒自疗"
	        WAR.Person[emenyid][CC.TXDH] = 112
	    end
    end
  
    if DT(pid,2) and JX(pid) and DWPD() then
	    local aa=math.modf(JY.Person[pid]["用毒能力"]/100)
		local NS=math.modf(JY.Person[eid]["中毒程度"]*0.5*aa)
		local XK=NS*5
		local NK=XK*5
		WAR.Person[WAR.CurID]["真伤点数"]=WAR.Person[WAR.CurID]["真伤点数"] or 0 +AddPersonAttrib(pid, "生命", XK);
		WAR.Person[WAR.CurID]["内力点数"]=WAR.Person[WAR.CurID]["内力点数"] or 0 +AddPersonAttrib(pid, "内力", NK);
	    WAR.Person[emenyid][CC.TXWZ1] = "七星毒王・神木纳毒"
	    WAR.Person[emenyid][CC.TXDH] = 112
    end
  
    --何红药攻击上毒
    if DT(pid, 176) and DWPD() then
	    if JY.Person[pid]["受伤程度"] > 0 then
		    WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + 
			AddPersonAttrib(eid, "中毒程度", JY.Person[pid]["受伤程度"])
	    end
    end	
 
    if DWPD() then
 	    for i = 1, #CC.ZGT12 do --主功体上毒
 		    if (CC.ZGT12[i][1] == wugong or (T12YMZ(pid) and wugong == 112)) and (PersonGT(pid, CC.ZGT12[i][2]) or ((PersonGT(pid,9999) and (JY.Thing[224]["加攻击力"]) == CC.ZGT12[i][2] or JY.Thing[224]["加防御力"]) == CC.ZGT12[i][2])) then
 			    WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + 
 			    AddPersonAttrib(eid, "中毒程度", CC.ZGT12[i][3])
 			    break
 		    end
 	    end	 
    end
    if DWPD() then
 	    for i = 1, #CC.ZGT12 do --1-26-
 		    if (CC.ZGT12[i][1] ==  WAR.HLTX or CC.ZGT12[i][2] ==  WAR.HLTX) and (wglw(pid,102) or (DT(pid,38) and PersonKF(pid,102))) then
 			    WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + 
 			    AddPersonAttrib(eid, "中毒程度", CC.ZGT12[i][3])
 			    break
 		    end
 	    end	 
    end
    if DWPD() then
 	    for i = 1, #CC.ZGT12 do --豸苗：折梅手
	        for l = 1,10 do
	            local jl = 15 + math.modf(JY.Person[pid]["实战"] / 20)+ math.modf(JY.Person[pid]["武学常识"] / 10)
	            if wugong == 14 and (JLSD(0,5+jl,pid) or (MPPD(pid)==7 and JLSD(0,15,pid))) and JY.Person[pid]["内力"] >= 7000 then
	                if JY.Person[pid]["武功" .. l] == CC.ZGT12[i][1] then
 			            WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + 
 			            AddPersonAttrib(eid, "中毒程度", CC.ZGT12[i][3])
			            WAR.ZMS = 1
 			            break
			        end
			    end
 		    end
 	    end	 
    end
  
    if DT(pid, 631) and DWPD() then --殷离上毒
	--local aa, bb = JY.Person[578]["拳掌功夫"]--JX(pid)
	local aa = JY.Person[578]["拳掌功夫"]--JX(pid)
	if aa > 100 then 
	    aa = 100 
	end   
	--if aa then
		WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + 
		AddPersonAttrib(eid, "中毒程度", aa)
	--end
    end	 
 
    if DT(pid, 4) and DWPD() then --阎基上毒
	    --local aa, bb = JY.Person[578]["拳掌功夫"]--JX(pid)
	    local aa = math.modf(JY.Person[pid]["耍刀技巧"]/5)--JX(pid)
	    if aa > 100 then 
	        aa = 100 
	    end   
	--if aa then
		WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + 
		AddPersonAttrib(eid, "中毒程度", aa)
	--end
    end	
 
    if getHZ(pid, 34) and DWPD() then
        WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", 25)
    end
 
    if DWPD() then
	    WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", spoison(pid))
    end
  
    --偷东西
    if WAR.TD == -2 then
        local i = nil
        i = math.random(4)
        if 0 < JY.Person[eid]["携带物品数量" .. i] and -1 < JY.Person[eid]["携带物品" .. i] and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emenyid]["我方"] then
            JY.Person[eid]["携带物品数量" .. i] = JY.Person[eid]["携带物品数量" .. i] - 1
            WAR.TD = JY.Person[eid]["携带物品" .. i]
        end
        if JY.Person[eid]["携带物品数量" .. i] < 1 then
            JY.Person[eid]["携带物品" .. i] = -1
        end
    else
        WAR.TD = -1
    end
	--主角偷东西
	--[[
	if ZJ(pid) then
		for i=1,4 do
			if 0 < JY.Person[eid]["携带物品数量" .. i] and -1 < JY.Person[eid]["携带物品" .. i] and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emenyid]["我方"] then
			  instruct_32(JY.Person[eid]["携带物品" .. i],JY.Person[eid]["携带物品数量" .. i])
			  JY.Person[eid]["携带物品数量" .. i] = 0
			  JY.Person[eid]["携带物品" .. i]=-1
			  break
			end
		end
	end]]
    --血刀吸血
    if WAR.XDDF == 1 then 
        local XDXX=0  
        if PersonGT(pid, 94) then
		    XDXX = XDXX + math.modf((hurt) * 0.15)
	    else
		    XDXX = XDXX + math.modf((hurt) * 0.1)
	    end
	    if MPPD(pid)==6 and MPDJ(pid)>1 then
	        local mpdj=3
		    if MZ(pid)==2 then
		        mpdj=mpdj*(1+0.2*MPDJ(pid))
		        if WAR.LXZT[eid]~=nil and WAR.LXZT[eid]>0 then
		            mpdj=mpdj*(2+WAR.LXZT[eid]*0.02)
		        end
		        if JY.Person[pid]["武器"] == 44 and DT(pid, 97)then
		            mpdj=mpdj*(1+1.5)
		        end
		        if WAR.XUEFU[pid]~=nil and WAR.XUEFU[pid]>=0 then
		            mpdj=mpdj*(1+WAR.XUEFU[pid]*0.2)
		       end
		    end
			XDXX = XDXX + math.modf((hurt) * 0.05*mpdj)
		end
		if wglw1(pid,63) then
			local mpdj2=100
			if WAR.LXZT[eid]~=nil and WAR.LXZT[eid]>0 then
			   mpdj2= math.modf(mpdj2*(1+WAR.LXZT[eid]*0.01))
			   WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命",-mpdj2)
			end
			XDXX=XDXX+mpdj2
		end
		if XDXX>=200 and not wglw1(pid,63) then
			XDXX=200
		end
	  	WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", XDXX);
		if wglw1(pid,63) then		
			for j = 0, WAR.PersonNum -1 do
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
					local tid = WAR.Person[j]["人物编号"]
					WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"], "生命",XDXX)
					WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
					--JY.Person[tid]["生命"] = JY.Person[tid]["生命"] + XDXX
			   end
			end	
		end
		WAR.XUEFU[pid]=WAR.XUEFU[pid] or 0 +1
		if 	WAR.XUEFU[pid]>=15 then
		    WAR.XUEFU[pid]=15
		end
		WAR.XDXX = WAR.XDXX + XDXX
    end
  
    if JY.Person[pid]["武器"] == 44 then  --血刀
		WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", math.modf(hurt * 0.3))
  	    WAR.XIXUE = WAR.XIXUE + math.modf(hurt * 0.3)
	end	

    if pid==0 and putong() == 9 then --血手吸血
	    WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", math.modf((hurt) * (0.1+((WAR.LXZT[0] or 0)/150))));    
        WAR.XIXUE = WAR.XIXUE + math.modf((hurt) * (0.1+((WAR.LXZT[0] or 0)/150)))
    end
  
    if DT(pid,83) and (WAR.GUDU==1) then --何铁手吸血
	    WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", math.modf((hurt) * 0.15));    
        WAR.GUDUXIXUE = WAR.GUDUXIXUE + math.modf((hurt) * 0.15)		
    end

    if hasTF(pid, 43) and WAR.VAMPIRE[pid] ~= nil then
  	    WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", math.modf(hurt * 0.1))
  	    WAR.VAMPIRE[pid] = WAR.VAMPIRE[pid] + math.modf(hurt * 0.1)
    end

    if T7DFWM(pid) and WAR.DFWM2 == 3 then --东方未明刀系特技吸血
	    WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", math.modf((hurt) * 0.15));    
        WAR.DFWMXX = WAR.DFWMXX + math.modf((hurt) * 0.15)	  
    end
  
	if (wglw1(pid,67) or (DT(pid, 1) and JX(pid)) or (DT(pid, 621) and JX(pid))) and WAR.VAMPIRE[pid] ~= nil then
		WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", math.modf(hurt * 0.1))
  	    WAR.VAMPIRE[pid] = WAR.VAMPIRE[pid] + math.modf(hurt * 0.1)
	end
    if T13TQS(pid) and WAR.TQS == 4 then --沼跃鱼：滕青山狼吻吸血
	    WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", math.modf((hurt) * 0.03*WAR.SWHH));    
        WAR.TQSLW = WAR.TQSLW +math.modf((hurt) * 0.03*WAR.SWHH)	  
    end
  
    if wssz(pid) and WAR.TQS == 4 then --沼跃鱼：滕青山狼吻吸血
	    WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", math.modf((hurt) * 0.03*WAR.SWHH1));    
        WAR.TQSLW = WAR.TQSLW +math.modf((hurt) * 0.03*WAR.SWHH1)	  
    end
    
    --贝海石 被攻击后生命+100
    if DT(eid , 85) and 0 < JY.Person[eid]["生命"] then
        WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", 100);
    end
	
    --安七
    if DT(eid, 456) and 0 < JY.Person[eid]["生命"] then
        WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", 200);
    end	
	
    --萧雨客被攻击后加生命
    if T3XYK(eid) and 0 < JY.Person[eid]["生命"] then
        WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", 150);
    end

    --水镜四奇被攻击后加生命
    if T2SQ(eid) and 0 < JY.Person[eid]["生命"] then
        WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", 100);
    end   

    --太极神功护体生命加200
	if PersonGTHT(eid,182) and 0 < JY.Person[eid]["生命"] then
		WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", 200);
    end

    --瑜伽密乘护体生命加200
	if PersonGTHT(eid,184) and 0 < JY.Person[eid]["生命"] then
		WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", 200);
    end

    if MPPD(eid) == 16 and 0 < JY.Person[eid]["生命"] then
        local mpdj = MPDJ(eid) * 10+20
        WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", mpdj);
    end
  
    if MPPD(eid) == 18 and MPDJ(eid) >= 5 and 0 < JY.Person[eid]["生命"] and PersonGTHT(eid, 189, WAR.NGHT) then --崆峒拳系堂主
		local mpdj = MPDJ(eid) + JY.Person[pid]["拳掌功夫"]
		WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", mpdj);
    end	

    if DT(eid,599) and 0 < JY.Person[eid]["生命"] then
        local mpdj = 100
        WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", mpdj);
    end
  
    if WAR.BMGX == 1 and WAR.BMGX ~= nil then
	    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", math.modf((hurt) * 2));
	    WAR.BMGX = 0
    end
  
    if getHZ(eid, 10) and 0 < JY.Person[eid]["生命"] then
        WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", 80);
    end
 
    if DT(eid, 117) and 0 < JY.Person[eid]["生命"] then
        WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", 50);
    end
 
    --宫本武藏 被攻击后生命+150
    if DT(eid , 516) and 0 < JY.Person[eid]["生命"] then
       WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", 150);
    end
  
    --霍青桐 杀体力
    if WAR.HQT == 1 and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emenyid]["我方"] then
  	    WAR.Person[emenyid]["体力点数"] = (WAR.Person[emenyid]["体力点数"] or 0) + AddPersonAttrib(eid, "体力", -15);
    end
	
	--沙狱・地火极炼
	if wugong == 78 and wglw1(pid,78) and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emenyid]["我方"] and JLSD(20,75,pid) and JY.Person[eid]["体力"] > 9 then
  	    WAR.Person[emenyid]["体力点数"] = (WAR.Person[emenyid]["体力点数"] or 0) + AddPersonAttrib(eid, "体力", -10);
		if WAR.Person[emenyid][CC.TXWZ2] == nil then
			WAR.Person[emenyid][CC.TXWZ2] = "沙狱・地火极炼"
		else
			WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .."地火极炼"
		end
    end
	
    if WAR.FXHJ1 == 1 and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emenyid]["我方"] then
  	    WAR.Person[emenyid]["体力点数"] = (WAR.Person[emenyid]["体力点数"] or 0) + AddPersonAttrib(eid, "体力", -10);
		WAR.OYFSD[eid] = WAR.OYFSD[eid] or 0 + 20
	end 	

    if WAR.WYLW1 == 3 and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emenyid]["我方"] then
  	    WAR.Person[emenyid]["体力点数"] = (WAR.Person[emenyid]["体力点数"] or 0) + AddPersonAttrib(eid, "体力", -25);
	    WAR.OYFSD[eid]=WAR.OYFSD[eid] or 0 +25
    end
 
    if WAR.WYLW1 == 4 and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emenyid]["我方"] then
  	    WAR.Person[emenyid]["体力点数"] = (WAR.Person[emenyid]["体力点数"] or 0) + AddPersonAttrib(eid, "体力", -25);
	    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -math.modf((hurt) * 2));
	    WAR.YHZJ[eid]=WAR.YHZJ[eid] or 0 +1
    end
 
    if WAR.DZPZ==1 and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emenyid]["我方"]then
        WAR.ICEXS[eid]=1
	    WAR.ICE[eid]=WAR.ICE[eid] or 0 + 20
	    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -math.modf((hurt) * 2));
	    WAR.YHZJ[eid]=WAR.YHZJ[eid] or 0 +1
    end
 
    if WAR.DZPZ==2 and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emenyid]["我方"] then
        WAR.HOTXS[eid]=1
	    WAR.HOT[eid]=WAR.HOT[eid] or 0 + 20
	    WAR.Person[emenyid]["体力点数"] = (WAR.Person[emenyid]["体力点数"] or 0) + AddPersonAttrib(eid, "体力", -15);
	    WAR.LFCG[eid]=WAR.LFCG[eid] or 0 +10
    end
 
    if WAR.DZPZ==3 and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emenyid]["我方"] then

	if math.random(10)<5 then
	    WAR.BZ[eid]=WAR.BZ[eid] or 0 +1
	end
	WAR.GUDUVICTIE[eid]=WAR.GUDUVICTIE[eid] or 0 +1
	local aa=math.modf(JY.Person[eid]["内力"] / 10) 
	WAR.L_WNGZL[eid] = 20 + aa
	WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", aa)
	WAR.QSLZ[eid]=WAR.QSLZ[eid] or 0 +1
    end	
 
    if WAR.WYLW2 == 3 and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emenyid]["我方"] then
	    if math.random(10)<5 then
	        WAR.BZ[eid]=WAR.BZ[eid] or 0 +1
	    end
	    WAR.GUDUVICTIE[eid]=WAR.GUDUVICTIE[eid] or 0 +1
	    local aa=math.modf(JY.Person[eid]["内力"] / 10) 
	    WAR.L_WNGZL[eid] = 20 + aa
	    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -aa);
    end
 
    if WAR.WYLW2 == 4 and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emenyid]["我方"] then
	    local aa=math.modf(JY.Person[eid]["内力"] / 10) 
	    WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", aa)
	    WAR.QSLZ[eid]=WAR.QSLZ[eid] or 0 +1
    end
 
    if WAR.WYLW3 == 4 and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emenyid]["我方"] then
	    WAR.LFCG[eid]=WAR.LFCG[eid] or 0 +10
    end
 
    if WAR.WYLW3 == 3 and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emenyid]["我方"] then
	    WAR.HDGX[eid]=WAR.HDGX[eid] or 0 +1
    end
 
    if WAR.WYLW5 == 3 and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emenyid]["我方"] then
	    WAR.LYXJ[eid]=WAR.LYXJ[eid] or 0 +1
    end
 
 
    if DWPD() then
	--主功体杀体力
	for i = 1, #CC.ZGT9 do
		if (CC.ZGT9[i][1] == wugong or (T12YMZ(pid) and wugong == 112)) and (PersonGTJL(pid, CC.ZGT9[i][2], WAR.NGJL) or ((PersonGTJL(pid,9999, WAR.NGJL) and (JY.Thing[224]["加攻击力"]) == CC.ZGT9[i][2] or JY.Thing[224]["加防御力"]) == CC.ZGT9[i][2])) then
			local tl = math.modf(JY.Person[eid]["体力"] * (CC.ZGT9[i][3] / 100))
			WAR.Person[emenyid]["体力点数"] = (WAR.Person[emenyid]["体力点数"] or 0) + 
				AddPersonAttrib(eid, "体力", -tl);
			break
		end
	end	
    end
    --and (PersonGTJL(pid, CC.ZGT9[i][2], WAR.NGJL) or ((PersonGTJL(pid,9999, WAR.NGJL) and (JY.Thing[224]["加攻击力"]) == CC.ZGT9[i][2] or JY.Thing[224]["加防御力"]) == CC.ZGT9[i][2])) then
    if DWPD() then
	--1-26-
	for i = 1, #CC.ZGT9 do
		if (CC.ZGT9[i][1] ==  WAR.HLTX or CC.ZGT9[i][2] ==  WAR.HLTX) and (wglw(pid,102) or (DT(pid,38) and PersonKF(pid,102))) then
			local tl = math.modf(JY.Person[eid]["体力"] * (CC.ZGT9[i][3] / 100))
			WAR.Person[emenyid]["体力点数"] = (WAR.Person[emenyid]["体力点数"] or 0) + 
				AddPersonAttrib(eid, "体力", -tl);
			break
		end
	end	
    end
    if DWPD() then
	--豸苗：折梅杀体力
	for i = 1, #CC.ZGT9 do
	    for l = 1,10 do
		    local jl = 15 + math.modf(JY.Person[pid]["实战"] / 20)+ math.modf(JY.Person[pid]["武学常识"] / 10)
	        if wugong == 14 and (JLSD(0,5+jl,pid) or (MPPD(pid)==7 and JLSD(0,15,pid))) and JY.Person[pid]["内力"] >= 7000 then
	            if JY.Person[pid]["武功" .. l] == CC.ZGT9[i][1] then
			        local tl = math.modf(JY.Person[eid]["体力"] * (CC.ZGT9[i][3] / 100))
			        WAR.Person[emenyid]["体力点数"] = (WAR.Person[emenyid]["体力点数"] or 0) + 
				    AddPersonAttrib(eid, "体力", -tl);
				    WAR.ZMS = 1
			        break	
		        end
		    end
	    end	
	end
    end
  
    if WAR.QQSH == 3 and DWPD() then
	    local tl = math.random(2, 10)
	    if DT(pid, 33) then
		    tl = tl + 3
	    end
	    WAR.Person[emenyid]["体力点数"] = (WAR.Person[emenyid]["体力点数"] or 0) + AddPersonAttrib(eid, "体力", -tl);
    end
  
    --程英 杀内力
    --[[if WAR.CY == 1 and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emenyid]["我方"] then
       WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -300);
    end]]
  
    if DWPD() and hasTF(pid, 60) then
	   WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -200);
    end
  
    if WAR.ARJX == 1 then
	   WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -350);
    end 

    --桃花三宝，玉箫杀内300
    if (WAR.THSB == 3 or (MPPD(pid)==10 and WAR.THSB3 ~= 0)) and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emenyid]["我方"] then
       WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -300);
    end
  
    if (wglw(pid,188) or (DT(pid,48) and PersonGT(pid,188))) and JLSD(10,50,pid) then
		WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -500);
    end 

    if hasTF(eid, 79) and JY.Person[eid]["生命"] <= 0 then
  	    if WAR.UNDEAD[eid] == nil then
  		    WAR.UNDEAD[eid] = 50
  		    WAR.Person[emenyid][CC.TXDH] = 119
		    if WAR.Person[emenyid][CC.TXWZ3] == nil then  
  		        WAR.Person[emenyid][CC.TXWZ3] = "醉生梦死"	
            else 
		        WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."+醉生梦死"	
            end		
  		        JY.Person[eid]["生命"] = 1
  	    end
    end  
	
	if WAR.BLHQ1 == 1 and JY.Person[eid]["生命"] <= 0 and wglw1(pid,67) and JLSD(10,40,eid) then --
		WAR.BLHQ[eid] = 50
		JY.Person[eid]["生命"] = 1
		JY.Person[eid]["受伤程度"] = 0
		WAR.FXDS[eid] = 0
		WAR.CHZ[eid] = 0
		WAR.Person[emenyid][CC.TXDH] = 119
	end	

  
    if wugong == 66 and (DT(pid,103) or DT(pid,595)) and WAR.CHD==4 then --沼跃鱼：鸠摩智残火刀一式
        WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -1500)
	    if JY.Person[eid]["受伤程度"]>=0 then
	       local ns= math.modf(JY.Person[eid]["受伤程度"]*3)
	       WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -ns)
	    end
    end

  	if wugong == 140 and DT(pid,558)  then --霍山阴风刀
	    if JY.Person[eid]["受伤程度"]>=0 then
	        local ns= math.modf(JY.Person[eid]["受伤程度"]*3)+100
	        WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -ns)
	    end
	end  

    --田归农 杀死苗人凤
    if WAR.ZDDH == 0 and DT(pid, 72) and eid == 3 and JY.Person[eid]["生命"] <= 0 then
        WAR.TGN = 1
    end  
  
    if WAR.ZDDH == 0 and DT(pid, 4) and eid == 1 and JY.Person[eid]["生命"] <= 0 then
        WAR.YJ2 = 1
    end  
  
    local ours = 0
    for j = 0, WAR.PersonNum - 1 do
  	    if WAR.Person[j]["死亡"] == false and 
  		    WAR.Person[j]["我方"] then
  		    local tmppid = WAR.Person[j]["人物编号"]
  		    if tmppid ~= 92 then
  			    ours = 1
  			    break
  		    end
  	    end
    end	
	
    if ZLE(eid) and JY.Person[eid]["生命"] <= 0 and ours ~= 0 then --赵灵儿退场
	    WAR.MMTC = 1
    end
  
    if LYR(eid) and JY.Person[eid]["生命"] <= 0 and ours ~= 0 then --林月如退场
	    WAR.MMTC = 2
    end

    if AN(eid) and JY.Person[eid]["生命"] <= 0 and ours ~= 0 then --阿奴退场
	    WAR.MMTC = 3
    end  
  
    if (getHZ(eid, 4) or hasTF(eid, 76)) and JY.Person[eid]["生命"] <= 0 and DWPD() and xiaobin(pid) then
	    local yes = 0
	    local yes2 = 0
	    for j = 0, WAR.PersonNum - 1 do
		    if WAR.Person[j]["死亡"] == false and 
			    WAR.Person[j]["我方"] then
			    local tmppid = WAR.Person[j]["人物编号"]
			    if tmppid ~= eid then
				    yes2 = 1
				    break
			    end
		    end
	    end		
	for j = 0, WAR.PersonNum - 1 do
		if WAR.Person[j]["死亡"] == false and 
			WAR.Person[j]["我方"] == false then
			local tmppid = WAR.Person[j]["人物编号"]
			if tmppid ~= pid then
				yes = 1
				break
			end
		end
	end		
	if yes ~= 0 and yes2 ~= 0 then
		WAR.SHMP = pid
		WAR.Person[emenyid][CC.TXWZ3] = "散魂灭魄"
	end
    end
  
	if DT3(eid, 76) and JY.Person[eid]["生命"] <= 0 then --王语嫣退场点破重置
		WAR.WYY = {}
	end
	if (wglw(eid,121) or DT(eid, 59)) and JY.Person[eid]["生命"] <= 0 then
	    WAR.QX1 = {}
	end
	if JY.Person[eid]["生命"] <= 0 and hasTF(eid, 119) and DWPD() then
		WAR.Person[emenyid][CC.TXDH] = 147
		WAR.Person[emenyid][CC.TXWZ3] = "悲歌断肠"	
		WAR.BZ[pid] = 2	
	end
	if DT(pid, 602) and JLSD(10, 60, pid) and DWPD() then
		WAR.Person[emenyid][CC.TXDH] = 160
		WAR.Person[emenyid][CC.TXWZ3] = "易镇天南"	
		WAR.BZ[eid] = 2	
	end
	if JY.Person[eid]["生命"] <= 0 and (MPPD(eid)==13 and MPDJ(eid)>1) and DWPD() then --沼跃鱼：明教同仇敌忾
		local MJTC= math.random(3)
		local status = 0
		if PersonGT(eid,93) then----
		MJTC=3
		end
        if MJTC ==1 then
		for j = 0, WAR.PersonNum - 1 do
				if not WAR.Person[j]["死亡"] and WAR.Person[j]["我方"] ~= WAR.Person[emenyid]["我方"] 
					and WAR.Person[j]["人物编号"] ~= eid then
					local tmppid = WAR.Person[j]["人物编号"]
					AddPersonAttrib(tmppid, "中毒程度", -1*(MPDJ(eid)-1))
				end
			end	
		status=107
		
        elseif MJTC ==2 then
		for j = 0, WAR.PersonNum - 1 do
				if not WAR.Person[j]["死亡"] and WAR.Person[j]["我方"] ~= WAR.Person[emenyid]["我方"] 
					and WAR.Person[j]["人物编号"] ~= eid then
					local tmppid = WAR.Person[j]["人物编号"]
					WAR.BZ[tmppid] = WAR.BZ[tmppid] or 0 + MPDJ(eid)-1
				end	
			end	
		status=108
		
		else
			for j = 0, WAR.PersonNum - 1 do
				if not WAR.Person[j]["死亡"] and WAR.Person[j]["我方"] ~= WAR.Person[emenyid]["我方"] 
					and WAR.Person[j]["人物编号"] ~= eid then
					local tmppid = WAR.Person[j]["人物编号"]
					local aa=50
					local bb=300
					if PersonGT(eid,93) then----
		            aa=aa+math.modf(JY.Person[eid]["内力"]/100)
					bb=math.modf(aa*6)
		            end
					AddPersonAttrib(tmppid, "生命", -aa*(MPDJ(eid)-1))
					AddPersonAttrib(tmppid, "内力", -bb*(MPDJ(eid)-1))
				end
			end	
		status=109
		end	
	    WAR.Person[emenyid][CC.TXDH] = status
		WAR.Person[emenyid][CC.TXWZ3] = "生亦何欢.死亦何苦"
	end
	
	--[[if WAR.BLHQ1 == 2 then
		for j = 0, WAR.PersonNum - 1 do
			if not WAR.Person[j]["死亡"] and WAR.Person[j]["我方"] ~= WAR.Person[emenyid]["我方"] and WAR.Person[j]["人物编号"] ~= eid then
				local tmppid = WAR.Person[j]["人物编号"]
				local aa=50
				local bb=300
				AddPersonAttrib(tmppid, "生命", -aa*(4))
				AddPersonAttrib(tmppid, "内力", -bb*(4))
			end
		end
		WAR.BLHQ1 = 0
	end]]
	
	if JY.Person[eid]["生命"] <= 0 and WAR.RECOVERY[eid] == nil then 
		for j = 0, WAR.PersonNum - 1 do
			local tmppid = WAR.Person[j]["人物编号"]
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["人物编号"] ~= eid then
				if hasTF(tmppid, 81) and WAR.Person[j]["我方"] ~= WAR.Person[emenyid]["我方"] then
					WAR.Person[j]["内力点数"] = (WAR.Person[j]["内力点数"] or 0) + AddPersonAttrib(tmppid, "内力", 200)
					WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(tmppid, "生命", 100)
					WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
				elseif hasTF(tmppid, 82) and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] then
					WAR.Person[j]["内力点数"] = (WAR.Person[j]["内力点数"] or 0) + AddPersonAttrib(tmppid, "内力", 500)
					WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(tmppid, "生命", 200)
					WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
				elseif (MPPD(tmppid)== 13 and MPDJ(tmppid)>1) and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] then--沼跃鱼：明教同仇敌忾
					WAR.Person[j]["内力点数"] = (WAR.Person[j]["内力点数"] or 0) + AddPersonAttrib(tmppid, "内力", 500)
					WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(tmppid, "生命", 200)
					WAR.XNXS[WAR.Person[j]["人物编号"]] = 1					
				end
			end			
			if hasTF(tmppid, 120) and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] then 
				WAR.Person[j].Time = 990
			elseif (MPPD(tmppid)== 13 and MPDJ(tmppid)>1) and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] then --沼跃鱼：明教同仇敌忾
				WAR.Person[j].Time = WAR.Person[j].Time+500
				if WAR.Person[j].Time>=999 then
				WAR.Person[j].Time=999
				end
			end				
		end	
		if hasTF(eid, 77) and JY.Person[eid]["生命"] <= 0 then 
			for j = 0, WAR.PersonNum - 1 do
				if not WAR.Person[j]["死亡"] and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] 
					and WAR.Person[j]["人物编号"] ~= eid then
					local tmppid = WAR.Person[j]["人物编号"]
					zhanyi(tmppid, 30, 1)
				end
			end			
		end		
		if hasTF(eid, 80) and JY.Person[eid]["生命"] <= 0 then 
			for j = 0, WAR.PersonNum - 1 do
				if not WAR.Person[j]["死亡"] and WAR.Person[j]["我方"] ~= WAR.Person[emenyid]["我方"] 
					and WAR.Person[j]["人物编号"] ~= eid then
					local tmppid = WAR.Person[j]["人物编号"]
					zhanyi(tmppid, -30)
				end
			end	
		end			
		if hasTF(eid, 139) and JY.Person[eid]["生命"] <= 0 then 
			for j = 0, WAR.PersonNum - 1 do
				if not WAR.Person[j]["死亡"] and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"] 
					and WAR.Person[j]["人物编号"] ~= eid then
					local tmppid = WAR.Person[j]["人物编号"]
					WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(tmppid, "生命", 300)	
				end
			end	
		end	
		if hasTF(eid, 138) and JY.Person[eid]["生命"] <= 0 then 
			for j = 0, WAR.PersonNum - 1 do
				if not WAR.Person[j]["死亡"] and WAR.Person[j]["我方"] ~= WAR.Person[emenyid]["我方"] 
					and WAR.Person[j]["人物编号"] ~= eid then
					local tmppid = WAR.Person[j]["人物编号"]
					WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(tmppid, "生命", -300)
					if JY.Person[tmppid]["生命"] < 0 then JY.Person[tmppid]["生命"] = 1 end
				end
			end	
		end
		--[[
		if eid == 104 and JY.Person[eid]["生命"] <= 0 then 
			if not (WAR.ZDDH == 134 or WAR.ZDDH == 226 or WAR.ZDDH == 341 or WAR.ZDDH == 342 or JY.Person[50]["姓名"] ~= "萧峰") then
				local x, y = WE_xy(WAR.Person[emenyid]["坐标X"], WAR.Person[emenyid]["坐标Y"] - 1)
				NewWARPersonZJ(50, true, x, y, false, 2);
				WAR.LQZ[50] = 100
				Talk("阿朱且退，这等局面，便由萧某来应付罢", 50)
				Talk("大哥，千万小心", 104) 		
			end
		end
		]]
		WAR.RECOVERY[eid] = 1
	end
  
	if DT(eid, 633) and JY.Person[eid]["生命"] <= 0 and WAR.LSH == 0 then --凌霜华退场
		for j = 0, WAR.PersonNum - 1 do
			if not WAR.Person[j]["死亡"] and WAR.Person[j]["我方"] == WAR.Person[emenyid]["我方"]
				and WAR.Person[j]["人物编号"] == 632 then
				zhanyi(WAR.Person[j]["人物编号"], 100, 1)
				WAR.LQZ[WAR.Person[j]["人物编号"]] = 100
				WAR.Person[j].Time = 999
				WAR.LSH = 1
				break
			end
		end				
	end	
  	
	if eid == 606 and JY.Person[eid]["生命"] <= 0 then
		JY.Person[eid]["友好度"] = limitX(JY.Person[eid]["友好度"] - 10, 0, 100)		
	end
  
	if WAR.ZDDH ~= 226 and hasTF(pid, 75) 
		and JY.Person[eid]["生命"] <= 0 and inteam(pid) 
		and WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and not inteam(eid) then
		WAR.YJ = WAR.YJ + math.random(15) + 25
	end
  
	if DT(pid, 38) and JY.Person[eid]["生命"] <= 0 and DWPD() and WAR.SAXING ~= -1 then
		WAR.SAXING = WAR.SAXING + 1 --石破天每杀一人集气+200
	end
	
	if hasTF(pid, 78) and DWPD() and JY.Person[eid]["生命"] <= 0 then
		WAR.DXQL[pid] = WAR.DXQL[pid] or 0 + 100
	end

	if T11CJR(pid) and juexing() > 0 and DWPD() and JY.Person[eid]["生命"] <= 0 then
		for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[j]["死亡"] == false and not nokillspeed(WAR.Person[j]["人物编号"]) then
				WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - math.modf(100 + JY.Person[pid]["实战"] * 0.1)
			end
		end
		WAR.Person[WAR.CurID][CC.TXWZ3] = "飞瀑怒潮"
	end
	
	if getHZ(pid, 5) and JY.Person[eid]["生命"] <= 0 and DWPD() then
		WAR.Person[WAR.CurID][CC.TXWZ3] = "赤炼修罗"
		WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid,"生命", 100)
	end	
  
	if DT(pid, 631) and JY.Person[eid]["生命"] <= 0 and DWPD() and --殷离
		((eid >= 431 and eid <= 439) or (eid >= 887 and eid <= 895)) then
		--setJX(pid, 1)
		if JY.Person[578]["拳掌功夫"] < 999 then 
		AddPersonAttrib(578, "拳掌功夫", 1)
		end
	end

	if DT(pid, 606) and WAR.ZDDH == 295 and math.random(5) == 1 and JY.Person[eid]["生命"] <= 0 and DWPD() and xiaobin(eid) then --武骧金星：宠物学武功
		local a = JY.Person[eid]["声望"]
		local b = JY.Person[eid]["技能1"]
		if a > 0 and JY.Person[pid]["武功10"] == 0 then
			if not PersonKF(pid, a) then 
				for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
					if JY.Person[pid]["武功"..i] == 0 then 
						JY.Person[pid]["武功"..i] = a 
						JY.Person[pid]["武功等级"..i] = 999 
						QZXS(JY.Person[pid]["姓名"].."学会了"..JY.Wugong[a]["名称"]);
						break
					end
				end
			end
		end
		if b > 0 and JY.Person[pid]["技能5"] == 0 and math.random(2) == 1 then
			local panding = 0
			for i = 1, 5 do
				if JY.Person[pid]["技能"..i] == b then 
					panding = 1
					break
				end
			end
			if panding == 0 then
				for i = 2, 5 do
					if JY.Person[pid]["技能"..i] == 0 then
						JY.Person[pid]["技能"..i] = b
						QZXS(JY.Person[pid]["姓名"].."领悟了"..CC.TFlist[b][1]);
						break
					end
				end
			end
		end
	end
	
    --阿紫杀每人后杀全体气80 中毒5-15 中毒满追加减体力
	if DT(pid, 47) and JY.Person[eid]["生命"] <= 0 and 
		WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
	    for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - 80
				local p = WAR.Person[j]["人物编号"]
				if JY.Person[p]["中毒程度"] < 100 then
					WAR.Person[j]["中毒点数"] = (WAR.Person[j]["中毒点数"] or 0) + AddPersonAttrib(p,"中毒程度", 5 + math.random(0, 10));
					WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
				else
					AddPersonAttrib(p, "体力", -1 * math.random(5, 10))
					WAR.Person[j]["体力点数"] = (WAR.Person[j]["体力点数"] or 0) + AddPersonAttrib(p,"体力", -1 * math.random(5, 10));
					WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
				end
			end
		end
	end

    --steal
    if (hasTF(pid, 97) or MPPD(pid) == 2) and (JLSD(10, 60, pid) or PersonKF(pid,197)) and inteam(pid) and WAR.ZDDH ~= 341 and --武骧金星：队友挑战任务中不能偷东西
		WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
		local hasitem = 0		
		for i = 1, 4 do
			if JY.Person[eid]["携带物品数量" .. i] > 0 and JY.Person[eid]["携带物品" .. i] > -1 then
				hasitem = 1
				break
			end
		end
		if hasitem == 1 then
			while true do		
				local i = nil
				i = math.random(4)
				if 0 < JY.Person[eid]["携带物品数量" .. i] and -1 < JY.Person[eid]["携带物品" .. i] and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emenyid]["我方"] then
				  JY.Person[eid]["携带物品数量" .. i] = JY.Person[eid]["携带物品数量" .. i] - 1				  
				  WAR.ZHUJUETDNUM = WAR.ZHUJUETDNUM + 1
				  WAR.ZHUJUETD[WAR.ZHUJUETDNUM]=JY.Person[eid]["携带物品" .. i]			  
				  hasitem = 2
				end
				if JY.Person[eid]["携带物品数量" .. i] < 1 then
				  JY.Person[eid]["携带物品" .. i] = -1
				end
				if hasitem == 2 then
					break
				end
			end
		end
	end
    --阎基在场，我方攻击中毒1-5点
    if WAR.Person[WAR.CurID]["我方"] and DWPD() then
       for j = 0, WAR.PersonNum - 1 do
           if WAR.Person[j]["人物编号"] == 4 and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
              WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", math.random(1, 5))
           end
       end
    end
    if DT1(pid,4) then
  	   WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", math.random(1, 10))
    end
  
    if DT(pid,4) and JX(pid) then
        local str=""
        local aa=math.modf(JY.Person[pid]["用毒能力"]/100)
  	    if JLSD(10,30+aa*15,pid) then
	        DHdisplay(1070, 1089, "千金毒方.悲酥清风")
	        if JLSD(10,30+aa*15,pid) then
	            WAR.QSLZ[eid]=WAR.QSLZ[eid] or 0+1
	            local str=".七星蜡烛"
	        end
            for j = 0, WAR.PersonNum - 1 do
		        if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				    local tmppid = WAR.Person[j]["人物编号"]
				    WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(tmppid, "生命", -50*(aa+1))
				    if JY.Person[tmppid]["生命"] < 0 then JY.Person[tmppid]["生命"] = 1 end	
					    WAR.Person[j]["内力点数"] = (WAR.Person[j]["内力点数"] or 0) +AddPersonAttrib(tmppid, "内力", -300*(aa+1))
					    WAR.Person[j]["中毒点数"] = (WAR.Person[j]["中毒点数"] or 0) +AddPersonAttrib(tmppid, "中毒程度", math.random(aa, 10))
				    end
					WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
	            end	
	        if WAR.Person[emenyid][CC.TXWZ3] == nil then
		        WAR.Person[emenyid][CC.TXWZ3] = "千金毒方.悲酥清风"..str
	        else
		        WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+" .. "千金毒方.悲酥清风"..str
	        end	
	            WAR.Person[emenyid][CC.TXDH] = 112
	    end
    end
  
    if WAR.FXHJ1 == 1 then
		WAR.KHCM[eid] = 1
	end	

    --葵花刺目，40%机率MISS 
    if WAR.KHBX == 1 and 0 < hurt and (WAR.KHCM[eid] == nil or WAR.KHCM[eid] == 0) 
	    and WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and eid ~= 13 and eid ~= 78 and eid ~= 130 and eid ~= 662 and MPPD(eid) ~= 9 then
        WAR.KHCM[eid] = 1
    end
  
    --辟邪刺目，100%MISS 谢逊梅超风柯镇恶免疫
    if WAR.KHBX == 2 and 0 < hurt and WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"]
	    and eid ~= 13 and eid ~= 78 and eid ~= 130 and eid ~= 662 and MPPD(eid) ~= 9 then
        WAR.KHCM[eid] = 2
    end
  
    if WAR.SHENMEN == 1 and hurt > 0 and DWPD() then--神门刺穴
	    WAR.BZ[eid] = 1
    end
  
    if WAR.ZHUA == 1 and hurt > 0 and DWPD() then
	    WAR.L_NOT_MOVE[eid] = 1
    end

    --宫本宝藏 秒杀
    if WAR.GBWZ == 1 and DT(pid, 516) and math.random(10) < 6 and WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and not jtyl(eid) and not wssz(eid) then --pid == 516
  	    WAR.Person[emenyid]["生命点数"] = -JY.Person[eid]["生命"];
        JY.Person[eid]["生命"] = 0
    end

    if J2YSS(pid) and WAR.DUOMINGJIAN==15 and WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and not jtyl(eid) and not wssz(eid) then --pid == 516
  	    WAR.Person[emenyid]["生命点数"] = -JY.Person[eid]["生命"];
        JY.Person[eid]["生命"] = 0
    end
  
    if getHZ(pid, 3) and JLSD(10, 35, pid) and xiaobin(eid) and
	    WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
  	    WAR.Person[emenyid]["生命点数"] = -JY.Person[eid]["生命"];
        JY.Person[eid]["生命"] = 0
        WAR.Person[WAR.CurID][CC.TXWZ1] = "十殿阎罗"
        WAR.Person[WAR.CurID][CC.TXDH] = 6
    end  

    if wugong == 26 and (DT(pid,49) or DT(pid,617)) and JLSD(10,45,pid) then	  --虚竹降龙掌   
        WAR.Person[emenyid]["内力点数"] = -JY.Person[eid]["内力"];
        JY.Person[eid]["内力"] = 0
		WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", 9999)
		WAR.Person[WAR.CurID][CC.TXWZ3] = "北冥真气 为我所用"
    end

    if wglw(pid,88) or DT(pid,26) or DT(pid,35) or DT(pid,617) then --吸星领悟
		WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", 350)
		WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -350)
	end	

    --封穴计算 
	local fxjl = 10
	--[[
	if not inteam(pid) then
		local gfxp = {114, 26, 129, 65, 18, 39, 70, 57, 185}
		for g = 1, 10 do
			if DT(pid, gfxp[g]) then
				fxjl = fxjl + 20
				break
			end
		end
	end  ]]
	
	if DT(pid, 98) and JY.Person[0]["品德"] < 30 then --段延庆，品德越低封穴几率越高
		local bonus = 30 - JY.Person[0]["品德"]
		fxjl = fxjl + bonus
	end   
	
	for i = 1, #CC.ZGT10 do --功体加成封穴
		if (CC.ZGT10[i][1] == wugong or (T12YMZ(pid) and wugong == 112)) and (PersonGT(pid, CC.ZGT10[i][2]) or ((PersonGT(pid,9999) and (JY.Thing[224]["加攻击力"]) == CC.ZGT10[i][2] or JY.Thing[224]["加防御力"]) == CC.ZGT10[i][2])) then
			fxjl = fxjl + CC.ZGT10[i][3]
			break
		end
	end
    --and (PersonGT(pid, CC.ZGT10[i][2]) or ((PersonGT(pid,9999) and (JY.Thing[224]["加攻击力"]) == CC.ZGT10[i][2] or JY.Thing[224]["加防御力"]) == CC.ZGT10[i][2]) then	
	for i = 1, #CC.ZGT10 do --1-26
		if (CC.ZGT10[i][1] ==  WAR.HLTX or CC.ZGT10[i][2] ==  WAR.HLTX) and (wglw(pid,102) or (DT(pid,38) and PersonKF(pid,102))) then
			fxjl = fxjl + CC.ZGT10[i][3]
			break
		end
	end	
	for i = 1, #CC.ZGT10 do --豸苗：折梅手
	    for l = 1,10 do
		local jl = 15 + math.modf(JY.Person[pid]["实战"] / 20)+ math.modf(JY.Person[pid]["武学常识"] / 10)
	        if wugong == 14 and (JLSD(0,5+jl,pid) or (MPPD(pid)==7 and JLSD(0,15,pid))) and JY.Person[pid]["内力"] >= 7000 then
	            if JY.Person[pid]["武功" .. l] == CC.ZGT10[i][1] then
			        fxjl = fxjl + CC.ZGT10[i][3]
			        WAR.ZMS = 1
			        break
		        end
		    end
	    end	
	end

	if PersonKF(pid, 152) then --天南易阳决封穴+10
		fxjl = fxjl + 10
	end  
	if PersonGT(pid, 152) then --天南易阳决主功体封穴+10
		fxjl = fxjl + 10
	end   	

	if JY.Person[pid]["武器"] == 247 and yongquan(wugong) then --逍遥指环封穴+10
		fxjl = fxjl + 10
	end

	if JY.Person[pid]["武器"] == 49 and wugong == 80 then --打狗套装封穴+20
		fxjl = fxjl + 20
	end  	
	
	if WGLX == 1 then --拳系武功封穴+20，其他+10
		fxjl = fxjl + 20
	else
		fxjl = fxjl + 10
	end

	if wugong==133 then --沼跃鱼：一灯六脉转龙
	   fxjl = fxjl * WAR.ACT
	 end
	
	if wugong == 17 and DT(pid, 81) then --朱九真一阳指封穴+15
		fxjl = fxjl + 15
	end
	
	if DT(pid, 61) then --欧阳克封穴+15
		fxjl = fxjl + 15
	end
	
    if (DT(pid, 5) or DT(pid, 666)) or wglw1(pid,46) then  --太极剑法领悟封穴+30	
		fxjl = fxjl + 40
	end 	 	
	
    if JY.Person[pid]["武器"] == 48 and JLSD(10,40,pid)  then 	--金刀黑剑
		WAR.BFX = 1
	end	
	
	--桃花三宝，五岳剑法，特系大招，琴棋书画必封穴	
	if WAR.GCTJ == 1 or WAR.GCTJ1 == 1 or WAR.QQSH == 2 or WAR.L_WYJFA == 1 or WAR.L_WYJFA1 == 1 or WAR.THSB == 2 or (MPPD(pid)==10 and WAR.THSB2 ~= 0) then 	
		WAR.BFX = 1
	end
	
	if T7DFWM(pid) and WAR.DZXY == 1 and yongte(wugong) and juexing()>1 then --东方未明特系反击特效
	    WAR.BFX = 1
	end  
	
	if XYL(pid) and WAR.XYL == 2 then --豸苗：谢云流必封穴
		WAR.BFX = 1
	end
	if DT(pid,27) and (pid == 0 or pid == 27) and WAR.TLHS == 1 then ----
		WAR.BFX = 1
	end
	if MPPD(pid) == 11 and WAR.JQ[pid] ~= nil and WAR.JQ[pid] > 6 then --剑势3
	    WAR.BFX = 1
	end
	if WAR.ZCDZ ==1 and hasDZ(pid,2) then ---沼跃鱼：战意组件2
        WAR.BFX = 1
    end
	if (wglw(pid,107) and PersonGT(pid,107)) or DT(pid,599) then
		WAR.BFX = 1
	end 	
	if DT(pid,129) then--沼跃鱼：王重阳神通技一阳指劲
	    WAR.BFX = 1
	end
	
	if (wugong==17 and MPPD(pid)==15 and PersonGTJL(pid,152,WAR.NGJL)) and DT(pid, 602) then--沼跃鱼：王重阳神通技一阳指劲
	    WAR.BFX = 1
	end
	
	if DT(pid,65) and WAR.YD>0 then
	    WAR.BFX = 1
	end
	
	if WAR.LXZQ == 1 and JLSD(25, 75, pid) then --拳系大招封穴50%二次判定
		WAR.BFX = 1
	end

	if T4WXS(pid) and WAR.SHITOUJIAN == 1 and JLSD(10, 30, pid) then --王小石剑法特效20%二次判定
		WAR.BFX = 1
	end	
	
	if DT(pid,72) and JX(pid) and WAR.DJJIAN == 1 and JLSD(10, 30, pid) then --田归农剑法特效20%流血
		WAR.BFX = 1
	end
	
	if noparalyze(eid) then
	
	elseif T7DFWM(pid) and WAR.DFWM2 == 1 then --东方未明出拳系特效不额外封穴
	
	elseif T9ZY(eid) and WAR.ZYWS > 0 then --赵云无双不封穴
	
	elseif T8LXY(eid) and lixiaoyao ~= 0 then --李逍遥真元护体不封穴
	
	elseif DT(eid,65) and WAR.WCY4>0 then --沼跃鱼：六脉转龙免封穴
	
	elseif MPPD(eid) == 8 and JLSD(10, 25, eid) then --武骧金星：白驼山弟子几率免封穴
	
	elseif DWPD() and hurt > 100 then --封穴计算
		if JLSD(10, 10 + fxjl, eid) or WAR.BFX == 1 then
			local fengxue = 0	
			if PersonGT(pid, 152) then
				fengxue = hurt / 60
			else
				fengxue = hurt / 70
			end
			if PersonGT(eid, 151) then --金刚不坏封穴减半
				fengxue = fengxue * 0.5
			end	
			if WAR.QQSH == 2 and DT(pid, 32) then
				fengxue = fengxue + 3
			end	
            if wglw(eid,184) and PersonGT(eid,184) or DT(eid,665) then --瑜伽密乘减半封穴
				fengxue = fengxue * 0.5
			end	
			if DT(pid,129) then --沼跃鱼：王重阳神通技一阳指劲
			   fengxue = fengxue + math.random(5,10)
			end
			
			if DT(pid,65) and WAR.YD>0 then --沼跃鱼：一灯六脉转龙
	           fengxue = fengxue + 3*(8-WAR.YD)
	        end
			
			if wugong==133 then --沼跃鱼：一灯六脉转龙
	           fengxue = fengxue * WAR.ACT
	        end
			
			if DT(pid,602) then
	           fengxue = fengxue + math.random(5,10)
	        end
			
			if wugong==17 and MPPD(pid)==15 and PersonGTJL(pid,152,WAR.NGJL) then--沼跃鱼：大理一阳指劲
	           fengxue = fengxue + math.random(5,10)
	        end
			
			if JY.Person[eid]["防具"] == 60 then --金丝背心-封穴5
				fengxue = fengxue - 5
				if fengxue < 0 then fengxue = 0 end
			end				
			local wgjc = 0
			local fff = 130
			if not inteam(pid) then
				fff = 100
			end
			for i, v in ipairs(CC.WGJC2) do --武功封穴加成
				if v[1] == wugong then
					wgjc = 1
					fengxue = fengxue + (v[2] * (hurt / fff))
					break
				end
			end 		
			if wgjc == 0 then
				fengxue = fengxue + (2 * (hurt / fff))
			end
			fengxue = math.modf(fengxue)
			
			if WAR.FXDS[eid] == nil then
				WAR.FXDS[eid] = fengxue
			else
				WAR.FXDS[eid] = WAR.FXDS[eid] + fengxue
			end			
			
			WAR.FXXS[eid] = 1
			
			if DT(eid, 627) and JY.Person[eid]["生命"] > math.modf((WAR.FXDS[eid] or 0) * 10) then --公孙绿萼免疫封穴
				WAR.FXXS[eid] = nil
				WAR.FXDS[eid] = nil
				WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid,"生命",-(math.modf((WAR.FXDS[eid] or 0) * 10)))
				--JY.Person[eid]["生命"] = JY.Person[eid]["生命"] - math.modf((WAR.FXDS[eid] or 0) * 10)
			end

            if wglw(eid,106) or (DT(eid,9) and PersonGT(eid,106)) then --九阳领悟免疫封穴
				WAR.FXXS[eid] = nil
				WAR.FXDS[eid] = nil
				--JY.Person[eid]["生命"] = JY.Person[eid]["生命"] - math.modf((WAR.FXDS[eid] or 0) * 10)
			end 	

            if MPPD(eid) == 8 and PersonGT(eid,95) then  --白驼山蛤蟆功免疫封穴
				WAR.FXXS[eid] = nil
				WAR.FXDS[eid] = nil
			end	
			
            if DT(eid, 62) or DT(eid , 594) then --金轮免疫封穴
				WAR.FXXS[eid] = nil
				WAR.FXDS[eid] = nil
			end 			
			
			if eid==0 and putong() == 9 then --血手以自身流血值代替封穴
				WAR.LXZT[eid] = (WAR.LXZT[eid] or 0) + WAR.FXDS[eid]
				WAR.FXXS[eid] = nil
				WAR.FXDS[eid] = nil
			end
			
            if wglw(eid,94) or (DT(eid,632) and PersonKF(eid,94)) then	 --神照功神经颠倒
                WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -(WAR.FXDS[eid] or 0)*5)
				WAR.FXXS[eid] = nil
				WAR.FXDS[eid] = nil
			end	
			
			if WAR.FXDS[eid] ~= nil and 50 < WAR.FXDS[eid] then
				WAR.FXDS[eid] = 50
			end			
					
			if pid == 0 and putong() == 1 then --拳系每多1拳封穴+1
				WAR.FXDS[eid] = (WAR.FXDS[eid]or 0) + wgnumber(0, 1)
				if WAR.FXDS[eid] > (wgnumber(0, 1) + 50) then
					WAR.FXDS[eid] = wgnumber(0, 1) + 50
				end
			end			
		end
	end
	
	WAR.BFX = 0
  
	--[[
	if not inteam(pid) then
		local glxp = {6, 3, 40, 97, 103, 19, 60, 71, 189, 27}
		for g = 1, 10 do
		if pid == glxp[g] and JLSD(30, 50, pid) then
			WAR.BLX = 1
		end
		end
	end
	]]
	
	--流血计算
	local lxjl = 20
	if WGLX == 2 or WGLX == 3 then --刀剑系流血+20，其它+5
		lxjl = lxjl + 20
	else
		lxjl = lxjl + 5
	end
    if  wugong==4 or wugong==20 then----
	    lxjl = lxjl + 35
	end
	
	if  wugong==12 then----
	    lxjl = lxjl + 30
	end
	
	if blood(pid) then
		WAR.BLX = 1
	end
  
    if JY.Person[pid]["武器"] == 249 and JLSD(10,40,pid) then	--闯王军刀
		WAR.BLX = 1
	end

	if WAR.ASKD == 1 and JLSD(25, 75, pid) then --刀系大招必流血
		WAR.BLX = 1
	end
  
  	if WAR.ASKD1 == 1 and JLSD(25, 75, pid) then --刀系大招必流血
		WAR.BLX = 1
	end
  
	if T9ZY(pid) and WAR.ZYLJ == 1 then --赵云必流血
		WAR.BLX = 1
	end
  
  	if XYL(pid) and WAR.XYL == 1 then --豸苗：谢云流必流血
		WAR.BLX = 1
	end
	
    if wugong == 42 and ((DT(pid, 601) or DT(pid, 59)) or wglw1(pid,42)) then  --玉女剑法必流血	
        WAR.BLX = 1
	end	 	
	
    if wugong == 148 and (DT(pid, 55) or wglw1(pid,148)) then
	    WAR.BLX = 1
	end 		
	
    if DT(pid, 600) then 
		WAR.BLX = 1
	end		
	
	if MPPD(pid) == 11 and WAR.JQ[pid] ~= nil and WAR.JQ[pid] > 0 then --剑势3
	   WAR.BLX = 1
	end
	if T13TQS(pid) and WAR.TQS==4 then--沼跃鱼：滕青山拟兽式狼吻必流血
		WAR.BLX = 1	
	end
  	if wssz(pid) and WAR.TQS==4 then--沼跃鱼：滕青山拟兽式狼吻必流血
		WAR.BLX = 1	
	end
	if pid==0 and putong() == 9 and math.random(10)<=5 then --血手仁义50%流血
		WAR.BLX = 1
	end
    if (wglw(pid,107) and PersonGT(pid,107)) or DT(pid,599) then
		WAR.BLX = 1
	end	
  	if DT(pid,65) and WAR.YD>0 then --沼跃鱼：一灯六脉转龙
		WAR.BLX = 1
	 end
  
	if T4WXS(pid) and WAR.SHITOUJIAN == 1 and JLSD(10, 30, pid) then --王小石剑法特效20%流血
		WAR.BLX = 1
	end
	if DT(pid,72) and JX(pid) and WAR.DJJIAN == 1 and JLSD(10, 30, pid) then --田归农剑法特效20%流血
		WAR.BLX = 1
	end
	
	--倚天，屠龙特效，鸠摩智特效，特系大招，五岳剑法必流血
	if WAR.L_YTJ1 == 1 or WAR.L_TLD == 1 or WAR.GCTJ == 1 or WAR.GCTJ1 == 1 or WAR.L_WYJFA == 2 or WAR.L_WYJFA2 == 1 or WAR.LYBF>0 then 
		WAR.BLX = 1
	end
	
	if T7DFWM(pid) and WAR.DZXY == 1 and yongte(wugong) and juexing()>1 then --东方未明特系反击特效
	    WAR.BLX = 1
	end  
	
	if wglw1(pid,155) and yongquan(wugong) or DT(pid,665) then --五指秘刀领悟用拳必流血
	    WAR.BLX = 1
	end  
	
	if wugong == 140 and (wglw1(pid,140) or DT(pid,558))then --阴风刀领悟必流血
	    WAR.BLX = 1
	end	
	
	if (wglw1(pid,34) or wglw1(pid,77) or ((DT(pid,605) or (DT(pid,627)))and JX(pid))) and  yongjian(wugong) then --阴阳领悟与西方剑意领悟
	    WAR.BLX = 1
	end  
	
	if wglw2(pid,191) and PersonKF(pid,191) and JLSD(10,45,pid) then
		WAR.BLX = 1
		WAR.LXZS[eid] = 1
	end	
	
	if WAR.ZCDZ ==1 and hasDZ(pid,2) then ---沼跃鱼：战意组件2
       WAR.BLX = 1
	end	
	
	if T9ZY(eid) and WAR.ZYWS > 0 then --赵云无双免疫流血
	
	elseif DWPD() and hurt > 50 then
		if JLSD(10, 10 + lxjl, eid) or WAR.BLX == 1 then
			local liuxue = hurt / 50
			if DT(pid, 591) then
				liuxue = liuxue * 2
			end
			if halflx(eid) then
				liuxue = liuxue / 2
			end
			if JY.Person[eid]["防具"] == 62 then --佛心甲-流血5
				liuxue = liuxue - 5
				if liuxue < 0 then liuxue = 0 end
			end		
		    
			local wgjc = 0
			for i, v in ipairs(CC.WGJC2) do --武功流血加成
				if v[1] == wugong then
					wgjc = 1
					liuxue = liuxue + (v[3] * (hurt / 80))
					break
				end
			end 	
			if wgjc == 0 then
				liuxue = liuxue + (2 * (hurt / 80))
			end
			
		   if DT(pid,65) and WAR.YD>0 then --沼跃鱼：一灯六脉转龙
	           liuxue = liuxue + 3*(8-WAR.YD)
		   end
			
	if  wugong==12 then----
	    liuxue = liuxue + math.random(5,10)
	end
			
			liuxue = math.modf(liuxue)
			if WAR.LXZT[eid] == nil then
			  WAR.LXZT[eid] = liuxue
			else
			  WAR.LXZT[eid] = WAR.LXZT[eid] + liuxue
			end
			WAR.LXXS[eid] = 1
			if 100 < WAR.LXZT[eid] then
				WAR.LXZT[eid] = 100
			end
			
 		if wglw1(pid,155) and yongquan(wugong) or DT(pid,665) then --五指秘刀领悟用拳必流血
	        WAR.LXZT[eid]=WAR.LXZT[eid] or 0 + math.modf(sixi(pid,1) /50)
	    end
		
			if (wglw1(pid,34) or wglw1(pid,77) or ((DT(pid,605) or DT(pid,627))and JX(pid))) and  yongjian(wugong) then --阴阳领悟与西方剑意领悟
	    WAR.LXZT[eid]=WAR.LXZT[eid] or 0 + math.modf(sixi(pid,2) /50)
	end 
		
			if putong() == 2 and pid == 0 then --剑神流血+2
				WAR.LXZT[eid] = WAR.LXZT[eid] + math.modf(wgnumber(0, 2) * 2)
			end	
			
			if T13TQS(pid) and WAR.TQS==4 then
			    WAR.LXZT[eid] = WAR.LXZT[eid] + WAR.SWHH*5
			end
			if wssz(pid) and WAR.TQS==4 then
			    WAR.LXZT[eid] = WAR.LXZT[eid] + WAR.SWHH1*5
			end
			if WAR.LYBF>0 then
			   WAR.LXZT[eid]=WAR.LXZT[eid] or 0 + WAR.LYBF*3
			end
			if WAR.WYLW5>0 then
			   WAR.LXZT[eid]=WAR.LXZT[eid] or 0 + WAR.WYLW5*3
			end
		end	
	end

	WAR.BLX = 0
     
	--迟缓计算
	if hurt > 100 and DWPD() and (T9ZY(eid) == false or WAR.ZYWS <= 0) then
		local jl = 20
		if WGLX == 4 then
			jl = jl + 20
		else
			jl = jl + 5
		end
		if T4WXS(pid) and WAR.SHITOUJIAN == 1 then --王小石剑法特效20%迟缓
			jl = jl + 20
		end
		if DT(pid,72) and JX(pid) and WAR.DJJIAN == 1 then --田归农剑法特效20%迟缓
			jl = jl + 20
		end
		
		if DT(pid, 589) then --水笙
			jl = jl + 15
		end
		if WAR.ZFLY ~= 0 then --正反两仪
			jl = jl + 20
		end

 		if XYL(pid) and WAR.XYL == 3 then --豸苗：谢云流迟缓
			local chihuan = hurt / 60
			if halfch(eid) then
				chihuan =chihuan / 2
			end
			chihuan = math.modf(chihuan)						
			if WAR.CHZ[eid] == nil then
			  WAR.CHZ[eid] = chihuan
			else
			  WAR.CHZ[eid] = WAR.CHZ[eid] + chihuan
			end
			if 50 < WAR.CHZ[eid] then
				WAR.CHZ[eid] = 50
			end	
			WAR.CHXS[eid] = 1
			end
	
       if DT(pid, 600) then -- 武无敌必迟缓
			local chihuan = hurt / 60
			if halfch(eid) then
				chihuan =chihuan / 2
			end
			chihuan = math.modf(chihuan)						
			if WAR.CHZ[eid] == nil then
			  WAR.CHZ[eid] = chihuan
			else
			  WAR.CHZ[eid] = WAR.CHZ[eid] + chihuan
			end
			if 50 < WAR.CHZ[eid] then
				WAR.CHZ[eid] = 50
			end	
			WAR.CHXS[eid] = 1
		end	
	
 		if wglw1(pid,155) and yongdao(wugong) or DT(pid,665) then 
			local chihuan = hurt / 60+sixi(pid,3)/50
			if halfch(eid) then
				chihuan =chihuan / 2
			end
			chihuan = math.modf(chihuan)						
			if WAR.CHZ[eid] == nil then
			  WAR.CHZ[eid] = chihuan
			else
			  WAR.CHZ[eid] = WAR.CHZ[eid] + chihuan
			end
			if 50 < WAR.CHZ[eid] then
				WAR.CHZ[eid] = 50
			end	
			WAR.CHXS[eid] = 1
			end
	
        if WAR.ARJX == 3 then -- 黯然第三式必迟缓
			local chihuan = hurt / 60
			if halfch(eid) then
				chihuan =chihuan / 2
			end
			chihuan = math.modf(chihuan)						
			if WAR.CHZ[eid] == nil then
			  WAR.CHZ[eid] = chihuan
			else
			  WAR.CHZ[eid] = WAR.CHZ[eid] + chihuan
			end
			if 50 < WAR.CHZ[eid] then
				WAR.CHZ[eid] = 50
			end	
			WAR.CHXS[eid] = 1
		end 	

		if WAR.XMSSZ == 4 then -- 须弥第四式必迟缓
			local chihuan = hurt / 60
			if halfch(eid) then
				chihuan =chihuan / 2
			end
			chihuan = math.modf(chihuan)						
			if WAR.CHZ[eid] == nil then
			  WAR.CHZ[eid] = chihuan
			else
			  WAR.CHZ[eid] = WAR.CHZ[eid] + chihuan
			end
			if 50 < WAR.CHZ[eid] then
				WAR.CHZ[eid] = 50
			end	
			WAR.CHXS[eid] = 1
			if WAR.CHZ[eid] > 40 and JLSD(10,30,eid) then
				WAR.SZWH[eid]=WAR.SZWH[eid] or 0 + 21
			end
		end		
			
        if DT(pid, 8) or wglw1(pid,618) then	-- 天山六阳掌必迟缓
			local chihuan = hurt / 60
			if halfch(eid) then
				chihuan =chihuan / 2
			end
			chihuan = math.modf(chihuan)						
			if WAR.CHZ[eid] == nil then
			  WAR.CHZ[eid] = chihuan
			else
			  WAR.CHZ[eid] = WAR.CHZ[eid] + chihuan
			end
			if 50 < WAR.CHZ[eid] then
				WAR.CHZ[eid] = 50
			end	
			WAR.CHXS[eid] = 1
		end 				
		
        if JY.Person[pid]["武器"] == 48 and JLSD(10,40,pid) then --金刀黑剑	
			local chihuan = hurt / 60
			if halfch(eid) then
				chihuan =chihuan / 2
			end
			chihuan = math.modf(chihuan)						
			if WAR.CHZ[eid] == nil then
			  WAR.CHZ[eid] = chihuan
			else
			  WAR.CHZ[eid] = WAR.CHZ[eid] + chihuan
			end
			if 50 < WAR.CHZ[eid] then
				WAR.CHZ[eid] = 50
			end	
			WAR.CHXS[eid] = 1
		end 					
			
		if WAR.L_LXXL == 1 or WAR.THSB == 1 or WAR.L_WYJFA == 4 or WAR.L_WYJFA4 == 1 or (MPPD(pid)==10 and WAR.THSB1 ~= 0) or JLSD(10, 10 + jl, pid) or WAR.LXBL > 0  then
			local chihuan = hurt / 60
			if halfch(eid) then
				chihuan =chihuan / 2
			end
			if JY.Person[eid]["防具"] == 63 then --皮衣-迟缓5
				chihuan = chihuan - 5
				if chihuan < 0 then chihuan = 0 end
			end		
			local wgjc = 0
			for i, v in ipairs(CC.WGJC2) do --武功迟缓加成
				if v[1] == wugong and v[4] ~= nil then
					wgjc = 1
					chihuan = chihuan + (v[4] * (hurt / 100))
					break
				end
			end 	
			if wgjc == 0 then
				chihuan = chihuan + (2 * (hurt / 100))
			end
			if DT(pid, 43) then
				chihuan = chihuan * 1.5
			end
			chihuan = math.modf(chihuan)						
			if WAR.CHZ[eid] == nil then
			  WAR.CHZ[eid] = chihuan
			else
			  WAR.CHZ[eid] = WAR.CHZ[eid] + chihuan
			end
			if 50 < WAR.CHZ[eid] then
				WAR.CHZ[eid] = 50
			end	
			WAR.CHXS[eid] = 1	
			if putong() == 13 and pid == 0 then --暗系迟缓+2
				WAR.CHZ[eid] = WAR.CHZ[eid] + math.modf(wgnumber(pid, 6) * 2)
			end
			if PersonKF(eid,143) and MPPD(eid) ~= 5 then --豸苗：一苇渡江免疫迟缓
			    WAR.CHZ[eid] = 0
				WAR.CHXS[eid] = 0
			end	
			if DT(eid,614) then --12-29-千军止步
			    WAR.CHZ[eid] = 0
				WAR.CHXS[eid] = 0
			end	
			if XYL(eid) and PersonKF(eid,115) then 
			    WAR.CHZ[eid] = 0
				WAR.CHXS[eid] = 0
			end
			if eid==0 and putong() == 9 then --血手以自身流血值代替迟缓
				WAR.LXZT[eid] = (WAR.LXZT[eid] or 0) + WAR.CHZ[eid]
				WAR.CHZ[eid] = 0
				WAR.CHXS[eid] = 0
			end
			
            if wglw(eid,106) or (DT(eid,9) and PersonGT(eid,106)) then	
				WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -1500)
				WAR.CHZ[eid] = 0
				WAR.CHXS[eid] = 0
			end	
			
            if wglw(eid,94) or (DT(eid,632) and PersonKF(eid,94)) then  --神照功神经倒颠	
				WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -WAR.CHZ[eid]*5)
                WAR.CHZ[eid] = 0
				WAR.CHXS[eid] = 0
			end	
		end
	end
	
	--冰封计算
	--灼烧计算
	local BFWG = {}
	local ZSWG = {}
	local B = 0
	local Z = 0
	for i = 0, JY.ThingNum - 1 do
		if JY.Thing[i]["需内力性质"] == 0 then
			B = B + 1
			BFWG[B] = JY.Thing[i]["练出武功"]
		elseif JY.Thing[i]["需内力性质"] == 1 then
			Z = Z + 1
			ZSWG[Z] = JY.Thing[i]["练出武功"]
		end
	end
	local BFWG2 = {3,5,9,11,19,21,35,89,95,101,107,121,124}
	local ZSWG2 = {13,26,39,44,45,61,65,66,99,103,106}  
	local bfjl = 0
	local zsjl = 0
	local ice = 0
	local hot = 0
	
	if hurt > 50 and DWPD() then
		local jl = 0
		
		if DT(pid, 643) or DT(pid, 644) then
			ice = 10 + math.random(5)
		end		
		if JY.Person[pid]["内力性质"] == 0 or JY.Person[pid]["内力性质"] == 3 then
			jl = jl + 15
		elseif JY.Person[pid]["内力性质"] == 2 then
			jl = jl + 10
		end
		for i = 1, #BFWG do
			if wugong == BFWG[i] then
				jl = jl + 5
				ice = ice + math.random(5)
			end
		end
		for i = 1, #BFWG2 do
			if wugong == BFWG2[i] then
				jl = jl + 20
				ice = ice + math.random(10)
			end		
		end
		if PersonGT(pid, 107) then
			jl = jl + 10
		end
		if PersonKF(pid, 124) then
			jl = jl + 15
		elseif PersonGT(pid, 124) then
			jl = jl + 30
		end
		if JY.Person[pid]["武器"] == 45 and yongdao(wugong) then
			jl = jl + 15
		end
		if WAR.JWYX == 1 then
			jl = jl + 30
		end
		if DT(pid, 48) and JX(pid) then
			jl = jl + 20
		end
		if wugong == 19 and (DT(pid, 18) or wglw1(pid,19)) then  --幻阴指冰封
			jl = jl + 30
		end 	
		if XYL(pid) and WAR.XYL == 4 then -- 豸苗：谢云流冰封
		    jl = 100
		end
		if (wglw(pid,107) and PersonGT(pid,107)) or DT(pid,599) then
			jl = 100
		end 	
		if wugong == 42 and ((DT(pid, 601) or DT(pid, 59)) or wglw1(pid,42)) then  --玉女剑法必冰封
			jl = 100
		end 	
		if wugong == 8 and ((DT(pid, 618) or DT(pid, 116)) or wglw1(pid,8)) then -- 天山六阳掌冰封
			jl = 100
		end 	
		if wugong == 133 and (DT(pid, 113) or wglw1(pid,133)) then --参合指冰封
			jl = 100
		end	
		if wugong == 26 and (DT(pid,49) or DT(pid,617)) then  --虚竹降龙掌冰封
			jl = 100
		end 	
		if MPPD(pid) == 18 and MPDJ(pid) >= 2 and PersonKF(pid,189) then --崆峒高级弟子
			jl = 100
		end	
		if JY.Person[pid]["武器"] == 38 then	--君子淑女
			jl = jl + 30
		end 	
		if wugong == 62 and (DT(pid,189) or wglw1(pid,62)) then  --夫妻刀法
			jl = 100
		end 
		if DT(pid,583) then
			jl = 100 
		end 	
		--华山拳系
		if (MPPD(pid) == 14 and PersonGT(pid,90) and JY.Person[pid]["拳掌功夫"] >= 200 and yongquan(wugong)) or ((DT(pid,54) or DT(pid,185) or DT(pid,188)) and yongquan(wugong)) then
            jl = 100
		end			
		if wugong == 128 then
		    jl = jl  + 50
			hot = hot + math.random(10)
		end
		
		if wugong == 9 then
			jl = jl + math.modf(JY.Person[pid]["内力"]/300)
		end
		
		if wugong == 176 and (DT(pid, 111) or wglw1(pid,176)) or DT(pid,618) then 
			jl = 100
		end
		if DT(pid, 600) then
		    jl = 100
		end

		if WAR.BHBM == 2 then -- 豸苗：童姥八荒八灭
		    jl = 100
		end
		if WAR.WYLW1 >0 then -- 恒山剑法领悟
		    jl = 100
			ice = ice + math.random(6,10)
		end
		if wglw(pid,107) or DT(pid,599) then --17-2-10
		    jl = 100
		end
		if hasTF(pid, 110) then
			jl = 100
		end
		if DT(pid, 643) or DT(pid, 644) then
			jl = 100
		end
		bfjl = jl
	end
  
	if hurt > 50 and DWPD() then
		local jl = 0
		
		if JY.Person[pid]["内力性质"] == 1 or JY.Person[pid]["内力性质"] == 3 then
			jl = jl + 15
		elseif JY.Person[pid]["内力性质"] == 2 then
			jl = jl + 10			
		end
		for i = 1, #ZSWG do
			if wugong == ZSWG[i] then
				jl = jl + 5
				hot = hot + math.random(5)
			end
		end
		for i = 1, #ZSWG2 do
			if wugong == ZSWG2[i] then
				jl = jl + 20
				hot = hot + math.random(10)
			end		
		end
		if PersonGT(pid, 106) then
			jl = jl + 10
		end
		if JY.Person[pid]["武器"] == 249 and yongdao(wugong) then
			jl = jl + 10
		end	
		if (wglw(pid,107) and PersonGT(pid,107)) or DT(pid,599) then
			jl = 100
		end	
		if XYL(pid) and WAR.XYL == 4 then -- 豸苗：谢云流灼烧
		    jl = 100
		end	
		if WAR.FLHS3 == 1 then --侵略如火
			jl = 100
		end 	
		if MPPD(pid) == 18 and MPDJ(pid) >= 2 and PersonKF(pid,189) then --崆峒高级弟子
			jl = 100
		end	
		if wugong == 39 and (DT(pid, 129) or wglw1(pid,39)) then  --全真剑法必灼烧
			jl = 100
		end 		
		if wugong == 8 and ((DT(pid, 618) or DT(pid, 116)) or wglw1(pid,8)) then -- 天山六阳掌灼烧
			jl = 100
		end 	
		if wugong == 133 and (DT(pid, 113) or wglw1(pid,133)) then --参合指灼烧
			jl = 100
		end	
		if wugong == 66 and ((DT(pid, 103) or DT(pid, 595)) or wglw1(pid,66)) then
			jl = 100 
		end	
		if wugong == 13 and wglw1(pid,13) then --铁掌领悟必灼烧
			jl = 100
		end	
		if (wglw1(pid,68) and wugong == 68) or (T9ZY(pid) and wugong == 112 and wglw1(pid,68)) then
			jl = 100
		end
		if wugong == 62 and (DT(pid,189) or wglw1(pid,62)) then  --夫妻刀法
			jl = 100
		end 
		if DT(pid,583) then
			jl = 100
		end 	
		if JY.Person[pid]["武器"] == 38 then	--君子淑女
			jl = jl + 30
		end 	
		--华山拳系
		if (MPPD(pid) == 14 and PersonGT(pid,90) and JY.Person[pid]["拳掌功夫"] >= 200 and yongquan(wugong)) or ((DT(pid,54) or DT(pid,185) or DT(pid,188)) and yongquan(wugong)) then
			jl = 100
		end 	
		if wugong == 176 and (DT(pid, 111) or wglw1(pid,176)) or DT(pid,618) then
			jl = 100
		end
        if wugong == 45 and (DT(pid, 592) or wglw1(pid, 45)) then	
			jl = 100
		end
        if wugong == 141 and (DT(pid, 585) or wglw1(pid,141)) then
			jl = 100
		end
        if WAR.JWDF > 0 then
			jl = 100
		end 	
		if WAR.ARJX > 0 then
			jl = 100
		end
		if WAR.BHBM == 1 then -- 豸苗：童姥八荒八灭
		    jl = 100
		end
	   if MPPD(pid) == 11 and WAR.JQ[pid] ~= nil and WAR.JQ[pid] > 3 then --剑势3
	      jl = 100
	   end
	   if wugong == 8 then
		    jl = jl  + 50
			hot = hot + math.random(10)
		end
	   if WAR.ARJX > 0 then 
			jl = 100
		end
		if WAR.WYLW3 >0 then -- 衡山剑法领悟
		    jl = 100
			hot = hot + math.random(6,10)
		end
		if WAR.JWYX == 2 then
			jl = jl + 30
		end
		if wglw(pid,106) or (DT(pid,9) and PersonGT(pid,106)) then --17-2-8
		    jl = 100
		end
		if WAR.YD>0 then
		    jl = 100
		end
		if T2SQ(pid) then 
			jl = 100
		end 	
		if DT(pid,80) and WAR.NSTJ1>0 then
		    jl = 100
		end
		
		if hasTF(pid, 111) then
			jl = 100
		end		
		zsjl = jl
	end	

	if bfjl == zsjl then
		if math.random(2) > 1 then bfjl = 0 else zsjl = 0 end
	end
	
	if bfjl > 0 and bfjl > zsjl then
		local jl = bfjl
		if (PersonKF(eid, 124) and not (DT(eid,48) and JX(eid)))  then --寒冰真气免疫冰封	
		elseif (wglw(eid,106) and not (DT(eid,48) and JX(eid))) or (DT(eid,9) and PersonGT(eid,106)) then --九阳领悟免疫冰封
		elseif (DT(eid, 618) or (wglw1(eid,8) and not (DT(eid,48) and JX(eid)))) then --六阳掌免疫冰封
		elseif DT(eid, 42) then
		elseif (DT(eid, 5) and PersonKF(eid,99)) then
		elseif wglw(eid, 99) then
		elseif wglw1(eid, 30) then
		elseif JLSD(10, 10 + jl, pid) or WAR.L_SSBD == 1 or WAR.QQSH == 1 or
			(wugong == 33 and PersonGTJL(pid, 124, WAR.NGJL)) then
			if inteam(eid) then
				ice = ice + math.modf(hurt / 15)
			else
				ice = ice + math.modf(hurt / 20)
			end
			if DT(pid, 22) then
				ice = math.modf(ice * 2)
			end
			if PersonGT(pid, 124) then
				ice = ice + 5
			end
			if JY.Person[eid]["防具"] == 63 then
				ice = ice - 5
			end
			if DT(pid, 48) and JX(pid) then
				ice = ice + 5
			end			
			if WAR.QQSH == 1 and DT(pid, 31) then
				ice = ice + 5
			end		
		    if wglw(pid,107) or DT(pid,599) then --17-2-10
                ice = ice*2
		    end
			if wugong == 9 then
			ice = ice + math.modf(JY.Person[pid]["内力"]/300)
		    end
			
			if wugong == 5 and WAR.ACT>1 then
			ice = ice + math.modf(JY.Person[pid]["内力"]/300)
		    end
			
			if not wglw(eid,106) or (DT(eid,9) and PersonKF(eid,106)) then --九阳领悟反弹冰封
				WAR.ICE[eid] = (WAR.ICE[eid] or 0) + ice
				if WAR.ICE[eid] > 50 then WAR.ICE[eid] = 50 end
				WAR.ICEXS[eid] = 1
			else
				WAR.ICE[pid] = (WAR.ICE[pid] or 0) + ice
				if WAR.ICE[pid] > 50 then WAR.ICE[pid] = 50 end
				WAR.ICEXS[pid] = 1
			end
			
			if not DT(eid, 661) then --武骧金星：雪儿反弹冰封
				WAR.ICE[eid] = (WAR.ICE[eid] or 0) + ice
				if WAR.ICE[eid] > 50 then WAR.ICE[eid] = 50 end
				WAR.ICEXS[eid] = 1
			else
				WAR.ICE[pid] = (WAR.ICE[pid] or 0) + ice
				if WAR.ICE[pid] > 50 then WAR.ICE[pid] = 50 end
				WAR.ICEXS[pid] = 1
			end
		end
	elseif zsjl > 0 and zsjl > bfjl then
		local jl = zsjl
		if DT(eid, 41) then
		elseif (DT(eid, 5) and PersonKF(eid,99)) then
		elseif wglw(eid, 99) then
		elseif wglw1(eid, 32)  then
		elseif JLSD(10, 10 + jl, pid) then
			if inteam(eid) then
				hot = hot + math.modf(hurt / 15)
			else
				hot = hot + math.modf(hurt / 20)
			end
			if PersonGT(pid, 152) then --天南易阳决灼烧增加
				hot = hot + 5
			end		
			if wugong == 66 and ((DT(pid, 103) or DT(pid, 595)) or wglw1(pid,66)) then --火焰刀增加灼烧
				hot = hot + 20
			end	
			if wugong == 8 and ((DT(pid, 618) or DT(pid, 116)) or wglw1(pid,618)) then  --天山六阳掌增加灼烧
				hot = hot + 10
			end	
			if wugong == 26 and ((DT(pid, 50) or DT(pid,617)) or wglw1(pid,26)) then	--降龙外劲增加灼烧
				hot = hot + 15
			end 	
			if wugong == 17 and (DT(pid, 65) or wglw1(pid,17)) then   --一阳指增加灼烧
				hot = hot + 15
			end 	
			if wugong == 86 and (DT(pid, 615) or wglw1(pid,86)) then	--伏魔杖法增加灼烧
				hot = hot + 15
			end 
			if wugong == 49 and (DT(pid, 53) or wglw1(pid,49)) then	--六脉神剑增加灼烧
				hot = hot + 20
			end 
			if wugong == 23 and ((DT(pid, 8) or DT(pid, 167) or DT(pid, 168)) or wglw1(pid,23) or DT(pid, 603)) then  --七伤拳增加灼烧
				hot = hot + 10
			end 	
			if DT(pid, 592) or wglw1(pid, 45) then	
			   hot = hot + 30
			end
			if WAR.ARJX > 0 then
				hot = hot + 25
			end		
			if WAR.FXHJ3 == 1 then
			    hot = hot + 30
			end 	
			if WAR.JWDF > 0 then
				hot = hot + 20
			end 	
			if WAR.XYHQ == 1 then
				hot = hot + 35
			end	
			if JY.Person[eid]["防具"] == 63 then
				hot = hot - 5
			end
			if pid == 0 and putong() == 2 then --剑神每练1剑灼烧+2
				hot = hot + 2
			end
		    if wglw(pid,106) or (DT(pid,9) and PersonGT(pid,106)) then --17-2-8
		    jl = hot*2
		    end
			if DT(pid,65) and WAR.YD>0 then
			    hot = hot + 5*(8-WAR.YD)
			end
			
		if DT(pid,80) and JX(pid) and WAR.NSTJ1>0 then
		    hot = hot + 5*WAR.NSTJ1
		end
			
			WAR.HOT[eid] = (WAR.HOT[eid] or 0) + hot
			if WAR.HOT[eid] > 50 then WAR.HOT[eid] = 50 end
			WAR.HOTXS[eid] = 1
		end		
	end
	
    if WAR.XLGJ == 2 or WAR.XLGJ == 4 or WAR.XLGJ == 5 then  --降龙柔劲灼烧
		WAR.HOTXS[eid] = 1
		WAR.HOT[eid] = (WAR.HOT[eid] or 0) + math.modf(hurt/20)
		if WAR.HOT[eid] > 30 then
			WAR.HOT[eid] = 30
		end
	end	
	
    if WAR.JWDF > 0 then --金乌刀法
		WAR.HOTXS[eid] = 1 	
		if WAR.HOTXS[eid] == nil then
		    WAR.HOTXS[eid] = 0
	    else
		    WAR.HOTXS[eid] = WAR.HOTXS[eid] + 25
	    end
	end	
	
	if(wglw1(pid,68) and wugong == 68) or (T9ZY(pid) and wugong == 112 and wglw1(pid,68)) then --杨家枪领悟
		WAR.HOTXS[eid] = 1 	
		if WAR.HOT[eid] == nil then
		    WAR.HOT[eid] = 0
	    else
		    WAR.HOT[eid] = WAR.HOT[eid] + 15
	    end
	end
	
    if WAR.XYHQ == 1 then
		WAR.HOTXS[eid] = 1 
		if WAR.HOT[eid] == nil then
			WAR.HOT[eid] = 1 
		else
		    WAR.HOT[eid] = WAR.HOT[eid] + 15
		end
	end				
	
	if MPPD(pid) == 13 and PersonGT(pid, 93) and WAR.HOTXS[eid] == nil then --沼跃鱼明教焚影圣诀灼烧
	    WAR.HOTXS[eid] = 1
	    WAR.HOT[eid] = (WAR.HOT[eid] or 0) + math.modf(hurt/60*MPDJ(pid))
	    if WAR.HOT[eid] > 50 then
		    WAR.HOT[eid] = 50
	    end
	end

	if MPPD(pid) == 15 and DT(pid, 602) then --大理阳炎
	    WAR.HOTXS[eid] = 1
	    WAR.HOT[eid] = (WAR.HOT[eid] or 0) + math.modf(hurt/60*MPDJ(pid))
	    if WAR.HOT[eid] > 50 then
		    WAR.HOT[eid] = 50
	    end
	end
	
    if DT(pid, 602) then
	    WAR.HOTXS[eid] = 1
	    WAR.HOT[eid] = (WAR.HOT[eid] or 0) + math.modf(hurt/60*MPDJ(pid))
	    if WAR.HOT[eid] > 50 then
		    WAR.HOT[eid] = 50
	    end
	end		
	
    if WAR.SBZ == 1 then 
	    WAR.HOTXS[eid] = 1
	    WAR.HOT[eid] = (WAR.HOT[eid] or 0) + math.modf(hurt/3)
	    if WAR.HOT[eid] > 50 then
		    WAR.HOT[eid] = 50
	    end
	end	
	
    if WAR.JWDF == 5 then
        hurt = math.modf(hurt + (sixi(pid,3)))
	    ang = math.modf(WAR.HOTXS[eid] * 10)
	    local a = math.modf(ang * 2)
	    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -a)
		WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "受伤程度", 35)
	    --JY.Person[eid]["受伤程度"] = JY.Person[eid]["受伤程度"] + 35 
		if JY.Person[eid]["受伤程度"] > 100 then 
			JY.Person[eid]["受伤程度"] = 100
        end
        WAR.HOT[eid] = (WAR.HOT[eid] or 0) + (a * 2)
	end 	

    if DT(pid,665) and yongdao(wugong) and JLSD(10,40,pid) then
        hurt = math.modf(hurt + (sixi(pid,3))) / 5
	    ang = math.modf(WAR.HOTXS[eid] * 10)
	    local a = math.modf(ang * 2)
	    WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -a)
		WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "受伤程度", 15)
	    --JY.Person[eid]["受伤程度"] = JY.Person[eid]["受伤程度"] + 15 
		if JY.Person[eid]["受伤程度"] > 100 then 
			JY.Person[eid]["受伤程度"] = 100
        end
        WAR.HOT[eid] = (WAR.HOT[eid] or 0) + (a * 2)
	end 

--麻痹值计算
	local MBWG = {9,202} 
	local mbjl = 0
	local mabi = 0
	if hurt > 50 and DWPD() then
		local jl = 0
		if JY.Person[pid]["内力性质"] > 2 then
			jl = jl + 15
		else
			jl = jl + 10
		end
		for i = 1, #MBWG do
			if wugong == MBWG[i] then
				jl = jl + 20
				mabi = mabi + math.random(10)
			end		
		end
		if wugong == 202 and DT(pid,84) then
			jl = 100
			mabi = mabi +10
		end
		if JLSD(10, 10 + jl, pid) then
			if inteam(eid) then
				mabi = mabi + math.modf(hurt / 15)
			else
				mabi = mabi + math.modf(hurt / 20)
			end
			WAR.MABI[eid] = (WAR.MABI[eid] or 0) + mabi
		end
		--WAR.MABI[eid] = (WAR.MABI[eid] or 0) + mabi
		if WAR.MABI[eid] ~= nil and WAR.MABI[eid] > 50 then
			WAR.MABI[eid] = 50
		end	
		WAR.MBXS[eid] = 1
	end
	
	--怒气值计算
	--蓝烟清：新逆运走火，不会暴气
  if WAR.L_NYZH[eid] == nil and 0 < JY.Person[eid]["生命"] and hurt > 0 and (WAR.LQZ[eid] == nil or WAR.LQZ[eid] < 100) and DWPD() and WAR.DZXY ~= 1 and WAR.ASKD ~= 1 and WAR.ASKD1 ~= 1 and WAR.LYBF<3 then
    --[[local minlqzj = math.modf((hurt) / 3 * 0.2 + 1)
    local lqzj = math.random(math.modf((hurt) / 3) + 1)
    if lqzj < minlqzj then
      lqzj = minlqzj
    end]]
	local m1 = math.modf(hurt / 20)
	local m2 = math.modf(hurt / 10)
    local lqzj  = math.random(m1, m2)
    --敌人难度下额外增加的怒气值
    if WAR.Person[emenyid]["我方"] == false then
        local flqzj = 0
        if JY.Thing[202][WZ7] == 1 then
            flqzj = math.random(2)
        elseif JY.Thing[202][WZ7] == 2 then
            flqzj = math.random(5)
    else
            flqzj = math.random(8)
        end
            lqzj = lqzj + flqzj;
    end
		
	if DT(pid, 72) then --田归农攻击时怒气上升-50%
		lqzj = math.modf(lqzj * 0.5)
	end
	
	if T7DFWM(eid) or (eid == 0 and putong() == 4) then --特系主角和东方未明每个特系+怒气5%
		local gctj = wgnumber(eid, 4)
		lqzj = math.modf(lqzj * (1 + 0.05 * gctj))
	end
	
	if WAR.DXYM == 1 and wglw(pid,153) then
		if WAR.LQZ[pid] == nil then
			WAR.LQZ[pid] = 10
		else
			WAR.LQZ[pid] = WAR.LQZ[pid] + 10
		end  
	    if WAR.LQZ[pid] >= 100 then 
		    WAR.LQZ[pid] = 100
		end 
	end	
	
	if WAR.ARJX > 0 then --黯然怒气增加
        lqzj = 0
		if WAR.LQZ[pid] == nil then
			WAR.LQZ[pid] = 25
		else
			WAR.LQZ[pid] = WAR.LQZ[pid] + 25
		end  
	    if WAR.LQZ[pid] >= 100 then 
		    JY.Person[pid]["受伤程度"] = 0
		end   
	else 
		lqzj = math.modf(lqzj * 0.3)
	end 	
	
	if (DT(eid, 5) or wglw1(eid, 16)) then --太极拳领悟怒气加100%
        lqzj = math.modf(lqzj * 2)   
	end		
	
	if (DT(eid, 592) or wglw(eid, 203)) then --怒海剑涛怒气加100%
        lqzj = math.modf(lqzj * 2)   
	end
	
    if wugong == 26 and (DT(pid, 55) or DT(pid,617)) then	--巨侠怒气
		lqzj = math.modf(lqzj * 2.5)
	end	
	
    if wugong == 86 and DT(pid, 457) then  --凡总自带
		WAR.YANGKANG = 1
		if WAR.LQZ[pid] == nil then
			WAR.LQZ[pid] = 30
		elseif WAR.LQZ[pid] > 70 and WAR.LQZ[pid] ~= 100 then
			WAR.LQZ[pid] = 99
		elseif WAR.LQZ[pid]  < 100 then
			WAR.LQZ[pid] = WAR.LQZ[pid] + 30
		end
		lqzj = math.modf(lqzj * 5)
		if WAR.Person[WAR.CurID][CC.TXWZ2] ~= nil then
			WAR.Person[WAR.CurID][CC.TXWZ2] = WAR.Person[WAR.CurID][CC.TXWZ2] .."+伏魔杖法・拨云见日"
		else
			WAR.Person[WAR.CurID][CC.TXWZ2] = "伏魔杖法・拨云见日"
		end
    end		
	
    if (DT(pid, 615) or wglw1(pid,86)) and JLSD(10, 40, pid) then
		WAR.YANGKANG = 1
		if WAR.LQZ[pid] == nil then
			WAR.LQZ[pid] = 30
		elseif WAR.LQZ[pid] > 70 and WAR.LQZ[pid] ~= 100 then
			WAR.LQZ[pid] = 99
		elseif WAR.LQZ[pid]  < 100 then
			WAR.LQZ[pid] = WAR.LQZ[pid] + 30
		end
		lqzj = math.modf(lqzj * 5)
		if WAR.Person[WAR.CurID][CC.TXWZ2] ~= nil then
			WAR.Person[WAR.CurID][CC.TXWZ2] = WAR.Person[WAR.CurID][CC.TXWZ2] .."+伏魔杖法・拨云见日"
		else
			WAR.Person[WAR.CurID][CC.TXWZ2] = "伏魔杖法・拨云见日"
		end
    end		
	
    if (NF(pid) and yongdao(wugong) and JLSD(10, 40, pid)) and juexing() > 0 then
		WAR.BZ[pid] = 2	
        if WAR.LQZ[pid] == nil then
			WAR.LQZ[pid] = 30
		elseif WAR.LQZ[pid] > 80 and WAR.LQZ[pid] ~= 100 then
			WAR.LQZ[pid] = 100
		elseif WAR.LQZ[pid]  < 100 then
			WAR.LQZ[pid] = WAR.LQZ[pid] + 20
		end
		lqzj = math.modf(lqzj * 3)	
		WAR.Person[WAR.CurID][CC.TXWZ2] = "桃之夭夭"
	end	

	if LYR(eid) then --林月如怒气上升+50%
		lqzj = math.modf(lqzj * 1.5)
	end
	
	if DT(eid, 640) or DT(eid, 641) then
		lqzj = math.modf(lqzj * 1.5)
	end
	
	if DT(eid, 161) then --李莫愁生命越低怒气越高
		lqzj = math.modf(lqzj * (1 + ((JY.Person[eid]["生命最大值"] - JY.Person[eid]["生命"]) / JY.Person[eid]["生命最大值"])))
	end
	
	if PersonGT(eid, 95) then --蛤蟆+怒气10%，主功体30%
		lqzj = math.modf(lqzj * 1.3)
	elseif PersonKF(eid, 95) then
		lqzj = math.modf(lqzj * 1.1)
	end
	
	if PersonGT(eid, 103) then --龙象主功体怒气+15%
		lqzj = math.modf(lqzj * 1.15)
	end
    
	if (DT(pid,615) or wglw1(pid,24)) and wugong == 24 then 
		lqzj = 0
	end
	
    if WAR.FQDS == 3 or WAR.FQDS == 6 then
		lqzj = 0 
		if WAR.LQZ[pid] == nil then
			WAR.LQZ[pid] = 5
		else 
		    WAR.LQZ[pid] = WAR.LQZ[pid] + 5
		end		
	end 	
	
	if (PersonGT(pid, 102) and wglw(pid,102)) or (DT(pid,38) and PersonKF(pid,102)) or (T5BCF(pid) and juexing()>0) then --太玄怒气增加值减少
	    if (WAR.TXTX == 3 or WAR.TXTX == 6) then 
            lqzj = 0
		    if WAR.LQZ[pid] == nil then
			   WAR.LQZ[pid] = 25
		    else
			   WAR.LQZ[pid] = WAR.LQZ[pid] + 25
		    end  
		else 
		lqzj = math.modf(lqzj * 0.3)
		end
	elseif PersonKF(pid, 102) then 
		lqzj = math.modf(lqzj * 0.6)
	end
	
	if pid == 0 and putong() == 3 and  WAR.ASKD == 1 then
		if WAR.LQZ[pid] == nil then
		   WAR.LQZ[pid] = 25
		else
		   WAR.LQZ[pid] = WAR.LQZ[pid] + 25
		end 
		--[[if WAR.LQZ[pid] ~= nil  and WAR.LQZ[pid] >= 100 then
		DHdisplay(1694, 1705, "怒气爆发")
		end]]
	end
	
	if DT(pid, 7) then 
		lqzj = math.modf(lqzj * 0.5)
	end		
	
	if DT3(eid, 54) then --袁承志虎乱怒气上升增加50%
		if WAR.YCZHL[eid] ~= nil and WAR.YCZHL[eid] > 0 then
			lqzj = math.modf(lqzj * 1.5)
		end
	end

	if DT(eid, 582) then --武骧金星：木婉清特效
		if JY.Person[pid]["性别"] ~= JY.Person[eid]["性别"] then
			lqzj = lqzj * 2
		end		
	end

	if T11CJR(eid) then lqzj = lqzj * 2 end
	
    if NF(eid) then lqzj = lqzj * 2 end	
	
	if WAR.SJHB[pid] == 3 then
		lqzj = 0
	end	
	
	if (DT(eid,59) and PersonKF(eid,121)) or wglw(eid,121) or (DT(eid,601)) then --17-3-3-玉女经
	   lqzj = 0
	end
	if DT(pid, 70) then --玄慈无怒气
	   lqzj = 0
	end
	
	if DT(eid,50) then --沼跃鱼：萧峰天恩特性，怒气上升减缓
		lqzj = math.modf(lqzj * 0.7)
	end
	
	if JX(eid) and not DT(eid,50) then --沼跃鱼：觉醒角色怒气上升(萧峰除外)
		lqzj = math.modf(lqzj * 1.1)
	end
	
	if ZYBF(eid) and not DT(eid,50) then --沼跃鱼：战意勃发怒气上升(萧峰除外)
		lqzj = math.modf(lqzj * 1.3)
	end
	
	if DT(eid, 70) then
		lqzj = 0
	end	
	
	if hasTF(eid, 32) then
		if JY.Person[pid]["性别"] ~= JY.Person[eid]["性别"] then
			lqzj = 0
		end	
	end	
	
	if WAR.PEACE[eid] ~= nil and WAR.PEACE[eid] > 0 then
		lqzj = 0
	end
	
	if wugong==15 then
		lqzj = 0
	end
	
    if WAR.LGQJ[eid] ~= nil and WAR.LGQJ[eid] > 0 then --谢无悠
		lqzj = 0
	end
	if DT(pid, 131) then
		lqzj = 0
	end
	if wglw1(pid,58) then
	    local aa = lqzj
		if aa < 20 then aa = aa*2 end
		aa=aa+5*math.random(1,2)
		WAR.LQZ[eid]=WAR.LQZ[eid] or 0 - aa
	    if WAR.LQZ[eid]<=0 then
			WAR.LQZ[eid]=nil
		end
		WAR.LQZ[pid] = (WAR.LQZ[pid] or 0)+aa
		--[[if WAR.LQZ[pid] ~= nil and WAR.LQZ[pid]>100 then
			WAR.LQZ[pid] = 100
			DHdisplay(2664, 2680, "雄霸天下.阿鼻三刀")
		end]]
		lqzj = 0
	elseif DT(pid, 114) and WAR.HQWX2 == 2 then --豸苗：扫地杀怒气--17-2-9
		if WAR.LQZ[eid] ~= nil then
			WAR.LQZ[eid] = WAR.LQZ[eid] - lqzj*3
		end	
		if WAR.GTNUQI ~= 0 then --功体杀怒气
			if WAR.LQZ[eid] ~= nil then
				WAR.LQZ[eid] = WAR.LQZ[eid] - WAR.GTNUQI
			end
		end
    elseif DT(pid, 64) and WAR.KMWD>=1 then--空明武道不涨怒气
	    if WAR.LQZ[eid] ~= nil then
			WAR.LQZ[eid] = WAR.LQZ[eid]
		end	
		if WAR.GTNUQI ~= 0 then --功体杀怒气
			if WAR.LQZ[eid] ~= nil then
				WAR.LQZ[eid] = WAR.LQZ[eid] - WAR.GTNUQI
			end
		end
	elseif MPPD(pid)==3 and PersonGTJL(pid, 121, WAR.NGJL) then--古墓清心诀不涨怒气
	    if WAR.LQZ[eid] ~= nil then
			WAR.LQZ[eid] = WAR.LQZ[eid]
		end	
		if WAR.GTNUQI ~= 0 then --功体杀怒气
			if WAR.LQZ[eid] ~= nil then
				WAR.LQZ[eid] = WAR.LQZ[eid] - WAR.GTNUQI
			end
        end
	elseif WAR.GTNUQI ~= 0 then --功体杀怒气
		if WAR.LQZ[eid] ~= nil then
			WAR.LQZ[eid] = WAR.LQZ[eid] - WAR.GTNUQI
		end
	else
		if WAR.LQZ[eid] == nil then
			WAR.LQZ[eid] = lqzj 
		else
			WAR.LQZ[eid] = WAR.LQZ[eid] + lqzj 
		end
	end
	
    if (WAR.NYZJ[eid] ~= nil or DT(eid, 60) or DT(eid, 620)) and JLSD(0,30,eid) then
	   WAR.LQZ[eid] = 100
	end 

	if T6XQS(pid) and WAR.XQS == 1 then --萧秋水水逝杀怒气
		if WAR.LQZ[eid] ~= nil then
			WAR.LQZ[eid] = WAR.LQZ[eid] - lqzj
		end	
		if WAR.GTNUQI ~= 0 then --功体杀怒气
			if WAR.LQZ[eid] ~= nil then
				WAR.LQZ[eid] = WAR.LQZ[eid] - WAR.GTNUQI
			end
		end  
	
	--[[elseif PersonGTJL(pid, 102, WAR.L_SGJL) then --太玄主功体加力杀怒气
		if WAR.LQZ[eid] ~= nil then
			WAR.LQZ[eid] = WAR.LQZ[eid] - math.modf(lqzj/2)
		end	
		if WAR.GTNUQI ~= 0 then --功体杀怒气
			if WAR.LQZ[eid] ~= nil then
				WAR.LQZ[eid] = WAR.LQZ[eid] - WAR.GTNUQI
			end
		end			]]
    elseif 	T6XQS(pid) and WAR.XQS == 8	then
	    if WAR.LQZ[eid] ~= nil then
	        local aa= WAR.LQZ[eid]
	        local bb=AddPersonAttrib(eid, "生命", -aa)
	        WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) +bb
	        local cc=AddPersonAttrib(eid, "内力", -aa*10)
	        WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) +cc
			WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "受伤程度", -bb-cc)
		    WAR.LQZ[eid] = 0
	    end
	elseif WAR.GTNUQI ~= 0 then --功体杀怒气
		if WAR.LQZ[eid] ~= nil then
			WAR.LQZ[eid] = WAR.LQZ[eid] - WAR.GTNUQI
		end
	else
		if WAR.LQZ[eid] == nil then
			WAR.LQZ[eid] = lqzj 
		else
			WAR.LQZ[eid] = WAR.LQZ[eid] + lqzj 
		end
	end

    if DT(pid, 662) then
		if WAR.LQZ[eid] ~= nil then
			WAR.LQZ[eid] = WAR.LQZ[eid] - lqzj
		end	
	end 	

	for j = 0, WAR.PersonNum - 1 do 
		if wglw1(WAR.Person[j]["人物编号"], 57) and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~=  WAR.Person[emenyid]["我方"] then
		  	WAR.LQZ[eid] = nil
		end
	end
	 
	if WAR.LQZ[eid] ~= nil and WAR.LQZ[eid] <= 0 then
	  	WAR.LQZ[eid] = nil;
	end	
	
    --怒气暴发
	if WAR.LQZ[eid] ~= nil and 100 < WAR.LQZ[eid] then
	    WAR.LQZ[eid] = 100
	    WAR.Person[emenyid][CC.TXDH] = 6
	    if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
	        WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. CC.WARS117
	    else
	    	WAR.Person[emenyid][CC.TXWZ3] = CC.WARS118
	  	end
		if hasTF(eid, 44) then
			JY.Person[eid]["受伤程度"] = 0
		end
		if WAR.ARJX == 5 then
			JY.Person[pid]["受伤程度"] = 0
		end
		if eid == 0 and putong() == 3 and juexing() > 0 then
			DHdisplay(1694, 1705, "狂刀一怒・血杀千里")
		end
		if wglw1(eid,58) and WAR.XLEB ==0 then
		    local s= WAR.CurID 
		    WAR.CurID = emenyid
		    DHdisplay(2664, 2680, "雄霸天下・阿鼻三刀")
            WAR.XLEB = math.random(1,3)
		    WAR.CurID = s
		end	
		if WAR.LFCG[eid]~=nil and WAR.LFCG[eid]>0 then
			JY.Person[eid]["受伤程度"] = 100
		    local aa=JY.Person[eid]["内力"]
		    local bb=JY.Person[eid]["生命"]
	        WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -math.modf(aa * 0.01*WAR.LFCG[eid]))
		    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -math.modf(bb * 0.01*WAR.LFCG[eid]))
		    WAR.LFCG[eid]=nil
		end
		if DT(eid, 50) and JY.Person[eid]["生命"] > 0 then --武骧金星：萧峰被激怒后会立即出手
			WAR.Person[emenyid].Time = 999
			JY.Person[eid]["中毒程度"] = 0
			JY.Person[eid]["受伤程度"] = 0	
			WAR.FXDS[eid] = nil
			WAR.LXZT[eid] = nil
			WAR.CHZ[eid] = nil
            local aa=JY.Person[eid]["生命最大值"]			
	        WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", math.modf(aa * 0.3))
		end
    end
	 -- 豸苗：太玄主动怒气暴发
	if WAR.LQZ[pid] ~= nil and 100 < WAR.LQZ[pid] then
	    WAR.LQZ[pid] = 100
		WAR.ZDNQ[pid] = 1
	    WAR.Person[WAR.CurID][CC.TXDH] = 6
	end 
	
	if ZYJ(eid) then--沼跃鱼：战意技下的怒气爆发
	    local str=".战技"
	    if DT(eid,1) then
	        str=".绝刀"
	    end
	    if DT(eid,51) then
	        str=".修罗无间"
	    end
	    if (DT(eid,103) or DT(eid,595)) and WAR.CHD==0 then
	        str=".明王残火刀"
	        WAR.CHD = 5
	    end
	    if DT(eid,50) then
	        str=".天缚苍龙诀"
	    end
	    if T13TQS(eid) then
	        str=".兽血沸腾"
	    end
	    if T8LXY(eid) then
	        str=".蜀山剑神"
	    end
		    WAR.Person[emenyid][CC.TXDH] = 6
	    if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
	        WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. str
	    else
	        WAR.Person[emenyid][CC.TXWZ3] = CC.WARS118..str
	  	end
	end
	
		if DT(eid, 585) then --武骧金星：小二特殊判定
		WAR.Person[emenyid].Time = 999 
		WAR.ACT = 10 end 
    end
    
    if T9ZY(eid) and juexing() >= 3 and WAR.ZYWS == 0 then --赵云无双
	    if JY.Person[eid]["生命"] < math.modf(JY.Person[eid]["生命最大值"] * 0.5) then
	        WAR.Person[emenyid][CC.TXDH] = 110
	        if WAR.Person[emenyid][CC.TXWZ3] ~= nil then
	            WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3] .. "+无双觉醒"
	        else
	    	    WAR.Person[emenyid][CC.TXWZ3] = "无双觉醒"
	  	    end		
		    WAR.ZYWS = 1
	        --WAR.ZYWSPD = 1
		    WAR.LQZ[eid] = 100
		    WAR.FXDS[eid] = nil
		    WAR.LXZT[eid] = nil
		    WAR.CHZ[eid] = nil
		    JY.Person[eid]["受伤程度"] = 0
		    JY.Person[eid]["中毒程度"] = 0
	    end
    end
    
    if WAR.ASKD == 1 and DWPD() then
        if WAR.LQZ[eid] == nil then
		    WAR.LQZ[eid] = 0
	    else
		    WAR.LQZ[eid] = math.modf(WAR.LQZ[eid] * 0.5)
	    end
    end
  
    if WAR.ASKD1 == 1 and DWPD() then
        if WAR.LQZ[eid] == nil then
		    WAR.LQZ[eid] = 0
	    else
		    WAR.LQZ[eid] = math.modf(WAR.LQZ[eid] * 0.5)
	    end
    end
  
    if WAR.LYBF==3 and DWPD() then
        if WAR.LQZ[eid] == nil then
		    WAR.LQZ[eid] = 0
	    else
		    WAR.LQZ[eid] = math.modf(WAR.LQZ[eid] * 0.5)
	    end
    end	
  
  	if jtyl(pid) and (WAR.JTYL == 6 or WAR.JTYL == 9) and DWPD() then --谢无悠
	   WAR.LQZ[eid] = 0
	end
    --[[
    --血刀老祖 魅惑，减少为10%
    if pid == 97 and math.random(10) <= 1 and WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
       WAR.Person[emenyid]["我方"] = WAR.Person[WAR.CurID]["我方"]
    end]]
  
    --成不忧 被令狐冲 秒杀
    if WAR.ZDDH == 205 and eid == 141 then
  	   WAR.Person[emenyid]["生命点数"] = -JY.Person[eid]["生命"];
       JY.Person[eid]["生命"] = 0
    end
  
    --武无敌秒欢总
    if pid == 600 and eid == 455 then
  	   WAR.Person[emenyid]["生命点数"] = -JY.Person[eid]["生命"];
       JY.Person[eid]["生命"] = 0
	   say("好好好！", 600) 
	   say("多谢师父承让！", 455)   
	   say("你能将葵花宝典中的武学融合到十强武道中创出一片天地，为师很欣慰。", 600) 
	   say("徒儿今日得师傅指导又有了新的认知！", 455) 
	   say("你就继续锄强扶弱，造福武林吧！", 600) 
	   say("徒儿明白！", 455)
    end

    if WAR.ZDDH == 299 then --射雕比赛
	    if eid == 608 and  JY.Person[eid]["生命"] <= 0 then
		    if pid == zj() then
			    RW.type = 1
		    elseif pid == 55 then
			    RW.type = 2
			    JY.Person[55]["武功4"] = 148
	            JY.Person[55]["武功等级4"] = 999
			    setJX(55,1)
	    else
			RW.type = 3
		    end
	    end
    end
    
    --游坦之 上毒
    if DT(pid, 48) and WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
        local d = math.modf((340 - JY.Person[eid]["抗毒能力"] - JY.Person[eid]["内力"] / 50) / 4)
        if d < 0 then
            d = 0
        end
        WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", d);
    end

    if pid == 0 and putong() == 8 and DWPD() then
        local d = math.modf((JY.Person[pid]["实战"] - JY.Person[eid]["抗毒能力"] - JY.Person[eid]["内力"] / 50) / 5)
        if d < 0 then
            d = 0
        end
        WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", d);
    end
  
    if wugong == 3 and DWPD() then
        local d = math.modf((JY.Person[pid]["用毒能力"] - JY.Person[eid]["抗毒能力"]- JY.Person[eid]["内力"] / 50 ) / 5)
        if d < 0 then
            d = 0
        end
        WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", d);
    end
  
    if wugong == 126 and WAR.ACT>1 and  DWPD() then
        local d = math.modf((JY.Person[pid]["用毒能力"] - JY.Person[eid]["抗毒能力"]- JY.Person[eid]["内力"] / 50 ) / 5)
        if d < 0 then
            d = 0
        end
        WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", d);
    end
  
    if WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and
	    ((JY.Person[pid]["武器"] == 244 and yongquan(wugong)) or 
	    (JY.Person[pid]["武器"] == 46 and yongdao(wugong)) or 
	    (JY.Person[pid]["武器"] == 252 and yongte(wugong))) then --金蜈钩和绿刀和蛇杖上毒2-5
	    WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", 2+math.random(3));
    end
  
    --铁掌，龙象加力造成固定内伤10-15点
    if wugong == 13 and PersonGTJL(pid, 103, WAR.NGJL) and
	    WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
  	    WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "受伤程度", 10 + math.random(5));
    end
  
    --太极神功加力内伤20-25点
	if PersonGTJL(pid,182,WAR.NGJL) and WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
  	    WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "受伤程度", 20 + math.random(5));
	end 	

    if wugong == 23 and WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then --七伤拳强上内伤
	    local d = math.modf((JY.Person[pid]["内力"] - JY.Person[eid]["内力"]) / 150)
        if d < 0 then
            d = 0
        end
  	    WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "受伤程度", d);
    end
  
  	if WAR.YFDLW == 3 and WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then --阴风刀领悟强上内伤
	    local d = WAR.ICE[eid] or 0
        if d < 0 then
            d = 0
        end
  	    WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "受伤程度", d*0.5);
		if WAR.YHZJ[eid]~=nil and WAR.YHZJ[eid]>0 then
		WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "受伤程度", d)
		end
    end
  
  
    --密宗
    if MPPD(eid) == 6 and WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
        local mpdj = MPDJ(eid)*5
  	    WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "受伤程度", -(mpdj));
    end
  
    --少林不动明王，金刚不坏神功加力时大金刚掌造成内伤
    if (wugong == 22 and PersonGTJL(pid, 151, WAR.NGJL) and MPPD(pid) == 5 and MPDJ(pid) > 1) or (DT(pid,615) and JLSD(20,50,pid)) and
	    WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
	    local d = math.modf((JY.Person[pid]["内力"] - JY.Person[eid]["内力"]) / 300)
        if d < 0 then
            d = 0
        end
  	    WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "受伤程度", 5*MPDJ(pid) + d);
	    if JLSD(20,50,pid) then
	        WAR.CYSH[eid] = d+10*MPDJ(pid);
	    end
	    local SN=JY.Person[eid]["受伤程度"]*5
	    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -SN);
	    if WAR.Person[emenyid][CC.TXWZ2] == nil then
		    WAR.Person[emenyid][CC.TXWZ2] = "不动明王.金刚般若掌"
	    else
		    WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .."不动明王.金刚般若掌"
	    end	
    end
  
    if T13TQS(pid) and WAR.TQS==5 and
	   WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
  	   WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) +  AddPersonAttrib(eid, "受伤程度", 10 + WAR.SWHH);
    end
  
    if wssz(pid) and WAR.TQS==5 and
	    WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
  	    WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) +  AddPersonAttrib(eid, "受伤程度", 10 + WAR.SWHH1);
    end
  
    if T13TQS(pid) and WAR.TQS==1 and
	    WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
  	    WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", 10 + WAR.SWHH);
    end
  
    if wssz(pid) and WAR.TQS==1 and
	    WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
  	    WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", 10 + WAR.SWHH1);
    end
  
    --玄冥，逆运加力时造成内伤和无视上毒10点
    if wugong == 21 and PersonGTJL(pid, 104, WAR.NGJL) and
	    WAR.Person[emenyid]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
  	    WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "受伤程度", 5);
  	    WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", 10);
    end
	
	--奥义 小人物的愤怒
	if WAR.XRWDFN == 2 then
		WAR.SZWH[eid]=WAR.SZWH[eid] or 5
		WAR.ATKDOWN[eid]=WAR.ATKDOWN[eid] or 20
		WAR.DEFDOWN[eid]=WAR.DEFDOWN[eid] or 20
		WAR.SPDDOWN[eid]=WAR.SPDDOWN[eid] or 20
	end
    
    --乾坤反弹伤害
    if eid == -1 then
	    local x, y = nil, nil
	    while true do
		x = math.random(63)
	    y = math.random(63)
		if not SceneCanPass(x, y) or GetWarMap(x, y, 2) < 0 then
		    SetWarMap(WAR.Person[emenyid]["坐标X"], WAR.Person[emenyid]["坐标Y"], 2, -1)
		    SetWarMap(WAR.Person[emenyid]["坐标X"], WAR.Person[emenyid]["坐标Y"], 5, -1)
		    WAR.Person[emenyid]["坐标X"] = x
		    WAR.Person[emenyid]["坐标Y"] = y
		    SetWarMap(WAR.Person[emenyid]["坐标X"], WAR.Person[emenyid]["坐标Y"], 2, emenyid)
		    SetWarMap(WAR.Person[emenyid]["坐标X"], WAR.Person[emenyid]["坐标Y"], 5, WAR.Person[emenyid]["贴图"])
		    break;
		end
	    end
    end

    --判断是否可以加实战
    --敌方也加实战
    if JY.Person[eid]["生命"] <= 0 and DWPD() then --and WAR.SZJPYX[eid] == nil then
    
    --崆峒派战斗、高升客栈杀欧阳克、家里练功房、全真教练功、青城派练功、少林练功   不加实战
    local wxzd = {17, 67, 226, 220, 224, 219, 79, 102}
    local wx = 0
    for i = 1, #wxzd do
        if WAR.ZDDH == wxzd[i] then
            wx = 1
		    break
        end
    end
    
    --丐帮门口
    if WAR.ZDDH == 82 and GetS(10, 0, 18, 0) == 1 then
      wx = 1
    end
    --木人巷
    if WAR.ZDDH == 214 and GetS(10, 0, 19, 0) == 1 then
      wx = 1
    end
    
	if WAR.ZDDH == 276 or WAR.ZDDH == 279 or WAR.ZDDH == 281 then
		wx = 1
	end
	if WAR.ZDDH == 20 and JY.SubScene == 25 and CC.fight == 1 then
		wx = 1
	end
    --如果可加实战
    if wx == 0 then
		local szexp = 1
		if JY.Person[eid]["排行"] > 2 then
			szexp = (JY.Person[eid]["排行"] - 1) * (JY.Person[eid]["排行"] - 1)
		end
		--[[if eid < 191 and 0 < eid then
			szexp = math.modf(WARSZJY[eid]) 
		end]]
		AddPersonAttrib(pid, "实战", szexp)
		if T3XYK(pid) and WAR.JUNSHEN > 0 then
			AddPersonAttrib(pid, "实战", szexp)
		end
		if hasTF(pid, 156) then
			AddPersonAttrib(pid, "实战", 15)
		end 	
		if T11CJR(pid) then
			AddPersonAttrib(pid, "实战", math.max(1, math.modf(szexp * (JY.Person[pid]["生命最大值"] - JY.Person[pid]["生命"]) / JY.Person[pid]["生命最大值"])))
			AddPersonAttrib(pid, "实战", math.max(1, math.modf(szexp * (JY.Person[pid]["内力最大值"] - JY.Person[pid]["内力"]) / JY.Person[pid]["内力最大值"])))
			AddPersonAttrib(pid, "实战", math.max(1, math.modf(szexp * (100 - JY.Person[pid]["体力"]) / 100)))
		end
		if not duiyou(pid) then
			AddPersonAttrib(pid, "实战", limitX(szexp * 5, 1, 50))
		end
		--WAR.SZJPYX[eid] = 1
	end
    end
  
    if JY.Person[eid]["生命"] <= 0 and DWPD() then --击败敌人战意增长
	    if WAR.Person[WAR.CurID]["我方"] then
		    zhanyi(pid, (4 * (1 + WAR.MYCHAIN / 30)))
	    else
		    zhanyi(pid, (5 * (1 + WAR.MYCHAIN / 30)))
	    end
    end
  
    --平一指杀人
    if JY.Person[eid]["生命"] <= 0 and DWPD() and DT(pid, 28) then
        WAR.PYZ = WAR.PYZ + 1
    end
	
    if 5 < WAR.PYZ then
        WAR.PYZ = 5
    end
  
    if JY.Person[eid]["生命"] <= 0 and DWPD() then
	    if MPPD(pid) == 6 and MZ(pid)== 2 then --血祭
		    if WAR.XJ[pid] == nil then
			    WAR.XJ[pid] = 1
		    else
			    WAR.XJ[pid] = WAR.XJ[pid] + 1
		   end
	end
	
	if hasTF(pid, 61) then
		if WAR.CLXL[pid] == nil then
			WAR.CLXL[pid] = 1
		else
			WAR.CLXL[pid] = WAR.CLXL[pid] + 1
		end 
	end
    end
  
    --北冥神功和吸星大法，加内力上限
    if (WAR.BMXH == 1 or WAR.BMXH == 2 or WAR.BMXH == 4) and 0 < hurt and DWPD() then
	   if PersonKF(eid, 124) and JY.Person[pid]["内力性质"] ~= 2 then
		  SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 4, 2)	
		  WAR.ICEXS[pid] = 1
		  WAR.ICE[pid] = (WAR.ICE[pid] or 0) + math.random(5, 15)

       elseif (PersonGTHT(eid,108,WAR.NGHT) and wglw(eid,108)) or DT(eid, 615) then
	
	else
		local xnl = nil
		if WAR.BMXH == 1 then
		    if (wglw(pid,85) or DT(pid,118) or T1LEQ(pid)) and WAR.BMXS == 1 then
			local a = math.modf(JY.Person[eid]["内力最大值"] *0.02)
			xnl = math.modf(JY.Person[eid]["内力"] / 13 + math.random(10)) + a
			else
			xnl = math.modf(JY.Person[eid]["内力"] / 13 + math.random(10))
			end
		elseif WAR.BMXH == 2 then--日月神教
		    if (MPPD(pid) == 12 and GetS(54,0,0,1) == 1 and MPDJ(pid) >= 3) or DT(pid,617) then 
			xnl = math.modf(JY.Person[eid]["内力"] / 15 + math.random(10))
			else
			xnl = math.modf(JY.Person[eid]["内力"] / 20 + math.random(10))
			end
		elseif WAR.BMXH == 4 then --龙鳞碎牙
			xnl = math.modf(JY.Person[eid]["内力"] / 20 + math.random(10))
		end
		if wglw(eid,101) or (DT(eid,117) and PersonKF(eid,101)) then	--唯我独尊--17-2-27
		   WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", -math.modf(xnl/2 + 1))
		end
		if BJY(eid) and juexing() > 2 then
		   WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", -math.modf(xnl/2 + 1))
		end
	if JY.Person[pid]["生命"] <= 0 then		--弹不死
      	JY.Person[pid]["生命"] = 1;
		WAR.FXXS[pid]=1 
		WAR.FXDS[pid]=50 
	end
		WAR.Person[emenyid]["内力点数"] = (WAR.Person[emenyid]["内力点数"] or 0) + AddPersonAttrib(eid, "内力", -xnl);
		WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", math.modf(xnl + 1))
		if inteam(pid) then AddPersonAttrib(pid, "内力最大值", math.modf(xnl * 2 / 3 + 10)) end
	end 
    end
  
    if WAR.QX1[pid] == 1 then --17-3-3-玉女经
        if WAR.LQZ[pid] ~= nil and WAR.LQZ[pid] > 0 then 
			if WAR.TZQJ13 == nil or WAR.DWRY == 1 then
			else	
				local a = math.modf(WAR.LQZ[pid]*1.5)
				WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", -a)
				if JY.Person[pid]["生命"] <= 0 then		--弹不死
				   JY.Person[pid]["生命"] = 1;
				   WAR.FXXS[pid]=1 
				   WAR.FXDS[pid]=50 
				end
			end		
	    end
    end   
	
    --水镜四奇 云体风身 洗武功
    if 100 < WAR.YTFS and ((T2SQ(eid) and juexing() > 2) or DT(eid, 662)) then
        WAR.Person[emenyid][CC.TXDH] = 6
        if WAR.Person[emenyid][CC.TXWZ1] ~= nil then
            WAR.Person[emenyid][CC.TXWZ1] = WAR.Person[emenyid][CC.TXWZ1] .. CC.WARS119
        else
            WAR.Person[emenyid][CC.TXWZ1] = CC.WARS120
        end
        WAR.YTFS = -1
	    if T2SQ(eid) then
		    WAR.YT1 = JY.Person[0]["武功2"]
		    WAR.YT2 = JY.Person[0]["武功等级2"]
		    JY.Person[0]["武功2"] = wugong
		    JY.Person[0]["武功等级2"] = 999
	    end
    end
  
    --化功大法
    if (wglw(eid,87) or (DT(eid,46) and PersonKF(eid,87))) and 0 < hurt and DWPD() and JLSD(0,40,eid) then 
       if WAR.HGDF[pid] == nil then  
	      WAR.HGDF[pid] = 0 
	   end
          WAR.HGDF[pid] = WAR.HGDF[pid] + 30
	   if WAR.Person[emenyid][CC.TXDH] == -1 then
          WAR.Person[emenyid][CC.TXDH] = math.fmod(87, 10) + 85
       end
       if WAR.Person[emenyid][CC.TXWZ2] == nil then
          WAR.Person[emenyid][CC.TXWZ2] = CC.WARS35
       else
          WAR.Person[emenyid][CC.TXWZ2] = WAR.Person[emenyid][CC.TXWZ2] .. "+" .. CC.WARS35
       end
    end
  
    --化功大法 上毒 减内力
    if WAR.BMXH == 3 and 0 < hurt and DWPD() then
       local xnl = nil
       xnl = math.modf(JY.Person[eid]["内力"] / 20 + math.random(10))
	   if wglw(eid,87) or (DT(eid,46) and PersonKF(eid,87)) then 
	      local xnl1 = JY.Person[eid]["中毒程度"]*3
          xnl = xnl + xnl1
	   end
          WAR.Person[emenyid]["内力点数"] = AddPersonAttrib(eid, "内力", -xnl);
	   if wglw(pid,87) or (DT(pid,46) and PersonKF(pid,87)) then 
          WAR.Person[emenyid]["中毒点数"] = AddPersonAttrib(eid, "中毒程度", 5 + math.random(15))
	   else
	      WAR.Person[emenyid]["中毒点数"] = AddPersonAttrib(eid, "中毒程度", 15 + math.random(15))
	   end
    end
  
    if T7DFWM(pid) and WAR.DZXY == 1 and yongan(wugong) and juexing()>1 then --东方未明暗系反击特效
	   local xishu2=math.modf(sixi(pid,5) * 0.2)
	   WAR.Person[emenyid]["中毒点数"] = AddPersonAttrib(eid, "中毒程度", xishu2)
	end	 
  
    --吸星大法 吸体力
    if WAR.BMXH == 2 and 0 < hurt and DWPD() then
       local xt1 = Rnd(2) + 3
       local xt2 = Rnd(4) + 1
	   local xt4 = 3 + Rnd(3)
       local xt3 = 2 + Rnd(3)
	   local xt5 = math.modf((JY.Person[eid]["生命最大值"]-JY.Person[eid]["生命"])/5)
       local n = AddPersonAttrib(eid, "体力", -xt1)
       local m = AddPersonAttrib(pid, "体力", xt3)
    
    --任我行 额外吸体力
    if DT(pid, 26) then
    	n = n + AddPersonAttrib(eid, "体力", -xt2)
    	m = m + AddPersonAttrib(pid, "体力", xt2)
	end	 
	--虚竹降龙掌吸体力
    if wugong == 26 and (DT(pid,49) or DT(pid,617)) then
		n = n + AddPersonAttrib(eid, "体力", -10)
    	m = m + AddPersonAttrib(pid, "体力", 10)
	end	 	
	--日月神教
	if GetS(54,0,0,1) == 1 and MPDJ(pid) >= 3 and MPPD(pid) == 12 then
    	n = n + AddPersonAttrib(eid, "体力", -xt4)
    	m = m + AddPersonAttrib(pid, "体力", xt4)
  	end
    --北冥领悟
	if wglw(pid,85) or (DT(pid,116) or DT(pid,118) or DT(pid,618)) then
		n = n + AddPersonAttrib(eid, "体力", -13)
    	m = m + AddPersonAttrib(pid, "体力", 13)
	end	
  	if wglw(pid,88) or (DT(pid,26) or DT(pid,617)) then--吸星大法领悟
	   if WAR.LXZT[eid] ~= nil then 
	   --AddPersonAttrib(eid, "生命", -(xt5+WAR.LXZT[eid])*2)
	   WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -(xt5+(WAR.LXZT[eid])*2))
	   else
	   --AddPersonAttrib(eid, "生命", -xt5)
	   WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) + AddPersonAttrib(eid, "生命", -xt5)
	   end
	end
  	WAR.Person[emenyid]["体力点数"] = (WAR.Person[emenyid]["体力点数"] or 0) + n;
  	WAR.Person[WAR.CurID]["体力点数"] = (WAR.Person[WAR.CurID]["体力点数"] or 0) + m;
    end
  
    if WAR.SJHB[pid] == 3 and DWPD() then
	   local n = 1 + math.random(10)
	   local n2 = AddPersonAttrib(eid, "体力", -n)
	   WAR.Person[emenyid]["体力点数"] = (WAR.Person[emenyid]["体力点数"] or 0) + n2
	   if MPPD(pid) == 3 or DT(pid,59) then
	   WAR.Person[emenyid]["体力点数"] = (WAR.Person[emenyid]["体力点数"] or 0) + AddPersonAttrib(eid, "体力", -5)
	   end
    end

   if DT(pid,114) and (wugong == 1 or wugong == 22 or wugong == 20 or wugong == 24 or wugong == 108) then
		local aa= JY.Person[pid]["品德"]or 0
		WAR.XMS_QSRL = 1
		if JY.Person[pid]["武器"] == 363 and aa ~= nil and aa >= 70 then
			if JLSD(10,(aa/2),pid) then
				WAR.XMS_QSRL = 2
				WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid,"生命",-200)
			end	
		end
    end
	
    if MPPD(pid) == 5 and PersonKF(pid, 108) and not DT(pid,114) then --武骧金星：少林派福利
	    local aa= JY.Person[pid]["品德"]or 0
		if JLSD(10, 20 + MPDJ(pid) * 10, pid) or DT(pid, 615) then
		    if wugong == 22 then
			    WAR.JGZ_DMZ = 1 
				if JY.Person[pid]["武器"] == 363 and aa ~= nil and aa >= 70 then
					if JLSD(10,(aa/2),pid) then
						WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid,"生命",-100)
						WAR.JGZ_DMZ = 2
					end
				end	
		    elseif wugong == 1 then
			    WAR.LHQ_BNZ = 1
				if JY.Person[pid]["武器"] == 363 and aa ~= nil and aa >= 70 then
					if JLSD(10,(aa/2),pid) then
						WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid,"生命",-50)
						WAR.LHQ_BNZ = 2
					end	
				end
			elseif wugong == 24  or wugong == 108 then
				WAR.RL = 1
				if JY.Person[pid]["武器"] == 363 and aa ~= nil and aa >= 70 then
					if JLSD(10,(aa/2),pid) then
						WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid,"生命",-150)
						WAR.RL = 2
					end	
				end
		    end
	    end
    end
  
    if DT(pid, 589) and JLSD(10, 35, pid) then
	    WAR.L_SSBD = 1
    end
  
    --蓝烟清：雷震剑法，每次攻击会累加
    --nino 最多累计200
    if wugong == 28 and DWPD() and 0 < hurt and WAR.L_LZJFCC == 0 then
  	    if WAR.L_LZJF_ATK[pid] ~= nil then
  		    WAR.L_LZJF_ATK[pid] = WAR.L_LZJF_ATK[pid] + 50
  	    else
  		    WAR.L_LZJF_ATK[pid] = 50;
  	    end
  	    if WAR.L_LZJF_ATK[pid] > 250 then
  		    WAR.L_LZJF_ATK[pid] = 250;
  	    end
  	        WAR.L_LZJFCC = 1;
    end			

    --蓝烟清：柔云剑法，每次攻击会累加，最多累加五次
    if wugong == 36 and DWPD() and 0 < hurt and WAR.L_RYJFCC == 0 then
  	    if WAR.L_RYJF[pid] ~= nil then
  		    WAR.L_RYJF[pid] = WAR.L_RYJF[pid] + 1
  	    else
  		    WAR.L_RYJF[pid] = 1;
  	    end
  	    if WAR.L_RYJF[pid] > 5 then
  		    WAR.L_RYJF[pid] = 5;
  	    end
  	    WAR.L_RYJFCC = 1;
    end
    	
    if WAR.TZ_XZ == 1 and DWPD() then
        WAR.TZ_XZ_SSH[eid] = 1
    end
  
    if WAR.TZ_XZ2 == 1 and DWPD() then
        WAR.TZ_XZ_SSH2[eid] = WAR.TZ_XZ_SSH2[eid] or 0 + 2
	    WAR.GUDUVICTIE[eid] = WAR.GUDUVICTIE[eid] or 0 + 2
    end
  
    --中毒计算
    --易筋主功体完全抗毒
    local poisonnum = math.modf(level * JY.Wugong[wugong]["敌人中毒点数"] + 5 * JY.Person[pid]["攻击带毒"])
    if JY.Person[eid]["抗毒能力"] < poisonnum and dng == 0 and DT(pid , 48) and 
	   WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emenyid]["我方"] and PersonGT(pid, 108) == false then
  	   if WAR.Person[emenyid]["我方"] then
  		  poisonnum = math.modf(poisonnum / 10 - JY.Person[eid]["抗毒能力"]/10 - JY.Person[eid]["内力"] / 200)
  	   else
  		  poisonnum = math.modf(poisonnum / 15 - JY.Person[eid]["抗毒能力"]/5 - JY.Person[eid]["内力"] / 150)
  	   end  
	   if JY.Person[eid]["防具"]==61 then --鳄鱼甲-中毒5
		  poisonnum = poisonnum - 5
	   end		
       if poisonnum < 0 then
          poisonnum = 0
       end
          WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", myrnd(poisonnum))
    end
  
    --蓝烟清：发动蟾震九天时中毒40点
    if WAR.L_CZJT == 1 then	
  	    local n = 10 
	    if DT(pid, 61) then --欧阳克加5-10点
		    n = n + math.random(5, 10)
	    end
	    if PersonGT(pid, 95) then --主功体蛤蟆功蟾震追加中毒
		    n = n + math.modf(WAR.tmp[200 + pid] / 10);				
  	    end
  	    WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0 ) + AddPersonAttrib(eid, "中毒程度", n);
  	    WAR.tmp[200 + pid] = 0 
    end
	
    if (wglw(pid,103) and PersonGT(pid, 103)) or (PersonGT(pid, 103) and (DT(pid, 62) or DT(pid, 594))) or (DT(pid, 662) and PersonKF(pid, 103)) then --血龙
	    if (WAR.LXQJ[100+eid] == 1 or WAR.LXQJ[200+eid] == 1) and WAR.ACT == 1 then 
		    local a = 0 
		    if WAR.LWZN[eid] ~= nil and WAR.LWZN[eid] > 0 then 
			    a = WAR.LWZN[eid]
		    end	
		    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) +AddPersonAttrib(eid, "生命", -math.modf(100*(1+a*0.1)));
		    if WAR.Person[emenyid][CC.TXWZ3] == nil then
			    WAR.Person[emenyid][CC.TXWZ3] = "龙象气劲・爆"
		    elseif WAR.Person[emenyid][CC.TXWZ3] ~= nil then
			    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."+".."龙象气劲・爆"
		    end
		    WAR.Person[emenyid][CC.TXDH] = 58
	    end
    end
	
    if ((DT(pid, 103) or DT(pid, 595)) or wglw1(pid,66)) then	
	    if (WAR.HYDM[100+eid] == 1 or WAR.HYDM[200+eid] == 1) and WAR.ACT == 1 then 
		    local a = 0 
		    if WAR.HYDX[eid] ~= nil and WAR.HYDX[eid] > 0 then 
			    a = WAR.HYDX[eid]
		    end	
		    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) +AddPersonAttrib(eid, "生命", -math.modf(100*(1+a*0.1)));
		    if WAR.Person[emenyid][CC.TXWZ3] == nil then
			    WAR.Person[emenyid][CC.TXWZ3] = "火焰刀・破"
		    elseif WAR.Person[emenyid][CC.TXWZ3] ~= nil then
			    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."+".."火焰刀・破"
		    end
		    WAR.Person[emenyid][CC.TXDH] = 58
	    end
    end	
	
    if NF(pid) and yongdao(wugong) then
	    if (WAR.XYDH[100+eid] == 1 or WAR.XYDH[200+eid] == 1) and WAR.ACT == 1 then 
		    local a = 0 
		    if WAR.XYDQ[eid] ~= nil and WAR.XYDQ[eid] > 0 then 
			    a = WAR.XYDQ[eid]
		    end	
		    WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) +AddPersonAttrib(eid, "生命", -math.modf(150*(1+a*0.1)));
		    if WAR.Person[emenyid][CC.TXWZ3] == nil then
			    WAR.Person[emenyid][CC.TXWZ3] = "雪饮神锋・寒"
		    elseif WAR.Person[emenyid][CC.TXWZ3] ~= nil then
			    WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."+".."雪饮神锋・寒"
		    end
		    WAR.Person[emenyid][CC.TXDH] = 140
	    end
    end	
	
    if wugong == 176 and ((DT(pid, 117) or wglw1(pid,176)) and JLSD (10, 40, pid)) or (DT(pid,618) and JLSD(10, 40, pid)) and (PersonKF(eid,8) or wglw1(eid,8)) == false then
     --if (WAR.SSF[100+pid] == 1 or WAR.SSF[200+pid] == 1) and WAR.ACT == 1 then 
		for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then				
				local tmppid = WAR.Person[j]["人物编号"]
				WAR.ICE[tmppid]=WAR.ICE[tmppid] or 0 + 30
				local bb=WAR.ICE[tmppid]*15
				WAR.Person[emenyid]["体力点数"] = (WAR.Person[emenyid]["体力点数"] or 0) + AddPersonAttrib(tmppid, "体力", -20)
				WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
			end
		end	
		local a = 0 
		if WAR.SSFZ[pid] ~= nil and WAR.SSFZ[pid] > 0 then 
			a = WAR.SSF[pid]
		end	
		WAR.Person[emenyid]["真伤点数"] = (WAR.Person[emenyid]["真伤点数"] or 0) +AddPersonAttrib(eid, "生命", -math.modf(100*(1+a*0.1)));
		if WAR.Person[emenyid][CC.TXWZ3] == nil then
			WAR.Person[emenyid][CC.TXWZ3] = "生死符・热劲破体"
		elseif WAR.Person[emenyid][CC.TXWZ3] ~= nil then
			WAR.Person[emenyid][CC.TXWZ3] = WAR.Person[emenyid][CC.TXWZ3].."+".."生死符・热劲破体"
		end
		WAR.Person[emenyid][CC.TXDH] = 144
	   --end
    end
	
	--虚竹降龙掌杀内
    if wugong == 26 and (DT(pid,49) or DT(pid,617)) then 	
		for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then				
				local tmppid = WAR.Person[j]["人物编号"]
				WAR.ICE[tmppid] = WAR.ICE[tmppid] or 0 + 30
				local aa = WAR.ICE[tmppid] * 15
				WAR.Person[j]["内力点数"] = (WAR.Person[j]["内力点数"] or 0) + AddPersonAttrib(tmppid, "内力", -aa)
				WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
			end
		end	
	end	
	
	if (wglw(eid,108) or (DT(eid,615) or DT(eid,114)) and PersonKF(eid,108)) and WAR.NGHT > 0 then --
		WAR.FXDS[eid] = nil
		WAR.CHZ[eid] = nil
		WAR.ICE[eid] = nil
		WAR.HOT[eid] = nil
		WAR.LXZT[eid] = nil
		WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "受伤程度", -100)
		WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", -100)
	end
	
    if DT(eid,457) and PersonKF(eid,108) and WAR.NGHT > 0 then --凡总自带
		WAR.FXDS[eid] = nil
		WAR.CHZ[eid] = nil
		WAR.ICE[eid] = nil
		WAR.HOT[eid] = nil
		WAR.LXZT[eid] = nil
		WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "受伤程度", -100)
		WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", -100)
	end	
	
    if PersonGT(eid,181) then --主运太极神功免疫冰火封血迟	
		WAR.FXDS[eid] = nil
		WAR.CHZ[eid] = nil
		WAR.ICE[eid] = nil
		WAR.HOT[eid] = nil
		WAR.LXZT[eid] = nil
	end	
	
	if DT(pid,5) and (pid==5 or pid == 0) then ----
	    if WAR.TJZS[1000+pid] ~= nil and WAR.TJZS[1000+pid] > 0 then 
	        JY.Person[pid]["生命"] = WAR.TJZS[1000+pid]
	        WAR.TJZS[1000+pid] = nil 
	    end
	end
    WAR.NGHT = 0
    WAR.FLHS4 = 0  
    WAR.L_SGHT = 0;
  	if jtyl(pid) then--1-26-
	    if WAR.SJSM[100+pid] ~= nil and WAR.SJSM[100+pid] > 0 then 
	        if JY.Person[pid]["生命"] < WAR.SJSM[100+pid] then
	            WAR.SJSM[300+pid] = 1
	        end
	        JY.Person[pid]["生命"]= WAR.SJSM[100+pid]
	        WAR.SJSM[100+pid] = nil
	        WAR.SJSM[1000+pid] = JY.Person[pid]["生命"]
	    end
	end	 
  	if wssz(pid) then--1-26-
	    if WAR.SSFN[100+pid] ~= nil and WAR.SSFN[100+pid] > 0 then 
	        if JY.Person[pid]["生命"] < WAR.SSFN[100+pid] then
	            WAR.SSFN[300+pid] = 1
	        end
	        JY.Person[pid]["生命"]= WAR.SSFN[100+pid]
	        WAR.SSFN[100+pid] = nil
	        WAR.SSFN[1000+pid] = JY.Person[pid]["生命"]
	    end
	end	 
	if WAR.TJYL[pid] == 1 then 
	    if WAR.FXDS[eid] ~= nil and WAR.FXDS[eid] > 0 then 
	        if WAR.FXDS[pid] == nil then
	            WAR.FXDS[pid] = WAR.FXDS[eid]
		    else 
		        WAR.FXDS[pid] = WAR.FXDS[pid] + WAR.FXDS[eid]
		    end 
        end		
		WAR.FXXS[pid] = 1
		WAR.FXDS[eid] = 0
		if WAR.CHZ[eid] ~= nil and WAR.CHZ[eid] > 0 then 
	        if WAR.CHZ[pid] == nil then
	            WAR.CHZ[pid] = WAR.CHZ[eid]
		    else 
		        WAR.CHZ[pid] = WAR.CHZ[pid] + WAR.CHZ[eid]
		    end  
        end		
		WAR.CHXS[pid] = 1
		WAR.CHZ[eid] = 0
		if WAR.ICE[eid] ~= nil and WAR.ICE[eid] > 0 then
	        if WAR.ICE[pid] == nil then
	            WAR.ICE[pid] = WAR.ICE[eid]
		    else 
		        WAR.ICE[pid] = WAR.ICE[pid] + WAR.ICE[eid]
		    end  
		end
		WAR.ICEXS[pid] = 1
		WAR.ICE[eid] = 0
		if WAR.HOT[eid] ~= nil and WAR.HOT[eid] > 0 then
	        if WAR.HOT[pid] == nil then
	            WAR.HOT[pid] = WAR.HOT[eid]
		    else 
		        WAR.HOT[pid] = WAR.HOT[pid] + WAR.HOT[eid]
		    end 
		end
		WAR.HOTXS[pid] = 1
		WAR.HOT[eid] = 0
		if WAR.LXZT[eid] ~= nil and WAR.LXZT[eid] > 0 then 
	        if WAR.LXZT[pid] == nil then 
	            WAR.LXZT[pid] = WAR.LXZT[eid]
		    else 
		        WAR.LXZT[pid] = WAR.LXZT[pid] + WAR.LXZT[eid]
		    end 
		end
		WAR.LXXS[pid] = 1
		WAR.LXZT[eid] = 0
		JY.Person[pid]["中毒程度"] = JY.Person[pid]["中毒程度"] + JY.Person[eid]["中毒程度"]
		JY.Person[pid]["受伤程度"] = JY.Person[pid]["受伤程度"] + JY.Person[eid]["受伤程度"]
		WAR.Person[WAR.CurID]["内伤点数"] = (WAR.Person[WAR.CurID]["内伤点数"] or 0) + AddPersonAttrib(pid,"受伤程度",JY.Person[eid]["受伤程度"])
		WAR.Person[WAR.CurID]["中毒点数"] = (WAR.Person[WAR.CurID]["中毒点数"] or 0) + AddPersonAttrib(pid,"受伤程度",JY.Person[eid]["中毒程度"])
		WAR.Person[emenyid]["内伤点数"] = (WAR.Person[emenyid]["内伤点数"] or 0) + AddPersonAttrib(eid, "受伤程度", -100)
		WAR.Person[emenyid]["中毒点数"] = (WAR.Person[emenyid]["中毒点数"] or 0) + AddPersonAttrib(eid, "中毒程度", -100)
		WAR.TJYL[pid] = nil 
	end
    if WAR.Person[emenyid][CC.TXWZ2] == nil then
        WAR.Person[emenyid][CC.TXWZ2] = "  "
    end
    if DWPD() == false then
        WAR.Person[emenyid][CC.TXDH] = -1
        WAR.Person[emenyid][CC.TXWZ0] = nil
        WAR.Person[emenyid][CC.TXWZ1] = nil
        WAR.Person[emenyid][CC.TXWZ2] = nil
        WAR.Person[emenyid][CC.TXWZ3] = nil
    end
    
  return limitX(hurt, 0, hurt);
end

--绘画战斗地图
function WarDrawMap(flag, v1, v2, v3, v4)
    local x = WAR.Person[WAR.CurID]["坐标X"]
    local y = WAR.Person[WAR.CurID]["坐标Y"]
    if not v4 then
       v4 = JY.SubScene
    end
    if flag == 0 then
       lib.DrawWarMap(0, x, y, 0, 0, -1, v4)
    elseif flag == 1 then
    if JY.SubScene == 0 or JY.SubScene == 2 or JY.SubScene == 3 or JY.SubScene == 4 or JY.SubScene == 39 then
       lib.DrawWarMap(1, x, y, v1, v2, -1, v4)
    else
       lib.DrawWarMap(2, x, y, v1, v2, -1, v4)
    end
    elseif flag == 2 then
    lib.DrawWarMap(3, x, y, 0, 0, -1, v4)
    elseif flag == 4 then
    lib.DrawWarMap(4, x, y, v1, v2, v3, v4)
    end
    My_Show_Buff();
    if WAR.ShowHead == 1 then
       WarShowHead()
  end  
end

--敌方战斗数据
function WarSelectEnemy()
    local emax = 20
    local addenemy = -1
    if PNLBD[WAR.ZDDH] ~= nil then
  	   PNLBD[WAR.ZDDH]()
    end
  
    --日本战数据
    if WAR.ZDDH == 235 then
        local r = GetPinyin1(32, CC.ScreenH - CC.Fontbig * 6)
        local T = {}
        for a = 1, 3000 do
            local b = "" .. a
            T[b] = a
        end
        WAR.Data["敌人1"] = T[r]
    end
    
    if WAR.ZDDH == 20 and JY.SubScene == 25 and CC.fight == 1 then
	    if emax < CC.enum then
		    emax = CC.enum
	    end
	    for i = 1, CC.enum do
		    WAR.Data["敌人" .. i] = CC.elist[i]
		    local tt = math.modf(i / 15)
		    WAR.Data["敌方X" .. i] = 17 + (i - 1) - 15 * tt
		    WAR.Data["敌方Y" .. i] = 39	 - (tt) * 2	
	    end
    end
  
    for i = 1, emax do
        if WAR.Data["敌人" .. i] > 0 then
		if GetS(103, 0, 0, 0) == 1 then --nino：召唤人偶
			if WAR.Data["敌人" .. i] == GetS(103, 0, 0, 1) then				
				WAR.Data["敌人" .. i] = summon(GetS(103, 0, 0, 1))				
			end
		end
		
    	if WAR.ZDDH == 137 then
    		if GetS(86, 10, 10, 5) == 1 then			--蓝烟清：杀宝象
    			WAR.Data["敌人" .. i] = 9999;
    		elseif GetS(86, 10, 10, 5) == 2 then	--蓝烟清：杀戚长发
    			WAR.Data["敌人" .. i] = 9999;
    		end
    	end
    	
    	if WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 then		--把练功点改成挑战四神组合
    		if GetS(86, 2, 1, 5) == 3 then				--张三丰和乔峰
    			WAR.Data["敌人1"] = 5;
    			WAR.Data["敌人2"] = 50;
    		elseif GetS(86, 2, 2, 5) == 3 then		--张三丰和东方不败
    			WAR.Data["敌人1"] = 5;
    			WAR.Data["敌人2"] = 27;
    		elseif GetS(86, 2, 3, 5) == 3 then		--张三丰和扫地神僧
    			WAR.Data["敌人1"] = 5;
    			WAR.Data["敌人2"] = 114;
    		elseif GetS(86, 2, 4, 5) == 3 then		--乔峰和东方不败
    			WAR.Data["敌人1"] = 50;
    			WAR.Data["敌人2"] = 27;
    		elseif GetS(86, 2, 5, 5) == 3 then		--乔峰和扫地神僧
    			WAR.Data["敌人1"] = 50;
    			WAR.Data["敌人2"] = 114;
    		elseif GetS(86, 2, 6, 5) == 3 then		--东方不败和扫地神僧
    			WAR.Data["敌人1"] = 27;
    			WAR.Data["敌人2"] = 114;
    		elseif GetS(86, 2, 7, 5) == 3 then		--五绝阵
    			WAR.Data["敌人1"] = 57;
    			WAR.Data["敌人2"] = 60;
    			WAR.Data["敌人3"] = 65;
				WAR.Data["敌人4"] = 129;
    			WAR.Data["敌人5"] = 69;
    			WAR.Data["敌人6"] = 64;
				WAR.Data["敌人7"] = 601;
    		elseif GetS(86, 2, 8, 5) == 3 then		--江湖四兄弟
    			WAR.Data["敌人1"] = 5;
    			WAR.Data["敌人2"] = 114;
    			WAR.Data["敌人3"] = 592;
				WAR.Data["敌人4"] = 455;
    		elseif GetS(86, 2, 9, 5) == 3 then		--天机盘龙阵
    			WAR.Data["敌人1"] = 5;
    			WAR.Data["敌人2"] = 27;
    			WAR.Data["敌人3"] = 50;
				WAR.Data["敌人4"] = 64;
				WAR.Data["敌人5"] = 114;
				WAR.Data["敌人6"] = 129;
				WAR.Data["敌人7"] = 140;
				WAR.Data["敌人8"] = 558;
				WAR.Data["敌人9"] = 599;
				WAR.Data["敌人10"] = 601;
				WAR.Data["敌人11"] = 602;
				WAR.Data["敌人12"] = 615;
				WAR.Data["敌人13"] = 618;
    		elseif GetS(86, 2, 10, 5) == 3 then	--夫妻阵
				WAR.Data["敌人1"] = 455;
				JY.Person[455]["声望"] = 105
   			    --WAR.Data["敌人1"] = 143;
				--WAR.Data["敌人2"] = 144;   
    			--WAR.Data["敌人3"] = 145;  
    			--WAR.Data["敌人4"] = 146;  
				--WAR.Data["敌人5"] = 147;  
				--WAR.Data["敌人6"] = 148;  
    		elseif GetS(86, 2, 11, 5) == 3 then	--武骧金星：宗师阵 
				WAR.Data["敌人1"] = 5;     --张三丰
    			WAR.Data["敌人2"] = 50;    --乔峰
    			WAR.Data["敌人3"] = 64;    --周伯通
				WAR.Data["敌人4"] = 129;   --王重阳
				WAR.Data["敌人5"] = 558;   --霍山
				WAR.Data["敌人6"] = 599;   --黄裳
				WAR.Data["敌人7"] = 601;  --林朝英
    		elseif GetS(86, 2, 12, 5) == 3 then	--武骧金星：四神封绝阵
                WAR.Data["敌人1"] = 5;
    			WAR.Data["敌人2"] = 27;
    			WAR.Data["敌人3"] = 50;
    			WAR.Data["敌人4"] = 114;				
    		elseif GetS(86, 2, 13, 5) == 3 then	--武骧金星：逍遥三老
				WAR.Data["敌人1"] = 116;  
    			WAR.Data["敌人2"] = 117;  
    			WAR.Data["敌人3"] = 118;  
   		    elseif GetS(86, 2, 14, 5) == 3 then	--武骧金星：天龙传说
				WAR.Data["敌人1"] = 602;   
    			WAR.Data["敌人2"] = 615;  
    			WAR.Data["敌人3"] = 618; 
   		    elseif GetS(86, 2, 15, 5) == 3 then	--武骧金星：挑战原创
				WAR.Data["敌人1"] = 598;	
                WAR.Data["敌人2"] = 597;
				WAR.Data["敌人3"] = 585;	
                WAR.Data["敌人4"] = 455;	
				WAR.Data["敌人5"] = 667;
				WAR.Data["敌人6"] = 600;				
    		end
    		
    		WAR.Data["敌方X1"] = 45;
			WAR.Data["敌方Y1"] = 36;
			WAR.Data["敌方X2"] = 45;
			WAR.Data["敌方Y2"] = 28;
			WAR.Data["敌方X3"] = 52;
			WAR.Data["敌方Y3"] = 28;
			WAR.Data["敌方X4"] = 52;
			WAR.Data["敌方Y4"] = 36;
			WAR.Data["敌方X5"] = 45;
			WAR.Data["敌方Y5"] = 32;
			WAR.Data["敌方X6"] = 49;
			WAR.Data["敌方Y6"] = 28;
			WAR.Data["敌方X7"] = 52;
			WAR.Data["敌方Y7"] = 32;
			WAR.Data["敌方X8"] = 52;
			WAR.Data["敌方Y8"] = 49;
    	end
    	
		if WAR.ZDDH == 226 and GetS(86,20,20,5) == 3 then		--brolycjw：战欧阳锋鸠摩智		
			WAR.Data["敌人1"] = 60;
			WAR.Data["敌人2"] = 103;
			SetS(86,20,20,5,0);	--临时存放
		end
		
		if WAR.ZDDH == 88 and GetS(86,20,20,5) == 9 then		--单挑鸠摩智
			WAR.Data["敌人1"] = 103;
		end		
		
		if WAR.ZDDH == 341 then --队友挑战
			WAR.Data["敌人1"] = CC.DYRW2
			WAR.Data["敌方X1"] = 45
			WAR.Data["敌方Y1"] = 15		
		end
		
		if WAR.ZDDH == 342 then --真华山论剑
			WAR.Data["敌人1"] = CC.MatchYou
		end
		
		if WAR.ZDDH == 79 then
    		if GetS(86, 11, 12, 5) == 1 then			--brolycjw：杀金轮
    			WAR.Data["敌人1"] = 62;
				WAR.Data["敌方X1"] = 21
				WAR.Data["敌方Y1"] = 30
			elseif GetS(86,15,2,5) > 0 then
	    		if GetS(86,15,2,5) == 1 then			--队友初级挑战
					local enemy = {3,184,67,98,118}
					local pick = math.random(5)
					WAR.Data["敌人1"] = enemy[pick]
				elseif GetS(86,15,2,5) == 2 then			--队友中级挑战
					local enemy = {62,65,71,103,69,6}
					local pick = math.random(6)
					WAR.Data["敌人1"] = enemy[pick]
				elseif GetS(86,15,2,5) == 3 then			--队友高级挑战
					local enemy = {129,64,26,60,57,164}
					local pick = math.random(6)
					WAR.Data["敌人1"] = enemy[pick]
				elseif GetS(86,15,2,5) == 4 then			--队友神级挑战
					local enemy = {5,27,50,114}
					local pick = math.random(4)
					WAR.Data["敌人1"] = enemy[pick]		
					SetS(86,15,2,5,enemy[pick])
				end					
				WAR.Data["敌方X1"] = 45;
				WAR.Data["敌方Y1"] = 15;
			end
    	end
    	
		if WAR.ZDDH == 185 then				--brolycjw：战
			WAR.Data["敌人14"] = 65;
			WAR.Data["敌方X14"] = 44
			WAR.Data["敌方Y14"] = 22
			WAR.Data["敌人15"] = 55;
			WAR.Data["敌人16"] = 56;
			WAR.Data["敌方X15"] = 44
			WAR.Data["敌方Y15"] = 23
			WAR.Data["敌方X16"] = 44
			WAR.Data["敌方Y16"] = 24			
		end
		if WAR.ZDDH == 170 then
			if GetS(86,20,20,5) == 1 then			--brolycjw：战谢烟客
    			WAR.Data["敌人1"] = 164;
				for i = 2, 5 do
					WAR.Data["敌人".. i] = -1;
				end
			elseif GetS(86,20,20,5) == 2 then			--brolycjw：战龙木岛主
    			WAR.Data["敌人3"] = 38;
				WAR.Data["敌人4"] = -1;
				WAR.Data["敌人5"] = -1;
			else
				WAR.Data["敌人5"] = -1;
			end
		end
    	if WAR.ZDDH == 92 and GetS(87,31,33,5) == 1 then		--冰糖恋：单挑陈达海
     		for i = 2, 5 do	
	 			WAR.Data["敌人" .. i] = -1;
     		end
		end
			
			--冰糖恋：单挑瓦尔拉齐
			if WAR.ZDDH == 91 and GetS(87,31,34,5) == 1 then
				WAR.Data["敌人1"] = 138
				for i = 2, 12 do
					WAR.Data["敌人" .. i] = -1;
				end
			end

			if WAR.ZDDH == 20 and GetS(87,31,35,5) == 1 then
				WAR.Data["敌人1"] = 9999;--临时人物数据代替心魔 
			end
			
			if WAR.ZDDH == 288 then --大地图挑战
				WAR.Data["敌人1"] = GetS(106, 63, 2, 0)
			end			
			
			if WAR.ZDDH == 291 then --传闻战洛阳
				WAR.Data["敌人1"] = CC.battle[GetS(106, 63, 21, 0)][3]
			end	
			
                                                if WAR.ZDDH == 364 then --传闻战河洛
				WAR.Data["敌人1"] = CC.battlee[GetS(106, 63, 21, 0)][3]
			end					

			if WAR.ZDDH == 286 or WAR.ZDDH == 287 then --保镖/山贼 --需添加
				local number = math.random(1, 10)
				if WAR.ZDDH == 286 then
					number = number + 5
				end
				if RW.event == 6 then
					number = 10
				end
				local enemy = -1
				for i = 1, number do
					while true do
						enemy = math.random(1, 500)
						if enemy == 190 or (enemy >= 311 and enemy <= 319) or (enemy >= 410 and enemy <= 440) then
						elseif xiaobin(enemy) then
							break
						end
					end
					WAR.Data["敌人"..i] = enemy
				end
				if GetS(106, 63, 3, 0) == 5 or RW.event == 4 then
					for i = 1, number do
						while true do
							enemy = math.random(1, 500)
							if enemy == 190 or (enemy >= 311 and enemy <= 319) or (enemy >= 410 and enemy <= 440) then
								break
							end
						end
						WAR.Data["敌人"..i] = enemy
					end				
				end
				if RW.event == 6 then
					local start = RW.mp[RW.target][3]
					for i = 1, number do
						WAR.Data["敌人"..i] = start + i - 1	
					end	
				end
			end
			
			if WAR.ZDDH == 295 then
				local enemy = -1
				for i = 1, 5 do
					while true do
						enemy = math.random(1, 500)
						if animal(enemy) then
							break
						end
					end
					WAR.Data["敌人"..i] = enemy
				end				
			end
			
			if WAR.ZDDH == 290 then --夺还任务
				local enemy = -1
				while true do
					enemy = math.random(1, 130)
					if not xiaobin(enemy) and not duiyou(enemy) and 
						JY.Person[enemy]["生命最大值"] >= math.modf(JY.Thing[202][WZ7] * 600) then
						break
					end
				end		
				WAR.Data["敌人"..i] = enemy	
			end
			
			if WAR.ZDDH == 289 then --决斗任务
				WAR.Data["敌人1"] = GetS(106, 63, 5, 0)
			end		
			
			if WAR.ZDDH == 267 and GetS(49, 0, 0, 0) == 1 then --药王庄
				WAR.Data["敌人1"] = 9999
				WAR.Data["敌人2"] = 10000
			end
			
			if WAR.ZDDH == 267 and GetS(49, 0, 0, 0) > 1 then
				WAR.Data["敌人1"] = 9999
				WAR.Data["敌人2"] = 10000
				WAR.Data["敌人3"] = 10001
			end			
			
			if WAR.ZDDH == 268 and GetS(22, 0, 0, 0) == 1 then --绝情谷
				WAR.Data["敌人1"] = 9999
			end		

			if WAR.ZDDH == 268 and GetS(22, 0, 0, 0) == 2 then 
				WAR.Data["敌人1"] = 161
			end				
   		
			if WAR.ZDDH == 20 and GetS(87,31,35,5) == 2 then
				WAR.Data["敌人1"] = 92
			end

			if WAR.ZDDH == 272 then
				if GetS(1, 1, 0, 1) == 1 then
					WAR.Data["敌人1"] = 84
				elseif GetS(1, 1, 0, 1) == 2 then
					WAR.Data["敌人1"] = 160
				elseif GetS(1, 1, 0, 1) == 3 then
					WAR.Data["敌人1"] = 62
				end				
			end
		
			if WAR.ZDDH == 275 then
				if GetS(1, 4, 0, 1) == 1 then
					WAR.Data["敌人1"] = 58
				elseif GetS(1, 4, 0, 1) == 2 then
					WAR.Data["敌人1"] = 55
				elseif GetS(1, 4, 0, 1) == 3 then
					WAR.Data["敌人1"] = 62
				elseif GetS(1, 4, 0, 1) == 4 then
					WAR.Data["敌人1"] = 56
				end				
			end
			
			--蓝烟清：重新摆十八铜人的位置，单挑时的位置
			if WAR.ZDDH == 217 and GetS(86,1,2,5) == 1 then
				--把三个铜人放在门口位置
				WAR.Data["敌方X16"] = 40
				WAR.Data["敌方Y16"] = 40
				
				WAR.Data["敌方X17"] = 40
				WAR.Data["敌方Y17"] = 38
				
				WAR.Data["敌方X18"] = 40
				WAR.Data["敌方Y18"] = 42
			end
			
			--蓝烟清：重新摆十八铜人的位置，群战时的位置
			if WAR.ZDDH == 217 and GetS(86,1,2,5) == 2 then
				for i=1,9 do
					WAR.Data["敌方X" .. i] = 22
					WAR.Data["敌方Y" .. i] = 32 + i;
				end
				
				for i=10, 18 do
					WAR.Data["敌方X" .. i] = 27
					WAR.Data["敌方Y" .. i] = 32 + (i-9);
				end
			end
				
			--蓝烟清：难度3，敌方小兵武功等级随机为极
			if JY.Thing[202][WZ7] > 2 then
				if JY.Person[WAR.Data["敌人" .. i]]["武功等级1"] < 999 and not duiyou(WAR.Data["敌人" .. i]) then --武骧金星：队友不参与
					--if math.random(1) then
					JY.Person[WAR.Data["敌人" .. i]]["武功等级1"] = 999;
					--end
				end
			end
			
      WAR.Person[WAR.PersonNum]["人物编号"] = WAR.Data["敌人" .. i]
      WAR.Person[WAR.PersonNum]["我方"] = false
      WAR.Person[WAR.PersonNum]["坐标X"] = WAR.Data["敌方X" .. i]
      WAR.Person[WAR.PersonNum]["坐标Y"] = WAR.Data["敌方Y" .. i]
      WAR.Person[WAR.PersonNum]["死亡"] = false
      WAR.Person[WAR.PersonNum]["人方向"] = 1
      WAR.PersonNum = WAR.PersonNum + 1
	  
    elseif addenemy == -1 then
		for aa = 1, #CC.AddEnemy do
			if WAR.ZDDH == CC.AddEnemy[aa][1] then
				addenemy = 1
				for bb = 2, #CC.AddEnemy[aa] do
					local nx = WAR.Data["敌方X1"]
					local ny = WAR.Data["敌方Y2"]
					NewWARPersonZJ(CC.AddEnemy[aa][bb], false, nx, ny, false, 1)	
				end
			end
		end
	end
    end
end--战斗人物选择

function WarSelectTeam()
    WAR.PersonNum = 0
  
    --dantong 单通自动参战
    if DT1(0,0) and (WAR.ZDDH>234 or WAR.ZDDH<229) and WAR.ZDDH ~= 226 and WAR.ZDDH ~= 341 then --武骧金星：萧笑竹特殊判定
  	   if WAR.Data["自动选择参战人1"] == -1 then
		  WAR.Data["自动选择参战人1"] = 0
	   end
    end
    if GetS(4, 7, 7, 5) == 2 and (WAR.ZDDH>234 or WAR.ZDDH<229) and WAR.ZDDH ~= 226 and WAR.ZDDH ~= 341 then
  	   if WAR.Data["自动选择参战人1"] == -1 then
		  WAR.Data["自动选择参战人1"] = 0
	   end
    end
    --brolycjw：自定义自动选择参战人
    --设置了之后，会直接战斗，而不可以选择队友
    if WAR.ZDDH == 79 then				--战斗编号
	   if GetS(86, 11, 12, 5) == 1 then			--brolycjw：杀金轮
		  WAR.Data["自动选择参战人1"] = 0;
		  WAR.Data["我方X1"] = 22
		  WAR.Data["我方Y1"] = 38
		
		  WAR.Data["自动选择参战人2"] = 59;
		  WAR.Data["我方X2"] = 23
		  WAR.Data["我方Y2"] = 38

	    elseif GetS(86,15,2,5) > 0 then
		   WAR.Data["自动选择参战人1"] = GetS(86,15,1,5);
	    end
    end
  
    if WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 and GetS(86, 2, 13, 5) == 3 then --逍遥三圣
       WAR.Data["自动选择参战人1"] = 0;
    end
    if WAR.ZDDH == 341 then --队友挑战
	   WAR.Data["自动选择参战人1"] = CC.DYRW
	   WAR.Data["我方X1"] = 52
	   WAR.Data["我方Y1"] = 15		
    end
  
 	if WAR.ZDDH == 342 then --真华山论剑
		WAR.Data["自动选择参战人1"] = CC.MatchMe
	end
		
	if WAR.ZDDH == 267 and GetS(49, 0, 0, 0) == 1 then --药王庄
		WAR.Data["自动选择参战人1"] = 1
		WAR.Data["自动选择参战人2"] = 2
	end 

	if WAR.ZDDH == 52 and inteam(78) and inteam(92) and LWS(92) then --程英居带梅超风和陆无双自动单挑李莫愁
		WAR.Data["自动选择参战人1"] = 78
		WAR.Data["自动选择参战人2"] = 92
	end 

	if WAR.ZDDH == 52 and inteam(78) then --程英居带梅超风自动单挑李莫愁
		WAR.Data["自动选择参战人1"] = 0
		WAR.Data["自动选择参战人2"] = 78
	end 

	if WAR.ZDDH == 52 and inteam(92) and LWS(92) then --程英居带陆无双自动单挑李莫愁
		WAR.Data["自动选择参战人1"] = 0
		WAR.Data["自动选择参战人2"] = 92
	end 

	if WAR.ZDDH == 52 and inteam(78) and inteam(92) and LWS(92) then --程英居带梅超风和陆无双自动单挑李莫愁
		WAR.Data["自动选择参战人1"] = 78
		WAR.Data["自动选择参战人2"] = 92
	end 
	
	if WAR.ZDDH == 288 then --大地图挑战
		WAR.Data["自动选择参战人1"] = GetS(106, 63, 1, 0)
	end			
	
	if WAR.ZDDH == 291 then --洛阳传闻战
		WAR.Data["自动选择参战人1"] = CC.battle[GetS(106, 63, 21, 0)][2]
	end		

	if WAR.ZDDH == 364 then --河洛传闻战
		WAR.Data["自动选择参战人1"] = CC.battlee[GetS(106, 63, 21, 0)][2]
	end		
	
	if WAR.ZDDH == 267 and GetS(49, 0, 0, 0) == 2 then
		WAR.Data["自动选择参战人1"] = 1
		WAR.Data["自动选择参战人2"] = 2
	end 	
	
	if WAR.ZDDH == 267 and GetS(49, 0, 0, 0) == 3 then
		WAR.Data["自动选择参战人1"] = 0
	end 	
  
	if (WAR.ZDDH == 268 or WAR.ZDDH == 269) and GetS(22, 0, 0, 0) == 1 then --绝情谷/蜘蛛洞
		if inteam(58) then
			WAR.Data["自动选择参战人1"] = 58
		else
			WAR.Data["自动选择参战人1"] = 59
		end
	end		
	
	if WAR.ZDDH == 268 and GetS(22, 0, 0, 0) == 2 then --绝情谷
		WAR.Data["自动选择参战人1"] = 63
		if inteam(78) then
			WAR.Data["自动选择参战人2"] = 78
		else
			WAR.Data["自动选择参战人2"] = 56
		end		
	end
 
	----日月神教黑木崖之战
	if WAR.ZDDH == 54 then
	    if GetS(54,0,0,1) == 2 then
	        for i = 4,20 do
                WAR.Data["自动选择参战人1"] = 27;
	            WAR.Data["敌人"..i] = 0
                WAR.Data["敌人1"] = 26;
  	            WAR.Data["敌人X1"] = 24
  	            WAR.Data["敌人Y1"] = 29
	            WAR.Data["敌人2"] = 35;
	            WAR.Data["敌人X1"] = 27
  	            WAR.Data["敌人Y1"] = 29
	            WAR.Data["敌人3"] = 73;
	            WAR.Data["敌人X1"] = 25
  	            WAR.Data["敌人Y1"] = 29
	        end
	    end	
    end	
	
	if WAR.ZDDH == 255 then --灭六大武当战
	    if GetS(11,60,15,0) == 1 then
	        WAR.Data["敌人1"] = -1
            WAR.Data["敌人4"] = -1
	        WAR.Data["敌人6"] = -1
	    elseif GetS(11,60,15,0) == 2 then 
	        WAR.Data["敌人1"] = -1
	        WAR.Data["敌人2"] = -1
            WAR.Data["敌人3"] = 5
	        WAR.Data["敌人4"] = 114
	        WAR.Data["敌人5"] = 455
	        WAR.Data["敌人6"] = 592
	    end
    end	
	
	if WAR.ZDDH == 362 then --救六大武当战
	    if GetS(11,60,15,0) == 1 then
	        WAR.Data["敌人7"] = 640
            WAR.Data["敌人9"] = 641
	        WAR.Data["敌人10"] = 642
	    end
    end	
    if WAR.ZDDH == 344 then --
	    if GetS(99,0,1,0) == 2 then
	        WAR.Data["敌人3"] = 513
            WAR.Data["敌人4"] = 507
	        WAR.Data["敌人5"] = 519
	        WAR.Data["敌人6"] = 522
	    end 
	end
  --冰糖恋：单挑陈达海
	if WAR.ZDDH == 92 and GetS(87,31,33,5) == 1 then
	  	WAR.Data["自动选择参战人1"] = 0;
	  	WAR.Data["我方X1"] = 43
	  	WAR.Data["我方Y1"] = 25
	end
	
	--冰糖恋：单挑瓦尔拉齐
	if WAR.ZDDH == 91 and GetS(87,31,34,5) == 1 then
  	    WAR.Data["自动选择参战人1"] = 0;
  	    WAR.Data["我方X1"] = 21
  	    WAR.Data["我方Y1"] = 28
	end
		
	--蓝烟清：重新摆十八铜人，群战，我方的位置
	if WAR.ZDDH == 217 and GetS(86,1,2,5) == 2 then
		for i=1, 6 do
			WAR.Data["我方X" .. i] = 25;
			if i < 4 then
				WAR.Data["我方Y" .. i] = 38 - i
			else
				WAR.Data["我方Y" .. i] = 38 + (i-4)
			end
		end
	end
	
	--挑战四神，我方位置
	if WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 then
		for i=1, 6 do
			WAR.Data["我方X" .. i] = 48;
			if i < 4 then
				WAR.Data["我方Y" .. i] = 34 - i;
			else
				WAR.Data["我方Y" .. i] = 34 + (i-4)
			end
		end
	end
	
	--队友挑战，我方位置
	if WAR.ZDDH == 79 then
		if GetS(86,15,2,5) > 0 then
			WAR.Data["我方X1"] = 51;
			WAR.Data["我方Y1"] = 15;
		end		
	end
	
	if GetS(103, 0, 0, 0) == 1 then --nino: 伪主角自动参战
		for i = 1, 6 do
			if WAR.Data["自动选择参战人" .. i] == 0 then
				WAR.Data["自动选择参战人" .. i] = GetS(103, 0, 0, 1)
				break
			end
		end
	end

	local pmax = 6
	if WAR.ZDDH == 20 and JY.SubScene == 25 then
		if pmax < CC.pnum then
			pmax = CC.pnum
		end
		for i = 1, CC.pnum do
			WAR.Data["自动选择参战人" .. i] = CC.plist[i]
			local tt = math.modf(i / 15)
			WAR.Data["我方X" .. i] = 20 + (i - 1) - 15 * tt
			WAR.Data["我方Y" .. i] = 17 + tt * 2				
		end
	end
	
    for i = 1, 6 do 
        local id = WAR.Data["自动选择参战人" .. i]
        if id >= 0 then
            WAR.Person[WAR.PersonNum]["人物编号"] = id
            WAR.Person[WAR.PersonNum]["我方"] = true
            WAR.Person[WAR.PersonNum]["坐标X"] = WAR.Data["我方X" .. i]
            WAR.Person[WAR.PersonNum]["坐标Y"] = WAR.Data["我方Y" .. i]
            WAR.Person[WAR.PersonNum]["死亡"] = false
            WAR.Person[WAR.PersonNum]["人方向"] = 2
            WAR.PersonNum = WAR.PersonNum + 1
        end
    end
  
    --蓝烟清：群战十八铜人战
    if WAR.ZDDH == 217 and GetS(86,1,2,5) == 2 then
  	   WAR.PersonNum = 0;
    end
  
    if WAR.PersonNum > 0 and WAR.ZDDH ~= 235 then
       return 
    end
  
    for i = 1, CC.TeamNum do --增加队友：选择参战人
        WAR.SelectPerson[i] = 0
        local id = JY.Base["队伍" .. i]
        if id >= 0 then
            for j = 1, CC.TeamNum do
                if WAR.Data["手动选择参战人" .. j] == id then
                    WAR.SelectPerson[i] = 1
                end
            end
        end
    end
    
    local menu = {}
    for i = 1, CC.TeamNum do
        menu[i] = {"", WarSelectMenu, 0}
        local id = JY.Base["队伍" .. i]
        if id >= 0 then
            menu[i][3] = 1
            local s = JY.Person[id]["姓名"]
            if WAR.SelectPerson[i] == 1 then
                menu[i][1] = "*" .. s
            else
     		    menu[i][1] = " " .. s
            end
        end
    end
  
    menu[CC.TeamNum + 1] = {" 全部出战", nil, 1}
    menu[CC.TeamNum + 2] = {" 结束", nil, 1}
  
    while true do
    Cls()
	if JY.SJCZ == 0 or (JY.SJCZ == 1 and GetS(4, 7, 7, 5) ~= 0)then	--非随机参战模式，或者非群通
		local x = (CC.ScreenW - 7 * CC.DefaultFont - 2 * CC.MenuBorderPixel) / 2
		DrawStrBox(x, 10, "请选择参战人物", C_WHITE, CC.DefaultFont)
		local r = ShowMenu(menu, CC.TeamNum + 2, 0, x, 10 + CC.SingleLineHeight, 0, 0, 1, 0, CC.DefaultFont, C_ORANGE, C_WHITE)
		if r == CC.TeamNum + 1 then
			for i = 1, CC.TeamNum do
				if JY.Base["队伍" .. i] >= 0 then
					WAR.SelectPerson[i]	= 1
				end
			end
		end
	elseif JY.SJCZ == 1 and GetS(4, 7, 7, 5) == 0 then	--群通模式下随机参战模式
		local ZDRS = 0
		while ZDRS < 1 do
			for i = 1, CC.TeamNum do
				if JY.Base["队伍" .. i] >= 0 and JLSD(30, 80, JY.Base["队伍" .. i]) then
					WAR.SelectPerson[i]	= 1
					ZDRS = ZDRS + 1
				end
			end
		end
	end
	Cls()
    for i = 1, 6 do --nino 改多人参战！
        if WAR.SelectPerson[i] > 0 then
            WAR.Person[WAR.PersonNum]["人物编号"] = JY.Base["队伍" .. i]
            WAR.Person[WAR.PersonNum]["我方"] = true
            WAR.Person[WAR.PersonNum]["坐标X"] = WAR.Data["我方X" .. i]
            WAR.Person[WAR.PersonNum]["坐标Y"] = WAR.Data["我方Y" .. i]
            WAR.Person[WAR.PersonNum]["死亡"] = false
            WAR.Person[WAR.PersonNum]["人方向"] = 2
            WAR.PersonNum = WAR.PersonNum + 1
        end
    end
	local tmp = 0
	for i = 7, CC.TeamNum do
		if WAR.SelectPerson[i] > 0 then
			tmp = 1
			break
		end
	end
        if WAR.PersonNum > 0 or tmp == 1 then
            break;
        end
    end
end

--计算战斗人物贴图
function WarCalPersonPic(id)
    local n = 5106
       n = n + JY.Person[WAR.Person[id]["人物编号"]]["头像代号"] * 8 + WAR.Person[id]["人方向"] * 2
    if JY.Person[WAR.Person[id]["人物编号"]]["头像代号"] >= 314 then
	   n = 4401 * 2 + (JY.Person[WAR.Person[id]["人物编号"]]["头像代号"] - 314) * 8 + WAR.Person[id]["人方向"] * 2
    end
    if JY.Person[WAR.Person[id]["人物编号"]]["头像代号"] >= 340 then
	   n = 4510 * 2 + (JY.Person[WAR.Person[id]["人物编号"]]["头像代号"] - 340) * 8 + WAR.Person[id]["人方向"] * 2
    end
    if JY.Person[WAR.Person[id]["人物编号"]]["头像代号"] >= 342 then
	   n = 4518 * 2 + (JY.Person[WAR.Person[id]["人物编号"]]["头像代号"] - 342) * 8 + WAR.Person[id]["人方向"] * 2
    end
    return n
end
--已方战斗时选择人物的菜单
function WarSelectMenu(newmenu, newid)
    local id = newmenu[newid][4]
    local maxnum = CC.TeamNum --出场人物上限
    local current = 0 --目前选择的人数
    for i = 1, CC.TeamNum do
	    if WAR.SelectPerson[i] > 0 then
		    current = current + 1 --计算现在选择了多少人
	    end
    end
    if WAR.SelectPerson[id] == 0 and current < maxnum then --在上限没有达到的情况下才可以选择
       WAR.SelectPerson[id] = 1
    else
    if WAR.SelectPerson[id] > 0 then
      WAR.SelectPerson[id] = 0
    end
    end
    if WAR.SelectPerson[id] > 0 then
       newmenu[newid][1] = "*" .. string.sub(newmenu[newid][1], 2)
    else
       newmenu[newid][1] = " " .. string.sub(newmenu[newid][1], 2)
    end
    return 0
end
    --战斗是否结束
    --直接使用StarShine的函数
War_isEnd = function()
    for i = 0, WAR.PersonNum - 1 do
        if JY.Person[WAR.Person[i]["人物编号"]]["生命"] <= 0 then
            WAR.Person[i]["死亡"] = true
            if WAR.Person[i]["死亡"] == true then 
		        for j = 0,WAR.PersonNum-1 do 
		            if WAR.Person[j]["我方"] == WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false then 
			            if WAR.TMMS[400+WAR.Person[j]["人物编号"]]== WAR.Person[i]["人物编号"] then
				            WAR.TMMS[400+WAR.Person[j]["人物编号"]] = nil
				        end  
			        end 
		        end
           end
        end
    end
    WarSetPerson()
    Cls()
    ShowScreen()
    local myNum = 0
    local EmenyNum = 0
    for i = 0, WAR.PersonNum - 1 do
        if WAR.Person[i]["死亡"] == false then
            if WAR.Person[i]["我方"] == true then
                myNum = 1
            else
		        EmenyNum = 1
	        end
        end
    end

    if EmenyNum == 0 then
       return 1;
    end
    if myNum == 0 then
  	   return 2;
    end
    return 0
end

--设置战斗全局变量
function WarSetGlobal()
    WAR = {}
    WAR.Data = {}
    WAR.SelectPerson = {}
    WAR.Person = {}
    for i = 0, 99 do
    WAR.Person[i] = {}
    WAR.Person[i]["人物编号"] = -1
    WAR.Person[i]["我方"] = true
    WAR.Person[i]["坐标X"] = -1
    WAR.Person[i]["坐标Y"] = -1
    WAR.Person[i]["死亡"] = true
    WAR.Person[i]["人方向"] = -1
    WAR.Person[i]["贴图"] = -1
    WAR.Person[i]["贴图类型"] = 0
    WAR.Person[i]["轻功"] = 0
    WAR.Person[i]["移动步数"] = 0
    WAR.Person[i]["点数"] = 0
    WAR.Person[i]["经验"] = 0
    WAR.Person[i]["自动选择对手"] = -1
    WAR.Person[i].Status = 0
    WAR.Person[i].Move = {}
    WAR.Person[i].Action = {}
    WAR.Person[i].Time = 0
    WAR.Person[i].TimeAdd = 0
    WAR.Person[i].SpdAdd = 0
    WAR.Person[i].Point = 0
    WAR.Person[i][CC.TXDH] = -1
    WAR.Person[i]["反击武功"] = -1
    WAR.Person[i][CC.TXWZ1] = nil
    WAR.Person[i][CC.TXWZ2] = nil
    WAR.Person[i][CC.TXWZ3] = nil
    end
  WAR.XNXS = {}
  WAR.XLGJ = 0   --降龙刚劲
  WAR.XLRJ = 0   --降龙柔劲
  WAR.BMXL = {}  --北冥降龙
  WAR.ARJX = 0   --黯然领悟
  WAR.ARJC = {}  --黯然领悟
  WAR.LMJQ = 0   --六脉领悟
  WAR.XMSZ = 0   --玄冥领悟
  WAR.JWDF = 0   --金乌刀法
  WAR.TDSX = 0   --持瑶琴战意技 
  WAR.HHDW1 = 0 --煌煌道威
  WAR.XMSSZ = 0
  WAR.TSYXL = 0  --铁碎牙蓄力
  WAR.YXZ = {}  --易数值
  WAR.ANBG = 0  --暗八卦攻
  WAR.MINBG = 0 --明八卦攻
  WAR.ANBG1 = {}  --暗八卦守
  WAR.MINBG1 = {} --明八卦守
  WAR.TJNC = {} --天机难测
  WAR.GMAQ = 0 -- 古墓暗器
  WAR.BPD = {} --冰魄毒
  WAR.BPLW1 = 0
  WAR.BPLW2 = 0
  WAR.BPLW3 = 0
  WAR.BPLW4 = 0
  WAR.BPLW5 = 0
  WAR.SGSF = 0   --七伤拳领悟
  WAR.YYMSN = 0
  WAR.CYANGZ = 0  --纯阳掌领悟
  WAR.CYINZ = 0 --纯阴掌领悟
  WAR.RJZQ = {} --儒君子气
  WAR.FRYG = {} --焚日阳罡
  WAR.SZZX = 0  --三指诛仙
  WAR.SZZX1 = {}
  WAR.YJQS = {}  --一劲七伤
  WAR.YMD = {}   --阳脉断
  WAR.YMH = {}   --阴脉毁
  WAR.TSWH = {} --踏雪无痕
  WAR.XYKP = 0   --萧雨客伤害
  WAR.XYKS = 0   --萧雨客速度
  WAR.WJBJ = 0   --无极霸剑
  WAR.MMBT = {}  --莫名悲痛
  WAR.QZJF = 0   --全真剑法
  WAR.LYBF = 0   --落英领悟
  WAR.YXMQ = 0   --玉箫领悟
  WAR.WYLW1 = 0   --恒山领悟
  WAR.WYLW2 = 0   --泰山领悟
  WAR.WYLW3 = 0   --衡山领悟
  WAR.WYLW4 = 0   --嵩山领悟
  WAR.WYLW5 = 0   --华山领悟
  WAR.ZKSY = 0   --五指秘刀领悟
  WAR.ZKSY1 = 0
  WAR.DZDJ = 0   --阴阳捣乱领悟
  WAR.DZDJ1 =0
  WAR.DZDJ2 =0
  WAR.XWZG = 0  --玄武真功
  WAR.SLJQ = 0  --圣灵剑气
  WAR.SFWD = 0  --十方无敌
  WAR.SFJS = 0  --十方皆杀
  WAR.SFJM = 0  --十方皆灭
  WAR.QJSD1 = 0 --强极十道
  WAR.TJPL = 0
  WAR.SQHY = 0  --十方无敌
  WAR.SFWD = {} --十方无敌
  WAR.SFJS = {} --十方皆杀
  WAR.SFJM = {} --十方皆灭
  WAR.TSLY = 0  --天山六阳掌
  WAR.XYSZ = {} --天山六阳掌
  WAR.KHCS = 0  --葵花重生
  WAR.KHNP = 0  --葵花重生
  WAR.PLDS = 0  --霹雳刀式
  WAR.PJS = 0
  WAR.PJS2 = 0
  WAR.DGJJ = {}  --独孤九剑
  WAR.DGJJ_ZJS = 0  --总决式
  WAR.DGJJ_PJS = 0  --破剑式
  WAR.DGJJ_PDS = 0  --破刀式
  WAR.DGJJ_PQS = 0  --破枪式
  WAR.DGJJ_PBS = 0  --破鞭式
  WAR.DGJJ_PSS = 0  --破索式
  WAR.DGJJ_PZS = 0  --破掌式
  WAR.DGJJ_PJS1 = 0  --破箭式
  WAR.DGJJ_PQS1 = 0  --破气式
  WAR.DGJJ_LDXJ = 0  --料敌先机
  WAR.JJWS = 0  --九剑无双
  WAR.TQFJ = 0
  WAR.JSFJ = 0
  WAR.TJSG = {} --太极神功
  WAR.TJJS = 0  --太极神功
  WAR.XSSG = {} --洗髓神功
  WAR.XSJS = 0  --洗髓神功
  WAR.YJSG = {} --瑜伽密乘
  WAR.YJMC = {} --瑜伽密乘
  WAR.YJJS = 0  --瑜伽密乘
  WAR.PYZJ = {} --排云掌劲
  WAR.XYQJ = 0  --虚云劲
  WAR.SLJF = {} --圣灵剑法
  WAR.SLJJ = 0  --圣灵剑法
  WAR.LYCS = 0  --龙元复活
  WAR.LYFH = 0  --龙元复活
  WAR.SBZ  = 0  --三霸掌
  WAR.SBJ  = 0  --三霸剑
  WAR.HYZF = 0  --幻阴指
  WAR.FZZS = {}  --风中之神
  WAR.DZXF = {}  --斗转星移
  WAR.WLKH = 0  --雾里看花
  WAR.BYJF = 0  --白羽箭法
  WAR.XMS = 0
  WAR.ZHWY = 0
  WAR.QCZL = 0  --倾城之恋
  WAR.KTAY1 = 0  --崆峒奥义
  WAR.KTAY2 = 0  --崆峒奥义
  WAR.SJRF = 0  --水镜如风
  WAR.SJRL = 0  --水镜如林
  WAR.SJRH = 0  --水镜如火
  WAR.SJRS = 0  --水镜如山
  WAR.SJRT = 0  --水镜如雷
  WAR.SJRY = 0  --水镜如阴
  WAR.FQDS = 0  --夫妻刀法
  WAR.SLWD = 0  --森罗万道
  WAR.XYZD = 0  --玄阴之道
  WAR.XYFQ = 0  --玄阴风剑
  WAR.XYLQ = 0  --玄阴雷剑
  WAR.XYHQ = 0  --玄阴火剑
  WAR.XYBQ = 0  --玄阴冰剑
  WAR.TLHD = 0  --天罗火道
  WAR.JMZD = 0  --寂灭之道
  WAR.HKSL = 0  --海枯石烂
  WAR.WSXW = 0  --万世凶亡
  WAR.BXJF = 0--辟邪剑法领悟
  WAR.BXJF1 = 0
  WAR.BXJF2 = 0
  WAR.BXJF3 = 0
  WAR.BXJFHQ = 0 --辟邪剑法回气
  WAR.BXJF4 = {}
  WAR.BXJF4PD = {}
  WAR.BXJFDZ1 = {}

  WAR.YFDLW = 0
  WAR.HSYFD = 0
  WAR.JYFXJ = 0  --飞絮劲
  WAR.FXHJ = 0   --飞絮劲
  WAR.FXHJ1 = 0  --飞絮劲
  WAR.FXHJ2 = 0  --飞絮劲
  WAR.FXHJ3 = 0  --飞絮劲
  WAR.FXHJ4 = 0  --飞絮劲
  WAR.XMHJ = 0   --玄冥神掌
  WAR.TZST = {}  --弹指神通
  WAR.TZSJ = 0   --弹指神通
  WAR.ZDNS = {}  --重伤状态
  WAR.EMQF1 = {} --截手九式
  WAR.EMQF2 = 0  --佛光普照
  --WAR.TDZX = {}   --天地之心庄
  WAR.TDZX1 = 0
  WAR.LHFY = 0   --龙鹤风云庄
  WAR.LHFY1 = {} --风鹤气劲
  WAR.LHFY2 = {} --云龙气劲
  WAR.DXYM = 0   --大小幽冥庄
  WAR.DXYM1 = {} --大小幽冥范围下降
  WAR.LJZYJ1 = 0 --临济领悟战意技
  WAR.LJZYJ2 = 0 --临济领悟战意技
  WAR.LJZYJ3 = 0 --临济领悟战意技
  WAR.LJZYJ4 = 0 --临济领悟战意技
  WAR.MWQ1 = 0  --木婉清阶段性战意技
  WAR.MWQ2 = 0
  WAR.MWQ3 = 0
  WAR.MWQ4 = 0
  WAR.KTFT = 0
  WAR.YNSX = 0--玉女素心剑领悟
  WAR.NHJT = 0--怒海剑涛
  WAR.YANGJ = {}--阳极
  WAR.YINJ = {}--阴极
  WAR.YQWR1 = {}--阳气污染  
  WAR.YQWR2 = {}--阴气污染
  WAR.YSJS = {}--阳神降世
  WAR.YSZL = {}--阴圣再临
  WAR.NTLW = {} --怒海剑涛领悟
  WAR.NTLW2 = {}
  WAR.NTLW3 = 0
  WAR.NTLW4 = {}
  WAR.LSZD = {} --出血毒
  WAR.LSZD1 = {} --基因毒
  WAR.LSZD2 = {}--神经毒
  WAR.LSQ = {} --灵蛇拳法领悟溅射效果
  WAR.TZPT = 0 --弹指神通领悟炮台
  WAR.TZPT1 = 0
  WAR.TZQJ1 = {}--弹指气劲
  WAR.TZQJ2 = {}--弹指气劲
  WAR.TZQJ3 = {}--弹指气劲
  WAR.TZQJ4 = {}--弹指气劲
  WAR.TZQJ5 = {}--弹指气劲
  WAR.TZQJ6 = {}--弹指气劲
  WAR.TZQJ7 = {}--弹指气劲
  WAR.TZQJ8 = {}--弹指气劲
  WAR.TZQJ9 = {}--弹指气劲
  WAR.TZQJ10 = {}--弹指气劲
  WAR.TZQJ11 = {}--弹指气劲
  WAR.TZQJ12 = {}--弹指气劲
  WAR.TZQJ13 = {}--弹指气劲
  WAR.TZQJ14 = {}--弹指气劲
  WAR.NHH = {}--内火核（I火）
  WAR.NBH = {}--内冰核（幽冥）
  WAR.LXZS = {}--流血自（血z）
  WAR.FDLJ = 0 --风刀雷剑
  WAR.FDLJ1 = {} 
  WAR.FDLJ2 = {}
  WAR.MABI = {}--麻痹状态
  WAR.MBXS = {}
  WAR.BTSP = {} --白驼蛇魄
  WAR.BTSP1 = {}--蛇魄陷阱
  WAR.BTSP2 = {}--蛇魄倒计时
  WAR.KSTW = 0
  WAR.FXDZ = {}
  WAR.FXDZ1 = {}--佛刑涤罪
  WAR.JZSEG = 0--金钟十二关
  WAR.YJZQ = {}--易筋真气
  WAR.FDZS = {}--渡化B
  WAR.XXZD = 0--吸星真谛
  WAR.BMMY = 0--北冥秘意
  WAR.JSJZ = 0--金蛇剑锥
  WAR.JSJZ2 = {}--金蛇剑锥
  WAR.JSJZ3 = 0--金蛇剑锥
  WAR.JSXD = {}--金蛇血毒
  WAR.JSXD2 = {}
  WAR.JSHL = {}--金蛇化龙
  WAR.YQLW = 0--杨家枪领悟--燎原百击三十击
  WAR.YQLW1 = 0--杨家枪领悟--燎原百击五十势
  WAR.YQHT = {} --杨家枪领悟--燎原百击气劲护体
  WAR.YQLYQY = {}--杨家枪领悟--燎原百击燎原枪焰
  WAR.XYYLW = {} --逍遥游身法领悟
  WAR.XYYLW1 = {}
  WAR.XYYLW2 = {}	--
  WAR.AXZX = 0 --暗香疏影领悟
  WAR.AXZY = 0 --暗香疏影领悟
  WAR.AXSY1 = {}
  WAR.AXSY2 = {}
  WAR.AXSY3 = {}
  WAR.AXSY4 = {}
  WAR.XSKJ = {}--心生恐惧
  WAR.AYMZ = 0--暗影迷踪
  WAR.JZFLW = 0--君子风领悟
  WAR.JZFLW1 = {}--君子风领悟
  WAR.ZXGLW = {}--摘星功领悟
  WAR.ZXGLW1 = {}
  WAR.KLJTX = {}--昆仑剑式
  WAR.KLDG = {}--昆仑道罡
  WAR.YLSZ = {}--云龙三折
  WAR.KLJZK = {}
  WAR.KLJZ = 0
  WAR.KLJZWF = {}--昆仑剑阵我方
  WAR.KLJZDF = {}--昆仑剑阵敌方
  WAR.KLLY1 = {}--昆仑门派指令1
  WAR.KLLY2 = {}--昆仑门派指令2
  WAR.WDJF1 = 0--武当剑法
  WAR.WDQF1 = 0--武当拳法
  WAR.WDQF2 = 0--武当拳法
  WAR.WDWJJ = {}--无极剑环
  --WAR.CYZY = {}--纯阳之意
  WAR.WDTJTJ = 0
  WAR.WDTJTQ = 0
  WAR.DWRY = 0
  WAR.PersonNum = 0
  WAR.AutoFight = 0
  WAR.CurID = -1
  WAR.SXTJ = 0 --时序计算
  WAR.WGWL = 0
  WAR.EVENT1 = 0 --计算event
  WAR.ZHDFBB = 0 --出现吧琳达
  WAR.HZZY = 0 --出现吧琳达
  WAR.ZYHB = 0
  WAR.ZYHB4 = 0 --左右三连
  WAR.ZYHB3 = 0 --左右三连
  WAR.ZYHB2 = 0 --左右三连
  WAR.ZYHBP = -1
  WAR.BJ = 0
  WAR.XK = 0
  WAR.XK2 = nil
  WAR.TD = -1
  WAR.ZHUJUETD={} --主角杀人得物品
  WAR.ZHUJUETDNUM=0
  WAR.HTSS = 0
  WAR.YTFS = 0
  WAR.YTFS1 = 0--云体次数
  WAR.XLLQ = 0
  WAR.XYMJ = 0--豸苗：谢云流错步剑
  WAR.SHITOUFJ = 0
  WAR.GBWZ1 = 0
  WAR.TLHS = 0 ----
  WAR.TJZS = {}----
  WAR.XYMJ1 = 0--17-3-2
  WAR.FLHT = 0--豸苗：童姥返老还童
  WAR.ZMS = 0--豸苗：折梅手
  WAR.ZWWW = 300--豸苗：谢云流坐忘无我
  WAR.ZWWW1 = 0--豸苗：谢云流坐忘无我
  WAR.STJ = 0--豸苗：谢云流生太极
  WAR.GQ = 0 --豸苗：一刀流格切1-25-
  WAR.QF = {} --豸苗：一刀流切返1-25-
  WAR.ZMYJ = 0 --17-3-1-
  WAR.LHWH = 0 --17-3-1-
  WAR.HQJK = 0 --17-3-1-
  WAR.YDSD = {} --1-28-
  WAR.SJSM = {} --1-26-
  WAR.SSFN = {} --823-   
  WAR.XYWX = {} --玄一无相
  WAR.HQWX = 0 --17-2-9
  WAR.HQWX1 = 0 --17-2-9
  WAR.HQWX2 = 0 --17-2-9
  WAR.XWGJ = 0 --17-2-12--
  WAR.QX1 = {} --17-3-3-玉女经
  WAR.QSLB = {} --逍遥三圣
  WAR.QSLB1 = 0 --逍遥三圣
  WAR.DW = {} --逍遥三圣
  WAR.LMBJ = 0 
  WAR.LMBJ1 = 0
  WAR.LMBJ2 = 0
  WAR.LMBJ3 = 0
  WAR.LMBJ4 = 0
  WAR.LMBJ5 = 0
  WAR.LMBJ6 = 0
  WAR.LMBJ7 = 0
  WAR.LMBJ8 = 0
  WAR.LMBJ9 = 0
  WAR.YDZM = 0
  WAR.GWZQ = 0-- 丐王真气--1-12-
  WAR.KLYH = 0 --九龙功
  WAR.SLCS = {}--九龙功
  WAR.SQFJ = 0
  WAR.SQGJ = 0
  WAR.YT1 = 0
  WAR.YT2 = 0
  WAR.ZSF = 0
  WAR.LSQL = 0
  WAR.LSQL1 = 0
  WAR.LSQL2 = {}
  WAR.TJL = 0
  WAR.ZSF2 = 0
  WAR.XZZ = 0
  WAR.GJQJ = 0--郭靖气劲
  WAR.GJQJ2 = 0--宇天流蓄杀气劲
  WAR.WCY = 0
  WAR.WCY1 = 0
  WAR.WCY2 = 0
  WAR.WCY3 = 0
  WAR.WCY4 = 0
  WAR.XLD  = {}		--修罗阿鼻刀状态层数
  WAR.XLEB = 0		--修罗阿鼻刀状态层数
  WAR.YD=0
  WAR.MCF = 0
  WAR.MCF2=0
  WAR.FS = 0
  WAR.FS2 = 0
  WAR.FS3 = 0
  WAR.DYSZ = 0
  WAR.TFH = 0
  WAR.WQQ = 0
  WAR.ZBT = {}
  WAR.ZBT2 = 0
  WAR.SQL = 1
  WAR.HQT = 0
  WAR.WYJP = 0--沼跃鱼：五岳剑派
  WAR.WXXY1=0
  WAR.CY = 0
  WAR.LRZ = 0
  WAR.HDWZ = 0
  WAR.GSLE = 0
  WAR.HXSZ = 0--日月神教黑血神针0
  WAR.ZJZ = 0
  WAR.TGN = 0
  WAR.YJ = 0
  WAR.YJ2 = 0
  WAR.XMH = 0
  WAR.PYZ = 0
  WAR.YZB = 0
  WAR.YZB2 = 0
  WAR.YZB3 = 0
  WAR.GBWZ = 0
  WAR.ssf = 0  

  WAR.GBWZ2 = 0
  WAR.SSQX = 0
  WAR.BSMT = 0
  WAR.XDLZ = 0
  WAR.L_JHGC = 0 --豸苗：谢云流
  WAR.XYLCZ=0 --豸苗：谢云流 
  WAR.SJL = 0 --豸苗：一刀流森九岚
  WAR.BHBM = 0 --豸苗：童姥八荒八灭
  WAR.TXPF = 0 --豸苗：太玄经
  WAR.HLTX = 0 --1-26-
  WAR.HLTX1 = {} --1-26-
  WAR.DUIZHAO = 0 --对招17-1-2
  WAR.HEJI = 0
  WAR.DZPZ = 0
  WAR.DUO = 0
  WAR.DJGZ = 0 --刀剑归真
  WAR.QKQJ = 0 --刀剑归真
  WAR.DMZF = 0 --达摩指法
  WAR.DMZF1 = 0 --白愁飞
  WAR.DFMQ = 0 --大伏魔拳
  WAR.CJSZ = 0 -- 摧坚神爪
  WAR.SHAOLIN2 = 0--罗汉堂伏魔杖
  WAR.YY=0 --玄冥火刀
  WAR.THSB=0 --桃花三宝
  WAR.THSB1=0 --真・桃花三宝
  WAR.THSB2=0 --真・桃花三宝
  WAR.THSB3=0 --真・桃花三宝
  WAR.THSB4=0 --真・桃花三宝
  WAR.THKF=0
  WAR.ZFLY=0 --正反两仪
  WAR.ZFLY1=0
  WAR.QQSH=0 --琴棋书画
  WAR.QQSH1 = 0
  WAR.JWYX=0 --金乌映雪
  WAR.SHAOLIN=0 --神掌伏魔
  WAR.XHPL=0 --血海飘零加集气
  WAR.XIXUE=0 --吸血
  WAR.SHITOUDAO=0 --王小石刀法
  WAR.SHITOUJIAN=0 --王小石剑法
  WAR.SHITOUNG=0 --王小石内功特效
  WAR.SHITOUJY=0 --王小石刀剑极意
  WAR.DJSX=0--田归农刀剑十杀
  WAR.DJDAO=0 --田归农胡刀
  WAR.DJJIAN=0 --田归农苗剑
  WAR.TQS2=0--沼跃鱼：滕青山神圣斗气
  WAR.TQS3=0--沼跃鱼: 滕青山凶兽斗气
  WAR.OUYANG=0 --欧阳克封穴
  WAR.HIT=0 --是否打中了敌人
  WAR.YTML=0
  WAR.LKZX=0
  WAR.LKZX2=0
  WAR.PLJZ={}
  WAR.PLJZ2=0
  WAR.PLJZ3=0
  WAR.GUDU=0 --蛊毒判定 1-龙眠蛊 -300集气 2-嗜血蛊 10%吸血 3-枯残蛊 攻击-30% 4-蚀心蛊 伤害+毒
  WAR.GUDUXIXUE=0
  WAR.VAMPIRE={}
  WAR.GUDUVICFENG={} --蓝凤凰蛊毒对象
  WAR.GUDUVICTIE={} --何铁手蛊毒对象 
  WAR.KMSHJQ={}
  WAR.GTJIQI=0 --主功体恢复集气数值
  WAR.GTPID=-1 --恢复集气数值对象
  WAR.GTSHAQI=0 --主功体杀气
  WAR.GTPID2=-1 --主功体杀气使用者
  WAR.GTNUQI=0 --主功体减怒气值
  WAR.SHENGHUO={} --圣火再移动步数
  WAR.GTMENU=1 --功体菜单显示
  WAR.LFH=0 --蓝凤凰
  WAR.QQDB=0 --青青大暴
  WAR.SXJ=0
  WAR.LYJJ=0
  WAR.CYYJ=0
  WAR.MKZS=0
  WAR.MMSY=0 --mm宿缘
  WAR.DYWY={} --狄云神照
  WAR.NPC={} --可控的npc
  WAR.SSNS ={}--三尸脑神丹
  WAR.HBZQ ={}--寒冰真气
  WAR.HBZQ1 ={}--寒冰真气
  WAR.HBZQ2 ={}--寒冰真气
  WAR.FHXY ={}--风花雪月
  WAR.QJZB = {}--12-29-千军止步
  WAR.NS ={}--日月神教逆杀
  WAR.ZOMBIE={} --唐门返魂
  WAR.HYYQ = {} -- 混元一气
  WAR.BFQL = {} -- 冰封千里
  WAR.UNDEAD={}
  WAR.RECOVERY={}
  WAR.YCZHL={} --袁承志虎乱
  WAR.HUFEI=0 --胡斐飞狐
  WAR.HMXC=0 --慕容幻梦星辰
  WAR.YX=0 --杨逍乾坤
  WAR.SAXING=-1 --石破天飒行
  WAR.DXQL = {}
  WAR.SHEDI=0 --欧阳克蛇笛指令
  WAR.SHENDIAO=0 --杨过神雕指令
  WAR.QIANZHU=0 --殷离千蛛指令
  WAR.JINCHAN=0 --蓝凤凰金蟾指令
  WAR.LINGDIAO=0 --郭靖灵雕指令
  WAR.XINYUAN=0 --阿青心猿指令
  WAR.ESHEN=0 --岳老三鳄神指令  
  WAR.YUFENG=3 --小龙女御蜂指令
  WAR.JIBIAN=0 --杨过机变指令
  WAR.LINGGANG=0 --郭靖灵罡
  WAR.SLZL=0 --森罗
  WAR.ZZZ={} --张召重激励
  WAR.QIZHEN={} --黄蓉奇阵记录
  WAR.QFY1={} --曲非烟指令飞燕凌波 50时序内速度+5
  WAR.QFY2={} --破虏令 下回合伤害+30%
  WAR.QFY3={} --空山鸣涧 30时序内被攻击伤害-20%
  WAR.BCFLJ=0 --白愁飞3连判定
  WAR.BCFFH=0 --白愁飞复活判定
  WAR.BCFZL=0 --白愁飞指令
  WAR.WAWY = 0
  WAR.WAWY2 = 0
  WAR.SH1 = {} --17-2-18
  WAR.WXXY = 0 
  WAR.SGDF = 0
  WAR.SGDF2 = -1
  WAR.YDLLJ = 1
  WAR.BMGT = 0
  WAR.BMGT1 = {}
  WAR.BMGT2 = -1
  WAR.PJTX = 0 --破尽天下
  WAR.XRWDFN = 0 --小人物的愤怒
  WAR.XRWDNX = {} --小人物的逆袭
  WAR.RZSZ = {} --神照复生
  WAR.RZSZ1 = 0
  WAR.SSTG = {} --神照生死同归
  WAR.JSJY = {} --剑势剑影
  WAR.FSJY = {} --风神绝影
  WAR.YINGSHA = {} --聂风分身
  WAR.SSTG1 = 0
  WAR.BHCS = {}--魔音・碧海潮生
  WAR.BHZC = 0--魔音・碧海潮生
  WAR.BHZC1 = 0--魔音・碧海潮生
  WAR.TSYBL = 0 --铁碎牙暴流
  WAR.FZS = 0
  WAR.LXYLJ=0 --李逍遥指令
  WAR.DOUCE=0 --武骧金星：乾坤皆阵斗策指令
  WAR.AXL=-1 --武骧金星：阿修罗指令
  WAR.SEVENSTAR={}
  WAR.ATKDOWN={}
  WAR.DEFDOWN={}
  WAR.SPDDOWN={}
  WAR.PEACE={}
  WAR.POISON={}
  WAR.CONFUSE={}
  WAR.CONFUSEO={}
  WAR.NOTF=nil
  WAR.HITALL={}
  WAR.YANGKANG=0
  WAR.KMWD=0
  WAR.KMWD1=0
  WAR.KMWD2=0
  WAR.ZBT3=0
  WAR.KMWD3={}
  WAR.ZBT1=0
  WAR.ZBT2=0
  WAR.SJTH={}
  WAR.YHZJ={}
  WAR.HDGX={}
  WAR.DLYZ={}
  WAR.LHZF={}
  WAR.FMZZ={}
  WAR.WYQS={}
  WAR.QSLZ={}
  WAR.LYXJ={}
  WAR.LFCG={}
  WAR.KMSH=3	
  WAR.LXYZLPD=0
  WAR.LXYLJTS=0
  WAR.LXYJS=0
  WAR.HQGS=0
  WAR.HQGSTS=0
  WAR.HQGS2=0
  WAR.HQGSTS2=0
  WAR.HQGS3=0
  WAR.HQGSTS3=0
  WAR.SHENJIAN=1
  WAR.LXYJSTS=0
  WAR.LXYXF=0
  WAR.LXYYJ=0
  WAR.HFXZ = 0
  WAR.YYHJ = 0
  WAR.SHG = 0
  WAR.BMSG = 0
  WAR.YYMZL = 0
  WAR.XTG = 0
  WAR.ZLEZL=0
  WAR.JQRZ = 0 --举重若轻
  WAR.ZJWF = 0 --举重若轻
  WAR.MENG={} --回魂仙梦列表
  WAR.AN={} --夺魂列表
   WAR.AN2={} --夺魂列表
  WAR.ZLE=0
  WAR.LYRZL=0
  WAR.SSNSD=0--日月神教三尸脑神丹
  WAR.LYR=0
  WAR.BFTX=0--五岳剑派冰封天下
  WAR.MMTC=0 --3mm退场
  WAR.XIANGXIANG=0
  WAR.LSH=0
  WAR.LSH2=0
	if JY.stat == 0 and T8LXY(0) then
		JY.stat = 1
		if AN(92) and T8LXY(0) then
			table.insert(CC.AddSpd, {92,0,50});
			table.insert(CC.AddSpd, {0,92,50});	
		end
		if LYR(92) and T8LXY(0) then
			table.insert(CC.AddAtk, {92,0,50});
			table.insert(CC.AddAtk, {0,92,50});		
		end
		if ZLE(92) and T8LXY(0) then
			table.insert(CC.AddDef, {92,0,50});
			table.insert(CC.AddDef, {0,92,50});			
		end  		
	end
    WAR.TGLX=0
    WAR.XQSLJ=0 --萧秋水连击判定
    WAR.DZWD=0--大智无定连击判定
    WAR.WSFJ=0
    WAR.XQS=0 --萧秋水忘情天书判定
    WAR.LMSJ=0 --六脉神剑判定
    WAR.XYL=0 --豸苗：谢云流状态
    WAR.LHT=0 -- 沼跃鱼:罗汉堂
    WAR.XYL1 = 0
    WAR.ZMZS = 0--豸苗：折梅手特效
    WAR.L_JHGC = 0 --豸苗：谢云流
    WAR.JHF=0 --豸苗：谢云流居合返
    WAR.WJGZ={} --豸苗：是否触万剑归宗
    WAR.DFWM=0 --东方未明特效1
    WAR.DFWM2=0 --东方未明特效2
    WAR.DFWMJIQI=0 --东方未明集气恢复
    WAR.DFWMXX=0 --东方未明吸血
    WAR.TMMS = {} --唐门模式
    WAR.QJBMS = {} --唐门模式
    WAR.BYLH = 0 --唐门模式
    WAR.DPJ = {}--唐门模式夺魄箭
    WAR.HXB1 = {}--唐门模式夺魄箭
    WAR.ACSJ = {}--唐门模式暗藏杀机
    WAR.JTJD = {}--唐门模式暗藏杀机
    WAR.HXB = 0 --唐门模式夺魄箭
    WAR.JTJD1 = 0 --唐门模式荆天棘地
    WAR.ZXJ = 0--唐门模式夺魄箭
    WAR.CXN = 0--唐门模式夺魄箭
    WAR.LZZ = 0 --唐门模式夺魄箭
    WAR.FQDF = 0 --夫妻刀法
    WAR.DFWM3=0
    WAR.DFWM3P=0
    WAR.LXFM = 0
  
    WAR.WWD = 0
    WAR.WWD1 = 0
    WAR.WWD2 = 0
    WAR.WWD3 = 0
    WAR.WWD4 = 0
    WAR.WWD5 = 0
    WAR.WWD6 = 0

    WAR.WJDZ=0
    WAR.WJDZ2=0
    WAR.WJDZ3=0
   
    WAR.LMJQ1=0--沼跃鱼：段誉龙脉剑气
    WAR.LMJQ2={}
    WAR.LMJQ3=0
	WAR.QLP=0 --苍龙破
	WAR.YLP={}--狱龙破
	WAR.ZRMD=0--斩刃冥道
	WAR.XQFJ={}
    WAR.QDP1=0--乾达婆
    WAR.AZ=0--阿紫
    WAR.AZ1=200
    WAR.AZ2=0
    WAR.SWHH=tianshu()----沼跃鱼：滕青山累计攻击上升
    WAR.SWFY=tianshu()----沼跃鱼：滕青山累计防御上升
    WAR.SWHH1=14----沼跃鱼：滕青山累计攻击上升
    WAR.SWFY1=14----沼跃鱼：滕青山累计防御上升
    WAR.TQS=0----沼跃鱼：滕青山拟兽式
    WAR.TQSLH=0----沼跃鱼：滕青山拟兽式
    WAR.TQSLW=0----沼跃鱼：滕青山狼吻吸血
    WAR.KUANGDAO=0 --狂刀决判定
    WAR.TIANGANG=0
    WAR.DUOMINGJIAN=0
	WAR.QYYYL = 0 --从云牙狱龙
	WAR.BLHQ = {} --比良黄泉
	WAR.BLHQ1 = 0 --比良黄泉
    WAR.LMC=0 --李莫愁
    WAR.SJL=0 --豸苗：一刀流森九岚
    WAR.XYLCZ=0 --豸苗：谢云流
    WAR.JTYL = 0 --谢无悠
    WAR.XYLCZ1 =0 
    WAR.LHXS = 0
    WAR.BMXS = 0
    WAR.TXTX = 0 --豸苗：太玄经
    WAR.LXBL = 0--豸苗：龙象
    WAR.BHLH = 0--唯我独尊--17-2-27
    WAR.LWZN = {}--血龙
    WAR.LXQJ = {}--血龙
    WAR.LXQJ1 = 0--血龙
    WAR.HYDJ = 0 --火焰刀
    WAR.HYDQ = 0 --火焰刀
    WAR.HYDX1 = 0
    WAR.HYDX2 = 0
    WAR.HYDX = {}--火焰刀杀
    WAR.HYDM = {}--火焰刀灭
	WAR.XYBD = 0 --雪饮宝刀
	WAR.BLXY = 0 --白露雪饮
	WAR.CDXY = 0 --创刀雪饮
	WAR.XYDY = 0 --雪饮刀意
	WAR.SZWS = 0 --神照经
	WAR.AHLJ = 0 --傲寒六诀
	WAR.WJJF = 0 --剑流云
	WAR.QFLZ = 0 --龙爪手
	WAR.DWLZ = {} --龙爪手
	WAR.ZLZS = {} --龙爪手
    WAR.TXJ = {}--豸苗：太玄经
    WAR.TXJ2 = {}--豸苗：太玄经
    WAR.LHFM = {}--豸苗：罗汉伏魔
    WAR.HGB = {}--17-2-19幻光步
    WAR.KHYX = {}--17-2-19幻光步
    WAR.WZJS = {}--位置计算
    WAR.YDBS = 0
    WAR.SHML = {}--17-2-19圣火密令
    WAR.WWDZ = {}--唯我独尊--17-2-27
    WAR.JSYZ = {}--剑势压制
	WAR.XYDQ = {} --雪饮刀气
	WAR.XYDH = {} --雪饮刀寒
	WAR.NJXY = {} --聂家雪饮
	WAR.XYCD = {} --雪饮创刀
	WAR.XYSF = {} --雪饮神锋
    WAR.BFZY = {} --步风足影
	WAR.KHSY = {} --葵花瞬移
	WAR.KHZJ = {} --葵花组件
    WAR.JQNF = {}	--豸苗：谢云流封步剑
    WAR.JQ = {} -- 秘剑演武・天道九势
    WAR.OYFSD = {} --豸苗：欧阳锋蛇毒
    WAR.BZQZ = 0 --豸苗：谢烟客碧针清掌
    WAR.KHG = {}--豸苗：谢烟客控鹤功
    WAR.MJYW = {} --17-3-1-谜影武步？？秘剑演舞
    WAR.WYWX = {}--17-3-1-谜影武步？？秘剑演舞
    WAR.CHD=0 --沼跃鱼：鸠摩智残火刀
    WAR.LLH=0 --沼跃鱼：琉璃火调息
    WAR.CHDZS=0--沼跃鱼：残火刀终式
    WAR.DLY=0--沼跃鱼：游坦之地龙玉
    WAR.XLWC=0--沼跃鱼：慕容复修罗
    WAR.LXSS=0--沼跃鱼:螺旋生死符
    WAR.NSTJ2=0--沼跃鱼:螺旋生死符
    WAR.SDQQ = 7 --17-2-9
    WAR.HQWX = 0 --17-2-9
    WAR.HQWX1 = 0 --17-2-9
    WAR.HQWX2 = 0 --17-2-9
    WAR.RLSZ = 0 --豸苗：扫地如来神掌
    WAR.DD=0
    WAR.GSWS={} --丐世无双
    WAR.GSWS1={} --丐世无双 
    WAR.GSWS3={} --郭靖大招 
    WAR.ZYHBS = {} --左右三连
    WAR.HZD={} --何足道
	WAR.KHTJ = {}   --葵花套件
	WAR.KHTJ1 = {}  --葵花套件
	WAR.LYDJLW = {}
	WAR.LYDJLW1 = {}
	WAR.LYDJLW2 = {}
	WAR.TLDW = {}
	WAR.HGFZ = {} --持瑶琴回光返照
	WAR.HQZP = {} --持瑶琴魂牵罪判
	WAR.XYLS = {} --凌波微步羞月洛神
	WAR.HRXY = {} --梯云怀若虚云
	WAR.HYXY1 = {}
	WAR.HSWLB = {}
	WAR.SQWZ = {} --武无敌
    WAR.WYY={} --王语嫣点破对象
    WAR.ZY=0 --赵云指令
    WAR.ZYZL=0
    WAR.ZYLJ=0
    WAR.ZYQT=0--赵云七探
    WAR.ZYSP=math.modf(tianshu()/1.4)--赵云蛇盘
    WAR.ZYPOS=0
    WAR.ZYWS=0 --赵云无双
    WAR.ZYWSPD=0
    WAR.JUNSHEN = 0
    WAR.JUNSHEN2 = 0
    WAR.JUNSHEN3 = 0
    WAR.SHMP=-1
    WAR.QFY=0
    WAR.XDDF = 0
    WAR.XDDF2 = 0
    WAR.XXCC = 0
    WAR.XDXX = 0
    WAR.WS = 0
	WAR.QLKS = 0
	WAR.BMSZ = 0
	WAR.DYWQ = 0
    WAR.ACT = 1
    WAR.ZDDH = -1
    WAR.NO1 = -1
    WAR.TJAY = 0
    WAR.DZXY = 0
    WAR.DZXYLV = {}
    WAR.QKNY = 0
    WAR.fthurt = 0
    WAR.NYSH = {}
    WAR.LXZQ = 0
    WAR.JSYX = 0
    WAR.ASKD = 0
    WAR.YZHYZ = {}		--刀主大招增加怒气计数
    WAR.ASKD1 = 0
    WAR.GBXL=0
    WAR.GCTJ = 0
    WAR.GCTJ1 = 0
    WAR.JSTG = 0
    WAR.JSTG2 = 0
    WAR.BMGX = 0
    WAR.HDYD = 0--沼跃鱼：胡斐战意技
    WAR.XTDJ = 0--沼跃鱼：杨过战意技
    WAR.LXSS = 0--沼跃鱼: 螺旋生死符
    WAR.ZCDZ = 0
    WAR.TJZX = 0--沼跃鱼：张三丰太极之形
    WAR.TJZX2 = 0--沼跃鱼：张三丰太极之形
    WAR.TJZX1 = 0--沼跃鱼：张三丰太极之形
    WAR.NSTJ = 0--沼跃鱼：张召重火手太极
    WAR.NSTJ1 = 0--沼跃鱼：张召重火手太极
    WAR.NSTJ2 = 0--沼跃鱼：张召重火手太极
    WAR.ZYDQ = 0
    WAR.QJSF = 0
    WAR.FLHS1 = 0
    WAR.FLHS2 = 0
	WAR.FLHS3 = 0
    WAR.FLHS4 = 0
    WAR.FLHS5 = 0
    WAR.FLHS6 = 0
    WAR.NGJL = 0
    WAR.NGHT = 0
    WAR.BMXH = 0
    WAR.ZYYD = 0
    WAR.SSFwav = 0
    WAR.JTYLwav = 0
    WAR.LMSJwav = 0
    WAR.JGZ_DMZ = 0
    WAR.LHQ_BNZ = 0
	WAR.XMS_QSRL = 0
    WAR.RL = 0
    WAR.ShowHead = 0
    WAR.Effect = 0
    WAR.EffectColor = {}
    WAR.EffectColor[2] = RGB(236, 200, 40)
    WAR.EffectColor[3] = RGB(112, 12, 112)
    WAR.EffectColor[4] = RGB(236, 200, 40)
    WAR.EffectColor[5] = RGB(96, 176, 64)
    WAR.EffectColor[6] = RGB(104, 192, 232)
    WAR.Delay = 0
    WAR.LifeNum = 0
    WAR.EffectXY = nil
    WAR.EffectXYNum = 0
    WAR.tmp = {} --1000逆运；2000神照；3000太极拳；4000队友生命/内力
    WAR.HMJT = {} --蛤蟆九天17-2-23
    WAR.JLDL = 0 
    WAR.JLDL1 = 0
    WAR.JLDL2 = 0 
    WAR.TJJL = {} --1-27
    WAR.TJYL = {}--1-27
    WAR.XTY = {} --先天印
    WAR.CSF = {} --长生符
    WAR.TXY = 0 --太虚印
    WAR.Actup = {}
    WAR.Defup = {}
    WAR.KHBX = 0
    WAR.KHCM = {}
    WAR.TJXL = {}
    WAR.JTQF = {}
    WAR.WXQQ = {}
    WAR.XLDL = {}
    WAR.DPLX ={}
    WAR.HSBS={}
    WAR.HSBS2={}
    WAR.SHENMEN = 0 --神门刺穴
    WAR.ZHUA = 0 
    WAR.SSF = {} --生死符
    WAR.SSFZ = {} --生死符
    WAR.LQZ = {}  
    WAR.SJHB = {} --双剑合璧
    WAR.DJHB1 = {} --双剑合璧
    WAR.DJHB2 = {} --双剑合璧
    WAR.DJHB3 = {} --阴阳倒错刃领悟
	WAR.DJHB4 = {} --十杀-剑
    WAR.DJHB5 = {} --十杀-刀
    WAR.JGZH1 = {} --金关组合拳
    WAR.JGZH2 = {}
    WAR.JGZH = 0
    WAR.XYYF = {}  
    WAR.FXDS = {} --封穴
    WAR.FXXS = {}  
    WAR.LXZT = {} --流血
    WAR.LXXS = {}  
    WAR.CHZ = {}		--自定义迟缓值
    WAR.CYSH = {} --豸苗：李秋水
    WAR.SZWH = {} --豸苗：狮子王吼
    WAR.ZDNQ = {} --豸苗：主动怒气爆发
    WAR.bhbm = {} --豸苗：八荒八灭 1000，阳，2000阴，3000阴阳
    WAR.XSZW = {} --谢无悠
    WAR.WRHX = {} --谢无悠
    WAR.CMCF = {} --谢无悠
    WAR.LGQJ = {} --谢无悠
    WAR.ZSWQ = {} --谢无悠
    WAR.JTWW = 2--谢无悠
    WAR.JTWW1 = 0
    WAR.JYS = 3
    WAR.XKZ = 0
    WAR.BYB = 0
    WAR.BYCX = {}
    WAR.LBPM = 0
    WAR.CHXS = {}  
    WAR.HOT = {}
    WAR.HOTXS= {}
    WAR.ICE = {}
    WAR.ICEXS = {}  
    WAR.SPIRIT = {}
    WAR.SPIRITMAX = {}
    WAR.SPIRITMIN = {}
    WAR.MYCHAIN = 0
    WAR.URCHAIN = 0
    WAR.MYCHAINADD = 0
    WAR.URCHAINADD = 0  
	WAR.DGJY = {} --独孤剑意
    WAR.ZXJQ = {} --紫霞剑系
	WAR.CDDQ = {} --创刀刀气
	WAR.HJJQ = {} --霍家剑气
    WAR.HIDE = {} --17-2-8
    WAR.JYHT = {} --17-2-8
    WAR.YHDF = {} --17-2-10
    WAR.JYZQ = {} --17-2-10
    WAR.YHDF1 = 0
    WAR.JYHT1 = 0
    WAR.JYHT2 = 0
	WAR.DGJY1 = 0
    WAR.HIDE[104] = 50
    WAR.HIDE[618] = 50
    WAR.HIDE[66] = 50
    WAR.JYHT[618] = 5
    WAR.JYZQ[618] = 5
    WAR.JYHT[9] = 5
    WAR.ZXJQ[618] = 10 --紫霞剑系
    WAR.ZXJQ[19] = 10 --紫霞剑系
	WAR.YJZQ[114] = 5
	WAR.YJZQ[615] = 5
	WAR.YJZQ[618] = 5
	WAR.XYYLW[667] = 6
    if wglw(0,89) then --紫霞剑系
       WAR.ZXJQ[0] = 10
    end
    --逍遥游领悟
	if GetS(114,0,0,0) == 197 and PersonKF(0,197) then
		WAR.XYYLW[0] = 6
	end	
	--
	if GetS(111,0,0,0) == 93 and PersonKF(0,93) then
       WAR.HIDE[0] = 50
    end
    if wglw(0,106) then --17-2-8-九阳护体
       WAR.JYHT[0] = 5
    end
    if wglw(0,107) or DT(0,599) then --17-2-8-九阳护体
       WAR.JYZQ[0] = 5
    end
	if wglw(0,108) then
		WAR.YJZQ[0] = 5
	end	
    if NF(0) then --创刀刀气
		WAR.CDDQ[0] = 10
	end 	

    WAR.JYZQ[599] = 5

    if DT1(0, 104) then
  	   WAR.HIDE[0] = 50
    end
    if DT1(0, 66) then
  	   WAR.HIDE[0] = 50
    end
    if DT1(0, 618) then
  	   WAR.HIDE[0] = 50
    end
    if DT1(0, 9) then
  	   WAR.JYHT[0] = 5
    end
    if DT1(0, 19) then
  	   WAR.ZXJQ[0] = 10--紫霞剑系
    end
    if DT1(0, 618) then
  	   WAR.JYHT[0] = 5
	   WAR.JYZQ[0] = 5
	   WAR.ZXJQ[0] = 10--紫霞剑系
    end
    --WAR.SZJPYX = {}
    WAR.TZ_DY = 0
    WAR.LQSLB = 0 --豸苗：李秋水
    WAR.TZ_XZ = 0
    WAR.TZ_XZ2 = 0--沼跃鱼：虚竹生死轮回
    WAR.TZ_XZ_SSH = {}
    WAR.TZ_XZ_SSH2 = {}--沼跃鱼：虚竹生死轮回
    WAR.BFX = 0
    WAR.BLX = 0
    WAR.JQSDXS = {}
    WAR.JQSD_WMM = 0  
    WAR.JYFX = {}			--brolycjw: 九阳封穴
    WAR.L_TLD = 0;		--装备屠龙刀特效，1流血
    WAR.L_TLD1 = 0;		--装备屠龙刀特效，1流血
    WAR.L_YTJ1 = 0;		--装备倚天剑特效，1流血
    WAR.L_YTJ2 = 0;		--装备倚天剑特效，1封穴
    WAR.L_LWX = 0;		--李文秀特色指令，一次战斗仅限一次  
    WAR.L_SSBD = 0;		--水笙是否发动攻击减速特效
    WAR.L_SGHT = 0;		--是否有神功护体
    WAR.L_SGJL = 0;		--是否有神功加力
    WAR.L_LXXL = 0;		--龙象蓄力攻击，造成迟缓
    WAR.B_BMJQ = {};		--北冥真气发动  
    WAR.L_EffectColor = {}		--自定义的战斗颜色显示
    WAR.L_EffectColor[1] = RGB(255, 10, 10);		--显示减少生命
    WAR.L_EffectColor[2] = RGB(247, 212, 215);		--显示增加生命
    WAR.L_EffectColor[3] = RGB(0, 102, 153);		--显示内力减少和增加
    WAR.L_EffectColor[4] = RGB(197, 207, 125);		--显示体力减少和增加
    WAR.L_EffectColor[5] = RGB(255, 236, 150);		--显示封穴
    WAR.L_EffectColor[6] = RGB(255, 236, 150);		--显示流血
    WAR.L_EffectColor[7] = RGB(51, 204, 102);		--显示中毒
    WAR.L_EffectColor[8] = RGB(174, 239, 220);		--显示解毒
    WAR.L_EffectColor[9] = RGB(255, 10, 10);		--显示内伤减少和增加
    WAR.L_EffectColor[10] = RGB(173, 216, 230)--迟缓颜色
    WAR.L_EffectColor[11] = RGB(0, 191, 255) --冰封颜色
    WAR.L_EffectColor[12] = RGB(255, 0, 0) --灼烧颜色
	WAR.L_EffectColor[13] = RGB(119, 136, 153) --麻痹颜色
	WAR.L_EffectColor[14] = RGB(132, 112, 255) --真伤颜色
	
    
    WAR.L_ZXSG = 0;	 --是否修炼有紫霞神功
    WAR.L_CZJT = 0;	--是否发动蟾震九天
    WAR.L_CZJT1 = 0         --蛤蟆九天17-2-23
    WAR.L_NYZH = {};		--是否触发逆运走火
    WAR.L_WNGZL = {};		--王难姑指令，持续中毒减血
    WAR.L_HQNZL = {};		--胡青牛指令，持续回血回内伤  
    WAR.L_TXSG = {};	--记录被太玄神功加力攻击过的敌人
    WAR.L_NOT_MOVE = {};		--记录不可移动的人
    WAR.L_LZJF_ATK = {};		--雷震剑法，每次攻击累加50点攻击力，上限是300点，如果使用其它武功加成攻击力并且攻击累加归0
    WAR.L_LZJFCC = 0			--是否已经累加过雷震剑法  
    WAR.L_RYJF = {};		--柔云剑法，每次攻击会增加3点连机率，200点杀集气，最多可累加5次。使用其它武功则释放累加值
    WAR.L_RYJFCC = 0;		--是否已经累加过柔云剑法
    WAR.L_QKDNY = {};		--设定攻击多个人时，乾坤只能被反一次
    WAR.L_TJXL = {}
    WAR.L_MJJF = 0;			--灭绝剑法招式
    WAR.L_WYJFA = 0;		--五岳剑法，1-封穴 2-流血 3-内伤 4-迟缓 5-连击
    WAR.L_WYJFA1 = 0;
    WAR.L_WYJFA2 = 0;
    WAR.L_WYJFA3 = 0;
    WAR.L_WYJFA4 = 0;
    WAR.L_WYJFA5 = 0;
    WAR.L_NSDF = {};		--南山刀法，有机率使被攻击的单位下回合受到的杀集气和伤害加倍
    WAR.L_NSDFCC = 0;		--南山刀法是否触发特效
    WAR.NSNS = {}  
    WAR.L_DG_X = 1;		--独孤求败被攻击的X
    WAR.L_DGQB_X = 1;		--独孤求败被攻击的X
    WAR.DR = {}		--豸苗：谢云流叠刃的X  
    WAR.DR_X = {}   --豸苗：谢云流叠刃的X  
    WAR.SHTY = 0 --豸苗：谢云流三环套月
    WAR.HGDF = {} --化功大法
    WAR.WZTS1 = {"无我无剑","三环套月","万剑归宗","八荒归元"}
    WAR.L_DG_ZS = {"独孤一式", "独孤二式", "独孤三式", "独孤四式", "独孤五式", "独孤六式","独孤七式", "独孤八式", "独孤九式", "独孤极意・无招胜有招"};
    WAR.L_DGQB_DEF = 0;		--初始没有，1被拳攻击，2被剑攻击，3被刀攻击，4被特攻击
    WAR.L_DGQB_ZS = {"独孤一式", "独孤二式", "独孤三式", "独孤四式", "独孤五式", "独孤六式","独孤七式", "独孤八式", "独孤九式", "独孤极意・无招胜有招"};
    WAR.L_DGQB_DEF_STR = {"破掌式", "破剑式", "破刀式", "破枪式", "破气式", "破箭式"} --武骧金星：增加暗器判定  
    WAR.L_DGQB_ZL = 0;		--召唤独孤求败，一次战场只限一次
    WAR.HB = {}----沼跃鱼：滕青山狐步
    WAR.HBPD = {}----沼跃鱼：滕青山狐步
    WAR.BHFJ = {}----沼跃鱼：白虎斗气反击
    WAR.JGBH = {}
    WAR.LXXL = {}
    WAR.KHNP1 = {}
    WAR.KHNP = {}
    WAR.NYZJ = {}
    WAR.ZYHB1 = {}
    WAR.XLFH = {}
    WAR.ZQK ={}
    WAR.ZQDL = {}
    WAR.BWAX = {}
    WAR.TMT = {}
  
  
	--门派指令
	--门派技能
	WAR.SXXYS = {} --三笑逍遥散
	WAR.SYWGZ = 0 --三阴蜈蚣爪
	WAR.SH = {} --锁喉
	WAR.ZBX = {} --醉八仙
	WAR.YFZ = {} --玉蜂针
	WAR.CLFJ = {} 	--飞影彩蛋：真龙心法反击
	WAR.XYFJ = {} --雪饮反击
	WAR.WQYJ = {} --无求易诀
	WAR.FGYJ = {} --反戈一击
	WAR.KHFJ = {} --葵花反击
	WAR.DGFJ = {} --独孤反击
	WAR.SLFJ = {} --森罗反击
	WAR.TM = {} --唐门反击
	WAR.JG = {} --金刚不坏
	WAR.BG = {} --武当八卦
	WAR.JD = {} --武骧金星：白驼山集毒
    WAR.JH = {} --武骧金星：桃花岛九花玉露
	WAR.WJ = {} --武当无极
	WAR.YRKG = {} --以柔克刚
	WAR.YJZD = {} --以静制动
	WAR.YJZD2 = {}
	WAR.YJZDPD = {}
	WAR.XJ = {} --血祭
	WAR.QX = 0 --潜行
	WAR.PD = {} --豸苗：谢云流破敌
	WAR.LW = {} --豸苗：谢云流乱流
	WAR.HUANXUE = {} --换血
	WAR.XUEMO = {} --血魔
    WAR.XUEFU={}
	WAR.WSDL = {}--密宗特系专精无上大力		
	WAR.CLXL = {}
	WAR.BH = {}
	WAR.LB = {}
	WAR.LBPD = {}
	WAR.BZ = {}
	WAR.MJTC = {}
	WAR.MJZB = {}
	WAR.MJZB2 ={}
	WAR.MJZBDS = {}
	WAR.MJCJ = 3
	WAR.MJBCJ = {}
	WAR.OWN = 1
	WAR.BHMJ=0----沼跃鱼：碧海幻境
	WAR.XXQG={}---沼跃鱼：日月神教捧月派吸星气攻
	WAR.XXQF={}---沼跃鱼：日月神教捧月派吸星气防
	WAR.XMPM = 0----沼跃鱼：罗汉堂嗔恶退散
	WAR.GBLJ = {} --丐帮连击点数
	WAR.BeiMeiHuo = 0	--被魅惑
	WAR.BeiHunluan = 0	--被混乱
	WAR.XIANSHU_COUNT_INONEACTION = 0 --只有第一次耗费体力内力
	WAR.YFS_COUNT = {}	--分身数目
	WAR.BSFH_COUNT = {}	 --变身复活数目
	WAR.YG_QG = {}	--消耗体力
	WAR.YG_NS = {}	--消除内伤
	WAR.BIANSHEN = {} --被变身的时序
	WAR.BIANSHEN_PID = {} --被变身的集合
	WAR.HUNLUAN	= {} -- 被混乱的集合
end

--显示非攻击时的点数
function War_Show_Count(id, str)

	local pid = WAR.Person[id]["人物编号"];
	local x = WAR.Person[id]["坐标X"];
	local y = WAR.Person[id]["坐标Y"];
	
	local hp = WAR.Person[id]["生命点数"];
    local mp = WAR.Person[id]["内力点数"];
    local tl = WAR.Person[id]["体力点数"];
    local ed = WAR.Person[id]["中毒点数"];
    local dd = WAR.Person[id]["解毒点数"];
    local ns = WAR.Person[id]["内伤点数"];
  
    local show = {x, y, nil, nil, nil, nil, nil, nil, nil, nil, nil};		--x, y, 生命, 内力, 体力, 封穴, 流血, 中毒, 解毒, 内伤
	
	if hp ~= nil and hp ~= 0 then		--显示生命
		if hp > 0 then
    	    show[3] = "命+"..hp;
        else
    	    show[3] = "命"..hp;
        end
	end
	
	if mp ~= nil and mp ~= 0 then		--显示内力
		if mp > 0 then
    	    show[4] = "内+"..mp;
        else
    	    show[4] = "内"..mp;
        end
	end
	
	if tl ~= nil and tl ~= 0 then		--显示体力
		if tl > 0 then
    	    show[5] = "体+"..tl;
        else
    	    show[5] = "体"..tl;
        end
	end
	
	
	if ed ~= nil and ed ~= 0 then		--显示中毒
        show[8] = "毒+"..ed;
	end
	
	if dd ~= nil and dd ~= 0 then		--显示解毒
        show[9] = "毒-"..dd;
	end
	
	if ns ~= nil and ns ~= 0 then		--显示内伤
		if ns > 0 then
    	    show[10] = ns;
        else
    	    --show[10] = "内伤↓ ";
        end
	end
	
	--记录哪个位置上有点数
	local showValue = {};
	local showNum = 0;
	for i=3, 10 do
		if show[i] ~= nil then
			showNum = showNum + 1;
			showValue[showNum] = i;
		end
	end

	if showNum == 0 then
		return;
	end
	
	
	local hb = GetS(JY.SubScene, x, y, 4);
	
	if CONFIG.Zoom == 1 then
        hb = hb * 2
    end
  
    local ll = string.len(show[showValue[1]]);	--长度
	
	local w = ll * CC.DefaultFont / 2 + 1
    local clip = {x1 = CC.XScale + CC.ScreenW / 2 - x - w/2, y1 = CC.YScale + CC.ScreenH / 2 - hb, x2 = CC.XScale + CC.ScreenW / 2 + w, y2 = CC.YScale + CC.ScreenH / 2 + CC.DefaultFont + 1}
	local area = (clip.x2 - clip.x1) * (clip.y2 - clip.y1) + 100		--绘画的范围
    local surid = lib.SaveSur(0, 0, CC.ScreenW, CC.ScreenH)		--绘画句柄
  
    local fastdraw = nil;
    if CONFIG.FastShowScreen == 0 or CC.AutoWarShowHead == 1 then
        fastdraw = 0
    else
        fastdraw = 1
    end
    for i = 5, 18 do
  	local tstart = lib.GetTime()
  	local y_off = i * 2 + 20
  	
  	--
  	if fastdraw == 1 and area < CC.ScreenW * CC.ScreenH / 2 then
  		local tmpclip = {x1 = clip.x1, y1 = clip.y1 - y_off, x2 = clip.x2, y2 = clip.y2 - y_off};
  		tmpclip = ClipRect(tmpclip)
        if tmpclip ~= nil then
            lib.SetClip(tmpclip.x1, tmpclip.y1, tmpclip.x2, tmpclip.y2)
            WarDrawMap(0)
			--显示文字
			if str ~= nil then
				DrawString(clip.x1 - #str*CC.Fontsmall/5, clip.y1 - y_off  - 110, str, C_WHITE, CC.Fontsmall);
			end
			
			for j=1, showNum do
				local c = showValue[j] - 1;
				if showValue[j] == 3 and string.sub(show[3],1,1) == "-" then		--减少生命，显示为红色
					c = 1;
				end
				DrawString(clip.x1, clip.y1 - y_off - (showNum-j+1)*30, show[showValue[j]], WAR.L_EffectColor[c], CC.DefaultFont); 	
			end       
        end
    else
    	lib.SetClip(0, 0, CC.ScreenW, CC.ScreenH)
        lib.LoadSur(surid, 0, 0)
        --显示文字
        if str ~= nil then
     		DrawString(clip.x1 - #str*CC.Fontsmall/5, clip.y1 - y_off - 110, str, C_WHITE, CC.Fontsmall);
     	end
        for j=1, showNum do
      	    local c = showValue[j] - 1;
      	    if showValue[j] == 3 and (string.sub(show[3],1,1) == "-" or string.sub(show[3],2,2) == "-") then		--减少生命，显示为红色
      		    c = 1;
      	    end
      	    DrawString(clip.x1, clip.y1 - y_off - (showNum-j+1)*30, show[showValue[j]], WAR.L_EffectColor[c], CC.DefaultFont); 	
        end 
  	end
  	
  	ShowScreen(1)
    lib.SetClip(0, 0, 0, 0)		--清除
    local tend = lib.GetTime()
    if tend - tstart < CC.Frame then
        lib.Delay(CC.Frame - (tend - tstart) + 10)
    end
    end
  
    WAR.Person[id]["生命点数"] = nil;
    WAR.Person[id]["内力点数"] = nil;
    WAR.Person[id]["体力点数"] = nil;
    WAR.Person[id]["中毒点数"] = nil;
    WAR.Person[id]["解毒点数"] = nil;
    WAR.Person[id]["内伤点数"] = nil;
  
    lib.FreeSur(surid)
end

--显示人物的战斗信息，包括头像，生命，内力等
function WarShowHead(id)
    if not id then
        id = WAR.CurID
    end
    if id < 0 then
        return 
    end
    local pid = WAR.Person[id]["人物编号"]
    local p = JY.Person[pid]
    local h = 18
    local width = 160 + 2 * CC.MenuBorderPixel
    local height = 160 + 2 * CC.MenuBorderPixel + 4 * h
    local x1, y1 = nil, nil
    local sx, sy = nil, nil
    local i = 1
    if WAR.Person[id]["我方"] == true then
       x1 = CC.ScreenW - width - 10
       y1 = CC.ScreenH - height - 10 - 120
       DrawBox(x1, y1, x1 + width, y1 + height + 120, C_WHITE)
	   sx = x1 - 25
	   sy = y1 + 20
    else
       x1 = 10
       y1 = 10
       DrawBox(x1, y1, x1 + width, y1 + height + 100, C_WHITE)
	   sx = x1 + width + 25
	   sy = y1	+ 20
    end

  
    local headw, headh = lib.PicGetXY(1, p["头像代号"] * 2)
    local headx = (160 - headw) / 2
    local heady = (100 - headh) / 2
    local dr = 0 --1-29-
	--lib.PicLoadFile(CONFIG.DataPath .. "head.idx", CONFIG.DataPath .. "head.grp", 55)
	  
    lib.PicLoadCache(1, gethead(pid) * 2, x1 + 10, y1 + 10, 1)

    --飞影在以下部分作了【醉武成痴】的回合数显示的修改：
    if WAR.Person[id]["我方"] == false and XYL(0) then
        if WAR.DR_X[WAR.Person[id]["人物编号"]] ~= nil and WAR.DR_X[WAR.Person[id]["人物编号"]] > 0 then 
     	   dr = WAR.DR_X[WAR.Person[id]["人物编号"]]  
        else 
	       dr = 0	
        end
        if dr > 5 then 
	       dr = 5 
        end	
        --DrawString(x1 + 75, y1 + 59, "叠刃 "..math.modf(dr), C_GOLD, 22)	--飞影：把【叠刃】放到下面去一起计算显示，不然不好排
    end
        --DrawString(x1 + 75, y1 + 15, "战意 "..math.modf(WAR.SPIRIT[pid]), C_RED, 22)	--飞影：因为标主可能有三个要显示的战斗参数，所以要把字改小一点
        DrawString(x1 + 75, y1 + 5, "战意 "..math.modf(WAR.SPIRIT[pid]), C_RED, 17)
        local chain = 0
        local yyhj = 0
        local jq = 0
        local zwcc = 0	--飞影：定义醉武成痴显示系数
    if WAR.Person[WAR.CurID]["我方"] then
	    chain = WAR.MYCHAIN
    else
	    chain = WAR.URCHAIN
    end
    if pid == 0 and zjtype() == 1 then
        yyhj = WAR.YYHJ
    end	
    if MPPD(pid) == 11 then
        if WAR.JQ[pid] ~= nil and WAR.JQ[pid] > 0 then 
            jq = WAR.JQ[pid]
	    else 
	        jq = 0
	    end
    end
    if hasTF(pid, 24) then		--飞影：醉武成痴显示等于WAR.ZBT
	    if WAR.ZBT[pid] ~= nil and WAR.ZBT[pid] > 0 then
		    zwcc = WAR.ZBT[pid]
	    else
		    zwcc = 0
	    end
    end
    --[[if WAR.Person[WAR.CurID]["我方"] == false and XYL(0) then
        if WAR.DR_X[pid] ~= nil and WAR.DR_X[pid] > 0 then 
           dr = WAR.DR_X[pid]
	    else 
	       dr = 0
	    end
	       DrawString(x1 + 75, y1 + 59, "叠刃 "..math.modf(dr), C_GOLD, 22)
    end ]]

    --飞影：原来的显示内容
    --[[    				  
	DrawString(x1 + 75, y1 + 37, "连锁 "..math.modf(chain), C_GOLD, 22)
	if pid == 0 and zjtype() == 1 then
	DrawString(x1 + 75, y1 + 59, "汇聚 "..math.modf(yyhj), C_GOLD, 22)
	elseif MPPD(pid) == 11 then 
	DrawString(x1 + 75, y1 + 59, "剑气 "..math.modf(jq), C_GOLD, 22)
	end --1-29-
    ]]

     --飞影：改成下面的显示方式：
  	local dyy = 22
		DrawString(x1 + 75, y1 + dyy, "连锁 "..math.modf(chain), C_GOLD, 17)
		dyy = dyy + 17
	if pid == 0 and zjtype() == 1 then
		DrawString(x1 + 75, y1 + dyy, "汇聚 "..math.modf(yyhj), C_GOLD, 17)
		dyy = dyy + 17
	end
	if WAR.Person[id]["我方"] == false and XYL(0) then
		DrawString(x1 + 75, y1 + dyy, "叠刃 "..math.modf(dr), C_GOLD, 17)
		dyy = dyy + 17
	end
	if MPPD(pid) == 11 then
		DrawString(x1 + 75, y1 + dyy, "剑气 "..math.modf(jq), C_GOLD, 17)
		dyy = dyy + 17
	end
	if hasTF(pid, 24) then
		DrawString(x1 + 75, y1 + dyy, "武痴 "..math.modf(zwcc), C_GOLD, 17)
		dyy = dyy + 17
	end

    --飞影在以上部分做了【醉武成痴】的回合数显示的修改

    MyDrawString(x1, x1 + 160, y1 + 70, p["姓名"], C_WHITE, 30)
    MyDrawString(x1, x1 + 160, y1 + 98, "【"..gettitle(pid).."】", C_GOLD, 20)
	if yongnei(p["声望"]) then
		MyDrawString(x1, x1 + 165, y1 + 120, "主运:"..JY.Wugong[p["声望"]]["名称"], C_RED, 20) --(x1 + size * 8 - 18, y1 + h2 * i, "主功体:".."【"..JY.Wugong[p["声望"]]["名称"].."】", M_Wheat, size2)
	else
		MyDrawString(x1, x1 + 165, y1 + 120, "主运:".."无", C_RED, 20)--DrawString(x1 + size * 8 - 18, y1 + h2 * i, "主功体:".."【无】", M_Wheat, size2)
	end
    x1 = x1 + 5
    y1 = y1 + 5 + 100 
    local color = nil
    if p["受伤程度"] < p["中毒程度"] then
        if p["中毒程度"] == 0 then
            color = RGB(252, 148, 16)
        elseif p["中毒程度"] < 50 then
            color = RGB(120, 208, 88)
    else
            color = RGB(56, 136, 36)
        end
        elseif p["受伤程度"] < 33 then
            color = RGB(236, 200, 40)
        elseif p["受伤程度"] < 66 then
            color = RGB(244, 128, 32)
    else
            color = RGB(232, 32, 44)
    end
  
    y1 = y1 + 35 
    local hp = math.modf(p["生命"] * 160 / p["生命最大值"])
    local mp = math.modf(p["内力"] * 160 / p["内力最大值"])
    local tp = math.modf(p["体力"] * 160 / 100)
    local lqz = math.modf((WAR.LQZ[pid] or 0) * 160 /100);		--怒气
    local zd = math.modf(p["中毒程度"] * 160 / 100)	--中毒
  
    lib.PicLoadCache(0, 4507*2, x1, y1, 1)				
    lib.PicLoadCache(0, 4507*2, x1, y1 + 25, 1)
    lib.PicLoadCache(0, 4507*2, x1, y1 + 50, 1)
    lib.PicLoadCache(0, 4507*2, x1, y1 + 75, 1)
    --lib.PicLoadCache(0, 4507*2, x1, y1 + 100, 1)
  
    lib.SetClip(x1, y1, x1 + hp, y1 + 25)  
    lib.PicLoadCache(0, 4506*2, x1, y1, 1)
    lib.SetClip(x1, y1 + 30, x1 + mp, y1 + 50)
    lib.PicLoadCache(0, 4505*2, x1, y1 + 25, 1)
    lib.SetClip(x1, y1 + 30, x1 + tp, y1 + 75)
    lib.PicLoadCache(0, 4508*2, x1, y1 + 50, 1)
  
    lib.SetClip(x1, y1 + 30, x1 + lqz, y1 + 100)
    lib.PicLoadCache(0, 4506*2, x1, y1 + 75 , 1)
  
    --lib.SetClip(x1, y1 + 30, x1 + zd, y1 + 125)
    --lib.PicLoadCache(0, 4509*2, x1, y1 + 100 , 1)
  
    lib.SetClip(0, 0, 0, 0)
  
    DrawString(x1 + 10, y1 + 5, "生命", C_WHITE, 16)
    DrawString(x1 + 10, y1 + 30, "内力", C_WHITE, 16)
    DrawString(x1 + 10, y1 + 55, "体力", C_WHITE, 16)
    DrawString(x1 + 10, y1 + 80, "怒气", C_WHITE, 16)
    --DrawString(x1 + 10, y1 + 105, "中毒", C_WHITE, 16)
  
    local lifexs = p["生命"]
    local nlxs = p["内力"]
    local tlxs = p["体力"]
    local lqzxs = WAR.LQZ[pid] or 0;
    local zdxs = p["中毒程度"]
  
    --已方才显示的
    local nsxs = p["受伤程度"];		--内伤
    local fxxs = WAR.FXDS[pid] or 0;		--封穴
    local lxxs = WAR.LXZT[pid] or 0;		--流血
    local chxs = WAR.CHZ[pid] or 0;		--迟缓
    local ice = WAR.ICE[pid] or 0;		
    local hot = WAR.HOT[pid] or 0;
	local mbxs = WAR.MABI[pid] or 0;
  
    DrawString(x1 + 10 + 37, y1 + 5, lifexs, C_WHITE, 16)
    DrawString(x1 + 10 + 37, y1 + 30, nlxs, C_WHITE, 16)
    DrawString(x1 + 10 + 37, y1 + 55, tlxs, C_WHITE, 16)
    DrawString(x1 + 10 + 37 + 18, y1 + 80, lqzxs, C_WHITE, 16)
  
   -- DrawString(x1 + 10 + 18 + 18, y1 + 105, zdxs, C_WHITE, 16)		--中毒
  
    if WAR.Person[id]["我方"] == true then
  	   local myx1 = 0;
  	   local myy1 = 0;
  	   DrawString(x1 + 3 + myx1, y1 + 110, "内伤:", C_WHITE, 16)
  	   DrawString(x1 + 18*2 + 10, y1 + 110, nsxs, C_RED, 16)		--内伤
  	   myx1 = myx1 + 18 * 5;
  	
	   DrawString(x1 + (myx1-5), y1 + 110, "中毒:", C_WHITE, 16)
  	   DrawString(x1 + (myx1-5) + 18*2 + 10, y1 + 110, zdxs, M_Lime, 16)	
	
  	   DrawString(x1 + (myx1-5), y1 + 130, "流血:", C_WHITE, 16)
  	   DrawString(x1 + (myx1-5) + 18*2 + 10, y1 + 130, lxxs, M_Pink, 16)		--流血
	
	--攻，防，轻，血，盲目/封印，禁足/不动，迷茫/魅惑，隐蔽，火/冰
	local sm = {
			{{WAR.QFY2, 4376,"鼓舞"..string.format("%s", WAR.QFY2[pid]or 0).."时序"}, {WAR.WYY, 4377,"点破"..string.format("%s", WAR.WYY[pid]or 0).."时序"}, {WAR.ATKDOWN, 4377,"破兵"..string.format("%s", WAR.ATKDOWN[pid]or 0).."时序"}},
			{{WAR.QFY3, 4378,"铁壁"..string.format("%s", WAR.QFY3[pid]or 0).."时序"}, {WAR.DEFDOWN, 4379,"破甲"..string.format("%s", WAR.DEFDOWN[pid]or 0).."时序"}},
			{{WAR.QFY1, 4380,"神行"..string.format("%s", WAR.QFY1[pid]or 0).."时序"}, {WAR.DYWY, 4380,"神照"..string.format("%s", WAR.DYWY[pid]or 0).."时序"}, {WAR.QIZHEN, 4381,"奇阵"..string.format("%s", WAR.QIZHEN[pid]or 0).."时序"}, {WAR.SPDDOWN, 4381,"羁绊"..string.format("%s", WAR.SPDDOWN[pid]or 0).."时序"}},
			{{WAR.L_HQNZL, 4382,"补益"..string.format("%s", WAR.L_HQNZL[pid]or 0).."时序"}, {WAR.L_WNGZL, 4383,"毒击"..string.format("%s", WAR.L_WNGZL[pid]or 0).."时序"}},
			{{WAR.KHCM, 4384,"盲目"}, {WAR.BZ, 4387,"封印"}},
			{{WAR.L_NOT_MOVE, 4386,"缠足"}, {WAR.SH, 4391,"锁喉"..string.format("%s", WAR.SH[pid]or 0).."时序"}, {WAR.YJZD, 4391,"太极"..string.format("%s", WAR.YJZD[pid]or 0).."时序"}, {WAR.JG, 4391,"金刚"..string.format("%s", WAR.JG[pid]or 0).."时序"}, {WAR.SZWH, 4390,"晕眩"..string.format("%s", WAR.SZWH[pid]or 0).."时序"}},
			{{WAR.GUDUVICTIE, 4397,"蛊毒"..string.format("%s", WAR.GUDUVICTIE[pid]or 0).."回合"},{WAR.KMSHJQ, 4397,"空明"}},
			{{WAR.NPC, 4389,"魅惑"..string.format("%s", WAR.NPC[pid]or 0).."时序"}, {WAR.CONFUSE, 4385,"混乱"..string.format("%s", WAR.CONFUSE[pid]or 0).."时序"}},
			{{WAR.HIDE, 4388,"隐蔽"..string.format("%s", WAR.HIDE[pid]or 0).."时序"}},		
			{{WAR.PEACE, 4398,"冰心"..string.format("%s", WAR.PEACE[pid]or 0).."时序"}},
			{{WAR.ZDNS, 4395,"重伤"..string.format("%s", WAR.ZDNS[pid]or 0).."时序"}},
			{{WAR.HDGX, 4392,"火毒"},{WAR.NHH, 4392,"业火"..string.format("%s", WAR.NHH[pid]or 0).."回合"}},
			{{WAR.YHZJ, 4393,"寒毒"},{WAR.NBH, 4393,"幽冥"..string.format("%s", WAR.NBH[pid]or 0).."回合"}},
			{{WAR.BG, 4396,"八卦"..string.format("%s", WAR.BG[pid]or 0).."层"}},
			{{WAR.WJ, 4396,"无极"..string.format("%s", WAR.WJ[pid]or 0).."层"}},
		--{{WAR.YHZJ, 4393,"陷阱：寒毒侵脉"},{WAR.NBH, 4393,"幽冥"..string.format("%s", WAR.NBH[pid]or 0).."时序"}},	
		
	}
	
	for i = 1, #sm do
		local count = 0
		for j = 1, #sm[i] do
			if sm[i][j][1][pid] ~= nil then
				DrawBox(sx-20, sy-20, sx+20, sy+20, C_WHITE)
				lib.PicLoadCache(0,sm[i][j][2]*2,sx, sy, 0, 256);	
				DrawString(sx-115,sy-10,sm[i][j][3],C_WHITE, 18)
				count = 1
			end
		end		
		if count ~= 0 then
			sy = sy + 40
		end
	end

	
	myx1 = 0;
	myy1 = 20;
  	DrawString(x1 + 3 + myx1, y1 + 110 + myy1, "封穴:", C_WHITE, 16)
  	DrawString(x1 + 18*2 + 10, y1 + 110 + myy1, fxxs, RGB(255, 236, 150), 16)		--封穴
  	myx1 = myx1 + 18 * 5;
  	
		DrawString(x1 + (myx1-5), y1 + 130 + myy1, "迟缓:", C_WHITE, 16)
  	DrawString(x1 + (myx1-5) + 18*2 + 10, y1 + 130 + myy1, chxs, RGB(173, 216, 230), 16)		--迟缓
  	
		myx1 = 0;
		myy1 = 40;
	DrawString(x1 + 3 + myx1, y1 + 110 + myy1, "麻痹:", C_WHITE, 16)
  	DrawString(x1 + 18*2 + 10, y1 + 110 + myy1, mbxs, RGB(119, 136, 153), 16)--麻痹	
  	DrawString(x1 + 3 + myx1, y1 + 130 + myy1, "冰封:", C_WHITE, 16)
  	DrawString(x1 + 18*2 + 10, y1 + 130 + myy1, ice, M_DeepSkyBlue, 16)		
  	myx1 = myx1 + 18 * 5;
  	
		DrawString(x1 + (myx1-5), y1 + 130 + myy1, "灼烧:", C_WHITE, 16)
  	DrawString(x1 + (myx1-5) + 18*2 + 10, y1 + 130 + myy1, hot, M_Orange, 16)		
	
  	myx1 = 0;
		myy1 = 60;
	--队友攻击力加成
	local atk = 0;
	for i,v in pairs(CC.AddAtk) do
	    if v[1] == pid then
	        for wid = 0, WAR.PersonNum - 1 do
	            if WAR.Person[wid]["人物编号"] == v[2] and WAR.Person[wid]["死亡"] == false then
	                atk = atk + v[3]
			        if hasTF(pid, 129) then
				        atk = atk + v[3]
			        end				  
	            end
	        end
	    end
	if DT1(pid,v[1]) and DT1(pid,v[2]) then
		atk = atk + v[3]
		end
	end
	  
	  
	--队友防御力加成
	local def = 0;
	for i,v in pairs(CC.AddDef) do
	    if v[1] == pid then
	        for wid = 0, WAR.PersonNum - 1 do
	            if WAR.Person[wid]["人物编号"] == v[2] and WAR.Person[wid]["死亡"] == false then
	                def = def + v[3]
			        if hasTF(pid, 129) then
				        def = def + v[3]
			        end				  
	            end
	        end
	    end
	if DT1(pid,v[1]) and DT1(pid,v[2]) then
		def = def + v[3]
	    end
	end
	  
	--队友轻功加成
	local spd = 0;
	for i,v in pairs(CC.AddSpd) do
	    if v[1] == pid then
	        for wid = 0, WAR.PersonNum - 1 do
	            if WAR.Person[wid]["人物编号"] == v[2] and WAR.Person[wid]["死亡"] == false then
	                spd = spd + v[3]
			        if hasTF(pid, 129) then
				        spd = spd + v[3]
			        end				  
	            end
	        end
	    end
	if DT1(pid,v[1]) and DT1(pid,v[2]) then
		spd = spd + v[3]
		end
	end
	  
	local color = C_WHITE;
	local ac, dc, sc = color,color,color;
	if atk > 0 then
	  	ac = RGB(204,255,102);
	end
	if def > 0 then
	  	dc = RGB(204,255,102);
	end
	if spd > 0 then
	  	sc = RGB(204,255,102);
	end
	if WAR.Person[id]["我方"] then
		DrawString(x1 + 3, y1 + 130 + myy1, "攻:"..atk, ac, 16)		--队友加成
		DrawString(x1 + 18*3 + 10, y1 + 130 + myy1, "防:"..def, dc, 16)		--队友加成
		DrawString(x1 + 18*6 + 10, y1 + 130 + myy1, "轻:"..spd, sc, 16)		--队友加成
	end
    else
    	--[[local myx1 = 0;
		local myy1 = 40;
    lib.PicLoadCache(0,4368*2,x1 + 3, y1 + 130 + myy1 + 20, 2, 256)]]
  
		if WAR.Person[id]["我方"] == false then
			local myx1 = 0;
		   local myy1 = 0;
		   DrawString(x1 + 3 + myx1, y1 + 110, "内伤:", C_WHITE, 16)
		   DrawString(x1 + 18*2 + 10, y1 + 110, nsxs, C_RED, 16)		--内伤
		   myx1 = myx1 + 18 * 5;
		
		   DrawString(x1 + (myx1-5), y1 + 110, "中毒:", C_WHITE, 16)
		   DrawString(x1 + (myx1-5) + 18*2 + 10, y1 + 110, zdxs, M_Lime, 16)	
		
		   DrawString(x1 + (myx1-5), y1 + 130, "流血:", C_WHITE, 16)
		   DrawString(x1 + (myx1-5) + 18*2 + 10, y1 + 130, lxxs, M_Pink, 16)		--流血
		local sm = {
			{{WAR.QFY2, 4376,"鼓舞"..string.format("%s", WAR.QFY2[pid]or 0).."时序"}, {WAR.WYY, 4377,"点破"..string.format("%s", WAR.WYY[pid]or 0).."时序"}, {WAR.ATKDOWN, 4377,"破兵"..string.format("%s", WAR.ATKDOWN[pid]or 0).."时序"}},
			{{WAR.QFY3, 4378,"铁壁"..string.format("%s", WAR.QFY3[pid]or 0).."时序"}, {WAR.DEFDOWN, 4379,"破甲"..string.format("%s", WAR.DEFDOWN[pid]or 0).."时序"}},
			{{WAR.QFY1, 4380,"神行"..string.format("%s", WAR.QFY1[pid]or 0).."时序"}, {WAR.DYWY, 4380,"神照"..string.format("%s", WAR.DYWY[pid]or 0).."时序"}, {WAR.QIZHEN, 4381,"奇阵"..string.format("%s", WAR.QIZHEN[pid]or 0).."时序"}, {WAR.SPDDOWN, 4381,"羁绊"..string.format("%s", WAR.SPDDOWN[pid]or 0).."时序"}},
			{{WAR.L_HQNZL, 4382,"补益"..string.format("%s", WAR.L_HQNZL[pid]or 0).."时序"}, {WAR.L_WNGZL, 4383,"毒击"..string.format("%s", WAR.L_WNGZL[pid]or 0).."时序"}},
			{{WAR.KHCM, 4384,"盲目"}, {WAR.BZ, 4387,"封印"}},
			{{WAR.L_NOT_MOVE, 4386,"缠足"}, {WAR.SH, 4391,"锁喉"..string.format("%s", WAR.SH[pid]or 0).."时序"}, {WAR.YJZD, 4391,"太极"..string.format("%s", WAR.YJZD[pid]or 0).."时序"}, {WAR.JG, 4391,"金刚"..string.format("%s", WAR.JG[pid]or 0).."时序"}, {WAR.SZWH, 4390,"晕眩"..string.format("%s", WAR.SZWH[pid]or 0).."时序"}},
			{{WAR.GUDUVICTIE, 4397,"蛊毒"..string.format("%s", WAR.GUDUVICTIE[pid]or 0).."回合"},{WAR.KMSHJQ, 4397,"空明"}},
			{{WAR.NPC, 4389,"魅惑"..string.format("%s", WAR.NPC[pid]or 0).."时序"}, {WAR.CONFUSE, 4385,"混乱"..string.format("%s", WAR.CONFUSE[pid]or 0).."时序"}},
			{{WAR.HIDE, 4388,"隐蔽"..string.format("%s", WAR.HIDE[pid]or 0).."时序"}},		
			{{WAR.PEACE, 4398,"冰心"..string.format("%s", WAR.PEACE[pid]or 0).."时序"}},
			{{WAR.ZDNS, 4395,"重伤"..string.format("%s", WAR.ZDNS[pid]or 0).."时序"}},
			{{WAR.HDGX, 4392,"火毒"},{WAR.NHH, 4392,"业火"..string.format("%s", WAR.NHH[pid]or 0).."回合"}},
			{{WAR.YHZJ, 4393,"寒毒"},{WAR.NBH, 4393,"幽冥"..string.format("%s", WAR.NBH[pid]or 0).."回合"}},
			{{WAR.BG, 4396,"八卦"..string.format("%s", WAR.BG[pid]or 0).."层"}},
			{{WAR.WJ, 4396,"无极"..string.format("%s", WAR.WJ[pid]or 0).."层"}},
			--{{WAR.YHZJ, 4393,"陷阱：寒毒侵脉"},{WAR.NBH, 4393,"幽冥"..string.format("%s", WAR.NBH[pid]or 0).."时序"}},	
			
		}
		
		for i = 1, #sm do
			local count = 0
			for j = 1, #sm[i] do
				if sm[i][j][1][pid] ~= nil then
					DrawBox(sx-20, sy-20, sx+20, sy+20, C_WHITE)
					lib.PicLoadCache(0,sm[i][j][2]*2,sx, sy, 0, 256);	
					DrawString(sx+32,sy-10,sm[i][j][3],C_WHITE, 18)
					count = 1
				end
			end		
			if count ~= 0 then
				sy = sy + 40
			end
		end
		myx1 = 0;
		myy1 = 20;
		DrawString(x1 + 3 + myx1, y1 + 110 + myy1, "封穴:", C_WHITE, 16)
		DrawString(x1 + 18*2 + 10, y1 + 110 + myy1, fxxs, RGB(255, 236, 150), 16)		--封穴
		myx1 = myx1 + 18 * 5;
		
			DrawString(x1 + (myx1-5), y1 + 130 + myy1, "迟缓:", C_WHITE, 16)
		DrawString(x1 + (myx1-5) + 18*2 + 10, y1 + 130 + myy1, chxs, RGB(173, 216, 230), 16)		--迟缓
		
			myx1 = 0;
			myy1 = 40;
		DrawString(x1 + 3 + myx1, y1 + 110 + myy1, "麻痹:", C_WHITE, 16)
		DrawString(x1 + 18*2 + 10, y1 + 110 + myy1, mbxs, RGB(119, 136, 153), 16)--麻痹	
		DrawString(x1 + 3 + myx1, y1 + 130 + myy1, "冰封:", C_WHITE, 16)
		DrawString(x1 + 18*2 + 10, y1 + 130 + myy1, ice, M_DeepSkyBlue, 16)		
		myx1 = myx1 + 18 * 5;
		
			DrawString(x1 + (myx1-5), y1 + 130 + myy1, "灼烧:", C_WHITE, 16)
		DrawString(x1 + (myx1-5) + 18*2 + 10, y1 + 130 + myy1, hot, M_Orange, 16)
		DrawBox(x1 - 5, y1 + 98 + 40 + 75, x1 + width - 5, y1 + 260 + 75, C_WHITE)
		local hl = 1
			for i = 1, 4 do
				local wp = p["携带物品" .. i]
				local wps = p["携带物品数量" .. i]
				if wp >= 0 then
					local wpm = JY.Thing[wp]["名称"]
					DrawString(x1, y1 + 185 + hl * 30, wpm .. wps, C_WHITE, 25)
					hl = hl + 1
				end
			end
		end
	end	
end

--自动选择合适的武功
function War_AutoSelectWugong()
    local pid = WAR.Person[WAR.CurID]["人物编号"]
    local probability = {}
    local wugongnum = 10
    for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
    local wugongid = JY.Person[pid]["武功" .. i]
    if wugongid > 0 then 
        if JY.Wugong[wugongid]["伤害类型"] == 0 then
      
      	--选择杀生命的武功，必须消耗内力比现有内力小，起码可以发出一级的武功。
        if JY.Wugong[wugongid]["消耗内力点数"] <= JY.Person[pid]["内力"] then
          local level = math.modf(JY.Person[pid]["武功等级" .. i] / 100) + 1
		  if level > 10 then level = 10 end
          probability[i] = (JY.Person[pid]["攻击力"] * 3 + WGWL(pid, wugongid, level)) / 2 --JY.Wugong[wugongid]["攻击力" .. level]
        else
          probability[i] = 0
        end
        
        --内功攻击
        --if inteam(pid) and WAR.Person[WAR.CurID]["我方"] then
        	--蓝烟清：新逆运走火状态下可以使用逆运神功攻击
        if WAR.Person[WAR.CurID]["我方"] then  
		if yongnei(wugongid) then
          	if WAR.L_NYZH[pid] ~= nil and wugongid == 104 then
          				
			elseif i == 1 and pid == 0 and GetS(103, 0, 0, 1) > 0 then
			
			elseif not inteam(pid) and i == 1 then
			
			elseif wugongid == 105 and (DT(pid, 36) or DT(pid, 27)) then		--林平之 显示葵花神功
          	
          	elseif wugongid == 102 and (DT(pid, 38) or wglw(pid,102) or T5BCF(pid)) then		--石破天 显示太玄神功
          	
          	elseif wugongid == 106 and DT(pid, 9) then		--张无忌 显示九阳神功
          	
          	elseif wugongid == 94 and DT(pid, 37) then		----狄云 显示神经照
			
			elseif wugongid == 93 and DT(pid, 66) then		----小昭 显示圣火
			
			elseif wugongid == 98 and (DT(pid, 116) or DT(pid, 118)) then	--李秋水 显示小无相
			
			elseif wugongid == 43 and (DT(pid, 51) or DT(pid, 113)) then --慕容父子显示斗转
          		
            elseif (wugongid == 104 or wugongid == 95) and (DT(pid, 60) or DT(pid, 620)) then --欧阳锋显示逆运蛤蟆
			
			elseif wugongid == 95 and DT(pid, 61) then --欧阳克显示蛤蟆
			
			elseif PersonKF(pid, 98) and wugongid == 98 then
			
			elseif (pid == 0 and putong() == 5) or ngattack(pid) then			--天罡才可以使用内功
            	
            else
            	probability[i] = 0
            end
        end
		end
        
        --吸功不可攻击
        if wugongid == 85 or wugongid == 87 or wugongid == 88  then
            probability[i] = 0
        end
        
		if wugongid == 115 or wugongid == 116 or wugongid == 117  
			or wugongid == 118 or wugongid == 119  or wugongid == 143 or wugongid == 179 
			or (wugongid >= 190 and wugongid <= 200) or wugongid == 205 then --轻功不可攻击
			probability[i] = 0
		end
		
        --斗转星移
        if wugongid == 43 and not DT(pid, 113) and not DT(pid, 51) then
            if pid == 0 and putong() == 5 then
          	    probability[i] = 0
            else
          	    probability[i] = 0
            end
        end
        
        --张三丰不用纯阳么
        if wugongid == 99 and pid == 5 then
            probability[i] = 0
        end
        
		if wugongid == 100 and pid == 64 then --老顽童不用先天
			probability[i] = 0
		end
		
		if wugongid == 108 and pid == 50 then --乔峰不用易筋
			probability[i] = 0
		end
		
		if wugongid == 9 and pid == 60 then --欧阳锋不用雪山掌
			probability[i] = 0
		end
		
		if (wugongid == 22 or wugongid == 24) and pid == 114 then --扫地不用两个掌法
			probability[i] = 0
		end
		
		if WAR.Person[WAR.CurID]["我方"] == false then
			if yongnei(wugongid) then
				if i == 1 then

				elseif wugongid == 104 and pid == 60 then
				
				elseif wugongid == 95 and pid == 61 then
				
				elseif wugongid == 98 and (pid == 118 or pid == 116) then
				
				else
					probability[i] = 0
				end
			end
		end	
		
		if (wugongid == 100 or wugongid == 107) and pid == 64 then --周伯通不用内功
			probability[i] = 0
		end
		
        --李b元，不可使用内功攻击
        --if pid == 92 and yongnei(wugongid) then
        --  probability[i] = 0
        --end

      else
        probability[i] = 0		 --很小的概率选择杀内力 nino: 改成0几率
      end
    else
      wugongnum = i - 1
      break;
    end
	  
    end
  
    if wugongnum ==  0 then			--如果没有武功，直接返回-1
  	   return -1;
    end

	local maxoffense = 0		--计算最大攻击力
	for i = 1, wugongnum do
	    if maxoffense < probability[i] then
	        maxoffense = probability[i]
	    end
	end
	
	local mynum = 0			--计算我方和敌人个数
	local enemynum = 0
	for i = 0, WAR.PersonNum - 1 do
	    if WAR.Person[i]["死亡"] == false then
	        if WAR.Person[i]["我方"] == WAR.Person[WAR.CurID]["我方"] then
	            mynum = mynum + 1
	        else
	    	    enemynum = enemynum + 1
	        end
	    end
	end
	
	
	local factor = 0		--敌人人数影响因子，敌人多则对线面等攻击多人武功的选择概率增加
	if mynum < enemynum then
	    factor = 2
	else
	    factor = 1
	end
	
	for i = 1, wugongnum do		--考虑其他概率效果
	    local wugongid = JY.Person[pid]["武功" .. i]
	    if probability[i] > 0 then
	        if probability[i] < maxoffense - 300 then		--去掉攻击力小的武功
	            probability[i] = 0
	        end
	        local extranum = 0			--武功武器配合的攻击力
	        for j,v in ipairs(CC.ExtraOffense) do
	            if v[1] == JY.Person[pid]["武器"] and v[2] == wugongid then
	                extranum = v[3]
	                break;
	            end
	        end
	        local level = math.modf(JY.Person[pid]["武功等级" .. i] / 100) + 1
		    if level > 10 then level = 10 end
	            probability[i] = probability[i] + JY.Wugong[wugongid]["攻击范围"] * factor * JY.Wugong[wugongid]["杀伤范围" .. level] * 20
	        end
	end
	
	local s = {}		--按照概率依次累加
	local maxnum = 0
	for i = 1, wugongnum do
	    s[i] = maxnum
	    maxnum = maxnum + probability[i]
	end
	s[wugongnum + 1] = maxnum
	if maxnum == 0 then		--没有可以选择的武功
	    return -1
	end
	
	local v = Rnd(maxnum)		 --产生随机数
	local selectid = 0
	for i = 1, wugongnum do		--根据产生的随机数，寻找落在哪个武功区间
	    if s[i] <= v and v < s[i + 1] then
	        selectid = i
  	    end
	end
	return selectid
end

--战斗武功选择菜单
function DIY_War_FightMenu(aa,bb,k)
    local pid = WAR.Person[WAR.CurID]["人物编号"]
    local numwugong = 0
    local menu = {}
    local canuse = {}
    local c = 0
    if k == nil then
  	   k = 0
    end
    for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
    local tmp = JY.Person[pid]["武功" .. i]
    if tmp > 0 then
      if JY.WGLVXS == 1 then
        menu[i] = {JY.Wugong[tmp]["名称"] .. "・" .. JY.Person[pid]["武功等级" .. i], nil, 1}
      else
        menu[i] = {JY.Wugong[tmp]["名称"], nil, 1}
      end
      
      --内力少不显示
      if JY.Person[pid]["内力"] < JY.Wugong[tmp]["消耗内力点数"] then
        menu[i][3] = 0
      end
      	  
      --如果不是游坦之，内功武功不显示
      --if pid ~= 48 and tmp > 88 and tmp < 109 and tmp ~= 92 then
      if not ngattack(pid) and yongnei(tmp) then  
		menu[i][3] = 0
      end
      
	  if (tmp >=115 and tmp <=119) or (tmp >= 190 and tmp <= 200) or tmp == 205 then --轻功不显示
		menu[i][3] = 0
	  end
	  
	  if tmp == 121 then --玉女心经不显示
		menu[i][3] = 0
	  end
	  
	  if tmp == 143 then --一苇渡江不显示
		menu[i][3] = 0
	  end
	  if tmp == 179 then --凌波微步不显示
		menu[i][3] = 0
	  end
      --如果主角是天罡，内功武功显示
      if ((PersonKF(pid, 98) and tmp == 98) or (pid == 0 and putong() == 5)) and yongnei(tmp) and
  	  not (tmp == 85 or tmp == 87 or tmp == 88) then
        menu[i][3] = 1
      end

	  if i == 1 and pid == 0 and GetS(103, 0, 0, 1) > 0 and
  	  not (tmp == 85 or tmp == 87 or tmp == 88) then --nino：伪主角如果第一个武功是内功则可以使用 --武骧金星：移动一下顺序避免吸功可以使用
	  	menu[i][3] = 1
	  end
      
      --北冥神功、化功大法、吸星大法、斗转星移不显示
      if tmp == 85 or tmp == 87 or tmp == 88 or tmp == 43 then
        menu[i][3] = 0
      end
	  
      --林平之 显示葵花神功
      if tmp == 105 and (DT(pid, 36) or DT(pid, 27)) then
        menu[i][3] = 1
      end
	  
	  if tmp == 98 and (DT(pid, 116) or DT(pid , 118)) then
		menu[i][3] = 1
	  end
	  
	  if tmp == 108 and DT(pid, 114) then
		menu[i][3] = 1
	  end
	  
	  --[[ 武骧金星：这个恐怕是写错了
	  if tmp == 66 and DT(pid, 93) then
		menu[i][3] = 1
	  end
	  ]]
	  
	  --[[
		if i == 1 and GetS(103, 0, 0, 0) == 1 and pid == GetS(103, 0, 0, 1) then --nino：伪主角如果第一个武功是内功则可以使用
			menu[i][3] = 1
		end
		]]		
	  
	  if (tmp == 104 or tmp == 95) and (DT(pid, 60) or DT(pid, 620)) then
	  	menu[i][3] = 1
	  end
      --石破天 显示太玄神功
      if tmp == 102 and (DT(pid, 38) or wglw(pid,102) or T5BCF(pid)) then
        menu[i][3] = 1
      end
      
      --张无忌 显示九阳神功 和圣火
      if (tmp == 106 or tmp == 93) and DT(pid, 9) then
        menu[i][3] = 1
      end
	  
      if tmp == 93 and DT(pid,66) then --小昭显示圣火
        menu[i][3] = 1
      end	  
      
      --狄云 显示神经照
      if tmp == 94 and DT(pid,37) then
        menu[i][3] = 1
      end
      
      --ivansz:慕容复入队 显示斗转星移
      if tmp == 43 and (DT(pid, 51) or DT(pid, 113)) then
        menu[i][3] = 1
      end
	  if tmp == 95 and DT(pid, 61) then --欧阳克可以用蛤蟆功
        menu[i][3] = 1
      end	  
	  
      if wglw(pid,43) and tmp == 43 then --领悟斗转内功后可攻击
		menu[i][3] = 1
	  end		
	
      if tmp == 181 then 
        menu[i][3] = 1
      end		
	
	  if tmp == 103 and (DT(pid, 62) or DT(pid , 594)) then --金轮可以用龙象
        menu[i][3] = 1
      end	
	 
      if tmp == 103 and DT(pid, 84) then --霍都可以用龙象
        menu[i][3] = 1
      end	
	  
	  numwugong = numwugong + 1
	  
      if menu[i][3] == 1 then
		c = c + 1
		canuse[c] = i
	  end
	  
    end
    end
    if c == 0 then
       return 0
    end
	if k ~= 0 then
		if k > c then
			k = c
		end
		WAR.ShowHead = 0
		if freefight(pid) then --ignore building restriction
			WAR.BH[pid] = 1
		end
		local r = War_Fight_Sub(WAR.CurID, canuse[k])
		WAR.BH[pid] = nil
		WAR.ShowHead = 1
		Cls()
		return r
	else
	    local r = nil
		r = ShowMenu(menu, numwugong, 0, CC.MainSubMenuX, CC.MainSubMenuY, 0, 0, 1, 1, CC.DefaultFont, C_ORANGE, C_WHITE)
		if r == 0 then
			return 0
		end
		WAR.ShowHead = 0
		if freefight(pid) then --ignore building restriction
			WAR.BH[pid] = 1
		end
		local r2 = War_Fight_Sub(WAR.CurID, r)
		WAR.BH[pid] = nil
		WAR.ShowHead = 1
		Cls()
		return r2
	end
end

--战斗武功选择菜单
function War_FightMenu()
    local pid = WAR.Person[WAR.CurID]["人物编号"]
    local numwugong = 0
    local menu = {}
    for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
    local tmp = JY.Person[pid]["武功" .. i]
    if tmp > 0 then
      if JY.WGLVXS == 1 then
        menu[i] = {JY.Wugong[tmp]["名称"] .. "・" .. JY.Person[pid]["武功等级" .. i], nil, 1}
      else
        menu[i] = {JY.Wugong[tmp]["名称"], nil, 1}
      end
      
      --内力少不显示
      if JY.Person[pid]["内力"] < JY.Wugong[tmp]["消耗内力点数"] then
        menu[i][3] = 0
      end
      
     
	  if (tmp >=115 and tmp <=119) or (tmp>=190 and tmp<=200) or tmp == 205 then --轻功不显示
		menu[i][3] = 0
	  end
	  
	  if tmp == 121 then --玉女心经不显示
		menu[i][3] = 0
	  end	  
	  if tmp == 143 then --一苇渡江
		menu[i][3] = 0
	  end
	  if tmp == 179 then --凌波微步
		menu[i][3] = 0
	  end	  
      --如果不是游坦之，内功武功不显示
      --蓝烟清：狮吼功可以显示 -- 改不显示
      
      if not ngattack(pid) and yongnei(tmp) then  
		menu[i][3] = 0
      end
      
      --如果主角是天罡，内功武功显示
      if ((PersonKF(pid, 98) and tmp == 98) or (pid == 0 and putong() == 5)) and yongnei(tmp) and
  	  not (tmp == 85 or tmp == 87 or tmp == 88) then
        menu[i][3] = 1
      end
      
      --北冥神功、化功大法、吸星大法、斗转星移不显示
      if tmp == 85 or tmp == 87 or tmp == 88 or tmp == 43 then
        menu[i][3] = 0
      end	  
	  
      --林平之 显示葵花神功
      if tmp == 105 and (DT(pid, 36) or DT(pid, 27)) then
        menu[i][3] = 1
      end
       
	  if tmp == 98 and (DT(pid , 116) or DT(pid , 118)) then
		menu[i][3] = 1
	  end
	  
	  if tmp == 108 and DT(pid, 114) then
		menu[i][3] = 1
	  end	 
		
	--[[武骧金星：这个恐怕是写错了	
	  if tmp == 66 and DT(pid, 93) then
		menu[i][3] = 1
	  end		  
	  
		if i == 1 and GetS(103, 0, 0, 0) == 1 and pid == GetS(103, 0, 0, 1) then --nino：伪主角如果第一个武功是内功则可以使用
			menu[i][3] = 1
		end]]
		
		if i == 1 and pid == 0 and GetS(103, 0, 0, 1) > 0 and
  	    not (tmp == 85 or tmp == 87 or tmp == 88) then --nino：伪主角如果第一个武功是内功则可以使用
			menu[i][3] = 1
		end		
		
		if (tmp == 104 or tmp == 95) and (DT(pid, 60) or DT(pid, 620)) then
			menu[i][3] = 1
		end
	   
      --石破天 显示太玄神功
      if tmp == 102 and (DT(pid, 38) or wglw(pid,102) or T5BCF(pid)) then
        menu[i][3] = 1
      end
      
      --张无忌 显示九阳神功 和圣火
      if (tmp == 106 or tmp == 93) and DT(pid , 9) then
        menu[i][3] = 1
      end
	  
       if tmp == 93 and DT(pid,66) then --小昭显示圣火
        menu[i][3] = 1
      end	     
	  
      --狄云 显示神经照
      if tmp == 94 and DT(pid, 37) then
        menu[i][3] = 1
      end
	  

	  
      if tmp == 95 and DT(pid, 61) then --欧阳克可以用蛤蟆功
        menu[i][3] = 1
      end	  
	  
      if tmp == 103 and (DT(pid, 84) or DT(pid, 594)) then --霍都可以用龙象
        menu[i][3] = 1
      end		  
      
	  
      --慕容复 显示斗转星移
      if tmp == 43 and (DT(pid,51) or DT(pid,113)) then
        menu[i][3] = 1
      end
      
      numwugong = numwugong + 1
    end
    end
    if numwugong == 0 then
       return 0
    end
    local r = nil
    r = ShowMenu(menu, numwugong, 0, CC.MainSubMenuX, CC.MainSubMenuY, 0, 0, 1, 1, CC.DefaultFont, C_ORANGE, C_WHITE)
    if r == 0 then
       return 0
    end
    WAR.ShowHead = 0
    if freefight(pid) then --ignore building restriction
	   WAR.BH[pid] = 1
    end
    local r2 = War_Fight_Sub(WAR.CurID, r)
    WAR.BH[pid] = nil
    WAR.ShowHead = 1
    Cls()
    return r2
end

--自动战斗时 做思考
function War_Think()
    local pid = WAR.Person[WAR.CurID]["人物编号"]
    local r = -1
    if JY.Person[pid]["体力"] < 10 then
       r = War_ThinkDrug(4)
       if r >= 0 then
          return r
       end
       return 0
    end
    --if JY.Person[pid]["生命"] < 20 or JY.Person[pid]["受伤程度"] > 50 then
    --r = War_ThinkDrug(2)
	   --if r >= 0 then
	     --return r
       --end
    --end
  
    local rate = -1
    if JY.Person[pid]["生命"] < math.min(1500, JY.Person[pid]["生命最大值"]) / 5 then
       rate = 90
    elseif JY.Person[pid]["生命"] < math.min(1500, JY.Person[pid]["生命最大值"]) / 4 then
       rate = 70
    elseif JY.Person[pid]["生命"] < math.min(1500, JY.Person[pid]["生命最大值"]) / 3 then
       rate = 50
    elseif JY.Person[pid]["生命"] < math.min(1500, JY.Person[pid]["生命最大值"]) / 2 then
       rate = 25
    end
  
    --暴气时，不吃药
    if Rnd(100) < rate and WAR.LQZ[pid] ~= nil and WAR.LQZ[pid] ~= 100 then
       r = War_ThinkDrug(2)
       if r >= 0 then				--如果有药吃药
          return r
       else
    	  r = War_ThinkDoctor()		--如果没有药，考虑医疗
  	   if r >= 0 then
    	  return r
  	   end
       end
    end

    --考虑内力
    rate = -1
    if JY.Person[pid]["内力"] < JY.Person[pid]["内力最大值"] / 6 then
  	   rate = 100
    elseif JY.Person[pid]["内力"] < JY.Person[pid]["内力最大值"] / 5 then
       rate = 75
    elseif JY.Person[pid]["内力"] < JY.Person[pid]["内力最大值"] / 4 then
       rate = 50
    end
  
    --蓝烟清如果是满血，减少吃药的机率
 	if JY.Person[pid]["生命"] == JY.Person[pid]["生命最大值"] then
 		rate = rate - 50;
 	end
  
    if Rnd(100) < rate then
       r = War_ThinkDrug(3)
       if r >= 0 then
    	  return r
  	   end
    end
  
    rate = -1
    if CC.PersonAttribMax["中毒程度"] * 3 / 4 < JY.Person[pid]["中毒程度"] then
       rate = 60
    else
       if CC.PersonAttribMax["中毒程度"] / 2 < JY.Person[pid]["中毒程度"] then
          rate = 30
       end
    end
  
    --半血以下，才吃解毒药
    if Rnd(100) < rate and JY.Person[pid]["生命"] < JY.Person[pid]["生命最大值"] / 2 then
       r = War_ThinkDrug(6)
       if r >= 0 then
    	  return r
  	   end
    end
  
    local minNeili = War_GetMinNeiLi(pid)
    if minNeili <= JY.Person[pid]["内力"] then
       r = 1
    else
       r = 0
    end
  
    --[[if WAR.BZ[pid] ~= nil then	
	   WAR.BZ[pid] = WAR.BZ[pid] - 1
	   if WAR.BZ[pid] == 0 then
		  WAR.BZ[pid] = nil
	   end
	   r = 0
    end]]
  
    return r
end
--自动攻击
function War_AutoFight()
    local pid = WAR.Person[WAR.CurID]["人物编号"]
    local wugongnum = War_AutoSelectWugong()
    if wugongnum <= 0 then
       War_AutoEscape()
	   if JY.Person[pid]["体力"] < 20 or JY.Person[pid]["内力"] < War_GetMinNeiLi(pid) * 10 then
		  War_RestMenu()
	   else
		  War_DefupMenu()
	   end
       return 
    end
    unnamed(wugongnum)
end

--自动战斗
function War_Auto()
    local pid = WAR.Person[WAR.CurID]["人物编号"]
    WAR.ShowHead = 1
    WarDrawMap(0)
    ShowScreen()
    lib.Delay(CC.WarAutoDelay)
    WAR.ShowHead = 0
    if CC.AutoWarShowHead == 1 then
       WAR.ShowHead = 1
    end
    local autotype = War_Think()
    if WAR.Person[WAR.CurID]["我方"] or WAR.ZDDH == 238 then
       if JY.Person[pid]["内力"] > 50 and JY.Person[pid]["体力"] > 10 then
          autotype = 1
       else
    	  autotype = 0
  	   end
    end
    if WAR.KHCM[pid] == 2 and autotype == 1 and pid ~= 13 and pid ~= 78 and pid ~= 130 and pid ~= 662 and pid ~= 614 and MPPD(pid) ~= 9 then
       WAR.Person[WAR.CurID]["移动步数"] = 0 
       autotype = 0  --武骧金星：目盲时不会攻击
	end
	if WAR.BZ[pid] ~= nil then
    WAR.Person[WAR.CurID]["移动步数"] = 0 
	end
    if (wglw(pid,999) or DT(pid,64)) and WAR.ZYHB2 == 2 then --左右三连
       WAR.Person[WAR.CurID]["移动步数"] = 0 
    end
    --蓝烟清：新逆运走火的状态下，有20%的机率会休息一下
    if autotype == 1 and inteam(pid) and JLSD(30, 50, pid) and WAR.L_NYZH[pid] ~= nil then
       autotype = 7
    end

    --日月神教
    for j = 0, WAR.PersonNum - 1 do --葵花涅
      if ((WAR.Person[j]["人物编号"] == 0 and WAR.KHNP1[WAR.Person[j]["人物编号"]] == 2) or (DT(WAR.Person[j]["人物编号"],27) and JY.Person[WAR.Person[j]["人物编号"]]["性别"] == 1)) 
	  and WAR.Person[j]["死亡"] == false and autotype == 1 then --武骧金星：单通判定修正
		if WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and math.random(10) <= 4 then
	    autotype = 7
	    end
      end
    end	
  
    if autotype == 1 and WAR.TMT[pid] ~= nil then
	   autotype = 0
    end 
  
    if autotype == 1 and WAR.BZ[pid] ~= nil then
	   autotype = 0
    end
    if autotype == 0 then
       War_AutoEscape()
	   if JY.Person[pid]["体力"] < 20 or JY.Person[pid]["内力"] < War_GetMinNeiLi(pid) * 10 then
		   War_RestMenu()
	   elseif WAR.KHCM[pid] == 2 then 
	       War_Wait() --豸苗：刺目等待
	   elseif WAR.BZ[pid] ~= nil then 
	       War_Wait() --豸苗：等待
	else  
		  War_DefupMenu()
	end
    elseif autotype == 1 then
       War_AutoFight()	
    elseif autotype == 2 then
       War_AutoEscape()
       War_AutoEatDrug(2)
    elseif autotype == 3 then
       War_AutoEscape()
       War_AutoEatDrug(3)
    elseif autotype == 4 then
       War_AutoEscape()
       War_AutoEatDrug(4)
    elseif autotype == 5 then
       War_AutoEscape()
       War_AutoDoctor()
    elseif autotype == 6 then
       War_AutoEscape()
       War_AutoEatDrug(6)
    elseif autotype == 7 then
       CurIDTXDH(WAR.CurID, 1325, 1344, CC.EVB171)
       War_RestMenu()
    end
    local chain 
    if WAR.Person[WAR.CurID]["我方"] then
	   chain = WAR.MYCHAIN
    else
	   chain = WAR.URCHAIN
    end  
    if autotype == 0 or autotype == 7 then --自动战斗战意增长
	   zhanyi(pid, (0.25 * (1 + chain / 30)))
    elseif autotype == 1 then
	   WAR.HIDE[pid] = nil
	   zhanyi(pid, (1.5 * (1 + chain / 30)))
    elseif autotype == 5 then
	   zhanyi(pid, (0.5 * (1 + chain / 30)))
    else
	   zhanyi(pid, (0.4 * (1 + chain / 30)))
    end
    return 0
end

    --isexp 经验值
    --warStatus 战斗状态 ---战后恢复
function War_EndPersonData(isexp, warStatus)
    for i = 0, WAR.PersonNum - 1 do
    local pid = WAR.Person[i]["人物编号"]

    --敌方回复满状态
    if not instruct_16(pid) then
      JY.Person[pid]["生命"] = JY.Person[pid]["生命最大值"]
      JY.Person[pid]["内力"] = JY.Person[pid]["内力最大值"]
      JY.Person[pid]["体力"] = CC.PersonAttribMax["体力"]
      JY.Person[pid]["受伤程度"] = 0
      JY.Person[pid]["中毒程度"] = 0
    end
    end
  
  
    for i = 0, WAR.PersonNum - 1 do
    local pid = WAR.Person[i]["人物编号"]
    if instruct_16(pid) then
      if warStatus == 1 then
        JY.Person[pid]["生命"] = JY.Person[pid]["生命"] + math.modf((JY.Person[pid]["生命最大值"] - JY.Person[pid]["生命"]) * 0.3)
        JY.Person[pid]["内力"] = JY.Person[pid]["内力"] + math.modf((JY.Person[pid]["内力最大值"] - JY.Person[pid]["内力"]) * 0.3)
        JY.Person[pid]["体力"] = JY.Person[pid]["体力"] + math.modf((100 - JY.Person[pid]["体力"]) * 0.3)
        JY.Person[pid]["受伤程度"] = math.modf(JY.Person[pid]["受伤程度"] / 2)
        JY.Person[pid]["中毒程度"] = math.modf(JY.Person[pid]["中毒程度"] / 2)
      else
	      if JY.Person[pid]["生命"] < JY.Person[pid]["生命最大值"] / 4 then
	        JY.Person[pid]["生命"] = math.modf(JY.Person[pid]["生命最大值"] / 4)
	      end
      end  
    end
    if JY.Person[pid]["体力"] < 10 then
      JY.Person[pid]["体力"] = 10
    end
    end
  
    --乔峰武功回复
    JY.Person[50]["武功1"] = 26
    JY.Wugong[13]["名称"] = "铁掌"

    --破丐帮打狗阵
    if WAR.ZDDH == 82 then
       SetS(10, 0, 18, 0, 1)
    end
  
    --十八铜人，战斗胜利
    if WAR.ZDDH == 217 and warStatus == 1 and GetS(86,1,2,5) ~= 3 then
       SetS(10, 0, 16, 0, 1)
    end
  
    --梅庄 秃笔翁战斗后
    if WAR.ZDDH == 44 then
       instruct_3(55, 6, 1, 0, 0, 0, 0, -2, -2, -2, 0, -2, -2)
       instruct_3(55, 7, 1, 0, 0, 0, 0, -2, -2, -2, 0, -2, -2)
    end
  
    --梅庄 黑白子战斗
    if WAR.ZDDH == 45 then
       instruct_3(55, 9, 1, 0, 0, 0, 0, -2, -2, -2, 0, -2, -2)
    end
  
    --梅庄 黄钟公战斗
    if WAR.ZDDH == 46 then
       instruct_3(55, 13, 0, 0, 0, 0, 0, -2, -2, -2, 0, -2, -2)
    end
  
    --非正常队友数据验证
    --[[ 
    暂时取消验证
    for i = 1, 6 do
    if JY.Base["队伍" .. i] > -1 then
      local LG = 1
      for ii = 1, 50 do
        if JY.Base["队伍" .. i] == 0 or JY.Base["队伍" .. i] == CC.PersonExit[ii][1] then
          LG = 0
        end
      end
      if LG == 1 and JY.WGLVXS == 0 then
      	xx = xx
   	 end
    end
    end
  
    --队友基本属性最大值验证
    for i = 1, 6 do
    if JY.Base["队伍" .. i] > -1 then
      local NG = 1
      local p = JY.Base["队伍" .. i]
      if JY.Person[p]["生命最大值"] > 999 or JY.Person[p]["内力最大值"] > 10000 then
        NG = 0
      end
      if JY.Person[p]["攻击力"] > 600 or JY.Person[p]["防御力"] > 600 or JY.Person[p]["轻功"] > 600 then
        NG = 0
      end
      if NG == 0 and JY.WGLVXS == 0 then
      	xx = xx
    	end
    end  
    end
    --]]
  
    --战斗失败，并且无经验
    if warStatus == 2 and isexp == 0 then
       return 
    end
  
    --统计活的人数
    local liveNum = 0
    for i = 0, WAR.PersonNum - 1 do
    if WAR.Person[i]["我方"] == true and JY.Person[WAR.Person[i]["人物编号"]]["生命"] > 0 then
      liveNum = liveNum + 1
    end
    end
  
    --保存是否为自动战斗
    --JY.ZDZD = WAR.AutoFight
  
    --分配经验
    local canyu = false
    if warStatus == 1 then
    if WAR.Data["经验"] < 1000 then
      WAR.Data["经验"] = 1000
    end
    for i = 0, WAR.PersonNum - 1 do
      local pid = WAR.Person[i]["人物编号"]
      if WAR.Person[i]["我方"] == true and inteam(pid) and JY.Person[pid]["生命"] > 0 then
        if pid == 0 then
          canyu = true
        end
        for ii = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
          if JY.Person[pid]["武功" .. ii] == 98 then
            WAR.Person[i]["经验"] = WAR.Person[i]["经验"] + math.modf(WAR.Data["经验"] * 1.5 / (liveNum))
          end
        end
        WAR.Person[i]["经验"] = WAR.Person[i]["经验"] + math.modf(WAR.Data["经验"] / (liveNum))
      end
    end
    end
  
    --修炼点经验
    for i = 0, WAR.PersonNum - 1 do
    local pid = WAR.Person[i]["人物编号"]
    AddPersonAttrib(pid, "物品修炼点数", math.modf(WAR.Person[i]["经验"] * 8 / 10))
    AddPersonAttrib(pid, "修炼点数", math.modf(WAR.Person[i]["经验"] * 8 / 10))
    if JY.Person[pid]["修炼点数"] < 0 then
      JY.Person[pid]["修炼点数"] = 0
    end
    War_PersonTrainBook(pid)     --修炼秘籍
    War_PersonTrainDrug(pid)		 --修炼药品
    end
  
  
    --飞影：练功模式之外的战斗，直接提升人物能力。
	if JY.YZYZ == 0 then
		for i = 0, WAR.PersonNum - 1 do
			local pid = WAR.Person[i]["人物编号"]
			if WAR.Person[i]["我方"] == true and 
				(inteam(pid) or (GetS(103, 0, 0, 0) == 1 and pid == GetS(103, 0, 0, 1))) then
				AddPersonAttrib(pid, "经验", math.modf(WAR.Person[i]["经验"] / 2))
				--DrawStrBoxWaitKey(string.format(CC.WARS124, JY.Person[pid]["姓名"], WAR.Person[i]["经验"]), C_WHITE, CC.DefaultFont)
				War_AddPersonLVUP(pid)
			else
				AddPersonAttrib(pid, "经验", WAR.Person[i]["经验"])
			end
		end
	elseif JY.YZYZ == 1 then
			if WAR.ZDDH == 226 then	--（练功模式下，获取的是经验值）
				for i = 0, WAR.PersonNum - 1 do
					local pid = WAR.Person[i]["人物编号"]
					if WAR.Person[i]["我方"] == true and 
						(inteam(pid) or (GetS(103, 0, 0, 0) == 1 and pid == GetS(103, 0, 0, 1))) then
						AddPersonAttrib(pid, "经验", math.modf(WAR.Person[i]["经验"] / 2))
						--DrawStrBoxWaitKey(string.format(CC.WARS124, JY.Person[pid]["姓名"], WAR.Person[i]["经验"]), C_WHITE, CC.DefaultFont)
						War_AddPersonLVUP(pid)
					else
						AddPersonAttrib(pid, "经验", WAR.Person[i]["经验"])
					end
				end
			else

				for i = 0, WAR.PersonNum - 1 do
				
					--提升三维数据
					local pid = WAR.Person[i]["人物编号"]
					if WAR.Person[i]["我方"] == true and WAR.Person[i]["经验"] > 1000 and
						(inteam(pid) or (GetS(103, 0, 0, 0) == 1 and pid == GetS(103, 0, 0, 1))) then
						local aa = math.modf(WAR.Person[i]["经验"] / 500)
						local bb = math.modf(WAR.Person[i]["经验"] / 250)
						local gongji = math.random(aa,bb)
						local fangyu = math.random(aa,bb)
						local qinggong = math.random(aa,bb)
						AddPersonAttrib(pid, "攻击力", gongji)
						AddPersonAttrib(pid, "防御力", fangyu)
						AddPersonAttrib(pid, "轻功", qinggong)
						DrawStrBoxWaitKey(string.format(CC.WARS131, JY.Person[pid]["姓名"], gongji, fangyu, qinggong), C_WHITE, CC.DefaultFont)
					end
					
					--随机一门武功提高熟练度
					local wugongmax = 1	
					local ketishennum = 0
					for j = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
						--定义已学的武功数
						if JY.Person[pid]["武功" .. j] > 0 then
							wugongmax = j
						end
						--定义可以提升的武功数（只有武功级别高于十级的武功才可以提升）
						if JY.Person[pid]["武功等级" .. j] >= 900 then
							ketishennum = ketishennum + 1
						end
					end
					local wugongnum = 0
					--如果有可提升的武功，那么不停随机直到随机到可提升武功为止
					if ketishennum > 0 then
						local wgsld = 0
						while wgsld == 0 do
							wugongnum = math.random(1 , wugongmax)
							if JY.Person[pid]["武功" .. wugongnum] ~= nil and JY.Person[pid]["武功" .. wugongnum] > 0 and JY.Person[pid]["武功等级" .. wugongnum] >= 900 then
								wgsld = 1
							end
						end
					end
						if WAR.Person[i]["我方"] == true and WAR.Person[i]["经验"] > 1000 and ketishennum > 0 and
								(inteam(pid) or (GetS(103, 0, 0, 0) == 1 and pid == GetS(103, 0, 0, 1))) then
							--熟练度提升提示
							DrawStrBoxWaitKey(string.format(CC.WARS132, JY.Person[pid]["姓名"], JY.Wugong[JY.Person[pid]["武功" .. wugongnum]]["名称"]), C_WHITE, CC.DefaultFont)
							--如果该武功不是极，就让他变成极，同时附加修炼到极的各种效果。
							if JY.Person[pid]["武功等级" .. wugongnum] < 999 then
								JY.Person[pid]["武功等级" .. wugongnum] = 999
								--修炼到极的提示
								DrawStrBoxWaitKey(string.format(CC.WARS76, JY.Person[pid]["姓名"], JY.Wugong[JY.Person[pid]["武功" .. wugongnum]]["名称"]), C_ORANGE, CC.DefaultFont)
									
									--以下为武功练到极的效果，原文复制
									local wugong = JY.Person[pid]["武功" .. wugongnum]
									if yongquan(wugong) then
										AddPersonAttrib(pid, "拳掌功夫", 1)
									elseif yongjian(wugong) then
										AddPersonAttrib(pid, "御剑能力", 1)
									elseif yongdao(wugong) then
										AddPersonAttrib(pid, "耍刀技巧", 1)
									elseif yongte(wugong) then
										AddPersonAttrib(pid, "特殊兵器", 1)
									elseif yongan(wugong) then
										AddPersonAttrib(pid, "暗器技巧", 1)	
									end
									
									  --阴阳捣乱刃到极，御剑耍刀各上升30点	       
									if wugong == 77 then
										if wglw1(pid,77) or ((DT(pid,605) or DT(pid,627))and JX(pid)) then
											say("剑转刀、刀转剑...，奇思妙想阿...", pid);
											ShowScreen()
											AddPersonAttrib(pid, "御剑能力", 100)
											AddPersonAttrib(pid, "耍刀技巧", 100)
											QZXS(JY.Person[pid]["姓名"].."刀剑属性各上升100点！")
										else	
											say("这一刀一剑的功夫好神奇....", pid);
											ShowScreen()
											AddPersonAttrib(pid, "御剑能力", 30)
											AddPersonAttrib(pid, "耍刀技巧", 30)
											QZXS(JY.Person[pid]["姓名"].."刀剑属性各上升30点！")
										end	
									end
									
									if wugong == 155 then	--五指密刀	
										AddPersonAttrib(pid, "拳掌功夫", 50)
										QZXS(JY.Person[pid]["姓名"].."拳掌上升50点！")
									end
									--石破天 太玄神功为极，增加轻功50
									if pid == 38 and JY.Person[pid]["武功" .. wugongnum] == 102 then
										say(CC.say2, 38)
										DrawStrBoxWaitKey(CC.say3, C_ORANGE, CC.DefaultFont)
										ShowScreen()
										AddPersonAttrib(pid, "轻功", 50)
										AddPersonAttrib(pid, "拳掌功夫", 150)
										AddPersonAttrib(pid, "御剑能力", 150)
										AddPersonAttrib(pid, "耍刀技巧", 100)
										AddPersonAttrib(pid, "特殊兵器", 100)
										AddPersonAttrib(pid, "暗器技巧", 100)
										QZXS(JY.Person[pid]["姓名"].."全系数上升!")
									end
									
									if (wglw(pid,102) or T5BCF(pid)) and wugong == 102 then
										say("这太玄经不愧为旷世绝学啊！", pid);
										ShowScreen()
										AddPersonAttrib(pid, "拳掌功夫", 150)
										AddPersonAttrib(pid, "御剑能力", 150)
										AddPersonAttrib(pid, "耍刀技巧", 100)
										AddPersonAttrib(pid, "特殊兵器", 100)
										AddPersonAttrib(pid, "暗器技巧", 100)
										QZXS(JY.Person[pid]["姓名"].."全系数上升!")
									end	
									
									if pid == 37 and JY.Person[pid]["武功" .. wugongnum] == 94 then --狄云 神照功为极，增加轻功20点
										say(CC.LTalk88, 37)
										DrawStrBoxWaitKey( "狄云领悟神照经的真髓!", C_ORANGE, CC.DefaultFont)		 
										setJX(pid)
									end
					   
									if pid == 61 and wugong == 9 then	--欧阳克重练灵蛇拳
										say("这功夫好熟悉....", 61);
										DrawStrBoxWaitKey("欧阳克攻轻各上升20点 拳掌上升100点", C_ORANGE, CC.DefaultFont)
										AddPersonAttrib(pid, "攻击力", 20)
										AddPersonAttrib(pid, "轻功", 20)
										AddPersonAttrib(pid, "拳掌功夫", 100)
										setJX(61)
										QZXS("欧阳克觉醒灵蛇拳奥义！")
										if GetS(113,0,0,0) == 0 then
											if JY.Person[0]["性别"] == 0 then
											say("(...那个所谓「大哥」带我回来之后，对我也不错...)", 61);
											say("大哥，我想起了一些这套蛇拳的法诀", 61);
											say("就告诉大哥当作近日来照顾我的回报吧", 61);
											end
											if DrawStrBoxYesNo(-1, -1, "要听么？", C_WHITE, 30) == true then
												QZXS("学会灵蛇拳奥义！")
												SetS(113,0,0,0,9)
												say("多谢欧阳贤弟了", 0);
											else
												say("（我脸皮可没这么厚...）", 0);
												say("多谢贤弟美意，但我想算了吧", 0);
												say("好", 61);
											end
										end	
									end	
                                   if pid == 582 and wugong == 58 and PersonKF(pid,57) then --木婉清双刀到极
                                     say("善恶一念间..",582)
                                     DrawStrBoxWaitKey("木婉清三维提升200点，耍刀提升100点", C_ORANGE, CC.DefaultFont)
                                     AddPersonAttrib(pid, "攻击力", 200)
									 AddPersonAttrib(pid, "轻功", 200)
									 AddPersonAttrib(pid, "防御力", 200)
									 AddPersonAttrib(pid, "耍刀技巧", 100)
									 setJX(582)
									 QZXS("修罗再临")
									if GetS(113,0,0,0) == 0 then
									if JY.Person[0]["耍刀技巧"] > 350 then	
									say("渡人不如渡己，修罗也可成佛，你要试试么？", 582);
									if DrawStrBoxYesNo(-1, -1, "试试看？", C_WHITE, 30) == true then
										QZXS("领悟修罗刀！")
										SetS(113,0,0,0,58)
										say("我好像懂了。。");
									else
									say("婉妹？",0);
									say("没事。",582);
									end
									end
									end	
									end
						
									if pid == 9 and wugong == 93 then
										say("这波斯明教的神功果然厉害", 9);
										DrawStrBoxWaitKey("张无忌轻功上升20点", C_ORANGE, CC.DefaultFont)
										AddPersonAttrib(pid, "轻功", 20)
									end						
					
									if pid == 1 and wugong == 67 then	--胡斐，胡家刀法到极，增加60点耍刀技巧
										say("刀法真是越练越精妙", 1);
										DrawStrBoxWaitKey("胡斐耍刀技巧增加50点", C_ORANGE, CC.DefaultFont)
										AddPersonAttrib(pid, "耍刀技巧", 50)
										if sixi(pid,3)>=250 then
											say("终于领悟了刀法的精要", 1);
											DrawStrBoxWaitKey("胡斐觉醒了战技.一刀", C_ORANGE, CC.DefaultFont)
											setJX(pid)
										end
									end

									if pid == 58 and wugong == 45 then --杨过，独孤九剑到极后，将玄铁剑法练到极，觉醒战意技
										for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
											if JY.Person[pid]["武功" .. i] == 47 and JY.Person[pid]["武功等级" .. i] >= 999 then
												say("独孤前辈的绝学真是高深莫测啊", 58);
												DrawStrBoxWaitKey("杨过御剑能力增加50点", C_ORANGE, CC.DefaultFont)
												AddPersonAttrib(pid, "御剑能力", 50)
												say("原来这就是举轻若重", 58);
												DrawStrBoxWaitKey("杨过觉醒了战技.玄铁九剑", C_ORANGE, CC.DefaultFont)
												setJX(pid)    
											end
										end
									end
					   
									if pid == 58 and wugong == 47 then	--杨过，独孤九剑到极后，将玄铁剑法练到极，觉醒战意技
										for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
											if JY.Person[pid]["武功" .. i] == 45 and JY.Person[pid]["武功等级" .. i] >= 999 then
												say("独孤前辈的绝学真是高深莫测啊", 58);
												DrawStrBoxWaitKey("杨过御剑能力增加50点", C_ORANGE, CC.DefaultFont)
												AddPersonAttrib(pid, "御剑能力", 50)
												say("原来这就是举重若轻", 58);
												DrawStrBoxWaitKey("杨过觉醒了战技.玄铁九剑", C_ORANGE, CC.DefaultFont)
												setJX(pid)    
											end
										end
									end
									
									if pid == 161 and wugong == 3 and sixi(pid,1) >=100 and sixi(pid,5)>=200 then	--杨过，独孤九剑到极后，将玄铁剑法练到极，觉醒战意技
										for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
											if JY.Person[pid]["武功" .. i] == 170 and JY.Person[pid]["武功等级" .. i] >= 999 then
												say("赤练之名，将更无远弗届！", 161);
												DrawStrBoxWaitKey("李莫愁拳掌、暗器、用毒能力上限大增", C_ORANGE, CC.DefaultFont)
												AddPersonAttrib(pid, "拳掌功夫", 50)
												AddPersonAttrib(pid, "暗器技巧", 100)
												setJX(pid)    
											end
										end
									end
									
									if pid == 161 and wugong == 170 and sixi(pid,1) >=100 and sixi(pid,5)>=200 then	--杨过，独孤九剑到极后，将玄铁剑法练到极，觉醒战意技
										for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
											if JY.Person[pid]["武功" .. i] == 3 and JY.Person[pid]["武功等级" .. i] >= 999 then
												say("赤练之名，将更无远弗届！", 161);
												DrawStrBoxWaitKey("李莫愁拳掌、暗器、用毒能力上限大增", C_ORANGE, CC.DefaultFont)
												AddPersonAttrib(pid, "拳掌功夫", 50)
												AddPersonAttrib(pid, "暗器技巧", 100)
												setJX(pid)    
											end
										end
									end
									
							--如果这门武功本身已经是极，就提升熟练度。
							elseif JY.Person[pid]["武功等级" .. wugongnum] >= 999 then
								local aa = math.modf(WAR.Person[i]["经验"] / 20)
								local bb = math.modf(WAR.Person[i]["经验"] / 10)
								local shuliandu = math.random(aa,bb)
								JY.Person[pid]["武功等级" .. wugongnum] = limitX(JY.Person[pid]["武功等级" .. wugongnum] + shuliandu, 1000, 32000)
							end
						end
				end
			end
		end
  
    --青城四秀
    if WAR.ZDDH == 48 then
       SetS(57, 52, 29, 1, 0)
       SetS(57, 52, 30, 1, 0)
    
    -- 一灯居，欧阳锋，裘千刃
    elseif WAR.ZDDH == 175 then
        instruct_3(32, 12, 1, 0, 0, 0, 0, 0, 0, 0, -2, -2, -2)
      
    --
    elseif WAR.ZDDH == 82 then
        SetS(10, 0, 18, 0, 1)
      
    --破打狗阵
    elseif WAR.ZDDH == 214 then
        SetS(10, 0, 19, 0, 1)
    end
  
    --十八铜人战斗胜利
    if WAR.ZDDH == 217 and warStatus == 1 and GetS(86,1,2,5) ~= 3 then
       SetS(65, 1, 1, 5, 517)
    end
end

--蓝烟清：DIY战斗子函数专用
function War_DIY_Fight(id, wugong, level, ng)
	return ng;
end

   --执行战斗，自动和手动战斗都调用
   --id战斗人物编号
   --wugongnum 使用的武功在位置
   --x,y为战斗场景坐标
function War_Fight_Sub(id, wugongnum, x, y)
    local pid = WAR.Person[id]["人物编号"]
	--local eid = WAR.Person[emenyid]["人物编号"]
    local wugong = 0
    local mptype, mpdj = 0
    if MPPD(pid) ~= 0 then
	   mptype = MPPD(pid)
	   mpdj = MPDJ(pid)
    end
    if wugongnum < 100 then
       wugong = JY.Person[pid]["武功" .. wugongnum]
    else
       wugong = wugongnum - 100
       wugongnum = 1
	  for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
	    if JY.Person[pid]["武功" .. i] == 43 then   --如果学习有斗转星移
	      wugongnum = i     --记录斗转武功位置
	  		break;
	    end
	  end	  
	  local function douzhuantest()
		if ((DT(pid, 51) and WAR.HMXC == 0 and inteam(pid)) or douzhuankekong(pid)) and WAR.AutoFight == 0 then
			return true
		else
			return false
		end
	  end
	  if douzhuantest()== false or (DT3(pid, 51) and WAR.HMXC > 0) then --慕容和主角可控
	    if x ~= nil and y ~= nil then	--武骧金星：兵器指数高了以后斗转会在这里出现问题
			x = WAR.Person[WAR.CurID]["坐标X"] - x
			y = WAR.Person[WAR.CurID]["坐标Y"] - y
			WarDrawMap(0)
        end		
	  end
	  local fj = nil
	  if WAR.DZXYLV[pid] == 110 then    --斗转星移提示的文字
	  
		  if pid == 51 and WAR.HMXC > 0 then
			  fj = string.format(CC.WARSHMXC, JY.Person[pid]["姓名"])
		  else
			  fj = string.format(CC.WARS18, JY.Person[pid]["姓名"])
		  end
		
	  elseif WAR.DZXYLV[pid] == 85 then
	    fj = string.format(CC.WARS19, JY.Person[pid]["姓名"])
	  elseif WAR.DZXYLV[pid] == 60 then
	    fj = string.format(CC.WARS20, JY.Person[pid]["姓名"])
	  end
	  
	  for i = 1, 10 do
	    DrawStrBox(-1, 24, fj, C_ORANGE, 20 + i)
	    ShowScreen()
	    if i == 10 then
	      lib.Delay(40)
	    else
	      lib.Delay(1)
	    end
	  end
	end
	
	--蓝烟清：修炼紫霞神功，增加剑系武功的伤害和攻击范围
    if PersonGT(pid, 89) then --紫霞主功体，增加剑系伤害范围
  	   if yongjian(wugong) then
  		  --JY.Wugong[wugong]["移动范围10"] = JY.Wugong[wugong]["移动范围10"]+2;
  		  --JY.Wugong[wugong]["杀伤范围10"] = JY.Wugong[wugong]["杀伤范围10"]+2;
  		WAR.L_ZXSG = 1;		--触发了紫霞神功，攻击结束之后范围必须还原
  	   end
    end 

    --降龙领悟后增加移动距离
    if wugong == 26 and ((DT(pid,50) or DT(pid,617)) or wglw1(pid,26)) then
	   JY.Wugong[26]["移动范围10"] = 10;
	   WAR.XLRJ = 1
    end   

    --白羽箭法领悟后增加移动距离
	if wugong == 148 and (DT(pid, 55) or wglw1(pid,148)) then
		JY.Wugong[148]["移动范围10"] = 30;
		WAR.BYJF = 1 
	end 	
	
	--须弥山神掌领悟后增加移动距离
	if wugong == 24 and wglw1(pid,24) then
	  JY.Wugong[24]["移动范围10"] = 15;
	   WAR.XMS = 1
	end 
	
	if wglw2(pid,191) and PersonKF(pid,191) then
		WAR.ZHWY = 1
		if yongquan(wugong) then
			JY.Wugong[wugong]["移动范围10"] = JY.Wugong[wugong]["移动范围10"] + 5
		elseif yongan(wugong) then
			JY.Wugong[wugong]["移动范围10"] = JY.Wugong[wugong]["移动范围10"] + 10
		end
	end	
	
    WAR.WGWL = JY.Wugong[wugong]["攻击力10"]
    local fightscope = JY.Wugong[wugong]["攻击范围"]
    local kfkind = JY.Wugong[wugong]["武功类型"]
    local level = JY.Person[pid]["武功等级" .. wugongnum]   --判断武功是否为极

    if level >= 999 then
       level = 11
    else
       level = math.modf(level / 100) + 1
    end
       WAR.ShowHead = 0
    local m1, m2, a1, a2, a3, a4, a5 = refw(wugong, level)  --获取武功的范围
    local movefanwei = {m1, m2}   --可移动的范围
    local atkfanwei = {a1, a2, a3, a4, a5}   --攻击范围
    if WAR.SQFJ == 1 then   
    else
  	   x, y = War_FightSelectType(movefanwei, atkfanwei, x, y)
    end

    --蓝烟清：紫霞神功剑系攻击范围回复
    if WAR.L_ZXSG == 1 then
  	   --JY.Wugong[wugong]["移动范围10"] = JY.Wugong[wugong]["移动范围10"]-2;
  	   --JY.Wugong[wugong]["杀伤范围10"] = JY.Wugong[wugong]["杀伤范围10"]-2;
  	   WAR.L_ZXSG = 2;
    end

    --降龙领悟 攻击范围还原
    if WAR.XLRJ == 1 then
	    JY.Wugong[26]["移动范围10"] = 5;
	    WAR.XLRJ = 0
    end 	

    --白羽箭法领悟攻击范围还原
	if WAR.BYJF == 1 then
		JY.Wugong[148]["移动范围10"] = 25;
		WAR.BYJF = 0
    end 

	--须弥山神掌领悟攻击范围还原
	if WAR.XMS == 1 then
		JY.Wugong[24]["移动范围10"] = 5;
		WAR.XMS = 0
    end

	if WAR.ZHWY == 1 then
		if yongquan(wugong) then
			JY.Wugong[wugong]["移动范围10"] = JY.Wugong[wugong]["移动范围10"] - 5
		elseif yongan(wugong) then
			JY.Wugong[wugong]["移动范围10"] = JY.Wugong[wugong]["移动范围10"] - 10
		end
		WAR.ZHWY = 0
	end

    if x == nil then
	   WAR.XLRJ = 0;
	   WAR.L_ZXSG = 0;
	   return 0
    end	

    --蓝烟清：使用小无相功攻击，随机变化武功
    if wugong == 98 or wugong == 181 then
  	  local kfvl = 0;
	  if DT(pid, 118) then
		 while kfvl < 1100 do
			wugong = math.random(JY.WugongNum - 1);
			kfvl = JY.Wugong[wugong]["攻击力10"];
	  end
	else
		 while (kfvl < 800 or kfvl > 1100) do
			wugong = math.random(JY.WugongNum - 1);
			kfvl = JY.Wugong[wugong]["攻击力10"];
	  end
	end
	WAR.XWGJ = 1 --17-2-12--
    end

	--阿青越女剑随机变化剑法
	--[[if DT(pid,614) and wugong == 123 then
		local YNJ = {};		
		local num = 0;	--当前学了多少个内功
		for i = 0, JY.WugongNum-1 do
			local kfid = JY.Wugong[i]["代号"]
			--先把内功都存入表格，吸功，金刚不坏，风林六如不加力
			if JY.Wugong[i]["类型"] == 2 then
				num = num + 1;
				YNJ[num] = {kfid};
			end
		end
		if num > 0 then
			for j = 1, num do 
				if myrandom(10,pid) then
					wugong = YNJ[j][1]
				end
			end
		end
	end]]	

    if T13TQS(pid) then
       WAR.SWHH=WAR.SWHH+math.modf(tianshu()/2)+1
    end
  
    if wssz(pid) then
       WAR.SWHH1=WAR.SWHH1+7
    end

    local  function between(num_1, num_2, num_3, flag)
    if not flag then
      flag = 0
    end
    if num_3 < num_2 then
      num_2, num_3 = num_3, num_2
    end
    if flag == 0 and num_2 < num_1 and num_1 < num_3 then
      return true
    elseif flag == 1 and num_2 <= num_1 and num_1 <= num_3 then
      return true
    else
      return false
    end
    end

    --判断合击
    --local DUIZHAO = -1
    local ZHEN_ID = -1
    local x0, y0 = WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"]
    for i = 0, WAR.PersonNum - 1 do
	local id = WAR.Person[WAR.CurID]["人物编号"]
    if WAR.Person[WAR.CurID]["我方"] == WAR.Person[i]["我方"] and i ~= WAR.CurID and WAR.Person[i]["死亡"] == false and WAR.SQFJ ~= 1 then
      local nx = WAR.Person[i]["坐标X"]
      local ny = WAR.Person[i]["坐标Y"]
      local fid = WAR.Person[i]["人物编号"]
	  local love
	  if (DT(WAR.Person[WAR.CurID]["人物编号"], 455) and fid == 597) or (WAR.Person[WAR.CurID]["人物编号"] == 597 and DT(fid, 455)) then
		love = 1
	  end
      for j = 1, 12 do
	      if JY.Person[fid]["武功" .. j] == wugong or TGLX(fid) or love == 1 then
			if T10XXZ(0) and WAR.Person[WAR.CurID]["我方"] then --萧笑竹特殊判定
				ZHEN_ID = i
				break
			end
			if TGLX(fid) and WAR.Person[WAR.CurID]["我方"] then --萧笑竹特殊判定
				ZHEN_ID = i
				WAR.TGLX=WAR.TGLX+1
				break
			end
	        if math.abs(nx-x0)+math.abs(ny-y0)<9 then
	          local flagx, flagy = 0, 0
	          if math.abs(nx - x0) <= 1 then
	            flagx = 1
	          end
	          if math.abs(ny - y0) <= 1 then
	            flagy = 1
	          end
	          if x0 == nx then
	            flagy = 1
	          end
	          if y0 == ny then
	            flagx = 1
	          end
	          if between(x, x0, nx, flagx) and between(y, y0, ny, flagy) then
	            ZHEN_ID = i
	            WAR.Person[i]["人方向"] = 3 - War_Direct(x0, y0, x, y)
				if love == 1 then
					WAR.WAWY2 = 1
				end
	            break;
	          end
	        end
	      end
	   	end
	   	if ZHEN_ID >= 0 then
      	break;
    	end
    end 
		if WAR.WAWY ~= 1 and  WAR.SQFJ ~= 1 and WAR.TZQJ13[WAR.CuiID] == nil and WAR.DWRY ~= 1 then
			if WAR.Person[WAR.CurID]["我方"] == WAR.Person[i]["我方"] and i ~= WAR.CurID and WAR.Person[i]["死亡"] == false and WAR.SQFJ ~= 1 
				and TGLX(WAR.Person[i]["人物编号"]) then
				 ZHEN_ID = i
				 WAR.HEJI = 1
			end
		
			if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[i]["我方"] and i ~= WAR.CurID and WAR.Person[i]["死亡"] == false
			and (DT(WAR.Person[i]["人物编号"],27) and (WAR.Person[i]["人物编号"] == 27 or WAR.Person[i]["人物编号"] == 0)) and JLSD(0,30,WAR.Person[i]["人物编号"]) then--对招17-1-2
				ZHEN_ID = i
				WAR.DUIZHAO = 1
				break;
			end	
			if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[i]["我方"] and i ~= WAR.CurID and WAR.Person[i]["死亡"] == false
			and (DT(WAR.Person[i]["人物编号"],5) and (WAR.Person[i]["人物编号"]== 5 or WAR.Person[i]["人物编号"] == 0)) and JLSD(0,30,WAR.Person[i]["人物编号"]) then--对招17-1-2
				ZHEN_ID = i
				WAR.DUIZHAO = 2
				break;
			end
			if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[i]["我方"] and i ~= WAR.CurID and WAR.Person[i]["死亡"] == false
			and (DT(WAR.Person[i]["人物编号"],114) and (WAR.Person[i]["人物编号"] == 114 or WAR.Person[i]["人物编号"] == 0)) and JLSD(0,30,WAR.Person[i]["人物编号"]) then--对招17-1-2
				ZHEN_ID = i
				WAR.DUIZHAO = 3
				break;
			end
			if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[i]["我方"] and i ~= WAR.CurID and WAR.Person[i]["死亡"] == false
			and (DT(WAR.Person[i]["人物编号"],50) and (WAR.Person[i]["人物编号"] == 50 or WAR.Person[i]["人物编号"] == 0)) and JLSD(0,30,WAR.Person[i]["人物编号"]) then--对招17-1-2
				ZHEN_ID = i
				WAR.DUIZHAO = 4
				break;
			end
			if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[i]["我方"] and i ~= WAR.CurID and WAR.Person[i]["死亡"] == false
			and DT(WAR.Person[i]["人物编号"],597) and JLSD(0,35,WAR.Person[i]["人物编号"]) then--对招17-1-2
				ZHEN_ID = i
				WAR.DUIZHAO = 5
				break;
			end
			if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[i]["我方"] and i ~= WAR.CurID and WAR.Person[i]["死亡"] == false
			and (DT(WAR.Person[i]["人物编号"],598) or (T13TQS(WAR.Person[i]["人物编号"]) and juexing()>2)) and (JLSD(0,35,WAR.Person[i]["人物编号"])  or WAR.Defup[WAR.Person[i]["人物编号"]] == 1 ) then--对招17-1-2
				ZHEN_ID = i
				WAR.DUIZHAO = 9
				break;
			end
			if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[i]["我方"] and i ~= WAR.CurID and WAR.Person[i]["死亡"] == false
			and DT(WAR.Person[i]["人物编号"],592) and (JLSD(10,45,WAR.Person[i]["人物编号"]) or (JLSD(10,65,WAR.Person[i]["人物编号"]) and juexing() > 0) or WAR.Defup[WAR.Person[i]["人物编号"]] == 1) then--对招17-1-2
				ZHEN_ID = i
				WAR.DUIZHAO = 6
				break;
			end
			if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[i]["我方"] and i ~= WAR.CurID and WAR.Person[i]["死亡"] == false
			and (T1LEQ(WAR.Person[i]["人物编号"]) and juexing()>1) and JLSD(0,35,WAR.Person[i]["人物编号"]) then--对招17-1-2
				ZHEN_ID = i
				WAR.DUIZHAO = 7
				break;
			end
			if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[i]["我方"] and i ~= WAR.CurID and WAR.Person[i]["死亡"] == false
			and (wglw1(WAR.Person[i]["人物编号"],43) or (DT(WAR.Person[i]["人物编号"],113) and JX(WAR.Person[i]["人物编号"])))  and JLSD(0,35,WAR.Person[i]["人物编号"]) then
				ZHEN_ID = i
				WAR.DUIZHAO = 8
				break;
			end
			if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[i]["我方"] and i ~= WAR.CurID and WAR.Person[i]["死亡"] == false
			and DT(WAR.Person[i]["人物编号"],600) and JLSD(10,85,WAR.Person[i]["人物编号"]) then--对招17-1-2
				ZHEN_ID = i
				WAR.DUIZHAO = 10
				break;
			end
			--[[
			if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[i]["我方"] and i ~= WAR.CurID and WAR.Person[i]["死亡"] == false
			and (NF(WAR.Person[i]["人物编号"]) and juexing() > 1) and JLSD(10,75,WAR.Person[i]["人物编号"]) then--对招17-1-2
				ZHEN_ID = i
				WAR.DUIZHAO = 11
				break;
			end
			]]
			if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[i]["我方"] and i ~= WAR.CurID and WAR.Person[i]["死亡"] == false
			and (BJY(WAR.Person[i]["人物编号"]) and juexing() > 2) and JLSD(10,60,WAR.Person[i]["人物编号"]) then--对招17-1-2
				ZHEN_ID = i
				WAR.DUIZHAO = 12
				break;
			end
			if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[i]["我方"] and i ~= WAR.CurID and WAR.Person[i]["死亡"] == false
			and (wglw(WAR.Person[i]["人物编号"],43) or (DT(WAR.Person[i]["人物编号"],666) and PersonKF(WAR.Person[i]["人物编号"],43))) and JLSD(10,50,WAR.Person[i]["人物编号"]) then
				ZHEN_ID = i
				WAR.DUIZHAO = 13
				break;
			end
			if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[i]["我方"] and i ~= WAR.CurID and WAR.Person[i]["死亡"] == false
			and DT(WAR.Person[i]["人物编号"],583) and JLSD(10,60,WAR.Person[i]["人物编号"]) then--对招17-1-2
				ZHEN_ID = i
				WAR.DUIZHAO = 14
				break;
			end
			if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[i]["我方"] and i ~= WAR.CurID and WAR.Person[i]["死亡"] == false
			and KHTJF(WAR.Person[i]["人物编号"]) and JLSD(10,40,WAR.Person[i]["人物编号"]) then--对招17-1-2
				ZHEN_ID = i
				WAR.DUIZHAO = 15
				break;
			end
		end
    end
       
    local fightnum = 1  --攻击次数
    --判断左右
    local zyjl = ZYHBJL(pid)
    --判定左右
    if JY.Person[pid]["左右互搏"] == 1 and WAR.ZYHB == 0 and (JLSD(0, zyjl, pid) or WAR.ZYHB1[pid] ~= nil) 
															and WAR.DZXY == 0 and WAR.SQFJ ~= 1 and WAR.ZYHB2 == 0 then
		WAR.ZYHB = 1
		if (wglw(pid,999) and JLSD(0,zyjl,pid)) or DT(pid,64) then 
		WAR.ZYHB2 = 1 
		WAR.ZYHB3 = 1
		end
		--改到特效文字0显示
		if WAR.Person[WAR.CurID][CC.TXWZ0] ~= nil then
			WAR.Person[WAR.CurID][CC.TXWZ0] = WAR.Person[WAR.CurID][CC.TXWZ0] .."・左右互搏";
		else
			WAR.Person[WAR.CurID][CC.TXWZ0] = "左右互搏";
		end 
    end
   
    if JY.Person[pid]["左右互搏"] == 1 and WAR.ZYHB == 1 and --左右三连
	   WAR.ZYHB2 == 2 and WAR.DZXY == 0 and WAR.SQFJ ~= 1 then
    --改到特效文字0显示
    if WAR.Person[WAR.CurID][CC.TXWZ0] ~= nil then
    	WAR.Person[WAR.CurID][CC.TXWZ0] = WAR.Person[WAR.CurID][CC.TXWZ0] .."・空明互搏";
    else
    	WAR.Person[WAR.CurID][CC.TXWZ0] = "空明互搏";
    end
    
    end
      
	--判断连击
	local LJ1 = LJJL(pid)
	local LJ = 0
	--蓝烟清：新逆运走火，连击提高10点
	if WAR.L_NYZH[pid] ~= nil or wglw(pid,104) then
		LJ = LJ + 10
	end
 
	--蓝烟清：柔云剑法，累加连击
	if WAR.L_RYJF[pid] ~= nil then
		LJ = LJ + 3*WAR.L_RYJF[pid];
	end

    --太极剑法领悟+30连击
	if (DT(pid, 5) or DT(pid, 9) or DT(pid, 666)) or wglw1(pid, 46) then
	    LJ = LJ + 30
    end

    --六脉领悟+40连击
	if WAR.LMJQ > 0 then
		LJ = LJ + 40
	end	

	--真武剑+10连击
	if yongjian(wugong) and JY.Person[pid]["武器"] == 236 then
		LJ = LJ + 10
	end
	
	--君子淑女剑+10连击
	if yongjian(wugong) and JY.Person[pid]["武器"] == 38 then
		LJ = LJ + 10
	end	
	
	--金刀黑剑+10连击
	if yongte(wugong) and JY.Person[pid]["武器"] == 48 then
		LJ = LJ + 10
	end	
  	
	--鸳鸯刀+10连击
	--[[if yongdao(wugong) and JY.Person[pid]["武器"] == 250 then
		LJ = LJ + 10
	end	]]

    --峨嵋九阳功
	if PersonKF(pid, 186) then
		LJ = LJ + 20
		if PersonKF(pid, 186) then
			LJ = LJ + 30
		end
	end 	

    --天赋武功12.26
    for i,v in ipairs(CC.TFWG) do
		if ((v[1] == pid) or (v[1] == cxzj() and pid == 0)) and v[2] == wugong then
		  LJ = LJ + 30
		  break
		end
    end
    --天赋武功12.26
    if pid == 0 and (putong() > 0 or teshu() > 0) and GetS(112,1,0,0) == wugong then
	   LJ = LJ + 30					
    end
    if pid == 0 and (putong() > 0 or teshu() > 0) and GetS(112,4,0,0) == wugong then
	   LJ = LJ + 30					
    end
	if wglw(pid,592) and (wugong == 45 or wugong == 47) then 
	   LJ = LJ + 30					
    end
    --12.26
    if pid == 92 and wugong == JY.Person[578]["攻击力"] then
	   LJ = LJ + 30					
    end
  
    if wugong == 2 then
	   LJ = LJ + math.modf(JY.Person[pid]["轻功"]/30)					
    end
  
    if wugong == 126 then
	   LJ = LJ + math.modf(JY.Person[pid]["用毒能力"]/20)					
    end
  
    --天赋武功12.26
    for i,v in ipairs(CC.TFWG1) do
      if ((v[1] == pid) or (v[1] == cxzj() and pid == 0)) and v[2] == wugong then
         LJ = LJ + 30
	     break
      end
    end
  
    if fqdid(pid) and wugong == 62 then 
	   LJ = 200
	end
	
	if wugong == 18 and WAR.TZQJ4[pid] ~= nil and wglw1(pid,18) then 
	   LJ = 200
	end
		
	for i, v in ipairs(CC.WGJC) do --武功特效连击加成
		if v[1] == wugong then
			LJ = LJ + v[2]
			break
		end
	end 	
	
	LJ = math.modf(LJ / 200 * 100)
	LJ = LJ + LJ1
	
	if WAR.XSKJ[pid] ~= nil then
		LJ = math.modf(LJ/math.modf(2,5))
	end	
	
	if myrandom(LJ,pid) then---连击追加
		fightnum = 2
		if wugong==7 and myrandom(LJ,pid) then
		fightnum = fightnum+math.random(1,2)
		end
		if wugong==10 then
		fightnum = fightnum+1
		end
		if wugong==129 then
		fightnum = 3
		end
	end
	
	if fightnum>=2 and JLSD(0, LJ, pid) and WAR.DZXY~=1 then
		if pid == 0 and teshu() > 0 and (GetS(112,1,0,0) == wugong or GetS(112,4,0,0) == wugong) then
			fightnum = fightnum+1					
		end
		for i,v in ipairs(CC.TFWG) do
			if ((v[1] == pid) or (v[1] == cxzj() and pid == 0)) and v[2] == wugong then
			  fightnum = fightnum+1
			  break
			end
		end
		for i,v in ipairs(CC.TFWG1) do
			if ((v[1] == pid) or (v[1] == cxzj() and pid == 0)) and v[2] == wugong then
			  fightnum = fightnum+1
			  break
			end
		end
	end

	if T13TQS(pid) and WAR.TQS3==5 then
	    fightnum=fightnum+1
	end

	if wssz(pid) and WAR.TQS3==5 then
	    fightnum=fightnum+1
	end

    if WAR.LMSJ > 0 then
		fightnum = fightnum + 3
	end		
	
	if WAR.ZYHB1[pid] ~= nil and WAR.ZYHB > 0 then
	    fightnum = 2
	end
	--主功体连击
	for i = 1, #CC.ZGT4 do
		if (CC.ZGT4[i][1] == wugong or (T12YMZ(pid) and wugong == 112)) and (PersonGT(pid, CC.ZGT4[i][2]) or ((PersonGT(pid,9999) and (JY.Thing[224]["加攻击力"]) == CC.ZGT4[i][2] or JY.Thing[224]["加防御力"]) == CC.ZGT4[i][2])) then
			fightnum = 2
			if math.random(100) <= CC.ZGT4[i][3] then --25%三连
				fightnum = 3
			end			
			break
		end
	end
	--1-26-and (PersonGT(pid, CC.ZGT4[i][2]) or ((PersonGT(pid,9999) and (JY.Thing[224]["加攻击力"]) == CC.ZGT4[i][2] or JY.Thing[224]["加防御力"]) == CC.ZGT4[i][2])) then
	for i = 1, #CC.ZGT4 do
		if (CC.ZGT4[i][1] ==  WAR.HLTX or CC.ZGT4[i][2] ==  WAR.HLTX) and (wglw(pid,102) or (DT(pid,38) and PersonKF(pid,102))) then
			fightnum = 2
			if math.random(100) <= CC.ZGT4[i][3] then --25%三连
				fightnum = 3
			end			
			break
		end
	end
		--豸苗：折梅连击
	for i = 1, #CC.ZGT4 do
	for l = 1,10 do
	local jl = 15 + math.modf(JY.Person[pid]["实战"] / 20)+ math.modf(JY.Person[pid]["武学常识"] / 10)
	    if wugong == 14 and (JLSD(0,5+jl,pid) or (MPPD(pid)==7 and JLSD(0,15,pid))) and JY.Person[pid]["内力"] >= 7000 then
	    if JY.Person[pid]["武功" .. l] == CC.ZGT4[i][1] then
			fightnum = 2
			if math.random(100) <= CC.ZGT4[i][3] then --25%三连
				fightnum = 3
			end			
			WAR.ZMS = 1
			break	
		end
		end
	end
	end
	
    --brolycjw: 独孤求败的连击
    if DT(pid , 592) then
	if WAR.L_DGQB_X < 2 then
		fightnum = 5
	elseif WAR.L_DGQB_X < 4 then
		fightnum = 4		
	elseif WAR.L_DGQB_X < 6 then
		fightnum = 3
	elseif WAR.L_DGQB_X < 8 then
		fightnum = 2
	else
		fightnum = 1
	end
    end 
 
	if DT3(pid , 91) and WAR.QQDB == 1 then --青青大暴必连击
		  for i = 1, 10 do
			DrawStrBox(-1, 24, "大暴青青 逆我者亡", C_ORANGE, 20 + i)  
			ShowScreen()
			lib.Delay(20)
		  end		
		fightnum = 2
	end
	
	if MPPD(pid) == 14 and WAR.SXJ == 1 then --夺命连环三仙剑
		  for i = 1, 10 do
			DrawStrBox(-1, 24, "夺命连环三仙剑", C_ORANGE, 20 + i)  
			ShowScreen()
			lib.Delay(20)
		  end		
		fightnum = 3
	end
	
	if DT(pid, 642) and yongjian(wugong) then
		fightnum = 2
	end
  
    --参合指领悟必连击
	if wugong == 133 and (DT(pid, 113) or wglw1(pid,133)) then
		fightnum = 2
	end	

    --玉女剑法必连击 20%三连
    if wugong == 42 and ((DT(pid, 601) or DT(pid, 59)) or wglw1(pid,42)) then
		fightnum = 2
		if JLSD(10, 30, pid) then
			fightnum = 3
		end
	end	
	if DT(pid,605) and wugong == 77 then
		fightnum = 3
	end
  
    --欧阳锋，射中最后一场，十五邪战斗， WAR.tmp[1060]还没明白
    if DT(pid, 60) and WAR.tmp[1060] == 1 and (WAR.ZDDH == 176 or WAR.ZDDH == 133) then
        fightnum = 2
    end
  
    --倚天密道，成昆有(70-30+10)%的机率变成不连击
    --[[if WAR.ZDDH == 237 and pid == 18 and JLSD(30, 70, pid) then
        fightnum = 1
    end]]
  
    if DT(pid,161) and JX(pid) and (wugong == 170 or wugong == 3) then
		fightnum = 3
	elseif DT(pid, 161) and fightnum == 2 then --李莫愁三连
	    local jl = 30 + math.modf(JY.Person[pid]["实战"] / 25)
	    if JLSD(10, 10 + jl, pid) then
		    fightnum = 3
	    end
    end
	
    if DT(pid, 87) and fightnum == 2 then --武骧金星：添加苏荃称号技能
	    fightnum = 3
    end
  
    if DT(pid, 50) then   --乔峰 pid == 50 武骧金星：单通判定修正
    if WAR.ZDDH == 83 and WAR.FS == 0 and pid == 50 then   --打四帮主时的乔峰 武骧金星：避免影响畅想人物或者单通角色
        say(CC.WARS21, 50)
        WAR.FS = 1
	    JY.Wugong[13]["名称"] = CC.WARS22
    end
	
    if JLSD(40, 70, pid) then   --增加(70-40+10)%的二次攻击机会
        fightnum = 2
    end
    	
    --如果乔峰用的是降龙，那么有(55-45=10)%的机率三连击，怒气暴发时必三连
    if JY.Person[pid]["武功" .. wugongnum] == 26 and (JLSD(45, 55, pid) or WAR.LQZ[pid] == 100) then
        fightnum = 3
        WAR.FS = 1
        for i = 1, 10 do
            DrawStrBox(-1, 24, CC.WARS23, C_ORANGE, 20 + i)   -- 降龙三叠浪在这里
            ShowScreen()
            lib.Delay(1)
        end
	    if ZYJ(pid) and fightnum == 3 then
	        fightnum=fightnum+1
	    end
    end
    if JY.Person[pid]["内力"] < math.modf(JY.Person[pid]["内力最大值"] / 3) then    --万恶的峰神，无限内力
    	JY.Person[pid]["内力"] = math.modf(JY.Person[pid]["内力最大值"] / 3)    	
  	end
    end
    if pid == 0 and T5BCF(0) then --白愁飞10%三连击，天敌必三连
	    local jilv = 5
	    jilv = jilv + math.modf((JY.Person[pid]["生命最大值"] - JY.Person[pid]["生命"])/50);

	if JLSD(10, 10 + jilv, pid) or WAR.BCFZL == 3 then
		fightnum = 3
		WAR.BCFLJ = 1
	end
    end
  
    if T9ZY(pid) and WAR.ZYWS > 0 then --赵云无双必连
	    fightnum = 3
    end
  
    --豸苗：谢云流一刀流-斩流剑・返
    local JHF = 0 
    if ((XYL(pid) and juexing() > 0) or jtyl(pid)) and yongjian(wugong) then 
        local a = 0
	    if jtyl(pid) then 
	        a = 50 
	    end   
	    if JLSD(0,50+a,pid) then
	        fightnum = 3
        end 
        JHF = 1
    end
  
    --豸苗：森九岚一刀流-斩流剑・返
    local SJLF = 0 
    if SJL(pid) and wugong == 131 then 
	    if JLSD(10,50,pid) then
	        fightnum = 3
        end 
        SJLF = 1
    end
  
    if T9ZY(pid) and juexing() >= 2 then --赵云3连击
	    local jilv = 15
	    if WAR.LQZ[pid] ~= nil then
		    jilv = jilv + math.modf(WAR.LQZ[pid] * 0.3)
	    end
	    if JLSD(0, 10 + jilv+WAR.ZYSP*10, pid) or WAR.ZYWS>0 then
		    fightnum = fightnum+3
		    WAR.ZYLJ = 1
	    end	
    end

    if T8LXY(pid) then --李逍遥醉仙
	    if WAR.LXYLJ > 0 then
		    fightnum = 2
		    WAR.LXYLJTS = 1
		    WAR.LXYLJ = WAR.LXYLJ - 1
	    end
    end
  
    if DT(pid,69) and JX(pid) then --李逍遥醉仙
	    if WAR.HQGS2 > 0 then
		    fightnum =  math.random(3, 5)
		    if ZYJ(pid) then
		        fightnum =5
		    end	
	    end
    end
  
    if ((PersonGT(pid, 108) and MPPD(pid) == 5 and MPDJ(pid) > 1) or DT(pid,615) or DT(pid,114)) and WAR.DMZF == 3 then --大智无定指必连击，35%几率3-5连击
	    fightnum = 2
	    if JLSD(10, 45, pid) then
	       WAR.DZWD = 1
		   fightnum = math.random(3, 5)
	    end
    end
  
    if DT(pid,152) and JX(pid) and yongjian(wugong) then --无尘觉醒后用剑必连击，50%几率3-5连击
	    fightnum = 2
	    if JLSD(10, 60, pid) then
		    WAR.XQSLJ = 1
		    fightnum = math.random(3, 5)
		    if ZYJ(pid) then
		        fightnum =5
		    end	
	        if wglw(pid,178) then --九龙功
                fightnum = fightnum*2
	            WAR.SLCS[100+pid] = fightnum
	        end
	    end
    end
  
    if WAR.SJRT == 1 then
	    fightnum = fightnum + 3
    end 

    if T6XQS(pid) and juexing() > 2 and yongjian(wugong) then --萧秋水3次觉醒后用剑必连击，35%几率3-5连击
	    fightnum = 2
	    if JLSD(10, 45, pid) or ZYJ(pid) then
		    WAR.XQSLJ = 1
		    fightnum = math.random(3, 5)
		    if ZYJ(pid) then
		        fightnum =5
		    end
	        if wglw(pid,178) and JLSD(10,60,pid) then --九龙功
                fightnum = fightnum*2
	            WAR.SLCS[100+pid] = fightnum
	        end	
	    end
    end

    if JY.Person[pid]["武器"] == 51 and JLSD(10,40,pid)  then --金龙鞭
		fightnum = 2
	end	

    if JY.Person[pid]["武器"] == 250 then --鸳鸯宝刀
		fightnum = 2
		if JLSD(10, 60, pid) then
		    fightnum = 3
		end 	
	end 	

    if JY.Person[pid]["武器"] == 307 and JLSD(10,40,pid)  then --四丈银鞭
		fightnum = 4
	end	

    if JY.Person[pid]["武器"] == 308 and JLSD(10,40,pid)  then --银丝拂尘
		fightnum = 3
	end

	if DT(pid,604) and wugong == 11 then
		if fightnum < 3 then
			fightnum = 3
		end
	end

    --东方不败，必连 70%三连
    if DT(pid, 27) then
		fightnum = 2
	    if JLSD(10, 70, pid) then
		    fightnum = 3
	    end
    end 

    --白羽箭法
	if wugong == 148 and (DT(pid, 55) or wglw1(pid,148)) then
		if JLSD(10, 60, pid)  and fightnum < 3 then
		    fightnum = 3
	    end
	end
		
    if MPPD(pid) == 18 and WAR.KTFT == 2 and JY.Person[pid]["特殊兵器"] >= 300 and yongte(wugong) and JLSD(10,45,pid) then --崆峒特系堂主		
		if fightnum < 3 then
		    fightnum = 3
	    end
    end	
		
    --太极神功蓄力后加连击
	if PersonGT(pid,182) and WAR.Actup[pid] ~= nil then
		fightnum = fightnum + 3
	end 	
	
    --瑜伽密乘连击
	if PersonGTJL(pid,184) then
		fightnum = 2
	end 	
	
    --峨眉掌门限定
    if (MPPD(pid) == 17 and MPDJ(pid) >= 2) or (GX(pid) and JX(pid)) then
	    if JLSD(10, 40, pid) and fightnum < 2 then
		    fightnum = 2
	    end
    end

    --段思平必三连
    if DT(pid, 602) then
		fightnum = 3
    end 

    --聂风十方后必三连
    if NF(pid) and juexing() > 1 and fightnum < 3 then
		fightnum = 3
    end

    --步惊云必连 30%三连
    if BJY(pid) and juexing() > 1 then
	    if JLSD(10, 40, pid) and fightnum < 3 then
		    fightnum = 3
	    end
    end 
	

    if (wglw(pid,178) or (DT(pid,69) and PersonKF(pid,178)) or T9ZY(pid) or DT(pid,602)) and JLSD(10,60,pid) then --九龙功
        fightnum = fightnum * 2
	    WAR.SLCS[100+pid] = fightnum
	end
  
    --[[如果乔峰用的是降龙，那么有(55-45=10)%的机率三连击，怒气暴发时必三连
    if DT(pid,50) and JY.Person[pid]["武功" .. wugongnum] == 26 and (JLSD(45, 55, pid) or WAR.LQZ[pid] == 100) and fightnum < 3 then
      fightnum = 3
      WAR.FS = 1
      for i = 1, 10 do
        DrawStrBox(-1, 24, CC.WARS23, C_ORANGE, 20 + i)   -- 降龙三叠浪在这里
        ShowScreen()
        lib.Delay(20)
      end
    end
	if DT(pid,50) and JY.Person[pid]["内力"] < math.modf(JY.Person[pid]["内力最大值"] / 3) then
		JY.Person[pid]["内力"] = math.modf(JY.Person[pid]["内力最大值"] / 3)	
	end]]

    
	--[[
    --任我行，杀东方阿姨，只能单连，悲剧
    if WAR.ZDDH == 54 and pid == 26 then
       fightnum = 1
    end]]
  
    --蓝烟清： brolycjw邪线，小龙女死后，杨过黯然销魂掌练到极后发出黯然极意 机率三连
    if DT(pid, 58) and JY.Person[pid]["武功" .. wugongnum] == 25 and 
	JY.Person[pid]["武功等级" .. wugongnum] >= 999 and GetS(86,11,11,5) == 2 then
  	local jl = 10;		--默认发动机率为10%
  	if JY.Person[58]["受伤程度"] > 50 then		--内伤大于50时， 每增加10点极意增加10%，并且集气速度增加5
  		jl = jl + (JY.Person[58]["受伤程度"]-50);		--平滑设置，比如内伤为55时，增加5%的机率    		
  	end    
  	if JY.Person[58]["生命"] < JY.Person[58]["生命最大值"]/2 then		--生命少于二分之一时，每少一百生命，机率增加10%
  		jl = jl + math.ceil((JY.Person[58]["生命最大值"]/2 - JY.Person[58]["生命"])/10);	  		
  	end
  
  	if jl > Rnd(100) then			--判断极意触发 三连
  		fightnum = 3;
  	end	
    end
 
	if pid == 0 and putong() == 1 and 
		wugong == 25 and --拳系主角黯然几率3连
		JY.Person[pid]["武功等级" .. wugongnum] >= 999 then
		local jl = 15;		--默认发动机率为15%	
		jl = jl + math.modf(JY.Person[pid]["受伤程度"] / 10);	--每受伤10点几率+1	   		  	
		jl = jl + math.modf((JY.Person[pid]["生命最大值"] - JY.Person[pid]["生命"])/100); --生命每少100几率+1	
	  
		if math.random(100) <= jl then			--判断极意触发 三连
			fightnum = 3;
		end					
	end
	
	if getHZ(pid, 29) and WAR.LQZ[pid] ~= nil and WAR.LQZ[pid] >= 100 
		and JLSD(10, 80, pid) and fightnum < 3 then
		fightnum = 3
		WAR.FS = 1
		for i = 1, 10 do
			DrawStrBox(-1, 24, "奋英雄怒・三叠浪", C_ORANGE, 20 + i)  
			ShowScreen()
			lib.Delay(20)
		end		
	end	
	
	if pid==0 and WAR.WYLW1==1 and fightnum < 3 then
        fightnum=3
		WAR.FS = 1
		for i = 1, 10 do
			DrawStrBox(-1, 24, "惊涛拍岸・三叠浪", C_ORANGE, 20 + i)  
			ShowScreen()
			lib.Delay(20)
		end	
    end

	if pid == WAR.AXL then --武骧金星：阿修罗指令必连击
		fightnum = fightnum + 1
	end

	if T12YMZ(pid) then fightnum = fightnum + math.modf(JY.Person[pid]["实战"] / 150) end --杨妙真
	
	if wugong == 78 and wglw1(pid,78) then 
		local aa = math.modf(WAR.SPIRIT[pid]-100)
		if aa < 0 then aa = 0 end
		if aa > 40 then aa = 40 end
		fightnum = fightnum + math.modf(JY.Person[pid]["实战"] / 250) + math.modf(aa / 10)
	end
	
	fightnum = multiple(pid, fightnum)
  
    --[[--蓝烟清：装备真武剑时使用太极剑法必连击
    if JY.Person[pid]["武器"] == 236  and  JY.Person[pid]["武功" .. wugongnum] == 46 then
  	   fightnum = 2;
    end]]

    WAR.ACT = 1
    WAR.FLHS6 = 0

    --斗转和云体反击只一次
    if WAR.DZXY == 1 then
	if DT(pid, 113) or wglw1(pid,43) then --斗转领悟
	
	elseif T7DFWM(pid) and yongquan(wugong) and juexing()>1 then  --东方未明拳系反击
	fightnum = 3
	
	else
		fightnum = 1
	end
    end
  
    if WAR.SQFJ == 1 then
		if DT(pid,517) then
		fightnum = 3
		   if fightnum==3 then
		   WAR.GBWZ2=1
		   WAR.ASKD1=1
		   end
		else
		fightnum = 1
		end
    end

    if DT(pid, 153) and fightnum > 1 then
	   fightnum = math.floor(fightnum * 1.5)
    end
  
    if fightnum > 1 then
	   WAR.TXY = fightnum
    else
	   WAR.TXY = 0
    end
    while WAR.ACT <= fightnum or (WAR.YDLLJ <=fightnum and MPPD(pid) == 11)do
	lib.GetKey()
    if WAR.WS == 1 then
      WAR.WS = 0
    end
    if WAR.BJ == 1 then
      WAR.BJ = 0
    end
	--六脉清零
	  WAR.LMSJ = 0
	--降龙刚劲清零
	  WAR.XLGJ = 0
    --黯然清零
	  WAR.ARJX = 0
	 --须弥清零
	  WAR.XMSSZ = 0
	--持瑶琴清零
	  WAR.TDSX = 0
	--铁碎牙蓄力清零
		WAR.TSYXL = 0
	--明八卦清零
		WAR.MINBG = 0
	--暗八卦清零
		WAR.ANBG = 0
	--铁掌领悟清零
		WAR.CYANGZ = 0
	--寒冰绵掌领悟清零
		WAR.CYINZ = 0	
		
    if WAR.DJGZ >= 1 then
      WAR.DJGZ = 0
    end
	
	if WAR.PJS>0 then
	WAR.PJS = 0
	end

	if WAR.PJS2>0 then
	WAR.PJS2 = 0
	end



	
	if WAR.JLDL2==5 then
	WAR.JLDL2=0
	end
    if WAR.LXQJ1 >= 1 then
      WAR.LXQJ1 = 0
    end	
    if WAR.HYDX1 >= 1 then
      WAR.HYDX1 = 0
    end		
	if WAR.XYDY >= 2 then
	  WAR.XYDY = 0
	end	
	if WAR.XYDY >= 1 then
	  WAR.XYDY = 0
	end
    if WAR.HYDX2 >= 1 then
      WAR.HYDX2 = 0
    end		 

	if WAR.JZSEG >= 1 then
		WAR.JZSEG = 0
	end	
	
	if WAR.TQS>0 then
	WAR.TQS=0
	end

	if WAR.TQS3>0 then
	WAR.TQS3=0
	end
	
	if WAR.ZYQT >= 1 then
      WAR.ZYQT = 0
    end
	
	if WAR.XMPM >= 1 then
      WAR.XMPM = 0
    end
	if WAR.YFDLW >= 1 then
      WAR.YFDLW = 0
    end
	if WAR.BXJF > 0 then
		WAR.BXJF = 0
	end
	
	if WAR.HSYFD >= 1 then
      WAR.HSYFD = 0
    end
	if WAR.QKQJ >= 1 then
      WAR.QKQJ = 0
    end
	if WAR.DZPZ >=1 then
	WAR.DZPZ=0
	end
	
	if WAR.LYBF >= 1 then
      WAR.LYBF = 0
    end
	if WAR.ZKSY >= 1 then
      WAR.ZKSY = 0
    end

	if WAR.DZDJ >= 1 then
      WAR.DZDJ = 0
    end
		if WAR.DZDJ2 >= 1 then
      WAR.DZDJ2 = 0
    end
	if WAR.DZDJ1 >= 1 then
      WAR.DZDJ1 = 0
    end
	if WAR.TGLX>=1 then
	WAR.TGLX=0
	end
	if WAR.YXMQ >= 1 then
	WAR.YXMQ = 0
	end
	
	 if WAR.PLDS >= 1 then
     WAR.PLDS = 0 
     end	 
	
    if WAR.WYLW1 >=1 then
       WAR.WYLW1 = 0   --恒山领悟
    end
    if WAR.WYLW2 >=1 then
       WAR.WYLW2 = 0   -- 泰山领悟
    end
    if WAR.WYLW3 >=1 then
       WAR.WYLW3 = 0   --衡山领悟
    end
    if WAR.WYLW4 >=1 then
       WAR.WYLW4 = 0   --嵩山领悟
    end
    if WAR.WYLW5 >=1 then
       WAR.WYLW5 = 0   --华山领悟
    end
	if WAR.DMZF >= 1 then
      WAR.DMZF = 0
    end
	if WAR.DMZF1 >= 1 then
      WAR.DMZF1 = 0
    end
	if WAR.JGZH >= 1 then
      WAR.JGZH = 0
    end
	if WAR.WXXY1 ==1 then
	WAR.WXXY1=0
	end
	if WAR.NSTJ1>=1 then
	WAR.NSTJ1 = 0
	end
	if WAR.NSTJ2>=1 then
	WAR.NSTJ2 = 0
	end

	if WAR.SHAOLIN2 == 1 then--罗汉堂伏魔杖
	   WAR.SHAOLIN2 = 0
    end
	
	WAR.XNXS = {}--空挥显示
	WAR.YY=0	
	WAR.THSB=0 --桃花三宝
	WAR.THSB1=0 --真・桃花三宝
    WAR.THSB2=0 --真・桃花三宝
    WAR.THSB3=0 --真・桃花三宝
    WAR.THSB4=0 --真・桃花三宝
	WAR.THKF=0
	WAR.QQSH=0 --琴棋书画
	WAR.QQSH1 = 0
	WAR.JWYX=0 --金乌映雪
	WAR.ZFLY=0 --正反两仪
	WAR.ZFLY1=0
	WAR.SHAOLIN=0 --神掌伏魔
	WAR.XHPL=0 --血海飘零加集气
	WAR.XIXUE=0 --吸血
	WAR.SHITOUDAO=0 --王小石刀法
	WAR.SHITOUJIAN=0 --王小石剑法
	WAR.SHITOUNG=0 --王小石内功特效
    WAR.SHITOUJY=0 --王小石刀剑极意
    WAR.DJSX=0--田归农刀剑十杀
	WAR.DJDAO=0 --田归农胡刀
	WAR.DJJIAN=0 --田归农苗剑
	WAR.OUYANG=0 --欧阳克封穴
	WAR.GUDU=0 --蛊毒判定
	WAR.YTML=0
	WAR.LKZX2=0
	WAR.GUDUXIXUE=0
	WAR.VAMPIRE={}
	WAR.GTSHAQI=0 --主功体杀气
	WAR.GTPID2=-1 --主功体杀气使用者	
	WAR.GTNUQI=0 --主功体减怒气值
	WAR.XQS=0 --萧秋水忘情天书判定
	WAR.LMSJ=0 --六脉神剑判定
    WAR.TQS=0 --滕青山拟兽式判定
	WAR.WSFJ=0 --滕文婷万兽反击
	WAR.WSSZ=0
	WAR.SJL = 0 --豸苗：一刀流森九岚
	WAR.XYLCZ=0 --豸苗：谢云流
	WAR.ZMYJ = 0 --17-3-1-
	WAR.LHWH = 0 --17-3-1-
	WAR.HQJK = 0 --17-3-1-
	--WAR.PJTX = 0 --破尽天下
	WAR.JTYL = 0 --谢无悠
	WAR.ZJWF = 0 --举重若轻
	WAR.JQRZ = 0 --举重若轻
	WAR.LSQL = 0
	WAR.LSQL1 = 0
	WAR.XYLCZ1 =0 
	WAR.L_JHGC = 0 --豸苗：谢云流
	WAR.TXTX = 0 --豸苗：太玄经
	WAR.TXSN = 0 --豸苗：太玄经杀怒17-2-8
	WAR.LXBL = 0--豸苗：龙象
	WAR.BHLH = 0--唯我独尊--17-2-27
	WAR.LHT = 0--沼跃鱼：罗汉堂
	WAR.KLYH = 0 --九龙功
	WAR.LHXS = 0
	WAR.QYYYL = 0
	WAR.LHFY = 0   --龙鹤风云庄
	WAR.DXYM = 0   --大小幽冥庄
	WAR.LJZYJ1 = 0 --临济领悟战意技
    WAR.LJZYJ2 = 0 --临济领悟战意技
    WAR.LJZYJ3 = 0 --临济领悟战意技
    WAR.LJZYJ4 = 0 --临济领悟战意技 
	WAR.YNSX = 0
	WAR.NHJT = 0--怒海剑涛
	WAR.FDLJ = 0--风刀雷剑
	WAR.XXZD = 0--吸星真谛
	WAR.BMMY = 0--北冥秘意
	WAR.JSJZ3 = 0
	WAR.YQLW = 0--杨家枪领悟--燎原百击三十击
	WAR.YQLW1 = 0--杨家枪领悟--燎原百击五十势
    WAR.AYMZ = 0--暗影迷踪
	WAR.JZFLW = 0--君子风领悟
	WAR.TZPT = 0
	WAR.TZPT1 = 0	
	WAR.WDJF1 = 0--武当剑法
	WAR.WDQF1 = 0--武当拳法
	WAR.WDQF2 = 0--武当拳法
	WAR.WDTJTJ = 0 --玄天太极剑
	WAR.WDTJTQ = 0 --玄天太极拳
	WAR.DWRY = 0 --道我如一
	WAR.BXJF1 = 0
	WAR.BXJF2 = 0
	WAR.BXJF3 = 0
	
    WAR.XYL=0 --豸苗：谢云流状态
	WAR.XYL1 = 0
    WAR.JHF=0 --豸苗：谢云流居合返
	WAR.BHBM = 0 --豸苗：童姥八荒八灭
	WAR.TXPF = 0 --豸苗：太玄经
	WAR.DFWM=0 --东方未明特效1
	WAR.DFWM2=0 --东方未明特效2
	WAR.DFWMXX=0 --东方未明吸血
	WAR.DFWM3=0
	WAR.DFWM3P=0
	WAR.KUANGDAO=0 --狂刀决判定
	WAR.TIANGANG=0
	WAR.DUOMINGJIAN=0
	WAR.CHDZS=0--沼跃鱼：残火刀终式
	WAR.LXYKJ=0 --李逍遥御剑加伤害
	WAR.DD=0
	WAR.LXYYJ=0 --李逍遥御剑判定
	WAR.ZLE=0
	WAR.SYWGZ = 0
	WAR.LFH=0
	WAR.YANGKANG=0
	WAR.BPLW1 = 0
	WAR.BPLW2 = 0
	WAR.BPLW3 = 0
	WAR.BPLW4 = 0
	WAR.BPLW5 = 0
	WAR.EMQF2 = 0
	
	WAR.YJZD2[pid] = nil
	if WAR.YJZDPD[pid] == 1 then
		WAR.YJZDPD[pid] = nil
		WAR.YJZD2[pid] = {
						JY.Person[pid]["受伤程度"], 
						JY.Person[pid]["中毒程度"], 
						WAR.FXDS[pid],
						WAR.LXZT[pid],
						WAR.CHZ[pid],
						}	
		JY.Person[pid]["受伤程度"] = 0
		JY.Person[pid]["中毒程度"] = 0
		WAR.FXDS[pid] = nil
		WAR.LXZT[pid] = nil
		WAR.CHZ[pid] = nil
		DIYdisplay(CC.ASKILL[4][2])
	end
	
	WAR.B_BMJQ={}
	if WAR.KMWD3[pid] == 1 then
		WAR.KMWD3[pid] = nil
	end
    if WAR.MCF == 1 then
      WAR.MCF = 0
    end
	if WAR.ZBT2 >0 then
      WAR.ZBT2 = 0
    end
	if WAR.MCF2 == 1 then
      WAR.MCF2 = 0
    end
	if WAR.CJSZ == 1 then
      WAR.CJSZ = 0
    end
	 if WAR.DFMQ == 1 then
      WAR.DFMQ = 0
    end
    if WAR.HQT == 1 then
      WAR.HQT = 0
    end
	if WAR.YD==1 then
	  WAR.YD = 0
	end
	--[[if WAR.L_HQJK  == 1 then --豸苗：谢云流 豪气剑空判断
      WAR.L_HQJK = 0
	end
	if WAR.L_DR  == 1 then --豸苗：谢云流 叠刃判断
      WAR.L_DR = 0
	end]]
    if WAR.CY == 1 then
      WAR.CY = 0
    end
    if WAR.TFH == 1 then
      WAR.TFH = 0
    end
    if WAR.WQQ == 1 then
      WAR.WQQ = 0
    end
    if WAR.HDWZ == 1 then
      WAR.HDWZ = 0
    end
	if WAR.GSLE == 1 then
		WAR.GSLE = 0
	end
	if WAR.KMWD>0 then----沼跃鱼：空明武道重置
	 WAR.KMWD=0
	end
	
	if WAR.HXSZ == 1 then --日月神教黑血神针
		WAR.HXSZ = 0
	end
    if WAR.L_YTJ1 == 1 then	--装备倚天剑特效，1流血
      WAR.L_YTJ1 = 0;	
    end
    if WAR.L_YTJ2 == 1 then	--装备倚天剑特效，1封穴
      WAR.L_YTJ2 = 0;		
    end

	if WAR.FS2~=0 then
	WAR.FS2=0
	end
	WAR.NGJL2 = WAR.NGJL;
    WAR.XDDF = 0
	WAR.XDDF2 = 0
    WAR.NGJL = 0
    WAR.KHBX = 0
	WAR.SHENMEN = 0
    WAR.GBWZ = 0
	WAR.GBWZ2 = 0
    WAR.BSMT = 0
    WAR.LXZQ = 0
	WAR.LXFM = 0
    WAR.GCTJ = 0
	WAR.GCTJ1 = 0
	WAR.QJSF = 0
    WAR.ASKD = 0
	WAR.JSTG2 = 0
	WAR.ASKD1 = 0
	WAR.GBXL=0
    WAR.JSYX = 0
    WAR.BMXH = 0 
	WAR.BMSZ = 0 --黄沙万里鞭白蟒沙阵
	WAR.QLKS = 0 --黄沙万里鞭从龙狂杀
	WAR.DYWQ = 0 --持瑶琴大雅无曲
	WAR.HHDW1 = 0 --煌煌道威
	WAR.HDYD = 0--沼跃鱼：胡斐战意技
	WAR.XTDJ = 0--沼跃鱼：杨过战意技
	WAR.LZZ = 0--唐门模式夺魄箭
	WAR.HXB = 0--唐门模式夺魄箭 
	WAR.BYLH = 0--唐门模式夺魄箭
	WAR.JTJD1 = 0 --唐门模式荆天棘地
	WAR.ZXJ = 0--唐门模式夺魄箭 
	WAR.CXN = 0--唐门模式夺魄箭
	WAR.ZCDZ = 0
	WAR.ZYDQ = 0
    WAR.TD = -1
	--WAR.ZHUJUETD={} --主角杀人得物品
	--WAR.ZHUJUETDNUM=0
    WAR.XXCC = 0
    WAR.TZ_XZ = 0
	WAR.TZ_XZ2 = 0--沼跃鱼：虚竹生死轮回
    WAR.ZSF2 = 0
    WAR.JGZ_DMZ = 0
    WAR.LHQ_BNZ = 0
	WAR.XMS_QSRL = 0
	WAR.RL = 0
    CleanWarMap(4, 0)
    
    WAR.L_CZJT = 0;			--蟾震九天 默认为0
	WAR.L_CZJT1 = 0         --蛤蟆九天17-2-23
    WAR.L_TLD = 0		--装备屠龙刀特效，流血
	WAR.L_TLD1 = 0;		--装备屠龙刀特效，1流血
    WAR.L_SSBD = 0;	--水笙攻击特效，迟缓
    WAR.L_SGJL = 0;	--神功加力，默认为0
    WAR.L_LXXL = 0;	--龙象般若功蓄力攻击，会造成迟缓
    WAR.L_LZJFCC = 0		--雷震剑法攻击是否有效
    WAR.L_RYJFCC = 0		--柔云剑法攻击是否有效
    
    WAR.L_QKDNY = {}	--重新计算乾坤大挪移是否被反弹过
	WAR.L_TJXL = {}
    
    WAR.L_MJJF = 0;		--灭绝剑法招式
    WAR.L_NSDFCC = 0;	--南山刀法是否触发
    WAR.L_WYJFA = 0;
	WAR.L_WYJFA1 = 0;
	WAR.L_WYJFA2 = 0;
	WAR.L_WYJFA3 = 0;
	WAR.L_WYJFA4 = 0;
	WAR.L_WYJFA5 = 0;
    
    WarDrawAtt(x, y, atkfanwei, 3)
    if ZHEN_ID >= 0 then
      local tmp_id = WAR.CurID
      WAR.CurID = ZHEN_ID
      if  WAR.HEJI == 1 and TGLX(WAR.Person[ZHEN_ID]["人物编号"])  then	
		WAR.JSYX = 1	  
      elseif WAR.DUIZHAO == 1 and (DT(WAR.Person[ZHEN_ID]["人物编号"],27) or (WAR.Person[ZHEN_ID]["人物编号"] == 0 and WAR.KHNP1[WAR.Person[ZHEN_ID]["人物编号"]] > 0)) then --17-1-3
		WAR.KHCM[WAR.Person[tmp_id]["人物编号"]] = 2
      elseif WAR.DUIZHAO == 2 and DT(WAR.Person[ZHEN_ID]["人物编号"],5) then --17-1-3
		WAR.TJXL[WAR.Person[tmp_id]["人物编号"]] = 1
      elseif WAR.DUIZHAO == 3 and DT(WAR.Person[ZHEN_ID]["人物编号"],114) then --17-1-3
		WAR.WXQQ[WAR.Person[tmp_id]["人物编号"]] = 1
      elseif WAR.DUIZHAO == 4 and DT(WAR.Person[ZHEN_ID]["人物编号"],50) then --17-1-3
		WAR.XLDL[WAR.Person[tmp_id]["人物编号"]] = 1
      elseif WAR.DUIZHAO == 5 and DT(WAR.Person[ZHEN_ID]["人物编号"],597) then --17-1-25-
		WAR.QF[WAR.Person[ZHEN_ID]["人物编号"]] = 3
		WAR.JTQF[WAR.Person[tmp_id]["人物编号"]] = 1	
      elseif WAR.DUIZHAO == 6 and DT(WAR.Person[ZHEN_ID]["人物编号"],592) then --17-1-25-
		WAR.PJTX = 1
	  elseif WAR.DUIZHAO == 7 and (T1LEQ(WAR.Person[ZHEN_ID]["人物编号"]) and juexing()>1) then --17-1-25-
		WAR.DPLX[WAR.Person[tmp_id]["人物编号"]] = 1
	  elseif WAR.DUIZHAO == 8 and (wglw1(WAR.Person[ZHEN_ID]["人物编号"],43) or (DT(WAR.Person[ZHEN_ID]["人物编号"],113) and JX(WAR.Person[ZHEN_ID]["人物编号"]))) then --还施彼身
		WAR.HSBS[WAR.Person[tmp_id]["人物编号"]] = 1
	  elseif WAR.DUIZHAO == 9 and (DT(WAR.Person[ZHEN_ID]["人物编号"],598) or (T13TQS(WAR.Person[ZHEN_ID]["人物编号"]) and juexing()>2)) then --17-1-25-
		WAR.HSBS2[WAR.Person[tmp_id]["人物编号"]] = 1
	  elseif WAR.DUIZHAO == 10 and DT(WAR.Person[ZHEN_ID]["人物编号"],600) then --17-1-25-
		WAR.PJTX = 1
	  --elseif WAR.DUIZHAO == 11 and NF(WAR.Person[ZHEN_ID]["人物编号"]) then --17-1-25-
	  --WAR.TJXL[WAR.Person[tmp_id]["人物编号"]] = 1
      --WAR.KHCM[WAR.Person[tmp_id]["人物编号"]] = 2
	  --WAR.QF[WAR.Person[ZHEN_ID]["人物编号"]] = 3
	  elseif WAR.DUIZHAO == 12 and BJY(WAR.Person[ZHEN_ID]["人物编号"]) then --17-1-25-
		WAR.QF[WAR.Person[ZHEN_ID]["人物编号"]] = 3
		WAR.JTQF[WAR.Person[tmp_id]["人物编号"]] = 1	
	  elseif WAR.DUIZHAO == 13 and wglw(WAR.Person[ZHEN_ID]["人物编号"],43) then 
		WAR.DZXF[WAR.Person[tmp_id]["人物编号"]] = 1
	  elseif WAR.DUIZHAO == 14 and DT(WAR.Person[ZHEN_ID]["人物编号"],583) then --17-1-25-
		WAR.TLHD = 1
		WAR.QF[WAR.Person[ZHEN_ID]["人物编号"]] = 3
	  elseif WAR.DUIZHAO == 15 and KHTJF(WAR.Person[ZHEN_ID]["人物编号"]) then --17-1-25-
		WAR.BXJFDZ1[WAR.Person[tmp_id]["人物编号"]] = 1
	  else
		WarDrawAtt(WAR.Person[ZHEN_ID]["坐标X"] + x0 - x, WAR.Person[ZHEN_ID]["坐标Y"] + y0 - y, atkfanwei, 3)
	  end 
	  if WAR.Person[WAR.CurID]["我方"] and T10XXZ(0) then --萧笑竹特殊判定
		for i = 0, WAR.PersonNum - 1 do 
			if WAR.Person[i]["我方"] and WAR.Person[i]["死亡"] == false and i ~= WAR.CurID and i ~= tmp_id and PersonKF(WAR.Person[i]["人物编号"], wugong) then
				WarDrawAtt(WAR.Person[i]["坐标X"] + x0 - x, WAR.Person[i]["坐标Y"] + y0 - y, atkfanwei, 3)
			end
		end		
      end
	 if WAR.Person[WAR.CurID]["我方"] and TGLX(WAR.Person[ZHEN_ID]["人物编号"]) then --萧笑竹特殊判定
		for i = 0, WAR.PersonNum - 1 do 
			if WAR.Person[i]["我方"] and WAR.Person[i]["死亡"] == false and i ~= WAR.CurID and i ~= tmp_id and PersonKF(WAR.Person[i]["人物编号"], wugong) then
				WarDrawAtt(WAR.Person[i]["坐标X"] + x0 - x, WAR.Person[i]["坐标Y"] + y0 - y, atkfanwei, 3)
			end
		end		
      end
      WAR.CurID = tmp_id
    end
    if WAR.SQFJ == 1 then
	  CleanWarMap(4, 0)
      for i = 0, WAR.PersonNum - 1 do
        if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
          SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
        end
      end
    end
   
   
    --判断攻击次数大于1
    if WAR.ACT > 1 then   
      local A = CC.WARS30    --显示连击
      if DT(pid, 27) then --武骧金星：单通判定修正
        A = CC.s45    --显示风云再起
      end
      if DT(pid, 161) and fightnum == 3 then
		A = "三无三不手"
	  end
      if DT(pid, 87) and fightnum == 3 then --武骧金星：添加苏荃称号技能
		local rr = math.random(3)
		if rr == 1 then
			A = "美人三招 贵妃回眸"
		elseif rr == 2 then
			A = "美人三招 小怜横陈"
		else
			A = "美人三招 飞燕回翔"
		end	  		
	  end	  
	
    if T9ZY(pid) and WAR.ZYLJ>0 and fightnum>2 then
		local WZTS = {".单骑破阵",".枪出如龙",".子龙朱雀",".日月光华",".端坐霜天",".横扫千军",".化蛟覆海"}
		local str=""
		if WAR.ZYQT>0 then
		str=WZTS[WAR.ZYQT]
		end
		A = "七探蛇盘枪"..str
	end
	
	if pid == 0 then 
	    if WAR.LMBJ2 == 1 then 
		    A = "连绵不绝"
			WAR.LMBJ2 = 0 
		elseif WAR.LMBJ3 == 1 then	
		    A = "连绵不绝"
			WAR.LMBJ3 = 0 
	    end 
    end
	  
	if DT(pid,601) then 
	    if WAR.LMBJ2 == 1 then 
		    A = "玉女清心.连绵不绝"
			WAR.LMBJ2 = 0 
		 elseif WAR.LMBJ3 == 1 then	
		    A = "玉女清心.连绵不绝"
			WAR.LMBJ3 = 0 
	    end 
	end
	  
	if MPPD(pid)==16 and PersonGT(pid,100) then 
	    if WAR.LMBJ8 == 1 then 
		    A = "紫阳剑罡.气化三清"
			WAR.LMBJ8 = 0 
		elseif WAR.LMBJ9 == 1 then	
		    A = "紫阳剑罡.气化三清"
			WAR.LMBJ9 = 0 
	    end 
	end
	  
	if pid == 0 and zjtype()==1 and juexing()>0 and GetS(10, 0, 11, 0) == 1  then 
	    local pz=math.modf((101-JY.Person[pid]["资质"])/2) 
		if WAR.ACT == 3 and JLSD(10,90+pz,pid) then 
		    A = "隼旋初式"
			WAR.LMBJ4=1
		elseif WAR.ACT == 4 and JLSD(10,60+pz,pid)then	
		    A = "隼旋次式"
			WAR.LMBJ4=2 
		elseif WAR.ACT >= 5 and JLSD(10,40+pz,pid)then	
		    A = "隼旋终式"
			WAR.LMBJ4=3 
	    end 
	end
	  
	if pid == 0 and zjtype()==4 and juexing()>0 then 
	    if WAR.ACT == 1 and JLSD(10,90,pid) then 
		    A = "虚空初式"
			WAR.LMBJ4=1
		elseif WAR.ACT == 2 and JLSD(10,60,pid)then	
		    A = "虚空次式"
			WAR.LMBJ4=2 
		elseif WAR.ACT >= 3 and JLSD(10,40,pid)then	
		    A = "虚空终式"
			WAR.LMBJ4=3 
	    end 
	end
	  
	if (GB(pid)==3 or DT(pid, 69)) then --乌衣丐帮
	    if WAR.ACT == 2 and JLSD(10,90,pid) then 
		    A = "傲血战意"
			WAR.LMBJ5=1
		elseif WAR.ACT == 3 and JLSD(10,60,pid)then	
		    A = "傲骨战意"
			WAR.LMBJ5=2 
		elseif WAR.ACT >= 4 and JLSD(10,40,pid)then	
		    A = "傲天战意"
			WAR.LMBJ5=3 
	    end 
	end
	  
	if DT(pid,152) and JX(pid) and  WAR.ACT == WAR.TXY then --萧秋水几率3-5连击，出招式，随机杀气
        WAR.LMBJ4=WAR.TXY
		A = "终结夺命剑"
	end
	  
	  
    --改到特效文字0显示
    if WAR.Person[WAR.CurID][CC.TXWZ0] ~= nil then
      	WAR.Person[WAR.CurID][CC.TXWZ0] = WAR.Person[WAR.CurID][CC.TXWZ0] .."・".. A
    else
      	WAR.Person[WAR.CurID][CC.TXWZ0] = A;
    end
      
    end
      
    --计算暴击
	local BJ1 = BJJL(pid)
    local BJ = 0

    if NF(pid) and juexing() > 2 then --聂风3觉必暴
		WAR.BJ = 1
	end	

	if T9ZY(pid) and WAR.ZYWS > 0 then --赵云无双必暴
		WAR.BJ = 1
	end	
	
	if MPPD(pid) == 11 and wugong == 131 and WAR.SJL == 4 then --豸苗：一刀流森九岚暴击
	    WAR.BJ = 1
	end
	
	if T3XYK(pid) and WAR.JUNSHEN > 0 then
		WAR.BJ = 1
	end

	if T13TQS(pid) and WAR.TQS==4 and DWPD() then--沼跃鱼：滕青山拟兽式狼吻暴击
		WAR.BJ = 1	
	end
	
	if wssz(pid) and WAR.TQS==4 and DWPD() then--沼跃鱼：滕青山拟兽式狼吻暴击
		WAR.BJ = 1	
	 end
	
	if pid == WAR.AXL then --阿修罗指令必暴击
		WAR.BJ = 1
	end
	
    if WAR.LMJQ > 0 then --六脉领悟必暴击
		WAR.BJ = 1
	end 		
	
	if wglw1(pid,18) and WAR.TZQJ4[pid] ~= nil then
		WAR.BJ = 1
	end	
	
    --瑜伽密乘暴击+50
	if PersonGT(pid,184) or DT(pid,665) then
		BJ = BJ + 50
	end 		
	
	if wglw(pid,153) then --临济领悟加暴击
		BJ = BJ + 30
	end	
	
    --武当九阳功	
    if PersonKF(pid,185) then
		BJ = BJ + 30
		if PersonGT(pid,185) then
		    BJ = BJ + 50
		end	
	end 	
	
	--伏魔杵暴击+10
	if JY.Person[pid]["武器"] == 50 and yongte(wugong) then
		BJ = BJ + 10
	end
	
	--玄铁剑暴击+10
	if yongjian(wugong) and JY.Person[pid]["武器"] == 36 then
		BJ = BJ + 10
	end
	
	if wugong == 1 then
		BJ = BJ + 10+math.modf((100-JY.Person[pid]["资质"])/10)
	end
	
	if wugong == 83 and wglw1(pid,83) then
		WAR.BJ = 1
	end
	
	--玄铁指环暴击+10
	if yongquan(wugong) and JY.Person[pid]["武器"] == 245 then
		BJ = BJ + 10
	end	
		
	--屠龙刀暴击+10
	if yongdao(wugong) and JY.Person[pid]["武器"] == 43 then
		BJ = BJ + 10
	end
	if fqdid(pid) and wugong == 62 then 
		BJ = 100
	end
	for i, v in ipairs(CC.WGJC) do --武功特效暴击加成
		if v[1] == wugong then
		    BJ = BJ + v[3]
		    break
		end
	end 		
	
	BJ = BJ / 200 * 100
	BJ = math.modf(BJ + BJ1)

    if myrandom(BJ,pid) then
        WAR.BJ = 1
    end

    
	if ljbj(pid, fightnum) then
		WAR.BJ = 1
	end
	
    --游坦之，有阿紫为队友必暴击
    if DT(pid, 48) then
        for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["人物编号"] == 47 and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
                WAR.BJ = 1
            end
        end
    end

    
    --欧阳锋 逆运状态下必暴击
    if (DT(pid, 60) or DT(pid, 620)) and WAR.tmp[1060] == 1 then
        WAR.BJ = 1
    end
	
    --太极套装必暴击
	if JY.Person[pid]["武器"]==236 and wugong==46 then 
		WAR.BJ = 1
	end
	--1-26-
	for i = 1, #CC.ZGT7 do
		if (CC.ZGT7[i][1] ==  WAR.HLTX or CC.ZGT7[i][2] ==  WAR.HLTX) and (wglw(pid,102) or (DT(pid,38) and PersonKF(pid,102))) then
			WAR.BJ = 1
			break
		end
	end
	--主功体暴击
	for i = 1, #CC.ZGT7 do
		if (CC.ZGT7[i][1] == wugong or (T12YMZ(pid) and wugong == 112)) and (PersonGT(pid, CC.ZGT7[i][2]) or ((PersonGT(pid,9999) and (JY.Thing[224]["加攻击力"]) == CC.ZGT7[i][2] or JY.Thing[224]["加防御力"]) == CC.ZGT7[i][2])) then
			WAR.BJ = 1
			break
		end
	end
	--and (PersonGT(pid, CC.ZGT7[i][2]) or ((PersonGT(pid,9999) and (JY.Thing[224]["加攻击力"]) == CC.ZGT7[i][2] or JY.Thing[224]["加防御力"]) == CC.ZGT7[i][2])) then
		--豸苗：折梅手
	for i = 1, #CC.ZGT7 do
	    for l = 1,10 do
	    local jl = 15 + math.modf(JY.Person[pid]["实战"] / 20)+ math.modf(JY.Person[pid]["武学常识"] / 10)
	        if wugong == 14 and (JLSD(0,5+jl,pid) or (MPPD(pid)==7 and JLSD(0,15,pid))) and JY.Person[pid]["内力"] >= 7000 then
	            if JY.Person[pid]["武功" .. l] == CC.ZGT7[i][1] then
			        WAR.BJ = 1
			        WAR.ZMS = 1
			        break
		        end
		    end
	    end
    end
    --[[--怒气值100，必暴击
    if WAR.LQZ[pid] == 100 and WAR.DZXY ~= 1 and WAR.SQFJ ~= 1 then
      WAR.BJ = 1
    end]]
    
    --蓝烟清：装备玄铁剑配合玄铁剑法必暴击
    if JY.Person[pid]["武器"] == 36 and wugong == 45 then
    	WAR.BJ = 1
    end
    
    --蓝烟清：装备屠龙刀，使用等级为极的刀法提高40%暴击率，暴击的情况下有50%机率大幅度杀集气，并且造成流血。杀集气量与武功威力有关
	if JY.Person[pid]["武器"] == 43 then
	  	if yongdao(wugong) then
    		if WAR.BJ == 1 and JLSD(25, 75, pid) then
    			WAR.L_TLD = 1;
    		end
    	end
	end
	  
	if MPPD(pid)==6 and MPDJ(pid)>1 then
    	if WAR.BJ == 1 then
    		WAR.L_TLD1 = 1;
    	end
	end
	  
	--蓝烟清：新逆运走火暴击率提高20%
	if (WAR.L_NYZH[pid] ~= nil or wglw(pid,104)) and JLSD(55, 75, pid) then
	  	WAR.BJ = 1;
	end
	  	  
	local ng = 0 --nino ng杀气设定

	--蓝烟清：DIY修改专用
	local diy_ng = War_DIY_Fight(id, wugong, JY.Person[pid]["武功等级" .. wugongnum], ng);
	if diy_ng == nil then
	  	ng = 0;
	end
	  ng=diy_ng
    
    if WAR.BJ == 1 and WAR.XSKJ[pid] == nil then
        WAR.Person[id][CC.TXDH] = 89   --暴击特效动画
        if DT(pid, 50) then    --乔峰
            local r = nil
            r = math.random(3)
            if r == 1 then
                WAR.Person[id][CC.TXWZ1] = CC.WARS24  --教单于折箭 六军辟易 奋英雄怒
            elseif r == 2 then
                WAR.Person[id][CC.TXWZ1] = CC.WARS25  --虽万千人吾往矣
            elseif r == 3 then
                WAR.Person[id][CC.TXWZ1] = CC.WARS26  --胡汉恩仇  须倾英雄泪
            end
        elseif DT(pid, 27) then   --东方不败
            WAR.Person[id][CC.TXWZ2] = CC.WARS27    --日出东方  唯我不败
	    elseif T11CJR(pid) and juexing() > 2 then
		    WAR.Person[id][CC.TXWZ2] = "纯阳行左 飞瀑走右 阴阳融合 袭地贯天"
    else
        WAR.Person[id][CC.TXWZ2] = CC.WARS28    --暴击加力
    end
		
    --改成特效文字0显示
    if WAR.Person[WAR.CurID][CC.TXWZ0] ~= nil then
      	WAR.Person[WAR.CurID][CC.TXWZ0] = WAR.Person[WAR.CurID][CC.TXWZ0] .."・".. CC.WARS29
    else
      	WAR.Person[WAR.CurID][CC.TXWZ0] = CC.WARS29;
    end

    end
	   
    --六脉领悟
	if wugong == 49 and ((DT(pid, 53) or DT(pid, 602)) or wglw1(pid,49)) then
		WAR.LMJQ = math.random(6)
		local str = ""
		if  WAR.LMJQ == 1 then
			str = "六脉剑气・少商剑"
		elseif WAR.LMJQ == 2 then
		    str = "六脉剑气・商阳剑"
		elseif WAR.LMJQ == 3 then
		    str = "六脉剑气・中冲剑"
		elseif WAR.LMJQ == 4 then
		    str = "六脉剑气・关冲剑"
		elseif WAR.LMJQ == 5 then
		    str = "六脉剑气・少冲剑"	
		elseif WAR.LMJQ == 6 then
		    str = "六脉剑气・少泽剑"	
		end 	    
        if WAR.Person[WAR.CurID][CC.TXWZ2] ~= nil then
	         WAR.Person[WAR.CurID][CC.TXWZ2] = WAR.Person[WAR.CurID][CC.TXWZ2] .."・"..str
		else
		     WAR.Person[WAR.CurID][CC.TXWZ2] = str
		end 
	end	
	
    --安七
	if DT(pid, 456) then
		WAR.LMJQ = math.random(6)
		local str = ""
		if  WAR.LMJQ == 1 then
			str = "六脉剑气・少商剑"
		elseif WAR.LMJQ == 2 then
		    str = "六脉剑气・商阳剑"
		elseif WAR.LMJQ == 3 then
		    str = "六脉剑气・中冲剑"
		elseif WAR.LMJQ == 4 then
		    str = "六脉剑气・关冲剑"
		elseif WAR.LMJQ == 5 then
		    str = "六脉剑气・少冲剑"	
		elseif WAR.LMJQ == 6 then
		    str = "六脉剑气・少泽剑"	
		end 	    
        if WAR.Person[WAR.CurID][CC.TXWZ2] ~= nil then
	         WAR.Person[WAR.CurID][CC.TXWZ2] = WAR.Person[WAR.CurID][CC.TXWZ2] .."・"..str
		else
		     WAR.Person[WAR.CurID][CC.TXWZ2] = str
		end 
	end		
	
    --全真剑法
	if wugong == 39 and (DT(pid, 129) or wglw1(pid,39)) then --全真剑法
        WAR.QZJF = math.random(7)
		local str = ""
		if  WAR.QZJF == 1 then
			str = "全真剑法・天枢"
		elseif WAR.QZJF == 2 then
		    str = "全真剑法・天璇"
		elseif WAR.QZJF == 3 then
		    str = "全真剑法・天玑"
		elseif WAR.QZJF == 4 then
		    str = "全真剑法・天权"
		elseif WAR.QZJF == 5 then
		    str = "全真剑法・玉衡"	
		elseif WAR.QZJF == 6 then
		    str = "全真剑法・开阳"	
		elseif WAR.QZJF == 7 then
		    str = "全真剑法・瑶光"			
		end 	    
        if WAR.Person[WAR.CurID][CC.TXWZ2] ~= nil then
	         WAR.Person[WAR.CurID][CC.TXWZ2] = WAR.Person[WAR.CurID][CC.TXWZ2] .."・"..str
		else
		     WAR.Person[WAR.CurID][CC.TXWZ2] = str
		end 
	end		
	
	--降龙刚劲
	if wugong == 26 and ((DT(pid,50) or DT(pid,617)) or wglw1(pid,26)) then
		WAR.XLGJ = math.random(5)
		local str = ""
		if  WAR.XLGJ == 1 then
			str = "降龙悟道・刚劲"
		elseif WAR.XLGJ == 2 then
		    str = "降龙悟道・柔劲"
		elseif WAR.XLGJ == 3 then
		    str = "降龙悟道・混劲"
		elseif WAR.XLGJ == 4 then
		    str = "降龙悟道・刚柔并济"
		elseif WAR.XLGJ == 5 then
		    str = "降龙悟道・三劲齐发"	
		end 	    
        if WAR.Person[WAR.CurID][CC.TXWZ2] ~= nil then
	         WAR.Person[WAR.CurID][CC.TXWZ2] = WAR.Person[WAR.CurID][CC.TXWZ2] .."・"..str
		else
		     WAR.Person[WAR.CurID][CC.TXWZ2] = str
		end
		WAR.Person[id][CC.TXDH] = 140	
	end
	
	if wugong == 140 and (wglw1(pid,140) or DT(pid,558)) then
		WAR.YFDLW = math.random(3)
		local str = ""
		if  WAR.YFDLW == 1 then
			str = "初之舞・月白"
			if WAR.Person[WAR.CurID][CC.TXWZ3] ~= nil then
	         WAR.Person[WAR.CurID][CC.TXWZ3] = WAR.Person[WAR.CurID][CC.TXWZ3] .."・"..str
			else
		     WAR.Person[WAR.CurID][CC.TXWZ3] = str
			end
		elseif WAR.YFDLW == 2 then
		    str = "次之舞・白涟"	
		if WAR.Person[WAR.CurID][CC.TXWZ2] ~= nil then
	        WAR.Person[WAR.CurID][CC.TXWZ2] = WAR.Person[WAR.CurID][CC.TXWZ2] .."・"..str
		else
		     WAR.Person[WAR.CurID][CC.TXWZ2] = str
		end
		elseif WAR.YFDLW == 3 then
		    str = "叁之舞・白刃"		    
		if WAR.Person[WAR.CurID][CC.TXWZ2] ~= nil then
	         WAR.Person[WAR.CurID][CC.TXWZ2] = WAR.Person[WAR.CurID][CC.TXWZ2] .."・"..str
		else
		     WAR.Person[WAR.CurID][CC.TXWZ2] = str
		end 
		end
	end	
	
    --三霸掌
	if BJY(pid) and yongquan(wugong) and juexing() > 1 then
		WAR.SBZ = math.random(3)
		local str = ""
		if WAR.SBZ == 1 then
			str = "雷霆无尽"
		elseif WAR.SBZ == 2 then
		    str = "风火无边"
		elseif WAR.SBZ == 3 then
		    str = "五情无敌"
		end 	    
        if WAR.Person[WAR.CurID][CC.TXWZ2] ~= nil then
	         WAR.Person[WAR.CurID][CC.TXWZ2] = WAR.Person[WAR.CurID][CC.TXWZ2] .."・"..str
		else
		     WAR.Person[WAR.CurID][CC.TXWZ2] = str
		end 
	end	
	
    --三霸剑
	if BJY(pid) and yongjian(wugong) and juexing() > 1 then
		WAR.SBJ = math.random(3)
		local str = ""
		if WAR.SBJ == 1 then
			str = "剑留痕"
		elseif WAR.SBJ == 2 then
		    str = "剑流云"
		elseif WAR.SBJ == 3 then
		    str = "剑流星"
		end 	    
        if WAR.Person[WAR.CurID][CC.TXWZ2] ~= nil then
	         WAR.Person[WAR.CurID][CC.TXWZ2] = WAR.Person[WAR.CurID][CC.TXWZ2] .."・"..str
		else
		     WAR.Person[WAR.CurID][CC.TXWZ2] = str
		end 
	end		
	
    --黯然领悟
	if wugong == 25 and (DT(pid, 58) or wglw1(pid,25)) then
		WAR.ARJX = math.random(5)
		local str = ""
		if  WAR.ARJX == 1 then
			str = "天地妒・未信与"
		elseif WAR.ARJX == 2 then
		    str = "相思无用・惟别而已"
		elseif WAR.ARJX == 3 then
		    str = "别期若有定・千般煎熬又何如"
		elseif WAR.ARJX == 4 then
		    str = "莫道黯然销魂・何处柳暗花明"
		elseif WAR.ARJX == 5 then
		    str = "黯然销魂者・唯别而已矣"	
		end 	    
        if WAR.Person[WAR.CurID][CC.TXWZ2] ~= nil then
	         WAR.Person[WAR.CurID][CC.TXWZ2] = WAR.Person[WAR.CurID][CC.TXWZ2] .."・"..str
		else
		     WAR.Person[WAR.CurID][CC.TXWZ2] = str
		end 
	end		
	
    --金乌刀法
	if (wugong == 61 and wglw1(pid,61)) or (DT(pid, 38) and (wugong == 61 or wugong == 66 )) then
		WAR.JWDF = math.random(5)
		local str = ""
		if  WAR.JWDF == 1 then
			str = "烈阳・开门揖盗"
		elseif WAR.JWDF == 2 then
		    str = "烈阳・梅雪逢夏"
		elseif WAR.JWDF == 3 then
		    str = "烈阳・千钧压驼"
		elseif WAR.JWDF == 4 then
		    str = "烈阳・大海沉沙"
		elseif WAR.JWDF == 5 then
		    str = "烈阳・赤日炎炎"	
		end 	    
        if WAR.Person[WAR.CurID][CC.TXWZ2] ~= nil then
	         WAR.Person[WAR.CurID][CC.TXWZ2] = WAR.Person[WAR.CurID][CC.TXWZ2] .."・"..str
		else
		     WAR.Person[WAR.CurID][CC.TXWZ2] = str
		end 
	end	
	
	--须弥山神掌领悟
	if wugong == 24 and (DT(pid,615) or wglw1(pid,24)) then
		WAR.XMSSZ = math.random(5)
		local str = ""
		if  WAR.XMSSZ == 1 then
			str = "七佛灭罪・毗婆尸"
		elseif WAR.XMSSZ == 2 then
		    str = "七佛灭罪・尸弃"
		elseif WAR.XMSSZ == 3 then
		    str = "七佛灭罪・毗舍浮"
		elseif WAR.XMSSZ == 4 then
		    str = "七佛灭罪・拘留孙"
		elseif WAR.XMSSZ == 5 then
		    str = "七佛灭罪・拘那含牟尼"	
		end 	    
        if WAR.Person[WAR.CurID][CC.TXWZ2] ~= nil then
	         WAR.Person[WAR.CurID][CC.TXWZ2] = WAR.Person[WAR.CurID][CC.TXWZ2] .."・"..str
		else
		     WAR.Person[WAR.CurID][CC.TXWZ2] = str
		end 
	end
	
	if WAR.XMSSZ == 6 then
		if WAR.Person[WAR.CurID][CC.TXWZ2] ~= nil then
	         WAR.Person[WAR.CurID][CC.TXWZ2] = WAR.Person[WAR.CurID][CC.TXWZ2] .."+".."七佛灭罪・释迦牟尼"
		else
		     WAR.Person[WAR.CurID][CC.TXWZ2] = "七佛灭罪・释迦牟尼"
		end
	end
	
    --玄冥领悟
	if wugong == 21 and ((DT(pid, 643) or DT(pid, 644)) or wglw1(pid,21)) then
		WAR.XMSZ = math.random(4)
		local str = ""
		if  WAR.XMSZ == 1 then
			str = "玄冥・毒吞天下"
		elseif WAR.XMSZ == 2 then
		    str = "玄冥・寒冰"
		elseif WAR.XMSZ == 3 then
		    str = "玄冥冰毒"
		elseif WAR.XMSZ == 4 then
		    str = "玄冥火毒"
		end 	    
        if WAR.Person[WAR.CurID][CC.TXWZ2] ~= nil then
	         WAR.Person[WAR.CurID][CC.TXWZ2] = WAR.Person[WAR.CurID][CC.TXWZ2] .."・"..str
		else
		     WAR.Person[WAR.CurID][CC.TXWZ2] = str
		end 
	end			
	
	--持瑶琴战意技
	if wugong == 73 and wglw1(pid,73) and WAR.LQZ[pid] == 100 and WAR.SPIRIT[pid] > 120 then
		WAR.TDSX = math.random(2)
	end
	--铁碎牙蓄力
	if wugong == 67 and (wglw1(pid,67) or (DT(pid, 1) and JX(pid)) or (DT(pid, 621) and JX(pid))) and WAR.Actup[pid] == 1 then
		WAR.TSYXL = math.random(3)
		local str = ""
		if  WAR.TSYXL == 1 then
			str = "血玉碎牙"
		elseif WAR.TSYXL == 2 then
		    str = "龙鳞碎牙"
		elseif WAR.TSYXL == 3 then
		    str = "金刚碎牙"
		end 	    
        if WAR.Person[WAR.CurID][CC.TXWZ2] ~= nil then
	         WAR.Person[WAR.CurID][CC.TXWZ2] = WAR.Person[WAR.CurID][CC.TXWZ2] .."・"..str
		else
		     WAR.Person[WAR.CurID][CC.TXWZ2] = str
		end 
	end
	--明八卦攻
	if wglw1(pid,138) and wugong == 138 then
		WAR.MINBG = math.random(4)
	end	
	--暗八卦攻
	if WAR.YXZ[pid] ~= nil and WAR.YXZ[pid] > 0 then
		WAR.ANBG = math.random(4)
	end
	
	--铁掌领悟
	if wugong == 13 and wglw1(pid,13) then
		WAR.CYANGZ = math.random(2)
		local str = ""
		if  WAR.CYANGZ == 1 then
			str = "纯阳一气"
			if WAR.Person[WAR.CurID][CC.TXWZ3] ~= nil then
	         WAR.Person[WAR.CurID][CC.TXWZ2] = WAR.Person[WAR.CurID][CC.TXWZ3] .."・"..str
			else
		     WAR.Person[WAR.CurID][CC.TXWZ3] = str
			end
		elseif WAR.CYANGZ == 2 then
		    str = "辟邪烈日"
			if WAR.Person[WAR.CurID][CC.TXWZ2] ~= nil then
	         WAR.Person[WAR.CurID][CC.TXWZ2] = WAR.Person[WAR.CurID][CC.TXWZ2] .."・"..str
			else
		     WAR.Person[WAR.CurID][CC.TXWZ2] = str
			end
		end
	end	
	if wglw1(pid,13) and wugong == 13 and JLSD(10,60,pid) and WAR.CYANGZ ~= 1 then
		WAR.CYANGZ = 3
		local str = ""
		str = "纯阳贯地"
		if WAR.Person[WAR.CurID][CC.TXWZ1] ~= nil then
		 WAR.Person[WAR.CurID][CC.TXWZ1] = WAR.Person[WAR.CurID][CC.TXWZ1] .."・"..str
		else
		 WAR.Person[WAR.CurID][CC.TXWZ1] = str
		end
	end 	    
	
	--寒冰绵掌领悟
	--[[if WAR.YXZ[pid] ~= nil and WAR.YXZ[pid] > 0 then
		WAR.ANBG = math.random(4)
	end]]
	
	--古墓暗器
	if MPPD(pid) == 3 and sixi(pid,5) > 200 and PersonKFJ(pid,168) and PersonKFJ(pid,170) and yongan(wugong) then
		WAR.GMAQ = math.random(3)
	end
	
	--三指诛仙(一阳、幻阴加强)
	if PersonKF(pid,19) and PersonKF(pid,17) 
		and ((wugong == 17 and (wglw1(pid,17) or DT(pid,65))) or (wugong == 19 and (wglw1(pid,19) or DT(pid,18)))) 
		and WAR.LQZ[pid] == 100 then
		if WAR.ACT == 1 or WAR.ACT == 4 then
			WAR.SZZX = 1
			DIYdisplay("一指断欲・难返蓬瀛")
		elseif 	WAR.ACT == 2 or WAR.ACT == 5 then
			WAR.SZZX = 2
			DIYdisplay("二指灭道・重堕轮回")
		elseif 	WAR.ACT == 3 or WAR.ACT == 6 then
			WAR.SZZX = 3
			DIYdisplay("三指诛仙・魄形俱丧・万劫周回生不负")
		end
	end	
	
    --七伤拳领悟
	if wugong == 23 and ((DT(pid, 8) or DT(pid, 167) or DT(pid, 168)) or wglw1(pid,23)) then
		WAR.SGSF = math.random(7)
		local str = ""
		if  WAR.SGSF == 1 then
			str = "损心诀"
		elseif WAR.SGSF == 2 then
		    str = "伤肺诀"
		elseif WAR.SGSF == 3 then
		    str = "摧肝肠诀"
		elseif WAR.SGSF == 4 then
		    str = "藏离诀"
		elseif WAR.SGSF == 5 then
		    str = "精失诀"
		elseif WAR.SGSF == 6 then
		    str = "意恍惚诀"
		elseif WAR.SGSF == 7 then
		    str = "七伤总诀"			
		end 	
		if WAR.Person[WAR.CurID][CC.TXWZ2] ~= nil then
	         WAR.Person[WAR.CurID][CC.TXWZ2] = WAR.Person[WAR.CurID][CC.TXWZ2] .."・"..str
		else
		     WAR.Person[WAR.CurID][CC.TXWZ2] = str
		end 
	end		    			
	
    --幻阴指
	if wugong == 19 and (DT(pid,18) or wglw1(pid,19)) then
		WAR.HYZF = math.random(4)
		local str = ""
		if  WAR.HYZF == 1 then
			str = "一指凝血脉"
		elseif WAR.HYZF == 2 then
		    str = "二指损任督"
		elseif WAR.HYZF == 3 then
		    str = "三指破心神"
		elseif WAR.HYZF == 4 then
		    str = "无相幻阴・三分天下"	
		end 	    
        if WAR.Person[WAR.CurID][CC.TXWZ2] ~= nil then
	         WAR.Person[WAR.CurID][CC.TXWZ2] = WAR.Person[WAR.CurID][CC.TXWZ2] .."・"..str
		else
		     WAR.Person[WAR.CurID][CC.TXWZ2] = str
		end 
	end	
	
	if  wugong == 12 and wglw1(pid,12) then
		WAR.LYBF = math.random(3)
		local str = ""
		if  WAR.LYBF == 1 then
			str = "景严・落英散华"
		elseif WAR.LYBF == 2 then
		    str = "亢景・落英汇聚"
		elseif WAR.LYBF == 3 then
		    str = "终景・黄帝剑掌"
		end 

        if WAR.LYBF == 2 then
			for j = 0, WAR.PersonNum - 1 do
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
					WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - 100
					if WAR.LYBF == 2 then
						local tmppid = WAR.Person[j]["人物编号"]
						WAR.LXZT[tmppid]=WAR.LXZT[tmppid] or 0 + math.random(1, 10)
						local bb=WAR.LXZT[tmppid]
						WAR.Person[j]["内伤点数"] = (WAR.Person[j]["内伤点数"] or 0) + AddPersonAttrib(tmppid, "受伤程度", bb)
						WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
					end
				end
			end		
		end	    
        if WAR.Person[WAR.CurID][CC.TXWZ2] ~= nil then
	         WAR.Person[WAR.CurID][CC.TXWZ2] = WAR.Person[WAR.CurID][CC.TXWZ2] .."・"..str
		else
		     WAR.Person[WAR.CurID][CC.TXWZ2] = str
		end 
	end	
	
	if wugong == 38 and wglw1(pid,38) then
		WAR.YXMQ = math.random(3)
		local str = ""
		if  WAR.YXMQ == 1 then
			str = "魔曲・八音穿心"
		elseif WAR.YXMQ == 2 then
		    str = "次曲・次声震脉"
		elseif WAR.YXMQ == 3 then
		    str = "终曲・阎魔蟋蟀"
		end 

        if WAR.YXMQ >=1 then
			for j = 0, WAR.PersonNum - 1 do
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
					local tmppid = WAR.Person[j]["人物编号"]
					local aa = math.random(2,8)
					local bb=  math.modf(JY.Person[tmppid]["内力"]/500)
						WAR.Person[j]["体力点数"] = (WAR.Person[j]["体力点数"] or 0) + AddPersonAttrib(tmppid, "体力", -aa)
					if WAR.YXMQ == 1 then	
						WAR.BYCX[tmppid]=1
					end
					if WAR.YXMQ == 2 then	
						WAR.Person[j]["内伤点数"] = (WAR.Person[j]["内伤点数"] or 0) + AddPersonAttrib(tmppid, "受伤程度", bb)
						WAR.LXZT[tmppid]=WAR.LXZT[tmppid] or 0 + bb
						WAR.MENG[tmppid]=WAR.MENG[tmppid] or 0 + bb
					end
					if WAR.YXMQ ==3 then
					    WAR.YHDF[tmppid]=1
					end
					WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
				end
			end		
		end	    
        if WAR.Person[WAR.CurID][CC.TXWZ1] ~= nil then
	         WAR.Person[WAR.CurID][CC.TXWZ1] = WAR.Person[WAR.CurID][CC.TXWZ1] .."・"..str
		else
		     WAR.Person[WAR.CurID][CC.TXWZ1] = str
		end 
	end	
	
	if wugong == 30 and wglw1(pid,30) then
       WAR.WYLW1 = math.random(4)
        local str = ""		
		if  WAR.WYLW1 == 1 then
			str = "北堂壬水・惊涛拍岸"
		elseif WAR.WYLW1 == 2 then
		    str = "北堂壬水・千里冰封"
		elseif WAR.WYLW1 == 3 then
		    str = "北堂癸水・润物无声"
		elseif WAR.WYLW1 == 4 then
		    str = "北堂癸水・阴寒侵袭"
		end
        if WAR.WYLW1 == 2 then
			for j = 0, WAR.PersonNum - 1 do
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then				
					local tmppid = WAR.Person[j]["人物编号"]
					WAR.ICE[tmppid]=WAR.ICE[tmppid] or 0 + 30
					local bb=WAR.ICE[tmppid]*15
					WAR.Person[j]["内力点数"] = (WAR.Person[j]["内力点数"] or 0) + AddPersonAttrib(tmppid, "内力", -bb)
					WAR.XNXS[tmppid] = 1
				end
			end		
		end	   		
        if WAR.Person[id][CC.TXWZ2] ~= nil then
	         WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .."・"..str
		else
		     WAR.Person[id][CC.TXWZ2] = str
		end 
	end	
		
	if  wugong == 31 and wglw1(pid,31) then
		WAR.WYLW2 = math.random(4)
		local str = ""
		if  WAR.WYLW2 == 1 then
			str = "东方甲木・巨木锤击"
		elseif WAR.WYLW2 == 2 then
		    str = "东方甲木・茂木成林"
			WAR.FLHS2=WAR.FLHS2+math.random(3,5)
		elseif WAR.WYLW2 == 3 then
		    str = "东方乙木・滕蔓纠缠"
		elseif WAR.WYLW2 == 4 then
		    str = "东方乙木・青霉蔓延"
		end
        if WAR.WYLW2 == 4 then
			for j = 0, WAR.PersonNum - 1 do
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then				
					local tmppid = WAR.Person[j]["人物编号"]
					WAR.POISON[tmppid] = math.modf(JY.Person[pid]["实战"] / 10) 
				end
			end		
		end	   		
        if WAR.Person[id][CC.TXWZ2] ~= nil then
	         WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .."・"..str
		else
		     WAR.Person[id][CC.TXWZ2] = str
		end 
	end	
	
		if wugong == 32 and wglw1(pid,32) then
		local str = ""
        WAR.WYLW3 = math.random(4)	
		if  WAR.WYLW3 == 1 then
			str = "南宫丙火・烈火焚城"
		elseif WAR.WYLW3 == 2 then
		    str = "南宫丙火・松明抚斩"
		elseif WAR.WYLW3 == 3 then
		    str = "南宫丙火・火毒攻心"
		elseif WAR.WYLW3 == 4 then
		    str = "南宫丙火・怒火中烧"
		end
        if WAR.WYLW3 == 1 then
			for j = 0, WAR.PersonNum - 1 do
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then				
					local tmppid = WAR.Person[j]["人物编号"]
					WAR.HOT[tmppid]=WAR.HOT[tmppid] or 0 + 30
					local bb=WAR.HOT[tmppid]*5
					WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(tmppid, "生命", -bb)
					WAR.XNXS[tmppid] = 1
				end
			end		
		end	   		
        if WAR.Person[id][CC.TXWZ2] ~= nil then
	         WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .."・"..str
		else
		     WAR.Person[id][CC.TXWZ2] = str
		end 
	end	
	
	if  wugong == 33 and wglw1(pid,33) then
		local str = ""
        WAR.WYLW4 = math.random(4)
        CleanWarMap(4, 0)
        for i = 0, WAR.PersonNum - 1 do
            if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
                SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
            end
        end		
		if  WAR.WYLW4 == 1 then
			str = "中央戊土・峰峦如聚"
			WAR.FLHS1=1
		elseif WAR.WYLW4 == 2 then
		    str = "中央戊土・乱石穿空"
		elseif WAR.WYLW4 == 3 then
		    str = "中央已土・沙瀑大葬"
		elseif WAR.WYLW4 == 4 then
		    str = "中央已土・流沙囚牢"
		end
		if WAR.WYLW4 == 2 then
			for j = 0, WAR.PersonNum - 1 do
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then				
					local tmppid = WAR.Person[j]["人物编号"]
					WAR.Person[j]["内伤点数"] = (WAR.Person[j]["内伤点数"] or 0) + AddPersonAttrib(tmppid, "受伤程度", 10)
					WAR.XNXS[tmppid] = 1
				end
			end		
		end	
     
	if WAR.WYLW4 == 3 then
        local ns=math.random(3,4)*10
	    local str=""
	    local ns2=0
	    for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
                local tmppid = WAR.Person[j]["人物编号"]
		        WAR.CHXS[tmppid] = 1
		        WAR.CHZ[tmppid] = limitX((WAR.CHZ[tmppid] or 0) + ns, 0, 100)
				WAR.XNXS[tmppid] = 1
            end
        end
	end	
	
        if WAR.WYLW4 == 4 then
			for j = 0, WAR.PersonNum - 1 do
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then				
					local tmppid = WAR.Person[j]["人物编号"]
					WAR.L_NOT_MOVE[tmppid]=WAR.L_NOT_MOVE[tmppid] or 0 + 1
				end
			end		
		end	   		
        if WAR.Person[id][CC.TXWZ2] ~= nil then
	         WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .."・"..str
		else
		     WAR.Person[id][CC.TXWZ2] = str
		end 
	end	
	
	if  wugong == 34 and wglw1(pid,34) then
		local str = ""
        WAR.WYLW5 = math.random(4)
		if  WAR.WYLW5 == 1 then
			str = "西门庚金・金石可镂"
		elseif WAR.WYLW5 == 2 then
		    str = "西门庚金・电光连环"
		elseif WAR.WYLW5 == 3 then
		    str = "西门辛金・经脉寸断"
		elseif WAR.WYLW5 == 4 then
		    str = "西门辛金・金光夺目"
		end
		
  		if WAR.WYLW5 == 4 then
			for j = 0, WAR.PersonNum - 1 do
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then				
					local tmppid = WAR.Person[j]["人物编号"]
					WAR.KHCM[tmppid]=2 
				end
			end		
		end	  
        if WAR.Person[id][CC.TXWZ2] ~= nil then
	         WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .."・"..str
		else
		     WAR.Person[id][CC.TXWZ2] = str
		end 
	end	
	
    if wugong == 63 and wglw1(pid,63) then
		if fightnum<=2 then
		    fightnum=fightnum+math.random(2,4)
        end	
		local str = ""
        WAR.XDDF2 = math.random(3)
		if  WAR.XDDF2 == 1 then
			str = "血煞刀法・气血逆转"
		elseif WAR.XDDF2 == 2 then
		    str = "血煞刀法・血溅十步"
		elseif WAR.XDDF2 == 3 then
		    str = "血煞刀法・血色弥漫"
		end
        if WAR.XDDF2 == 3 then
			for j = 0, WAR.PersonNum - 1 do
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then				
					local tmppid = WAR.Person[j]["人物编号"]
					WAR.MENG[tmppid]=WAR.MENG[tmppid] or 0 +math.modf(JY.Person[pid]["实战"] / 10)
					WAR.XQFJ[tmppid]=WAR.XQFJ[tmppid] or 0 +math.modf(JY.Person[pid]["实战"] / 10)
				end
			end		
		end	  
        if WAR.Person[id][CC.TXWZ2] ~= nil then
	         WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .."・"..str
		else
		     WAR.Person[id][CC.TXWZ2] = str
		end
	end	
	
	if wugong == 155 and wglw1(pid,155) or DT(pid,665) then
		local str = ""
        WAR.ZKSY = math.random(3)
		if  WAR.ZKSY == 1 then
			str = "真空手印・贯通"
			WAR.ZKSY1 = 1
		elseif WAR.ZKSY == 2 then
		    str = "真空手印・狂狮"
			local d = math.modf(JY.Person[pid]["内力"]  / 300)
		    if d < 20 then
                d = 20
            end
		    local dd=d*10
				for i = 0, WAR.PersonNum - 1 do 
					if WAR.Person[i]["我方"] == false and WAR.Person[i]["死亡"] == false and i ~= WAR.CurID then
						WAR.Person[i].Time = math.max(WAR.Person[i].Time - dd, -500)
						WAR.Person[i]["内伤程度"] = (WAR.Person[i]["内伤程度"] or 0) + AddPersonAttrib(WAR.Person[i]["人物编号"],"受伤程度", math.random(15,d))
						WAR.XNXS[tmppid] = 1
					end
				end
		elseif WAR.ZKSY == 3 then
		    str = "真空手印・戾炎"
		end
        if WAR.Person[id][CC.TXWZ2] ~= nil then
	         WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .."・"..str
		else
		     WAR.Person[id][CC.TXWZ2] = str
		end
	
	end	
	
	if wglw1(pid,43) or ((DT(pid , 51) or DT(pid,113)) and JX(pid)) and WAR.DZXY==1 then
        local str = ""
        WAR.DZPZ = math.random(3)
		if WAR.DZPZ == 1 then
			str = "星辰变・璀璨星屑"
		elseif WAR.DZPZ == 2 then
		    str = "星辰变・银河星爆"
		elseif WAR.DZPZ == 3 then
		    str = "星辰变・星光灭绝"
		end
	    if WAR.Person[id][CC.TXWZ2] ~= nil then
	        WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .."・"..str
		else
		    WAR.Person[id][CC.TXWZ2] = str
		end
	 end

    --霹雳刀法 焚天烈焰
	if (DT(pid, 585) or wglw1(pid, 141)) and JLSD(15, 65, pid) and yongdao(wugong) then
	    local nl = math.modf((JY.Person[pid]["内力"] * 2 + JY.Person[pid]["内力最大值"])/3)
	    for j = 0, WAR.PersonNum - 1 do
        if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
            local tmpid=WAR.Person[j]["人物编号"]
		    local enemynl = math.modf(JY.Person[tmpid]["内力"] * 0.8)
		    local tmpshaqi = math.modf((nl - enemynl)/40)
	        if tmpshaqi < 0 then tmpshaqi = 0 end
		        WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - 100 - tmpshaqi
            end
        end
        if WAR.Person[id][CC.TXWZ2] ~= nil then
      	    WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+" .."霹雳刀法・焚天烈焰"
        else
      	    WAR.Person[id][CC.TXWZ2] = "霹雳刀法・焚天烈焰"
        end
	    WAR.Person[id][CC.TXDH] = 50
	end	 
	
	if (((XYL(pid) or jtyl(pid)) and JHF == 1) or (SJL(pid) and wugong == 131 and SJLF == 1)) and fightnum == 3 then  --豸苗：谢云流居合返  
	    if jtyl(pid) then 
		  WAR.Person[WAR.CurID][CC.TXWZ0] = "天女・返"--谢无悠
		else
		  WAR.Person[WAR.CurID][CC.TXWZ0] = "斩流・返"
		end  
    end

	if MPPD(pid) == 11 and WAR.LW~= nil and fightnum > 3 then  --豸苗：谢云流居合返 
	    if jtyl(pid) then 
		  WAR.Person[WAR.CurID][CC.TXWZ0] = "天女・切返"	--谢无悠
		else  
		  WAR.Person[WAR.CurID][CC.TXWZ0] = "斩流・切返"
		end  
    end
		  
	if pid == 0 and T5BCF(0) then
		if WAR.BCFLJ == 1 then
			local randomword = math.random(4)
			if randomword == 1 then
				WAR.Person[id][CC.TXWZ0] = "大丈夫久居人下，生死等闲，顺风则行，逆风则泊"
			elseif randomword == 2 then
				WAR.Person[id][CC.TXWZ0] = "我欲上九天揽月，痛饮狂欢，宁斗而败，不屈而活"
			elseif randomword == 3 then
				WAR.Person[id][CC.TXWZ0] = "一朝得势自比天，挥斥方遒，有何罡碍，有何不可"
			else
				WAR.Person[id][CC.TXWZ0] = "我志在万世功业，名扬天下，宁鸣而生，不默而死"
			end
		end
	end
    
	--全真剑法领悟
	if WAR.QZJF > 0 then
        for i = 0, WAR.PersonNum - 1 do 
			if WAR.Person[i]["我方"] == false and WAR.Person[i]["死亡"] == false and i ~= WAR.CurID then
				WAR.Person[i].Time = math.max(WAR.Person[i].Time-150,-150,300)
				WAR.Person[i]["内伤程度"] = (WAR.Person[i]["内伤程度"] or 0) + AddPersonAttrib(WAR.Person[i]["人物编号"],"受伤程度", math.random(25))
				WAR.XNXS[tmppid] = 1
			end
		end
	    ng = ng + 1250		
	end	
	
    if (wglw(pid,182) or (DT(pid,5) and PersonGT(pid,182))) and JLSD(10,40,pid) then
        if WAR.TJSG[pid] == nil then
	        WAR.TJSG[pid] = 0
		elseif WAR.TJSG[pid] >= 2000 then
			    ng = ng + WAR.TJSG[pid]
            for j = 0, WAR.PersonNum - 1 do
                if WAR.Person[j]["死亡"] == false and 
		            WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and not nokillspeed(WAR.Person[j]["人物编号"]) then
                    WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - math.modf(WAR.TJSG[pid]/5)
                end
            end
			if 	WAR.Person[id][CC.TXWZ2] == nil then
				WAR.Person[id][CC.TXWZ2] = "太极・蓄势待发"
			else
				WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].. "+太极・蓄势待发"
			end
		end
	end	
	
    --蟾震九天，最先判断，不影响加力
    --斗转和水镜的反击不触发
    if WAR.DZXY == 0 and WAR.SQFJ ~= 1 then
		if PersonKF(pid, 95) then
	        if WAR.tmp[200 + pid] == nil then
	             WAR.tmp[200 + pid] = 0
	      	elseif WAR.tmp[200 + pid] > 150 then
				ng = ng + WAR.tmp[200 + pid] * 10		  
				if PersonGT(pid, 95) or DT(pid, 60) or DT(pid, 620) then				
					ng = ng + 500				
					WAR.Person[id][CC.TXWZ2] = "蛤蟆功" .. "・神蟾震九天"
				else
					WAR.Person[id][CC.TXWZ2] = "蛤蟆功" .. "・蟾震九天"
				end
				WAR.Person[id][CC.TXDH] = 112
				WAR.L_CZJT = 1;		--发动蟾震九天，无视上毒
	        end			
		end
	end

	if (wglw(pid,95) or ((DT(pid,60) or DT(pid,620)) and PersonKF(pid,95))) then --蛤蟆九天17-2-23
	    if WAR.HMJT[pid] == nil then
	        WAR.HMJT[pid] = 0
		elseif WAR.HMJT[pid] >= 3000 then
			    ng = ng + WAR.HMJT[pid]
			if 	WAR.Person[id][CC.TXWZ2] == nil then
				WAR.Person[id][CC.TXWZ2] = "气吞山河・崩"
			else
				WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].. "+气吞山河・崩"
			end
            for j = 0, WAR.PersonNum - 1 do
                if WAR.Person[j]["死亡"] == false and 
		            WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and not nokillspeed(WAR.Person[j]["人物编号"]) then
                    WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - math.modf(WAR.HMJT[pid]/5)
                end
            end
				WAR.Person[id][CC.TXDH] = 112
				WAR.L_CZJT1 = 1		--发动蟾震九天，无视上毒
		end
	end

    --霹雳刀式
    if (DT(pid, 585) or wglw1(pid, 141))  and yongdao(wugong) then
        local aa=math.random(16)
	    local str="霹雳刀势"
	    local str1="霹雳刀式"
	    if aa<= 2 then
            str="横扫千军"
            ng = ng + 1400;
        elseif aa <=4 then
            str = "血战八方" 
            ng = ng + 1600;
        elseif aa <=6 then
            str = "烈火燎原" 
            ng = ng + 1800;
        elseif aa <=8 then
	        str = "雷霆万钧" 
            ng = ng + 2000;
	else
	    if WAR.ACT==1 then
	        fightnum = fightnum+3
	    end
	    ng = ng + 2000;
	    WAR.ASKD1=1
	    WAR.PLDS = math.random(3)
	    if WAR.PLDS ==1 then
            str1= "霹雳刀势・灭魄";
        elseif WAR.PLDS ==2 then
            str1= "霹雳刀势・鬼雄";
        elseif WAR.PLDS ==3 then
            str1= "霹雳刀势・祝融";
        end
	    end
	    if WAR.Person[id][CC.TXWZ3] == nil then
	        WAR.Person[id][CC.TXWZ3] = str
	    else
	        WAR.Person[id][CC.TXWZ3] = str .. "+" ..WAR.Person[id][CC.TXWZ3];
	    end
	    if WAR.Person[id][CC.TXWZ0] == nil then
	        WAR.Person[id][CC.TXWZ0] = str1
	    else
	        WAR.Person[id][CC.TXWZ0] = str1 .. "+" ..WAR.Person[id][CC.TXWZ0];
	    end
    end  
			
    if WAR.NS[pid] ~= nil then 
       ng = 0----日月神教
    end
	
    if DT(pid,617) then
		ng = 0 
	end 		
	
    --重写内功加力
	if JY.Person[pid]["声望"] > 0 and yongnei(JY.Person[pid]["声望"]) and WAR.BMGT2 ~= pid and WAR.PJTX == 0 then --如果有设置主功体
		local bjl = JLJL(pid)	
		if math.random(100) <= bjl then 
			WAR.NGJL = JY.Person[pid]["声望"]
			WAR.L_SGJL = WAR.NGJL
			local wl = 0
			for i,v in ipairs(CC.ZGTATK) do
				if v[1] == WAR.NGJL then
					wl = math.random(v[2], v[3])
					break
				end
			end
			ng = ng + wl
			if hasTF(pid, 10) then
				ng = ng + math.modf(wl * 0.5)
			end			
			if DT(pid, 48) and JX(pid) then --铁头内功加力*1.5-2
				ng = ng + math.modf(wl * math.random(5, 10) * 0.1)
			end
			local str = JY.Wugong[WAR.NGJL]["名称"]
			if WAR.LHZF[pid]~=nil and WAR.LHZF[pid]>0 then
				ng=0
				if WAR.Person[id][CC.TXWZ2] ~= nil then
					WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+".. "三藐菩提"
				else
					WAR.Person[id][CC.TXWZ2] = "三藐菩提"
				end
				WAR.LHZF[pid]=0
			end
			if WAR.FMZZ[pid]~=nil and WAR.FMZZ[pid]>0 then
		        WAR.MENG[pid]=30
		        WAR.CYSH[pid]=30
		        WAR.Person[WAR.CurID]["内伤点数"] = (WAR.Person[WAR.CurID]["内伤点数"] or 0) + AddPersonAttrib(pid, "受伤程度", 20)
		    if WAR.Person[id][CC.TXWZ2] ~= nil then
				WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+".. "业障缠身"
			else
				WAR.Person[id][CC.TXWZ2] = "业障缠身"
			end
			WAR.FMZZ[pid]=0
	        end
			if WAR.WYQS[pid]~=nil and WAR.WYQS[pid]>0 then
		        local aa=math.random(5)
				local bb=math.random(5)
				local cc=math.random(5)
				local dd=math.random(5)
				local ee=math.random(5)
				WAR.FXXS[pid] = 1
				WAR.ICEXS[pid] = 1
				WAR.HOTXS[pid] = 1
				WAR.LXXS[pid] = 1
				WAR.FXDS[pid] = WAR.FXDS[pid] or 0 + 5*aa
				WAR.ICE[pid] = WAR.ICE[pid] or 0 + 5*bb
				WAR.HOT[pid] = WAR.HOT[pid] or 0 + 5*cc
				WAR.LXZT[pid] = WAR.LXZT[pid] or 0 + 5*dd
				WAR.Person[WAR.CurID]["中毒点数"] = (WAR.Person[WAR.CurID]["中毒点数"] or 0) + AddPersonAttrib(pid, "中毒程度", 5*ee)
				WAR.BZ[pid]=WAR.BZ[pid] or 0 +1
		    if WAR.Person[id][CC.TXWZ2] ~= nil then
				WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+".. "五蕴炽盛"
			else
				WAR.Person[id][CC.TXWZ2] = "五蕴炽盛"
			end
			WAR.WYQS[pid]=0
	        end
			if WAR.SJTH[pid]~=nil and WAR.SJTH[pid]>0 then
			   WAR.BZ[pid]=1
			   WAR.OYFSD[pid]=100
			   if WAR.Person[id][CC.TXWZ2] ~= nil then
					WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+".. "剑意透体"
				else
					WAR.Person[id][CC.TXWZ2] = "剑意透体"
				end
				WAR.SJTH[pid]=0
			end
			if WAR.KLJTX[pid] ~= nil then
				if WAR.Person[id][CC.TXWZ2] ~= nil then
					WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+".. "昆仑剑式・龙剑截脉"
				else
					WAR.Person[id][CC.TXWZ2] = "昆仑剑式・龙剑截脉"
				end
			end
			if WAR.LYXJ[pid]~=nil and WAR.LYXJ[pid]>0 then
			   local aa=WAR.LXZT[pid] or 0 +JY.Person[pid]["受伤程度"]
			   WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", -2*aa)
			   WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", -10*aa)
			   if WAR.Person[id][CC.TXWZ2] ~= nil then
					WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+".. "千本落英"
				else
					WAR.Person[id][CC.TXWZ2] = "千本落英"
				end
				WAR.LYXJ[pid]=0
			end
			if WAR.QSLZ[pid]~=nil and WAR.QSLZ[pid]>0 then
			   local aa=JY.Person[pid]["中毒程度"]
			   WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", -3*aa)
			   WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", -10*aa)
			   if WAR.Person[id][CC.TXWZ2] ~= nil then
					WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+".. "七死爆毒"
				else
					WAR.Person[id][CC.TXWZ2] = "七死爆毒"
				end
				WAR.QSLZ[pid]=0
			end
			if WAR.YHZJ[pid]~=nil and WAR.YHZJ[pid]>0 then
			   WAR.CHXS[pid]=1
			   WAR.CHZ[pid]=50
			   WAR.ICEXS[pid]=1
			   WAR.ICE[pid]=50
			   WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", -500)
			   if WAR.Person[id][CC.TXWZ2] ~= nil then
					WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+" .. "寒毒侵脉"
				else
					WAR.Person[id][CC.TXWZ2] = "寒毒侵脉"
				end
				WAR.YHZJ[pid]=0
			end
			if WAR.HDGX[pid]~=nil and WAR.HDGX[pid]>0 then
			   WAR.HOTXS[pid]=1
			   WAR.HOT[pid]=50
			   WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", -250)
			   if WAR.Person[id][CC.TXWZ2] ~= nil then
					WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+" .. "火毒攻心"
				else
					WAR.Person[id][CC.TXWZ2] = "火毒攻心"
				end
				WAR.HDGX[pid]=0
			end
			if WAR.Person[id][CC.TXWZ2] ~= nil then
				WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+" ..str .. "加力"
			else
				WAR.Person[id][CC.TXWZ2] = str .. "加力"
			end
			WAR.Person[id][CC.TXDH] = math.fmod(WAR.NGJL, 10) + 85	
			if wglw(pid,108) or ((DT(pid,615) or DT(pid,114)) and PersonKF(pid,108)) then 
			   WAR.FXDS[pid] = nil
			   WAR.CHZ[pid] = nil
			   WAR.ICE[pid] = nil
			   WAR.HOT[pid] = nil
			   WAR.LXZT[pid] = nil
		       WAR.Person[WAR.CurID]["内伤点数"] = (WAR.Person[WAR.CurID]["内伤点数"] or 0) + AddPersonAttrib(pid, "受伤程度", -100)
		       WAR.Person[WAR.CurID]["中毒点数"] = (WAR.Person[WAR.CurID]["中毒点数"] or 0) + AddPersonAttrib(pid, "中毒程度", -100)
			end
			if wglw1(pid,18) or DT(pid,57) then
				WAR.TZPT1 = 1
			end	
			if pid == 0 and zjtype() == 1 then  
				WAR.YYHJ = WAR.YYHJ + 1
				if putong()==5 then
				WAR.YYHJ = WAR.YYHJ + 1
				end
				if WAR.YYHJ >= 10 then 
					WAR.YYHJ = 10
				end
			end			
		end
	end
    
	if pid == 0 and WAR.BMGT~= 0 and WAR.PJTX == 0 then 
	    WAR.NGJL = WAR.BMGT
	    WAR.L_SGJL = WAR.NGJL
	   	local wl = 0
		for i,v in ipairs(CC.ZGTATK) do
			if v[1] == WAR.NGJL then
				wl = math.random(v[2], v[3])
				break
			end
		end
			ng = ng + wl
		if hasTF(pid, 10) then
			ng = ng + math.modf(wl * 0.5)
		end			
		if DT(pid, 48) and JX(pid) then --铁头内功加力*1.5-2
			ng = ng + math.modf(wl * math.random(5, 10) * 0.1)
		end
		if WAR.LHZF[pid]~=nil and WAR.LHZF[pid]>0 then
            ng=0
		    if WAR.Person[id][CC.TXWZ2] ~= nil then
				WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+".. "三藐菩提"
			else
				WAR.Person[id][CC.TXWZ2] = "三藐菩提"
			end
			WAR.LHZF[pid]=0
	    end
			if WAR.FMZZ[pid]~=nil and WAR.FMZZ[pid]>0 then
		        WAR.MENG[pid]=30
		        WAR.CYSH[pid]=30
		        WAR.Person[WAR.CurID]["内伤点数"] = (WAR.Person[WAR.CurID]["内伤点数"] or 0) + AddPersonAttrib(pid, "受伤程度", 20)
		    if WAR.Person[id][CC.TXWZ2] ~= nil then
				WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+".. "业障缠身"
			else
				WAR.Person[id][CC.TXWZ2] = "业障缠身"
			end
			    WAR.FMZZ[pid]=0
	        end
			if WAR.WYQS[pid]~=nil and WAR.WYQS[pid]>0 then
		        local aa=math.random(5)
				local bb=math.random(5)
				local cc=math.random(5)
				local dd=math.random(5)
				local ee=math.random(5)
				WAR.FXXS[pid] = 1
				WAR.ICEXS[pid] = 1
				WAR.HOTXS[pid] = 1
				WAR.LXXS[pid] = 1
				WAR.FXDS[pid] = WAR.FXDS[pid] or 0 + 5*aa
				WAR.ICE[pid] = WAR.ICE[pid] or 0 + 5*bb
				WAR.HOT[pid] = WAR.HOT[pid] or 0 + 5*cc
				WAR.LXZT[pid] = WAR.LXZT[pid] or 0 + 5*dd
				WAR.Person[WAR.CurID]["中毒点数"] = (WAR.Person[WAR.CurID]["中毒点数"] or 0) + AddPersonAttrib(pid, "中毒程度", 5*ee)
				WAR.BZ[pid]=WAR.BZ[pid] or 0 +1
		    if WAR.Person[id][CC.TXWZ2] ~= nil then
				WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+".. "五蕴炽盛"
			else
				WAR.Person[id][CC.TXWZ2] = "五蕴炽盛"
			end
			WAR.WYQS[pid]=0
	        end
			if WAR.SJTH[pid]~=nil and WAR.SJTH[pid]>0 then
		        WAR.BZ[pid]=1
		        WAR.OYFSD[pid]=100
				if WAR.Person[id][CC.TXWZ2] ~= nil then
					WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+".. "剑意透体"
				else
					WAR.Person[id][CC.TXWZ2] = "剑意透体"
				end
			    WAR.SJTH[pid]=0
			end
			if WAR.LYXJ[pid]~=nil and WAR.LYXJ[pid]>0 then
			   local aa=WAR.LXZT[pid] or 0 +JY.Person[pid]["受伤程度"]
			   WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", -2*aa)
			   WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", -10*aa)
			   if WAR.Person[id][CC.TXWZ2] ~= nil then
					WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+".. "千本落英"
				else
					WAR.Person[id][CC.TXWZ2] = "千本落英"
				end
				WAR.LYXJ[pid]=0
			end
			if WAR.QSLZ[pid]~=nil and WAR.QSLZ[pid]>0 then
			   local aa=JY.Person[pid]["中毒程度"]
			   WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", -3*aa)
			   WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", -10*aa)
			   if WAR.Person[id][CC.TXWZ2] ~= nil then
					WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+".. "七死爆毒"
				else
					WAR.Person[id][CC.TXWZ2] = "七死爆毒"
				end
				WAR.QSLZ[pid]=0
			end
			if WAR.YHZJ[pid]~=nil and WAR.YHZJ[pid]>0 then
			   WAR.CHXS[pid]=1
			   WAR.CHZ[pid]=50
			   WAR.ICEXS[pid]=1
			   WAR.ICE[pid]=50
			   WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", -500)
			   if WAR.Person[id][CC.TXWZ2] ~= nil then
					WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+" .. "寒毒侵脉"
				else
					WAR.Person[id][CC.TXWZ2] = "寒毒侵脉"
				end
				WAR.YHZJ[pid]=0
			end
			if WAR.HDGX[pid]~=nil and WAR.HDGX[pid]>0 then
			   WAR.HOTXS[pid]=1
			   WAR.HOT[pid]=50
			   WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", -250)
			   if WAR.Person[id][CC.TXWZ2] ~= nil then
					WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+" .. "火毒攻心"
				else
					WAR.Person[id][CC.TXWZ2] = "火毒攻心"
				end
				WAR.HDGX[pid]=0
			end
			if wglw1(pid,18) or DT(pid,57) then
				WAR.TZPT1 = 1
			end	
	   		local str = JY.Wugong[WAR.NGJL]["名称"]
	   			if WAR.Person[id][CC.TXWZ2] ~= nil then
				WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+" ..str .. "加力"
			else
				WAR.Person[id][CC.TXWZ2] = str .. "加力"
			end
			WAR.Person[id][CC.TXDH] = math.fmod(WAR.NGJL, 10) + 85
			if pid == 0 and zjtype() == 1 then 
				WAR.YYHJ = WAR.YYHJ + 1
				if putong()==5 then
					WAR.YYHJ = WAR.YYHJ + 1
				end
				if WAR.YYHJ >= 10 then 
					WAR.YYHJ = 10
				 end
			end
	end
    
	if LYR(pid) then --林月如怒气100
		if WAR.LQZ[pid] ~= nil and WAR.LQZ[pid] >= 100 then
			if WAR.Person[id][CC.TXWZ1] == nil then
				WAR.Person[id][CC.TXWZ1] = "红颜如月有圆缺"
			else
				WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+".."红颜如月有圆缺"
			end		
		end
	end
	
	--冰魄银针领悟显示
	if (wglw1(pid,170) or DT(pid,161)) and JLSD(10,40,pid) then
		if WAR.Person[id][CC.TXWZ2] ~= nil then
			 WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .."+".."爱火已成霜"
		else
			 WAR.Person[id][CC.TXWZ2] = "爱火已成霜"
		end
	end	
	if (wglw1(pid,170) or DT(pid,161)) and JLSD(10,40,pid) then
		if WAR.Person[id][CC.TXWZ2] ~= nil then
		 WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .."+".."寒心复盈怨"
		else
			 WAR.Person[id][CC.TXWZ2] = "寒心复盈怨"
		end
	end
	if (wglw1(pid,170) or DT(pid,161)) and JLSD(10,40,pid) then
		if WAR.Person[id][CC.TXWZ2] ~= nil then
		 WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .."+".."虚情妄毒誓"
		else
			 WAR.Person[id][CC.TXWZ2] = "虚情妄毒誓"
		end
	end	
	if (wglw1(pid,170) or DT(pid,161)) and JLSD(10,40,pid) then
		if WAR.Person[id][CC.TXWZ2] ~= nil then
			 WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .."+".."意冷恨相逢"
		else
			 WAR.Person[id][CC.TXWZ2] = "意冷恨相逢"
		end
	end
	
	--灭剑绝剑效果显示
	if MPPD(pid) == 17 then--灭剑绝剑
		if GX(pid) and JX(pid) and JLSD(10,60,pid)then
			WAR.L_MJJF = 3
			WAR.L_MJJF = 4
			if WAR.L_MJJF == 3 then
				if WAR.Person[id][CC.TXWZ3] ~= nil then
					WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .."+".."倚天・灭剑"
				else
					WAR.Person[id][CC.TXWZ3] = "倚天・灭剑"
				end
			end
			if WAR.L_MJJF == 4 then
				if WAR.Person[id][CC.TXWZ3] ~= nil then
					WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .."+".."倚天・绝剑"
				else
					WAR.Person[id][CC.TXWZ3] = "倚天・绝剑"
				end
			end
		elseif wugong == 41 and PersonGT(pid,153) then
			WAR.L_MJJF = 3
			WAR.L_MJJF = 4
			if WAR.L_MJJF == 3 then
				if WAR.Person[id][CC.TXWZ3] ~= nil then
					WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .."+".."倚天・灭剑"
				else
					WAR.Person[id][CC.TXWZ3] = "倚天・灭剑"
				end	
			end
			if WAR.L_MJJF == 4 then
				if WAR.Person[id][CC.TXWZ3] ~= nil then
					WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .."+".."倚天・绝剑"
				else
					WAR.Person[id][CC.TXWZ3] = "倚天・绝剑"
				end
			end
		elseif yongjian(wugong) and PersonGT(pid,153) then
			if JLSD(10,60,pid) then
				WAR.L_MJJF = 1
				if WAR.L_MJJF == 1 then
					if WAR.Person[id][CC.TXWZ3] ~= nil then
						WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .."+".."灭剑"
					else
						WAR.Person[id][CC.TXWZ3] = "灭剑"
					end
				end
			else 
				WAR.L_MJJF = 2
				if WAR.L_MJJF == 2 then
					if WAR.Person[id][CC.TXWZ3] ~= nil then
						WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .."+".."绝剑"
					else
						WAR.Person[id][CC.TXWZ3] = "绝剑"
					end
				end
			end
		end
	end
	--临济领悟
	if wglw(pid,153) and PersonGT(pid,153) then
		if WAR.BJ == 1 and JLSD(10,70,pid) then
			WAR.TDZX1 = 1
			if WAR.TDZX1 == 1 then
				if WAR.Person[id][CC.TXWZ1] ~= nil then
					WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .."+".."天地之心庄"
				else
					WAR.Person[id][CC.TXWZ1] = "天地之心庄"
				end
			end
		end
		if WAR.BJ == 1 and WAR.LHFY1[pid] ~= nil then
			WAR.LHFY = 1
			if WAR.LHFY == 1 then
				if WAR.Person[id][CC.TXWZ2] ~= nil then
					WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .."+".."龙鹤风云庄"
				else
					WAR.Person[id][CC.TXWZ2] = "龙鹤风云庄"
				end
			end
		end
		if WAR.BJ == 1 then
			WAR.DXYM = 1
			if WAR.DXYM == 1 then
				if WAR.Person[id][CC.TXWZ3] ~= nil then
					WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .."+".."大小幽明庄"
				else
					WAR.Person[id][CC.TXWZ3] = "大小幽明庄"
				end
			end
		end
	end	
		
	--临济领悟战意技
	if wglw(pid,153) and PersonGT(pid,153) and PersonKF(pid,103) and WAR.BJ == 1 then
		if WAR.SPIRIT[pid] >= 120 then
			WAR.LJZYJ1 = 1
			if WAR.LJZYJ1 == 1 then
				WAR.Person[id][CC.TXWZ3] = "四智如来・成所作智"
			end
		end
		if WAR.SPIRIT[pid] >= 130 then
			WAR.LJZYJ2 = 1
			if WAR.LJZYJ2 == 1 then
				WAR.Person[id][CC.TXWZ2] = "四智如来・妙观察智"
			end
		end
		if WAR.SPIRIT[pid] >= 140 then
			WAR.LJZYJ3 = 1
			if WAR.LJZYJ3 == 1 then
				WAR.Person[id][CC.TXWZ1] = "四智如来・平等性智"
			end
		end
		if WAR.SPIRIT[pid] >= 140 and WAR.LQZ[pid] == 100 and JY.Person[pid]["生命"] < (JY.Person[pid]["生命最大值"]/2) then
			WAR.LJZYJ4 = 1
			DIYdisplay("持道入佛・四智如来・大圆镜智")
		end
	end
	
	--木婉清觉醒战意技
	if DT(pid,582) and JX(pid) then
	  if WAR.SPIRIT[pid] >= 200 then	  
	    WAR.MWQ4 = 1
		WAR.Person[WAR.CurID][CC.TXWZ3] = "摩诃迦罗"
	  elseif WAR.SPIRIT[pid] >= 160 then
	    WAR.MWQ3 = 1	
		WAR.Person[WAR.CurID][CC.TXWZ3] = "第三目.开眼"  
	  elseif WAR.SPIRIT[pid] >= 140 then
	    WAR.MWQ2 = 1
		WAR.Person[WAR.CurID][CC.TXWZ3] = "恶灭之雷"  
	  elseif WAR.SPIRIT[pid] >= 120 then
	    WAR.MWQ1 = 1
		WAR.Person[WAR.CurID][CC.TXWZ3] = "湿婆降临"
	  end	  
	end
		
	if MPPD(pid) == 18 and PersonGT(pid,189) and MPDJ(pid) >= 3 then--崆峒分堂
		if sixi(pid,1) > (sixi(pid,4) - 1) and sixi(pid,1) > (sixi(pid,5) - 1)  then
			WAR.KTFT = 1 --拳堂
		elseif sixi(pid,4) > (sixi(pid,1) - 1) and sixi(pid,4) > (sixi(pid,5) - 1) then
			WAR.KTFT = 2  --特堂
		elseif sixi(pid,5) > (sixi(pid,4) - 1) and sixi(pid,5) > (sixi(pid,1) - 1) then
			WAR.KTFT = 3  --暗堂
		end	
	end
	
	if wugong == 42 and (DT(pid, 601) or DT(pid, 59) or wglw1(pid,42)) then
		if JLSD(10, 40, pid) then
			WAR.YNSX = 1
			if WAR.Person[WAR.CurID][CC.TXWZ3] ~= nil then
				WAR.Person[WAR.CurID][CC.TXWZ3] = WAR.Person[WAR.CurID][CC.TXWZ3].."+".."玉女素心・浪迹天涯"
			else
				WAR.Person[WAR.CurID][CC.TXWZ3] = "玉女素心・浪迹天涯"
			end
		end
		if JLSD(10, 40, pid) then
			WAR.YNSX = 2
			if WAR.Person[WAR.CurID][CC.TXWZ3] ~= nil then
      	    WAR.Person[WAR.CurID][CC.TXWZ3] = WAR.Person[WAR.CurID][CC.TXWZ3].."+".."玉女素心・花前月下"
			else
				WAR.Person[WAR.CurID][CC.TXWZ3] = "玉女素心・花前月下"
			end
		end
		if JLSD(10, 40, pid) then
			WAR.YNSX = 3
			if WAR.Person[WAR.CurID][CC.TXWZ3] ~= nil then
				WAR.Person[WAR.CurID][CC.TXWZ3] = WAR.Person[WAR.CurID][CC.TXWZ3].."+".."玉女素心・冷月窥人"
			else
				WAR.Person[WAR.CurID][CC.TXWZ3] = "玉女素心・冷月窥人"
			end	
		end
		if JLSD(10, 40, pid) then
			WAR.YNSX = 4
			if WAR.Person[WAR.CurID][CC.TXWZ2] ~= nil then
				WAR.Person[WAR.CurID][CC.TXWZ2] = WAR.Person[WAR.CurID][CC.TXWZ2].."+".."玉女素心・清饮小酌"
			else
				WAR.Person[WAR.CurID][CC.TXWZ2] = "玉女素心・清饮小酌"
			end
		end
		if JLSD(10, 40, pid) then
			WAR.YNSX = 5
			if WAR.Person[WAR.CurID][CC.TXWZ2] ~= nil then
				WAR.Person[WAR.CurID][CC.TXWZ2] = WAR.Person[WAR.CurID][CC.TXWZ2].."+".."玉女素心・小园艺菊"
			else
				WAR.Person[WAR.CurID][CC.TXWZ2] = "玉女素心・小园艺菊"
			end	
		end
		if JLSD(10, 40, pid) then
			WAR.YNSX = 6
			if WAR.Person[WAR.CurID][CC.TXWZ1] ~= nil then
				WAR.Person[WAR.CurID][CC.TXWZ1] = WAR.Person[WAR.CurID][CC.TXWZ1].."+".."玉女素心・举案齐眉"
			else
				WAR.Person[WAR.CurID][CC.TXWZ1] = "玉女素心・举案齐眉"
			end
		end
	end
	
	if PersonKF(pid,203) then --怒海剑涛
		local aa = fightnum or 0
		local bb = math.modf(sixi(pid,2)/3)
		if bb > 70 then bb = 70 end
		if PersonGT(pid,203) then
			if WAR.ACT == 1 then
				fightnum = fightnum + 1
			end
			--[[if fightnum > 6 then
				fightnum = 6
				--WAR.ACT = 20
			end]]
			ng = math.modf((ng * aa)/2)
			if WAR.ACT == WAR.TXY and JLSD(10,bb,pid)then
				WAR.NHJT = 1
				WAR.Person[id][CC.TXWZ3] = "势若怒涛兮泰若山"
			end	
		else
			if JLSD(10,bb,pid) then
				if WAR.ACT == 1 then
					fightnum = fightnum + 1
				end	
				--[[if fightnum > 6 then
				fightnum = 6
				--WAR.ACT = 20
				end]]
				ng = math.modf((ng * aa)/2)
			end	
		end
	end	
	--怒海剑涛领悟
	if (wglw(pid,203) or DT(pid,592)) and PersonGT(pid,203) and yongjian(wugong) then --
		WAR.NTLW[pid] = (WAR.NTLW[pid] or 0) + 20
		for i = 0, WAR.PersonNum - 1 do
			if WAR.Person[i]["死亡"] == false and WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then				
				local tmppid = WAR.Person[i]["人物编号"]
				WAR.NTLW[tmppid]=(WAR.NTLW[tmppid] or 0) + 10
			end
		end
	end	
			
	if (wglw(pid,203) or DT(pid,592)) and PersonGT(pid,203) and yongjian(wugong) then--
		if WAR.ACT == 1 then
			if DT(pid,592) then
				fightnum = fightnum + 3
			else	
				fightnum = fightnum + 2
				--[[if fightnum > 6 then
					fightnum = 6
					--WAR.ACT = 20
				end]]
			end	
		end	
		if WAR.NTLW[pid] ~= nil and WAR.NTLW[pid] > 1 and JLSD(10,20+(WAR.NTLW[pid] or 0),pid) then
			WAR.NTLW[pid] = math.modf(WAR.NTLW[pid]/2)
			for i = 0, WAR.PersonNum - 1 do
				if WAR.Person[i]["死亡"] == false and WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then				
					local tmppid = WAR.Person[i]["人物编号"]
					WAR.MENG[tmppid]=WAR.MENG[tmppid] or 0 + math.modf(5+(WAR.NTLW[tmppid] or 0))
					WAR.SPIRIT[tmppid]=WAR.SPIRIT[tmppid] or 0 - 3
				end
			end
			if WAR.Person[WAR.CurID][CC.TXWZ1] ~= nil then
				WAR.Person[WAR.CurID][CC.TXWZ1] = WAR.Person[WAR.CurID][CC.TXWZ1].."+".."暗潮剑势"
			else
				WAR.Person[WAR.CurID][CC.TXWZ1] = "暗潮剑势"
			end
		end
		if  WAR.LQZ[pid] ~= nil and WAR.LQZ[pid] >= 100 and WAR.NTLW[pid] ~= nil and WAR.NTLW[pid] > 1 then
			for i = 0, WAR.PersonNum - 1 do
				if WAR.Person[i]["死亡"] == false and WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then				
					local tmppid = WAR.Person[i]["人物编号"]
					WAR.Person[i]["真伤点数"] = (WAR.Person[i]["真伤点数"] or 0) - (WAR.NTLW[pid] + WAR.NTLW[tmppid]) 
					WAR.Person[i]["体力点数"] = (WAR.Person[i]["体力点数"] or 0) - ((WAR.NTLW[pid] + WAR.NTLW[tmppid])/10)
					JY.Person[tmppid]["生命"]=(JY.Person[tmppid]["生命"] or 0) - (WAR.NTLW[pid] + WAR.NTLW[tmppid])
					JY.Person[tmppid]["体力"]= (JY.Person[tmppid]["体力"] or 0) - ((WAR.NTLW[pid] + WAR.NTLW[tmppid])/10)
					WAR.XNXS[WAR.Person[i]["人物编号"]] = 1
				end
				WAR.NTLW[WAR.Person[i]["人物编号"]] = 0
			end
			if WAR.Person[WAR.CurID][CC.TXWZ1] ~= nil then
				WAR.Person[WAR.CurID][CC.TXWZ1] = WAR.Person[WAR.CurID][CC.TXWZ1].."+".."怒剑狂涛"
			else
				WAR.Person[WAR.CurID][CC.TXWZ1] = "怒剑狂涛"
			end
		end	
	end

	if (wglw(pid,203) or DT(pid,592)) and PersonGT(pid,203) and WAR.NTLW3 == 1 then
		for i = 0, WAR.PersonNum - 1 do
			if WAR.Person[i]["死亡"] == false and WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then				
				local tmppid = WAR.Person[i]["人物编号"]
				WAR.SJTH[tmppid]=WAR.SJTH[tmppid] or 0 + 1
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd - 250
			end
		end
		if not DT(pid,592) then
			if fightnum > 3 then
				fightnum = 3
			end
		end	
	end	
	--怒海剑涛领悟结束
	--吸星、北冥显示修正
	if (wglw(pid,88) or (DT(pid,26) or DT(pid,35) or DT(pid,617))) and JLSD(10,40,pid) then--吸星
		WAR.XXZD = 1
		if WAR.Person[WAR.CurID][CC.TXWZ1] == nil then	
			WAR.Person[WAR.CurID][CC.TXWZ1] = "吸星真谛・导气归元"
	    else
			WAR.Person[WAR.CurID][CC.TXWZ1] = WAR.Person[WAR.CurID][CC.TXWZ1].."+吸星真谛・导气归元"
	    end	
	end	
	if (wglw(pid,85) or (DT(pid,116) or DT(pid,118) or DT(pid,618))) and JLSD(10,40,pid) then--北冥
		WAR.BMMY = 1
		if WAR.Person[WAR.CurID][CC.TXWZ1] == nil then
			WAR.Person[WAR.CurID][CC.TXWZ1] = "北冥秘意・百川归海"
	    else
			WAR.Person[WAR.CurID][CC.TXWZ1] = WAR.Person[WAR.CurID][CC.TXWZ1].."+北冥秘意・百川归海"
	    end
	end
	--金蛇剑领悟
	if (wglw1(pid,40) or (DT(pid,91)and JX(pid)) or DT(pid,54)) and wugong == 40 and WAR.JSHL[pid] ~= nil then
		local aa = WAR.JSHL[pid]
		if JLSD(0,10+aa,pid) then
			DHdisplay(770, 783, "金蛇秘传・真・金蛇化龙")
			for j = 0, WAR.PersonNum - 1 do
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then				
					local tmppid = WAR.Person[j]["人物编号"]
					local aa = WAR.LXZT[tmppid] or 0
					local bb = JY.Person[tmppid]["中毒程度"] or 0
					WAR.BPD[tmppid] = (WAR.BPD[tmppid] or 0) + 20
					WAR.Person[j]["生命点数"] = (WAR.Person[j]["生命点数"] or 0) + AddPersonAttrib(tmppid,"生命",-(100+(aa+bb)))
					WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
				end
			end
			WAR.JSHL[pid] = nil
		end
	end
	
	--杨家枪法领悟
	if (wglw1(pid,68) and wugong == 68) or (T9ZY(pid) and wugong == 112 and wglw1(pid,68)) then
		local str = ""
		if WAR.ACT == 1 then
			WAR.YQLW = 1
			for j = 0, WAR.PersonNum-1 do 
				local df = WAR.Person[j]["人物编号"] 
				local offset1 = math.abs(WAR.Person[j]["坐标X"] - WAR.Person[WAR.CurID]["坐标X"]) 
				local offset2 = math.abs(WAR.Person[j]["坐标Y"] - WAR.Person[WAR.CurID]["坐标Y"])	
				if WAR.Person[j]["死亡"] == false and offset1 <= 8 and offset2 <= 8 and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				   WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(df, "生命", -(math.random(50,100)))
				   WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
				end
			end
			str = "三十击・无定击"
			if WAR.Person[WAR.CurID][CC.TXWZ1] ~= nil then
				WAR.Person[WAR.CurID][CC.TXWZ1] = WAR.Person[WAR.CurID][CC.TXWZ1].."+".."燎原百击・"..str
			else
				WAR.Person[WAR.CurID][CC.TXWZ1] = "燎原百击・"..str
			end
		else
			if JLSD(10,60,pid) then
				WAR.YQLW = math.random(2,3)
				if WAR.YQLW == 2 then
					str = "三十击・雨暴风狂"
				elseif 	WAR.YQLW == 3 then
					str = "三十击・叠浪千重"
				end
				if WAR.Person[WAR.CurID][CC.TXWZ1] ~= nil then
					WAR.Person[WAR.CurID][CC.TXWZ1] = WAR.Person[WAR.CurID][CC.TXWZ1].."+".."燎原百击・"..str
				else
					WAR.Person[WAR.CurID][CC.TXWZ1] = "燎原百击・"..str
				end
			end	
		end
		if WAR.LQZ[pid] ~= nil and WAR.LQZ[pid] >= 100 then
			WAR.WS = 1
			if WAR.ACT == 1 then
				DHdisplay(150,171,"燎原百击・三十击・威凌天下")
				CleanWarMap(4, 0)
				for i = 0, WAR.PersonNum - 1 do
					if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
						SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
					end
				end		
				ng = ng + 1250
			end	
			WAR.YQHT[pid] = 1
		end
	end
		
	if ((wglw1(pid,68) and wugong == 68) or (T9ZY(pid) and wugong == 112 and wglw1(pid,68))) and JLSD(10,60,pid) then
		local str = ""
		WAR.YQLW1 = math.random(3)
		if WAR.YQLW1 == 1 then	
			str = "五十势・斜挑式"
		elseif 	WAR.YQLW1 == 2 then	
			str = "五十势・横扫式"
		elseif WAR.YQLW1 == 3 then	
			str = "五十势・格勾式"
		end	
		if WAR.Person[WAR.CurID][CC.TXWZ2] ~= nil then
			WAR.Person[WAR.CurID][CC.TXWZ2] = WAR.Person[WAR.CurID][CC.TXWZ2].."+".."燎原百击・"..str
		else
			WAR.Person[WAR.CurID][CC.TXWZ2] = "燎原百击・"..str
		end
	end
	
	if (wglw1(pid,48) or (DT(pid,36) and PersonKF(pid,48) and JX(pid))) and wugong == 48 then--辟邪领悟基本招式、伤害依照敌我速度差、敌方流血值以及我方战意增加。
		local str = ""
		local str1 = ""
		WAR.BXJF = math.random(5)
		if WAR.BXJF == 1 then	
			str = "截风・飞花穿柳"--+10体，按敌人流血回覆生命，并增加敌方流血
		elseif WAR.BXJF == 2 then	
			str = "扫霆・涤荡群魔"--200全屏杀气，15时序儒君子气，根据攻击敌人增加该次攻击伤害（上限25％），回复内力5％内力
		elseif WAR.BXJF == 3 then	
			str = "刺鸿・直捣黄龙"--自身加5战意，根据打到的敌人数增加怒气，被攻击的敌方怒气清零、战意-5并10时序集气紊乱
		elseif WAR.BXJF == 4 then	
			str = "灵怒・杀气沸腾"--对敌方附加千本落英，并依照己方怒气附加真伤，若自己怒气爆发时，则依照敌方当前集气位置附加真伤（3倍速和明镜止水记得写）
		elseif WAR.BXJF == 5 then	
			str = "挂峰・万众伏诛"--敌人缠足、眩晕、自身神行状态，回合结束后可再次移动。
		end	
		if WAR.Person[WAR.CurID][CC.TXWZ2] ~= nil then
			WAR.Person[WAR.CurID][CC.TXWZ2] = WAR.Person[WAR.CurID][CC.TXWZ2].."+"..str
		else
			WAR.Person[WAR.CurID][CC.TXWZ2] = str
		end
		if JLSD(10,30,pid) or (WAR.LQZ[pid] ~= nil and WAR.LQZ[pid] >= 100 and JLSD(10,50,pid)) then
			WAR.BXJF1 = 1 -- 特殊辟邪1：点宵
			str1 = "点宵・群邪辟易"
		end
		if WAR.SPIRIT[pid] ~= nil and WAR.SPIRIT[pid] >= 100 and WAR.LQZ[pid] ~= nil and WAR.LQZ[pid] >= 100 and WAR.ACT == 1 then
			WAR.BXJF2 = 1--特殊辟邪2：穿星
			str1 = "穿星・佛剑花开"
		end	
		if WAR.SPIRIT[pid] ~= nil and JLSD(10,40,pid) and WAR.SPIRIT[pid] >= 120 then
			if WAR.SPIRIT[pid] >= 140 then
				WAR.BXJF3 = 3
			elseif WAR.SPIRIT[pid] >= 130 then
				WAR.BXJF3 = 2
			elseif WAR.SPIRIT[pid] >= 120 then
				WAR.BXJF3 = 1
			end
			str1 = "辟邪终式・鬼神皆斩"
		end	
		if WAR.Person[WAR.CurID][CC.TXWZ1] ~= nil then
			WAR.Person[WAR.CurID][CC.TXWZ1] = WAR.Person[WAR.CurID][CC.TXWZ1].."+"..str1
		else
			WAR.Person[WAR.CurID][CC.TXWZ1] = str1
		end	
	end	 
	
	
	if wglw2(pid,194) and PersonKF(pid,194) and WAR.HIDE[pid] ~= nil and JLSD(10,60,pid) then
		WAR.AYMZ = 1
		if WAR.Person[WAR.CurID][CC.TXWZ2] ~= nil then
			WAR.Person[WAR.CurID][CC.TXWZ2] = WAR.Person[WAR.CurID][CC.TXWZ2].."+".."影武乱世"
		else
			WAR.Person[WAR.CurID][CC.TXWZ2] = "影武乱世"
		end
	end	
	
	
	--琴棋书画60%	1-画冰封 2-书封穴 3-棋杀体 4-琴杀怒
	if MPPD(pid) == 12 then
		if PersonKF(pid,196) and not yongdao(wugong) and (PersonKFJ(pid, 125) or PersonKFJ(pid, 71) or PersonKFJ(pid, 72) or PersonKFJ(pid, 73)) then
			if JLSD(10,70,pid) then
				WAR.QQSH = 1
				WAR.QQSH1 = 1
				ng = ng + 1500
			else
				WAR.QQSH = 1
				ng = ng +1000
			end
			if JLSD(10,70,pid) then
				WAR.QQSH = 2
				WAR.QQSH1 = 2
				ng = ng + 1500
			else
				WAR.QQSH = 2
				ng = ng + 1000
			end	
			if JLSD(10,70,pid) then
				WAR.QQSH = 3
				WAR.QQSH1 = 3
				ng = ng + 1500
			else	
				WAR.QQSH = 3
				ng = ng + 1000
			end
			if JLSD(10,70,pid) then
				WAR.QQSH = 4
				WAR.QQSH1 = 4
				ng = ng + 1500
				WAR.GTNUQI = WAR.GTNUQI + math.random(5, 10)
			else
				WAR.QQSH = 4
				ng = ng + 1000
				WAR.GTNUQI = WAR.GTNUQI + math.random(5, 10)
			end
		elseif (DT(pid, 31) or DT(pid, 32) or DT(pid, 33) or DT(pid, 34)) and JLSD(10, 45, pid) then
				ng = ng + 500
			if wugong == 125 then
				WAR.QQSH = 1
				ng = ng + 800
			elseif wugong == 71 then
				WAR.QQSH = 2
				ng = ng + 800
			elseif wugong == 72 then
				WAR.QQSH = 3
				ng = ng + 800
			elseif wugong == 73 then
				WAR.QQSH = 4
				ng = ng + 800
				WAR.GTNUQI = WAR.GTNUQI + math.random(5, 10)
				if DT(pid, 34) then
					WAR.GTNUQI = WAR.GTNUQI + math.random(5, 10)
				end
			end
		elseif (PersonKFJ(pid, 125) and PersonKFJ(pid, 71) and PersonKFJ(pid, 72) and PersonKFJ(pid, 73))
				and (wugong == 125 or (wugong >= 71 and wugong <= 74)) and JLSD(10, 80, pid) then
			if wugong == 125 then
				WAR.QQSH = 1
				ng = ng + 800
			elseif wugong == 71 then
				WAR.QQSH = 2
				ng = ng + 800
			elseif wugong == 72 then
				WAR.QQSH = 3
				ng = ng + 800
			elseif wugong == 73 then
				WAR.QQSH = 4
				ng = ng + 800
				WAR.GTNUQI = WAR.GTNUQI + math.random(5, 10)
		
			end
		end
	end	
	
	if MPPD(pid) == 12 then
		local str = ""
		if WAR.QQSH1 > 0 then
			if WAR.QQSH1 == 1 then
				str = "四绝艺・江山艳"
			end
			if WAR.QQSH1 == 2 then
				str = "四绝艺・颜柳风"
			end
			if WAR.QQSH1 == 3 then
				str = "四绝艺・奕天下"
			end
			if WAR.QQSH1 == 4 then
				str = "四绝艺・叹三弦"
			end
		else
			if WAR.QQSH == 1 then
				str = "琴棋书画・江山如画"
			end
			if WAR.QQSH == 2 then
				str = "琴棋书画・秉笔直书"
			end
			if WAR.QQSH == 3 then
				str = "琴棋书画・星罗棋布"
			end
			if WAR.QQSH == 4 then
				str = "琴棋书画・菩提清心"
			end
		end
		if WAR.Person[WAR.CurID][CC.TXWZ3] ~= nil then
			WAR.Person[WAR.CurID][CC.TXWZ3] = WAR.Person[WAR.CurID][CC.TXWZ3] .. "+"..str
		else
			WAR.Person[WAR.CurID][CC.TXWZ3] = str
		end
	end
	
	if PersonKF(pid,199) and JLSD(10,40,pid) and MPPD(pid) == 15 then
		for j = 0, WAR.PersonNum - 1 do
			local aa = WAR.Person[j]
			local bb = 0
			if aa["我方"] == false and aa["死亡"] == false and j ~= WAR.CurID then
				bb = bb + 1
				if bb < 4 then bb = 4 end
				WAR.SPIRIT[aa["人物编号"]] = WAR.SPIRIT[aa["人物编号"]] - math.floor(bb/3)
			end
		end
		if WAR.Person[id][CC.TXWZ3] ~= nil then
			WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+".."帝者威"
		else
			WAR.Person[id][CC.TXWZ3] = "帝者威"
		end
	end
	
	if wglw2(pid,199) and JLSD(10,45,pid) and WAR.ACT == 1 and MPPD(pid) == 15 then
		for j = 0, WAR.PersonNum - 1 do
			local aa = WAR.Person[j]
			if aa["我方"] == false and aa["死亡"] == false and j ~= WAR.CurID then
				WAR.BZ[aa["人物编号"]] = 1
			end
		end
		if WAR.Person[id][CC.TXWZ3] ~= nil then
			WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+".."天恩浩荡"
		else
			WAR.Person[id][CC.TXWZ3] = "天恩浩荡"
		end
	end	
	
    if T6XQS(pid) and juexing() > 1 then --萧秋水2次觉醒后内功加力的时候出忘情天书
		if WAR.NGJL > 0 then
			WAR.XQS = math.random(1, 3)
			local WZTS = {"忘情天书・水逝","忘情天书・火延","忘情天书・金断","忘情天书・木顽","忘情天书・土掩"}
			WAR.Person[id][CC.TXWZ3] = WZTS[WAR.XQS];
			if WAR.XQS == 2 then --萧秋水火延杀气+3000
				ng = ng + 60*sixi(pid,2)+1000
				if JLSD(20,40+math.modf(sixi(pid,2)/15),pid) then
				    WAR.XQS=6
				    WAR.Person[id][CC.TXWZ3] = "忘情天书・火延・城郭炎上"
				    WAR.Person[id][CC.TXDH] = 108
				end
			end
			if WAR.XQS == 3 then
			    if JLSD(20,40+math.modf(sixi(pid,2)/15),pid) then
			        WAR.XQS=7
			        WAR.Person[id][CC.TXWZ3] = "忘情天书・金断・金石可镂"
			        WAR.Person[id][CC.TXDH] = 158
			    end
			end
			if WAR.XQS==1 then
			    if JLSD(20,40+math.modf(sixi(pid,2)/15),pid) then
		            WAR.XQS=8
			        WAR.Person[id][CC.TXWZ3] = "忘情天书・水逝・抽刀断水"
			        WAR.Person[id][CC.TXDH] = 163
		        end
			end	
		end
	end

    if T9ZY(pid) and juexing() >= 2 and wugong==112 then --赵云3连击  
  	    WAR.ZYQT = math.random(7)
	    if WAR.ZYQT<1 or WAR.ZYQT>7 then
		    WAR.ZYQT=1
	    end
        local WZTS = {"・单骑破阵","・枪出如龙","・子龙朱雀","・日月光华","・端坐霜天","・横扫千军","・化蛟覆海"}
	    WAR.Person[id][CC.TXWZ1] = "七探蛇盘枪"..WZTS[WAR.ZYQT];
	    if  WAR.ZYQT==6 then ---战意组建14-伤心小箭
		    local aa=50
		    for j = 0, WAR.PersonNum - 1 do
		        if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
		            local bb=JY.Person[WAR.Person[j]["人物编号"]]["受伤程度"]+JY.Person[WAR.Person[j]["人物编号"]]["中毒程度"]
			        local cc=math.modf(aa*bb/150)
			        WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"],"生命",-cc)
					--JY.Person[WAR.Person[j]["人物编号"]]["生命"] = JY.Person[WAR.Person[j]["人物编号"]]["生命"] - cc
			        if JY.Person[WAR.Person[j]["人物编号"]]["生命"] <= 0 then
				        JY.Person[WAR.Person[j]["人物编号"]]["生命"] = 1
			        end
					WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
		        end
		    end	
	    end
    end
	
    if WAR.SJRH == 1 then
		ng = ng + 3000
	end 		
	
    if wglw1(pid,32) and yongjian(wugong) then
       ng = ng + (5*sixi(pid,2)+1000)*WAR.WYLW3
    end	

    if (wglw1(pid,77) or ((DT(pid,605) or DT(pid,627))and JX(pid))) and yongdao(wugong) then
       ng = ng + (5*sixi(pid,3)+1000)
    end 
	
	if XYL(pid) and yongjian(wugong) then --豸苗：谢云流用剑附加大杀气
	    ng = ng + 2000
	    WAR.Person[id][CC.TXDH] = 158
		local str = "剑气纵横"
		if JY.Person[pid]["声望"] == 180 and juexing() > 1 then 
		   str = "太虚剑气"
		end
		if WAR.Person[id][CC.TXWZ3] == nil then
			WAR.Person[id][CC.TXWZ3] = str
		else
			WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+" ..str
		end	
	end
	--谢无悠
	if jtyl(pid) and yongjian(wugong) then
        WAR.Person[id][CC.TXDH] = 158
    end
	--降龙特效
	--[[if DT(pid,50) and wugong == 26 then
        WAR.Person[id][CC.TXDH] = 140
    end]]
	  
	if ((jtyl(pid) or SJL(pid)) or (MPPD(pid) == 11 and JLSD(0,50,pid))) and wugong == 131 and not XYL(pid) then ----豸苗：森九岚
		WAR.SJL = math.random(1, 5)
		local WZTS = {"斩流剑奥义・无量劫","斩流剑奥义・一之太刀","斩流剑奥义・居合","斩流剑奥义・聚","斩流剑奥义・海上生明月"}
	    if WAR.Person[id][CC.TXWZ2] == nil then
			WAR.Person[id][CC.TXWZ2] = WZTS[WAR.SJL];
		else
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+" ..WZTS[WAR.SJL]
		end
		if WAR.SJL == 1 then 
			ng = ng + 1500
		end
	end
	
	if XYL(pid) and yongjian(wugong) and JY.Person[pid]["声望"] == 180 and juexing() > 1 then ----豸苗：谢云流1-25-
		WAR.XYLCZ = math.random(1, 4)
		if WAR.SHTY >= 5 then 
			WAR.XYLCZ = 4
		end
		if WAR.XYLCZ == 4 then 
			ng = ng + 1000
		end
	end
	if jtyl(pid) and wugong == 131 then--谢无悠
	    WAR.JTYL = math.random(1, 9)
		if JY.Person[pid]["生命"] < math.modf(JY.Person[pid]["生命最大值"]/2) and WAR.CMCF[pid] == nil then
		   WAR.JTYL = 4
		end   
		if ZYJ(pid) then 
		   WAR.JTYL = 9
		end   
	    local JTYL = "九天一流・"
		local WZTS = {"一念无量","现世执妄","悟入幻想","草木成佛","天人五衰","六根清净","众生无情","生死有命","半身大悟"}
	--	if WAR.Person[id][CC.TXWZ3] == nil then
			WAR.Person[id][CC.TXWZ3] = JTYL..WZTS[WAR.JTYL];
	--	else
	--		WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+" ..JTYL..WZTS[WAR.JTYL]
	--	end
		if WAR.JTYL == 3 or WAR.JTYL == 9 then 
			WAR.WRHX[pid] = 25
		end
		if WAR.JTYL == 4 or WAR.JTYL == 9 then 
			WAR.CMCF[pid] = 25
		end
		if WAR.ACT == 1 then 
			WAR.JTYLwav = 1
		end
	end
	if XYL(pid) and yongjian(wugong) and juexing() > 0 then ----豸苗：谢云流1-25-
		WAR.XYLCZ1 = math.random(1, 4)
		local WZTS = {"斩流剑奥义・一之太刀","斩流剑奥义・居合","斩流剑奥义・天人五衰","斩流剑奥义・一念无量劫"}
		if WAR.Person[id][CC.TXWZ2] == nil then
			WAR.Person[id][CC.TXWZ2] = WZTS[WAR.XYLCZ1];
		else
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+" ..WZTS[WAR.XYLCZ1]
		end
		if WAR.XYLCZ1 == 4 then 
			ng = ng + 1000
		end
	end
	
	WAR.JYFXJ = 0
	WAR.FXHJ1 = 0
	WAR.FXHJ2 = 0
	WAR.FXHJ3 = 0
	WAR.FXHJ4 = 0
	
    if (PersonGT(pid, 107) and (DT(pid, 599))) or (wglw(pid,107) and JLSD(10,40,pid) and PersonGTJL(pid, 107,WAR.NGJL)) then 	 	
	    WAR.JYFXJ = math.random(1, 13)
		local FXHJ = "九阴飞絮・"
		local WZTS = {"一道","二道","三道","四道","五道","六道","七道","八道","九道","十道","十一道","十二道","十三道"}
		WAR.Person[id][CC.TXWZ2] = FXHJ..WZTS[WAR.JYFXJ];
		if WAR.JYFXJ == 1 or WAR.JYFXJ == 2 or WAR.JYFXJ == 3 or WAR.JYFXJ == 4 then 
			WAR.FXHJ1 = 1
		end
		if WAR.JYFXJ == 5 or WAR.JYFXJ == 6 or WAR.JYFXJ == 7 or WAR.JYFXJ == 8 then 
			WAR.FXHJ2 = 1
		end
		if WAR.JYFXJ == 9 or WAR.JYFXJ == 10 or WAR.JYFXJ == 11 or WAR.JYFXJ == 12 then 
			WAR.FXHJ3 = 1
		end
		if WAR.JYFXJ == 13 then 
			WAR.FXHJ4 = 1
		end
		ng = ng + 1000
	end	
	
    if DT(pid,583) and JLSD(pid,10,45) then 
		WAR.XYZD = math.random(1,4)
		local XYJQ = "玄阴之道・"	
		local WZTS = {"风","雷","火","冰"}
		WAR.Person[id][CC.TXWZ2] = XYJQ..WZTS[WAR.XYZD];
		if WAR.XYZD == 1 then
			WAR.XYFQ = 1
		end 
		if WAR.XYZD == 1 then
			WAR.XYLQ = 1
		end 
		if WAR.XYZD == 1 then
			WAR.XYHQ = 1
		end 
		if WAR.XYZD == 1 then
			WAR.XYBQ = 1
		end 
		ng = ng + 1250
	end		
		
    -- 三千越甲不可敌12-29-
	if DT(pid,614) then 
	    local dfnum = 0
	    for j = 0, WAR.PersonNum - 1 do
	       if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
	    	    dfnum = dfnum + 1
	        end
	    end
        ng = ng + dfnum*200
	end
	
	if (MPPD(pid) == 5 and PersonGT(pid,96) and MPDJ(pid)>1 and JLSD(0,20+MPDJ(pid)*15,pid)) or (DT(pid,615) and JLSD(20,50,pid)) then
	    if JY.Person[pid]["资质"] < 50 then
	        WAR.LHT= math.random(6, 10)
	    elseif JY.Person[pid]["资质"] >= 50 then
	        WAR.LHT= math.random(1, 5)
	    end
	    if DT(pid,615) then
	        WAR.LHT=math.random(9, 10)
	    end
	   	if WAR.Person[id][CC.TXWZ1] == nil then
			WAR.Person[id][CC.TXWZ1] = "韦陀镇魂.万魔降伏"
		else
			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .."万魔降伏"
		end
	end	
	
	--豸苗：龙象
	if (PersonGT(pid, 103) and (DT(pid, 62) or DT(pid, 594))) or (wglw(pid,103) and pid == 0 and (JLSD(0,JY.Person[pid]["资质"],pid) or WAR.LXXL[pid] ~= nil)) or (wglw(pid,103) and DT(pid,618)) or (DT(pid, 662) and PersonKF(pid, 103)) then
	    if JY.Person[pid]["资质"] > 50 then
	        WAR.LXBL = math.random(6, 10)
	    elseif JY.Person[pid]["资质"] <= 50 then
	        WAR.LXBL = math.random(1, 5)
	    elseif DT(pid, 62) or DT(pid, 594) then
	        WAR.LXBL = math.random(6, 10)
	    end
	    local WZTS = {"一","二","三","四","五","六","七","八","九","十"}
	    if DT(pid, 618) then 
	       WAR.Person[id][CC.TXWZ1] = "无相・"..WZTS[WAR.LXBL].."龙"..WZTS[WAR.LXBL].."象"
	    else
	   	if WAR.Person[id][CC.TXWZ1] == nil then
			WAR.Person[id][CC.TXWZ1] = WZTS[WAR.LXBL].."龙"..WZTS[WAR.LXBL].."象"
		else
			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" ..WZTS[WAR.LXBL].."龙"..WZTS[WAR.LXBL].."象"
		end
	    end
	end  
	
    if wugong == 66 and (DT(pid, 595) or DT(pid,103) or wglw1(pid,66)) then	--火焰刀	
	    if JY.Person[pid]["资质"] > 50 or DT(pid, 595) or DT(pid,103) then
	        WAR.HYDX2 = math.random(6, 10)
	    elseif JY.Person[pid]["资质"] <= 50 then
	        WAR.HYDX2 = math.random(1, 5)
	    end
	    local WZTS = {"一","二","三","四","五","六","七","八","九","十"}
	    if DT(pid, 103) or wglw1(pid,66) then 
	        WAR.Person[id][CC.TXWZ1] = "刀气・"..WZTS[WAR.HYDX2].."气"..WZTS[WAR.HYDX2].."劲"
	    else
			if WAR.Person[id][CC.TXWZ1] == nil then
				WAR.Person[id][CC.TXWZ1] = WZTS[WAR.HYDX2].."气"..WZTS[WAR.HYDX2].."劲"
			else
				WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" ..WZTS[WAR.HYDX2].."气"..WZTS[WAR.HYDX2].."劲"
			end
	    end
	end 
	
    if NF(pid) and yongdao(wugong) then 
	    WAR.CDXY = math.random(1, 3)
		local WZTS = {"纵斩・纵观天地","横劈・横眼千夫","斜砍・斜看苍生"}
		if WAR.Person[id][CC.TXWZ2] == nil then
			WAR.Person[id][CC.TXWZ2] = WZTS[WAR.CDXY];
		else
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+" ..WZTS[WAR.CDXY]
		end
		if WAR.CDXY == 3 then 
			ng = ng + 500
		end
	end  	
	
    --夫妻刀法
	if wugong == 62 and (DT(pid,189) or wglw1(pid,62)) then	
		WAR.FQDS = math.random(1,6)
		local WZTS = {"女貌郎才珠万斛 天教艳质为眷属","清风引佩下瑶台 明月照妆成金屋","刀光掩映孔雀屏 喜结丝萝在乔木","英雄无双风流婿 却扇洞房燃花烛","碧箫声里双鸣凤 今朝有女颜如玉","千金一刻庆良宵，占断人间天上福"}
	    if WAR.FQDS > 0 then
			ng = ng + 1000
		end 	
		if WAR.Person[id][CC.TXWZ2] == nil then
			WAR.Person[id][CC.TXWZ2] = WZTS[WAR.FQDS];
		else
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+" ..WZTS[WAR.FQDS]
		end
	end 	
	
	--豸苗：太玄经1-26-
	if (PersonGT(pid, 102) and ((JLSD(0,30,pid) and JY.Person[pid]["资质"] < 31) or DT(pid,38))) or (PersonGT(pid, 102) and wglw(pid,102)) or (T5BCF(pid) and juexing()>0) then
	    if DT(pid,38) or wglw(pid,102) or (T5BCF(pid) and juexing()>0) then 
	        WAR.TXTX = math.random(1, 6)
	    else 
	        WAR.TXTX = math.random(1, 5)
	    end
	    local WZTS = {"十步杀一人 千里不留行","赵客缦胡缨 吴钩霜雪明","救赵挥金锤 邯郸先震惊","闲过信陵饮 脱剑膝前横","三杯吐然诺 五岳倒为轻","谁能书阁下 白首太玄经"}
	   	if WAR.Person[id][CC.TXWZ1] == nil then
			WAR.Person[id][CC.TXWZ1] = WZTS[WAR.TXTX];
		else
			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" ..WZTS[WAR.TXTX]
		end
		if WAR.TXTX > 0  then
		    ng = ng + 1500
		end   
	end  
	
	if DT(pid,164) and ZYJ(pid) and wugong == 18 then
	    fightnum = 2
        if  WAR.ACT == 1 then
            WAR.Person[WAR.CurID][CC.TXWZ3] = "绝学・碧针清掌・松针"
		elseif  WAR.ACT == 2 then
		    WAR.Person[WAR.CurID][CC.TXWZ3] = "绝学・碧针清掌・碧掌"
		    ng = ng + 2000
		end
	end	
	
	
	--魔音・碧海潮生
	if (wglw(pid,6) and PersonGT(pid,6)) or (PersonKF(pid,6) and DT(pid,57)) then
        if math.random(10) <= 5 then 
	        WAR.BHZC = WAR.BHZC + math.random(5)
	   	if WAR.Person[id][CC.TXWZ1] == nil then
			WAR.Person[id][CC.TXWZ1] = "碧海・潮起"
		else
			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .."碧海・潮起"
		end
		  if WAR.BHZC>=5 then 
		     WAR.BHZC = 5
		  end
	    elseif (math.random(10) > 5 and WAR.BHZC > 0) or WAR.BHZC >=5 then
	      WAR.BHZC1 = 1
	   	if WAR.Person[id][CC.TXWZ1] == nil then
			WAR.Person[id][CC.TXWZ1] = "碧海・潮落"
		else
			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .."碧海・潮落"
		end
	    end
	    ng = ng + 400*WAR.BHZC
    end	   	
	
	if PersonGT(pid,6) and DT(pid,57) and JX(pid) then
	    if yongquan(wugong) and (WAR.Actup[pid]~=nil or JLSD(10,50,pid)) then
	        WAR.LYBF = 3
	   	   	if WAR.Person[id][CC.TXWZ1] == nil then
			    WAR.Person[id][CC.TXWZ2] = "落英・黄帝芳华"
		    else
			    WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ1] .. "+" .."落英・黄帝芳华"
		    end
	    end
	end
	
	if PersonGT(pid,6) and DT(pid,57) and JX(pid) then
	    if yongjian(wugong) and (WAR.Actup[pid]~=nil or JLSD(10,50,pid)) then
	        for j = 0, WAR.PersonNum - 1 do
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
					local tmppid = WAR.Person[j]["人物编号"]
					local aa = math.random(2,8)
					local bb=  math.modf(JY.Person[tmppid]["内力"]/500)
					WAR.MENG[tmppid]=WAR.MENG[tmppid] or 0 + bb
					WAR.YHDF[tmppid]=1
					WAR.Person[j]["体力点数"] = (WAR.Person[j]["体力点数"] or 0) + AddPersonAttrib(tmppid, "体力", -aa)
					WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
				end
			end		  
	   	   	if WAR.Person[id][CC.TXWZ2] == nil then
			    WAR.Person[id][CC.TXWZ2] = "玉箫・喑声潮曲"
		    else
			    WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+" .."玉箫・喑声潮曲"
		    end
	    end
	end
	
	if PersonGT(pid,6) and DT(pid,57) and JX(pid) then
	    if yongan(wugong) and (WAR.Actup[pid]~=nil or JLSD(10,50,pid)) then
	        WAR.LYBF = 2
	   	   	if WAR.Person[id][CC.TXWZ2] == nil then
			    WAR.Person[id][CC.TXWZ2] = "弹指・刹影无声"
		    else
			    WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+" .."弹指・刹影无声"
		    end
	    end
	end
	
    if DT(pid, 114) and WAR.HQWX == 1 then --豸苗：扫地僧附加伤害 --17-2-9
	    ng = ng + 2000
    end
  
	if T13TQS(pid) then ----沼跃鱼：滕青山拟兽式
		WAR.TQS = math.random(1, 5)
		local WZTS = {"拟兽式・蛇咬","拟兽式・虎咆","拟兽式・隼旋","拟兽式・狼吻","拟兽式・象踏"}
		WAR.Person[id][CC.TXWZ3] = WZTS[WAR.TQS];
		if WAR.TQS == 2 then --滕青山虎咆杀气+2000
			ng = ng + 2000
		end
		if WAR.TQS == 3 then --滕青山虎咆杀气+2000
			WAR.TQSLH = 1
		end
	end

	if wssz(pid) then ----沼跃鱼：滕青山拟兽式
		WAR.TQS = math.random(1, 5)
		local WZTS = {"拟兽式・蛇咬","拟兽式・虎咆","拟兽式・隼旋","拟兽式・狼吻","拟兽式・象踏"}
		WAR.Person[id][CC.TXWZ3] = WZTS[WAR.TQS];
		if WAR.TQS == 2 then --滕青山虎咆杀气+2000
			ng = ng + 2000
		end
		if WAR.TQS == 3 then --滕青山虎咆杀气+2000
			WAR.TQSLH = 1
		end
	end
	
	if T11CJR(pid) and juexing() > 1 then 
		ng = ng + 500 + JY.Person[pid]["实战"] 
		if WAR.Person[id][CC.TXWZ3] == nil then
			WAR.Person[id][CC.TXWZ3] = "怒潮袭天"
		else
			WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+" .."怒潮袭天"
		end			
	end
	
	if T11CJR(pid) and juexing() > 2 then 
		if WAR.Person[id][CC.TXWZ0] == nil then
			WAR.Person[id][CC.TXWZ0] = "天地不容"
		else
			WAR.Person[id][CC.TXWZ0] = WAR.Person[id][CC.TXWZ0] .. "+" .."天地不容"
		end			
	end	
	
	if wugong == 83 and wglw1(pid,83) then 
		if WAR.Person[id][CC.TXWZ1] == nil then
			WAR.Person[id][CC.TXWZ1] = "一大三千・无上大千"
		else
			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .."无上大千"
		end			
	end
	--持瑶琴刚柔劲阴阳弦
	if wugong == 73 and wglw1(pid,73) then 
		if WAR.Person[id][CC.TXWZ3] == nil then
			WAR.Person[id][CC.TXWZ3] = "刚柔劲・阴阳弦"
		else
			WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+" .."刚柔劲・阴阳弦"
		end			
	end
	
	--胡刀领悟 天下霸道三刀
	if wugong == 67 and (wglw1(pid,67) or (DT(pid, 1) and JX(pid)) or (DT(pid, 621) and JX(pid))) then 
		if WAR.Person[id][CC.TXWZ3] == nil then
			WAR.Person[id][CC.TXWZ3] = "天下霸道三刀"
		else
			WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+" .."天下霸道三刀"
		end
		if JLSD(10,60,pid) then
			WAR.FZS = 1
			if WAR.Person[id][CC.TXWZ3] == nil then
			WAR.Person[id][CC.TXWZ3] = "铁碎牙・风之殇"
			else
			WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+" .."风之殇"
			end
		end	
		if WAR.LQZ[pid] == 100 and WAR.SPIRIT[pid] >= 140 then--
			if WAR.Person[id][CC.TXWZ1] == nil then
			WAR.Person[id][CC.TXWZ1] = "精绝天下・斩刃冥道"
			else
			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .."斩刃冥道"
			end
		end
	end
	
	--黄沙万里鞭乱尘无尽特效
	if wugong == 78 and wglw1(pid,78) then 
		if WAR.Person[id][CC.TXWZ1] == nil then
			WAR.Person[id][CC.TXWZ1] = "沙狱・乱尘无尽"
		else
			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .."乱尘无尽"
		end			
	end
	
	
	
    if NF(pid) and juexing() > 2 then 
		ng = ng + 1000 + JY.Person[pid]["实战"] 
	end
	
	ng = ng + rouxi(pid, wugong)
	
	if DT(pid, 636) then --袁紫衣加气攻
	    ng = ng + wgnumber(pid, 0) * 150
	end		
	
    if T4WXS(pid) then --王小石加气攻
	    ng = ng + sixi(pid,3)*5
	end	
	
    --白驼山主运蛤蟆功增加气攻
	if MPPD(pid) == 8 and PersonGT(pid,95) then	
		ng = ng + 1500
	end	
	
	--豸苗：乔峰神威如龙
	if DT(pid, 50) and JLSD(10,60,pid) then
	    ng = ng + WAR.SPIRIT[pid]*10
		if WAR.Person[id][CC.TXWZ2] == nil then
			WAR.Person[id][CC.TXWZ2] = "神威如龙"
		else
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+神威如龙"
		end
	end
	
    if T7DFWM(pid) and juexing() >= 1 then --东方未明攻击特技
	    if JY.Person[0]["攻击力"] >= 550 and JY.Person[0]["生命"] <= math.modf(JY.Person[0]["生命最大值"] * 0.5)
		and JLSD(30, 65, pid) then --东方未明觉醒后生命50%以下，35%几率攻击加倍
		WAR.DFWM = 1
		if WAR.Person[id][CC.TXWZ3] == nil then
			WAR.Person[id][CC.TXWZ3] = "会心一击"
		else
			WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+" .."会心一击"
		end				
		    WAR.Person[id][CC.TXDH] = 110
	end	
	
	if DT(pid,104) and JX(pid) and (WAR.HIDE[pid] == nil or WAR.HIDE[pid] <= 0) then --沼跃鱼:乾达婆
        if JLSD(10, 45+math.modf((WAR.SPIRIT[pid]-100)*1.25), pid)  then
			WAR.HIDE[pid] = WAR.HIDE[pid] or 0 +math.modf((WAR.SPIRIT[pid]-100)*3)
			WAR.QFY1[pid] = WAR.QFY1[pid] or 0 +math.modf((WAR.SPIRIT[pid]-100)*3)
			if WAR.Person[id][CC.TXWZ3] == nil then
			    WAR.Person[id][CC.TXWZ3] = "乾达婆.飞天瞬影"
		    else
			    WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+" .."乾达婆.飞天瞬影"
		    end				
		        WAR.Person[id][CC.TXDH] = 110
		end
	end
	
	--东方未明觉醒后四系特技
	if sixi(pid, 1) >= 130 and yongquan(wugong) and JLSD(30, 50 + wgnumber(0, 1), pid) then 
		if WAR.Person[id][CC.TXWZ3] == nil then
			WAR.Person[id][CC.TXWZ3] = "凌空点穴"
		else
			WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+" .."凌空点穴"
		end
		WAR.DFWM2 = 1	
	elseif sixi(pid, 2) >= 130 and yongjian(wugong) and JLSD(30, 60 + wgnumber(0, 2), pid) then
		if WAR.Person[id][CC.TXWZ3] == nil then
			WAR.Person[id][CC.TXWZ3] = "卧龙傲天"
		else
			WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+" .."卧龙傲天"
		end		
		WAR.DFWM2 = 2		
		WAR.DFWMJIQI = 1
	elseif sixi(pid, 3) >= 130 and yongdao(wugong) and JLSD(30, 55 + wgnumber(0, 3), pid) then
		if WAR.Person[id][CC.TXWZ3] == nil then
			WAR.Person[id][CC.TXWZ3] = "吞天噬日"
		else
			WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+" .."吞天噬日"
		end
		WAR.DFWM2 = 3		
	elseif sixi(pid, 4) >= 130 and yongte(wugong) and JLSD(30, 55 + wgnumber(0, 4), pid) then
		if WAR.Person[id][CC.TXWZ3] == nil then
			WAR.Person[id][CC.TXWZ3] = "醉里挑灯"
		else
			WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+" .."醉里挑灯"
		end	
		WAR.DFWM2 = 4
	elseif sixi(pid, 5) >= 130 and yongan(wugong) and JLSD(30, 55 + wgnumber(0, 6), pid) then
		if WAR.Person[id][CC.TXWZ3] == nil then
			WAR.Person[id][CC.TXWZ3] = "寸芒破罡"
		else
			WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+" .."寸芒破罡"
		end	
		WAR.DFWM2 = 5		
	end
    end	

    if JY.Person[pid]["武器"] == 43 and JLSD(10,40,pid)  then  --屠龙刀
		for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[j]["死亡"] == false and not nokillspeed(WAR.Person[j]["人物编号"]) then
				WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - 150
			end
		end
	end
	if JY.Person[pid]["武器"] == 236 and JLSD(10,40,pid)  then --太极剑
		for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[j]["死亡"] == false and not nokillspeed(WAR.Person[j]["人物编号"]) then
				WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - 75
			end
		end
	end
	if wugong == 141 and JY.Person[pid]["武器"] == 299 and JLSD(10,60,pid) then --武骧金星：霹雳狂刀特效
		for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[j]["死亡"] == false and not nokillspeed(WAR.Person[j]["人物编号"]) then
				WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - 200
			end
		end
	end
	if JY.Person[pid]["武器"] == 312 and JLSD(10,40,pid) then --金轮
		for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[j]["死亡"] == false and not nokillspeed(WAR.Person[j]["人物编号"]) then
				WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - 120
			end
		end
	end
	if JY.Person[pid]["武器"] == 313 and JLSD(10,40,pid) then --银弧刀
		for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[j]["死亡"] == false and not nokillspeed(WAR.Person[j]["人物编号"]) then
				WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - 100
			end
		end
	end
	if wugong == 26 and (DT(pid,49) or DT(pid,617)) and JLSD(10,60,pid) then --虚竹降龙掌减集气
		for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[j]["死亡"] == false and not nokillspeed(WAR.Person[j]["人物编号"]) then
				WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - 200
			end
		end
	end
	--华山拳系
	if (MPPD(pid) == 14 and PersonGT(pid,90) and JY.Person[pid]["拳掌功夫"] >= 300 and yongquan(wugong) and JLSD(10,40,pid)) or ((DT(pid,54) or DT(pid,185) or DT(pid,188)) and yongquan(wugong) and JLSD(10,45,pid)) then
        local str = "华山・混元掌"	    
		for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[j]["死亡"] == false and not nokillspeed(WAR.Person[j]["人物编号"]) then
				WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - 150
			end
		end
		if WAR.Person[id][CC.TXWZ1] ~= nil then
			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+"..str
		else
			WAR.Person[id][CC.TXWZ1] = str
		end
	end	
	--苍龙破暴怒减集气
	if wugong == 67 and (wglw1(pid,67) or (DT(pid, 1) and JX(pid)) or (DT(pid, 621) and JX(pid))) and WAR.LQZ[pid] == 100 then
		if WAR.QLP ~= nil and WAR.QLP > 0 then
		local aa = WAR.QLP
		for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[j]["死亡"] == false and not nokillspeed(WAR.Person[j]["人物编号"]) then
				WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - aa*30
			end
		end
		end
	end	
	if PersonGTJL(pid,184) then --瑜伽密乘减集气
		for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[j]["死亡"] == false and not nokillspeed(WAR.Person[j]["人物编号"]) then
				WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - 100
			end
		end
	end
	if jtyl(pid) and (WAR.JTYL == 2 or WAR.JTYL == 9) then --谢无悠
        for j = 0,WAR.PersonNum-1 do 
	        if WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[j]["死亡"] == false then
               WAR.XSZW[WAR.Person[j]["人物编号"]] = 25
		    end
        end
	end	
	if jtyl(pid) and (WAR.JTYL == 2 or WAR.JTYL == 9) then --谢无悠
        for j = 0,WAR.PersonNum-1 do 
	        if WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[j]["死亡"] == false then
               WAR.XSZW[WAR.Person[j]["人物编号"]] = 25
		    end
        end
	end		
	
    --混元一气---气海无量
    if wglw(pid,90) and JLSD(0,25,pid) and PersonGT(pid, 90) then 
        local str = "混元一气・气海无量"
        for j = 0,WAR.PersonNum-1 do 
	        if WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[j]["死亡"] == false and WAR.Person[j].Time > 250 then
                if nokillspeed(WAR.Person[j]["人物编号"]) then
                    if JY.Person[pid]["体力"] == 100 then
			            WAR.Person[j].Time = 250
			        end
			    else  
                    WAR.Person[j].Time = 250			   
		        end
		    end
        end
	 	if DT(pid, 618) then
			str = "无相・气海无量"
		end
		if WAR.Person[id][CC.TXWZ1] ~= nil then
			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+"..str
		else
			WAR.Person[id][CC.TXWZ1] = str
		end
    end
    if (PersonKF(pid, 92) and DT(pid, 13)) or (wglw(pid,92) and PersonGT(pid, 92) )then
	    local str = "狮王吼"
  		if JLSD(0,30,pid) then
			for p = 0, WAR.PersonNum - 1 do
			    if WAR.Person[p]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and 
				    WAR.Person[p]["死亡"] == false and not nokillspeed(WAR.Person[p]["人物编号"]) and not ycfy(WAR.Person[p]["人物编号"]) then
				    WAR.SZWH[WAR.Person[p]["人物编号"]] = 20 --狮子王吼
			    end
			end
			if DT(pid, 618) then
				str = "无相・狮王吼"
			end
			if WAR.Person[id][CC.TXWZ1] ~= nil then
				WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+"..str
			else
				WAR.Person[id][CC.TXWZ1] = str
			end
		end	
	end	
	
	--恶灭之雷
	if DT(pid,528) and JX(pid) and JLSD(10,30,pid) and WAR.MWQ2 == 1 then
	   local str = ".婆罗门"
	    for e = 0, WAR.PersonNum - 1 do
			if WAR.Person[e]["死亡"] == false and WAR.Person[e]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
			WAR.Person[e].TimeAdd = WAR.Person[e].TimeAdd - 300
			WAR.Person[e]["真伤点数"] = (WAR.Person[e]["真伤点数"] or 0) + AddPersonAttrib(WAR.Person[e]["人物编号"],"生命",-200)
			--JY.Person[WAR.Person[e]["人物编号"]]["生命"] = JY.Person[WAR.Person[e]["人物编号"]]["生命"] - 200
			WAR.XNXS[WAR.Person[e]["人物编号"]] = 1
			end
	    end
    end
	
	if ((DT(pid, 13) and JX(pid)) or wglw(pid,92) ) and PersonGT(pid, 92) and JY.Person[pid]["内力"]> 5000 then	    
		if JLSD(10,35,pid) then
		    local str = "奥义.狂狮咆哮"
	        for e = 0, WAR.PersonNum - 1 do
                if WAR.Person[e]["死亡"] == false and WAR.Person[e]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
                    WAR.Person[e].TimeAdd = WAR.Person[e].TimeAdd - math.modf(JY.Person[WAR.Person[WAR.CurID]["人物编号"]]["内力"] / 5)
                    if WAR.Person[e].Time < -450 then
                        WAR.Person[e].Time = -450
                    end
                    WAR.Person[e]["内力点数"] = (WAR.Person[e]["内力点数"] or 0) + AddPersonAttrib(WAR.Person[e]["人物编号"],"内力",-(math.modf(JY.Person[WAR.Person[WAR.CurID]["人物编号"]]["内力"] / 25)))
					--JY.Person[WAR.Person[e]["人物编号"]]["内力"] = JY.Person[WAR.Person[e]["人物编号"]]["内力"] - math.modf(JY.Person[WAR.Person[WAR.CurID]["人物编号"]]["内力"] / 25)
                    if JY.Person[WAR.Person[e]["人物编号"]]["内力"] < 0 then
                        JY.Person[WAR.Person[e]["人物编号"]]["内力"] = 0
                    end
                    WAR.Person[e]["真伤点数"] = (WAR.Person[e]["真伤点数"] or 0) + AddPersonAttrib(WAR.Person[e]["人物编号"],"生命",-(math.modf(JY.Person[WAR.Person[WAR.CurID]["人物编号"]]["内力"] / 100)))
					--JY.Person[WAR.Person[e]["人物编号"]]["生命"] = JY.Person[WAR.Person[e]["人物编号"]]["生命"] - math.modf(JY.Person[WAR.Person[WAR.CurID]["人物编号"]]["内力"] / 100)
					WAR.XNXS[WAR.Person[e]["人物编号"]] = 1
				end
                if JY.Person[WAR.Person[e]["人物编号"]]["生命"] < 0 then
                    JY.Person[WAR.Person[e]["人物编号"]]["生命"] = 0
                end
            end
	    if DT(pid, 618) then
			str = "无相・狂狮咆哮"
		end
	        if wglw(pid,92) then
	            local jiannei = math.modf(JY.Person[pid]["内力"] * 0.1)
	            WAR.Person[WAR.CurID]["内力点数"] = ( WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", -jiannei)
	            local jiannei2 = math.modf(JY.Person[pid]["体力"] * 0.1)
	             WAR.Person[WAR.CurID]["体力点数"] = ( WAR.Person[WAR.CurID]["体力点数"] or 0) + AddPersonAttrib(pid, "体力", -jiannei2)
	        elseif (DT(pid, 13) and JX(pid)) then
	            local jiannei = math.modf(JY.Person[pid]["内力"] * 0.2)
	             WAR.Person[WAR.CurID]["内力点数"] = ( WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", -jiannei)
	            local jiannei2 = math.modf(JY.Person[pid]["体力"] * 0.2)
	             WAR.Person[WAR.CurID]["体力点数"] = ( WAR.Person[WAR.CurID]["体力点数"] or 0) + AddPersonAttrib(pid, "体力", -jiannei2)
	        end
		    if WAR.Person[id][CC.TXWZ1] ~= nil then
			    WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+"..str
		    else
			    WAR.Person[id][CC.TXWZ1] = str
		    end
		end	
	end	
	
	if jtyl(pid) then ----
		for p = 0, WAR.PersonNum - 1 do
			if WAR.Person[p]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[p]["死亡"] == false then
				if WAR.MJYW[WAR.Person[p]["人物编号"]]  ~= nil then 
				    WAR.MJYW[WAR.Person[p]["人物编号"]] = nil
				    WAR.MJYW[WAR.Person[WAR.CurID]["人物编号"]] = 1
				end 
			end
		end
	end		
    if wglw(pid,103) or (PersonGT(pid, 103) and (DT(pid, 62) or DT(pid, 594))) or (DT(pid, 662) and PersonKF(pid, 103)) then --血龙
	   -- local str = "血龙之怒"
  		if JLSD(0,40,pid) then
		    local str = "血龙之怒"
			for p = 0, WAR.PersonNum - 1 do
			    if WAR.Person[p]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[p]["死亡"] == false then
				    if WAR.LWZN[WAR.Person[p]["人物编号"]]  == nil then 
				        WAR.LWZN[WAR.Person[p]["人物编号"]] = 1 --狮子王吼
				    else 
				        WAR.LWZN[WAR.Person[p]["人物编号"]] = WAR.LWZN[WAR.Person[p]["人物编号"]] +1
				    end
				if WAR.LWZN[WAR.Person[p]["人物编号"]] > 10 then 
				   WAR.LWZN[WAR.Person[p]["人物编号"]] = 10 
				end   
			end
		end
			--if DT(pid, 618) then
				--str = "无相・狮王吼"
				--end
				if WAR.Person[id][CC.TXWZ3] ~= nil then
				WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+"..str
				else
				WAR.Person[id][CC.TXWZ3] = str
				end
		end	
  		if JLSD(0,40,pid) then
		    local str = "龙象气劲"
			--for p = 0, WAR.PersonNum - 1 do
			--if WAR.Person[p]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and 
			--	WAR.Person[p]["死亡"] == false and not nokillspeed(WAR.Person[p]["人物编号"]) and not ycfy(WAR.Person[p]["人物编号"]) then
			--	WAR.LXQJ[100+WAR.Person[p]["人物编号"]] = 1 --狮子王吼  
			--end
			--end
			WAR.LXQJ1 = 1
				--if DT(pid, 618) then
				--str = "无相・狮王吼"
				--end
				if WAR.Person[id][CC.TXWZ3] ~= nil then
				WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+"..str
				else
				WAR.Person[id][CC.TXWZ3] = str
				end
		end	
	end
	
	if (wglw1(pid,66) or ((DT(pid, 103) or DT(pid, 595)))) and PersonKFJ(pid, 66) then --血龙
	   -- local str = "血龙之怒"
  		if JLSD(0,40,pid) then
		    local str = "九凤焚天"
			for p = 0, WAR.PersonNum - 1 do
			    if WAR.Person[p]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[p]["死亡"] == false then
				    if WAR.HYDX[WAR.Person[p]["人物编号"]]  == nil then 
				        WAR.HYDX[WAR.Person[p]["人物编号"]] = 1 --狮子王吼
				    else 
				        WAR.HYDX[WAR.Person[p]["人物编号"]] = WAR.HYDX[WAR.Person[p]["人物编号"]] +1
				    end
				    if WAR.HYDX[WAR.Person[p]["人物编号"]] > 10 then 
				        WAR.HYDX[WAR.Person[p]["人物编号"]] = 10 
				    end   
			    end
			end
				--if DT(pid, 618) then
				--str = "无相・狮王吼"
				--end
				if WAR.Person[id][CC.TXWZ3] ~= nil then
				WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+"..str
				else
				WAR.Person[id][CC.TXWZ3] = str
				end
		end	
			if JLSD(0,40,pid) then
		    local str = "毕方怒焰"
			--for p = 0, WAR.PersonNum - 1 do
			--if WAR.Person[p]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and 
			--	WAR.Person[p]["死亡"] == false and not nokillspeed(WAR.Person[p]["人物编号"]) and not ycfy(WAR.Person[p]["人物编号"]) then
			--	WAR.LXQJ[100+WAR.Person[p]["人物编号"]] = 1 --狮子王吼  
			--end
			--end
			WAR.HYDX1 = 1
				--if DT(pid, 618) then
				--str = "无相・狮王吼"
				--end
				if WAR.Person[id][CC.TXWZ3] ~= nil then
				WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+"..str
				else
				WAR.Person[id][CC.TXWZ3] = str
				end
		end	
	end
	
    if NF(pid) and yongdao(wugong) then --雪饮
		local str = "雪饮刀气"
		for p = 0, WAR.PersonNum - 1 do
			if WAR.Person[p]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[p]["死亡"] == false then
				if WAR.XYDQ[WAR.Person[p]["人物编号"]]  == nil then 
				    WAR.XYDQ[WAR.Person[p]["人物编号"]] = 1 
				else 
				    WAR.XYDQ[WAR.Person[p]["人物编号"]] = WAR.XYDQ[WAR.Person[p]["人物编号"]] +1
				end
				if WAR.XYDQ[WAR.Person[p]["人物编号"]] > 10 then 
				    WAR.XYDQ[WAR.Person[p]["人物编号"]] = 10 
				end   
			end
	    end
		if WAR.Person[id][CC.TXWZ3] ~= nil then
			WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+"..str
		else
			WAR.Person[id][CC.TXWZ3] = str
		end
		local str = "寒意凌冽"
	    WAR.XYDY = 1
		if WAR.Person[id][CC.TXWZ3] ~= nil then
			WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+"..str
		else
			WAR.Person[id][CC.TXWZ3] = str
		end	
	end	
	
	--武无敌十方皆杀
	if WAR.ACT == 1 and 
	    DT(pid, 600) and JLSD(10, 70, pid) and not wglw(pid,181) then 
		if WAR.Person[id][CC.TXWZ1] == nil then
			WAR.Person[id][CC.TXWZ1] = "玄武真功・十方皆杀"
		else
			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+玄武真功・十方皆杀"
		end
		WAR.Person[id][CC.TXDH] = 120
		for j = 0, WAR.PersonNum - 1 do	
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"],"生命",-800)
				--JY.Person[WAR.Person[j]["人物编号"]]["生命"] = JY.Person[WAR.Person[j]["人物编号"]]["生命"] - 800
				if JY.Person[WAR.Person[j]["人物编号"]]["生命"] <= 0 then
					JY.Person[WAR.Person[j]["人物编号"]]["生命"] = 1
				end
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
					WAR.Person[j]["内力点数"] = (WAR.Person[j]["内力点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"], "内力", -3000)
				end
				WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
			end
		end		
	end	
	
    --聂风十方皆杀
	if NF(pid) and (JLSD(35, 75, pid) or WAR.LQZ[pid] == 100) and juexing() > 1 then
		JY.Person[pid]["内力"] = math.modf(JY.Person[pid]["内力"] * 0.2) 
		if WAR.Person[id][CC.TXWZ1] == nil then
			WAR.Person[id][CC.TXWZ1] = "玄武真功・十方皆杀"
		else
			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+玄武真功・十方皆杀"
		end
		WAR.Person[id][CC.TXDH] = 119
		for j = 0, WAR.PersonNum - 1 do	
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"],"生命",-400)
				--JY.Person[WAR.Person[j]["人物编号"]]["生命"] = JY.Person[WAR.Person[j]["人物编号"]]["生命"] - 800
				if JY.Person[WAR.Person[j]["人物编号"]]["生命"] <= 0 then
					JY.Person[WAR.Person[j]["人物编号"]]["生命"] = 1
				end
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
					WAR.Person[j]["内力点数"] = (WAR.Person[j]["内力点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"], "内力", -1200)
				end
				WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
			end
		end	
	end	
	
	--玄武真功十方皆杀
	if (PersonGT(pid, 181) and (DT(pid, 455))) or (wglw(pid,181) and JLSD(10,40,pid) and PersonGTJL(pid,181,WAR.NGJL)) then
		local xihe = sixi(pid,1) + sixi(pid,2) + sixi(pid,3) + sixi(pid,4) + sixi(pid,5)
		if xihe >= 600 then
		    JY.Person[pid]["内力"] = math.modf(JY.Person[pid]["内力"] * 0.2)
            if WAR.Person[id][CC.TXWZ1] == nil then
			    WAR.Person[id][CC.TXWZ1] = "玄武真功・十方皆杀"
		    --else
			    --WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ3].."+玄武真功・十方皆杀"
		    end
		    WAR.Person[id][CC.TXDH] = 120
			for j = 0, WAR.PersonNum - 1 do	
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
					WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"],"生命",-300)
					--JY.Person[WAR.Person[j]["人物编号"]]["生命"] = JY.Person[WAR.Person[j]["人物编号"]]["生命"] - 800
					if JY.Person[WAR.Person[j]["人物编号"]]["生命"] <= 0 then
						JY.Person[WAR.Person[j]["人物编号"]]["生命"] = 1
					end
					if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
						WAR.Person[j]["内力点数"] = (WAR.Person[j]["内力点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"], "内力", -600)
					end
					WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
				end
			end	
	    end		
	end	

	if wugong == 18 and WAR.TZQJ12[pid] == 1 and JLSD(10,45,pid) then
		local xihe = sixi(pid,1) + sixi(pid,2) + sixi(pid,3) + sixi(pid,4) + sixi(pid,5)
		if xihe >= 100 then
		    JY.Person[pid]["内力"] = math.modf(JY.Person[pid]["内力"] * 0.2)
            if WAR.Person[id][CC.TXWZ1] == nil then
			    WAR.Person[id][CC.TXWZ1] = "玄武真功・十方皆杀"
		    --else
			    --WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ3].."+玄武真功・十方皆杀"
		    end
		    WAR.Person[id][CC.TXDH] = 120
		    for j = 0, WAR.PersonNum - 1 do	
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
					WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"],"生命",-250)
					--JY.Person[WAR.Person[j]["人物编号"]]["生命"] = JY.Person[WAR.Person[j]["人物编号"]]["生命"] - 800
					if JY.Person[WAR.Person[j]["人物编号"]]["生命"] <= 0 then
						JY.Person[WAR.Person[j]["人物编号"]]["生命"] = 1
					end
					if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
						WAR.Person[j]["内力点数"] = (WAR.Person[j]["内力点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"], "内力", -500)
					end
					WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
				end
			end	
	    end		
	end

	--武无敌十方无敌
    if DT(pid, 600) and JLSD(10, 100, pid) and not wglw(pid,181) then
		DHdisplay(1653, 1665, "玄武真功・十方无敌")
	    local str = "十方无敌"  		
		for p = 0, WAR.PersonNum - 1 do
			if WAR.Person[p]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and 
				WAR.Person[p]["死亡"] == false and not nokillspeed(WAR.Person[p]["人物编号"]) and not ycfy(WAR.Person[p]["人物编号"]) then
				WAR.SZWH[WAR.Person[p]["人物编号"]] = 75 --十方无敌
		    end 
		end
		WAR.SQHY = 1
	end 	
	
    --聂风十方无敌
    if NF(pid) and (JLSD(35, 75, pid) or WAR.LQZ[pid] == 100) and juexing() > 1 then
	    DHdisplay(2182, 2196, "玄武真功・十方无敌")
	    JY.Person[pid]["内力"] = math.modf(JY.Person[pid]["内力"] * 0.2)
	    local str = "十方无敌"  		
		for p = 0, WAR.PersonNum - 1 do
			if WAR.Person[p]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and 
				WAR.Person[p]["死亡"] == false and not nokillspeed(WAR.Person[p]["人物编号"]) and not ycfy(WAR.Person[p]["人物编号"]) then
				WAR.SZWH[WAR.Person[p]["人物编号"]] = 75 --十方无敌
		    end 
		end
		WAR.SQHY = 1
	end 	
	
	--玄武真功十方无敌	
    if (PersonGT(pid, 181) and (DT(pid, 455))) or (wglw(pid,181) and JLSD(10,40,pid) and PersonGTJL(pid, 181,WAR.NGJL)) then
	    DHdisplay(443, 455, "玄武真功・十方无敌")
		local xihe = sixi(pid,1) + sixi(pid,2) + sixi(pid,3) + sixi(pid,4) + sixi(pid,5)
		if xihe >= 550 then
	        JY.Person[pid]["内力"] = math.modf(JY.Person[pid]["内力"] * 0.1)
	        local str = "十方无敌"  		
			for p = 0, WAR.PersonNum - 1 do
			    if WAR.Person[p]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and 
				    WAR.Person[p]["死亡"] == false and not nokillspeed(WAR.Person[p]["人物编号"]) and not ycfy(WAR.Person[p]["人物编号"]) then
				    WAR.SZWH[WAR.Person[p]["人物编号"]] = 75 --十方无敌
		        end 
		    end
	    end
		WAR.SQHY = 1
	end 	
	
	if WAR.SQHY == 1 then
		local ad = math.random(3,5)
	    local ab = ad * 10
        for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
                if JY.Person[WAR.Person[j]["人物编号"]]["内力"] > 100 * ad then
                    --JY.Person[WAR.Person[j]["人物编号"]]["内力"] = JY.Person[WAR.Person[j]["人物编号"]]["内力"] - 100 * ad
                    WAR.Person[j]["内力点数"] = (WAR.Person[j]["内力点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"],"内力",-(100 * ad));
                else
          	        WAR.Person[j]["内力点数"] = (WAR.Person[j]["内力点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"],"内力",-(JY.Person[WAR.Person[j]["人物编号"]]["内力"]))
          	        --JY.Person[WAR.Person[j]["人物编号"]]["内力"] = 0
          	        WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"],"生命",-(100 * ad));
					--JY.Person[WAR.Person[j]["人物编号"]]["生命"] = JY.Person[WAR.Person[j]["人物编号"]]["生命"] - 100 * ad
          	        --WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) - 100 * ad;
                end
				WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
            end
        end
		WAR.SQHY = 0
	end	
	
    --降龙十八掌・刚劲
    if WAR.XLGJ == 1 or WAR.XLGJ == 4 or WAR.XLGJ == 5 then
 		if JLSD(10,60,pid) then		
		    for p = 0, WAR.PersonNum - 1 do
			    if WAR.Person[p]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and 
				    WAR.Person[p]["死亡"] == false and not nokillspeed(WAR.Person[p]["人物编号"]) and not ycfy(WAR.Person[p]["人物编号"]) then
				    WAR.SZWH[WAR.Person[p]["人物编号"]] = 20 --降龙刚劲
		        end 
		    end
	    end
	end	
	
    if wglw(pid,188) or (DT(pid,48) and PersonGT(pid,188))then	
		if JLSD(10,40,pid) then
			DHdisplay(820, 835, "神足经・勇猛精进")
		    for p = 0, WAR.PersonNum - 1 do
			    if WAR.Person[p]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and 
				    WAR.Person[p]["死亡"] == false and not nokillspeed(WAR.Person[p]["人物编号"]) and not ycfy(WAR.Person[p]["人物编号"]) then
				    WAR.SZWH[WAR.Person[p]["人物编号"]] = 20 --神足经
				end	
		    end 
		end
	end 	
	
    --nino 有狮子吼几率出特效
 	if PersonKF(pid, 92) then --狮子吼特效 
    	local jilv = 25
		jilv = jilv + math.modf(JY.Person[pid]["内力"]/500)		
		if PersonGT(pid, 92) then
			jilv = jilv + 25
		end
		if DT(pid, 13) then
			jilv = jilv + 100
		end
		if JLSD(10, jilv + 10, pid) then
			if WAR.Person[id][CC.TXDH] == -1 then
				WAR.Person[id][CC.TXDH] = math.fmod(92, 10) + 85
			end
			local nl = math.modf((JY.Person[pid]["内力"] * 2 + JY.Person[pid]["内力最大值"])/3);--内力综合值
			local jiannei = math.modf(JY.Person[pid]["内力"] * 0.1)
			--if jiannei > 500 then jiannei = 500 end
			if PersonGT(pid, 92)  then
			    if wglw(pid,92) or  DT(pid, 13) then
				   
				else   
				   WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", -jiannei)
				end   
			else
				if wglw(pid,92) or  DT(pid, 13) then
				   WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", -math.modf(jiannei * 0.25))
				else   
				   WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", -math.modf(jiannei * 0.5))
				end 
			end	  
			for j = 0, WAR.PersonNum - 1 do
				if WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and 
					WAR.Person[j]["死亡"] == false and not nokillspeed(WAR.Person[j]["人物编号"]) then
					local tmpid=WAR.Person[j]["人物编号"]
					local enemynl = math.modf(JY.Person[tmpid]["内力"] * 0.5)
					local tmpshaqi = math.modf((nl - enemynl)/50)
					if WAR.SPIRIT[pid] ~= nil then						
						if PersonGT(pid, 92) then	
							tmpshaqi = tmpshaqi + math.modf(WAR.SPIRIT[pid] * 0.5) + 30
						end
					end
					if pid == 0 and WAR.SHG == 1 then
			           WAR.Person[j]["内伤点数"] = (WAR.Person[j]["内伤点数"] or 0) + AddPersonAttrib(tmpid, "受伤程度", 15)
			        end 
					tmpshaqi = limitX(tmpshaqi, 0, 500)
					if jtyl(WAR.Person[j]["人物编号"]) then 
					tmpshaqi = -tmpshaqi
					end
					if DT(pid, 13) then
						WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - tmpshaqi - 30    
					else
						WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - tmpshaqi   --普通角色用，全部集气减100
					end
					if PersonGT(pid, 92) then						
						--WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - 50 --主功体追加杀气50 受伤2-5 30%迟缓1-3						
						--AddPersonAttrib(tmpid, "受伤程度", math.random(3) + 2) 
						if JLSD(10, 40, pid) then
							if WAR.CHZ[tmpid] == nil then
								WAR.CHZ[tmpid] = math.random(3)
							else
								WAR.CHZ[tmpid] = math.random(3) + WAR.CHZ[tmpid]
							end
							WAR.CHXS[tmpid] = 1
						end
					end	
					WAR.XNXS[WAR.Person[j]["人物编号"]]	= 1
				end			
			end
			if WAR.Person[id][CC.TXWZ2] == nil then
				WAR.Person[id][CC.TXWZ2] = "狮子吼"
			else
				WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+狮子吼";
			end
		end
    end
  
    --主功体恢复集气
	for i = 1, #CC.ZGT5 do
		if (CC.ZGT5[i][1] == wugong or (T12YMZ(pid) and wugong == 112)) and (PersonGT(pid, CC.ZGT5[i][2]) or ((PersonGT(pid,9999) and (JY.Thing[224]["加攻击力"]) == CC.ZGT5[i][2] or JY.Thing[224]["加防御力"]) == CC.ZGT5[i][2])) then
			WAR.GTJIQI = CC.ZGT5[i][3]
			WAR.GTPID = pid
			break
		end
	end
    --1-26-and (PersonGT(pid, CC.ZGT5[i][2]) or ((PersonGT(pid,9999) and (JY.Thing[224]["加攻击力"]) == CC.ZGT5[i][2] or JY.Thing[224]["加防御力"]) == CC.ZGT5[i][2])) then
	for i = 1, #CC.ZGT5 do
		if (CC.ZGT5[i][1] ==  WAR.HLTX or CC.ZGT5[i][2] ==  WAR.HLTX) and (wglw(pid,102) or (DT(pid,38) and PersonKF(pid,102))) then
			WAR.GTJIQI = CC.ZGT5[i][3]
			WAR.GTPID = pid
			break
		end
	end
	    --豸苗：折梅手
	for i = 1, #CC.ZGT5 do
	    for l = 1,10 do
	    local jl = 15 + math.modf(JY.Person[pid]["实战"] / 20)+ math.modf(JY.Person[pid]["武学常识"] / 10)
	        if wugong == 14 and (JLSD(0,5+jl,pid) or (MPPD(pid)==7 and JLSD(0,15,pid))) and JY.Person[pid]["内力"] >= 7000 then
	            if JY.Person[pid]["武功" .. l] == CC.ZGT5[i][1] then
			        WAR.GTJIQI = CC.ZGT5[i][3]
			        WAR.GTPID = pid
			        WAR.ZMS = 1
			        break
		        end
		    end
	    end
	end
    --普通角色风林特效  六如
	local lrjl = 0
	lrjl = math.modf(tianshu() * 2)

	if pid == 0 and (JLSD(25,50+lrjl,0) or (putong() == 6 and JLSD(30, 55, 0)) or wglw(0,102)) and tianshu()>=1 
		and (zjtype() == 1 or T10XXZ(0) or zjtype() == 4) then --50%几率，仁者30%二次判定 武骧金星：萧笑竹风林六如有效
		local mc = "六如苍龙诀・"
		if juexing()>0 then
		mc = "六如隼龙诀・"
		end
		local t = math.random(6)
		local p = math.random(6)
		
		--if GetS(10, 0, 11, 0) ~= 1 and JLSD(10, 60, pid) then --4如1-3
		--	t = math.random(3)
		--else
		--	t = math.random(4) --6如1-4
		--end

		if putong() == 6  then --and GetS(10, 0, 11, 0) ~= 1 then --仁者4如2-3
			t = math.random(8) + 1
			p = math.random(8) + 1
		end
		--if putong() == 6 and GetS(10, 0, 11, 0) == 1 and JLSD(25, 75, pid) then --仁者6如2-3
		--	t = math.random(2) + 1
		--end
		--if putong() == 6 and GetS(10, 0, 11, 0) == 1 and (t == 1 or t == 4) and WAR.FLHS6 > 2 then
		--	t = math.random(2) + 1
		--end

		if t >3 and tianshu() >= 1 then -- t判定如风
			WAR.Person[id][CC.TXDH] = 6
			if WAR.Person[id][CC.TXWZ2] ~= nil then
				WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+"..FLHSYL[1];
			else
				WAR.Person[id][CC.TXWZ2] = mc .. FLHSYL[1]    --其疾如风
			end
			WAR.FLHS1 = 1
			for j = 0, WAR.PersonNum - 1 do --如风+队友集气150
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
					WAR.Person[j].Time = WAR.Person[j].Time + 150
				end
				if WAR.Person[j].Time > 980 then
					WAR.Person[j].Time = 980
				end
			end
		end
		if p >3 and tianshu() >= 3 then --p判定如火
			WAR.Person[id][CC.TXDH] = 6
			if WAR.Person[id][CC.TXWZ2] ~= nil then
				WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+"..FLHSYL[3]    --侵略如火
			else
				WAR.Person[id][CC.TXWZ2] = mc .. FLHSYL[3]    --侵略如火
			end
			ng = ng + 3000
			WAR.FLHS3 = 1
		end
		--1和4雷震，50%出，仁者必出
		if ((putong() == 6 and math.random(2) < 2) or (math.random(4) < 2)) and juexing() > 0  and PersonKF(pid, 91) and WAR.FLHS6 < 3 then
			WAR.Person[id][CC.TXDH] = 6
			if WAR.Person[id][CC.TXWZ2] ~= nil then
				WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+"..FLHSYL[6]    --动如雷震
			else
				WAR.Person[id][CC.TXWZ2] = mc .. FLHSYL[6]    --动如雷震
			end
			fightnum = fightnum + 1
			WAR.FLHS6 = WAR.FLHS6 + 1
		end
	end
   
	--如果学会北冥神功或者角色是零二七
    if (PersonKF(pid, 85) or T1LEQ(pid)) and (JLSD(25, 75, pid) or DT(pid, 118) or DT(pid, 116)) then
	    if WAR.Person[id][CC.TXDH] == -1 then
            WAR.Person[id][CC.TXDH] = math.fmod(85, 10) + 85
        end
        if WAR.Person[id][CC.TXWZ2] == nil then
            WAR.Person[id][CC.TXWZ2] = CC.WARS33
        else
            WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+" .. CC.WARS33
        end
        WAR.BMXH = 1
      
        --北冥神功升级
        for w = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
            if JY.Person[pid]["武功" .. w] == 85 then
                JY.Person[pid]["武功等级" .. w] = JY.Person[pid]["武功等级" .. w] + 50
            end
        --if JY.Person[pid]["武功等级" .. w] > 999 then
        --JY.Person[pid]["武功等级" .. w] = 999
        --end
        end
    end
      
    --吸星大法，任我行必触发，与北冥不可同时触发'
	--任盈盈40%二次判定
    if (PersonKF(pid, 88) and (JLSD(25, 75, pid) or (DT(pid, 73) and JLSD(10, 50, pid))) and WAR.BMXH == 0) 
		or DT(pid, 26) then
        if WAR.Person[id][CC.TXDH] == -1 then
            WAR.Person[id][CC.TXDH] = math.fmod(88, 10) + 85
        end
        if WAR.Person[id][CC.TXWZ2] == nil then
            WAR.Person[id][CC.TXWZ2] = CC.WARS34
        else
            WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+" .. CC.WARS34
        end
        WAR.BMXH = 2
      
        --吸星大法升级
        for w = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
            if JY.Person[pid]["武功" .. w] == 88 then
                JY.Person[pid]["武功等级" .. w] = JY.Person[pid]["武功等级" .. w] + 50
            end
            --if JY.Person[pid]["武功等级" .. w] > 999 then
            --JY.Person[pid]["武功等级" .. w] = 999
            --end
        end
    end
    
    --化功大法
	--丁老怪必出
	--阿紫40%二次判定
    if ((PersonKF(pid, 87) or (MPPD(pid) == 1 and MPDJ(pid) == 3)) and 
		WAR.BMXH == 0 and (JLSD(25, 75, pid) or 
		(DT(pid, 47) and JLSD(10, 50, pid)))) or DT(pid, 46) then
      if WAR.Person[id][CC.TXDH] == -1 then
        WAR.Person[id][CC.TXDH] = math.fmod(87, 10) + 85
      end
      if WAR.Person[id][CC.TXWZ2] == nil then
        WAR.Person[id][CC.TXWZ2] = CC.WARS35
      else
        WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+" .. CC.WARS35
      end
      WAR.BMXH = 3
      
      --化功大法升级
      for w = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
        if JY.Person[pid]["武功" .. w] == 87 then
          JY.Person[pid]["武功等级" .. w] = JY.Person[pid]["武功等级" .. w] + 50
        end
        --if JY.Person[pid]["武功等级" .. w] > 999 then
        --  JY.Person[pid]["武功等级" .. w] = 999
        --end
      end
    end
	
	if WAR.TSYXL == 2 then
        if WAR.Person[id][CC.TXDH] == -1 then
            WAR.Person[id][CC.TXDH] = math.fmod(88, 10) + 85
        end
        WAR.BMXH = 4
    end
	
	if DT(pid, 26) then
		if WAR.LQZ[pid] ~= nil and WAR.LQZ[pid] > 0 then
			ng = ng + math.modf(WAR.LQZ[pid] * 20)
		end
	end
	
	--阿青剑法加成
	if DT(pid, 614) and yongjian(wugong) then --阿青剑法加成
		local q = wgnumber(pid, 2)
		ng = ng + 300 * q
	end	
	
	--brolycjw: 独孤求败
    if DT(pid , 592) then
		if WAR.L_DGQB_X < 3 then
			WAR.Person[id][CC.TXDH] = 24
			WAR.Person[id][CC.TXWZ2] = "利剑"
			ng = ng + 1200
		elseif WAR.L_DGQB_X < 5 then
			WAR.Person[id][CC.TXDH] = 48
			WAR.Person[id][CC.TXWZ2] = "软剑"
			ng = ng + 1400		
		elseif WAR.L_DGQB_X < 7 then
			WAR.Person[id][CC.TXDH] = 10
			WAR.Person[id][CC.TXWZ2] = "重剑"
			ng = ng + 1600	
		elseif WAR.L_DGQB_X < 9 then
			WAR.Person[id][CC.TXDH] = 46
			WAR.Person[id][CC.TXWZ2] = "木剑"
			ng = ng + 1800				
		else
			WAR.Person[id][CC.TXWZ2] = "无剑"
			ng = ng + 2000		
		end
    end
    
    --天罡内功为极，发动天罡真气，每多一个内功几率+3
    if pid == 0 and putong() == 5 and yongnei(JY.Person[pid]["武功" .. wugongnum]) then
        if JY.Person[pid]["武功等级" .. wugongnum] >= 999 and JLSD(10, 35 + math.modf(3 * wgnumber(0, 5)), pid) then
            WAR.Person[id][CC.TXWZ3] = CC.WARS39 .. JY.Wugong[JY.Person[pid]["武功" .. wugongnum]]["名称"]
            ng = ng + JY.Wugong[JY.Person[pid]["武功" .. wugongnum]]["攻击力10"]
        end
        if JY.Person[pid]["武功等级" .. wugongnum] >= 999 then
     	 	WAR.WS = 1
    	end
    end
    
    --杨过使用黯然销魂掌60%极意，主角50%极意
	--[[if (JY.Person[pid]["武功" .. wugongnum] == 25 and JY.Person[pid]["武功等级" .. wugongnum] >= 999) and
		((DT(pid, 58) and GetS(86,11,11,5) == 2 and JLSD(10, 70, pid)) 
		or (DT(pid, 0) and putong() == 1 and JLSD(10, 60, pid))) then
        if WAR.Person[id][CC.TXWZ3] ~= nil then
            ng = ng - 1400
        end
        WAR.Person[id][CC.TXWZ3] = "伤心无用 唯别而已 别情若有定 千般煎熬又何如 莫道黯然销魂"  --伤心无用 唯别而已 别情若有定 千般煎熬又何如 莫道黯然销魂
        WAR.Person[id][CC.TXDH] = 84
        ng = ng + 2000
        WAR.WS = 1
        for i = 1, 5 do
            for j = 1, 5 do
                SetWarMap(x + i - 1, y + j - 1, 4, 1)
                SetWarMap(x - i + 1, y + j - 1, 4, 1)
                SetWarMap(x + i - 1, y - j + 1, 4, 1)
                SetWarMap(x - i + 1, y - j + 1, 4, 1)
            end
        end	
	end]]
    
    if (JY.Person[pid]["武功" .. wugongnum] == 21 and JY.Person[pid]["武功等级" .. wugongnum] >= 999) and
		((DT(pid, 643)  and JLSD(10, 70, pid)) or (DT(pid, 644)  and JLSD(10, 70, pid)) 
		or (DT(pid, 0) and putong() == 1 and JLSD(10, 60, pid))) then
        if WAR.Person[id][CC.TXWZ3] ~= nil then
            ng = ng - 1400
        end
        WAR.Person[id][CC.TXWZ3] = "玄冥极意・阴毒灭心"  
        WAR.Person[id][CC.TXDH] = 6
        ng = ng + 2000
        WAR.WS = 1
        for i = 1, 5 do
            for j = 1, 5 do
                SetWarMap(x + i - 1, y + j - 1, 4, 1)
                SetWarMap(x - i + 1, y + j - 1, 4, 1)
                SetWarMap(x + i - 1, y - j + 1, 4, 1)
                SetWarMap(x - i + 1, y - j + 1, 4, 1)
            end
        end	
	end
	
    if (PersonGT(pid,181) and (DT(pid,455))) or (wglw(pid,181) and JLSD(10,40,pid) and PersonGTJL(pid,181,WAR.NGJL)) or DT(pid,600) then	
        WAR.XWZG = WAR.XWZG + 1
	    local WZTS = {"刀","枪","剑","戟","棍","拳","掌","腿","指","爪"}
	    local str = WZTS[WAR.XWZG]
	        if WAR.XWZG >= 10 then
		        WAR.XWZG = 10
		        str = "玄武真功"
		    end
	    if WAR.Person[id][CC.TXWZ1] == nil then
			WAR.Person[id][CC.TXWZ1] = "气劲".."・"..str
		else
			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+".."气劲".."・"..str
		end
	end	
	
	if JY.Person[pid]["武功" .. wugongnum] == 26 and DT(pid, 55) and PersonGT(pid,107) and JX(pid) then
	    WAR.GJQJ=WAR.GJQJ+1
	    local WZTS = {"一重","二重","三重","四重","五重","六重","七重","八重","九重","十重","十一重","十二重","十三重","十四重"}
	    local str=WZTS[WAR.GJQJ]
	    if WAR.GJQJ>=13 then
		    WAR.GJQJ=13
		    str="终极真罡"
		end
	    if WAR.Person[id][CC.TXWZ1] == nil then
			WAR.Person[id][CC.TXWZ1] = "侠气罡劲".."・"..str
		else
			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+".."侠气罡劲".."・"..str
		end
	end
	
	if pid == 0 and zjtype()==4 and juexing()>0 and GetS(10, 0, 11, 0) == 1 and WAR.NGJL>0 then 
	    WAR.GJQJ2=WAR.GJQJ2+1
	    local WZTS = {"飞狐","雪山","连城","天龙","射雕","白马","鹿鼎","笑傲","书剑","神雕","侠客","倚天","碧血","鸳鸯","越女"}
	    local str=WZTS[WAR.GJQJ2]
	    if WAR.GJQJ2>=15 then
		    WAR.GJQJ2=15
		    str="侠客风云"
		end
	    if WAR.Person[id][CC.TXWZ1] == nil then
			WAR.Person[id][CC.TXWZ1] = "宇晶天书诀".."・"..str
		else
			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+".."宇晶天书诀".."・"..str
		end
	end
	
	if DT(pid, 64) and JX(pid) and WAR.ACT==1 then
	    if WAR.ZBT1>0 then
		    ng = ng+(400+WAR.SPIRIT[pid])*WAR.ZBT1
	        local aa=WAR.ZBT1
	        if aa>7 then
	            aa=7
	        end
	        local WZTS = {"天璇","天权","天玑","天枢","玉衡","开阳","瑶光"}
	        local str=WZTS[aa]
	        DHdisplay(456, 469, "空明螺旋拳意")
	        DHdisplay(1747, 1759, aa.."重"..str)
	        if WAR.Person[id][CC.TXWZ1] == nil then
				WAR.Person[id][CC.TXWZ1] = "空明螺旋拳".."・"..str
			else
				WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+".."空明螺旋拳".."・"..str
			end
		        WAR.ZBT2=(aa+1)*(aa+1)
		        WAR.ZBT1=0
	    end
	end
	
	if (wglw(pid, 107) and PersonGT(pid,107)) or DT(pid,599) and WAR.ACT==1 then
	    if WAR.ZBT3>0 then
	        local aa=math.random(2,9)
	        if DT(pid,599) then
	            aa=math.random(7,9)
	        end
	        if aa>9 then
	            aa=9
	        elseif aa<2 then
	            aa=2
	        end
	        local str=aa.."重".."气劲"
	        ng = ng+(WAR.SPIRIT[pid]+300)*aa
	        DHdisplay(456, 469, "螺旋九影")
	        DHdisplay(1747, 1759, str)
	        if WAR.Person[id][CC.TXWZ1] == nil then
				WAR.Person[id][CC.TXWZ1] = "螺旋九影".."・"..str
			else
				WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+".."螺旋九影".."・"..str
			end
		        WAR.ZBT2=aa
		        WAR.ZBT3=0
	    end
	end
	
	if ((wglw(pid, 107) and PersonGT(pid,107) )or DT(pid,599)) and yongquan(wugong) and (JLSD(10,50,pid) or (DT(pid,599)and JLSD(10,50,pid))) then
	    ng = ng+2000
	    if WAR.Person[id][CC.TXWZ1] == nil then
			WAR.Person[id][CC.TXWZ1] = "九阴拳藏.大伏魔拳"
		else
			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+".."九阴拳藏.大伏魔拳"
		end
		    WAR.DFMQ=1
	 end
		
	 if (wglw(pid, 107) or DT(pid,599)) and PersonGT(pid,107) and wugong == 11 then
	 	ng = ng + 1200;
		if WAR.Person[id][CC.TXWZ1] == nil then
			WAR.Person[id][CC.TXWZ1] = "九阴白骨.摧坚神爪"
		else
			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+".."九阴白骨.摧坚神爪"
		end
		WAR.CJSZ=1
		WAR.MCF=1
	end
	
    if wugong == 26 and ((DT(pid,50) or DT(pid,617)) or wglw1(pid,26)) and JY.Person[pid]["武功等级" .. wugongnum] >= 999 and JLSD(10, 60, pid) then	
		fightnum = 6
	    for i = 1, 10 do
            DrawStrBox(-1, 24, CC.WARS134, C_ORANGE, 20 + i)   -- 领悟后50%有余不尽
            ShowScreen()
            lib.Delay(1)
        end
	    if wugong == 26 and ((DT(pid, 50) or DT(pid,617)) or wglw1(pid,26)) and JY.Person[pid]["武功等级" .. wugongnum] >= 999 and WAR.LQZ[pid] == 100 then
            fightnum = 6
	        for i = 1, 10 do
                DrawStrBox(-1, 24, CC.WARS134, C_ORANGE, 20 + i)   -- 领悟后满怒必触发有余不尽
                ShowScreen()
                lib.Delay(1)
            end
	    end
	end
	
    if T3XYK(pid) then --萧雨客雷震九州
		ng = ng + 1000
        WAR.XYKP = 1   
    end	
	
    if hasTF(pid, 144) and JY.Person[pid]["武功等级" .. wugongnum] >= 999 and JLSD(10, 90, pid) then
        if WAR.Person[id][CC.TXWZ3] ~= nil then
            ng = ng - 1400
        end
        WAR.Person[id][CC.TXWZ3] = "苦集灭道" 
        WAR.Person[id][CC.TXDH] = 119
        ng = ng + 1000
        WAR.WS = 1
        for i = 1, 7 do
            for j = 1, 7 do
                SetWarMap(x + i - 1, y + j - 1, 4, 1)
                SetWarMap(x - i + 1, y + j - 1, 4, 1)
                SetWarMap(x + i - 1, y - j + 1, 4, 1)
                SetWarMap(x - i + 1, y - j + 1, 4, 1)
            end
        end
    end 
	
    if MPPD(pid) == 18 and PersonGT(pid,189) and JLSD(20, 60, pid) then 
	    if WAR.KTFT == 1 and yongquan(wugong) then
			local zq = JY.Person[pid]["拳掌功夫"] / 150
			local zq2 = JY.Person[pid]["拳掌功夫"]
			if WAR.Person[id][CC.TXWZ2] ~= nil then
				WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].."+".."三焦齐逆兮魂魄飞扬"
			else
				WAR.Person[id][CC.TXWZ2] = "三焦齐逆兮魂魄飞扬"
			end
			ng = ng + zq2 * 3
			WAR.WS = 1
			for i = 1, 1+zq do
				for j = 1, 1+zq do
					SetWarMap(x + i - 1, y + j - 1, 4, 1)
					SetWarMap(x - i + 1, y + j - 1, 4, 1)
					SetWarMap(x + i - 1, y - j + 1, 4, 1)
					SetWarMap(x - i + 1, y - j + 1, 4, 1)
				end
			end
		elseif WAR.KTFT == 2 and yongte(wugong) then
			local zq = JY.Person[pid]["特殊兵器"] / 150
			local zq2 = JY.Person[pid]["特殊兵器"]
			if WAR.Person[id][CC.TXWZ2] ~= nil then
				WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].."+".."三焦齐逆兮魂魄飞扬"
			else
				WAR.Person[id][CC.TXWZ2] = "三焦齐逆兮魂魄飞扬"
			end
			ng = ng + zq2 * 3
			WAR.WS = 1
			for i = 1, 1+zq do
				for j = 1, 1+zq do
					SetWarMap(x + i - 1, y + j - 1, 4, 1)
					SetWarMap(x - i + 1, y + j - 1, 4, 1)
					SetWarMap(x + i - 1, y - j + 1, 4, 1)
					SetWarMap(x - i + 1, y - j + 1, 4, 1)
				end
			end
		elseif WAR.KTFT == 3 and yongan(wugong) then
			local zq = JY.Person[pid]["暗器技巧"] / 150
			local zq2 = JY.Person[pid]["暗器技巧"]
			if WAR.Person[id][CC.TXWZ2] ~= nil then
				WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].."+".."三焦齐逆兮魂魄飞扬"
			else
				WAR.Person[id][CC.TXWZ2] = "三焦齐逆兮魂魄飞扬"
			end
			ng = ng + zq2 * 3
			WAR.WS = 1
			for i = 1, 1+zq do
				for j = 1, 1+zq do
					SetWarMap(x + i - 1, y + j - 1, 4, 1)
					SetWarMap(x - i + 1, y + j - 1, 4, 1)
					SetWarMap(x + i - 1, y - j + 1, 4, 1)
					SetWarMap(x - i + 1, y - j + 1, 4, 1)
				end
			end
		end	
    end	
	
	 if wugong == 24 and (DT(pid,615) or wglw1(pid,24)) and WAR.LQZ[pid] == 100 then 
	    if fightnum < 2 then
			fightnum = 2 
		end	
		if WAR.Person[id][CC.TXWZ1] ~= nil then
		    WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+".."灭罪真言・莲华洗秽"
	    else
		    WAR.Person[id][CC.TXWZ1] = "灭罪真言・莲华洗秽"
	    end
        if JLSD(10,60,pid) and not (MPPD(pid) == 5 and MPDJ(pid) > 2 and PersonGT(pid,108)) then
		ng = ng + 2000
        WAR.WS = 1
        for i = 1, 6 do
            for j = 1, 6 do
                SetWarMap(x + i - 1, y + j - 1, 4, 1)
                SetWarMap(x - i + 1, y + j - 1, 4, 1)
                SetWarMap(x + i - 1, y - j + 1, 4, 1)
                SetWarMap(x - i + 1, y - j + 1, 4, 1)
            end
        end
		end
    end
	
	if wugong == 25 and (DT(pid, 58) or wglw1(pid,25)) and JY.Person[pid]["武功" .. wugongnum] == 25 and JY.Person[pid]["武功等级" .. wugongnum] >= 999 and JLSD(10, 85, pid) then
		JY.Person[pid]["内力"] = math.modf(JY.Person[pid]["内力"] * 0.95)
        if WAR.Person[id][CC.TXWZ3] ~= nil then
            ng = ng - 4000
        end
        WAR.Person[id][CC.TXWZ3] = "黯然销魂・魂牵梦萦" 
        WAR.Person[id][CC.TXDH] = 120
        ng = ng + 2000
        WAR.WS = 1
        for i = 1, 7 do
            for j = 1, 7 do
                SetWarMap(x + i - 1, y + j - 1, 4, 1)
                SetWarMap(x - i + 1, y + j - 1, 4, 1)
                SetWarMap(x + i - 1, y - j + 1, 4, 1)
                SetWarMap(x - i + 1, y - j + 1, 4, 1)
            end
        end
        if WAR.ARJX > 0 then
		    WAR.YANGKANG = 1
	    end	
	end					
	
    if wugong == 21 and ((DT(pid, 643) or DT(pid, 644)) or wglw1(pid,21)) and JLSD(10, 60, pid) then	
	    if WAR.Person[id][CC.TXWZ3] ~= nil then
            ng = ng - 1000
        end
        WAR.Person[id][CC.TXWZ3] = "玄冥・奇寒透骨" 
        ng = ng + 2000
        WAR.WS = 1
        for i = 1, 5 do
            for j = 1, 5 do
                SetWarMap(x + i - 1, y + j - 1, 4, 1)
                SetWarMap(x - i + 1, y + j - 1, 4, 1)
                SetWarMap(x + i - 1, y - j + 1, 4, 1)
                SetWarMap(x - i + 1, y - j + 1, 4, 1)
            end
        end
		WAR.XMHJ = 1
    end	
	--煌煌道威
	if WAR.HHDW1 == 1 and wglw2(pid,115) then	
	    if WAR.Person[id][CC.TXWZ2] ~= nil then
            ng = ng - 1000
        end
        if WAR.Person[id][CC.TXWZ2] ~= nil then
		    WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].."+".."煌煌道威・封魔玄坤"
	    else
		    WAR.Person[id][CC.TXWZ2] = "煌煌道威・封魔玄坤"
	    end 
        ng = ng + 2000
        WAR.WS = 1
        for i = 1, 7 do
            for j = 1, 7 do
                SetWarMap(x + i - 1, y + j - 1, 4, 1)
                SetWarMap(x - i + 1, y + j - 1, 4, 1)
                SetWarMap(x + i - 1, y - j + 1, 4, 1)
                SetWarMap(x - i + 1, y - j + 1, 4, 1)
            end
        end
    end
	
	if wugong == 83 and wglw1(pid,83) and JLSD(10, 90, pid) then	
	    if WAR.Person[id][CC.TXWZ2] ~= nil then
            ng = ng - 1000
        end
        if WAR.Person[id][CC.TXWZ2] ~= nil then
		    WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].."+".."大力真禅"
	    else
		    WAR.Person[id][CC.TXWZ2] = "一大三千・大力真禅"
	    end
        ng = ng + 2000
        WAR.WS = 1
        if JY.Person[pid]["内力"] <= 10000 and JY.Person[pid]["内力"] >= 8000 then 
			for i = 1, 12 do
				for j = 1, 12 do
					SetWarMap(x + i - 1, y + j - 1, 4, 1)
					SetWarMap(x - i + 1, y + j - 1, 4, 1)
					SetWarMap(x + i - 1, y - j + 1, 4, 1)
					SetWarMap(x - i + 1, y - j + 1, 4, 1)
				end
			end
		elseif JY.Person[pid]["内力"] < 8000 and JY.Person[pid]["内力"] >= 6000 then
			for i = 1, 10 do
				for j = 1, 10 do
					SetWarMap(x + i - 1, y + j - 1, 4, 1)
					SetWarMap(x - i + 1, y + j - 1, 4, 1)
					SetWarMap(x + i - 1, y - j + 1, 4, 1)
					SetWarMap(x - i + 1, y - j + 1, 4, 1)
				end
			end
		elseif JY.Person[pid]["内力"] < 6000 and JY.Person[pid]["内力"] >= 4000 then
			for i = 1, 8 do
				for j = 1, 8 do
					SetWarMap(x + i - 1, y + j - 1, 4, 1)
					SetWarMap(x - i + 1, y + j - 1, 4, 1)
					SetWarMap(x + i - 1, y - j + 1, 4, 1)
					SetWarMap(x - i + 1, y - j + 1, 4, 1)
				end
			end		
		elseif JY.Person[pid]["内力"] < 4000 then
			for i = 1, 6 do
				for j = 1, 6 do
					SetWarMap(x + i - 1, y + j - 1, 4, 1)
					SetWarMap(x - i + 1, y + j - 1, 4, 1)
					SetWarMap(x + i - 1, y - j + 1, 4, 1)
					SetWarMap(x - i + 1, y - j + 1, 4, 1)
				end
			end
		end
    end
		
	if wugong == 78 and wglw1(pid,78) and JY.Person[pid]["武器"] == 307 then 
		for i = 1, 4 do
			for j = 1, 4 do
				SetWarMap(x + i - 1, y + j - 1, 4, 1)
				SetWarMap(x - i + 1, y + j - 1, 4, 1)
				SetWarMap(x + i - 1, y - j + 1, 4, 1)
				SetWarMap(x - i + 1, y - j + 1, 4, 1)
			end
		end
        if wglw(pid,107) and PersonGTJL(pid, 107, WAR.NGJL) and JLSD(10, 35, pid) then 
		ng = ng + 1000
		WAR.WS = 1
		WAR.BMSZ = 1
		DHdisplay(3255, 3277, "白蟒沙阵",M_White)
			for i = 1, 7 do
				for j = 1, 7 do
					SetWarMap(x + i - 1, y + j - 1, 4, 1)
					SetWarMap(x - i + 1, y + j - 1, 4, 1)
					SetWarMap(x + i - 1, y - j + 1, 4, 1)
					SetWarMap(x - i + 1, y - j + 1, 4, 1)
				end
			end
		end	
    end
	
	--铁掌 纯阳一气
	--[[if WAR.CYANGZ == 1 and wglw1(pid,13) then	 
        local aa= math.ceil(sixi(pid,1)/100)
		if aa > 7 then aa = 7 end
		fightnum = aa - 1
	end	
	if wugong == 13 and wglw1(pid,13) and WAR.ACT > 3 then
		local aa = WAR.ACT
		ng = ng + 2000
		WAR.WS = 1
		for i = 1, (3+aa) do
			for j = 1, (3+aa) do
				SetWarMap(x + i - 1, y + j - 1, 4, 1)
				SetWarMap(x - i + 1, y + j - 1, 4, 1)
				SetWarMap(x + i - 1, y - j + 1, 4, 1)
				SetWarMap(x - i + 1, y - j + 1, 4, 1)
			end
		end
	end]]
	
	if (wglw1(pid,68) and wugong == 68) or (T9ZY(pid) and wugong == 112 and wglw1(pid,68)) then
		if fightnum < 3 and WAR.ACT == 1 and  JLSD(10,40,pid) then
			fightnum = fightnum + 3
		end	
		if WAR.ACT > 1 then
			local aa = WAR.ACT
			ng = ng + 2000
			WAR.WS = 1
			for i = 1, (3+aa) do
				for j = 1, (3+aa) do
					SetWarMap(x + i - 1, y + j - 1, 4, 1)
					SetWarMap(x - i + 1, y + j - 1, 4, 1)
					SetWarMap(x + i - 1, y - j + 1, 4, 1)
					SetWarMap(x - i + 1, y - j + 1, 4, 1)
				end
			end
		end	
	end
	
	if wugong == 86 and (DT(pid, 615) or wglw1(pid,86)) and JY.Person[pid]["武功等级" .. wugongnum] >= 999 and JLSD(10, 60, pid) then
		WAR.Person[id][CC.TXWZ3] = "伏魔杖法・秦王鞭石" 
        WAR.Person[id][CC.TXDH] = 120
        ng = ng + 1000
		WAR.BFX = 1
	    WAR.BLX = 1
	    WAR.BBF = 1
	    WAR.BZS = 1
		WAR.WS = 1
		for i = 1, 5 do
			for j = 1, 5 do
				SetWarMap(x + i - 1, y + j - 1, 4, 1)
				SetWarMap(x - i + 1, y + j - 1, 4, 1)
				SetWarMap(x + i - 1, y - j + 1, 4, 1)
				SetWarMap(x - i + 1, y - j + 1, 4, 1)
			end
		end	
    end	
	
    if wugong == 86 and DT(pid, 457) and JY.Person[pid]["武功等级" .. wugongnum] >= 999 then  --凡总自带
		WAR.Person[id][CC.TXWZ3] = "伏魔杖法・秦王鞭石" 
        WAR.Person[id][CC.TXDH] = 120
        ng = ng + 1000
		WAR.BFX = 1
	    WAR.BLX = 1
	    WAR.BBF = 1
	    WAR.BZS = 1
		WAR.WS = 1
		for i = 1, 5 do
			for j = 1, 5 do
				SetWarMap(x + i - 1, y + j - 1, 4, 1)
				SetWarMap(x - i + 1, y + j - 1, 4, 1)
				SetWarMap(x + i - 1, y - j + 1, 4, 1)
				SetWarMap(x - i + 1, y - j + 1, 4, 1)
			end
		end	
    end		
	
    if wugong == 23 and ((DT(pid, 8) or DT(pid, 167) or DT(pid, 168)) or wglw1(pid,23) or DT(pid, 603)) and JY.Person[pid]["武功等级" .. wugongnum] >= 999 and JLSD(10, 75, pid) then	
		WAR.Person[id][CC.TXWZ2] = "七伤拳劲" 
        WAR.Person[id][CC.TXDH] = 51
        ng = ng + 1500
		WAR.BFX = 1
	    WAR.BLX = 1
	    WAR.BBF = 1
	    WAR.BZS = 1
		WAR.WS = 1
		for i = 1, 6 do
			for j = 1, 6 do
				SetWarMap(x + i - 1, y + j - 1, 4, 1)
				SetWarMap(x - i + 1, y + j - 1, 4, 1)
				SetWarMap(x + i - 1, y - j + 1, 4, 1)
				SetWarMap(x - i + 1, y - j + 1, 4, 1)
			end
		end	
    end	
	
    if WAR.HYZF == 4 then 	 
        ng = ng + 1200
		for i = 1, 5 do
			for j = 1, 5 do
				SetWarMap(x + i - 1, y + j - 1, 4, 1)
				SetWarMap(x - i + 1, y + j - 1, 4, 1)
				SetWarMap(x + i - 1, y - j + 1, 4, 1)
				SetWarMap(x - i + 1, y - j + 1, 4, 1)
			end
		end	
	end	
	
	if wugong == 40 and WAR.JSFJ == 2 then
		fightnum = 1
		ng = ng + 1200
		for i = 1, 8 do
			for j = 1, 8 do
				SetWarMap(x + i - 1, y + j - 1, 4, 1)
				SetWarMap(x - i + 1, y + j - 1, 4, 1)
				SetWarMap(x + i - 1, y - j + 1, 4, 1)
				SetWarMap(x - i + 1, y - j + 1, 4, 1)
			end
		end
	end	
	
    if NF(pid) and yongdao(wugong) and JLSD(10, 40, pid) then
		WAR.Person[pid][CC.TXWZ2] = "踏雪寻梅" 
		WAR.BFX = 1
	    WAR.BLX = 1
	    WAR.BBF = 1
	    WAR.BZS = 1
		WAR.WS = 1
		for i = 1, 5 do
			for j = 1, 5 do
				SetWarMap(x + i - 1, y + j - 1, 4, 1)
				SetWarMap(x - i + 1, y + j - 1, 4, 1)
				SetWarMap(x + i - 1, y - j + 1, 4, 1)
				SetWarMap(x - i + 1, y - j + 1, 4, 1)
			end
		end	
    end		
	
	if wugong == 8 and ((DT(pid, 618) or DT(pid, 116)) or wglw1(pid,8)) and JY.Person[pid]["武功等级" .. wugongnum] >= 999 and (JLSD(10, 60, pid) or WAR.LQZ[pid] == 100) then
		WAR.Person[id][CC.TXWZ3] = "日斜归路晚霞明" 
        WAR.Person[id][CC.TXDH] = 144
        ng = ng + 1000
		WAR.WS = 1
		for i = 1, 7 do
			for j = 1, 7 do
				SetWarMap(x + i - 1, y + j - 1, 4, 1)
				SetWarMap(x - i + 1, y + j - 1, 4, 1)
				SetWarMap(x + i - 1, y - j + 1, 4, 1)
				SetWarMap(x - i + 1, y - j + 1, 4, 1)
			end
		end	
    end	
	
    if wugong == 177 and (DT(pid, 27) or wglw1(pid,177)) and JY.Person[pid]["武功等级" .. wugongnum] >= 999 and JLSD(10, 60, pid) then	
		if WAR.Person[id][CC.TXWZ3] ~= nil then
            ng = ng - 2500
        end
        WAR.Person[id][CC.TXWZ1] = "葵花神针・空蝉" 
        WAR.Person[id][CC.TXDH] = 60
        ng = ng + 2000
        WAR.WS = 1
        for i = 1, 6 do
            for j = 1, 6 do
                SetWarMap(x + i - 1, y + j - 1, 4, 1)
                SetWarMap(x - i + 1, y + j - 1, 4, 1)
                SetWarMap(x + i - 1, y - j + 1, 4, 1)
                SetWarMap(x - i + 1, y - j + 1, 4, 1)
            end
        end
	end	
	
    if wugong == 46 and (DT(pid, 5) or wglw1(pid,46)) and JY.Person[pid]["武功等级" .. wugongnum] >= 999 and JLSD(10, 80, pid) then
        if WAR.Person[id][CC.TXWZ3] ~= nil then
            ng = ng - 2500
        end
        WAR.Person[id][CC.TXWZ3] = "太极剑法・太极圆转" 
        WAR.Person[id][CC.TXDH] = 57
        ng = ng + 2500
        WAR.WS = 1
        WAR.JLDL2 = 5
	end	
	
    if wugong == 16 and (DT(pid, 5) or wglw1(pid,16)) and JY.Person[pid]["武功等级" .. wugongnum] >= 999 and (JLSD(10, 80, pid) or WAR.TQFJ == -1) then
        if WAR.Person[id][CC.TXWZ3] ~= nil then
            ng = ng - 2500
        end
        WAR.Person[id][CC.TXWZ3] = "太极拳法・圆融之道" 
        WAR.Person[id][CC.TXDH] = 29
        ng = ng + 2500
        WAR.WS = 1
        for i = 1, 7 do
            for j = 1, 7 do
                SetWarMap(x + i - 1, y + j - 1, 4, 1)
                SetWarMap(x - i + 1, y + j - 1, 4, 1)
                SetWarMap(x + i - 1, y - j + 1, 4, 1)
                SetWarMap(x - i + 1, y - j + 1, 4, 1)
            end
        end
	end		
	
	if wglw2(pid,198) and PersonKF(pid,198) and JLSD(10,70,pid) then
		local aa = math.modf(JY.Person[pid]["品德"]/10)
		if aa > 8 then aa = 8 end
		WAR.JZFLW = 1
		WAR.Person[id][CC.TXWZ2] = "君子风・治国平世" 
        WAR.Person[id][CC.TXDH] = 51
		if yongjian(wugong) then
			ng = ng + 2500
			WAR.WS = 1
			for i = 1, aa do
				for j = 1, aa do
					SetWarMap(x + i - 1, y + j - 1, 4, 1)
					SetWarMap(x - i + 1, y + j - 1, 4, 1)
					SetWarMap(x + i - 1, y - j + 1, 4, 1)
					SetWarMap(x - i + 1, y - j + 1, 4, 1)
				end
			end
		end	
	end
	
	if (GB(pid)==2 or DT(pid, 69)) and yongte(wugong) then
	    WAR.GBLJ[pid]=WAR.GBLJ[pid] or 0 + 1
	end
	
    --使用降龙十八掌
	if JY.Person[pid]["武功" .. wugongnum] == 26 then
        if DT(pid, 55) and PersonGT(pid,107)  and JX(pid) then
	        ng = ng + 200*WAR.GJQJ
	    end  	
	    if (GB(pid)==3 or DT(pid, 69)) and ((WAR.ACT==1 and JLSD(10, 60, pid)) or (DT(pid, 55) and PersonGT(pid,107)  and JX(pid) and JLSD(10, 20+WAR.GJQJ*5, pid))) then
		    if WAR.Person[id][CC.TXWZ1] == nil then
				WAR.Person[id][CC.TXWZ1] = "傲血战意".."真・"..XL18JY[math.random(8)]
			else
				WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+".."傲血战意.".."真・"..XL18JY[math.random(8)]
			end
		    WAR.Person[id][CC.TXDH] = 89
            if WAR.Person[id][CC.TXWZ3] ~= nil then
                ng = ng - 500
            end
	        ng = ng + WAR.SPIRIT[pid]*30
	    CleanWarMap(4, 0)
		for i = 0, WAR.PersonNum - 1 do
			if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
				SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
			end
		end	
		WAR.WS = 1
		WAR.ASKD1=1
		WAR.GBXL=1
	--乔峰必出极意，郭靖有(40%)，洪七公50%，拳主角40%
	elseif ((DT(pid, 50) or DT(pid, 617)) or wglw1(pid,26)) or (DT(pid, 55) and JLSD(10, 50, pid)) or (DT(pid, 69) and JLSD(10, 60, pid)) or 
		((pid == 0 and putong() == 1 and JY.Person[pid]["武功等级" .. wugongnum] >= 999) 
		and JLSD(10, 50, pid)) or (getHZ(pid, 33) and JLSD(10, 30, pid)) or (PersonKF(pid, 26) and JLSD(10, 30, pid)) or
		(DT(pid, 49) and JLSD(0, 100, pid)) then
		if WAR.Person[id][CC.TXWZ3] == nil then
			WAR.Person[id][CC.TXWZ3] = XL18JY[math.random(8)]
		else
			WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+"..XL18JY[math.random(8)]
		end
		ng = ng + 2300
		WAR.WS = 1
		for i = 1, (level) / 2 + 1 do
			for j = 1, (level) / 2 + 1 do
				SetWarMap(x + i - 1, y + j - 1, 4, 1)
				SetWarMap(x - i + 1, y + j - 1, 4, 1)
				SetWarMap(x + i - 1, y - j + 1, 4, 1)
				SetWarMap(x - i + 1, y - j + 1, 4, 1)
			end
		end
	elseif JLSD(10, 10 + attribRandom(pid, level, 1), pid) then	--降龙小极意跟攻击力挂钩
		if WAR.Person[id][CC.TXWZ3] == nil then
			WAR.Person[id][CC.TXWZ3] = XL18[math.random(6)]
		else
			WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+"..XL18[math.random(6)]
		end		
		ng = ng + 1800
		for i = 1, (1 + (level)) / 2 do
			for j = 1, (1 + (level)) / 2 do
				SetWarMap(WAR.Person[WAR.CurID]["坐标X"] + i * 2 - 1, WAR.Person[WAR.CurID]["坐标Y"] + j * 2 - 1, 4, 1)
				SetWarMap(WAR.Person[WAR.CurID]["坐标X"] - i * 2 + 1, WAR.Person[WAR.CurID]["坐标Y"] + j * 2 - 1, 4, 1)
				SetWarMap(WAR.Person[WAR.CurID]["坐标X"] + i * 2 - 1, WAR.Person[WAR.CurID]["坐标Y"] - j * 2 + 1, 4, 1)
				SetWarMap(WAR.Person[WAR.CurID]["坐标X"] - i * 2 + 1, WAR.Person[WAR.CurID]["坐标Y"] - j * 2 + 1, 4, 1)
			end
		end
	elseif GB(pid)==2 then
	    WAR.GBLJ[pid]=WAR.GBLJ[pid] or 0 + 1
		if JLSD(10,40,pid) then
	        WAR.GBLJ[pid]=WAR.GBLJ[pid] or 0 + 1
	        if WAR.Person[id][CC.TXWZ3] == nil then 
                WAR.Person[id][CC.TXWZ3] = "奥义.猛龙过江"   
	        else 
	            WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+".."奥义.猛龙过江"
	        end
            WAR.Person[id][CC.TXDH] = 43
	   end
	else	
		end
	end
	if pid == 0 and zjtype()==4 and juexing()>0 and GetS(10, 0, 11, 0) == 1 and WAR.GJQJ2>0 then
	    ng = ng + 200*WAR.GJQJ2
	end  	 	
	
	if DT(pid,600) and yongquan(wugong) then
		WAR.Person[id][CC.TXDH] = 6
		if WAR.Person[id][CC.TXWZ2] ~= nil then
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .."+玄武真功・山海拳经"
		else
			WAR.Person[id][CC.TXWZ2] = "玄武真功・山海拳经"
		end
			ng = ng + 5000
	end	
	
    if DT(pid,600) and yongjian(wugong) then
		WAR.Person[id][CC.TXDH] = 6
		if WAR.Person[id][CC.TXWZ2] ~= nil then
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .."+玄武真功・天命剑道"
		else
			WAR.Person[id][CC.TXWZ2] = "玄武真功・天命剑道"
		end
			ng = ng + 5000
	end	
	
	if DT(pid,600) and yongdao(wugong) then
		WAR.Person[id][CC.TXDH] = 6
		if WAR.Person[id][CC.TXWZ2] ~= nil then
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .."+玄武真功・无二刀法"
		else
			WAR.Person[id][CC.TXWZ2] = "玄武真功・无二刀法"
		end
			ng = ng + 5000
	end	
	
    if DT(pid,600) and yongte(wugong) then
		WAR.Person[id][CC.TXDH] = 6
		if WAR.Person[id][CC.TXWZ2] ~= nil then
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .."+玄武真功・虎啸棍集"
		else
			WAR.Person[id][CC.TXWZ2] = "玄武真功・虎啸棍集"
		end
			ng = ng + 5000
	end		
	
    if DT(pid,600) and yongan(wugong) then
		WAR.Person[id][CC.TXDH] = 6
		if WAR.Person[id][CC.TXWZ2] ~= nil then
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .."+玄武真功・圆融金指"
		else
			WAR.Person[id][CC.TXWZ2] = "玄武真功・圆融金指"
		end
			ng = ng + 5000
	end		
	
    if DT(pid,600) and yongnei(wugong) then
		WAR.Person[id][CC.TXDH] = 6
		if WAR.Person[id][CC.TXWZ2] ~= nil then
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .."+玄武真功・玄门捣虚"
		else
			WAR.Person[id][CC.TXWZ2] = "玄武真功・玄门捣虚"
		end
			ng = ng + 5000
	end		
	
		--使用六脉神剑
    if JY.Person[pid]["武功" .. wugongnum] == 49 then
    	--学会一阳指，60%的机率出六脉大招，如果是段誉学一阳指必出, 朱九真30%二次判定
     	if (PersonKF(pid, 17) or MPPD(pid)==15) and (JLSD(20, 80, pid) or DT(pid, 53) 
			or (DT(pid, 81) and math.random(10) <= 3)) and DT(pid, 602) then
			WAR.LMSJ=math.random(7)
	    if WAR.LMSJ == 7 then----
			local num = 6;
    	    local n = 0;
    	    local person = {};
    	--清掉之前的范围
  		--CleanWarMap(4, 0)
  		
  		--判断全场人数
        for i = 0, WAR.PersonNum - 1 do
            if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
                n = n + 1
				person[n] = i; 
            end
        end
      
        --根据不同的X攻击不同的敌人
        if n <= num then
      	    for i=1, n do
      		    SetWarMap(WAR.Person[person[i]]["坐标X"], WAR.Person[person[i]]["坐标Y"], 4, 1)
      	    end
        else
      	    while num > 0 do
				local t = math.random(n);
				if person[t] ~= nil then
					SetWarMap(WAR.Person[person[t]]["坐标X"], WAR.Person[person[t]]["坐标Y"], 4, 1)
					person[t] = nil;
					num = num - 1;
				end
      	    end
        end
	end		
	if WAR.Person[id][CC.TXWZ3] == nil then
		WAR.Person[id][CC.TXWZ3] = "真."..LMSJ[WAR.LMSJ]
	else
		WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+".."真."..LMSJ[WAR.LMSJ]
	end					
		ng = ng + 2300
	--if DT(pid, 53) then   --段誉六脉音效
		WAR.LMSJwav = 1
		WAR.WS = 1
	--end
    --如果没学会一阳指，大招与于轻功挂钩
    elseif JLSD(10, 10 + attribRandom(pid, level, 3), pid) or DT(pid, 53) and math.random(10) < 6 then
		if WAR.Person[id][CC.TXWZ3] == nil then
			WAR.Person[id][CC.TXWZ3] = LMSJ[math.random(6)]
		else
			WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+"..LMSJ[math.random(6)]
		end		
			ng = ng + 1800
		--if DT(pid, 53) then
			WAR.LMSJwav = 1
		--end
		end
    end

	if pid == 0 and T10XXZ(0) and juexing() > 2 then
		if WAR.Person[id][CC.TXWZ3] == nil then
			WAR.Person[id][CC.TXWZ3] = "神并天地"
		else
			WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+".."神并天地"
		end
		WAR.WS = 1
		for i = 1, (level) / 2 + 1 do
			for j = 1, (level) / 2 + 1 do
				SetWarMap(x + i - 1, y + j - 1, 4, 1)
				SetWarMap(x - i + 1, y + j - 1, 4, 1)
				SetWarMap(x + i - 1, y - j + 1, 4, 1)
				SetWarMap(x - i + 1, y - j + 1, 4, 1)
			end
		end	
	end
	
    --主功体加力追加杀集气  
	for i = 1, #CC.ZGT6 do
		if (CC.ZGT6[i][1] == wugong or (T12YMZ(pid) and wugong == 112)) and (PersonGTJL(pid, CC.ZGT6[i][2], WAR.NGJL) or ((PersonGTJL(pid,9999, WAR.NGJL) and (JY.Thing[224]["加攻击力"]) == CC.ZGT6[i][2] or JY.Thing[224]["加防御力"]) == CC.ZGT6[i][2])) then
			WAR.GTSHAQI = CC.ZGT6[i][3]
			WAR.GTPID2 = pid 			
			break
		end
	end
    --1-26-and (PersonGTJL(pid, CC.ZGT6[i][2], WAR.NGJL) or ((PersonGTJL(pid,9999, WAR.NGJL) and (JY.Thing[224]["加攻击力"]) == CC.ZGT6[i][2] or JY.Thing[224]["加防御力"]) == CC.ZGT6[i][2])) then
	for i = 1, #CC.ZGT6 do
		if (CC.ZGT6[i][1] ==  WAR.HLTX or CC.ZGT6[i][2] ==  WAR.HLTX) and (wglw(pid,102) or (DT(pid,38) and PersonKF(pid,102))) then
			WAR.GTSHAQI = CC.ZGT6[i][3]
			WAR.GTPID2 = pid 			
			break
		end
	end
	--豸苗：折梅手 
	for i = 1, #CC.ZGT6 do
	    for l = 1,10 do
	    local jl = 15 + math.modf(JY.Person[pid]["实战"] / 20)+ math.modf(JY.Person[pid]["武学常识"] / 10)
	        if wugong == 14 and (JLSD(0,5+jl,pid) or (MPPD(pid)==7 and JLSD(0,15,pid))) and JY.Person[pid]["内力"] >= 7000 then
	            if JY.Person[pid]["武功" .. l] == CC.ZGT6[i][1] then
			        WAR.GTSHAQI = CC.ZGT6[i][3]
			        WAR.GTPID2 = pid 	
                    WAR.ZMS = 1			
			        break
		        end
		    end
	    end
	end
	
	for i = 1, #CC.WPSQ do
		if CC.WPSQ[i][1] == JY.Person[pid]["武器"] and CC.WPSQ[i][2] == wugong then
			WAR.GTSHAQI = WAR.GTSHAQI + CC.WPSQ[i][3]
			WAR.GTPID2 = pid 			
			break
		end
	end	
	
	if WAR.DFWM2 == 4 and T7DFWM(pid) then --东方未明特系特技必杀气200
		WAR.GTSHAQI = WAR.GTSHAQI + 200
		WAR.GTPID2 = pid 
	end	
	
	--虚竹降龙掌
    if wugong == 26 and (DT(pid,49) or DT(pid,617)) then	
		WAR.GTSHAQI = WAR.GTSHAQI + 500
		WAR.GTPID2 = pid 
	end	
	
	if MPPD(pid) == 4 and MPDJ(pid) >= 2 and WAR.WJ[pid] ~= nil then --武当无极
		WAR.GTSHAQI = WAR.GTSHAQI + WAR.WJ[pid]
		WAR.GTPID2 = pid
	    if DT(pid,5) and WAR.TJZX2>1 then
	        WAR.GTSHAQI = WAR.GTSHAQI +WAR.WJ[pid]*(WAR.TJZX2-1)
	    end
        if PersonGT(pid, 99) or PersonGT(pid,182) then
            WAR.WJ[pid] = math.modf(WAR.WJ[pid]*0.9)
        else		
		    WAR.WJ[pid] = nil
		end
		if WAR.Person[id][CC.TXWZ3] == nil then
			WAR.Person[id][CC.TXWZ3] = "无极"
		else
			WAR.Person[id][CC.TXWZ3] = "无极・"..WAR.Person[id][CC.TXWZ3]
		end		
	end
	
    --主功体杀怒气
	for i = 1, #CC.ZGT1 do
		if (CC.ZGT1[i][1] == wugong or (T12YMZ(pid) and wugong == 112)) and (PersonGTJL(pid, CC.ZGT1[i][2], WAR.NGJL) or ((PersonGTJL(pid,9999, WAR.NGJL) and (JY.Thing[224]["加攻击力"]) == CC.ZGT1[i][2] or JY.Thing[224]["加防御力"]) == CC.ZGT1[i][2])) then
			WAR.GTNUQI = WAR.GTNUQI + CC.ZGT1[i][3]
			break
		end
	end
    --1-26-and (PersonGTJL(pid, CC.ZGT1[i][2], WAR.NGJL) or ((PersonGTJL(pid,9999, WAR.NGJL) and (JY.Thing[224]["加攻击力"]) == CC.ZGT1[i][2] or JY.Thing[224]["加防御力"]) == CC.ZGT1[i][2])) then
	for i = 1, #CC.ZGT1 do
		if (CC.ZGT1[i][1] ==  WAR.HLTX or CC.ZGT1[i][2] ==  WAR.HLTX) and (wglw(pid,102) or (DT(pid,38) and PersonKF(pid,102))) then
			WAR.GTNUQI = WAR.GTNUQI + CC.ZGT1[i][3]
			break
		end
	end
    --豸苗：折梅手
	for i = 1, #CC.ZGT1 do
	    for l = 1,10 do
	        local jl = 15 + math.modf(JY.Person[pid]["实战"] / 20)+ math.modf(JY.Person[pid]["武学常识"] / 10)
	        if wugong == 14 and (JLSD(0,5+jl,pid) or (MPPD(pid)==7 and JLSD(0,15,pid))) and JY.Person[pid]["内力"] >= 7000 then
	            if JY.Person[pid]["武功" .. l] == CC.ZGT1[i][1] then
			        WAR.GTNUQI = WAR.GTNUQI + CC.ZGT1[i][3]
			        WAR.ZMS = 1
			        break
		        end
		    end
	    end
	end
    
    --狄云，神经照，(75-25)%特效
    if DT(pid , 37) and wugong == 94 and JY.Person[pid]["武功等级" .. wugongnum] >= 999 and JLSD(25, 75, pid) then
        WAR.Person[id][CC.TXWZ3] = CC.WARS43
        ng = ng + math.modf(JY.Person[pid]["内力"] / 40)
	    WAR.ASKD1=1
	    if fightnum<3 then
	        fightnum=3
	    end
    end
	
	if MPPD(pid) == 1 and JLSD(10, 45 + 10*MPDJ(pid), pid) then 
		WAR.SYWGZ = 1
		if  PersonKF(pid, 87) then
		    WAR.SYWGZ = 2
		end
	end
	
	if pid==0 and putong() == 9 and WAR.LXZT[0]~=nil and math.random(10)<5 
		and juexing() > 0 then --观武后血海飘零40%加集气
		WAR.Person[id][CC.TXWZ1]="血海飘零"
		WAR.Person[id][CC.TXDH]=14
		WAR.XHPL=1
	end
	
	if pid == 0 and putong() == 3 and --刀系狂刀决
		PersonKFJ(0, 64) and JLSD(10, 50, pid) and sixi(pid, 3) >= 120 then
		local aa = math.modf(sixi(pid, 3) / 20)
		local bb = math.modf(sixi(pid, 3) / 10)
		local cc = limitX(math.random(aa, bb), 1, 24)
		ng = ng + math.modf(cc * 100)				
		WAR.KUANGDAO = cc
	end
	
	if J2YSS(pid) and --夺命剑
		yongjian(wugong) and JLSD(10, 50, pid) and sixi(pid, 2) >= 120 then
		local aa = math.modf(sixi(pid, 2) / 50)
		local bb = math.modf(sixi(pid, 2) / 25)
		local cc = limitX(math.random(aa, bb), 1, 13)
		ng = ng + math.modf(cc * 100)				
		WAR.DUOMINGJIAN = cc
		if WAR.DUOMINGJIAN==13 and JLSD(10, 60, pid)  then
		WAR.DUOMINGJIAN = 14
		if JX(pid) and JLSD(10, 50, pid) then
		WAR.DUOMINGJIAN = 15
		end
		end
	end
	
	if (wglw1(pid,77) or ((DT(pid,605) or DT(pid,627))and JX(pid))) and WAR.DZDJ1 >0 then
		local aa = math.modf(sixi(pid, 3) / 20)
		local bb = math.modf(sixi(pid, 3) / 10)
		local cc = limitX(math.random(aa, bb), 1, 24)
		ng = ng + math.modf(cc * 100)				
	end
	
	if pid == 0 and putong() == 5 and (JLSD(10, 50, pid) or WAR.JSTG2>0) and yongnei(wugong) and JY.Person[pid]["内力"] >=3000 then
		local aa = math.modf(JY.Person[pid]["内力"] / 800)
		local bb = math.modf(JY.Person[pid]["内力"] / 400)
		local cc = limitX(math.random(aa, bb), 1, 24)
		ng = ng + math.modf(cc * 100)				
		WAR.TIANGANG = cc
	end
	
	--沼跃鱼：战意组件3 用刀附加气攻
    if WAR.ZCDZ ==1 and hasDZ(pid,3) and yongdao(wugong) then
    	local aa = math.modf(sixi(pid, 3) / 20)
		local bb = math.modf(sixi(pid, 3) / 10)
		local cc = limitX(math.random(aa, bb), 1, 24)
		ng = ng + math.modf(cc * 100)	
    end 
	
    if yongdao(wugong) and wglw1(pid,155) or DT(pid,665) then
    	local aa = math.modf(sixi(pid, 3) / 20)
		local bb = math.modf(sixi(pid, 3) / 10)
		local cc = limitX(math.random(aa, bb), 1, 24)
		ng = ng + math.modf(cc * 100)	
    end 
	
    if (yongquan(wugong) or WAR.ZKSY>0) and wglw1(pid,155) or DT(pid,665) then
    	local aa = math.modf(sixi(pid, 1) / 20)
		local bb = math.modf(sixi(pid, 1) / 10)
		local cc = limitX(math.random(aa, bb), 1, 24)
		ng = ng + math.modf(cc * 100)	
    end 
	
    if WAR.ZCDZ ==1 and hasDZ(pid,5) and yongan(wugong) then ---沼跃鱼：战意组件5
        local aa = math.modf(sixi(pid, 5) / 20)
		local bb = math.modf(sixi(pid, 5) / 10)
		local cc = limitX(math.random(aa, bb), 1, 24)
		ng = ng + math.modf(cc * 100)
    end
	
	if T8LXY(pid) and WAR.LXYYJ>0 then--李逍遥御剑气攻
		local aa = math.modf(sixi(pid, 2) / 20)
		local bb = math.modf(sixi(pid, 2) / 10)
		local cc = limitX(math.random(aa, bb), 1, 24)
		ng = ng + math.modf(cc * 100)
        WAR.LXYKJ = cc		
	end
	
	if DT(pid, 161) and WAR.ACT == 1 and WAR.Person[WAR.CurID]["我方"] 
		and WAR.AutoFight == 0 and JLSD(10, 50, pid) then --李莫愁冰魄银针
		WAR.LMC = 1
	end
	
	if DT(pid, 601) and WAR.ACT == 1 and WAR.Person[WAR.CurID]["我方"] 
		and WAR.AutoFight == 0 and JLSD(10, 50, pid) then --李莫愁冰魄银针
		WAR.LMC = 1
	end

	if DT(pid, 153) and JX(pid) and WAR.Person[WAR.CurID]["我方"] 
		and WAR.AutoFight == 0 then --赵半山回龙碧
		local anqi=math.modf(sixi(pid, 5) / 30)
		if JLSD(10, 50+anqi, pid) or ZYJ(pid) then
		    WAR.LMC = math.random(1,3)
		end
	end
	
	if DT(pid, 626) and WAR.ACT == 1 and fightnum > 1 then --何足道多次攻击
		local jl = 20 + math.modf(JY.Person[pid]["实战"] / 15)
		if JLSD(10, 10 + jl, pid) then
			WAR.HZD = {x, y}
		end
	end	
	if (PersonGT(pid, 181) and (DT(pid, 455))) or (wglw(pid,181) and JLSD(10,40,pid) and PersonGTJL(pid,181,WAR.NGJL)) and WAR.ACT == 1 and fightnum > 1 then
		local jl = 20 + math.modf(JY.Person[pid]["攻击力"] / 25)
		if JLSD(10, 10 + jl, pid) then
			WAR.WWD = {x, y}
		end 	
	end
	--丐世无双
	if PersonKFJ(pid, 26) and PersonKFJ(pid, 80) and (JLSD(0, 50, pid) or WAR.ZYHB1[pid]~= nil or (DT(pid,69) and JX(pid) and (JLSD(0,60,pid)) or ZYJ(pid))) then
        if wugong ==26 and WAR.GSWS1[1] == nil then
	        WAR.GSWS = {x, y}
	    elseif wugong ==80 and WAR.GSWS[1] == nil then
	        WAR.GSWS1 = {x, y}
	    end	
	end	
	--葵花套件
	if KHT(pid) and WAR.ACT == 1 and fightnum > 1 then
        if wugong == 177 and WAR.KHTJ1[1] == nil then
	        WAR.KHTJ = {x, y}
	    elseif wugong == 48 and WAR.KHTJ[1] == nil then
	        WAR.KHTJ1 = {x, y}
	    end	
	end	
	
	if (wglw1(pid,60) or DT(pid,166)) and PersonKF(pid,60) and PersonKF(pid,37) and WAR.ACT == 1 and MPPD(pid) == 14 and PersonGT(pid,90) and JLSD(10, 42, pid) then
        if wugong == 37 and WAR.LYDJLW1[1] == nil then
	        WAR.LYDJLW = {x, y}
	    elseif wugong == 60 and WAR.LYDJLW[1] == nil then
	        WAR.LYDJLW1 = {x, y}
	    end	
	end	
	
	if (wglw(pid,203) or DT(pid,592)) and PersonGT(pid,203) and WAR.NTLW[pid] ~= nil and WAR.NTLW[pid] > 1 then --if  then
		if WAR.NTLW2[1] == nil and yongjian(wugong) and JLSD(10,5+WAR.NTLW[pid],pid) then
			WAR.NTLW2 = {x, y}
		end
	end	
		
	if MPPD(pid) == 5 and JY.Person[pid]["武器"] == 367 and JLSD(10,60 ,pid) then--佛刑涤罪
		if wugong == 65 and WAR.FXDZ1[1] == nil then
			WAR.FXDZ = {x,y}
		elseif wugong == 139 and WAR.FXDZ[1] == nil then
			WAR.FXDZ1 = {x,y}
		end
	end	
	
	if wglw1(pid,40) and wugong == 40 and (JLSD(10,35,pid) or WAR.JSJZ == 1) and WAR.JSJZ2[pid] == nil then
		WAR.JZJZ = 0
		WAR.JSJZ2 = {x,y}
	end
	
	if (wglw(pid,999) or DT(pid,64)) and WAR.ZYHB2 == 1 then --左右三连
        if WAR.ZYHBS[1] == nil then
	        WAR.ZYHBS = {x, y}
	    end
            WAR.ZYHB4 = wugong	   
	end
	
	if pid == 0 and putong() == 13 and yongan(wugong) then
		ng = ng + 100 * wgnumber(pid, 6)
	end
	
	if T5BCF(pid) and WAR.BCFZL > 0 then --白愁飞三指弹天效果
		if WAR.BCFZL == 3 then --天敌
			WAR.WS = 1
			ng = ng + 10* JY.Person[pid]["拳掌功夫"]
			for i = 1, 6 do
				for j = 1, 6 do
				    SetWarMap(x + i - 1, y + j - 1, 4, 1)
				    SetWarMap(x - i + 1, y + j - 1, 4, 1)
				    SetWarMap(x + i - 1, y - j + 1, 4, 1)
				    SetWarMap(x - i + 1, y - j + 1, 4, 1)
				end
			end			
		elseif WAR.BCFZL == 2 then --惊梦
			ng = ng + 10* JY.Person[pid]["拳掌功夫"]
			local aa=math.modf(JY.Person[pid]["拳掌功夫"]/5)
			for j = 0, WAR.PersonNum - 1 do
			    if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				    WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"],"生命",-(100+aa))
					--JY.Person[WAR.Person[j]["人物编号"]]["生命"] = JY.Person[WAR.Person[j]["人物编号"]]["生命"] - 100-aa
				    WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - (150+aa)
					WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
			    end
			end			
		else --破煞
		local aa=math.modf(JY.Person[pid]["拳掌功夫"]/5)
		ng = ng *2+aa
		end
	end
	
	if ZLE(pid) then --赵灵儿回魂仙梦
		local extra = 0
		if WAR.LQZ[pid] ~= nil then
			extra = extra + math.modf(WAR.LQZ[pid] * 0.1)
		end
		if JLSD(10, 35 + extra, pid) then
			WAR.ZLE = 1
			if WAR.Person[id][CC.TXWZ1] == nil then
				WAR.Person[id][CC.TXWZ1] = "回魂仙梦"
			else
				WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+".."回魂仙梦"
			end
			WAR.Person[id][CC.TXDH] = 64				
		end
	end
	
	if pid==0 and T4WXS(0) and WAR.DZXYLV[pid]==nil then --王小石剑法刀法
		if yongjian(wugong) then --剑法特效
			if WAR.ACT==1 then				
				WAR.tmp[9000]=1 --剑法判定
			end
			local jilv=20
			if juexing() > 0 then jilv=jilv+10 end --观武几率+10
			jilv=jilv+math.modf(sixi(pid, 2)/10)
			jilv=jilv+math.modf(JY.Person[pid]["受伤程度"]/10)
			if JY.Person[pid]["生命"]<math.modf(JY.Person[pid]["生命最大值"]/3) then
				jilv=jilv+math.modf(JY.Person[pid]["生命"]/50)
			end
			if jilv>=math.random(100) then				
				local tmp=math.random(4)
				local word=""
				if tmp == 1 or tmp == 4 then
					word="凌空销魂剑"
				elseif tmp == 2 then
					word="凌空销魂剑・一霎销魂"
					ng = ng + 700
				elseif tmp == 3 then
					word="凌空销魂剑・销魂恨长"
					ng = ng + 700
				end
				if WAR.Person[id][CC.TXWZ1]==nil then
					WAR.Person[id][CC.TXWZ1]=word
				else
					WAR.Person[id][CC.TXWZ1]=WAR.Person[id][CC.TXWZ1].."+"..word
				end
				WAR.Person[id][CC.TXDH]=84			  
				WAR.SHITOUJIAN=1 --王小石剑法特效	
			end
		end
		
		if yongdao(wugong) then --刀法特效
			local jilv=20
			if WAR.ACT==1 then	
				WAR.tmp[9001]=1 --刀法判定
			end
			if juexing() > 0 then jilv=jilv+10 end --观武几率+10
			jilv=jilv+math.modf(sixi(pid, 3)/10) --最大加24
			jilv=jilv+math.modf(JY.Person[pid]["受伤程度"]/10) --最大加10
			if JY.Person[pid]["生命"]<math.modf(JY.Person[pid]["生命最大值"]/3) then
				jilv=jilv+math.modf(JY.Person[pid]["生命"]/50) --最大加10
			end
			if jilv>=math.random(100) then
				local tmp=math.random(4)
				local word=""
				if tmp == 1 or tmp == 4 then
					word="隔空相思刀"
				elseif tmp == 2 then
					word="隔空相思刀・相思旋剐"
					ng = ng + 700
				elseif tmp == 3 then
					word="隔空相思刀・红豆相思"
					ng = ng + 700
				end
				if WAR.Person[id][CC.TXWZ1]==nil then
					WAR.Person[id][CC.TXWZ1]=word
				else
					WAR.Person[id][CC.TXWZ1]=WAR.Person[id][CC.TXWZ1].."+"..word
				end	
				WAR.Person[id][CC.TXDH]=83
				WAR.SHITOUDAO=1 --王小石刀法特效	
			end
		end	
		
		if WAR.tmp[9000]~=nil and WAR.tmp[9001]~=nil and WAR.ZYHB == 2 and juexing() > 0 then --刀+剑
			local word=""
			local tmp=math.random(4) 
			if tmp == 1 and fightnum<3 then
				WAR.SHITOUJY=1
				word="明分暗合・缘灭缘生" --大范围三连击 杀气1500
				fightnum=3
				WAR.WS = 1
				WAR.tmp[9000]=nil
				WAR.tmp[9001]=nil --重置	
			else
				tmp=math.random(2)
				if tmp == 1 then--and fightnum<2
					WAR.SHITOUJY=2
					word="相思销魂・爱恨交缠" --生命越低增加伤害越高 最高300 杀气1000
					ng = ng + 500
					WAR.tmp[9000]=nil
					WAR.tmp[9001]=nil --重置		
				else
					WAR.SHITOUJY=3
					word="天地逆转・乾坤震爆" --破防 杀气2000
					ng = ng + 2500
					WAR.tmp[9000]=nil
					WAR.tmp[9001]=nil --重置						
				end
			end			
			if WAR.Person[id][CC.TXWZ1]==nil then
				WAR.Person[id][CC.TXWZ1]=word
			else
				WAR.Person[id][CC.TXWZ1]=WAR.Person[id][CC.TXWZ1].."+"..word
			end	
			WAR.Person[id][CC.TXDH]=math.random(83,84)
		end
		
				
		if fightnum >= 3 and juexing() > 0 then
			WAR.WS = 1
			ng = ng + 1000
			for i = 1, 6 do
				for j = 1, 6 do
				  SetWarMap(x + i - 1, y + j - 1, 4, 1)
				  SetWarMap(x - i + 1, y + j - 1, 4, 1)
				  SetWarMap(x + i - 1, y - j + 1, 4, 1)
				  SetWarMap(x - i + 1, y - j + 1, 4, 1)
				end
			end
		end
	else
		WAR.tmp[9000]=nil
		WAR.tmp[9001]=nil --重置
	end
	
	if  DT(pid,72) and JX(pid) and WAR.DZXYLV[pid]==nil then --田归农刀剑十杀
		if wugong == 44 then --剑法特效
			if WAR.ACT==1 then
                WAR.DJHB4[pid]=1
			end
			local jilv=50
			jilv=jilv+math.modf(sixi(pid, 2)/10)
			jilv=jilv+math.modf(JY.Person[pid]["受伤程度"]/10)
			if JY.Person[pid]["生命"]<math.modf(JY.Person[pid]["生命最大值"]/3) then
				jilv=jilv+math.modf(JY.Person[pid]["生命"]/50)
			end
			if jilv>=math.random(100) then				
				local word="刀剑双绝・不动一剑痕"
				if WAR.Person[id][CC.TXWZ1]==nil then
					WAR.Person[id][CC.TXWZ1]=word
				else
					WAR.Person[id][CC.TXWZ1]=WAR.Person[id][CC.TXWZ1].."+"..word
				end
				WAR.Person[id][CC.TXDH]=98			  
				WAR.DJJIAN=1 
			end
		end
		
		if wugong == 67 then --刀法特效
			local jilv=50
			if WAR.ACT==1 then	
                WAR.DJHB5[pid]=1
			end
			jilv=jilv+math.modf(sixi(pid, 3)/10) --最大加24
			jilv=jilv+math.modf(JY.Person[pid]["受伤程度"]/10) --最大加10
			if JY.Person[pid]["生命"]<math.modf(JY.Person[pid]["生命最大值"]/3) then
				jilv=jilv+math.modf(JY.Person[pid]["生命"]/50) --最大加10
			end
			if jilv>=math.random(100) then
				local word="刀剑双绝・狂龙裂斩"
				ng=ng+1700
				if WAR.Person[id][CC.TXWZ1]==nil then
					WAR.Person[id][CC.TXWZ1]=word
				else
					WAR.Person[id][CC.TXWZ1]=WAR.Person[id][CC.TXWZ1].."+"..word
				end	
				WAR.Person[id][CC.TXDH]=95
				WAR.DJDAO=1 	
			end
		end	

		
		if WAR.DJHB4[pid]~=nil and WAR.DJHB5[pid]~=nil and WAR.ZYHB == 2 then --刀+剑
			local word=""
			DHdisplay(517, 537, "刀剑十杀・古月照今尘")
			if fightnum<3  then
			    fightnum=3
			end
			WAR.DJSX=1
			word="刀剑十杀・古月照今尘" 
			ng = ng + 500
				WAR.DJHB4[pid]=nil
				WAR.DJHB5[pid]=nil --重置			
			if WAR.Person[id][CC.TXWZ1]==nil then
				WAR.Person[id][CC.TXWZ1]=word
			else
				WAR.Person[id][CC.TXWZ1]=WAR.Person[id][CC.TXWZ1].."+"..word
			end	
			WAR.Person[id][CC.TXDH]=111
		end	
		if fightnum >= 3  then
			WAR.WS = 1
			ng = ng + 1000
			for i = 1, 6 do
				for j = 1, 6 do
				  SetWarMap(x + i - 1, y + j - 1, 4, 1)
				  SetWarMap(x - i + 1, y + j - 1, 4, 1)
				  SetWarMap(x + i - 1, y - j + 1, 4, 1)
				  SetWarMap(x - i + 1, y - j + 1, 4, 1)
				end
			end
		end
	else
		WAR.DJHB4[pid]=nil
		WAR.DJHB5[pid]=nil --重置
	end
	
	if (wglw1(pid,77) or ((DT(pid,605) or DT(pid,627))and JX(pid))) and WAR.DZXYLV[pid]==nil then --倒错刀剑
		if wugong == 77 then --倒错刃特效
		    local word=""
			local num=0
            if math.random(10) > 5 then
			    num=78
				WAR.DZDJ=1
				WAR.DZDJ=4
				CleanWarMap(4, 0)
				for i = 0, WAR.PersonNum - 1 do
					if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
						SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
					end
				end	
				WAR.WS = 1
				ng = ng + 1000
				if WAR.DZDJ == 1 then
					word="刀剑顺行・黑剑真剑"
				end
				if WAR.DZDJ == 4 then
					word="刀剑逆转・金刀非刀"
				end
			else
				num=79
				WAR.DZDJ=2
				WAR.ASKD=1
				WAR.DZDJ=3
				if WAR.DZDJ == 2 then
					word="刀剑逆转・黑剑伪剑"
				end
				if WAR.DZDJ == 3 then
					word="刀剑顺行・金刀为刀"
				end
			end			
			if WAR.Person[id][CC.TXWZ1]==nil then
				WAR.Person[id][CC.TXWZ1]=word
			else
				WAR.Person[id][CC.TXWZ1]=WAR.Person[id][CC.TXWZ1].."+"..word
			end
			WAR.Person[id][CC.TXDH]=num		
		end
		--以上是用倒乱刃攻击的必然触发特效
		--以下是阳刀阴剑特效
		if WAR.ZYHB == 2 then
			if WAR.DJHB3[pid] == 1 and yongdao(wugong) and  wugong ~= 77 then
				WAR.DJHB3[pid] = 2--倒乱+刀是阴剑
			end	
			if WAR.DJHB3[pid] == 3 and yongjian(wugong) and not wugong ~= 77 then
				WAR.DJHB3[pid] = 4--倒乱+剑是阳刀
			end
			if WAR.DJHB1[pid] == 1 and (wugong == 77 or yongdao(wugong)) then
				WAR.DJHB1[pid] = 2--先剑后刀是阴剑
			end
			if WAR.DJHB2[pid] == 1 and (wugong == 77 or yongjian(wugong)) then
				WAR.DJHB2[pid] = 2--先刀后剑是阳刀
			end
		elseif  WAR.ZYHB == 1 then
			if wugong == 77 and WAR.DJHB3[pid] == nil then
				if math.random(10) > 5 then
					WAR.DJHB3[pid] = 1--倒乱阳刀
				else
					WAR.DJHB3[pid] = 3--倒乱阴剑
				end	
			else
				if yongjian(wugong) and WAR.DJHB1[pid] == nil then --剑法特效				
					WAR.DJHB1[pid] = 1 --阳刀判定
				end
				if yongdao(wugong) and WAR.DJHB2[pid] == nil then --刀法特效	
					WAR.DJHB2[pid] = 1 --阴剑判定
				end
			end	
		end

		if WAR.DJHB3[pid] == 1 or WAR.DJHB1[pid] == 1 or WAR.DJHB3[pid] == 4 or WAR.DJHB2[pid] == 2 then --阳刀（）
			local word=""
			local tmp=math.random(4) 
			if tmp == 1 and fightnum<3 then
				WAR.DZDJ1=1
				word="阳刃化刀・渔网阵" --大范围三连击 杀气1500
				fightnum=3
				WAR.WS = 1	
			else
				tmp=math.random(2)
				if tmp == 1  then--and fightnum<2
					WAR.DZDJ1=2
					word="阳刃化刀・烈阳舞" --生命越低增加伤害越高 最高300 杀气1000
					ng = ng + 500	
				else
					WAR.DZDJ1=3
					word="阳刃化刀・天丛云" --破防 杀气2000
						local ns=20
					for j = 0, WAR.PersonNum - 1 do
					   if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
						  WAR.Person[j]["内伤点数"] =(WAR.Person[j]["内伤点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"],"受伤程度",ns)
						  --JY.Person[WAR.Person[j]["人物编号"]]["受伤程度"] = JY.Person[WAR.Person[j]["人物编号"]]["受伤程度"] + ns
						  WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
					   end
					   if 100 < JY.Person[WAR.Person[j]["人物编号"]]["受伤程度"] then
						  JY.Person[WAR.Person[j]["人物编号"]]["受伤程度"] = 100
					   end
					end
					ng = ng + 50*ns				
				end
			end	
			if WAR.Person[id][CC.TXWZ1]==nil then
				WAR.Person[id][CC.TXWZ1]=word
			else
				WAR.Person[id][CC.TXWZ1]=WAR.Person[id][CC.TXWZ1].."+"..word
			end	
			WAR.Person[id][CC.TXDH] = 111
		end
		
		if WAR.DJHB3[pid] == 3 or WAR.DJHB2[pid] == 1 or WAR.DJHB3[pid] == 2 or WAR.DJHB1[pid] == 2 then --假剑
			local word=""
			local tmp=math.random(4) 
			if tmp == 1 and fightnum<2  then
				WAR.DZDJ2=1
				fightnum=math.random(4,5)
				word="阴刃化剑・枣核钉" 	
			else
				tmp=math.random(2)
				if tmp == 1 then--and fightnum<2
					WAR.DZDJ2=2
					word="阴刃化剑・霜雪扬" --生命越低增加伤害越高 最高300 杀气1000
					ng = ng + 500
				else
					WAR.DZDJ2=3
					word="阴刃化剑・八尺乌" --破防 杀气2000
					ng = ng + 2500					
				end
			end	
			if WAR.Person[id][CC.TXWZ1]==nil then
				WAR.Person[id][CC.TXWZ1]=word
			else
				WAR.Person[id][CC.TXWZ1]=WAR.Person[id][CC.TXWZ1].."+"..word
			end	
			WAR.Person[id][CC.TXDH]=112
		end
		if fightnum >= 3  then
			WAR.WS = 1
			ng = ng + 1000
			for i = 1, 7 do
				for j = 1, 7 do
				  SetWarMap(x + i - 1, y + j - 1, 4, 1)
				  SetWarMap(x - i + 1, y + j - 1, 4, 1)
				  SetWarMap(x + i - 1, y - j + 1, 4, 1)
				  SetWarMap(x - i + 1, y - j + 1, 4, 1)
				end
			end
		end 			
	end
	
	if MPPD(pid)==16 and WAR.DZXYLV[pid]==nil and PersonGT(pid,150) then --金关组合拳
		if wugong==15 then --空明
			if WAR.ACT==1 then				
				WAR.JGZH1[pid]=1 --空明判定
			end
			local jilv=30
			jilv=jilv+math.modf(sixi(pid, 1)/100)
			jilv=jilv+math.modf(JY.Person[pid]["受伤程度"]/30)
			if JY.Person[pid]["生命"]<math.modf(JY.Person[pid]["生命最大值"]/3) then
				jilv=jilv+math.modf(JY.Person[pid]["生命"]/100)
			end
			if  jilv>=math.random(100) then
			WAR.JGZH=1
			if WAR.Person[id][CC.TXWZ1]==nil then
				WAR.Person[id][CC.TXWZ1]="金关刚拳.裂空霹雳"
			else
				WAR.Person[id][CC.TXWZ1]=WAR.Person[id][CC.TXWZ1].."+".."金关刚拳.裂空霹雳"
			end	
			WAR.Person[id][CC.TXDH]=115
			end
		end
		
		if wugong==129 then --三花判定
			local jilv=30
			if WAR.ACT==1 then	
				WAR.JGZH2[pid]=1 --三花判定
			end
			local jilv=50
			jilv=jilv+math.modf(sixi(pid, 1)/100)
			jilv=jilv+math.modf(JY.Person[pid]["受伤程度"]/30)
			if JY.Person[pid]["生命"]<math.modf(JY.Person[pid]["生命最大值"]/3) then
				jilv=jilv+math.modf(JY.Person[pid]["生命"]/100)
			end
			if  jilv>=math.random(100) then
			WAR.JGZH=2
			if WAR.Person[id][CC.TXWZ1]==nil then
				WAR.Person[id][CC.TXWZ1]="金关刚拳.莲华落英"
			else
				WAR.Person[id][CC.TXWZ1]=WAR.Person[id][CC.TXWZ1].."+".."金关刚拳.莲华落英"
			end	
			WAR.Person[id][CC.TXDH]=115
			end
		end	
		
		if WAR.JGZH1[pid]~=nil and WAR.JGZH2[pid]~=nil and WAR.ZYHB == 2 then --刀+剑
			local word=""
			DHdisplay(517, 537, "金关刚拳.无二乱打")
			word="金关刚拳.无二乱打" 
			ng = ng + 500
			WAR.JGZH=3
			if fightnum<3  then
			fightnum=fightnum+2
			end
            WAR.JGZH1[pid]=nil
		    WAR.JGZH2[pid]=nil --重置				
			if WAR.Person[id][CC.TXWZ1]==nil then
				WAR.Person[id][CC.TXWZ1]=word
			else
				WAR.Person[id][CC.TXWZ1]=WAR.Person[id][CC.TXWZ1].."+"..word
			end	
			WAR.Person[id][CC.TXDH]=111
		end
		if WAR.ACT >= 3  then
			WAR.WS = 1
			ng = ng + 1000
			for i = 1, 6 do
				for j = 1, 6 do
				  SetWarMap(x + i - 1, y + j - 1, 4, 1)
				  SetWarMap(x - i + 1, y + j - 1, 4, 1)
				  SetWarMap(x + i - 1, y - j + 1, 4, 1)
				  SetWarMap(x - i + 1, y - j + 1, 4, 1)
				end
			end
		end
	else
		WAR.JGZH1[pid]=nil
		WAR.JGZH2[pid]=nil --重置
	end
	
	if pid == 0 and zjtype() == 4 and hasDZ(pid,15) and WAR.DZXYLV[pid]==nil then --田归农刀剑十杀
		if yongjian(wugong) then --剑法特效
			if WAR.ACT==1 then				
				WAR.tmp[8010]=1 --剑法判定
			end
			local jilv=50
			jilv=jilv+math.modf(sixi(pid, 2)/10)
			jilv=jilv+tianshu()*2
			jilv=jilv+math.modf(JY.Person[pid]["受伤程度"]/10)
			if JY.Person[pid]["生命"]<math.modf(JY.Person[pid]["生命最大值"]/3) then
				jilv=jilv+math.modf(JY.Person[pid]["生命"]/50)
			end
			if jilv>=math.random(100) then				
				local word="刀剑双绝.剑影"
                
				if WAR.Person[id][CC.TXWZ1]==nil then
					WAR.Person[id][CC.TXWZ1]=word
				else
					WAR.Person[id][CC.TXWZ1]=WAR.Person[id][CC.TXWZ1].."+"..word
				end
				WAR.Person[id][CC.TXDH]=98			  
				WAR.DJJIAN=1 
			end
		end
		
		if yongdao(wugong) then --刀法特效
			local jilv=50
			if WAR.ACT==1 then	
				WAR.tmp[8011]=1 --刀法判定
			end
			jilv=jilv+math.modf(sixi(pid, 3)/10) --最大加24
			jilv=jilv+math.modf(JY.Person[pid]["受伤程度"]/10) --最大加10
			if JY.Person[pid]["生命"]<math.modf(JY.Person[pid]["生命最大值"]/3) then
				jilv=jilv+math.modf(JY.Person[pid]["生命"]/50) --最大加10
			end
			if jilv>=math.random(100) then
				local word="刀剑双绝.刀光"
				ng=ng+1700
				if WAR.Person[id][CC.TXWZ1]==nil then
					WAR.Person[id][CC.TXWZ1]=word
				else
					WAR.Person[id][CC.TXWZ1]=WAR.Person[id][CC.TXWZ1].."+"..word
				end	
				WAR.Person[id][CC.TXDH]=95
				WAR.DJDAO=1 	
			end
		end	

		
		if WAR.tmp[8010]~=nil and WAR.tmp[8011]~=nil and WAR.ZYHB == 2 then --刀+剑
			local word=""
			DHdisplay(517, 537, "刀剑十杀.飞雪连天")
			if fightnum<3  then
			    fightnum=3
			end
			WAR.DJSX=1
			word="刀剑十杀.飞雪连天" 
			ng = ng + 500
			WAR.tmp[8000]=nil
			WAR.tmp[8001]=nil --重置				
			if WAR.Person[id][CC.TXWZ1]==nil then
				WAR.Person[id][CC.TXWZ1]=word
			else
				WAR.Person[id][CC.TXWZ1]=WAR.Person[id][CC.TXWZ1].."+"..word
			end	
			WAR.Person[id][CC.TXDH]=111
		end
		if fightnum >= 3  then
			WAR.WS = 1
			ng = ng + 1000
			for i = 1, 6 do
				for j = 1, 6 do
				  SetWarMap(x + i - 1, y + j - 1, 4, 1)
				  SetWarMap(x - i + 1, y + j - 1, 4, 1)
				  SetWarMap(x + i - 1, y - j + 1, 4, 1)
				  SetWarMap(x - i + 1, y - j + 1, 4, 1)
				end
			end
		end
	else
		WAR.tmp[8000]=nil
		WAR.tmp[8001]=nil --重置
	end
	
	
	--神掌+伏魔杖 50%，拳主角20%二次判定
	if JY.Person[pid]['武功'..wugongnum]==24 and JY.Person[pid]['武功等级'..wugongnum]>=999 and 
		(math.random(10)<6 or (pid == 0 and putong() == 1 and JLSD(30, 50, pid)) or WAR.ZYHB1[pid] ~= nil) then
	    for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
		    if JY.Person[pid]['武功'..i]==86 and JY.Person[pid]['武功等级'..i]>=999 then
				if WAR.Person[id][CC.TXWZ1] ~= nil then
					WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .."金刚怒目・菩萨低眉"
				else
					WAR.Person[id][CC.TXWZ1] = "金刚怒目・菩萨低眉"
				end			  
			    WAR.Person[id][CC.TXDH]=6
			    WAR.SHAOLIN=1
			    ng = ng + 1800
			    WAR.BJ = 1
			    WAR.WS = 1
			    break
			elseif wglw1(pid,24) then
				if WAR.Person[id][CC.TXWZ1] ~= nil then
					WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .."金刚怒目・菩萨低眉"
				else
					WAR.Person[id][CC.TXWZ1] = "金刚怒目・菩萨低眉"
				end			  
			    WAR.Person[id][CC.TXDH]=6
			    WAR.SHAOLIN=1
			    ng = ng + 1800
			    WAR.BJ = 1
			    WAR.WS = 1
			    break			
		    end
	    end
	end
		
	--神掌+伏魔杖 50%，特主角20%二次判定
	if JY.Person[pid]['武功'..wugongnum]==86 and JY.Person[pid]['武功等级'..wugongnum]>=999 and 
		(math.random(10)<6 or (pid == 0 and putong() == 4 and JLSD(30, 50, pid)) or WAR.ZYHB1[pid] ~= nil) then
	    for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
		    if JY.Person[pid]['武功'..i]==24 and JY.Person[pid]['武功等级'..i]>=999 then
				if WAR.Person[id][CC.TXWZ1] ~= nil then
					WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .."金刚怒目・菩萨低眉"
				else
					WAR.Person[id][CC.TXWZ1] = "金刚怒目・菩萨低眉"
				end		
			    WAR.Person[id][CC.TXDH]=6
			    WAR.SHAOLIN=1
			    ng = ng + 1800
			    WAR.BJ = 1
			    WAR.WS = 1
			    break		   		  
		    end
	    end
	end
	
    if T13TQS(pid) and juexing() > 1 then --沼跃鱼：滕青山凶兽斗气
		if JLSD(10, 30 + WAR.SWHH*7, pid) then 
			WAR.TQS3=1 --滕青山凶兽斗气
		end
	end
	
	if T13TQS(pid) and WAR.TQS3==1 then --沼跃鱼：滕青山凶兽斗气
		if WAR.Person[id][CC.TXWZ2]==nil then
			WAR.Person[id][CC.TXWZ2] = "凶兽斗气"
		else
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].."+凶兽斗气"
		end
		WAR.TQS3=math.random(4)+WAR.TQS3 --2-5
		if WAR.TQS3==2 then 
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].."・毕方烈焰" 
			WAR.Person[id][CC.TXDH]=10
		elseif WAR.TQS3==3 then
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].."・杌气浪" 
			WAR.Person[id][CC.TXDH]=18
		elseif WAR.TQS3==4 then 
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].."・相柳寒毒" 
			WAR.Person[id][CC.TXDH]=12
		elseif WAR.TQS3==5 then
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].."・金鹏流光" 
			WAR.Person[id][CC.TXDH]=11
		end
	end
	
	if wssz(pid) then --沼跃鱼：滕青山凶兽斗气
		if JLSD(10, 30 + WAR.SWHH1*7, pid) then 
			WAR.TQS3=1 --滕青山凶兽斗气
		end
	end
	
	if wssz(pid) and WAR.SQFJ==1 then
		WAR.WSFJ = math.random(1, 4)
		local WZTS = {"兽王心经・雄狮怒吼","兽王心经・万蛇之灾","万兽反击・双龙吐息","万兽反击・蚁皇噬体"}
		for p = 0, WAR.PersonNum - 1 do
			if WAR.Person[p]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[p]["死亡"] == false then
				if  WAR.WSFJ==1 then
				    WAR.SZWH[WAR.Person[p]["人物编号"]] = 20 --狮子王吼
				    WAR.Person[p]["内伤点数"] = (WAR.Person[p]["内伤点数"] or 0) + AddPersonAttrib(WAR.Person[p]["人物编号"],"受伤程度", math.random(10,20))
				elseif WAR.WSFJ==2 then
				    WAR.Person[p]["中毒点数"] = (WAR.Person[p]["中毒点数"] or 0) + AddPersonAttrib(WAR.Person[p]["人物编号"],"中毒程度", 100)
				    WAR.POISON[WAR.Person[p]["人物编号"]] =  WAR.POISON[WAR.Person[p]["人物编号"]] or 0 + 20
                    WAR.L_WNGZL[WAR.Person[p]["人物编号"]] = 50
				    WAR.QSLZ[WAR.Person[p]["人物编号"]] = WAR.QSLZ[WAR.Person[p]["人物编号"]] or 0 + 1
				elseif WAR.WSFJ==3 then
				    local victimid= WAR.Person[p]["人物编号"]
				    WAR.ICE[victimid] = limitX((WAR.ICE[victimid] or 0) + 30, 0, 50) 
				    WAR.HOT[victimid] = limitX((WAR.ICE[victimid] or 0) + 30, 0, 50) 
				    WAR.PEACE[victimid] = limitX((WAR.ICE[victimid] or 0) + 30, 0, 50) 
					if WAR.LQZ[victimid] ~= nil then
						WAR.LQZ[victimid] = WAR.LQZ[victimid] - 20
						if WAR.LQZ[victimid] <= 0  then
							WAR.LQZ[victimid] = nil
						end
					end
					if WAR.SPIRIT[victimid] ~= nil then
						WAR.SPIRIT[victimid] = WAR.SPIRIT[victimid] - 20
						if WAR.SPIRIT[victimid] <= 0  then
							WAR.SPIRIT[victimid] = nil
						end
					end
				    WAR.YHZJ[victimid]=1
				elseif WAR.WSFJ==4 then
				    WAR.OYFSD[WAR.Person[p]["人物编号"]] =  WAR.OYFSD[WAR.Person[p]["人物编号"]] or 0 + 20
				    WAR.LYXJ[WAR.Person[p]["人物编号"]] = WAR.LYXJ[WAR.Person[p]["人物编号"]] or 0 + 1
				end
				WAR.XNXS[WAR.Person[p]["人物编号"]] = 1
		    end
		end
		if WAR.Person[id][CC.TXWZ1]==nil then
			WAR.Person[id][CC.TXWZ1] = WZTS[WAR.WSFJ]
		else
			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+"..WZTS[WAR.WSFJ]
		end
	end
	
	if wssz(pid) and WAR.TQS3==1 then --沼跃鱼：滕青山凶兽斗气
		if WAR.Person[id][CC.TXWZ2]==nil then
			WAR.Person[id][CC.TXWZ2] = "凶兽斗气"
		else
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].."+凶兽斗气"
		end
		WAR.TQS3=math.random(4)+WAR.TQS3 --2-5
		if WAR.TQS3==2 then 
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].."・毕方烈焰" 
			WAR.Person[id][CC.TXDH]=10
		elseif WAR.TQS3==3 then
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].."・杌气浪" 
			WAR.Person[id][CC.TXDH]=18
		elseif WAR.TQS3==4 then 
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].."・相柳寒毒" 
			WAR.Person[id][CC.TXDH]=12
		elseif WAR.TQS3==5 then
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].."・金鹏流光" 
			WAR.Person[id][CC.TXDH]=11
		end
	end
	
	if T7DFWM(pid) and WAR.DZXY == 1 and yongnei(wugong) and juexing()>1 then --东方未明内功反击特效
	    local jiali= math.modf(JY.Person[pid]["内力最大值"]/10)
	    ng = ng + jiali
        WAR.BJ = 1
	    WAR.WS = 1
	end	 
	
    if (wugong == 86 and MPPD(pid) == 5 and PersonGTJL(pid, 96, WAR.NGJL) and MPDJ(pid)> 2) or (DT(pid,615) and JLSD(20,50,pid)) and 
	    (math.random(10)<6 or (pid == 0 and putong() == 4 and JLSD(30, 50, pid)) or WAR.ZYHB1[pid] ~= nil) then --沼跃鱼：罗汉堂伏魔杖法
	    local SN=math.modf(JY.Person[pid]["内力"]/10)
	    local SN2=MPDJ(pid)+5
	    if JY.Person[pid]["武器"] == 50 then----沼跃鱼：伏魔杵
	        SN2=SN2+2
	    end
	    if WAR.Person[id][CC.TXWZ1] ~= nil then
			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .."韦陀镇魂・怒目荡魔"
		else
			WAR.Person[id][CC.TXWZ1] = "韦陀镇魂・怒目荡魔"
		end		
		WAR.Person[id][CC.TXDH]=6
		WAR.SHAOLIN2=1
		ng = ng + SN
		WAR.WS = 1
		for i = 1, SN2 do
			for j = 1, SN2 do
				SetWarMap(x + i - 1, y + j - 1, 4, 1)
				SetWarMap(x - i + 1, y + j - 1, 4, 1)
				SetWarMap(x + i - 1, y - j + 1, 4, 1)
				SetWarMap(x - i + 1, y - j + 1, 4, 1)
			end
		end
	end
	
	if (wugong == 24 and MPPD(pid) == 5 and PersonGTJL(pid, 108, WAR.NGJL) and MPDJ(pid)> 2) or DT(pid,615) and 
	    (math.random(10)<6 or (pid == 0 and putong() == 1 and JLSD(30, 50, pid)) or WAR.ZYHB1[pid] ~= nil)  then --沼跃鱼：达摩院须弥山
	    local SN=math.modf(JY.Person[pid]["内力"]/10)
	    local SN2=MPDJ(pid)
	    if WAR.Person[id][CC.TXWZ1] ~= nil then
			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .."天佛降世・千手如来"
		else
			WAR.Person[id][CC.TXWZ1] = "天佛降世・千手如来"
		end		
			WAR.Person[id][CC.TXDH]=6
			WAR.SHAOLIN2=1
		    ng = ng + SN
			WAR.WS = 1
	end
	
	--玄冥掌+火焰刀 50%，拳主角20%二次判定
	if JY.Person[pid]['武功'..wugongnum]==21 and JY.Person[pid]['武功等级'..wugongnum]>=999 and 
		(math.random(10) < 6 or (pid == 0 and putong() == 1 and JLSD(30, 50, pid)) or (DT(pid,2) and JX(pid) and JLSD(30, 50, pid)) or WAR.ZYHB1[pid] ~= nil) then
	    if DT(pid,2) and JX(pid) then
	        DHdisplay(2558, 2582, "玄冥海棠.毒心裂伤")
	  		if WAR.Person[id][CC.TXWZ1] ~= nil then
				WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .."玄冥海棠.毒心裂伤"
			else
				WAR.Person[id][CC.TXWZ1] = "玄冥海棠.毒心裂伤"
			end					  
			    WAR.Person[id][CC.TXDH]=57
			    WAR.YY=1
			    ng = ng + 1000
	    else
 	    for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
		    if JY.Person[pid]['武功'..i]==66 and JY.Person[pid]['武功等级'..i]>=999 then
				if WAR.Person[id][CC.TXWZ1] ~= nil then
					WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .."元阴无限・纯阳无极"
				else
					WAR.Person[id][CC.TXWZ1] = "元阴无限・纯阳无极"
				end					  
			    WAR.Person[id][CC.TXDH]=6
			    WAR.YY=1
			    ng = ng + 1000
			    break		   		  
		    end
	    end
	    end
	end
	
	--玄冥掌+火焰刀 50%，刀主角20%二次判定
	if JY.Person[pid]['武功'..wugongnum]==66 and JY.Person[pid]['武功等级'..wugongnum]>=999 and 
		(math.random(10) < 6 or (pid == 0 and putong() == 3 and JLSD(30, 50, pid)) or WAR.ZYHB1[pid] ~= nil) then
	    for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
		    if JY.Person[pid]['武功'..i]==21 and JY.Person[pid]['武功等级'..i]>=999 then
				if WAR.Person[id][CC.TXWZ1] ~= nil then
					WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .."纯阳无极・元阴无限"
				else
					WAR.Person[id][CC.TXWZ1] = "纯阳无极・元阴无限"
				end	
			    WAR.Person[id][CC.TXDH]=6
			    WAR.YY=2
			    ng = ng + 1000
			    break			   		  
		    end
	    end
	end

	--豸苗：折梅手特效
	if MPPD(pid) == 7 and MPDJ(pid) >=2 and wugong == 14 then
	    local a = math.random(15)
	    for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
	        if a <= 7 then
			    if JY.Person[pid]['武功'..i]==21 then
				    if WAR.Person[id][CC.TXWZ1] ~= nil then
					    WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .."纯阳无极・元阴无限"
				    else
					    WAR.Person[id][CC.TXWZ1] = "纯阳无极・元阴无限"
				    end	
			        WAR.Person[id][CC.TXDH]=6
			        WAR.YY=2
			        ng = ng + 1000			  
		        elseif JY.Person[pid]['武功'..i]==66 then
				    if WAR.Person[id][CC.TXWZ1] ~= nil then
					    WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .."元阴无限・纯阳无极"
				    else
					    WAR.Person[id][CC.TXWZ1] = "元阴无限・纯阳无极"
				    end					  
			            WAR.Person[id][CC.TXDH]=6
                        WAR.YY=1
			            ng = ng + 1000	   		  
		        end
		    end	
			if a >= 2 and a <= 8 then
				if JY.Person[pid]['武功'..i]==44 or JY.Person[pid]['武功'..i]==67 then
				  if WAR.Person[id][CC.TXWZ1] ~= nil then
					WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" ..CC.WARS44
				  else
					WAR.Person[id][CC.TXWZ1] = CC.WARS44
				  end
					WAR.Person[id][CC.TXDH] = 6
					WAR.DJGZ = 1
					ng = ng + 1500	
				end
			end	
			if a >=3 and a <= 9 then
				if JY.Person[pid]['武功'..i]==86 or JY.Person[pid]['武功'..i]==24 then 
					if WAR.Person[id][CC.TXWZ1] ~= nil then
						WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .."金刚怒目・菩萨低眉"
					else
						WAR.Person[id][CC.TXWZ1] = "金刚怒目・菩萨低眉"
					end		
					WAR.Person[id][CC.TXDH]=6
					WAR.SHAOLIN=1
					ng = ng + 1800
					WAR.BJ = 1
					WAR.WS = 1
				end
			end	
			if a >= 4 and a <= 10 then
				if JY.Person[pid]['武功'..i]==61 then
					WAR.JWYX = 1
					ng = ng + 800
					if WAR.Person[id][CC.TXWZ1] ~= nil then
						WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .."金乌映雪・玄冰"
					else
						WAR.Person[id][CC.TXWZ1] = "金乌映雪・玄冰"
					end		
					WAR.Person[id][CC.TXDH]=2   	
				elseif JY.Person[pid]['武功'..i]==35 then
					WAR.JWYX = 2
					ng = ng + 800
					if WAR.Person[id][CC.TXWZ1] ~= nil then
						WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .."金乌映雪・烈炎"
					else
						WAR.Person[id][CC.TXWZ1] = "金乌映雪・烈炎"
					end		
					WAR.Person[id][CC.TXDH]=33 
				end 
			end
			if a >= 4 and a <= 10 then
				if JY.Person[pid]['武功'..i]==137 then
					WAR.FDLJ = 1
					ng = ng + 800
					if WAR.Person[id][CC.TXWZ1] ~= nil then
						WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .."狂风怒嚎・雷鸣惊世"
					else
						WAR.Person[id][CC.TXWZ1] = "狂风怒嚎・雷鸣惊世"
					end		
					WAR.Person[id][CC.TXDH]=2   	
				elseif JY.Person[pid]['武功'..i]==55 then
					WAR.FDLJ = 2
					ng = ng + 800
					if WAR.Person[id][CC.TXWZ1] ~= nil then
						WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .."狂风怒嚎・雷鸣惊世"
					else
						WAR.Person[id][CC.TXWZ1] = "狂风怒嚎・雷鸣惊世"
					end		
					WAR.Person[id][CC.TXDH]=33 
				end 
			end
		end
	end

    if (pid==0 and T4WXS(0)) or(DT(pid,72) and JX(pid)) then --王小石，田归农不能出归真

    else	
    --苗家剑法，为极，配合胡家刀法。 50%刀剑合壁 剑主角20%独立判定 觉醒苗人凤40%独立判定
		if JY.Person[pid]["武功" .. wugongnum] == 44 and JY.Person[pid]["武功等级" .. wugongnum] >= 999 
			and (math.random(10) < 6 or (pid == 0 and putong() == 2 and JLSD(30, 50, pid)) or (DT(pid,3) and JX(pid) and (JLSD(10, 50, pid) or ZYBF(pid)) ) or WAR.ZYHB1[pid] ~= nil) then
			if DT(pid,3) and JX(pid) then
				DHdisplay(456, 469, "苗家天剑.剑意冲霄")
				if WAR.Person[id][CC.TXWZ1] ~= nil then
					WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .."苗家天剑・剑意纵横"
				else
					WAR.Person[id][CC.TXWZ1] = "苗家天剑・剑意冲霄"
				end
				WAR.Person[id][CC.TXDH] = 98
				WAR.DJGZ = 2
				ng = ng + math.modf(sixi(pid,2)*10)
			else
				for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
					if JY.Person[pid]["武功" .. i] == 67 and JY.Person[pid]["武功等级" .. i] >= 999 then
						if wglw1(pid,77)then
							WAR.DJJIAN = 1
							ng = ng + 1500
							if WAR.Person[id][CC.TXWZ1] ~= nil then
								WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .."倒乱・"..CC.WARS44
							else
								WAR.Person[id][CC.TXWZ1] = "倒乱・"..CC.WARS44
							end
							WAR.Person[id][CC.TXDH] = 6
						else
							WAR.DJGZ = 1
							ng = ng + 1500
							if WAR.Person[id][CC.TXWZ1] ~= nil then
								WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" ..CC.WARS44
							else
								WAR.Person[id][CC.TXWZ1] = CC.WARS44
							end
							WAR.Person[id][CC.TXDH] = 6
						end	
					end
				end
			end
		end
    
    --胡家刀法，为极，配合苗家剑法。 50%刀剑合壁 刀主角20%独立判定 觉醒胡一刀40%独立判定
		if JY.Person[pid]["武功" .. wugongnum] == 67 and JY.Person[pid]["武功等级" .. wugongnum] >= 999 
			and (math.random(10)<6 or (pid == 0 and putong() == 3 and JLSD(30, 50, pid)) or (DT(pid,621) and JX(pid) and (JLSD(10, 50, pid) or ZYBF(pid)) )or (DT(pid,4) and JX(pid) and (JLSD(10, 50, pid) or ZYBF(pid)) )or WAR.ZYHB1[pid] ~= nil) then
			if DT(pid,621) and JX(pid) then
				DHdisplay(877, 890, "胡家绝刀.刀气纵横")
				if WAR.Person[id][CC.TXWZ1] ~= nil then
					WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .."胡家绝刀.刀气纵横"
				else
					WAR.Person[id][CC.TXWZ1] = "胡家绝刀.刀气纵横"
				end
					WAR.Person[id][CC.TXDH] = 6
					WAR.DJGZ = 3
					ng = ng + math.modf(sixi(pid,3)*10)
			elseif DT(pid,4) and JX(pid) then
				local SN2=math.modf(JY.Person[pid]["用毒能力"]/100)+3
				DHdisplay(1233, 1249, "千毒胡刀.暗刃无影")
				if WAR.Person[id][CC.TXWZ1] ~= nil then
					WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .."千毒胡刀.暗刃无影"
				else
					WAR.Person[id][CC.TXWZ1] = "千毒胡刀.暗刃无影"
				end
					WAR.Person[id][CC.TXDH] = 145
					WAR.DJGZ = 4
					for i = 1, SN2 do
						for j = 1, SN2 do
							SetWarMap(x + i - 1, y + j - 1, 4, 1)
							SetWarMap(x - i + 1, y + j - 1, 4, 1)
							SetWarMap(x + i - 1, y - j + 1, 4, 1)
							SetWarMap(x - i + 1, y - j + 1, 4, 1)
						end
					end
					ng = ng + math.modf(SN2*400)
			else--17-1-1
				for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
					if JY.Person[pid]["武功" .. i] == 44 and JY.Person[pid]["武功等级" .. i] >= 999 then
						 if wglw1(pid,77) then
							WAR.DJDAO = 1
							ng = ng + 1500
							if WAR.Person[id][CC.TXWZ1] ~= nil then
								WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .."倒乱・"..CC.WARS44
							else
								WAR.Person[id][CC.TXWZ1] = "倒乱・"..CC.WARS44
							end
							WAR.Person[id][CC.TXDH] = 6
						else
							WAR.DJGZ = 1
							ng = ng + 1500
							if WAR.Person[id][CC.TXWZ1] ~= nil then
								WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" ..CC.WARS44
							else
								WAR.Person[id][CC.TXWZ1] = CC.WARS44
							end
							WAR.Person[id][CC.TXDH] = 6
						end
					end
				end
			end
		end
	end
 	--豸苗：折梅手特效补充
	if wugong == 14 and JY.Person[pid]["内力"] >= 7000 then
	    local jl = 15 + math.modf(JY.Person[pid]["实战"] / 20)+ math.modf(JY.Person[pid]["武学常识"] / 10)
        if JLSD(0,5+jl,pid) or (MPPD(pid)== 7 and JLSD(0,15,pid)) then	
	        for i = 1,10 do
		        if JY.Person[pid]['武功'..i]== 134 and JLSD(10,50,pid) then
		            WAR.SHENMEN = 1
		            WAR.ZMS = 1	
		        end   
                if JY.Person[pid]['武功'..i]== 20 or JY.Person[pid]['武功'..i]== 4 then
			        WAR.ZHUA = 1
                    WAR.ZMS = 1	
		        end	
                if JY.Person[pid]['武功'..i]== 48 or JY.Person[pid]['武功'..i]== 177 then
			        WAR.KHBX = 2
                    WAR.ZMS = 1	
		        end	
		        if JY.Person[pid]['武功'..i]== 63 then
		            WAR.XDDF = 1
		            WAR.ZMS = 1	
		        end  
            end	
        end		
	end
 	--1-26-
	if ((wglw(pid,102) or (DT(pid,38) and PersonKF(pid,102))) and WAR.HLTX1[pid] ~= nil) or (DT(pid,618) and PersonKF(pid,98)) then
		if WAR.HLTX == 134 or WAR.HLTX == 99 then
		   WAR.SHENMEN = 1
		end   
        if WAR.HLTX == 20 or WAR.HLTX == 4 or WAR.HLTX == 96 or WAR.HLTX == 97 then
			WAR.ZHUA = 1
		end	
        if WAR.HLTX == 48 or WAR.HLTX == 177 or WAR.HLTX == 105 then
			WAR.KHBX = 2
		end	
		if WAR.HLTX == 63 or WAR.HLTX == 94 then
		   WAR.XDDF = 1
		end  
	end
    --豸苗：童姥八荒八灭
 	if (PersonKFJ(pid, 8) or PersonKFJ(pid, 176)) and PersonKF(pid, 101) and (wugong == 8 or wugong == 176 or wugong == 101) and ((DT(pid,117) and JLSD(0,40,pid)) or JLSD(0,40,pid)) then
        local aa = math.random(2)
	    if aa == 1 then 
	        WAR.BHBM = 1
	        if WAR.Person[id][CC.TXWZ1] ~= nil then
                WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+八荒・纯阳至尊"
            else
                WAR.Person[id][CC.TXWZ1] = "八荒・纯阳至尊"
            end
	    elseif aa == 2 then 
	        if WAR.Person[id][CC.TXWZ1] ~= nil then
                WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+八灭・倒转阴阳"
            else
                WAR.Person[id][CC.TXWZ1] = "八灭・倒转阴阳"
            end
	            WAR.BHBM = 2
	    end
	        ng = ng + 1000	
	end

    if wugong == 176 and (DT(pid, 117) or wglw1(pid,176)) or (DT(pid, 618) and JLSD(10, 40, pid)) then
        local aa = math.random(2)
	    if aa == 1 then 
	        WAR.SSF = 1
	        if WAR.Person[id][CC.TXWZ1] ~= nil then
                WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+生死符・寒气"
            else
                WAR.Person[id][CC.TXWZ1] = "生死符・寒气"
            end
	    elseif aa == 2 then 
	        if WAR.Person[id][CC.TXWZ1] ~= nil then
                WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+生死符・热劲"
            else
                WAR.Person[id][CC.TXWZ1] = "生死符・热劲"
            end
	            WAR.SSF = 2
	    end
	        ng = ng + 1000	
	end

    if WAR.SBZ == 3 then
        local ad = math.modf(JY.Person[pid]["内力"]/3)
	    local ab = ad + 5
		WAR.SHAOLIN2 = 1
		ng = ng + ad
		WAR.WS = 1
	end	

    if wglw1(pid,175) then
		ng = ng + 1500
	end	

    --沼跃鱼：张召重柔云剑法
    if wugong == 36 and WAR.NSTJ>0 and DT(pid,80) and JX(pid) then
  	    WAR.NSTJ1 = WAR.NSTJ;
        if WAR.Person[id][CC.TXWZ1] ~= nil then
            WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+火手・太极奥义"
        else
            WAR.Person[id][CC.TXWZ1] = "火手・太极奥义"
        end
	        WAR.Person[id][CC.TXDH] = 116
	        WAR.NSTJ=0
    end
	
    --钟灵 使用闪电貂，可偷窃
    --[[if pid == 90 and JY.Person[pid]["武功" .. wugongnum] == 113 then
      WAR.TD = -2
    end]]
    
    --蓝烟清：挑战战斗不可偷东西
    if WAR.ZDDH == 226 or WAR.ZDDH == 79 then
    	WAR.TD = -1;
    end
    
    if WAR.ACT == 1 and 
		((getHZ(pid, 30) and JLSD(10, 60, pid) ) or (hasTF(pid, 39) and JLSD(10, 60, pid))) then
		for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				WAR.Person[j]["内力点数"] = (WAR.Person[j]["内力点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"], "内力", -500)
				WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
			end
		end
		WAR.Person[id][CC.TXWZ3] = "箫韶九成"
		WAR.Person[id][CC.TXDH] = 145
    end

	if PersonKF(pid, 6)  then --碧海潮生曲
		local jl = 20
		if PersonGT(pid, 6) then
			jl = jl + 20
		end
		if JLSD(10, 10 + jl, pid) then
			for j = 0, WAR.PersonNum - 1 do
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
					local tid = WAR.Person[j]["人物编号"]
					zhanyi(tid, -0.7)
					if PersonGT(pid, 6) then
						zhanyi(tid, -0.3)
					end
				end
			end
			WAR.Person[id][CC.TXWZ2] = CC.WARS45
			WAR.Person[id][CC.TXDH] = 145
		end
	end
	
	  ----沼跃鱼：桃花岛真传 碧海怒涛 
	local mpdj = MPDJ(pid)* 10
	local mpdj2 = MPDJ(pid)+1
    if MPPD(pid) == 10 and (JLSD(10,20 + MPDJ(pid)* 10,pid) or (DT(pid,57) and JLSD(20,70,pid)) or DT(pid,667)) then
	    local jl = 20
	    jl = jl + limitX(math.modf(WAR.SPIRIT[pid]-100), 0, 40)
	    if WAR.ACT==1 or (WAR.ACT>1 and JLSD(10,jl,pid)) or DT(pid,667) then
	        local str=".碧海怒涛"
            for j = 0, WAR.PersonNum - 1 do
		        if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
		            local tid = WAR.Person[j]["人物编号"]
		            local tl= math.modf(JY.Person[tid]["内力"]/2)
		            if JY.Person[pid]["内力"]-tl>0 then
		                tl=JY.Person[pid]["内力"]-tl
		            else
		                tl=0
		            end
					local kl = mpdj2*100+math.modf ((WAR.SPIRIT[pid]/100)*tl/5)
					if PersonGT(pid, 6) then
						kl=kl+200
					end
					if JY.Person[tid]["内力"] > kl then
						WAR.Person[j]["内力点数"] = (WAR.Person[j]["内力点数"] or 0) + AddPersonAttrib(tid, "内力", -kl)
						if DT(pid,57) then
							WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(tid, "生命", -math.modf (kl/10))
							WAR.CYSH[tid] = WAR.CYSH[tid] or 0 + jl
							str=".碧海狂潮"
						end
					else
						kl=math.modf (kl/10)
						WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(tid, "生命", -kl)
					end
					WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
				end
			end
	        DHdisplay(1830, 1849, "桃花岛真传"..str)
	    end
	end
   
    --沼跃鱼：落英缤纷 
	local mpdj = math.modf(JY.Person[pid]["御剑能力"]/20)
	local mpdj2 = math.modf(JY.Person[pid]["拳掌功夫"]/50)
    if PersonKFJ(pid, 12) and wglw1(pid,12)  and JLSD(0,10 + mpdj2* 10,pid) then
	    local jl = 20
	    jl = jl + limitX(math.modf(WAR.SPIRIT[pid]-100), 0, 40)
	    if WAR.ACT==1 or (WAR.ACT>1 and JLSD(10,jl,pid)) then
	        local str="散华.落英缤纷"
            for j = 0, WAR.PersonNum - 1 do
		        if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
		            local tid = WAR.Person[j]["人物编号"]
		            local tl= math.modf(JY.Person[tid]["内力"]/2)
		            if JY.Person[pid]["内力"]-tl>0 then
		                tl=JY.Person[pid]["内力"]-tl
		            else
		                tl=0
		            end
		                local kl = mpdj2*100+math.modf ((WAR.SPIRIT[pid]/100)*tl/5)
		            if PersonGT(pid, 6) then
		                kl=kl+200
		            end
					kl=math.modf(kl/10)
					WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(tid, "生命", -kl)
					WAR.LXXS[tid] = 1
					WAR.LXZT[tid] = limitX((WAR.LXZT[tid] or 0) + kl, 0, 50)
					WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
                end
            end
	        DHdisplay(456, 469, str)
	    end
	end
   
    --沼跃鱼：落英缤纷 
	local mpdj = math.modf(JY.Person[pid]["拳掌功夫"]/20)
	local mpdj2 = math.modf(JY.Person[pid]["御剑能力"]/50)
    if PersonKFJ(pid, 38) and wglw1(pid,38) and JLSD(0,10 + mpdj2* 10,pid) then
	    local jl = 20
	    jl = jl + limitX(math.modf(WAR.SPIRIT[pid]-100), 0, 40)
	    if WAR.ACT==1 or (WAR.ACT>1 and JLSD(10,jl,pid)) then
	        local str="天魔曲.无间轮回"
            for j = 0, WAR.PersonNum - 1 do
		        if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
		            local tid = WAR.Person[j]["人物编号"]
		            local tl= math.modf(JY.Person[tid]["内力"]/2)
		            if JY.Person[pid]["内力"]-tl>0 then
		                tl=JY.Person[pid]["内力"]-tl
		            else
		                tl=0
		            end
		                local kl = mpdj2*100+math.modf ((WAR.SPIRIT[pid]/100)*tl/5)
		            if PersonGT(pid, 6) then
		                kl=kl+200
		            end
		            if JY.Person[pid]["武器"] == 304 then
		                kl=kl+200
		            end  
		                kl=math.modf(kl/50)
		                WAR.Person[j]["内伤点数"] = (WAR.Person[j]["内伤点数"] or 0) + AddPersonAttrib(tid, "受伤程度", kl)
		                WAR.CYSH[tid] = limitX((WAR.CYSH[tid] or 0) + kl, 0, 50)
		            if math.random(10)<4 then
		                WAR.BZ[tid]=1
		            end
                end
            end
	  	    for i = 0, WAR.PersonNum - 1 do
			    if WAR.Person[i]["我方"] == true and WAR.Person[i]["死亡"] == false then
				    local id = WAR.Person[i]["人物编号"];
				     local add = JY.Person[pid]["医疗能力"]/4 + JY.Person[pid]["医疗能力"]*jl/160 + math.random(30);
					if add > JY.Person[pid]["医疗能力"]/2 then	--最大为医疗值的一半
						add = JY.Person[pid]["医疗能力"]/2 + math.random(30) + 30;
					end				
				    add = math.modf(add);		
				    WAR.Person[i]["内伤点数"] = (WAR.Person[i]["内伤点数"] or 0) + AddPersonAttrib(id, "受伤程度", -math.modf((add) / 5));
				    WAR.Person[i]["真伤点数"] = (WAR.Person[i]["真伤点数"] or 0) + AddPersonAttrib(id, "生命", add);
			    end
		    end  
	        DHdisplay(2842, 2853, str)
        end
	end
   
    if DT(pid,47) and JX(pid) and JLSD(10,20 + math.modf(WAR.SPIRIT[pid]-100),pid)  then--阿紫全屏苦痛
	    local jl = 20
	    jl = jl + limitX((WAR.SPIRIT[pid] - 100), 0, 40)
	    WAR.AZ=0
	    if WAR.ACT==1 or (WAR.ACT>1 and JLSD(10,jl,pid)) then
            for j = 0, WAR.PersonNum - 1 do
		        if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
		            local tid = WAR.Person[j]["人物编号"]
		            local tl= math.modf(JY.Person[tid]["受伤程度"]+JY.Person[tid]["中毒程度"])
		            WAR.AZ=WAR.AZ+tl
		            local kl = 100+math.modf ((WAR.SPIRIT[pid]/100)*tl)
		            if PersonKF(pid, 87) then
		                kl=kl+50
		            end
                    WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"],"生命",-kl)
						--JY.Person[WAR.Person[j]["人物编号"]]["生命"] = JY.Person[WAR.Person[j]["人物编号"]]["生命"] -kl
					WAR.XNXS[WAR.Person[j]["人物编号"]]	= 1
                end
            end
	        DHdisplay(2842, 2853, "紧那罗.苦痛颂歌")
	    end
	end
	
	if MPPD(pid) == 1 and (JLSD(10, 20 + MPDJ(pid) * 10, pid) or DT(pid, 46)) and (wugong == 160 or wugong == 169) then --星宿门派领悟
	    local jl = 20
	    jl = jl + limitX((WAR.SPIRIT[pid] - 100), 0, 40)	
	    if WAR.ACT == 1 or (WAR.ACT > 1 and JLSD(10,jl,pid)) then
            for j = 0, WAR.PersonNum - 1 do
		        if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
		            local tid = WAR.Person[j]["人物编号"]
		            local tl = math.modf(JY.Person[tid]["受伤程度"] + JY.Person[tid]["中毒程度"])
		            local kl = math.modf((WAR.SPIRIT[pid] / 1000) * tl)
		            if PersonKF(pid, 87) then
		                kl = kl + 5
		            end
					if wglw(pid,87) or DT(pid,46) then
						kl = kl + 5
					end
                    WAR.Person[j]["体力点数"] = (WAR.Person[j]["体力点数"] or 0) + AddPersonAttrib(tid, "体力", -kl)
					WAR.XNXS[WAR.Person[j]["人物编号"]]	= 1
                end
            end
	        DHdisplay(2842, 2853, "马屁神功.法螺大法")
	    end		
	end
   
    if (MPPD(pid) == 5 and PersonGT(pid, 108) and MPDJ(pid)> 2 and 
	    math.random(10)<(4+MPDJ(pid))) or ((DT(pid,615)) and JLSD(20,50,pid))   then --沼跃鱼：达摩院全屏
	    local jl = 50
	    jl = jl + limitX((WAR.SPIRIT[pid] - 100), 0, 40)
		if wglw1(pid,24) and WAR.LQZ[pid] == 100 then
		jl = jl + 30
		end
	    if WAR.ACT==1 or (WAR.ACT>1 and JLSD(10,jl,pid)) then
		    CleanWarMap(4, 0)
		    for i = 0, WAR.PersonNum - 1 do
			    if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
				    SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
			    end
		    end	
		    local aa=WAR.SPIRIT[pid]*2
		    local cc=math.modf(aa*100/150)
		    for j = 0, WAR.PersonNum -1 do
		        if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
			        local tid = WAR.Person[j]["人物编号"]
			        WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"],"生命",cc)
					--JY.Person[WAR.Person[j]["人物编号"]]["生命"] = JY.Person[WAR.Person[j]["人物编号"]]["生命"] + cc
		        end
		    end		
		    WAR.Person[WAR.CurID]["真伤点数"]=cc
		    WAR.WS = 1
            DHdisplay(1923, 1940, "天佛降世.普度众生")
        end	
	end
	
	
	--黄沙万里鞭特殊加成-金龙鞭
	if wugong == 78 and wglw1(pid,78) and JLSD(10, 35, pid) and JY.Person[pid]["武器"] == 51 then 
		WAR.QLKS = 1
		DHdisplay(3255, 3277, "从龙狂沙",M_Yellow)
	end	
	
	
   	if (wglw(pid,100) or (DT(pid,129) and PersonKF(pid,100)) or (wglw1(pid,18) and WAR.TZQJ3[pid] ~= nil)) and (JLSD(10,60,pid) or PersonGT(pid,100)) then --沼跃鱼：王重阳调理内息
	    if WAR.ACT==1 then
	        local XK = nil
			local NK = nil
			local NS = nil
			local mpdj=0.15
			if PersonGT(pid, 100) then
				mpdj=0.25
			end
			XK = 1000 * mpdj
			NK = XK*3
			NS = 5 + math.modf(JY.Person[pid]["受伤程度"]/10)
			WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", XK);
			WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", NK);
			WAR.Person[WAR.CurID]["内伤点数"] = (WAR.Person[WAR.CurID]["内伤点数"] or 0) + AddPersonAttrib(pid, "受伤程度", -NS);
			DHdisplay(1923, 1940, "先天真气调理内息");
		end
	 end
    
    if DT(pid,592) then 
	    local XK = nil
		local NK = nil
		local NS = nil
		local mpdj=0.15
		mpdj=0.25
	    XK = 1000 * mpdj
		NK = XK*3
		NS = 5 + math.modf(JY.Person[pid]["受伤程度"]/100)
		WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", 1);
		WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", NK);
		WAR.Person[WAR.CurID]["内伤点数"] = (WAR.Person[WAR.CurID]["内伤点数"] or 0) + AddPersonAttrib(pid, "受伤程度", -10);
		DHdisplay(10, 21, "独孤剑气");
	end	
	
    if DT(pid,600) then 
	    local XK = nil
		local NK = nil
		local NS = nil
		local mpdj=0.15
		mpdj=0.25
	    XK = 1000 * mpdj
		NK = XK*3
		NS = 5 + math.modf(JY.Person[pid]["受伤程度"]/10)
		WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", XK);
		WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", NK);
		WAR.Person[WAR.CurID]["内伤点数"] = (WAR.Person[WAR.CurID]["内伤点数"] or 0) + AddPersonAttrib(pid, "受伤程度", -NS);
		DHdisplay(2300, 2316, "玄武罡气");
	end

    if NF(pid) and juexing() > 1 then 
	    local XK = nil
		local NK = nil
		local NS = nil
		local mpdj=0.15
		mpdj=0.25
	    XK = 1000 * mpdj
		NK = XK*3
		NS = 5 + math.modf(JY.Person[pid]["受伤程度"]/10)
		WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", XK);
		WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", NK);
		WAR.Person[WAR.CurID]["内伤点数"] = (WAR.Person[WAR.CurID]["内伤点数"] or 0) + AddPersonAttrib(pid, "受伤程度", -NS);
		DHdisplay(771, 782, "龙元之气");
	end  

    if DT(pid,602) then 
	    local XK = nil
		local NK = nil
		local NS = nil
		local mpdj=0.15
		mpdj=0.25
	    XK = 1000 * mpdj
		NK = XK*3
		NS = 5 + math.modf(JY.Person[pid]["受伤程度"]/10)
		WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", XK);
		WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", NK);
		WAR.Person[WAR.CurID]["内伤点数"] = (WAR.Person[WAR.CurID]["内伤点数"] or 0) + AddPersonAttrib(pid, "受伤程度", -NS);
		DHdisplay(1173, 1186, "剑气调息");
	end

    if T3XYK(pid) and juexing() > 0 and JLSD(10, 60, pid) then 
	    local XK = nil
		local NK = nil
		local NS = nil
		local mpdj=0.05
		mpdj=0.15
	    XK = 1000 * mpdj
		NK = XK*2
		NS = 5 + math.modf(JY.Person[pid]["受伤程度"]/20)
		WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", XK);
		WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", NK);
		WAR.Person[WAR.CurID]["内伤点数"] = (WAR.Person[WAR.CurID]["内伤点数"] or 0) + AddPersonAttrib(pid, "受伤程度", -NS);
		DHdisplay(443, 455, "封狼居胥");
	end

    if MPPD(pid) == 18 and MPDJ(pid) >= 3 and PersonGT(pid,189) and JLSD(10, 50, pid) then --崆峒堂主
	    local a = JY.Person[pid]["拳掌功夫"]
		local b = JY.Person[pid]["特殊兵器"]
		local c = JY.Person[pid]["暗器技巧"]
		local d = a + b + c
		WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", d);
		WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", d);
		DHdisplay(1400, 1419, "上清秘气");
	end

    if MPPD(pid)==16 and (JLSD(10,40,pid) and PersonGT(pid,100)) then --沼跃鱼：全真教调理内息
	    local XK = nil
		local NK = nil
		local NS = nil
		local NS2 = nil
		local mm = 1500
		local str="先天真气"
		if JY.Person[pid]["生命最大值"] < 1500 then
			mm = JY.Person[pid]["生命最大值"]
		end
			local nn = 10000
			if JY.Person[pid]["内力最大值"] < 10000 then
				nn = JY.Person[pid]["内力最大值"]
			end
				local mpdj=MPDJ(pid)*0.05			
	            XK = math.modf((mm - JY.Person[pid]["生命"]) * mpdj)
				NK = math.modf((nn - JY.Person[pid]["内力"]) * mpdj)
				NS = 5 + math.modf(JY.Person[pid]["受伤程度"]/10)
				NS2 = 5 + math.modf(JY.Person[pid]["中毒程度"]/10)
				WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", XK);
				WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", NK);
				WAR.Person[WAR.CurID]["内伤点数"] = (WAR.Person[WAR.CurID]["内伤点数"] or 0) + AddPersonAttrib(pid, "受伤程度", -NS);
				WAR.Person[WAR.CurID]["中毒点数"] = (WAR.Person[WAR.CurID]["中毒点数"] or 0) + AddPersonAttrib(pid, "中毒程度", -NS2);
				DHdisplay(1090, 1103, str.."恢复");
	end
   
    if (T1LEQ(pid) and juexing()>0) and (JLSD(10,60,pid) or juexing()>1) then --沼跃鱼：逍遥心法和逍遥鹏飞决
	    local XK = nil
		local NK = nil
		local NS = nil
		local mm = 1500
		local str="逍遥心法"
		if JY.Person[pid]["生命最大值"] < 1500 then
			mm = JY.Person[pid]["生命最大值"]
		end
			local nn = 10000
            if JY.Person[pid]["内力最大值"] < 10000 then
				nn = JY.Person[pid]["内力最大值"]
			end
			local mpdj=0.15			
			if juexing()>1 then
				mpdj=0.25
                str="逍遥鹏飞诀"				
			end
	        XK = math.modf((mm - JY.Person[pid]["生命"]) * mpdj)
			NK = math.modf((nn - JY.Person[pid]["内力"]) * mpdj)
			NS = 5 + math.modf(JY.Person[pid]["受伤程度"]/10)
			WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", XK);
			WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", NK);
			WAR.Person[WAR.CurID]["内伤点数"] = (WAR.Person[WAR.CurID]["内伤点数"] or 0) + AddPersonAttrib(pid, "受伤程度", -NS);
			DHdisplay(1090, 1103, str.."恢复");
	end
   
   	if DT(pid,4) and JX(pid) then --沼跃鱼：阎基千金
	    local XK = nil
		local NK = nil
		local NS = nil
		local NT = nil
	    local mpdj=JY.Person[pid]["医疗能力"]/1000
	    XK = 1000 * mpdj
	    NK = XK*3
		NS = 5 + math.modf(JY.Person[pid]["受伤程度"]/10)
		NT = NS*2
	    WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", XK);
		WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", NK);
		WAR.Person[WAR.CurID]["内伤点数"] = (WAR.Person[WAR.CurID]["内伤点数"] or 0) + AddPersonAttrib(pid, "受伤程度", -NS);
		WAR.Person[WAR.CurID]["体力点数"]= (WAR.Person[WAR.CurID]["体力点数"]or 0) + AddPersonAttrib(pid, "体力", NT)
		DHdisplay(1090, 1103, "千金药方.华佗养身");
	end
    
    --东方不败
    if DT(pid, 27) then
        WAR.WS = 1
    end
	
    --日月神教三尸脑神丹
    if WAR.SSNS[pid] ~= nil then 
	    WAR.WS = 0
    end
    --乔峰，郭靖，洪七公，使用降龙十八掌
    if (DT(pid , 50) or DT(pid , 55) or DT(pid , 69)) and JY.Person[pid]["武功" .. wugongnum] == 26 then
        WAR.WS = 1
    end
    if jtyl(pid) then --谢无悠
        WAR.WS = 1
    end
    --令狐冲 使用独孤九剑
    if DT(pid, 35) and JY.Person[pid]["武功" .. wugongnum] == 47 then
        WAR.WS = 1
    end
	--扫地僧易筋经
    if DT(pid, 114) and JY.Person[pid]["武功" .. wugongnum] == 108 then
        WAR.WS = 1
    end    
	if pid == 0 and putong() == 13 and yongan(wugong) then
		WAR.WS = 1
	end
	if hasTF(pid, 131) then
		WAR.WS = 1
	end
	
    --金轮法王 攻击杀集气+2000
    if DT(pid, 62) or DT(pid, 594) or DT(pid, 662) then
      ng = ng + 2000
    end
	
	if hasTF(pid, 21) then
		ng = ng + 1000
	end
    
	if GX(pid) and JX(pid) then --郭襄觉醒杀集气+1000
		ng = ng + 1000
	end
	
	if DT(pid, 630) then --夏雪宜气攻
		ng = ng + math.modf((JY.Person[pid]["生命最大值"] - JY.Person[pid]["生命"]) * 2)
	end
	
	if (DT(pid, 5) or DT(pid, 9) or DT(pid, 666)) or wglw1(pid, 46) then
	   ng = ng + 800
    end
	
    if WAR.XSJS == 1 then
		ng = ng + 1250
	end 		
	
    if BJY(pid) and WAR.LYFH > 0 then
		local WZTS = {"第一周天","第二周天","第三周天"}	
	    local CHD = 10
		DHdisplay(658, 677, "周天之力")
		WAR.Person[id][CC.TXWZ2] = WZTS[CHD];
	    WAR.Person[id][CC.TXDH] = 119
	    ng = ng + 500 * (8 - WAR.LYFH)
		WAR.WS = 1
	end	
		
	if DT(pid, 129) and WAR.WCY3>0 then--沼跃鱼：重阳真打
	    local WZTS = {"神通真打.天枢","神通真打.天璇","神通真打.天玑","神通真打.天权","神通真打.玉衡","神通真打.开阳","神通真打.瑶光"}
	    local CHD=WAR.WCY3
	    DHdisplay(1908, 1922, "论剑模式.北斗装攻")
	    WAR.Person[id][CC.TXWZ2] = WZTS[CHD];
	    WAR.Person[id][CC.TXDH] = 132
	    ng = ng + 500*(8-WAR.WCY3)
	    WAR.MCF2 = 1
        WAR.WS = 1
    end
	
	if DT(pid, 65) and WAR.WCY4>0 then--沼跃鱼：剑气六脉
	    local WZTS = {"气剑六指.少泽","气剑六指.少冲","气剑六指.关冲","气剑六指.中冲","气剑六指.商阳","气剑六指.少商"}
	    local CHD=WAR.WCY4
	    DHdisplay(1923, 1940, "一阳精髓.气剑贯通")
	    DHdisplay(770, 783, "剑指合一.六脉转龙")
	    WAR.Person[id][CC.TXWZ2] = WZTS[CHD];
	    WAR.Person[id][CC.TXDH] = 106
	    WAR.YD=WAR.WCY4
	    WAR.MCF2 = 1
        WAR.WS = 1
	end

	if T9ZY(pid) and JY.Person[pid]["武器"] == 255 and juexing() >= 2 then --赵云+亮银枪
		ng = ng + 1500
	end
	
    --梅超风，使用九阴白骨爪，伤害加倍
    if DT(pid , 78) and JY.Person[pid]["武功" .. wugongnum] == 11 then
        WAR.MCF = 1
        WAR.Person[id][CC.TXWZ3] = CC.WARS46
    end
	
	if pid == 0 and putong() == 10 and juexing() > 0 and WAR.LKZX2 == 0 then
		local pz = math.modf(JY.Person[pid]["资质"] / 4)
		if JLSD(10, 30 + pz, pid) then
			if WAR.Person[WAR.CurID][CC.TXWZ1] ~= nil then
				WAR.Person[WAR.CurID][CC.TXWZ1] = WAR.Person[WAR.CurID][CC.TXWZ1] .. "・天地随我心"
			else
				WAR.Person[WAR.CurID][CC.TXWZ1] = "天地随我心"
			end		
			WAR.Person[WAR.CurID][CC.TXDH] = 152		
			for i = 0, WAR.PersonNum - 1 do
				if WAR.Person[i]["死亡"] == false and RealJL(WAR.CurID, i, 5) and i ~= WAR.CurID then
					local tid = WAR.Person[i]["人物编号"]
					WAR.LKZX2 = WAR.LKZX2 + math.modf(JY.Person[tid]["攻击力"] * 0.15)
				end
			end
		end
	end
	
	if hasTF(pid, 112) and JLSD(10, 60, pid) and WAR.ACT == 1 then --异常状态
		WAR.YANGKANG = 1
	end
    
    --[[if WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 and GetS(86, 2, 11, 5) == 3 then
		DHdisplay(1653, 1665, "盘龙舞・天机变")	
		WAR.YANGKANG = 1
	end]]
	
    --花铁干，使用中平枪法，杀集气+1000
    if DT(pid , 52) and JY.Person[pid]["武功" .. wugongnum] == 70 then
        WAR.Person[id][CC.TXWZ3] = CC.WARS47
        ng = ng + 1000
    end
    
    --蓝凤凰，何铁手，攻击伤害提高10%
    if DT(pid, 25) or DT(pid, 83) then
        WAR.TFH = 1
    end
    
    --温青青，使用雷震剑法，伤害随机提高，最高为3倍
    if DT(pid , 91) and JY.Person[pid]["武功" .. wugongnum] == 28 then
        WAR.WQQ = 1
    end
    
	if T7DFWM(pid) and WAR.DFWM2 == 5 then --东方未明暗系特技附加不良状态
	    WAR.YANGKANG = 1
	end	
	
    --霍青桐，使用三分剑法，伤体力15
    if DT(pid , 74) and JY.Person[pid]["武功" .. wugongnum] == 29 then
        WAR.HQT = 1
    end
 	
	if ((wugong == 73 and DT(pid, 34)) or (wugong==38 and PersonKF(pid,73)) 
		or (wugong==73 and PersonKF(pid,38)))
		and (DT(pid, 34) or JLSD(20,70,pid) or (DT(pid , 581) and math.random(10) <= 5) or WAR.ZYHB1[pid] ~= nil) then --琴+箫=笑傲江湖50%全体生命+50
	    for j = 0, WAR.PersonNum - 1 do
	        if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
	            local tmpid=WAR.Person[j]["人物编号"]
				WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(tmpid, "生命", 50)
				if DT(pid, 581) then --pid == 581 武骧金星：单通判定修正
					WAR.Person[j]["体力点数"] = (WAR.Person[j]["体力点数"] or 0) + AddPersonAttrib(tmpid, "体力", 3)
				end
	            WAR.Person[id][CC.TXWZ3] = "江湖笑 烟雨遥"
	            WAR.Person[id][CC.TXDH] = 89
				WAR.XNXS[tmpid] = 1
	        end
	    end	
	end	

    if pid==0 and T4WXS(0) and WAR.SHITOUDAO==1 then --王小石刀法特效-集气100，-生命50
		for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				local tmpid=WAR.Person[j]["人物编号"]
				WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - 300
				WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(tmpid, "生命", -100)
				--JY.Person[WAR.Person[j]["人物编号"]]["生命"] = JY.Person[WAR.Person[j]["人物编号"]]["生命"] - 100
			    if JY.Person[WAR.Person[j]["人物编号"]]["生命"]<=0 then
					JY.Person[WAR.Person[j]["人物编号"]]["生命"]=1
					WAR.FXXS[WAR.Person[j]["人物编号"]]=1 --封穴判定
					WAR.FXDS[WAR.Person[j]["人物编号"]]=50 --封穴点数	
				end
				WAR.XNXS[tmpid] = 1
			end
		end		
	end
    
	if wglw1(pid,155) and WAR.Actup[pid]~=nil and yongdao(wugong) or DT(pid,665) then --五指秘刀蓄力刀法效果
		for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				local tmpid=WAR.Person[j]["人物编号"]
				WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(tmpid, "生命", -(math.modf(JY.Person[WAR.Person[j]["人物编号"]]["生命"]*0.2)))
				--JY.Person[WAR.Person[j]["人物编号"]]["生命"] = JY.Person[WAR.Person[j]["人物编号"]]["生命"] 
			    if JY.Person[WAR.Person[j]["人物编号"]]["生命"]<=0 then
					JY.Person[WAR.Person[j]["人物编号"]]["生命"]=1
					WAR.FXXS[WAR.Person[j]["人物编号"]]=1 --封穴判定
					WAR.FXDS[WAR.Person[j]["人物编号"]]=50 --封穴点数	
				end
				WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
			end
		end		
	end
	
	 if DT(pid,72) and JX(pid) and WAR.DJDAO==1 then --沼跃鱼：田归农狂龙斩特效-集气100，-生命50
		for j = 0, WAR.PersonNum - 1 do
			local tmpid=WAR.Person[j]["人物编号"]
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - 100
				WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(tmpid, "生命", -50)
			    if JY.Person[WAR.Person[j]["人物编号"]]["生命"]<=0 then
					JY.Person[WAR.Person[j]["人物编号"]]["生命"]=1
					WAR.FXXS[WAR.Person[j]["人物编号"]]=1 --封穴判定
					WAR.FXDS[WAR.Person[j]["人物编号"]]=25 --封穴点数	
				end
				WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
			end
		end		
	end

	if ((T9ZY(pid) and wugong == 112 and wglw1(pid,68)) or (wglw1(pid,68) and wugong == 68)) and WAR.Actup[pid]~=nil  then --杨家枪领悟
		if WAR.ACT == 1 then
			DHdisplay(345,358,"燎原百击・五十势・无枪势")
		end	
		local aa = WAR.HOT[pid] or 0
		for j = 0, WAR.PersonNum - 1 do
			local tmpid=WAR.Person[j]["人物编号"]
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(tmpid, "生命", - math.modf(5*aa))
				--JY.Person[WAR.Person[j]["人物编号"]]["生命"] = JY.Person[WAR.Person[j]["人物编号"]]["生命"] - math.modf(5*aa)
			    if JY.Person[WAR.Person[j]["人物编号"]]["生命"]<=0 then
					JY.Person[WAR.Person[j]["人物编号"]]["生命"]=1
					WAR.FXXS[WAR.Person[j]["人物编号"]]=1 --封穴判定
					WAR.FXDS[WAR.Person[j]["人物编号"]]=25 --封穴点数	
				end
				WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
			end
		end		
	end


	if T8LXY(pid) then --沼跃鱼：李逍遥御剑术改进
		if (JLSD(10, 10 + math.modf(25 + (5 * wgnumber(0, 2))), pid)) or (ZYBF(pid) and (JLSD(10, 10 + math.modf(25 + (5 * wgnumber(0, 2))), pid))) or ZYJ(pid) then --15%，每学一个剑法多5%
			local word = "御剑术"
			WAR.LXYYJ = 1
			if juexing() >= 1 then
				WAR.LXYYJ = 2
				word = "万剑诀"
			end
			if juexing() >= 2 then
				WAR.LXYYJ = 3
				word = "天剑"
			end
			if juexing() >= 3 and ZYJ(pid) then
				WAR.LXYYJ = 4
				word = "剑神"			
			end
			if WAR.Person[id][CC.TXDH] == nil then
				WAR.Person[id][CC.TXDH] = 89
			end
			if WAR.Person[id][CC.TXWZ1] ~= nil then
				WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" ..word
			else
				WAR.Person[id][CC.TXWZ1] = word
			end			
		end
	
		if WAR.LXYYJ >= 2 then
			for j = 0, WAR.PersonNum - 1 do
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
					WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - 100
					if WAR.LXYYJ >= 3 then
						local tmppid = WAR.Person[j]["人物编号"]
						WAR.Person[j]["壬说闶"] = (WAR.Person[j]["壬说闶"] or 0) + AddPersonAttrib(tmppid, "受伤程度", math.random(1, 10))
					end
					WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
				end
			end		
		end
	end
	
	local t, s = noangry(pid)
	if t ~= -1 then		
		for j = 0, WAR.PersonNum - 1 do		
			local ttt = WAR.Person[j]["人物编号"]
			if WAR.Person[j]["死亡"] == false and 
				WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				WAR.LQZ[ttt] = limitX((WAR.LQZ[ttt] or 0) - t, 0, 100)
			end
		end
		if WAR.Person[id][CC.TXDH] == nil then
			WAR.Person[id][CC.TXDH] = 89
		end
		if WAR.Person[id][CC.TXWZ1] ~= nil then
			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" ..s
		else
			WAR.Person[id][CC.TXWZ1] = s
		end				
	end
	
	local t, s = paralyze(pid)
	if t ~= -1 then
		for j = 0, WAR.PersonNum - 1 do		
			local ttt = WAR.Person[j]["人物编号"]
			if WAR.Person[j]["死亡"] == false and 
				WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				WAR.FXXS[ttt] = 1
				WAR.FXDS[ttt] = limitX((WAR.FXDS[ttt] or 0) + t, 0, 50)
			end
		end
		if WAR.Person[id][CC.TXDH] == nil then
			WAR.Person[id][CC.TXDH] = 89
		end
		if WAR.Person[id][CC.TXWZ1] ~= nil then
			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" ..s
		else
			WAR.Person[id][CC.TXWZ1] = s
		end		
	end
	
    --杨过 攻击，非吼 全体集气减100
	local t, s = allkillspeed(pid)
    if t ~= -1 then
        for j = 0, WAR.PersonNum - 1 do
		    local ttt = WAR.Person[j]["人物编号"]
            if WAR.Person[j]["死亡"] == false and not nokillspeed(ttt) and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				if nokillspeed(ttt) then
				else
					if jtyl(WAR.Person[j]["人物编号"]) then --谢无悠
						t = -t 
					end   
					WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - t
					if DT(pid,58) and ZYBF(pid) then
						WAR.Person[j]["壬说闶"] = (WAR.Person[j]["壬说闶"] or 0) + AddPersonAttrib(ttt, "受伤程度", math.random(1, 10))
					end
					WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
				end	
            end
        end
        if WAR.Person[id][CC.TXDH] == nil then
            WAR.Person[id][CC.TXDH] = 89
        end
        if WAR.Person[id][CC.TXWZ1] ~= nil and s ~= "" then
      	    WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" ..s
        else
      	    WAR.Person[id][CC.TXWZ1] = s
        end
    end
	
    --谢无悠
    if jtyl(pid) and (WAR.JTYL == 1 or WAR.JTYL == 9) then
        for j = 0, WAR.PersonNum - 1 do
		    local ttt = WAR.Person[j]["人物编号"]
            if WAR.Person[j]["死亡"] == false and 
			    WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and not jtyl(WAR.Person[j]["人物编号"]) then
                WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - 200
            end
        end
        if WAR.Person[id][CC.TXDH] == nil then
            WAR.Person[id][CC.TXDH] = 89
        end
    end
    
    --萧雨客
    if T3XYK(pid) and WAR.LQZ[pid] == 100 and juexing() > 1 then
        for j = 0, WAR.PersonNum - 1 do
		    local ttt = WAR.Person[j]["人物编号"]
            if WAR.Person[j]["死亡"] == false and 
			    WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and not jtyl(WAR.Person[j]["人物编号"]) then
                WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - 1000
            end
        end
    end	
	 
    --降龙外劲杀集气
	if wugong == 26 and ((DT(pid, 50) or DT(pid,617)) or wglw1(pid,26)) and JLSD(10, 60, pid) then
	    for j = 0, WAR.PersonNum - 1 do
		    local ttt = WAR.Person[j]["人物编号"]
            if WAR.Person[j]["死亡"] == false and 
			    WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and not jtyl(WAR.Person[j]["人物编号"]) then
                WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - 200
            end
        end
        if WAR.Person[id][CC.TXDH] == nil then
            WAR.Person[id][CC.TXDH] = 120
        end	
    end	 
	
    --杨过吼
    if WAR.XK == 2 and DT(pid , 58) and WAR.Person[WAR.CurID]["我方"] == WAR.XK2 then
        for e = 0, WAR.PersonNum - 1 do
            if WAR.Person[e]["死亡"] == false and WAR.Person[e]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
                WAR.Person[e].TimeAdd = WAR.Person[e].TimeAdd - math.modf(JY.Person[WAR.Person[WAR.CurID]["人物编号"]]["内力"] / 5)
                if WAR.Person[e].Time < -450 then
                    WAR.Person[e].Time = -450
                end
                WAR.Person[e]["内力点数"] = (WAR.Person[e]["内力点数"] or 0) + AddPersonAttrib(WAR.Person[e]["人物编号"],"内力",- math.modf(JY.Person[WAR.Person[WAR.CurID]["人物编号"]]["内力"] / 5))
				--JY.Person[WAR.Person[e]["人物编号"]]["内力"] = JY.Person[WAR.Person[e]["人物编号"]]["内力"] - math.modf(JY.Person[WAR.Person[WAR.CurID]["人物编号"]]["内力"] / 5)
                if JY.Person[WAR.Person[e]["人物编号"]]["内力"] < 0 then
                    JY.Person[WAR.Person[e]["人物编号"]]["内力"] = 0
                end
                WAR.Person[e]["真伤点数"] = (WAR.Person[e]["真伤点数"] or 0) + AddPersonAttrib(WAR.Person[e]["人物编号"],"生命",- math.modf(JY.Person[WAR.Person[WAR.CurID]["人物编号"]]["内力"] / 25))
				--JY.Person[WAR.Person[e]["人物编号"]]["生命"] = JY.Person[WAR.Person[e]["人物编号"]]["生命"] - math.modf(JY.Person[WAR.Person[WAR.CurID]["人物编号"]]["内力"] / 25)
				if JY.Person[WAR.Person[e]["人物编号"]]["生命"] < 0 then
					JY.Person[WAR.Person[e]["人物编号"]]["生命"] = 0
				end
				WAR.XNXS[WAR.Person[e]["人物编号"]] = 1
			end
		end
        
		--吼过之后，内力为0，内力最大值-100，并且用声望控制上限
		if inteam(pid) then
			JY.Person[pid]["内力"] = 0
			JY.Person[pid]["内力最大值"] = JY.Person[pid]["内力最大值"] - 100
			JY.Person[578]["半身像"] = JY.Person[578]["半身像"] + 1	--武骧金星：修正杨过内力上限BUG
		else
			WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", -1000)  --做敌方内力只减1000，额
		end
		  
		if JY.Person[pid]["内力最大值"] < 500 then
			JY.Person[pid]["内力最大值"] = 500
		end
		if WAR.Person[id][CC.TXWZ1] ~= nil then
			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" ..CC.WARS49   --西狂之震怒・雷霆狂啸
		else
			WAR.Person[id][CC.TXWZ1] = CC.WARS49   --西狂之震怒・雷霆狂啸
		end
			WAR.Person[id][CC.TXDH] = 6
			WAR.XK = 3
	end    
      
    --任盈盈
	if DT(pid, 73) and JLSD(10, 60, pid) then
		WAR.Person[id][CC.TXWZ3] = CC.WARS50
		WAR.Person[id][CC.TXDH] = 89
		for j = 0, WAR.PersonNum - 1 do
		    if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
			    WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"],"生命",-100)
				--JY.Person[WAR.Person[j]["人物编号"]]["生命"] = JY.Person[WAR.Person[j]["人物编号"]]["生命"] - 100
			    if JY.Person[WAR.Person[j]["人物编号"]]["生命"] <= 0 then
				    JY.Person[WAR.Person[j]["人物编号"]]["生命"] = 1
			    end
				WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
		    end
		end		
	end
	
	if T7DFWM(pid) and juexing() >= 1 then --东方未明满天流星群伤80
	    local xihe= sixi(pid, 1)+sixi(pid, 2)+sixi(pid, 3)+sixi(pid, 4)+ sixi(pid, 5)
		if xihe >= 400 and JLSD(10, 70, pid) then
			if WAR.Person[id][CC.TXWZ3] == nil then
				WAR.Person[id][CC.TXWZ3] = "满天流星"
			else
				WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+满天流星"
			end
			WAR.Person[id][CC.TXDH] = 89
			for j = 0, WAR.PersonNum - 1 do
			  if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"],"生命",-80)
				--JY.Person[WAR.Person[j]["人物编号"]]["生命"] = JY.Person[WAR.Person[j]["人物编号"]]["生命"] - 80
				if JY.Person[WAR.Person[j]["人物编号"]]["生命"] <= 0 then
					JY.Person[WAR.Person[j]["人物编号"]]["生命"] = 1
				end
				WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
			  end
			end			
		end	
	end

    --[[ if WAR.SQGJ==1 then
	  WAR.ZYHB=0
	  WAR.ACT=10
      WAR.WS = 1
	  ng=ng+1000+WAR.XWZG*100]]
      
    if DT(pid, 600) then --武无敌十方皆灭
	    WAR.WS = 1
	    local xihe= sixi(pid, 1)+sixi(pid, 2)+sixi(pid, 3)+sixi(pid, 4)+ sixi(pid, 5)
		if xihe >= 700 and JLSD(30, 60, pid) then
		    for i = 12,24 do
		        for i = 1, 15 do
                    for j = 1, 15 do
                        SetWarMap(x + i - 1, y + j - 1, 4, 1)
                        SetWarMap(x - i + 1, y + j - 1, 4, 1)
                        SetWarMap(x + i - 1, y - j + 1, 4, 1)
                        SetWarMap(x - i + 1, y - j + 1, 4, 1)
                    end
                end
			    NewDrawString(-1,-1,"玄武真功・十方皆灭",C_GOLD,35+i)
			    ShowScreen();
			    if i==24 then
				    Cls();							
				    NewDrawString(-1,-1,"玄武真功・十方皆灭",C_GOLD,35+i)
				    ShowScreen();
				    lib.Delay(500);
			    else
				    lib.Delay(1);
			    end						
		    end
	    end
	end	
	
    if (PersonGT(pid, 181) and (DT(pid, 455))) or (wglw(pid,181) and JLSD(10,60,pid) and PersonGTJL(pid, 181,WAR.NGJL)) then --玄武真功十方皆灭
	    WAR.WS = 1
	    local xihe = sixi(pid,1) + sixi(pid,2) + sixi(pid,3) + sixi(pid,4) + sixi(pid,5)
		if xihe >= 700 and JLSD(30, 60, pid) then
		    JY.Person[pid]["内力"] = math.modf(JY.Person[pid]["内力"] * 0.3)
            for i = 12,24 do
		        for i = 1, 8 do
                    for j = 1, 8 do
                        SetWarMap(x + i - 1, y + j - 1, 4, 1)
                        SetWarMap(x - i + 1, y + j - 1, 4, 1)
                        SetWarMap(x + i - 1, y - j + 1, 4, 1)
                        SetWarMap(x - i + 1, y - j + 1, 4, 1)
                    end
                end
			    NewDrawString(-1,-1,"玄武真功・十方皆灭",C_GOLD,35+i)
			    ShowScreen();
			    if i==24 then
				    Cls();							
				    NewDrawString(-1,-1,"玄武真功・十方皆灭",C_GOLD,35+i)
				    ShowScreen();
				    lib.Delay(500);
			    else
				    lib.Delay(1);
			    end						
		    end
	    end
	end			
			
	if WAR.ACT == 1 and 
		((getHZ(pid, 17) and JLSD(10, 30, pid)) or (hasTF(pid, 38) and JLSD(10, 60, pid))) then 
		if WAR.Person[id][CC.TXWZ3] == nil then
			WAR.Person[id][CC.TXWZ3] = "含沙射影"
		else
			WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+含沙射影"
		end
		WAR.Person[id][CC.TXDH] = 170
		for j = 0, WAR.PersonNum - 1 do
		    if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"],"生命",-80)
				--JY.Person[WAR.Person[j]["人物编号"]]["生命"] = JY.Person[WAR.Person[j]["人物编号"]]["生命"] - 80
				if JY.Person[WAR.Person[j]["人物编号"]]["生命"] <= 0 then
					JY.Person[WAR.Person[j]["人物编号"]]["生命"] = 1
				end
				WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
		    end
		end			
	end	  
   
    if (WAR.KHNP1[pid] ~= nil or DT(pid,27)) and JLSD(0,30,pid) then 
	   	for j = 0, WAR.PersonNum - 1 do
		    if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
			WAR.KHCM[WAR.Person[j]["人物编号"]] = 2
			end
		end
		WAR.Person[id][CC.TXWZ1] = "葵花真解・葵花百劫"
	end	
  
    if hasTF(pid, 146) and JLSD(10, 40, pid) then 
	   	for j = 0, WAR.PersonNum - 1 do
		    if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
			WAR.KHCM[WAR.Person[j]["人物编号"]] = 2
			end
		end
		WAR.Person[id][CC.TXWZ3] = "乌云蔽日"
	end	

    if BJY(pid) and yongquan(wugong) and JY.Person[0]["拳掌功夫"] > 250 and JLSD(10,40,pid) then 
	   	for j = 0, WAR.PersonNum - 1 do
		    if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
			WAR.KHCM[WAR.Person[j]["人物编号"]] = 2
			end
		end
		if WAR.Person[id][CC.TXWZ3] ~= nil then
      	    WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+".."排云掌・乌云蔽日"
        else
      	    WAR.Person[id][CC.TXWZ3] = "排云掌・乌云蔽日"
        end	   
	end	

    --峨眉使者限定
	if (GX(pid) and JX(pid)) and JLSD(10,60,pid) then
		for j = 0, WAR.PersonNum - 1 do
		    if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
			WAR.KHCM[WAR.Person[j]["人物编号"]] = 2
			end
		end
		if WAR.Person[id][CC.TXWZ3] ~= nil then
      	    WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+".."玉女丹青・西子洗面"
        else
      	    WAR.Person[id][CC.TXWZ3] = "玉女丹青・西子洗面"
        end	
	elseif (MPPD(pid) == 17 and MPDJ(pid) >= 2) and PersonGT(pid,153)then
		if sixi(pid,2) >= 300 and (sixi(pid,1) + sixi(pid,2)) >= 450 then
			if wugong == 41 or (yongjian(wugong) and JLSD(10,60,pid)) then
				for j = 0, WAR.PersonNum - 1 do
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				WAR.KHCM[WAR.Person[j]["人物编号"]] = 2
				end
				end
				if WAR.Person[id][CC.TXWZ3] ~= nil then
					WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+".."玉女丹青・西子洗面"
				else
					WAR.Person[id][CC.TXWZ3] = "玉女丹青・西子洗面"
				end	
			elseif not yongjian(wugong) and JLSD(10,35,pid) then
				for j = 0, WAR.PersonNum - 1 do
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				WAR.KHCM[WAR.Person[j]["人物编号"]] = 2
				end
				end
				if WAR.Person[id][CC.TXWZ3] ~= nil then
					WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+".."玉女丹青・西子洗面"
				else
					WAR.Person[id][CC.TXWZ3] = "玉女丹青・西子洗面"
				end
			end
		end	
	end
	
	
    --if WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 and GetS(86, 2, 11, 5) == 3 and JLSD(10, 60, pid) then
		--DHdisplay(1653, 1665, "盘龙舞・天地暗")
		--for j = 0, WAR.PersonNum - 1 do
		    --if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
			--WAR.KHCM[WAR.Person[j]["人物编号"]] = 2
			--end
		--end
	--end	

	if wglw(pid,89) or (PersonKF(pid,89) and DT(pid,19)) then --紫霞剑系
	    if WAR.ZXJQ[pid] ~= nil and WAR.ZXJQ[pid] > 0 then  
	        if WAR.Person[id][CC.TXWZ1] ~= nil then
      	        WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+".."紫霞剑气"
            else
      	        WAR.Person[id][CC.TXWZ1] = "紫霞剑气"
            end	   
	    end
	end
	
    if NF(pid) then --创刀
	    if WAR.CDDQ[pid] ~= nil and WAR.CDDQ[pid] > 0 then  
	        if WAR.Person[id][CC.TXWZ2] ~= nil then
      	        WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].."+".."创刀刀气"
            else
      	        WAR.Person[id][CC.TXWZ2] = "创刀刀气"
            end	   
	    end
	end	
	
    if BJY(pid) then --霍家剑气
	    if WAR.HJJQ[pid] ~= nil and WAR.HJJQ[pid] > 0 then  
	        if WAR.Person[id][CC.TXWZ2] ~= nil then
      	        WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].."+".."霍家剑气"
            else
      	        WAR.Person[id][CC.TXWZ2] = "霍家剑气"
            end	   
	    end
	end		
	
    --张三丰 40%万法自然，集气从500开始 沼跃鱼：未触发则太极之形参数归零
    if DT(pid, 5) then
	   if JLSD(10, 40, pid) then
            WAR.ZSF = 1
            WAR.Person[id][CC.TXWZ1] = CC.WARS52
	   else
	        WAR.TJZX1 =0 
	        WAR.TJZX2=0
	   end
    end
	if DT(pid,5) and (pid==5 or pid == 0) then ----
	    if JY.Person[pid]["生命"] > 0 then 
	        WAR.TJZS[1000+pid] = JY.Person[pid]["生命"]
	    end
	end
	if jtyl(pid) then--1-26-
	   if JY.Person[pid]["生命"] > 0 then
	        WAR.SJSM[100+pid] = JY.Person[pid]["生命"]
	   end
	end
	
	if wssz(pid) then--1-26-
	   if JY.Person[pid]["生命"] > 0 then
	        WAR.SSFN[100+pid] = JY.Person[pid]["生命"]
	   end
	end
	
	if MPPD(pid) == 9 and (DT(pid, 93) or yongan(wugong)) then 
        if WAR.TMMS[pid] == 1 then
            if WAR.ACT == 1 then --唐门模式夺魄箭
                if WAR.DPJ[pid] == nil then
                    WAR.DPJ[pid] = 1
	            else   
                    WAR.DPJ[pid] = WAR.DPJ[pid] +1
	            end
	            if (WAR.DPJ[pid] < 3 and WAR.BJ == 1 and JLSD(10,40,pid)) or WAR.DPJ[pid] == 3 then 
	                WAR.TMMS[100+pid] = 1
	            end
	            if WAR.DPJ[pid] == 4 and WAR.BJ == 1 then
		            if JLSD(10,60,pid) then 
	      	            if WAR.Person[id][CC.TXWZ3] ~= nil then
      	                    WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+".."妙手连环"
                        else
      	                    WAR.Person[id][CC.TXWZ3] = "妙手连环"
                        end
		                    WAR.TMMS[300+pid] = 1
			                WAR.TMMS[100+pid] = 1
			        end
	                    --WAR.TMMS[100+pid] = 1
	            end
	            if WAR.DPJ[pid] > 4 then 
	                WAR.DPJ[pid] = 1 
	            end 
		            WAR.TMMS[200+pid] = WAR.DPJ[pid]
	                if WAR.DPJ[pid] == 4 then
	      	            if WAR.Person[id][CC.TXWZ1] ~= nil then
      	                    WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+".."追命无声"
                        else
      	                    WAR.Person[id][CC.TXWZ1] = "追命无声"
                        end
	                end
		        end 
		        if JLSD(10,40,pid) then 
		            WAR.LZZ = 1--雷震子
	      	        if WAR.Person[id][CC.TXWZ3] ~= nil then
      	                WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+".."雷震子"
                    else
      	                WAR.Person[id][CC.TXWZ3] = "雷震子"
                    end
		        end
		        if JLSD(10,40,pid) then 
		            WAR.HXB = 1--
	      	        if WAR.Person[id][CC.TXWZ3] ~= nil then
      	                WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+".."化血镖"
                    else
      	                WAR.Person[id][CC.TXWZ3] = "化血镖"
                    end
		        end
		        if JLSD(10,40,pid) then 
		            WAR.CXN = 1--
	      	        if WAR.Person[id][CC.TXWZ3] ~= nil then
      	                WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+".."穿心弩"
                    else
      	                WAR.Person[id][CC.TXWZ3] = "穿心弩"
                    end
		        end
		        if JLSD(10,40,pid) then 
		            WAR.ZXJ = 1--
	      	        if WAR.Person[id][CC.TXWZ3] ~= nil then
      	                WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+".."逐星箭"
                    else
      	                WAR.Person[id][CC.TXWZ3] = "逐星箭"
                    end
		        end
	        end  
            if WAR.TMMS[pid] == 2 then
		        if JLSD(10,40,pid) then 
		            WAR.HXB = 1--
	      	        if WAR.Person[id][CC.TXWZ3] ~= nil then
      	                WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+".."化血镖"
                    else
      	                WAR.Person[id][CC.TXWZ3] = "化血镖"
                    end
		        end
		        if JLSD(10,40,pid) then 
		            WAR.JTJD1 = 1--
	      	        if WAR.Person[id][CC.TXWZ3] ~= nil then
      	                WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+".."荆天棘地"
                    else
      	                WAR.Person[id][CC.TXWZ3] = "荆天棘地"
                    end
		        end
		        if JLSD(10,40,pid) then 
		            WAR.BYLH = 1--
	      	        if WAR.Person[id][CC.TXWZ3] ~= nil then
      	                WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+".."暴雨梨花"
                    else
      	                WAR.Person[id][CC.TXWZ3] = "暴雨梨花"
                    end
		        end
	        end
	end
	
	if (((MPPD(pid) == 11 and PersonGT(pid,180) and juexing() > 0) or (XYL(pid) and juexing() > 0) or jtyl(pid) or SJL(pid)) and wugong == 131) or wssz(pid) then --秘剑演武・剑势
	    local str = ""
	    if WAR.JQ[pid] == nil then 
	        WAR.JQ[pid] = 1 
	    else 
	        WAR.JQ[pid] = WAR.JQ[pid] + 1
        end
	    if WAR.JSJY[pid] == nil and WAR.JSJY[200+pid] == nil then --剑势剑影
	        if WAR.JQ[pid] > 0 and WAR.JQ[pid] ~= nil then
	            local aa = WAR.JQ[pid] + 16
		        if (JLSD(0,aa,pid) or (WAR.JQ[pid] == 9 and WAR.LQZ[pid] == 100 )) then
					--local nydx = {}
					--local nynum = 1
					--for j = 0, WAR.PersonNum - 1 do
					--  if WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[j]["死亡"] == false then
					--    nydx[nynum] = j
					--    nynum = nynum + 1
					--  end
					--end
					--local nyft = nydx[math.random(nynum - 1)]
					local x, y = WE_xy(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] - 1)
					local mid = 30000-pid;				--定义一个临时的戚长发数据
					JY.Person[mid] = {};
					for i=1, #PSX do
						JY.Person[mid][PSX[i]] = JY.Person[pid][PSX[i]];--JY.Person[WAR.Person[nyft]["人物编号"]][PSX[i]];
					end
					JY.Person[mid]["姓名"] = JY.Person[pid]["姓名"]--JY.Person[WAR.Person[nyft]["人物编号"]]["姓名"]
		--JY.Person[mid]["生命最大值"] = JY.Person[pid]["生命最大值"]--JY.Person[WAR.Person[nyft]["人物编号"]]["生命最大值"];
					JY.Person[mid]["生命"] = JY.Person[pid]["生命"]--JY.Person[WAR.Person[nyft]["人物编号"]]["生命"];
		--JY.Person[mid]["内力最大值"] = JY.Person[pid]["内力最大值"]--JY.Person[WAR.Person[nyft]["人物编号"]]["内力最大值"];
		--JY.Person[mid]["内力"] = JY.Person[pid]["内力"]--JY.Person[WAR.Person[nyft]["人物编号"]]["内力"];
		--JY.Person[mid]["轻功"] = JY.Person[pid]["轻功"]--JY.Person[WAR.Person[nyft]["人物编号"]]["轻功"]
		--JY.Person[mid]["攻击力"] = JY.Person[pid]["攻击力"]--JY.Person[WAR.Person[nyft]["人物编号"]]["攻击力"]
		--JY.Person[mid]["防御力"] = JY.Person[pid]["防御力"]--JY.Person[WAR.Person[nyft]["人物编号"]]["防御力"]
					JY.Person[mid]["无用12"] = pid--WAR.Person[nyft]["人物编号"]
					JY.Person[mid]["无用14"] = JY.Person[pid]["无用14"]--JY.Person[WAR.Person[nyft]["人物编号"]]["无用14"]
					for o = 1,HHH_GAME_SETTING["WG_COUNT_MAX"] do
						JY.Person[mid]["武功"..o] = JY.Person[pid]["武功"..o]
						JY.Person[mid]["武功等级"..o] = JY.Person[pid]["武功等级"..o]
					end
					if WAR.Person[WAR.CurID]["我方"] == true then 
						NewWARPersonZJ(mid, true, x, y, false, 1);
						WAR.DW[mid] = 1
					else
						NewWARPersonZJ(mid, false, x, y, false, 1);
						WAR.DW[mid] = 2
					end
					if pid == 0 and cxzj() > 0 then 
					   JY.Person[mid]["无用12"] = cxzj()
					end
					--WAR.Person[mid].Time = 999
					WAR.JSJY[pid] = mid
					WAR.JSJY[100+mid] = 30
					WAR.JSJY[200+mid] = pid
					WAR.JSJY[300+mid] = 1
					WAR.SPIRITMIN[mid] = 100
					--WAR.UNDEAD[pid] = 15
					if jtyl(pid) then
						WAR.SJSM[1000+mid] = JY.Person[mid]["生命"]
					--WAR.YDSD[mid] = WAR.YDSD[pid]
					end
					if wssz(pid) then
						WAR.SSFN[1000+mid] = JY.Person[mid]["生命"]
					--WAR.YDSD[mid] = WAR.YDSD[pid]
					end
					str = "・剑影"
				end
			end
		end
		if WAR.JQ[pid] > 9 then 
			WAR.JQ[pid] = 1
		end
		if WAR.JQ[pid] ~= nil and WAR.JQ[pid] > 0 then
			local cs = ""
			local names = 
			{{1,"一"},
			{2, "二"},
			{3, "三"},
			{4, "四"},
			{5, "五"},	
			{6, "六"},	
			{7, "七"},	
			{8, "八"},	
			{9, "九"},	
			}
			for i,v in ipairs(names) do
				if v[1] == WAR.JQ[pid] then
					cs = v[2]
					break
				end
			end 
			if WAR.Person[id][CC.TXWZ3] ~= nil then
				WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+".."秘剑演武・剑势"..cs..str
			else
				WAR.Person[id][CC.TXWZ3] = "秘剑演武・剑势"..cs..str
			end
	    end
	end
	
    if DT(pid,600) then --十方无敌
	    local str = ""
	    if WAR.SFWD[pid] == nil then 
	        WAR.SFWD[pid] = 1 
	    else 
	        WAR.SFWD[pid] = WAR.SFWD[pid] + 1
        end
	    if WAR.SFJS[pid] == nil and WAR.SFJS[200+pid] == nil then --十方皆杀
	        if WAR.SFWD[pid] > 0 and WAR.SFWD[pid] ~= nil then
	            local aa = WAR.SFWD[pid] + 20
		        if (JLSD(0,aa,pid) or (WAR.SFWD[pid] == 10 and WAR.LQZ[pid] == 100 )) then
	                local x, y = WE_xy(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] - 1)
	                local mid = 30000-pid;			--定义一个临时的人物数据	
	                JY.Person[mid] = {};
	                for i=1, #PSX do
		                JY.Person[mid][PSX[i]] = JY.Person[pid][PSX[i]];
	                end
	                JY.Person[mid]["姓名"] = JY.Person[pid]["姓名"]
	                JY.Person[mid]["生命"] = JY.Person[pid]["生命"]
	                JY.Person[mid]["无用12"] = pid
	                JY.Person[mid]["无用14"] = JY.Person[pid]["无用14"]
                    for o = 1,HHH_GAME_SETTING["WG_COUNT_MAX"] do
	                    JY.Person[mid]["武功"..o] = JY.Person[pid]["武功"..o]
	                    JY.Person[mid]["武功等级"..o] = JY.Person[pid]["武功等级"..o]
                    end
	                if WAR.Person[WAR.CurID]["我方"] == true then 
	                    NewWARPersonZJ(mid, true, x, y, false, 1);
	                    WAR.SFJM[mid] = 1
	                else
	                    NewWARPersonZJ(mid, false, x, y, false, 1);
	                    WAR.SFJM[mid] = 2
	                end
	                    if pid == 0 and cxzj() > 0 then 
	                        JY.Person[mid]["无用12"] = cxzj()
	                    end
	                    WAR.SFJS[pid] = mid
	                    WAR.SFJS[100+mid] = 30
	                    WAR.SFJS[200+mid] = pid
	                    WAR.SFJS[300+mid] = 1
	                    WAR.SPIRITMIN[mid] = 100
	                    str = "・气劲"
	            end
	        end
	    end
	    if WAR.SFWD[pid] > 9 then 
	        WAR.SFWD[pid] = 1
	    end
	    if WAR.SFWD[pid] ~= nil and WAR.SFWD[pid] > 0 then
	        local cs = ""
		    local names = 
		    {{1,"刀"},
		    {2, "枪"},
		    {3, "剑"},
		    {4, "戟"},
		    {5, "棍"},	
		    {6, "拳"},	
			{7, "掌"},
			{8, "腿"},
			{9, "指"},
			{10, "爪"},	
		    }
		    for i,v in ipairs(names) do
			    if v[1] == WAR.SFWD[pid] then
				    cs = v[2]
				    break
			    end
		    end 
	        if WAR.Person[id][CC.TXWZ3] ~= nil then
      	        WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+".."十强武道・"..cs..str
            else
      	        WAR.Person[id][CC.TXWZ3] = "十强武道・"..cs..str
            end
	    end
	end		
	
    if NF(pid) and yongdao(wugong) and juexing() > 0 then --雪饮神锋
	    local str = ""
	    if WAR.NJXY[pid] == nil then 
	        WAR.NJXY[pid] = 1 
	    else 
	        WAR.NJXY[pid] = WAR.NJXY[pid] + 1
        end
	    if WAR.XYCD[pid] == nil and WAR.XYCD[200+pid] == nil then --创刀
	        if WAR.NJXY[pid] > 0 and WAR.NJXY[pid] ~= nil then
	            local aa = WAR.NJXY[pid] + 30
		        if (JLSD(0,aa,pid) or (WAR.NJXY[pid] == 6 and WAR.LQZ[pid] == 100 )) then
	                local x, y = WE_xy(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] - 1)
	                local mid = 30000-pid;			--定义一个临时的人物数据	
	                JY.Person[mid] = {};
	                for i=1, #PSX do
		                JY.Person[mid][PSX[i]] = JY.Person[pid][PSX[i]];
	                end
	                JY.Person[mid]["姓名"] = JY.Person[pid]["姓名"]
	                JY.Person[mid]["生命"] = JY.Person[pid]["生命"]
	                JY.Person[mid]["无用12"] = pid
	                JY.Person[mid]["无用14"] = JY.Person[pid]["无用14"]
                    for o = 1,HHH_GAME_SETTING["WG_COUNT_MAX"] do
	                    JY.Person[mid]["武功"..o] = JY.Person[pid]["武功"..o]
	                    JY.Person[mid]["武功等级"..o] = JY.Person[pid]["武功等级"..o]
                    end
	                if WAR.Person[WAR.CurID]["我方"] == true then 
	                    NewWARPersonZJ(mid, true, x, y, false, 1);
	                    WAR.XYSF[mid] = 1
	                else
	                    NewWARPersonZJ(mid, false, x, y, false, 1);
	                    WAR.XYSF[mid] = 2
	                end
	                    if pid == 0 and cxzj() > 0 then 
	                        JY.Person[mid]["无用12"] = cxzj()
	                    end
	                    WAR.XYCD[pid] = mid
	                    WAR.XYCD[100+mid] = 30
	                    WAR.XYCD[200+mid] = pid
	                    WAR.XYCD[300+mid] = 1
	                    WAR.SPIRITMIN[mid] = 100
	                    str = "・封寒"
	            end
	        end
	    end
	    if WAR.NJXY[pid] > 9 then 
	        WAR.NJXY[pid] = 1
	    end
	    if WAR.NJXY[pid] ~= nil and WAR.NJXY[pid] > 0 then
	        local cs = ""
		    local names = 
		    {{1,"一诀"},
		    {2, "二诀"},
		    {3, "三诀"},
		    {4, "四诀"},
		    {5, "五诀"},	
		    {6, "六诀"},		
		    }
		    for i,v in ipairs(names) do
			    if v[1] == WAR.NJXY[pid] then
				    cs = v[2]
				    break
			    end
		    end 
	        if WAR.Person[id][CC.TXWZ3] ~= nil then
      	        WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+".."雪饮神锋・"..cs..str
            else
      	        WAR.Person[id][CC.TXWZ3] = "雪饮神锋・"..cs..str
            end
	    end
	end			
	
	if wglw(pid,101) or (DT(pid,117) and PersonKF(pid,101)) then	--唯我独尊--17-2-27
	    WAR.BHLH = 1
	    if WAR.Person[id][CC.TXWZ3] ~= nil then
        		WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+" .."八荒六合"
        else
          	  WAR.Person[id][CC.TXWZ3] = "八荒六合"
        end	   
	end
	if (wglw(pid,99) or ((DT(pid,5) or DT(pid,666)) and PersonKF(pid,99))) and JLSD(10,40,pid) and WAR.LSQL2[pid] == nil then 
	    if WAR.Person[id][CC.TXWZ3] ~= nil then
        		WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+" .."道法自然"
        else
          	  WAR.Person[id][CC.TXWZ3] = "道法自然"
        end
        WAR.LSQL2[pid] = 1
	end
	if (wglw(pid,99) or ((DT(pid,5) or DT(pid,666)) and PersonKF(pid,99))) and JLSD(10,40,pid) then 
	    if WAR.Person[id][CC.TXWZ3] ~= nil then
        		WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+" .."龙蛇起陆"
        else
          	  WAR.Person[id][CC.TXWZ3] = "龙蛇起陆"
        end
        WAR.LSQL = 1
	end  

    if ((MPPD(pid) == 11 and PersonGT(pid,180) and juexing() > 0) or (XYL(pid) and juexing() > 0) or jtyl(pid) or SJL(pid)) and wugong == 131 then --17-3-1 
        local a = math.random(3)
	    if a == 1 then 
            DHdisplay(1967, 1997, "")
		    for j = 0, WAR.PersonNum-1 do 
			    local df = WAR.Person[j]["人物编号"] 
			    local offset1 = math.abs(WAR.Person[WAR.CurID]["坐标X"] - WAR.Person[j]["坐标X"]) 
                local offset2 = math.abs(WAR.Person[WAR.CurID]["坐标Y"] - WAR.Person[j]["坐标Y"])	
			    if WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[j]["死亡"] == false and offset1 <= 10 and offset2 <= 10 then
			        WAR.WYWX[WAR.Person[j]["人物编号"]] = 1
			    end
            end
	        if WAR.Person[id][CC.TXWZ3] ~= nil then
        	    WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+" .."秘剑演武・无影无相"
            else
          	    WAR.Person[id][CC.TXWZ3] = "秘剑演武・无影无相"
            end
	    elseif a == 2 then 
	        DHdisplay(2559, 2581, "")
	        WAR.HQJK = 1
	        if WAR.Person[id][CC.TXWZ3] ~= nil then
        		WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+" .."秘剑演武・豪气剑空"
            else
          	  WAR.Person[id][CC.TXWZ3] = "秘剑演武・豪气剑空"
            end
	else
	        DHdisplay(457, 468, "")
	        WAR.LHWH = 1
	        if WAR.Person[id][CC.TXWZ3] ~= nil then
        		WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+" .."秘剑演武・落花无痕"
            else
          	  WAR.Person[id][CC.TXWZ3] = "秘剑演武・落花无痕"
            end
	    end
    end
  
    if NF(pid) and juexing() > 0 then --雪饮神锋
        local a = math.random(3)
	    if a == 1 then 
            DHdisplay(494, 505, "")
		    for j = 0, WAR.PersonNum-1 do 
			    local df = WAR.Person[j]["人物编号"] 
			    local offset1 = math.abs(WAR.Person[WAR.CurID]["坐标X"] - WAR.Person[j]["坐标X"]) 
                local offset2 = math.abs(WAR.Person[WAR.CurID]["坐标Y"] - WAR.Person[j]["坐标Y"])	
			    if WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[j]["死亡"] == false and offset1 <= 10 and offset2 <= 10 then
			        WAR.WYWX[WAR.Person[j]["人物编号"]] = 1
			    end
            end
	        if WAR.Person[id][CC.TXWZ3] ~= nil then
        		WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+" .."雪饮神锋・傲寒"
            else
          	    WAR.Person[id][CC.TXWZ3] = "雪饮神锋・傲寒"
            end
	    elseif a == 2 then 
	        DHdisplay(678, 690, "")
	        WAR.XYBD = 1
	        if WAR.Person[id][CC.TXWZ3] ~= nil then
        		WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+" .."雪饮神锋・创刀"
            else
          	    WAR.Person[id][CC.TXWZ3] = "雪饮神锋・创刀"
            end
	else
	        DHdisplay(1830, 1848, "")
	        WAR.BLXY = 1
	        if WAR.Person[id][CC.TXWZ3] ~= nil then
        		WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+" .."雪饮神锋・魔刃"
            else
          	    WAR.Person[id][CC.TXWZ3] = "雪饮神锋・魔刃"
            end
	    end
    end

	--聂风1觉后流血
    if NF(pid) and JLSD(10, 40, pid) and juexing() > 0 then
	    if WAR.LXZT[pid] ~= nil then
            WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid,"生命",- (math.random(3) + math.modf(JY.Person[pid]["受伤程度"] / 20)))
			JY.Person[pid]["生命"] = JY.Person[pid]["生命"] - math.random(3) - math.modf(JY.Person[pid]["受伤程度"] / 20)
        else
            WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid,"生命",- (math.modf(JY.Person[pid]["受伤程度"] / 20)))
			--JY.Person[pid]["生命"] = JY.Person[pid]["生命"] - 1 - math.modf(JY.Person[pid]["受伤程度"] / 20)
            if JY.Person[pid]["生命"] < 1 then
                JY.Person[pid]["生命"] = 1
            end
        end
        WAR.Person[pid][CC.TXWZ2] = "风神怒・风入松间雷不动"
    end
	
    --五岳剑派
	if MPPD(pid) == 14 then
	    local mpdj = MPDJ(pid) + 4
	    if math.random(10) < (mpdj) then
            WAR.WYJP = 1
            WAR.Person[id][CC.TXWZ1] = "剑气冲霄"
        end
	end
	
	if DT(pid,69) and JLSD(0,70,pid) then 
	    if WAR.Person[id][CC.TXWZ2] ~= nil then
            WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+" .."丐王真气"
        else
          	WAR.Person[id][CC.TXWZ2] = "丐王真气"
        end
	    WAR.GWZQ = 1 
	end 
	
	if DT(pid,592) and (JLSD(10,45,pid) or (juexing() > 0 and JLSD(10,85,pid)) or WAR.Actup[pid] ~= nil) then --破尽天下
	    if WAR.Person[id][CC.TXWZ1] ~= nil then
        	WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .."破尽天下"
        else
          	 WAR.Person[id][CC.TXWZ1] = "破尽天下"
        end
	    WAR.PJTX = 1 
	end	
	
    if DT(pid,583) and JLSD(10,45,pid) then 
		if WAR.Person[id][CC.TXWZ1] ~= nil then
        	WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .."万道森罗・天罗火道"
        else
          	 WAR.Person[id][CC.TXWZ1] = "万道森罗・天罗火道"
        end	
		WAR.TLHD = 1
	end	
	
	--豸苗：折梅手
	if wugong == 14 and WAR.ZMS ~= 0 then
	    if WAR.Person[id][CC.TXWZ1] ~= nil then
        	WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .."尽皆化入・化繁为简"
        else
          	WAR.Person[id][CC.TXWZ1] = "尽皆化入・化繁为简"
        end
	    WAR.ZMS = 0
	end
	if (wglw(pid,592) or DT(pid,592)) and WAR.DGJY[pid] ~= nil and WAR.DGJY[pid] > 0 then --17-2-10
	    local cs = ""
		local names = 
		{{1,"一" },
		{2, "二"},
		{3, "三" },
		{4, "四"},
		{5, "五"},
		{6, "六"},
		{7, "七"},
		{8, "八"},
		{9, "九"},	
		}
		for i,v in ipairs(names) do
			if v[1] == WAR.DGJY[pid] then
				cs = v[2]
				break
			end
		end
	    if WAR.Person[id][CC.TXWZ3] ~= nil then
        	WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+" .."独孤剑意・"..cs.."重"
        else
          	WAR.Person[id][CC.TXWZ3] = "独孤剑意・"..cs.."重"
        end
	    WAR.DGJY[pid] = WAR.DGJY[pid] - 1
	    if WAR.DGJY[pid] <= 0 then 
	        WAR.DGJY[pid] = nil 
	    end
	end 
	if (((wglw(pid, 107) and PersonGTJL(pid,107,WAR.NGJL)) or (DT(pid,599) and PersonGTJL(pid,107,WAR.NGJL))) or (wugong == 18 and wglw1(pid,18))) and WAR.JYZQ[pid] ~= nil and WAR.JYZQ[pid] > 0 then --17-2-10
	    local cs = ""
		local names = 
		{{1,"一" },
		{2, "二"},
		{3,"三" },
		{4, "四"},
		{5, "五"},	
		}
		for i,v in ipairs(names) do
			if v[1] == WAR.JYZQ[pid] then
				cs = v[2]
				break
			end
		end
	    if WAR.Person[id][CC.TXWZ3] ~= nil then
        	WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+" .."九阴破体真气"..cs.."层"
        else
          	WAR.Person[id][CC.TXWZ3] = "九阴破体真气"..cs.."层"
        end
	    WAR.JYZQ[pid] = WAR.JYZQ[pid] - 1
	    if WAR.JYZQ[pid] <= 0 then 
	        WAR.JYZQ[pid] = nil 
	    end
	end  
	if (wglw(pid, 107) or DT(pid,599)) and PersonGTJL(pid,107,WAR.NGJL) and (JLSD(0,30,pid) or (DT(pid,599) and JLSD(0,50,pid))) then --17-2-10
	    if WAR.Person[id][CC.TXWZ1] ~= nil then
        	WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .."九阴摄魂"
        else
          	WAR.Person[id][CC.TXWZ1] = "九阴摄魂"
        end
	    WAR.YHDF1 = 1
	end
	if BJY(pid) and yongjian(wugong) and JY.Person[0]["御剑能力"] > 400 and juexing() > 0 then
	    if WAR.Person[id][CC.TXWZ1] ~= nil then
        	WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .."圣灵剑法・剑二十二"
        else
          	WAR.Person[id][CC.TXWZ1] = "圣灵剑法・剑二十二"
        end
		WAR.SLJJ = 1
	end 		
	--豸苗：扫地僧佛渡--17-2-9-
	if DT(pid, 114) then
        if JLSD(0,50,pid) then
	        WAR.HQWX = 1
            if WAR.Person[id][CC.TXWZ1] == nil then
	           WAR.Person[id][CC.TXWZ1] = "化气无形"
		    else   
		       WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+".."化气无形"
		    end
		end
		if JLSD(0,50,pid) then 
		    WAR.HQWX1 = math.random(2)
		    if WAR.HQWX1 == 1 then
		        WAR.HQWX2 = 1 
                if WAR.Person[id][CC.TXWZ1] == nil then
	                WAR.Person[id][CC.TXWZ1] = "苦海无涯"
		        else   
		            WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+".."苦海无涯"
		        end
		    elseif WAR.HQWX1 == 2 then 
  		        WAR.HQWX2 = 2
                if WAR.Person[id][CC.TXWZ1] == nil then
	                WAR.Person[id][CC.TXWZ1] = "放下屠刀"
		        else   
		            WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+".."放下屠刀"
		        end			  
		    end 
		end   
	end
	
	if wglw(pid,96) or (pid == 400 and JY.Person[pid]["姓名"] == "慧聪") or (DT(pid,38) and PersonKF(pid,96)) or DT(pid,615) then
	    local str = "罗汉伏魔"
	    local jl = 60-math.modf(JY.Person[pid]["资质"]/4)
	    if ((wglw(pid,96) and PersonGT(pid,96)) and ((pid == 0 and JLSD(0,jl,pid)) or (DT(pid,618) and JLSD(0,50,pid)))) or ((pid == 400 and JY.Person[pid]["姓名"] == "慧聪") and JLSD(0,60,pid))or (DT(pid,38) and JLSD(0,30,pid)) or DT(pid,615) then
	        WAR.LHXS = 1  
	        if DT(pid,618) then 
	            str = "无相・罗汉伏魔"
	        end 
	        if WAR.Person[id][CC.TXWZ1] == nil then 
	            WAR.Person[id][CC.TXWZ1] = str
	        else 
	            WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+"..str
	        end 
	    end
	end  

	if (wglw(pid,85) or (DT(pid,118) and PersonKF(pid,85)) or T1LEQ(pid)) and JLSD(0,35,pid) and WAR.BMXH == 1 then 
	    if WAR.Person[id][CC.TXWZ1] == nil then 
	        WAR.Person[id][CC.TXWZ1] = "海纳百川"
	    else 
	        WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+".."海纳百川"
	    end 
	        WAR.BMXS = 1
	end
	
	if getHZ(pid, 28) and math.random(10) < 5 and WAR.ACT == 1 then
		WAR.TJL = 1
		if WAR.Person[id][CC.TXWZ1] ~= nil then
			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .."+"..CC.WARS52
		else
			WAR.Person[id][CC.TXWZ1] = CC.WARS52
		end		
	end
	
    if ((wglw(pid,102) or (DT(pid,38) and PersonKF(pid,102))) and WAR.HLTX1[pid] ~= nil) or (DT(pid,618) and PersonKF(pid,98)) then --1-26-
	    for i = 1,HHH_GAME_SETTING["WG_COUNT_MAX"] do 
	        if JY.Person[pid]["武功"..i] > 0 then
		        WAR.HLTX = JY.Person[pid]["武功"..math.random(i)]
		    end
        end 
	    if WAR.Person[id][CC.TXWZ1] == nil then 
	        WAR.Person[id][CC.TXWZ1] = "万般归一"
	    else 
	        WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+".."万般归一"
	    end
    end
	--[[or (JY.Person[pid]["武功"..i] > 88 and JY.Person[pid]["武功"..i] < 91) or (JY.Person[pid]["武功"..i] >= 92 and JY.Person[pid]["武功"..i] <= 108) 
					or JY.Person[pid]["武功"..i] == 121 or JY.Person[pid]["武功"..i] == 124 or (JY.Person[pid]["武功"..i] >= 150 and JY.Person[pid]["武功"..i] <= 153)
					or JY.Person[pid]["武功"..i] == 178 or (JY.Person[pid]["武功"..i] >= 180 and JY.Person[pid]["武功"..i] <= 189)	or JY.Person[pid]["武功"..i] == 203]]
	
	if wugong == 18 and (wglw1(pid,18) or DT(pid,57)) and (WAR.TZPT1 == 1 or JLSD(10,60,pid)) then --弹指领悟
		local N_JL = {};		
		local num = 0;	--当前学了多少个内功
		for i = 1, CC.Kungfunum do
			local kfid = JY.Person[pid]["武功" .. i]
			local kflvl = JY.Person[pid]["武功等级" .. i]
			if kflvl == 999 then
				kflvl = 11
			else
				kflvl = math.modf(kflvl / 100) + 1
			end
			--先把内功都存入表格，吸功，金刚不坏，风林六如不加力
			if JY.Wugong[kfid]["类型"] == 0 and kfid ~= 85 and kfid ~= 87 and kfid ~= 88  and kfid ~= 91 then
				num = num + 1;
				N_JL[num] = {kfid};
			end
		end
		if num > 0 then
			for i = 1, num do 
				if math.random(10) > 8 then
					WAR.TZPT = N_JL[i][1]
				end
			end
		end	
		if WAR.TZPT > 0 then
			if WAR.Person[id][CC.TXWZ1] == nil  then 
				WAR.Person[id][CC.TXWZ1] = "弹指・"..JY.Wugong[WAR.TZPT]["名称"]
			else 
				WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+".."弹指・"..JY.Wugong[WAR.TZPT]["名称"]
			end
		end	
	end	

    if (wglw(pid,183) or (DT(pid,615) and PersonGTJL(pid,183))) and JLSD(10,40,pid) then
		if WAR.Person[id][CC.TXWZ3] ~= nil then
        	WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+" .."超脱离凡"
        else
          	WAR.Person[id][CC.TXWZ3] = "超脱离凡"
        end
	    WAR.XSJS = 1
	end 	

    if (wglw(pid,184) and PersonGT(pid,184)) and WAR.LQZ[pid] == 100 or DT(pid,665) then
		if WAR.Person[id][CC.TXWZ3] ~= nil then
        	WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+" .."无穷无尽"
        else
          	WAR.Person[id][CC.TXWZ3] = "无穷无尽"
        end
		WAR.YJJS = 1
	end	

    --虚竹  福泽加护，集气从300开始
    if DT(pid, 49) and JLSD(10, 50, pid) then
        WAR.XZZ = 1
        if WAR.Person[id][CC.TXWZ1] ~= nil then
      	    WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .."+"..CC.WARS53
        else
      	    WAR.Person[id][CC.TXWZ1] = CC.WARS53
        end
    end
	
    if DT(pid, 662) and JLSD(10, 60, pid) then
        WAR.SJRF = 1
        if WAR.Person[id][CC.TXWZ3] ~= nil then
      	    WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .."+".."谋・其疾如风"
        else
      	    WAR.Person[id][CC.TXWZ3] = "谋・其疾如风"
        end
    end	
	
	if D1GHYD(pid) and JLSD(10, 20+tianshu(), pid) then
        WAR.XZZ = 1
    end
	
    --东方不败  50%葵花点穴手，杀集气+1200
    if DT(pid, 27) and math.random(10) < 6 then
        WAR.Person[id][CC.TXWZ3] = CC.WARS54
        ng = ng + 1200
    end
	 
    --程灵素 攻击全屏中毒+20 满毒减体力
    if DT(pid, 2) and WAR.ACT == 1 then
        for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
                WAR.Person[j]["中毒点数"] = (WAR.Person[j]["中毒点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"],"中毒程度",20)
				--JY.Person[WAR.Person[j]["人物编号"]]["中毒程度"] = JY.Person[WAR.Person[j]["人物编号"]]["中毒程度"] + 20
				if 100 < JY.Person[WAR.Person[j]["人物编号"]]["中毒程度"] then
					JY.Person[WAR.Person[j]["人物编号"]]["中毒程度"] = 100
					WAR.Person[j]["体力点数"] = (WAR.Person[j]["体力点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"], "体力", -math.random(2,5))
					if JX(pid) then
						WAR.Person[j]["内力点数"] = (WAR.Person[j]["内力点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"], "内力", -math.random(2,5)*100)
					end
				end
				WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
			end
        end
        if WAR.Person[id][CC.TXWZ1] ~= nil then
      	    WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .."+"..CC.WARS55
        else
      	    WAR.Person[id][CC.TXWZ1] = CC.WARS55
        end
        WAR.Person[id][CC.TXDH] = 64
    end
	
	--持瑶琴回光返照
	if wugong == 73 and wglw1(pid,73) then
		local zd=math.modf(10,15)
        for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
                WAR.Person[j]["中毒点数"] = (WAR.Person[j]["中毒点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"],"中毒程度",zd)
				--JY.Person[WAR.Person[j]["人物编号"]]["中毒程度"] = JY.Person[WAR.Person[j]["人物编号"]]["中毒程度"] + zd
				if 100 < JY.Person[WAR.Person[j]["人物编号"]]["中毒程度"] then
					JY.Person[WAR.Person[j]["人物编号"]]["中毒程度"] = 100
				end
				WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
            end
        end
        if WAR.Person[id][CC.TXWZ1] == nil then
      	    WAR.Person[id][CC.TXWZ1] = "阎王三更・回光返照"
        else
      	    WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .."+".."回光返照"
        end
    end
      
	if bpoison(pid) > 0 and WAR.ACT == 1 then
        for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
			    WAR.Person[j]["中毒点数"] = (WAR.Person[j]["中毒点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"],"中毒程度",20)
				--JY.Person[WAR.Person[j]["人物编号"]]["中毒程度"] = JY.Person[WAR.Person[j]["人物编号"]]["中毒程度"] + 20
			    if 100 < JY.Person[WAR.Person[j]["人物编号"]]["中毒程度"] then
			        JY.Person[WAR.Person[j]["人物编号"]]["中毒程度"] = 100
			    end
				WAR.XNXS[WAR.Person[j]["人物编号"]] = 1	
            end
        end
	end

    --鸠摩智  使用火焰刀法，50%加内伤20，加杀集气1000
    if wugong == 66 and JY.Person[pid]["武功等级" .. wugongnum] >= 999 and ((DT(pid, 103) or DT(pid, 595)) and (JLSD(10, 60, pid) or ZYBF(pid) ))  then
        local ns=20
	    local str=""
	    local ns2=0
	    if ZYBF(pid) then
	        ns=ns+10
	        str="・迦楼罗琉璃火"
	    end
	    for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
                WAR.Person[j]["内伤点数"] = (WAR.Person[j]["内伤点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"],"受伤程度",ns)
				--JY.Person[WAR.Person[j]["人物编号"]]["受伤程度"] = JY.Person[WAR.Person[j]["人物编号"]]["受伤程度"] + ns
				WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
            end
            if 100 < JY.Person[WAR.Person[j]["人物编号"]]["受伤程度"] then
                JY.Person[WAR.Person[j]["人物编号"]]["受伤程度"] = 100
            end
		    ns2=ns2+ns
        end
	        ng = ng + 50*ns
            if WAR.Person[id][CC.TXWZ1] ~= nil then
      	        WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .."+"..CC.WARS56..str  --大轮密宗・火焰刀
            else
      	        WAR.Person[id][CC.TXWZ1] = CC.WARS56..str  --大轮密宗・火焰刀
            end
                WAR.Person[id][CC.TXDH] = 58
	            WAR.LLH=ns2
    end
	
	--古墓剑系 纤手握星辰
	if MPPD(pid) == 3 and PersonGT(pid,121) and PersonKFJ(pid,39) and PersonKFJ(pid,42) and yongjian(wugong) then
		for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and 
				WAR.Person[j]["死亡"] == false and not nokillspeed(WAR.Person[j]["人物编号"]) then
				local tmppid = WAR.Person[j]["人物编号"]
				local tmpcount = 0
				tmpcount = tmpcount + 40
				if JLSD(0,tmpcount,pid) then
					if WAR.ATKDOWN[tmppid] == nil then
						WAR.ATKDOWN[tmppid] = (WAR.ATKDOWN[tmppid] or 0) + 20
					end	
					--WAR.Person[id][CC.TXWZ1] = "纤手握星辰"  --大轮密宗・火焰刀
				end	
			end			
		end
	end	
	
	--赤练魔威
	if (wugong == 3 or wugong == 170) and DT(pid,161) and JX(pid) then
		local aa = 0
		if JLSD(0,50,pid) then
			for j = 0, WAR.PersonNum - 1 do
				if WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[j]["死亡"] == false then
					local tmppid = WAR.Person[j]["人物编号"]
					if nokillspeed(WAR.Person[j]["人物编号"]) == true then
					else					
						WAR.Person[j].Time = WAR.Person[j].Time - 150      --普通角色用，全部集气减100
						if WAR.Person[j].Time < 0 then
							JY.Person[tmppid]["中毒程度"] = 100
						end	--大轮密宗・火焰刀
					end	
				end			
			end
			WAR.Person[id][CC.TXWZ1] = "赤练魔威"
		end
	end
	
	--持瑶琴大音希声
    if wugong == 73 and wglw1(pid,73) then
        local ns=10
	    for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
                WAR.Person[j]["内伤点数"] = (WAR.Person[j]["内伤点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"],"受伤程度",ns)
				--JY.Person[WAR.Person[j]["人物编号"]]["受伤程度"] = JY.Person[WAR.Person[j]["人物编号"]]["受伤程度"] + ns
				WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
            end
            if 100 < JY.Person[WAR.Person[j]["人物编号"]]["受伤程度"] then
                JY.Person[WAR.Person[j]["人物编号"]]["受伤程度"] = 100
            end
        end
	    ng = ng + 30*ns
		if WAR.Person[id][CC.TXWZ1] ~= nil then
			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .."+".."大音希声"  --大轮密宗・火焰刀
		else
			WAR.Person[id][CC.TXWZ1] = "伏羲神天・大音希声"
		end
    end
	
	--持瑶琴天响
	if WAR.TDSX == 1 then
		if fightnum > 3 then
			fightnum = 3 
		end
        local ns=50
	    for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
                WAR.Person[j]["内伤点数"] = (WAR.Person[j]["内伤点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"],"受伤程度",ns)
				--JY.Person[WAR.Person[j]["人物编号"]]["受伤程度"] = JY.Person[WAR.Person[j]["人物编号"]]["受伤程度"] + ns
				WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
			end
            if 100 < JY.Person[WAR.Person[j]["人物编号"]]["受伤程度"] then
                JY.Person[WAR.Person[j]["人物编号"]]["受伤程度"] = 100
            end
			if 49 < JY.Person[WAR.Person[j]["人物编号"]]["受伤程度"] then
				local aa = JY.Person[WAR.Person[j]["人物编号"]]["受伤程度"]
			    WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"], "生命", -(aa * (math.random(1,3))))
				WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
				--AddPersonAttrib(WAR.Person[j]["人物编号"], "生命", -(aa * (math.random(1,3))))
            end
        end
	    ng = ng + 30*ns
    end
	
     --血刀门  使用火焰刀法，30%加流血20，加杀集气1000
    if wugong == 66 and JY.Person[pid]["武功等级" .. wugongnum] >= 999 and ((MPPD(pid)==6 and MPDJ(pid)>1) and JLSD(10, 30+5*MPDJ(pid), pid) )  then
        local ns=math.random(MPDJ(pid),MPDJ(pid)+1)*10
	    for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
                local tmppid = WAR.Person[j]["人物编号"]
		        WAR.LXXS[tmppid] = 1
		        WAR.LXZT[tmppid] = limitX((WAR.LXZT[tmppid] or 0) + ns, 0, 100)
		        WAR.HOTXS[tmppid] = 1
		        WAR.HOT[tmppid] = limitX((WAR.HOT[tmppid] or 0) + 10, 0, 100)
				WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
            end
        end
        if WAR.Person[id][CC.TXWZ1] ~= nil then
      	    WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .."+".."血浪滔天・血焰刀"  
        else
      	    WAR.Person[id][CC.TXWZ1] = "血浪滔天・血焰刀" 
        end
            WAR.Person[id][CC.TXDH] = 29
    end
 
      --金轮寺  使用火焰刀法，30%加流血20，加杀集气1000
    if wugong == 66 and JY.Person[pid]["武功等级" .. wugongnum] >= 999 and ((MPPD(pid)==6 and MPDJ(pid)>1) and JLSD(10, 30+5*MPDJ(pid), pid) )  then
        local ns=math.random(MPDJ(pid),MPDJ(pid)+1)*10
	    local str=""
	    local ns2=0
	    for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
                local tmppid = WAR.Person[j]["人物编号"]
		        WAR.CHXS[tmppid] = 1
		        WAR.CHZ[tmppid] = limitX((WAR.CHZ[tmppid] or 0) + ns, 0, 100)
				WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
            end
        end
        if WAR.Person[id][CC.TXWZ1] ~= nil then
      	    WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .."+".."龙象神威・金刚智"  
        else
      	    WAR.Person[id][CC.TXWZ1] = "龙象神威・金刚智" 
        end
            WAR.Person[id][CC.TXDH] = 29
    end
 
    if ((NF(pid) and (JLSD(10,40,pid) or ZYBF(pid))) and yongdao(wugong)) and juexing() > 2 then
        local ns = 30
	    local str = "冰心剔透・魔念高涨"
	    if ZYBF(pid) then
	        ns = ns + 10
	        str = "冰心剔透・魔念高涨"
	    end
	    for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
                local tmppid = WAR.Person[j]["人物编号"]
		        WAR.ICEXS[tmppid] = 1
		        WAR.ICE[tmppid] = WAR.ICE[tmppid] or 0 + ns
				WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
            end
        end
	    ng = ng + 50 * ns
        if WAR.Person[id][CC.TXWZ1] ~= nil then
      	    WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .."+"..str
        else
      	    WAR.Person[id][CC.TXWZ1] = str 
        end
        WAR.Person[id][CC.TXDH] = 158
    end

    if ((BJY(pid) and (JLSD(10,40,pid) or ZYBF(pid))) and yongjian(wugong)) and juexing() > 1 then
        local ns = 30
	    local str = "三剑合一・无极霸剑"
	    if ZYBF(pid) then
	        ns = ns + 10
	        str = "三剑合一・无极霸剑"
	    end
	    for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
                local tmppid = WAR.Person[j]["人物编号"]
		        WAR.HOTXS[tmppid] = 1
		        WAR.HOT[tmppid] = WAR.HOT[tmppid] or 0 + ns
				WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
            end
        end
	    ng = ng + 50 * ns
        if WAR.Person[id][CC.TXWZ1] ~= nil then
      	    WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .."+"..str
        else
      	    WAR.Person[id][CC.TXWZ1] = str 
        end
        WAR.Person[id][CC.TXDH] = 149
    end

    if (DT(pid, 48) and JX(pid) and (JLSD(10, 60, pid) or ZYBF(pid))) and (yongnei(wugong) or wugong == 21) then
        local ns=20
	    local str="冰蚕天罗"
	    if ZYBF(pid) then
	        ns=ns+10
	        str="摩呼罗迦・翡翠冰晶"
	    end
	    for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
                local tmppid = WAR.Person[j]["人物编号"]
		        WAR.ICEXS[tmppid] = 1
		        WAR.ICE[tmppid] = WAR.ICE[tmppid] or 0 + ns
				WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
            end
        end
	    ng = ng + 50*ns
        if WAR.Person[id][CC.TXWZ1] ~= nil then
      	    WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .."+"..str  --沼跃鱼:游坦之的战意被动
        else
      	    WAR.Person[id][CC.TXWZ1] = str  --沼跃鱼:游坦之的战意被动
        end
            WAR.Person[id][CC.TXDH] = 58
    end

    if wugong==66 and (DT(pid,103) or DT(pid,595)) and WAR.CHD>1 then--沼跃鱼：鸠摩智残火刀名称
        local WZTS = {"残火刀三式・极焱返寒","残火刀次式・炎魔心障","残火刀初式・一刀火葬"}
		local CHD=WAR.CHD
		CHD=CHD-2
		WAR.Person[id][CC.TXWZ3] = WZTS[CHD];
		WAR.Person[id][CC.TXDH] = 145
		WAR.CHD=WAR.CHD-1
    end

    --使用血刀大法，配带血刀或血刀老祖使用时，吸血10%
    if (JY.Person[pid]["武功" .. wugongnum] == 63 or (MZ(pid)==2 and yongdao(wugong)) or wglw1(pid,63) ) and (JY.Person[pid]["武器"] == 44 or DT(pid, 97) or wglw1(pid,63)) then
        WAR.XDDF = 1
    end
    
    --太极拳，才加杀1点集气，额
    if JY.Person[pid]["武功" .. wugongnum] == 16 then
        if WAR.tmp[3000 + pid] == nil then
            WAR.tmp[3000 + pid] = 0
    	elseif 0 < WAR.tmp[3000 + pid] then
            WAR.Person[id][CC.TXWZ3] = CC.WARS59   --太极拳借力打力
            ng = ng + WAR.tmp[3000 + pid] * 5
        end
    end
	
	 if WAR.TSYBL == 1 and WAR.tmp[3000 + pid] ~= nil and WAR.tmp[3000 + pid] > 0 and (wglw1(pid,67) or (DT(pid, 1) and JX(pid)) or (DT(pid, 621) and JX(pid))) then--and JLSD(10,40,pid)
		ng = ng + WAR.tmp[3000 + pid] * 5
		if WAR.Person[id][CC.TXWZ2] == nil then
			WAR.Person[id][CC.TXWZ2] = "铁碎牙・暴流破"
		else
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+" .."暴流破"
		end	
    end
	
	if (wugong ~= 16 or(wugong == 16 and PersonGT(pid,182))) and MPPD(pid) == 4 and WAR.BG[pid] ~= nil then --武当八卦
		if wugong == 16 and wglw1(pid,16) and wglw(pid,182) and (PersonGTJL(pid,182,WAR.NGJL) or JLSD(10,60,pid)) then
			WAR.WDTJTQ = 1
			if WAR.Person[id][CC.TXWZ1] == nil then
				WAR.Person[id][CC.TXWZ1] = "玄天八卦・真武太极拳"
			else
				WAR.Person[id][CC.TXWZ1] = "玄天八卦・真武太极拳"..WAR.Person[id][CC.TXWZ1]
			end
		elseif wugong == 46 and wglw1(pid,46) and wglw(pid,182) and (PersonGTJL(pid,182,WAR.NGJL) or JLSD(10,60,pid)) then
			WAR.WDTJTJ = 1
			if WAR.Person[id][CC.TXWZ1] == nil then
				WAR.Person[id][CC.TXWZ1] = "玄天八卦・真武太极剑"
			else
				WAR.Person[id][CC.TXWZ1] = "玄天八卦・真武太极剑"..WAR.Person[id][CC.TXWZ1]
			end
		else	
			if WAR.Person[id][CC.TXWZ3] == nil then
				WAR.Person[id][CC.TXWZ3] = "八卦"
			else
				WAR.Person[id][CC.TXWZ3] = "八卦・"..WAR.Person[id][CC.TXWZ3]
			end
		end	
	end

    if (MPPD(pid) == 4 and PersonGTJL(pid, 99, WAR.NGJL))  and 
	    yongjian(wugong) then --沼跃鱼：武当太极剑法
	    local SN=math.modf(JY.Person[pid]["内力"]/500)
	    local SN2=MPDJ(pid)
	    if JY.Person[pid]["武器"] == 236 then----
	        SN2=SN2+5
	    end
	    WAR.GTJIQI=WAR.GTJIQI+ SN*(SN2+WAR.ACT)
	    WAR.GTPID=pid
	    WAR.BG[pid]=WAR.BG[pid] or 0 + SN*(SN2+WAR.ACT)
        WAR.WJ[pid]= WAR.WJ[pid] or 0 + SN*(SN2+WAR.ACT)*5
	    if WAR.Person[id][CC.TXWZ2] == nil then
		    WAR.Person[id][CC.TXWZ2] = "太极精要・圆转剑舞"
	    else
		    WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+" .. "太极精要・圆转剑舞"
	    end	
	        WAR.Person[id][CC.TXDH] = 38
	end	
	if (MPPD(pid) == 4 and PersonGTJL(pid, 99, WAR.NGJL)) and yongjian(wugong) then
		WAR.WDJF1 = 1
		if WAR.Person[id][CC.TXWZ2] == nil then
		    WAR.Person[id][CC.TXWZ2] = "太极精要・无极剑环"
	    else
		    WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+" .. "太极精要・无极剑环"
	    end	
	        WAR.Person[id][CC.TXDH] = 38
	end
	if (MPPD(pid) == 4 and PersonGTJL(pid, 99, WAR.NGJL)) and yongquan(wugong) then	
		local str = ""
		if WAR.ACT == 1 then
			WAR.WDQF1 = 1
			str = "母式云手"
		else 
			WAR.WDQF2 = 1
			str = "冲虚连拳"
		end
		if str ~= "" then
			if WAR.Person[id][CC.TXWZ2] == nil then
				WAR.Person[id][CC.TXWZ2] = "太极精要・"..str
			else
				WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+" .. "太极精要・"..str
			end	
			WAR.Person[id][CC.TXDH] = 38
		end	
	end	
	
	if MPPD(pid) == 4 and wglw(pid,182) and ((wugong == 16 and wglw1(pid,16)) or (wugong == 46 and wglw1(pid,46))) and JLSD(10,60,pid) then
		WAR.DWRY = 1
		if WAR.Person[id][CC.TXWZ2] == nil then
			WAR.Person[id][CC.TXWZ2] = "玄天太极・道我如一"
		else
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .. "+" .. "玄天太极・道我如一"
		end	
	end
	
	if MPPD(pid) == 8 and WAR.JD[pid] ~= nil then --武骧金星：白驼山集毒
		if WAR.Person[id][CC.TXWZ3] == nil then
			WAR.Person[id][CC.TXWZ3] = "集毒"
		else
			WAR.Person[id][CC.TXWZ3] = "集毒・"..WAR.Person[id][CC.TXWZ3]
		end
	end
	
    if MPPD(pid) == 10 and WAR.JH[pid] ~= nil then --武骧金星：桃花岛九花玉露
		if WAR.Person[id][CC.TXWZ3] == nil then
			WAR.Person[id][CC.TXWZ3] = "九花玉露"
		else
			WAR.Person[id][CC.TXWZ3] = "九花玉露・"..WAR.Person[id][CC.TXWZ3]
		end
    end
	
	if WAR.NSNS[pid] ~= nil and hasTF(pid, 130) then
		if WAR.Person[id][CC.TXWZ3] == nil then
			WAR.Person[id][CC.TXWZ3] = "逆水凝霜"
		else
			WAR.Person[id][CC.TXWZ3] = "逆水凝霜・"..WAR.Person[id][CC.TXWZ3]
		end	
	end
      
	--武功招式加杀集气
	local tkf = {}
	local cz = false
	for i = 1, #CC.KfName do
		if CC.KfName[i][1] == wugong then
			tkf[#tkf + 1] = CC.KfName[i]
		end
	end
	local CZJL = math.modf(baseRandom(pid) / 2)
	if #tkf > 0 then
		CZJL = CZJL + #tkf * 5
	elseif wugong == 91 and JY.Wugong[wugong]["攻击范围"] == -1 then
		CZJL = CZJL + 15
	end
	if PersonGT(pid, 98) then
		CZJL = CZJL + 30
	end
	CZJL = CZJL + zhaoshi(pid)	
	if WAR.LQZ[pid] == 100 then
		CZJL = 100
	end	
	if wugong == 177 and (DT(pid, 27) or wglw1(pid,177)) and JLSD(10, 70, pid) then
		CZJL = 100
	end	
	if CZJL > 100 then CZJL = 100 end
	if WAR.ACT > 1 and not (hasTF(pid, 57) or WAR.HYYQ[pid] == 1) then --连击不能出招式
		if JLSD(0,70,pid) then
		CZJL = 0
		end
	end
	if JLSD(0, CZJL, pid) then
		cz = true
	end
	if txjid(pid) and yongjian(wugong) then 
	   cz = true
	end
    for j = 0, WAR.PersonNum - 1 do --武骧金星：水镜四奇在场时全队友必出招式	
        if DT(WAR.Person[j]["人物编号"], 662) and WAR.Person[j]["死亡"] == false then 
		    if WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
			    cz = true
		    end	  
	    end
    end	
	if cz then
		local tng = 0
		if ZJ(pid) and ((wugong >= 109 and wugong <= 112) or 
			(wugong == 91 and JY.Wugong[wugong]["攻击范围"] == -1)) then
			local str = "真・"..JY.Wugong[wugong]["名称"] 
			if T9ZY(pid) then 
			str = "七探蛇盘枪"
			end
			if WAR.Person[id][CC.TXWZ3] ~= nil then
				WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .."+"..str
			else
				WAR.Person[id][CC.TXWZ3] = str
			end
			tng = math.random(1000, JY.Wugong[wugong]["攻击力10"])	
		elseif #tkf ~= 0 then
			local ts = ""
			local tn = math.random(#tkf)
			ts = tkf[tn][2]
			if WAR.Person[id][CC.TXWZ3] ~= nil then
				WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+"..ts
			else
				WAR.Person[id][CC.TXWZ3] = ts
			end
			tng = tkf[tn][3]			
		end
		if extrazs(pid) > 0 then
			tng = math.modf(tng * (1 + extrazs(pid)))
		end
		ng = ng + tng
	end

    --蓝烟清：南山刀法，杨家枪法增加机率
    if wugong == 53 and (JLSD(20, 50, pid) or (PersonKF(68, pid) and JLSD(20, 50, pid))) then
    	WAR.L_NSDFCC = 1;
    	if WAR.Person[id][CC.TXWZ3] ~= nil then
  			WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "・单刀破枪"
  		else
    		WAR.Person[id][CC.TXWZ3] = "单刀破枪"
    	end
    end
    
	local function efttext(ziti,text,dhid) --显示字体
		if WAR.Person[WAR.CurID][ziti] == nil then
			WAR.Person[WAR.CurID][ziti] = text
		else
			WAR.Person[WAR.CurID][ziti] = WAR.Person[WAR.CurID][ziti].."+"..text
		end
		WAR.Person[WAR.CurID]["特效动画"] = dhid;
	end
	
	if DT(pid,83) and WAR.GUDU==0 then --何铁手50%嗜血蛊
		if JLSD(10, 60, pid) then
			efttext("特效文字3","嗜血蛊",90)
			WAR.GUDU=1
		end
		--[[if math.random(10)<=4 then
			efttext("特效文字3","龙眠蛊",90)
			WAR.GUDU=WAR.GUDU+1
		end		]]
	end
	
	if hasTF(pid, 43) and WAR.VAMPIRE[pid] == nil and JLSD(10, 60, pid) and not WAR.TSYXL == 1 then
		efttext("特效文字3", "魍魉夜行", 150)
		WAR.VAMPIRE[pid] = 0		
	end
	
	if WAR.TSYXL == 1 and WAR.VAMPIRE[pid] == nil then
		WAR.VAMPIRE[pid] = 0
	end	
	
	--nino: 桃花三宝
	if wugong==18 or wugong==12 or wugong==38 then
		local n = 0;
		for i=1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
			if (JY.Person[pid]["武功"..i] == 18 or JY.Person[pid]["武功"..i] == 12 
			or JY.Person[pid]["武功"..i] == 38) and JY.Person[pid]["武功等级"..i] >= 999 then
				n = n + 1
			end
		end
		if n==3 then
			WAR.THSB=5 --伤害加10%
			local jilv=70
			if DT(pid,56) or DT(pid,63) or DT(pid,78) or GX(pid) or DT(pid, 57) then 
				jilv=jilv+10
			end
			if JLSD(10, jilv, pid) then --60%几率出效果，三个徒弟加10
				if wugong==12 then --落英迟缓
					WAR.THSB=1
					WAR.Person[id][CC.TXWZ3] = "桃花影落飞神剑"
				elseif wugong==18 then --弹指封穴
					if math.random(10)<=5 then
						WAR.THSB=2
						WAR.Person[id][CC.TXWZ3] = "弹指人将老 回头憾苦多"
					end
				else --玉箫杀内300
					WAR.THSB=3
					WAR.Person[id][CC.TXWZ3] = "碧海潮生弄玉箫"
				end
			end
			local jilv=10 --初始几率10
			if JY.Person[pid]["轻功"]>400 then --轻功400以上，每20点+1点几率
				jilv=jilv+math.modf((JY.Person[pid]["轻功"]-400)/20)
			end
			if DT(pid,56) or DT(pid,63) or DT(pid,78) or GX(pid) or DT(pid, 57) then --三个徒弟几率+5
				jilv=jilv+5
			end
			if jilv >= math.random(100) and fightnum < 3 then
				fightnum=3
				efttext("特效文字1","桃花岛绝学・奇门五转",90)				
			end
			if fightnum>=3 then WAR.WS = 1 end
		end	
	end
	
	if wugong==18 or wugong==12 or wugong==38 then ----沼跃鱼：真传桃花三宝
		if MPPD(pid) == 10 and WAR.THSB~=5 then
			WAR.THSB4 = 1 --伤害加10%
			local str=""
			local jilv1 = MPDJ(pid)*20
			if DT(pid,56) or DT(pid,63) or DT(pid,78) or GX(pid) then 
				jilv1=jilv1+30
			end
		    if PersonKF(pid, 6) then
                jilv1=jilv1+10
	        end
			if PersonKF(pid,193) then
				jilv1 = jilv1 + 30
			end	
			if JLSD(10, jilv1, pid) and WAR.THSB~=1 then --60%几率出效果，三个徒弟加10
				WAR.THSB1=1
				str="真传・桃花影落飞神剑"
				if PersonGTJL(pid,6,WAR.NGJL) then
					WAR.THSB1=2
					str="真传・芳华落尽劈空掌"
				end
					efttext("特效文字3",str,90)
			end
			if JLSD(10, jilv1, pid) and WAR.THSB~=2 then --弹指封穴
				WAR.THSB2=1
				str="真传・弹指易老情空若"
				if PersonGTJL(pid,6,WAR.NGJL) then
					WAR.THSB2=2
					str="真传・兰花拂面暗疏影"
				end
					efttext("特效文字3",str,90)
			end
			if JLSD(10, jilv1, pid) and WAR.THSB~=3 then --玉箫杀内200
				WAR.THSB3=1
				str="真传・碧海潮生弄玉箫"
				if PersonGTJL(pid,6,WAR.NGJL) then
					WAR.THSB3=2
				    str="真传・玉漏催银舞神剑"
				end
					efttext("特效文字3",str,90)
			end
			local jilv2 = MPDJ(pid)*10 --初始几率10			
			if JY.Person[pid]["轻功"]>200 then --轻功200以上，每20点+1点几率
				jilv2=jilv2+math.modf((JY.Person[pid]["轻功"]-200)/20)
			end
			if DT(pid,56) or DT(pid,63) or DT(pid,78) or GX(pid) or DT(pid , 57) then --三个徒弟几率+20
				jilv2=jilv2+20
			end
			if jilv2 >= math.random(100) and fightnum < 3 then
				if PersonKF(pid,193) and JLSD(10,60,pid) then
				fightnum=5
				else
				fightnum=3
				end
				efttext("特效文字1","桃花岛绝学・奇门五转",90)				
			end
			if fightnum>=3 then WAR.WS=1 end
		end	
	end
	
	--碧海主运效果
	if MPPD(pid) == 10 and PersonGTJL(pid,6,WAR.NGJL) and ((wugong==18 or wugong==12 or wugong==38) or wglw(pid,6) or DT(pid,57))then--桃花岛 悲欢离合曲
		local str = ""
		local mpdj=MPDJ(pid)
		local p = JY.Person[pid]
		local aa = math.random(4)
		if aa < 4 then
			for j = 1, WAR.PersonNum-1 do 
				local eid = WAR.Person[j]["人物编号"]
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
					if aa == 1 then--悲曲
						local bb = (WAR.LQZ[eid] or 0)
						AddPersonAttrib(eid,"生命",-(bb*(2+mpdj)))
						WAR.LQZ[eid] = nil
						str = "潮音・悲曲・芳魂辞泪"
					elseif aa == 2 then--欢曲	
						WAR.HOT[eid] = (WAR.HOT[eid] or 0) + math.modf(15*mpdj)
						WAR.YQWR1[eid] = (WAR.YQWR1[eid]or 0) + 15
						str = "潮音・欢曲・红烛鸾帐"
					elseif aa == 3 then
						if math.random(10) > 3 then
							WAR.CYSH[eid] = 20
						else
							WAR.YHDF[eid] = 1
						end
						str = "潮音・离曲・不思难忘"
					end
				end
			end
		else
			local x = math.modf(p["生命"]/p["生命最大值"])
			local y = math.modf(p["内力"]/p["内力最大值"])
			local z = math.modf(p["体力"]/100)
			if x == 1 and y == 1 and z == 1 then
			elseif x >= y and x >= z then
				WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid,"内力", math.modf(p["内力最大值"]*x))
				WAR.Person[WAR.CurID]["体力点数"] = (WAR.Person[WAR.CurID]["体力点数"] or 0) + AddPersonAttrib(pid,"体力", math.modf(100*x))
			elseif y >= x and y >= z then
				WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid,"生命", math.modf(p["生命最大值"]*y))
				WAR.Person[WAR.CurID]["体力点数"] = (WAR.Person[WAR.CurID]["体力点数"] or 0) + AddPersonAttrib(pid,"体力", math.modf(100*y))
			elseif z >= x and z >= y then
				WAR.Person[WAR.CurID]["真伤点数"] = (WAR.Person[WAR.CurID]["真伤点数"] or 0) + AddPersonAttrib(pid,"生命", math.modf(p["生命最大值"]*z))
				WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0) + AddPersonAttrib(pid,"内力", math.modf(p["内力最大值"]*z))
			end
			str = "潮音・合曲・湖桥伞下"	
		end
		efttext("特效文字2",str,137)	
	end	
	
	--旋风扫叶腿领悟
	if MPPD(pid) == 10 and wglw2(pid,193) and PersonKF(pid,193) and JLSD(10,35,pid) and WAR.ACT > 1 then
		if wugong==18 or wugong==12 or wugong==38 then 
			WAR.THKF = 1
			efttext("特效文字3","桃花秘传・狂风绝技",137)
		end
	end	
	
	if wugong == 140 and DT(pid,558) and JLSD(10,30,pid) then
		WAR.HSYFD = 1
		if fightnum >2 then
			fightnum = 2
		end
		CleanWarMap(4, 0)
        for i = 0, WAR.PersonNum - 1 do
            if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
                SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
            end
        end		
		ng = ng + 2000
		WAR.WS = 1
		if WAR.Person[id][CC.TXWZ1] ~= nil then
			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .."+万解・白霞罚"
		else
			WAR.Person[id][CC.TXWZ1] = "万解・白霞罚"
		end
	end	
	
	if wglw1(pid,60) or DT(pid,166) then
		if wugong == 37 and PersonKFJ(pid, 60) and (JLSD(10, 70, pid) or WAR.ZYHB1[pid] ~= nil) then
			WAR.ZFLY = 1
			ng = ng + math.modf(sixi(pid, 3)*1.5)
			if MPPD(pid) == 19 and PersonGTJL(pid,204,WAR.NGJL) then
				WAR.ZFLY1=ng
			end
			efttext("特效文字1","正反两仪・道剑魔刀",139)
		elseif wugong == 60 and PersonKFJ(pid, 37) and (JLSD(10, 70, pid) or WAR.ZYHB1[pid] ~= nil) then
			WAR.ZFLY = 1
			ng = ng + math.modf(sixi(pid, 2)*1.5)
			if MPPD(pid) == 19 and PersonGTJL(pid,204,WAR.NGJL) then
				WAR.ZFLY1=ng
			end
			efttext("特效文字1","正反两仪・邪剑圣刀",139)
		end	
	else
		if wugong == 37 and PersonKFJ(pid, 60) and (JLSD(10, 70, pid) or WAR.ZYHB1[pid] ~= nil) then
			WAR.ZFLY = 1
			ng = ng + math.modf(sixi(pid, 3)*1.5)
			if MPPD(pid) == 19 and PersonGTJL(pid,204,WAR.NGJL) then
				WAR.ZFLY1=ng
			end
			if wglw1(pid,77)then
				efttext("特效文字1","倒乱・两仪化四象 四象生八卦",139)
			else
				efttext("特效文字1","两仪化四象 四象生八卦",139)
			end
		elseif wugong == 60 and PersonKFJ(pid, 37) and (JLSD(10, 70, pid) or WAR.ZYHB1[pid] ~= nil) then
			WAR.ZFLY = 1
			ng = ng + math.modf(sixi(pid, 2)*1.5)
			if MPPD(pid) == 19 and PersonGTJL(pid,204,WAR.NGJL) then
				WAR.ZFLY1=ng
			end
			if wglw1(pid,77)then
				efttext("特效文字1","倒乱・两仪化四象 四象生八卦",139)
			else
				efttext("特效文字1","两仪化四象 四象生八卦",139)
			end
		end	
	end	
	
	--[[if wugong == 37 and (PersonKFJ(pid, 60) or (MPPD(pid) == 14 and PersonGTJL(pid,90,WAR.NGJL))) and (JLSD(10, 70, pid) or WAR.ZYHB1[pid] ~= nil) and not (wglw1(pid,60) or DT(pid,166)) then --60%正反两仪
		WAR.ZFLY = 1
		ng = ng + math.modf(sixi(pid, 3)*1.5)
		if MPPD(pid) == 14 and PersonGTJL(pid,90,WAR.NGJL) then
		    WAR.ZFLY1=ng
		end
		if wglw1(pid,77)then
			efttext("特效文字1","倒乱・两仪化四象 四象生八卦",139)
		else
			efttext("特效文字1","两仪化四象 四象生八卦",139)
		end	
	elseif wugong == 37 and (PersonKFJ(pid, 60) or (MPPD(pid) == 14 and PersonGTJL(pid,90,WAR.NGJL))) and (JLSD(10, 70, pid) or WAR.ZYHB1[pid] ~= nil) and (wglw1(pid,60) or DT(pid,166)) then
		WAR.ZFLY = 1
		ng = ng + math.modf(sixi(pid, 3)*2.5)
		if MPPD(pid) == 14 and PersonGTJL(pid,90,WAR.NGJL) then
		    WAR.ZFLY1=ng
		end
		efttext("特效文字1","正反两仪・道剑魔刀",139)
	end
	
	if wugong == 60 and (PersonKFJ(pid, 60) or (MPPD(pid) == 14 and PersonGTJL(pid,90,WAR.NGJL))) and (JLSD(10, 70, pid) or WAR.ZYHB1[pid] ~= nil) and not (wglw1(pid,60) or DT(pid,166)) then --60%正反两仪
		WAR.ZFLY = 2
		ng = ng + math.modf(sixi(pid, 2)*1.5)
		if MPPD(pid) == 14 and PersonGTJL(pid,90,WAR.NGJL) then
		    WAR.ZFLY1=ng
		end
		if wglw1(pid,77)then
			efttext("特效文字1","倒乱・两仪化四象 四象生八卦",139)
		else
			efttext("特效文字1","两仪化四象 四象生八卦",139)
		end
	elseif wugong == 60 and (PersonKFJ(pid, 37) or (MPPD(pid) == 14 and PersonGTJL(pid,90,WAR.NGJL))) and (JLSD(10, 70, pid) or WAR.ZYHB1[pid] ~= nil) and (wglw1(pid,60) or DT(pid,166)) then
		WAR.ZFLY = 2
		ng = ng + math.modf(sixi(pid, 2)*2.5)
		if MPPD(pid) == 14 and PersonGTJL(pid,90,WAR.NGJL) then
		    WAR.ZFLY1=ng
		end
		efttext("特效文字1","正反两仪・邪剑圣刀",139)
	end]]
	
	if wugong == 35 and PersonKFJ(pid, 61) and (JLSD(10, 70, pid) or WAR.ZYHB1[pid] ~= nil) then --金乌映雪60%几率
		WAR.JWYX = 1
		ng = ng + 800
		if wglw1(pid,77) then
			efttext("特效文字1","倒乱・金乌映雪・玄冰",2)
		else
			efttext("特效文字1","金乌映雪・玄冰",2)
		end
	end
	
	if wugong == 61 and PersonKFJ(pid, 35) and (JLSD(10, 70, pid) or WAR.ZYHB1[pid] ~= nil) then
		WAR.JWYX = 2
		ng = ng + 800
		if wglw1(pid,77) then
			efttext("特效文字1","倒乱・金乌映雪・烈炎",33)
		else
			efttext("特效文字1","金乌映雪・烈炎",33)
		end	
	end
	
	if (wugong == 137 or wugong == 55) and PersonKFJ(pid,28) and PersonKFJ(pid,55) then
		local aa = math.modf((sixi(pid,2)+sixi(pid,3))/10)
		if aa > 50 then aa = 50 end
		if JLSD(10,10+aa,pid) then
			WAR.FDLJ = 1
			if wglw1(pid,77) then
				efttext("特效文字1","倒乱・狂风怒嚎・雷鸣惊世",114)
			else
				efttext("特效文字1","狂风怒嚎・雷鸣惊世",114)
			end	
		end
	end	
	
	
	
	
	--蓝烟清：五岳剑法
	if wugong == 30 or wugong == 31 or wugong == 32 or wugong == 33 or wugong == 34 then
		local n = 0;
		for i=1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
			if (JY.Person[pid]["武功"..i] == 30 or JY.Person[pid]["武功"..i] == 31 or JY.Person[pid]["武功"..i] == 32 or JY.Person[pid]["武功"..i] == 33 or JY.Person[pid]["武功"..i] == 34) and JY.Person[pid]["武功等级"..i] >= 999 then
				n = n + 1
			end
		end
		
		local bwy = 0
		if (wugong == 34 and DT(pid, 19)) or (wugong == 32 and DT(pid, 20)) or
			(wugong == 30 and DT(pid, 21)) or (wugong == 33 and DT(pid, 22))
			or (wugong == 31 and DT(pid, 23)) then
			bwy = 1
		end
		
		if n == 5 and (JLSD(10, 70, pid) or bwy == 1) then		--60%出
			--五岳剑法，1-封穴 2-流血 3-内伤 4-迟缓 5-连击
			local wuyue=math.random(5)
			WAR.L_WYJFA=wuyue	
			--WAR.BJ = 1
		end
	end
	  
    --蓝烟清：五岳剑派
	if MPPD(pid) == 14 and (wugong == 30 or wugong == 31 or wugong == 32 or wugong == 33 or wugong == 34) then		--必出
		local mpdj = MPDJ(pid)
		if math.random(10) <= (2+mpdj) then
		    WAR.L_WYJFA1=1
		end
		if math.random(10) <= (2+mpdj) then
		    WAR.L_WYJFA2=1
		end
		if math.random(10) <= (2+mpdj) then
		    WAR.L_WYJFA3=1
		end
		if math.random(10) <= (2+mpdj) then
		    WAR.L_WYJFA4=1
	    end
		if math.random(10) <= (2+mpdj) then
		    WAR.L_WYJFA5=1
		end
	end
	  
    --蓝烟清：五岳剑法，增加杀气
    if WAR.L_WYJFA > 0 then   	
    	local n = 6;
    	local tn = 1000;
		if (wugong == 34 and DT(pid, 19)) or (wugong == 32 and DT(pid, 20)) or
			(wugong == 30 and DT(pid, 21)) or (wugong == 33 and DT(pid, 22))
			or (wugong == 31 and DT(pid, 23)) then
			tn = tn + 800;
		end		
    	if PersonGTJL(pid, 89, WAR.NGJL) then		--紫霞加力剑法增加范围
    		n = 8;
    		tn = tn + 500;
    	end
		if JLSD(10, 35, pid) and PersonGT(pid, 89) then --紫霞主功体有25%几率大范围无误伤攻击
			CleanWarMap(4, 0);
			WAR.WS = 1
			for i = 1, n do
				for j = 1, n do
				  SetWarMap(x + i - 1, y + j - 1, 4, 1)
				  SetWarMap(x - i + 1, y + j - 1, 4, 1)
				  SetWarMap(x + i - 1, y - j + 1, 4, 1)
				  SetWarMap(x - i + 1, y - j + 1, 4, 1)
				end
			end
		end
        ng = ng + tn;
	    local wuyuedp=""
	    if WAR.L_WYJFA==1 then --五岳剑法，1-封穴 2-流血 3-内伤 4-迟缓 5-连击
		    wuyuedp="五岳剑法・东岳如座・封"
	    elseif WAR.L_WYJFA==2 then
		    wuyuedp="五岳剑法・南岳如飞・刺"
	    elseif WAR.L_WYJFA==3 then
		    wuyuedp="五岳剑法・中岳如卧・镇"
	    elseif WAR.L_WYJFA==4 then
		    wuyuedp="五岳剑法・北岳如行・徐"
   else
		if fightnum >= 2 then	
			WAR.BJ = 1
		else
			fightnum = fightnum + 1;
		end
		wuyuedp="五岳剑法・西岳如立・连"
	    end
        if WAR.Person[id][CC.TXWZ3] ~= nil then
      	    WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+"..wuyuedp
        else
      	    WAR.Person[id][CC.TXWZ3] = wuyuedp
        end
        --WAR.WS = 1
    end

	if MPPD(pid) == 14 and (wugong == 30 or wugong == 31 or wugong == 32 or wugong == 33 or wugong == 34) and MPDJ(pid) > 1 then   	
    	local n = 6;
    	local tn = 1500;
		local mpdj = MPDJ(pid)
    	if PersonGTJL(pid, 89, WAR.NGJL) then		--紫霞加力剑法增加范围
    		n = 8;
    		tn = tn + 500;
    	end
		if math.random(10) <= (2+mpdj) then --五岳剑派
			CleanWarMap(4, 0);
			WAR.WS=1
			for i = 1, n do
				for j = 1, n do
				  SetWarMap(x + i - 1, y + j - 1, 4, 1)
				  SetWarMap(x - i + 1, y + j - 1, 4, 1)
				  SetWarMap(x + i - 1, y - j + 1, 4, 1)
				  SetWarMap(x - i + 1, y - j + 1, 4, 1)
				end
			end
		end
        ng = ng + tn;
	    local wuyuedp1=""
	    local wuyuedp2=""
	    local wuyuedp3=""
	    local wuyuedp4=""
	    local wuyuedp5=""
	    if WAR.L_WYJFA1==1 then --五岳剑法，1-封穴 2-流血 3-内伤 4-迟缓 5-连击
		    wuyuedp1="东岳如座・封"
		    if WAR.Person[id][CC.TXWZ3] ~= nil then
      	        WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+"..wuyuedp1
            else
      	        WAR.Person[id][CC.TXWZ3] = wuyuedp1
            end
	    end
	    if WAR.L_WYJFA2==1 then
		    wuyuedp2="南岳如飞・刺"
		    if WAR.Person[id][CC.TXWZ3] ~= nil then
      	        WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+"..wuyuedp2
            else
      	        WAR.Person[id][CC.TXWZ3] = wuyuedp2
            end
	    end
	    if WAR.L_WYJFA3==1 then
		    wuyuedp3="中岳如卧・镇"
		    if WAR.Person[id][CC.TXWZ3] ~= nil then
      	        WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+"..wuyuedp3
            else
      	        WAR.Person[id][CC.TXWZ3] = wuyuedp3
            end
	    end
	    if WAR.L_WYJFA4==1 then
		    wuyuedp4="北岳如行・徐"
		    if WAR.Person[id][CC.TXWZ3] ~= nil then
      	        WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+"..wuyuedp4
            else
      	        WAR.Person[id][CC.TXWZ3] = wuyuedp4
            end
	    end
	    if WAR.L_WYJFA5==1 then
		    if fightnum >= 2 then	
			    WAR.BJ = 1
		    else
			    fightnum = 2;
		    end
		    wuyuedp5="西岳如立・连"
		    if WAR.Person[id][CC.TXWZ3] ~= nil then
      	        WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+"..wuyuedp5
            else
      	        WAR.Person[id][CC.TXWZ3] = wuyuedp5
            end
	    end
            --WAR.WS = 1
    end
	
	if DT(pid, 5) and WAR.TJZX > 0 then --沼跃鱼：张三丰太极之形
        local zhongshu=WAR.TJZX
	    local cishu=0
	    if PersonGT(pid, 99) then
	        zhongshu=zhongshu+1
	    end
	    for i = 1,zhongshu do
	        if math.random(10)>=(9-zhongshu) then
		        cishu=cishu+1
		    end
	    end
	    WAR.TJZX1 = WAR.TJZX
	    WAR.TJZX = 0
	    WAR.TJZX2 = limitX(cishu, 0, 4)
	    fightnum = fightnum + WAR.TJZX2
	    if fightnum > 6 then 
	        fightnum = 6 
	    end
	    if WAR.TJZX2>0 then
	        efttext("特效文字1","太极之形・圆转不断",90)
        end	   
    end
	
	if (pid == 0 and putong() > 0) then
	local a = 0
	local c = 0
	if putong() == 1 and JY.Person[pid]["拳掌功夫"] > 200 then
	   c = limitX(math.modf((JY.Person[pid]["拳掌功夫"]-200)/4),0,30)
	   end
	if putong() == 2 and JY.Person[pid]["御剑能力"] > 200 then
	   c = limitX(math.modf((JY.Person[pid]["御剑能力"]-200)/4),0,30)  
	   end
	if putong() == 3 and JY.Person[pid]["耍刀技巧"] > 200 then
	   c = limitX(math.modf((JY.Person[pid]["耍刀技巧"]-200)/4),0,30)
	   end
	if putong() == 4 and JY.Person[pid]["特殊兵器"] > 200 then
	   c = limitX(math.modf((JY.Person[pid]["特殊兵器"]-200)/4),0,30) 
	   end
	if putong() == 5 and JY.Person[pid]["内力最大值"] > 2000 then
	   c = limitX(math.modf((JY.Person[pid]["内力最大值"]-2000)/40),0,30) 
	   end
	if putong() == 13 and JY.Person[pid]["暗器技巧"] > 200 then
	   c = limitX(math.modf((JY.Person[pid]["暗器技巧"]-200)/4),0,30) 
    end
	if putong() == 1 and JY.Person[pid]["拳掌功夫"] > 100 then
	   a = limitX(math.modf((JY.Person[pid]["拳掌功夫"]-100)/2),0,50)
	   end
	if putong() == 2 and JY.Person[pid]["御剑能力"] > 100 then
	   a = limitX(math.modf((JY.Person[pid]["御剑能力"]-100)/2),0,50)  
	   end
	if putong() == 3 and JY.Person[pid]["耍刀技巧"] > 100 then
	   a = limitX(math.modf((JY.Person[pid]["耍刀技巧"]-100)/2),0,50)
	   end
	if putong() == 4 and JY.Person[pid]["特殊兵器"] > 100 then
	   a = limitX(math.modf((JY.Person[pid]["特殊兵器"]-100)/2),0,50) 
	   end
	if putong() == 5 and JY.Person[pid]["内力最大值"] > 1000 then
	   c = limitX(math.modf((JY.Person[pid]["内力最大值"]-1000)/40),0,30) 
	  end
	if putong() == 13 and JY.Person[pid]["暗器技巧"] > 100 then
	   c = limitX(math.modf((JY.Person[pid]["暗器技巧"]-100)/2),0,50) 
    end
	   if JLSD(0,a,pid) and WAR.LMBJ == 0 then 
	   fightnum = fightnum + 1
	   WAR.LMBJ = 1
	   WAR.LMBJ2 = 1
	   end
	   if JLSD(0,c,pid) and WAR.LMBJ1 == 0 then 
	   fightnum = fightnum + 1
	   WAR.LMBJ1 = 1
	   WAR.LMBJ3 = 1
	   end
	end
	
	if MPPD(pid)==16 and PersonGT(pid,100) then
	local a = 0
	local c = 0
	
	if JY.Person[pid]["内力"] > 3000 then
	   c = limitX(math.modf((JY.Person[pid]["内力"]-3000)/40),0,30)  
	   end
	
	if JY.Person[pid]["内力"] > 1000 then
	   a = limitX(math.modf((JY.Person[pid]["内力"]-1000)/2),0,50)  
	   end
	
	   if JLSD(0,a,pid) and WAR.LMBJ6 == 0 then 
	   fightnum = fightnum + 1
	   WAR.LMBJ6 = 1
	   WAR.LMBJ8 = 1
	   end
	   if JLSD(0,c,pid) and WAR.LMBJ7 == 0 then 
	   fightnum = fightnum + 1
	   WAR.LMBJ7 = 1
	   WAR.LMBJ9 = 1
	   end
	end
	
    if DT(pid,601) then
	local a = 0
	local c = 0
	
	if JY.Person[pid]["内力"] > 3000 then
	   c = limitX(math.modf((JY.Person[pid]["内力"]-3000)/40),0,30)  
	   end
	
	if JY.Person[pid]["内力"] > 1000 then
	   a = limitX(math.modf((JY.Person[pid]["内力"]-1000)/2),0,50)  
	   end
	
	   if JLSD(0,a,pid) and WAR.LMBJ == 0 then 
	   fightnum = fightnum + 1
	   WAR.LMBJ = 1
	   WAR.LMBJ2 = 1
	   end
	   if JLSD(0,c,pid) and WAR.LMBJ1 == 0 then 
	   fightnum = fightnum + 1
	   WAR.LMBJ1 = 1
	   WAR.LMBJ3 = 1
	   end
	end
	
	
    --张三丰，(60-30+10)%机率增加20%的伤害，杀集气+1000
    if DT(pid, 5) and WAR.Person[id][CC.TXWZ3] ~= nil and JLSD(30, 60, pid) then
      WAR.Person[id][CC.TXWZ3] = CC.EVB110 .. "・" .. WAR.Person[id][CC.TXWZ3]  --化朽为奇
      ng = ng + 1000
      WAR.ZSF2 = 1
    end

    if MPPD(pid) == 11 then --一刀流切返1-25-
	    local a = 0
	    if WAR.QF[pid] ~= nil and WAR.QF[pid] > 0 then 
	        a = WAR.QF[pid] 
	        if a > 3 then 
	            a = 3 
	        end
	        fightnum = fightnum + a
	        WAR.QF[pid] = nil
	        efttext("特效文字1","秘剑・切返",90)
	    end
	end  
	
    --虚竹50%出生死符，杀集气+1000
    if JY.Person[pid]["武功" .. wugongnum] == 176 and (JLSD(20, 70, pid) or ZYJ(pid)) then
        WAR.Person[id][CC.TXWZ3] = CC.WARS60   --灵鹫宫绝学・生死符
        ng = ng + 1200
        WAR.SSFwav = 1   --音效
        WAR.TZ_XZ = 1
    end
	
	if JY.Person[pid]["武功" .. wugongnum] == 176 and JX(pid) and DT(pid, 49) and (JLSD(20, 70, pid) or ZYJ(pid) ) then     
	    WAR.Person[id][CC.TXWZ1] = "幽冥夜叉.生死轮回"   --灵鹫宫绝学・生死符
        WAR.TZ_XZ2 = 1
    end
 
    if DT(pid, 117) or DT(pid, 116) then --唯我独尊--17-2-27
	    if WAR.Person[id][CC.TXWZ3] == nil then 
            WAR.Person[id][CC.TXWZ3] = CC.WARS60   --灵鹫宫绝学・生死符
	    else 
	        WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+"..CC.WARS60   --灵鹫宫绝学・生死符
	    end
        ng = ng + 1700
        WAR.SSFwav = 1   --音效
        WAR.TZ_XZ = 1
    end
 
    --蓝烟清：李文秀使用特系攻击60%的机率大幅度杀集气
    if DT(pid , 590) and yongte(wugong) and JLSD(30, 80, pid) then
    	WAR.Person[id][CC.TXWZ3] = "心秀天铃・星月争辉";
    	ng = ng + 1200
        --WAR.SSFwav = 1   --音效	
    end
    
    
    --蓝烟清：柔云剑法，累加杀集气
	--nino 柔云最多500杀气
    if WAR.L_RYJF[pid] ~= nil and wugong ~= 36 then
    	ng = ng + 100*WAR.L_RYJF[pid];
		WAR.L_RYJF[pid]=nil
    end
    
    --蓝烟清：灭绝剑法，灭加伤害，装备倚天剑效果加倍
    --绝
    if WAR.L_MJJF == 2 then
    	ng = ng + 500;
    end
    
	if WAR.L_MJJF == 4 then
		ng = ng + 500;	
		if JLSD(10,70,pid) then
			ng = ng + 1000;
		end
	end
	
	
	local dagoujv=0 --装备打狗棒几率+5
	if JY.Person[pid]["武器"] == 49 then
    	dagoujv = dagoujv + 5;
    end
	if DT(pid,56) then --黄蓉+10几率
		dagoujv = dagoujv + 10
	end
	if GB(pid)==2 and WAR.GBLJ[pid]~=nil and WAR.GBLJ[pid]>=0 then --净衣加几率
		dagoujv = dagoujv + 5*WAR.GBLJ[pid]
	end

    --打狗棒法 特效   40%，特主角45%独立判定
   
	if JY.Person[pid]["武功" .. wugongnum] == 80 and JY.Person[pid]["武功等级" .. wugongnum] >= 999 
		and ((JLSD(30, 70+dagoujv, pid) or (getHZ(pid, 33) and JLSD(10, 30)) or ((DT(pid, 69) 
		or (pid == 0 and putong() == 4)) and JLSD(30, 75, pid))) or (PersonKF(pid, 26) and JLSD(10, 30, pid))) then
	  
	if GB(pid)==2 and WAR.GBLJ[pid]~=nil and WAR.GBLJ[pid]>=1 then--净衣丐帮打狗大招
	    if WAR.Person[id][CC.TXWZ1] == nil then 
            WAR.Person[id][CC.TXWZ1] = "打狗棒法最终奥义.恶犬皆尽"   --打狗棒法绝学--天下无狗
	    else 
	        WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+".. "打狗棒法最终奥义.恶犬皆尽"
	    end
            WAR.Person[id][CC.TXDH] = 89
        if WAR.Person[id][CC.TXWZ3] ~= nil then
            ng = ng - 500
        end
	    ng = ng + WAR.GBLJ[pid]*600
     
	    CleanWarMap(4, 0)
		for i = 0, WAR.PersonNum - 1 do
			if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
				SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
			end
		end	
		WAR.WS = 1
		WAR.GBLJ[pid]=WAR.GBLJ[pid]-1
		WAR.GCTJ1=1
	else
	    if WAR.Person[id][CC.TXWZ3] == nil then 
            WAR.Person[id][CC.TXWZ3] = CC.WARS61   --打狗棒法绝学--天下无狗
	    else 
	        WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+"..CC.WARS61
	    end
            WAR.Person[id][CC.TXDH] = 89
            if WAR.Person[id][CC.TXWZ3] ~= nil then
                ng = ng - 1000
            end
            ng = ng + 1800
            WAR.WS = 1
            for i = 1, 6 do
                for j = 1, 6 do
                    SetWarMap(x + i - 1, y + j - 1, 4, 1)
                    SetWarMap(x - i + 1, y + j - 1, 4, 1)
                    SetWarMap(x + i - 1, y - j + 1, 4, 1)
                    SetWarMap(x - i + 1, y - j + 1, 4, 1)
                end
            end
	    end
	elseif GB(pid)==2 then
	    WAR.GBLJ[pid]=WAR.GBLJ[pid] or 0 + 1
	    if JLSD(10,40,pid) then
	        WAR.GBLJ[pid]=WAR.GBLJ[pid] or 0 + 1
	        if WAR.Person[id][CC.TXWZ3] == nil then 
                WAR.Person[id][CC.TXWZ3] = "奥义.棒打双犬"   
	        else 
	            WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+".."奥义.棒打双犬"
	        end
                WAR.Person[id][CC.TXDH] = 45
	        end
	    else
    end
    
	if wugong == 80 and ((DT(pid, 50) or DT(pid, 56)) or wglw1(pid,80)) and JLSD(10, 60, pid) then
        WAR.YANGKANG=1
		if WAR.Person[id][CC.TXWZ3] == nil then
			WAR.Person[id][CC.TXWZ3] = "打狗棒法・挑字诀"
		else
			WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+打狗棒法・挑字诀"
		end
    end 	
	
	if wugong == 80 and ((DT(pid, 50) or DT(pid, 69)) or wglw1(pid,80)) and JLSD(10, 60, pid) then
        ng = ng + 1500
        if WAR.Person[id][CC.TXWZ3] ~= nil then
		    WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+打狗棒法・封字诀"
	    else
		    WAR.Person[id][CC.TXWZ3] = "打狗棒法・封字诀"
	    end
	end		
	
	if wugong == 80 and ((DT(pid, 50) or DT(pid, 56)) or wglw1(pid,80)) and JLSD(10, 60, pid) then
	    WAR.KHBX = 2
	    if WAR.Person[id][CC.TXWZ3] ~= nil then
		    WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+打狗棒法・戳字诀"
	    else
		    WAR.Person[id][CC.TXWZ3] = "打狗棒法・戳字诀"
	    end   
    end			
	
	if wugong == 80 and ((DT(pid, 50) or DT(pid, 69)) or wglw1(pid,80)) and JLSD(10, 60, pid) then
        local jiali= math.modf(JY.Person[pid]["内力最大值"]/10)
	    ng = ng + jiali
        WAR.BJ = 1
	    WAR.WS = 1
        if WAR.Person[id][CC.TXWZ3] ~= nil then
		    WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+打狗棒法・引字诀"
	    else
		    WAR.Person[id][CC.TXWZ3] = "打狗棒法・引字诀"
	    end   
    end			 		
	
    if wugong == 80 and ((DT(pid, 50) or DT(pid, 69)) or wglw1(pid,80)) and JLSD(10, 60, pid) then
        for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then				
			    local tmppid = WAR.Person[j]["人物编号"]
				WAR.L_NOT_MOVE[tmppid]=WAR.L_NOT_MOVE[tmppid] or 0 + 1
			end
		end		
	    if WAR.Person[id][CC.TXWZ3] ~= nil then
		    WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+打狗棒法・绊字诀"
	    else
		    WAR.Person[id][CC.TXWZ3] = "打狗棒法・绊字诀"
	    end 
	end
	
    if wugong == 80 and ((DT(pid, 50) or DT(pid, 56)) or wglw1(pid,80)) and JLSD(10, 60, pid) then
        CleanWarMap(4, 0)
        for i = 0, WAR.PersonNum - 1 do
            if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
                SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
            end
        end	
	    WAR.WS = 1	
	    WAR.Person[id][CC.TXDH] = 170
		if WAR.Person[id][CC.TXWZ2] ~= nil then
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .."+劈字诀・天下无狗"
		else
			WAR.Person[id][CC.TXWZ2] = "劈字诀・天下无狗"
		end
				ng = ng + 5000
	    for j = 0, WAR.PersonNum - 1 do
		    for j = 0, WAR.PersonNum - 1 do	
		        if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
			        WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"],"生命",-150)
					WAR.Person[j]["内力点数"] = (WAR.Person[j]["内力点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"],"内力",-500)
					--JY.Person[WAR.Person[j]["人物编号"]]["生命"] = JY.Person[WAR.Person[j]["人物编号"]]["生命"] - 150
			        if JY.Person[WAR.Person[j]["人物编号"]]["生命"] <= 0 then
				        JY.Person[WAR.Person[j]["人物编号"]]["生命"] = 1
			        end
			        WAR.XNXS[WAR.Person[j]["人物编号"]] = 1
		        end
		    end	
	    end				
	end				
	
	if WAR.ZYHB > 0 and PersonKFJ(pid, 39) and PersonKFJ(pid, 42) then --双剑合璧
		if WAR.ZYHB == 1 and wugong == 39 then
			WAR.SJHB[pid] = 39
		end
		if WAR.ZYHB == 2 and WAR.SJHB[pid] == 39 and wugong == 42 then
			WAR.SJHB[pid] = 3
			if WAR.Person[id][CC.TXWZ3] ~= nil then
				ng = ng - 1000
			end	
			local txt = {"清饮小酌", "抚琴按萧", "松下对弈", "西窗夜话", "柳荫联句", "竹帘临池", "锦笔生花"}	
			WAR.Person[id][CC.TXWZ3] = txt[math.random(#txt)]
			ng = ng + 1300
		end
		if WAR.ZYHB == 1 and wugong == 42 then
			WAR.SJHB[pid] = 42
		end
		if WAR.ZYHB == 2 and WAR.SJHB[pid] == 42 and wugong == 39 then
			WAR.SJHB[pid] = 3
			if WAR.Person[id][CC.TXWZ3] ~= nil then
				ng = ng - 1000
			end		
			local txt = {"清饮小酌", "抚琴按萧", "松下对弈", "西窗夜话", "柳荫联句", "竹帘临池", "锦笔生花"}	
			WAR.Person[id][CC.TXWZ3] = txt[math.random(#txt)]			
			ng = ng + 1300
		end	
	end
	
	if (MPPD(pid) == 3 or DT(pid,59)) and PersonKFJ(pid, 39) and PersonKFJ(pid, 42) and yongjian(wugong) and PersonGT(pid,121) then
		if JLSD(10,40,pid) and WAR.ZYHB == 0 then
		WAR.SJHB[pid] = 3
		ng = ng + 1000
		local txt = {"清饮小酌", "抚琴按萧", "松下对弈", "西窗夜话", "柳荫联句", "竹帘临池", "锦笔生花"}	
		WAR.Person[id][CC.TXWZ3] = txt[math.random(#txt)]	
		end
	end	
	
	if PersonKFJ(pid, 42) and DT(pid,601) and wugong == 42 and WAR.ACT>1 then
	    WAR.SJHB[pid] = 3
	    if WAR.Person[id][CC.TXWZ3] ~= nil then
			ng = ng - 1000
		end		
		local txt = {"单剑.清饮小酌", "单剑.抚琴按萧", "单剑.松下对弈", "单剑.西窗夜话", "单剑.柳荫联句", "单剑.竹帘临池", "单剑.锦笔生花"}	
		WAR.Person[id][CC.TXWZ3] = txt[math.random(#txt)]			
		ng = ng + 3*sixi(pid,2)
	end
	--昆仑门人刀剑阵开阵
	if MPPD(pid) == 19 then
		local mpdj = MPDJ(pid)
		if JLSD(0,20+(mpdj*5),pid) and (yongjian(wugong) or yongdao(wugong)) and WAR.ZYHB == 0 then
			WAR.ZYHB = 1
		end
	end
	if MPPD(pid) == 19 and MPDJ(pid) > 1 and PersonGT(pid,204) and PersonKF(pid,37) and PersonKF(pid,60) then
		--两仪阵
		if wugong == 60 and WAR.ZYHB == 1 then
			WAR.KLJZK[pid] = 60
		end
		if WAR.ZYHB == 2 and wugong == 37 and WAR.KLJZK[pid] == 60 and WAR.ACT == 1 then
			if WAR.KLJZ ~= 1 then
				WAR.KLJZWF[pid] = 1
				WAR.KLJZ = 1
				WAR.KLJZK[pid] = nil
				for k=0 , WAR.PersonNum-1 do 
					local klid = WAR.Person[k]["人物编号"]
					if WAR.Person[k]["死亡"] == false and WAR.Person[k]["我方"] == WAR.Person[WAR.CurID]["我方"] then
						WAR.KLJZWF[klid] = 1
					elseif WAR.Person[k]["死亡"] == false and WAR.Person[k]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
						WAR.KLJZDF[klid] = 1
					end
				end	
				DHdisplay(2920,2936,"刀剑双绝・顺逆两仪阵・开")
			else
				WAR.KLJZWF[pid] = 0
				WAR.KLJZ = 0
				for k=0 , WAR.PersonNum-1 do 
					local klid = WAR.Person[k]["人物编号"]
					if WAR.Person[k]["死亡"] == false and WAR.Person[k]["我方"] == WAR.Person[WAR.CurID]["我方"] then
						WAR.KLJZWF[klid] = nil
					elseif WAR.Person[k]["死亡"] == false and WAR.Person[k]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
						WAR.KLJZDF[klid] = nil
					end
				end
				DHdisplay(1258, 1275, "昆仑刀剑阵.收")
			end	
		end	
		--风雷阵（先狂风刀、后迅雷剑）
		if wugong == 55 and WAR.ZYHB == 1 then
			WAR.KLJZK[pid] = 55
		end	
		if WAR.ZYHB == 2 and wugong == 137 and WAR.KLJZK[pid] == 55 and WAR.ACT == 1 then
			if WAR.KLJZ ~= 2 then
				WAR.KLJZWF[pid] = 2
				WAR.KLJZ = 2
				WAR.KLJZK[pid] = nil
				for k=0 , WAR.PersonNum-1 do 
					local klid = WAR.Person[k]["人物编号"]
					if WAR.Person[k]["死亡"] == false and WAR.Person[k]["我方"] == WAR.Person[WAR.CurID]["我方"] then
						WAR.KLJZWF[klid] = 2
					elseif WAR.Person[k]["死亡"] == false and WAR.Person[k]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
						WAR.KLJZDF[klid] = 2
					end
				end
				DHdisplay(1803,1839,"刀剑双绝・疾风惊蛰阵・开")
			else
				WAR.KLJZWF[pid] = 0
				WAR.KLJZ = 0
				for k=0 , WAR.PersonNum-1 do 
					local klid = WAR.Person[k]["人物编号"]
					if WAR.Person[k]["死亡"] == false and WAR.Person[k]["我方"] == WAR.Person[WAR.CurID]["我方"] then
						WAR.KLJZWF[klid] = nil
					elseif WAR.Person[k]["死亡"] == false and WAR.Person[k]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
						WAR.KLJZDF[klid] = nil
					end
				end	
				DHdisplay(1258, 1275, "昆仑刀剑阵.收")
			end
		end
		--双绝阵（先胡家刀、再苗家剑）
		if wugong == 67 and WAR.ZYHB == 1 then
			WAR.KLJZK[pid] = 67
		end	
		if wugong == 44 and WAR.ZYHB == 2 and WAR.KLJZK[pid] == 67 and WAR.ACT == 1 then
			if WAR.KLJZ ~= 3 then
				WAR.KLJZWF[pid] = 3
				WAR.KLJZK[pid] = nil
				WAR.KLJZ = 3
				for k=0 , WAR.PersonNum-1 do 
					local klid = WAR.Person[k]["人物编号"]
					if WAR.Person[k]["死亡"] == false and WAR.Person[k]["我方"] == WAR.Person[WAR.CurID]["我方"] then
						WAR.KLJZWF[klid] = 3
					elseif WAR.Person[k]["死亡"] == false and WAR.Person[k]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
						WAR.KLJZDF[klid] = 3
					end
				end
				DHdisplay(2210,2219,"刀剑双绝・天剑绝刀阵・开")
			else
				WAR.KLJZWF[pid] = 0
				WAR.KLJZ = 0
				for k=0 , WAR.PersonNum-1 do 
					local klid = WAR.Person[k]["人物编号"]
					if WAR.Person[k]["死亡"] == false and WAR.Person[k]["我方"] == WAR.Person[WAR.CurID]["我方"] then
						WAR.KLJZWF[klid] = nil
					elseif WAR.Person[k]["死亡"] == false and WAR.Person[k]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
						WAR.KLJZDF[klid] = nil
					end
				end	
				DHdisplay(1258, 1275, "昆仑刀剑阵.收")	
			end
		end
		--霜炎阵（先金乌刀、再雪山剑）	
		if wugong == 61 and WAR.ZYHB == 1 then
			WAR.KLJZK[pid] = 61
		end	
		if wugong == 35 and WAR.ZYHB == 2 and WAR.KLJZK[pid] == 61 and WAR.ACT == 1 then
			if WAR.KLJZ ~= 4 then
				WAR.KLJZWF[pid] = 4
				WAR.KLJZK[pid] = nil
				WAR.KLJZ = 4
				for k=0 , WAR.PersonNum-1 do 
					local klid = WAR.Person[k]["人物编号"]
					if WAR.Person[k]["死亡"] == false and WAR.Person[k]["我方"] == WAR.Person[WAR.CurID]["我方"] then
						WAR.KLJZWF[klid] = 4
					elseif WAR.Person[k]["死亡"] == false and WAR.Person[k]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
						WAR.KLJZDF[klid] = 4
					end
				end
				DHdisplay(2301,2316,"刀剑双绝・霜炎九重阵・开")
			else
				WAR.KLJZWF[pid] = 0
				WAR.KLJZ = 0
				for k=0 , WAR.PersonNum-1 do 
					local klid = WAR.Person[k]["人物编号"]
					if WAR.Person[k]["死亡"] == false and WAR.Person[k]["我方"] == WAR.Person[WAR.CurID]["我方"] then
						WAR.KLJZWF[klid] = nil
					elseif WAR.Person[k]["死亡"] == false and WAR.Person[k]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
						WAR.KLJZDF[klid] = nil
					end
				end	
				DHdisplay(1258, 1275, "昆仑刀剑阵.收")	
			end
		end	
		--佛魔阵（先修罗刀、再达摩剑）
		if wugong == 58 and WAR.ZYHB == 1 then
			WAR.KLJZK[pid] = 58
		end	
		if wugong == 136 and WAR.ZYHB == 2 and WAR.KLJZK[pid] == 58 and WAR.ACT == 1 then
			if WAR.KLJZ ~= 5 then
				WAR.KLJZWF[pid] = 5
				WAR.KLJZK[pid] = nil
				WAR.KLJZ = 5
				for k=0 , WAR.PersonNum-1 do 
					local klid = WAR.Person[k]["人物编号"]
					if WAR.Person[k]["死亡"] == false and WAR.Person[k]["我方"] == WAR.Person[WAR.CurID]["我方"] then
						WAR.KLJZWF[klid] = 5
					elseif WAR.Person[k]["死亡"] == false and WAR.Person[k]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
						WAR.KLJZDF[klid] = 5
					end
				end
				DHdisplay(3331,3346,"刀剑双绝・佛业双身阵・开")
			else
				WAR.KLJZWF[pid] = 0
				WAR.KLJZ = 0
				for k=0 , WAR.PersonNum-1 do 
					local klid = WAR.Person[k]["人物编号"]
					if WAR.Person[k]["死亡"] == false and WAR.Person[k]["我方"] == WAR.Person[WAR.CurID]["我方"] then
						WAR.KLJZWF[klid] = nil
					elseif WAR.Person[k]["死亡"] == false and WAR.Person[k]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
						WAR.KLJZDF[klid] = nil
					end
				end	
				DHdisplay(1258, 1275, "昆仑刀剑阵.收")	
			end
		end
	end
	
    if fqdid(pid) and wugong == 62 then 
	    if JLSD(10,80,pid) then
	        local FQD = {"女貌郎才珠万斛 天教艳丽为眷属","清风引佩下瑶台 明月照装成金屋","刀光掩映孔雀屏 喜结丝萝在乔木","英雄无双风流婿 却扇洞房燃花烛","碧箫声里双凤鸣 今朝有女颜如玉","千金一刻庆良宵 占断人间天上福"}
	        WAR.FQDF = WAR.FQDF + 1
	        if WAR.Person[id][CC.TXWZ1] == nil then 
                WAR.Person[id][CC.TXWZ1] = FQD[math.random(6)]
	        else 
	            WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+"..FQD[math.random(6)]
	        end
	            ng = ng + WAR.FQDF*400
	    else 
	        WAR.FQDF = 0
	    end
	end
    --蓝烟清：胡家刀法，极意
    --刀系主角40%，胡斐50%, 胡一刀40%
    if wugong == 67 and JY.Person[pid]["武功等级" .. wugongnum] >= 999 
		and ((pid == 0 and putong() == 3 and JLSD(30, 70,pid)) 
		or (DT(pid, 621) and JLSD(10, 600,pid))
		or (DT(pid, 1) and JLSD(10, 70, pid))
		or (wglw1(pid,67) and JLSD(10, 80,pid) ))then --and JLSD(10,80,pid)
        local HDJY = {"极意・伏虎式","极意・拜佛听经","极意・穿手藏刀","极意・沙鸥掠波","极意・参拜北斗","极意・闭门铁扇刀","极意・缠身摘心刀","极意・进步连环刀","极意・八方藏刀式"};
        if WAR.Person[id][CC.TXWZ3] ~= nil then
		    ng = ng - 1100
	    end
        if WAR.Person[id][CC.TXWZ3] == nil then
			WAR.Person[id][CC.TXWZ3] = HDJY[math.random(9)]
		else
			WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+"..HDJY[math.random(9)]
		end	
        WAR.Person[id][CC.TXDH] = 6
        ng = ng + 2000
        WAR.WS = 1
        for i = 1, 6 do
            for j = 1, 6 do
                SetWarMap(x + i - 1, y + j - 1, 4, 1)
                SetWarMap(x - i + 1, y + j - 1, 4, 1)
                SetWarMap(x + i - 1, y - j + 1, 4, 1)
                SetWarMap(x - i + 1, y - j + 1, 4, 1)
            end
        end
		if wglw1(pid,67) or (DT(pid,621) and JX(pid)) or (DT(pid,1) and JX(pid)) then
			if JLSD(10,40,pid) or (JY.Person[pid]["武器"] == 45 and JLSD(10,80,pid)) then
			local aa=math.random(3)
			WAR.QLP = WAR.QLP or 0 + aa
				if WAR.QLP > 10 then
				WAR.QLP = 10
			end
			WAR.Person[WAR.CurID][CC.TXWZ2] = "天生牙・苍龙破"
			end
			if JLSD(10,40,pid) or (JY.Person[pid]["武器"] == 44 and JLSD(10,80,pid)) then
			WAR.QYYYL = 1
			end
			WAR.TSYBL = 1
		end
    end
    
    --杨过使用玄铁剑法50%极意
    if DT(pid, 58) and JY.Person[pid]["武功" .. wugongnum] == 45 
	    and JY.Person[pid]["武功等级" .. wugongnum] >= 999 and JLSD(10, 60, pid) then
        if WAR.Person[id][CC.TXWZ3] ~= nil then
		    ng = ng - 1400
	    end
	    WAR.Person[id][CC.TXWZ3] = CC.WARS62  --重剑真传・浪如山涌剑如虹
        WAR.Person[id][CC.TXDH] = 84
        ng = ng + 1700
        WAR.WS = 1
        for i = 1, 5 do
            for j = 1, 5 do
                SetWarMap(x + i - 1, y + j - 1, 4, 1)
                SetWarMap(x - i + 1, y + j - 1, 4, 1)
                SetWarMap(x + i - 1, y - j + 1, 4, 1)
                SetWarMap(x - i + 1, y - j + 1, 4, 1)
            end
        end
		JY.Wugong[wugong]["武功动画&音效"] = 190
    end
    
	if DT(pid, 604) and JY.Person[pid]["武功" .. wugongnum] == 11 
	    and JY.Person[pid]["武功等级" .. wugongnum] >= 999 and JLSD(10, 60, pid) then
	    WAR.Person[id][CC.TXWZ3] = "九阴嫡传・神爪无双"  --重剑真传・浪如山涌剑如虹
        WAR.Person[id][CC.TXDH] = 84
        ng = ng + 2000
        WAR.WS = 1
        for i = 1, 6 do
            for j = 1, 6 do
                SetWarMap(x + i - 1, y + j - 1, 4, 1)
                SetWarMap(x - i + 1, y + j - 1, 4, 1)
                SetWarMap(x + i - 1, y - j + 1, 4, 1)
                SetWarMap(x - i + 1, y - j + 1, 4, 1)
            end
        end
		if JLSD(10,60,pid) then
			WAR.BFX = 1
		else
			WAR.BLX = 1
		end	
    end
	
	--[[豸苗：谢云流万剑
    if XYL(pid) and yongjian(wugong) and JLSD(10, 60, pid) and juexing() > 0 then
    	if WAR.Person[id][CC.TXWZ3] ~= nil then
  			WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+万剑归宗"
  		else
    		WAR.Person[id][CC.TXWZ3] = "万剑归宗"
    	end
        ng = ng + 1000
        WAR.WS = 1
	    local n = math.random(4,9)
		for i = 1, n do
			for j = 1, n do
				SetWarMap(x + i - 1, y + j - 1, 4, 1)
				SetWarMap(x - i + 1, y + j - 1, 4, 1)
				SetWarMap(x + i - 1, y - j + 1, 4, 1)
				SetWarMap(x - i + 1, y - j + 1, 4, 1)
			end
		end
    end]]

    if MPPD(pid) == 11 and wugong == 131 and WAR.SJL == 5 then
		ng = ng + 1800
		WAR.WS = 1
		for i = 1, 7 do
		    for j = 1, 7 do
			    SetWarMap(WAR.Person[WAR.CurID]["坐标X"] + i * 2 - 1, WAR.Person[WAR.CurID]["坐标Y"] + j * 2 - 1, 4, 1)
			    SetWarMap(WAR.Person[WAR.CurID]["坐标X"] - i * 2 + 1, WAR.Person[WAR.CurID]["坐标Y"] + j * 2 - 1, 4, 1)
			    SetWarMap(WAR.Person[WAR.CurID]["坐标X"] + i * 2 - 1, WAR.Person[WAR.CurID]["坐标Y"] - j * 2 + 1, 4, 1)
			    SetWarMap(WAR.Person[WAR.CurID]["坐标X"] - i * 2 + 1, WAR.Person[WAR.CurID]["坐标Y"] - j * 2 + 1, 4, 1)
		    end
		end
	end	
    if MPPD(pid) == 11 and wugong == 131 then
		if WAR.JQ[pid] ~= nil and WAR.JQ[pid] > 0 then 
		    local a = WAR.JQ[pid]+1
		    ng = ng + 400*a
		    WAR.WS = 1
		    for i = 1, a do
		        for j = 1, a do
			        SetWarMap(x + i - 1, y + j - 1, 4, 1)
			        SetWarMap(x - i + 1, y + j - 1, 4, 1)
			        SetWarMap(x + i - 1, y - j + 1, 4, 1)
			        SetWarMap(x - i + 1, y - j + 1, 4, 1)
		        end
		    end
		end
	end	
    if MPPD(pid) == 9 and (DT(pid, 93) or yongan(wugong)) and WAR.BYLH == 1 and WAR.TMMS[pid] == 2 and WAR.QJBMS[pid] == nil then --唐门模式
		CleanWarMap(4,0)
		WAR.WS = 1
		for i = 1, 10 do
		    for j = 1, 10 do
			    SetWarMap(x + i - 1, y + j - 1, 4, 1)
		        SetWarMap(x - i + 1, y + j - 1, 4, 1)
			    SetWarMap(x + i - 1, y - j + 1, 4, 1)
			    SetWarMap(x - i + 1, y - j + 1, 4, 1)
		    end
		end
	end
	
    if MPPD(pid) == 9 and WAR.QJBMS[pid] == 3 then --唐门模式
        CleanWarMap(4,0)
		WAR.WS = 1
		for i = 1, 8 do
		    for j = 1, 8 do
			    SetWarMap(WAR.Person[WAR.CurID]["坐标X"] + i - 1, WAR.Person[WAR.CurID]["坐标Y"] + j - 1, 4, 1)
			    SetWarMap(WAR.Person[WAR.CurID]["坐标X"] - i + 1, WAR.Person[WAR.CurID]["坐标Y"] + j - 1, 4, 1)
			    SetWarMap(WAR.Person[WAR.CurID]["坐标X"] + i - 1, WAR.Person[WAR.CurID]["坐标Y"] - j + 1, 4, 1)
			    SetWarMap(WAR.Person[WAR.CurID]["坐标X"] - i + 1, WAR.Person[WAR.CurID]["坐标Y"] - j + 1, 4, 1)
		    end
		end
	end	
	
    if wugong == 18 and (DT(pid,57) or wglw1(pid,18)) and JLSD(10,60,pid) then --弹指神通	
		CleanWarMap(4,0)
		WAR.WS = 1
		for i = 1, 5 do
		    for j = 1, 5 do
			    SetWarMap(x + i - 1, y + j - 1, 4, 1)
		        SetWarMap(x - i + 1, y + j - 1, 4, 1)
			    SetWarMap(x + i - 1, y - j + 1, 4, 1)
			    SetWarMap(x - i + 1, y - j + 1, 4, 1)
		    end
		end
	end
	
    if BJY(pid) and yongjian(wugong) and juexing() > 1 and JLSD(10,50,pid) then --莫名悲痛
        --CleanWarMap(4,0)
		local a = JY.Wugong[wugong]["移动范围" .. 10] + 2
		WAR.WS = 1
		for i = 1, a do
		    for j = 1, a do
			    SetWarMap(WAR.Person[WAR.CurID]["坐标X"] + i - 1, WAR.Person[WAR.CurID]["坐标Y"] + j - 1, 4, 1)
			    SetWarMap(WAR.Person[WAR.CurID]["坐标X"] - i + 1, WAR.Person[WAR.CurID]["坐标Y"] + j - 1, 4, 1)
			    SetWarMap(WAR.Person[WAR.CurID]["坐标X"] + i - 1, WAR.Person[WAR.CurID]["坐标Y"] - j + 1, 4, 1)
			    SetWarMap(WAR.Person[WAR.CurID]["坐标X"] - i + 1, WAR.Person[WAR.CurID]["坐标Y"] - j + 1, 4, 1)
		    end
		end
        if WAR.Person[id][CC.TXWZ1] ~= nil then
		    WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+莫名剑法・莫名悲痛"
	    else
		    WAR.Person[id][CC.TXWZ1] = "莫名剑法・莫名悲痛"
	    end
	    WAR.MMBT = 1
		WAR.YANGKANG = 1
	end		
	
    if ((wglw(pid,592) and PersonKF(pid,45)) or DT(pid,592)) and JLSD(10,80,pid) and yongjian(wugong) then --举重若轻
	    local a = math.random(2)
		if a == 1 then 
            --CleanWarMap(4,0)
		    local a = JY.Wugong[wugong]["移动范围" .. 10] + 1
		    if PersonGT(pid,180) then 
		        a = a + 3
		    elseif PersonKF(pid,180) then 
		        a = a + 2
		    end
		    WAR.WS = 1
		        for i = 1, a do
		            for j = 1, a do
			            SetWarMap(WAR.Person[WAR.CurID]["坐标X"] + i - 1, WAR.Person[WAR.CurID]["坐标Y"] + j - 1, 4, 1)
			            SetWarMap(WAR.Person[WAR.CurID]["坐标X"] - i + 1, WAR.Person[WAR.CurID]["坐标Y"] + j - 1, 4, 1)
			            SetWarMap(WAR.Person[WAR.CurID]["坐标X"] + i - 1, WAR.Person[WAR.CurID]["坐标Y"] - j + 1, 4, 1)
			            SetWarMap(WAR.Person[WAR.CurID]["坐标X"] - i + 1, WAR.Person[WAR.CurID]["坐标Y"] - j + 1, 4, 1)
		            end
		        end
                if WAR.Person[id][CC.TXWZ3] ~= nil then
		            WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+举重若轻"
	            else
		            WAR.Person[id][CC.TXWZ3] = "举重若轻"
	            end
		else 
            if WAR.Person[id][CC.TXWZ3] ~= nil then
		        WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+举轻若重"
	        else
		        WAR.Person[id][CC.TXWZ3] = "举轻若重"
	        end
		    WAR.JQRZ = 2
		end
	    --WAR.JZRQ = 1
	end	
	
	if ((wglw(pid,592) and wugong == 45) or DT(pid,592)) and JLSD(10,60,pid) and yongjian(wugong) then --举重若轻
	    ng = ng + 1500
        if WAR.Person[id][CC.TXWZ1] ~= nil then
		    WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+重剑无锋 大巧不工"
	    else
		    WAR.Person[id][CC.TXWZ1] = "重剑无锋 大巧不工"
	    end
	    WAR.ZJWF = 1 --举重若轻
	end
	
    if wglw(pid,592)or DT(pid,592) then
		WAR.WS = 1
		ng = ng + 2000
		if WAR.Person[id][CC.TXWZ2] ~= nil then
		    WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].."+独孤剑境 攻敌勿守"
	    else
		    WAR.Person[id][CC.TXWZ2] = "独孤剑意 攻敌勿守"
	    end
	    WAR.DGJY1 = 1 --独孤剑意
	end		
	
    if wugong == 47 and (DT(pid, 592) or wglw1(pid, 47)) and JY.Person[pid]["武功" .. wugongnum] == 47 
        and JY.Person[pid]["武功等级" .. wugongnum] >= 999 then
		local aa = math.random(1,9)
	    aa = math.random(1,9)
	    if aa > 9 then
	        aa = 9
	    elseif aa < 1 then
	        aa = 1
	    end
	    local str = aa.."级".."剑气"
	    ng = ng + (WAR.SPIRIT[pid]+300) * aa
	    DHdisplay(484, 492, "独孤剑气")
	    DHdisplay(10, 19, str)
	    if WAR.Person[id][CC.TXWZ1] == nil then
			WAR.Person[id][CC.TXWZ1] = "九剑・总决式".."・"..str
	    else
			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+".."九剑・总决式".."・"..str
		end
		WAR.YANGKANG = 1
		WAR.BFX = 1
	    WAR.BLX = 1
	    WAR.BBF = 1
	    WAR.BZS = 1
		WAR.DGJJ_ZJS = 1
	end
	
    if wugong == 47 and (DT(pid, 592) or wglw1(pid, 47)) and JY.Person[pid]["武功" .. wugongnum] == 47 
        and JY.Person[pid]["武功等级" .. wugongnum] >= 999 and JLSD(10, 30, pid) then	
		if WAR.Person[id][CC.TXWZ2] == nil then
			WAR.Person[id][CC.TXWZ2] = "九剑・破剑式"
		else
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].."+九剑・破剑式"
		end
		WAR.PJS = 1

    end	
	
	if wugong == 47 and (DT(pid, 592) or wglw1(pid, 47)) and JY.Person[pid]["武功" .. wugongnum] == 47 
        and JY.Person[pid]["武功等级" .. wugongnum] >= 999 and JLSD(10, 30, pid) then
		if WAR.Person[id][CC.TXWZ2] == nil then
			WAR.Person[id][CC.TXWZ2] = "九剑・破刀式"
		else
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].."+九剑・破刀式"
		end
        for j = 0, WAR.PersonNum - 1 do
	        if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then				
			    local tmppid = WAR.Person[j]["人物编号"]
			    WAR.ICE[tmppid]=WAR.ICE[tmppid] or 0 + 30
				WAR.ICEXS[tmppid] = 1
			    local bb=WAR.ICE[tmppid]*15
			    WAR.Person[j]["体力点数"] = (WAR.Person[j]["体力点数"] or 0) + AddPersonAttrib(tmppid, "体力", -25)
				WAR.XNXS[tmppid] = 1
	        end
	    end	
	end	
	
    if wugong == 47 and (DT(pid, 592) or wglw1(pid, 47)) and JY.Person[pid]["武功" .. wugongnum] == 47 
        and JY.Person[pid]["武功等级" .. wugongnum] >= 999 and JLSD(20, 40, pid) then
	    if WAR.Person[id][CC.TXWZ2] == nil then
			WAR.Person[id][CC.TXWZ2] = "九剑・破枪式"
		else
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].."+九剑・破枪式"
		end		
		for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				WAR.Person[j].Time = WAR.Person[j].Time - 300
			    if WAR.Person[j].Time < -500 then WAR.Person[j].Time = - 500 
		        end
			end
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
				WAR.Person[j].Time = WAR.Person[j].Time + 300
			    if WAR.Person[j].Time > 999 then WAR.Person[j].Time = 999
			    end	
			end
		end
	end
	
	if wugong == 47 and (DT(pid, 592) or wglw1(pid, 47)) and JY.Person[pid]["武功" .. wugongnum] == 47 
        and JY.Person[pid]["武功等级" .. wugongnum] >= 999 and JLSD(20, 40, pid) then --
	    if WAR.Person[id][CC.TXWZ2] == nil then
			WAR.Person[id][CC.TXWZ2] = "九剑・破鞭式"
		else
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].."+九剑・破鞭式"
		end	
	    for j = 0, WAR.PersonNum - 1 do
		    if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
		        local p = WAR.Person[j]["人物编号"]
			    WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(p,"生命",-150)
				WAR.XNXS[p] = 1
		    end
	    end
		for j = 0, WAR.PersonNum-1 do 
			local df = WAR.Person[j]["人物编号"] 
			local offset1 = math.abs(WAR.Person[j]["坐标X"] - WAR.Person[WAR.CurID]["坐标X"]) 
            local offset2 = math.abs(WAR.Person[j]["坐标Y"] - WAR.Person[WAR.CurID]["坐标Y"])	
			if WAR.Person[j]["死亡"] == false and offset1 <= 8 and offset2 <= 8 and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
               WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(df, "生命", -math.modf((JY.Person[pid]["内力"] + JY.Person[df]["内力"]) / 10))
				WAR.XNXS[df] = 1
			end
        end
	end
	
	if wugong == 47 and (DT(pid, 592) or wglw1(pid, 47)) and JY.Person[pid]["武功" .. wugongnum] == 47 
        and JY.Person[pid]["武功等级" .. wugongnum] >= 999 and JLSD(10, 30, pid) then
		if WAR.Person[id][CC.TXWZ2] == nil then
			WAR.Person[id][CC.TXWZ2] = "九剑・破索式"
		else
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].."+九剑・破索式"
		end
		for j = 0, WAR.PersonNum - 1 do
	        if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then				
		        local tmppid = WAR.Person[j]["人物编号"]
		        WAR.L_NOT_MOVE[tmppid]=WAR.L_NOT_MOVE[tmppid] or 0 + 1
		    end
	    end	
	end
	
    if wugong == 47 and (DT(pid, 592) or wglw1(pid, 47)) and JY.Person[pid]["武功" .. wugongnum] == 47 
        and JY.Person[pid]["武功等级" .. wugongnum] >= 999 and JLSD(10, 30, pid) then
		if WAR.Person[id][CC.TXWZ2] == nil then
			WAR.Person[id][CC.TXWZ2] = "九剑・破掌式"
		else
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].."+九剑・破掌式"
		end
        WAR.PJS2 = 1
    end				
	
    if wugong == 47 and (DT(pid, 592) or wglw1(pid, 47)) and JY.Person[pid]["武功" .. wugongnum] == 47 
        and JY.Person[pid]["武功等级" .. wugongnum] >= 999 and JLSD(10, 30, pid) then
		if WAR.Person[id][CC.TXWZ2] == nil then
			WAR.Person[id][CC.TXWZ2] = "九剑・破箭式"
		else
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].."+九剑・破箭式"
		end
		for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - 300
				local tmppid = WAR.Person[j]["人物编号"]
				 WAR.Person[j]["内伤点数"] = (WAR.Person[j]["内伤点数"] or 0) + AddPersonAttrib(tmppid, "受伤程度", math.random(10, 50))
			end
		end
	    WAR.KHBX = 2
    end		
	
	if wugong == 47 and (DT(pid, 592) or wglw1(pid, 47)) and JY.Person[pid]["武功" .. wugongnum] == 47 
        and JY.Person[pid]["武功等级" .. wugongnum] >= 999 and JLSD(10, 30, pid) then
		if WAR.Person[id][CC.TXWZ2] == nil then
			WAR.Person[id][CC.TXWZ2] = "九剑・破气式"
		else
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].."+九剑・破气式"
		end
        for j = 0, WAR.PersonNum - 1 do			      	  
		    local tmppid = WAR.Person[j]["人物编号"]
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				JY.Person[tmppid]["内力"] = 1
			end					
		end 	
	end

   --[[ if wugong == 16 and (((DT(pid, 5) or wglw1(pid, 16)) and JLSD(10, 55, pid)) or WAR.TQFJ == -1 ) and WAR.ACT==1 then
		DHdisplay(2920, 2936, "太极拳法・运转如流",M_MediumTurquoise)
        for j = 0, WAR.PersonNum - 1 do
	        if WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[j]["死亡"] == false then
	            local aa = math.abs(WAR.Person[j]["坐标X"] - WAR.Person[WAR.CurID]["坐标X"]) + math.abs(WAR.Person[j]["坐标Y"] - WAR.Person[WAR.CurID]["坐标Y"])
	            local killjq = 0
	            if  aa < 99 and aa > 1 then
			        local x, y = WE_xy(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"]-1)
			        lib.SetWarMap(WAR.Person[j]["坐标X"], WAR.Person[j]["坐标Y"], 5, -1)
			        lib.SetWarMap(WAR.Person[j]["坐标X"], WAR.Person[j]["坐标Y"], 2, -1)
			        WAR.Person[j]["坐标X"], WAR.Person[j]["坐标Y"] = x, y
			        lib.SetWarMap(WAR.Person[j]["坐标X"], WAR.Person[j]["坐标Y"], 5, WAR.Person[j]["贴图"])
			        lib.SetWarMap(WAR.Person[j]["坐标X"], WAR.Person[j]["坐标Y"], 2, j)
			        killjq = (99-aa) * 2
	            elseif aa <= 1 then
	                killjq = 200
	            end
	            WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - killjq
	        end
	    end
	end]] 	 
	
    if (wglw(pid,178) or (DT(pid,50) and PersonKF(pid,178)))and PersonGT(pid,178) and JLSD(10, 55, pid) and WAR.ACT==1 then
		DHdisplay(3255, 3277, "擒龙秘技・擒龙手",M_Purple)
        for j = 0, WAR.PersonNum - 1 do
	        if WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[j]["死亡"] == false then
	            local aa = math.abs(WAR.Person[j]["坐标X"] - WAR.Person[WAR.CurID]["坐标X"]) + math.abs(WAR.Person[j]["坐标Y"] - WAR.Person[WAR.CurID]["坐标Y"])
	            local fxds = 0
	            local tmppid = WAR.Person[j]["人物编号"]
	            if aa < 7 and aa> 1 then
			        local x, y = WE_xy(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"]-1)
			        lib.SetWarMap(WAR.Person[j]["坐标X"], WAR.Person[j]["坐标Y"], 5, -1)
			        lib.SetWarMap(WAR.Person[j]["坐标X"], WAR.Person[j]["坐标Y"], 2, -1)
			        WAR.Person[j]["坐标X"], WAR.Person[j]["坐标Y"] = x, y
			        lib.SetWarMap(WAR.Person[j]["坐标X"], WAR.Person[j]["坐标Y"], 5, WAR.Person[j]["贴图"])
			        lib.SetWarMap(WAR.Person[j]["坐标X"], WAR.Person[j]["坐标Y"], 2, j)
			        fxds = (7-aa) * 5
	            elseif aa <= 1 then
	                fxds = 35
	            end
	            WAR.FXXS[tmppid] = 1
				WAR.FXDS[tmppid] = WAR.FXDS[tmppid] or 0 + fxds
	   	        if WAR.FXDS[tmppid]>=50 then
	                WAR.FXDS[tmppid] = 50
	            end
				WAR.XNXS[tmppid] = 1
	        end
	    end
	end 	
	
	if (DT(pid,103) or DT(pid,595)) and JLSD(10, 55, pid) and WAR.ACT==1 then
		DHdisplay(3312, 3281, "凌空取物・控鹤挪移",M_DeepSkyBlue)
	    for j = 0, WAR.PersonNum - 1 do
	        if WAR.Person[j]["我方"]~=WAR.Person[WAR.CurID]["我方"] and WAR.Person[j]["死亡"] == false then
	            if math.abs(WAR.Person[j]["坐标X"] - WAR.Person[WAR.CurID]["坐标X"]) + math.abs(WAR.Person[j]["坐标Y"] - WAR.Person[WAR.CurID]["坐标Y"]) < 6 then
			        local x, y = WE_xy(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"]-1)
			        lib.SetWarMap(WAR.Person[j]["坐标X"], WAR.Person[j]["坐标Y"], 5, -1)
			        lib.SetWarMap(WAR.Person[j]["坐标X"], WAR.Person[j]["坐标Y"], 2, -1)
			        WAR.Person[j]["坐标X"], WAR.Person[j]["坐标Y"] = x, y
			        lib.SetWarMap(WAR.Person[j]["坐标X"], WAR.Person[j]["坐标Y"], 5, WAR.Person[j]["贴图"])
			        lib.SetWarMap(WAR.Person[j]["坐标X"], WAR.Person[j]["坐标Y"], 2, j)
	            end
	        end
	    end
	end 	

    if ((MPPD(pid) == 17 and MPDJ(pid) >= 3) and JLSD(10,50,pid) and PersonGT(pid,153)) or ((GX(pid) and JX(pid)) and JLSD(10,60,pid)) then --峨眉使者限定
	    CleanWarMap(4, 0)
        for i = 0, WAR.PersonNum - 1 do
            if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
                SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
            end
        end		
		if WAR.Person[id][CC.TXWZ2] ~= nil then
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .."+玉女丹青・文姬挥笔"
		else
			WAR.Person[id][CC.TXWZ2] = "玉女丹青・文姬挥笔"
		end
		ng = ng + 1250
		WAR.WS = 1
	end	

	if wugong == 140 and (wglw1(pid,140) or DT(pid,558)) and WAR.LQZ[pid] == 100 then --阴风刀暴怒
	    if fightnum >2 then
			fightnum = 2
		end
		CleanWarMap(4, 0)
        for i = 0, WAR.PersonNum - 1 do
            if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
                SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
            end
        end		
		ng = ng + 2000
		WAR.WS = 1
		if WAR.Person[id][CC.TXWZ1] ~= nil then
			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .."+万解・白霞罚"
		else
			WAR.Person[id][CC.TXWZ1] = "万解・白霞罚"
		end
	end

	
	if WAR.TDSX == 2 then --持瑶琴地响
	    if fightnum > 3 then
			fightnum = 3
		end
		CleanWarMap(4, 0)
        for i = 0, WAR.PersonNum - 1 do
            if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
                SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
            end
        end		
		ng = ng + 2000
		WAR.WS = 1
	end
	
	if DT(pid,161) and JX(pid) and WAR.SPIRIT[pid] >= 120 and wugong == 170 and WAR.Actup[pid] ~= nil then
		CleanWarMap(4, 0) --
        for i = 0, WAR.PersonNum - 1 do
            if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
                SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
            end
        end		
		ng = ng + 2500
		WAR.WS = 1
		DHdisplay(3384, 3407, "杀尽天下负心人")
		WAR.BPL5 = 1
	elseif WAR.Actup[pid] ~= nil and WAR.SPIRIT[pid] >= 140 and wugong == 170 and (wglw1(pid,170) or DT(pid,161))then --冰魄银针领悟大招
		CleanWarMap(4, 0) --
        for i = 0, WAR.PersonNum - 1 do
            if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
                SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
            end
        end		
		ng = ng + 2000
		WAR.WS = 1
		DHdisplay(3384, 3407, "杀尽负心人")
		WAR.BPLW5 = 1
	end
	--[[豸苗：谢云流 豪气剑空
	local aa = math.random(10)
    if XYL(pid) and yongjian(wugong) then
	    if aa <= 3 then 
        if WAR.Person[id][CC.TXWZ2] ~= nil then
	       WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].."+豪气剑空"
	       else
	       WAR.Person[id][CC.TXWZ2] = "豪气剑空"
        end
	    WAR.L_HQJK = 1
	    elseif aa >= 4 then 
	    if WAR.Person[id][CC.TXWZ3] ~= nil then
	       WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+叠刃"
	    else
	       WAR.Person[id][CC.TXWZ3] = "叠刃"
        end
	    WAR.L_DR = 1
	    end
    end	 ]]
	
     --豸苗：谢云流 天人五衰
	if XYL(pid) and WAR.XYLCZ1 == 3 then
	    local a = math.random(4)
	    if a == 1 then
	        WAR.XYL = 1
	    elseif a == 2 then
	        WAR.XYL = 2
	    elseif a == 3 then
	        WAR.XYL = 3
	else
	    WAR.XYL = 4
	    end
	end

	--豸苗：谢云流极意
    if XYL(pid) and yongjian(wugong) and juexing() > 2 then
	if ZYJ(pid) then
          CleanWarMap(4, 0)
        for i = 0, WAR.PersonNum - 1 do
        if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
          SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
        end
        end
          ng = ng + 1500
          WAR.WS = 1
          Cls()
          ShowScreen()
          lib.Delay(40)
        for i = 12, 24 do
          NewDrawString(-1, -1, "半身大悟 斩流・天道剑封破" , C_GOLD, 25 + i)
          ShowScreen()
        if i == 24 then
          Cls()
          NewDrawString(-1, -1, "半身大悟 斩流・天道剑封破" , C_GOLD, 25 + i)
          ShowScreen()
          lib.Delay(500)
        else
          lib.Delay(1)
        end
        end
		WAR.L_JHGC = 1
	elseif JLSD(10,60,pid) then 
		ng = ng + 1500
        WAR.WS = 1
	    Cls()
        ShowScreen()
        lib.Delay(40)
        for i = 12, 24 do
        NewDrawString(-1, -1, "斩流・天道剑封破" , C_GOLD, 25 + i)
        ShowScreen()
        if i == 24 then
          Cls()
          NewDrawString(-1, -1, "斩流・天道剑封破" , C_GOLD, 25 + i)
          ShowScreen()
          lib.Delay(500)
        else
          lib.Delay(1)
        end
        end
		WAR.L_JHGC = 1
	end
    end
	--豸苗：谢云流
	if XYL(pid) then
		local s = math.random(4)
		if WAR.L_JHGC == 1 then
		WAR.Person[id][CC.TXWZ1] = "斩流・天道剑封破"
		elseif s == 1 then 
	    WAR.Person[id][CC.TXWZ1] = "只身单剑 快意恩仇纵江湖"
		elseif s == 2 then 
		WAR.Person[id][CC.TXWZ1] = "华山清观 一剑激起千层雪"
		elseif s == 3 then 
		WAR.Person[id][CC.TXWZ1] = "我之功过 谁能评说"
		else 
		WAR.Person[id][CC.TXWZ1] = "试问苍穹 可曾阴阳判鸿蒙"
		end
	end
	
	if MPPD(pid) == 6 and MZ(pid)==3 and MPDJ(pid) > 1 and JLSD(30, 80, pid) then
    if WAR.Person[id][CC.TXWZ1] ~= nil then
		WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+龙象伏魔"
	else
		WAR.Person[id][CC.TXWZ1] = "大力龙象・神威伏魔"
	end
	WAR.LXFM = 1
    end
	
    --霍都攻击，中毒+15，伤害+70
    if DT(pid, 84) and JLSD(10, 70, pid) then
        WAR.HDWZ = 1
	    if WAR.Person[id][CC.TXWZ1] == nil then
		    WAR.Person[id][CC.TXWZ1] = CC.WARS63  --暗箭・扇中钉
	    else
		    WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .. CC.WARS63 
	    end
            WAR.Person[id][CC.TXDH] = 89
    end
 
	if DT(pid, 632) then
		local jl = 20
		jl = jl + limitX((WAR.SPIRIT[pid] - 100), 0, 40)
		if JLSD(10, 10 + jl, pid) then
			WAR.DD = 1
			if WAR.Person[id][CC.TXWZ1] == nil then
				WAR.Person[id][CC.TXWZ1] = CC.WARS43
			else
				WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+" .. CC.WARS43
			end
			WAR.Person[id][CC.TXDH] = 89			
		end	
	end
 
    if DT(pid, 627) and JLSD(10, 70, pid) then --公孙绿萼枣核钉
        WAR.GSLE = 1
	    if WAR.Person[id][CC.TXWZ1] == nil then
		    WAR.Person[id][CC.TXWZ1] = "枣核钉"
	    else
		    WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+枣核钉"
	    end
            WAR.Person[id][CC.TXDH] = 89
    end
 
    if MPPD(pid) == 12 then --日月神教黑血神针
	    local str = "黑血神针"
	    local mpdj = MPDJ(pid)
	    if JLSD(10, 30+mpdj*10, pid) then
            WAR.HXSZ = 1
	        if DT(pid,27) then 
	            str = "葵花神针"
	        end
	        if WAR.Person[id][CC.TXWZ1] == nil then
		        WAR.Person[id][CC.TXWZ1] = str
	        else
		        WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .."+"..str
	        end
	    end
    end
	
	if DT(pid,152) and JX(pid)  and WAR.XQSLJ == 1  then --萧秋水连击数显示
		Cls()
        NewDrawString(-1, -1, "追魂夺命・"..tostring(fightnum).."连剑", C_GOLD, 50)
        ShowScreen()
        lib.Delay(700)
		WAR.XQSLJ = 2
	end
	
	if T6XQS(pid) and WAR.XQSLJ == 1 and juexing() > 2 then --萧秋水连击数显示
		Cls()
        NewDrawString(-1, -1, "惊天一剑・"..tostring(fightnum).."连击", C_GOLD, 50)
        ShowScreen()
        lib.Delay(700)
		WAR.XQSLJ = 2
	end
	
	if T8LXY(pid) and WAR.LXYLJTS == 1 then --李逍遥连击
		for i=12,24 do
			NewDrawString(-1,-1,"醉仙望月步",C_GOLD,25+i)
			ShowScreen();
			if i==24 then
				Cls();							
				NewDrawString(-1,-1,"醉仙望月步",C_GOLD,25+i)
				ShowScreen();
				lib.Delay(500);
			else
				lib.Delay(1);
			end						
		end
		WAR.LXYLJTS = 0	
	end
	
	if  ((PersonGT(pid, 108) and MPPD(pid) == 5 and MPDJ(pid) > 1) or DT(pid,615) or DT(pid,114))  and  WAR.DZWD == 1 then --大智无定指
		Cls()
        NewDrawString(-1, -1, "大智无定指・"..tostring(fightnum).."连击", C_GOLD, 50)
        ShowScreen()
        lib.Delay(700)
		WAR.DZWD = 0
	end
	
	if T8LXY(pid) and WAR.LXYJSTS == 1 then --沼跃鱼：李逍遥酒神咒（取代原先的剑神）
		for i=12,24 do
			NewDrawString(-1,-1,"酒神咒",C_GOLD,35+i)
			ShowScreen();
			if i==24 then
				Cls();							
				NewDrawString(-1,-1,"酒神咒",C_GOLD,35+i)
				ShowScreen();
				lib.Delay(500);
			else
				lib.Delay(1);
			end						
		end
		--WAR.LXYJSTS = 0	
	end	
	
	if DT(pid,69) and JX(pid) and WAR.HQGSTS == 1 then --沼跃鱼：李逍遥酒神咒（取代原先的剑神）
		zssdz(pid)
        for i = 12, 30 do
            NewDrawString(-1, -1, "龙纹至尊.丐世打狗", C_GOLD, 25 + i)
            ShowScreen()
            if i == 30 then
                Cls()
		        local a = JY.Person[pid]["半身像"]*2
                lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
                lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
                NewDrawString(-1, -1, "龙纹至尊.丐世打狗", C_GOLD, 25 + i)
                ShowScreen()
                lib.Delay(500)
            else
                lib.Delay(1)
            end
        end
			--WAR.LXYJSTS = 0	
	end	
	
	if DT(pid,69) and JX(pid) and WAR.HQGSTS2 == 1 then --沼跃鱼：李逍遥酒神咒（取代原先的剑神）
		zssdz(pid)
        for i = 12, 30 do
            NewDrawString(-1, -1, "贪狼降世.苍龙天舞", C_GOLD, 25 + i)
            ShowScreen()
            if i == 30 then
                Cls()
		        local a = JY.Person[pid]["半身像"]*2
                lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
                lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
                NewDrawString(-1, -1, "贪狼降世.苍龙天舞", C_GOLD, 25 + i)
                ShowScreen()
                lib.Delay(500)
            else
                lib.Delay(1)
            end
        end
			--WAR.LXYJSTS = 0	
	end	
	
	if DT(pid,55) and JX(pid) and WAR.HQGSTS3 == 1 then --沼跃鱼：李逍遥酒神咒（取代原先的剑神）
		zssdz(pid)
        for i = 12, 30 do
            NewDrawString(-1, -1, "一马奔腾.射雕引弓", C_GOLD, 25 + i)
            ShowScreen()
            if i == 30 then
                Cls()
		        local a = JY.Person[pid]["半身像"]*2
                lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
                lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
                NewDrawString(-1, -1, "天地都在我心中", C_GOLD, 25 + i)
                ShowScreen()
                lib.Delay(500)
            else
                lib.Delay(1)
            end
        end
			--WAR.LXYJSTS = 0	
	end		
	
    if DT(pid, 517) then
        if JLSD(10,45,pid) or WAR.Actup[pid]~= nil then
	        DIYdisplay("备前长船")
	        if fightnum<3 then
	            fightnum=3
	        end
	        WAR.Person[id][CC.TXWZ3] = "严流奥义.备前长船"  --二天一流秘奥义・万物一空
            WAR.Person[id][CC.TXDH] = 47
	    end
	    if fightnum==3 then
	        CleanWarMap(4, 0)
            for i = 0, WAR.PersonNum - 1 do
                if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
                    SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
                end
            end
	        WAR.WS = 1
	        WAR.GBWZ2 = 1
	        WAR.ASKD1=1
            ng = ng + sixi(pid,2)*5
	    end
    end 
	
	if T9ZY(pid) and WAR.ZYWS > 0 then
		DIYdisplay("神威如龙")
	end	
	
	if T8LXY(pid) and WAR.LXYJS == 1 then
		WAR.WS = 1
	end
	
	if DT(pid,69) and JX(pid) and WAR.HQGS == 1 then
		WAR.WS = 1
	end

	if DT(pid,69) and JX(pid) and WAR.HQGS2 == 1 then
		WAR.WS = 1
	end
	
	if DT(pid,55) and JX(pid) and WAR.HQGS3 == 1 then
		WAR.WS = 1
	end
	
    --水镜四奇，4本书华山觉醒后 50%火凤燎原
    if ((T2SQ(pid) and juexing() > 0) or DT(pid, 662)) and (JLSD(25, 75, 0) or WAR.SQGJ==1) and WAR.SQFJ ~= 1 and WAR.DZXY ~= 1 then
        Cls()
        DHZFXS(CC.WARS64)    --火凤燎原
	    if WAR.SQGJ==1 then
	        WAR.ZYHB=0
	        WAR.ACT=10
	    end
           WAR.Person[id][CC.TXDH] = 65
        WAR.WS = 1
	    ng=ng+1000+WAR.YTFS1*100----沼跃鱼：火凤燎原的修正
        for i = 1, 10 do
            for j = 1, 10 do
                SetWarMap(x + i - 1, y + j - 1, 4, 1)
                SetWarMap(x - i + 1, y + j - 1, 4, 1)
                SetWarMap(x + i - 1, y - j + 1, 4, 1)
                SetWarMap(x - i + 1, y - j + 1, 4, 1)
            end
        end
    end
     
	if wglw1(pid,12) and WAR.LYBF==1 then
	    Cls()
        DHZFXS("景严.落英散华")    
        WAR.Person[id][CC.TXDH] = 146
        WAR.WS = 1
	    ng=ng+1000+WAR.SPIRIT[pid]*10
        for i = 1, 7 do
            for j = 1, 7 do
                SetWarMap(x + i - 1, y + j - 1, 4, 1)
                SetWarMap(x - i + 1, y + j - 1, 4, 1)
                SetWarMap(x + i - 1, y - j + 1, 4, 1)
                SetWarMap(x - i + 1, y - j + 1, 4, 1)
            end
        end
	end

	if WAR.PLDS == 2 then
	    Cls()
        DHZFXS("霹雳刀势・鬼雄奋迅")    
        WAR.Person[id][CC.TXDH] = 137
        WAR.WS = 1
	    ng=ng+1000+sixi(pid,3)*3
        for i = 1, 7 do
            for j = 1, 7 do
                SetWarMap(x + i - 1, y + j - 1, 4, 1)
                SetWarMap(x - i + 1, y + j - 1, 4, 1)
                SetWarMap(x + i - 1, y - j + 1, 4, 1)
                SetWarMap(x - i + 1, y - j + 1, 4, 1)
            end
        end
	end

	if wglw1(pid,63) and WAR.XDDF2 ==2 then
	    Cls()
        DHZFXS("血煞刀法・血溅十步")    
        WAR.Person[id][CC.TXDH] = 133
        WAR.WS = 1
	    ng=ng+1000+WAR.SPIRIT[pid]*10
        for i = 1, 10 do
            for j = 1, 10 do
                SetWarMap(x + i - 1, y + j - 1, 4, 1)
                SetWarMap(x - i + 1, y + j - 1, 4, 1)
                SetWarMap(x + i - 1, y - j + 1, 4, 1)
                SetWarMap(x - i + 1, y - j + 1, 4, 1)
            end
        end
	end
	 
    --真田幸村
    if DT(pid , 553) and 0 < WAR.YZB2 then
        if 2 < WAR.YZB2 then
            WAR.Person[id][CC.TXWZ3] = CC.WARS65   --炎枪素浅鸣・无双乱舞皆传
        elseif 1 < WAR.YZB2 then
            WAR.Person[id][CC.TXWZ3] = CC.WARS66   --炎枪素浅鸣・真无双乱舞
        elseif 0 < WAR.YZB2 then
            WAR.Person[id][CC.TXWZ3] = CC.WARS67   --炎枪素浅鸣・无双乱舞
        end
        WAR.Person[id][CC.TXDH] = 6
        ng = ng + 200 + WAR.YZB2 * 600
        WAR.WS = 1
        for i = 1, 4 + WAR.YZB2 * 2 do
            for j = 1, 4 + WAR.YZB2 * 2 do
                SetWarMap(x + i - 1, y + j - 1, 4, 1)
                SetWarMap(x - i + 1, y + j - 1, 4, 1)
                SetWarMap(x + i - 1, y - j + 1, 4, 1)
                SetWarMap(x - i + 1, y - j + 1, 4, 1)
            end
        end
    end
    
    --宫本武藏，秒杀 - -
    if DT(pid, 516) and WAR.KHCM[pid] ~= 1 then
        WAR.Person[id][CC.TXWZ3] = CC.WARS68  --二天一流秘奥义・万物一空
        WAR.Person[id][CC.TXDH] = 6
        WAR.GBWZ = 1
        WAR.WS = 1
        ng = ng + 1500
    end
    
    if WAR.ZDDH == 130 then
        for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["人物编号"] == 541 and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
                WAR.BSMT = 1
                WAR.WS = 1
                ng = ng + 1500
                WAR.Person[id][CC.TXWZ1] = CC.WARS69  --毗沙门天之加护
                WAR.Person[id][CC.TXDH] = 6
            end
        end
    end
    
    --田伯光特色指令，文字显示
    if DT(pid , 29) then
    	if WAR.L_TBGZL == 1 and JLSD(30, 90, pid) then
    		if WAR.Person[id][CC.TXWZ1] ~= nil then
    			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+淫荡动世人";
    		else
    			WAR.Person[id][CC.TXWZ1] = "淫荡动世人";
    		end
    		ng = ng + 1000;
    	end
    end
    
    if PersonGT(pid, 99) and wugong == 134 then --神门10%刺穴
		if JLSD(10, 25, pid) then
			WAR.SHENMEN = 1
			WAR.Person[id][CC.TXWZ3] = "神门十三剑・刺穴";
			WAR.Person[id][CC.TXDH] = 6					
		end
	end
	
    if (PersonGT(pid, 96) and wugong == 20) or (PersonGT(pid, 97) and wugong == 4) then 
		if JLSD(10, 35, pid) then
			WAR.ZHUA = 1
			WAR.Person[id][CC.TXWZ3] = JY.Wugong[wugong]["名称"].."・缠足";
			WAR.Person[id][CC.TXDH] = 6					
		end
	end	

    if BJY(pid) and yongquan(wugong) and JY.Person[0]["拳掌功夫"] > 250 and JLSD(10,40,pid) then 
        for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then				
			    local tmppid = WAR.Person[j]["人物编号"]
				WAR.L_NOT_MOVE[tmppid]=WAR.L_NOT_MOVE[tmppid] or 0 + 1
			end
		end	
		if WAR.Person[id][CC.TXWZ3] ~= nil then
      	    WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+".."排云掌・重云深锁"
        else
      	    WAR.Person[id][CC.TXWZ3] = "排云掌・重云深锁"
        end	     
	end	

    if wugong == 177 and (DT(pid, 27) or wglw1(pid,177)) and JLSD(10, 40, pid) then --葵花神针缠足
		for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then				
				local tmppid = WAR.Person[j]["人物编号"]
				WAR.L_NOT_MOVE[tmppid]=WAR.L_NOT_MOVE[tmppid] or 0 + 1
			end
		end		   		
        if WAR.Person[id][CC.TXWZ3] ~= nil then
      	    WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3].."+".."葵花神针・光君";
        else
      	    WAR.Person[id][CC.TXWZ3] = "葵花神针・光君"
        end
		WAR.Person[id][CC.TXDH] = 6	
	end	
    
    --葵花神功 主功体10%刺目，辟邪60%刺目
    if PersonGT(pid, 105) then
		if pid == 0 and putong() == 2 then --剑神不自宫刺目30%，自宫刺目60%
			if wugong == 48 then
				local bcm = 0
				if JY.Person[pid]["性别"] == 0 and JLSD(10, 40, pid) then
					bcm = 1
				elseif JY.Person[pid]["性别"] == 2 and JLSD(10, 70, pid) then
					bcm = 1
				elseif GetS(111, 0, 0, 0) == 105 and JY.Person[pid]["性别"] == 1 and JLSD(10, 70, pid) then
				    bcm = 1
				end
				if bcm == 1 then
					WAR.KHBX = 2
					WAR.Person[id][CC.TXWZ3] = "真辟邪剑法・葵花刺目";
					WAR.Person[id][CC.TXDH] = 6				
				end
			elseif JLSD(10, 20, pid) and JY.Person[pid]["性别"] == 2 then
				WAR.KHBX = 2
				if WAR.Person[id][CC.TXWZ3] ~= nil then
					WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "・葵花刺目";
				else
					WAR.Person[id][CC.TXWZ3] = "葵花刺目";
				end
				WAR.Person[id][CC.TXDH] = 6				
			end
		elseif GetS(111, 0, 0, 0) == 105 and pid == 0 then 
		    if wugong == 48 and JLSD(10, 70, pid) then
			   WAR.KHBX = 2
			   WAR.Person[id][CC.TXWZ3] = "真辟邪剑法・葵花刺目";
			   WAR.Person[id][CC.TXDH] = 6
			elseif wugong == 177 and JLSD(10, 60, pid) then
			   WAR.KHBX = 2
			   WAR.Person[id][CC.TXWZ3] = "真葵花神针・葵花刺目";
			   WAR.Person[id][CC.TXDH] = 6
			end   
		elseif wugong == 48 and JLSD(10, 70, pid) then
			WAR.KHBX = 2
			WAR.Person[id][CC.TXWZ3] = "真辟邪剑法・葵花刺目";
			WAR.Person[id][CC.TXDH] = 6
		elseif wugong == 177 and JLSD(10, 60, pid) then
			WAR.KHBX = 2
			WAR.Person[id][CC.TXWZ3] = "真葵花神针・葵花刺目";
			WAR.Person[id][CC.TXDH] = 6		
		elseif JLSD(10, 20, pid) then
			--WAR.KHBX = 1
			WAR.KHBX = 2
			if WAR.Person[id][CC.TXWZ3] ~= nil then
				WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "葵花刺目";
			else
				WAR.Person[id][CC.TXWZ3] = "葵花刺目";
			end
			WAR.Person[id][CC.TXDH] = 6
    	end
    end
    
	if wugong == 177 and (DT(pid, 27) or wglw1(pid,177)) and JLSD(10, 70, pid) then --葵花神针刺目
		WAR.KHBX = 2
		WAR.Person[id][CC.TXWZ2] = "葵花神针・随风";
		WAR.Person[id][CC.TXDH] = 6		
	end			
	
    --盲目状态・攻击无效
    if WAR.KHCM[pid] == 1 or WAR.KHCM[pid] == 2 then
        WAR.Person[id][CC.TXDH] = 89
        WAR.Person[id][CC.TXWZ2] = "状态・盲目攻击"  --状态・攻击无效
    end
	
    if WAR.WYY[pid] ~= nil and not inteam(pid) then --王语嫣点破
        WAR.Person[id][CC.TXDH] = 89
        WAR.Person[id][CC.TXWZ2] = "状态・被点破" 
    end	
	
    if wugong == 177 and (DT(pid, 27) or wglw1(pid,177)) and JLSD(10, 40, pid) then --葵花神针减速
	    for j = 0, WAR.PersonNum - 1 do
		    if WAR.Person[j]["死亡"] == false and 
			    WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
			    WAR.Person[j].Time = WAR.Person[j].Time - 200
		        if WAR.Person[j].Time < -300 then WAR.Person[j].Time = -300 
		        end
	        end
	    end	
		WAR.Person[id][CC.TXDH] = 80
        WAR.Person[id][CC.TXWZ2] = "葵花神针・六合" 
	end		
	
    --蓝烟清：独孤求败攻击，X为10时发动全屏攻击，通过X不断变化被攻击的人数
    if DT(pid , 592) then
    	local num = WAR.L_DGQB_X;
    	local n = 0;
    	local person = {};
    	--清掉之前的范围
  		--CleanWarMap(4, 0)
  		
  		
    for i = 0, WAR.PersonNum - 1 do
        if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
            n = n + 1
			person[n] = i; 
        end
    end
      
    --根据不同的X攻击不同的敌人
    if n <= num or WAR.L_DGQB_X >= 10 then
      	for i=1, n do
      		SetWarMap(WAR.Person[person[i]]["坐标X"], WAR.Person[person[i]]["坐标Y"], 4, 1)
      	end
    else
      	while num > 0 do
      	local t = math.random(n);
      	if person[t] ~= nil then
      		SetWarMap(WAR.Person[person[t]]["坐标X"], WAR.Person[person[t]]["坐标Y"], 4, 1)
      		person[t] = nil;
      		num = num - 1;
      	end
      	end
    end
       
	local str = WAR.L_DGQB_ZS[limitX(WAR.L_DGQB_X,1, 10)]
        WAR.Person[id][CC.TXWZ3] = str;
        Cls()
        ShowScreen()
        if WAR.L_DGQB_X >= 10 then		--独孤求败发动极意后，恢复５００命，２０００内力，内伤和中毒减半
	        WAR.Person[id]["真伤点数"] = (WAR.Person[id]["真伤点数"] or 0) + AddPersonAttrib(pid, "生命", 500);
	        WAR.Person[id]["内力点数"] = (WAR.Person[id]["内力点数"] or 0) + AddPersonAttrib(pid, "内力", 2000);
	        WAR.Person[id]["解毒点数"] = (WAR.Person[id]["解毒点数"] or 0) - AddPersonAttrib(pid, "中毒程度", -50);
		  	WAR.Person[id]["内伤点数"] = (WAR.Person[id]["内伤点数"] or 0) + AddPersonAttrib(pid, "受伤程度", -50);
		    WAR.Person[id][CC.TXDH] = 6
	        for i = 12, 24 do
	            NewDrawString(-1, -1, str, C_GOLD, CC.DefaultFont + i)
	            ShowScreen()
	            if i == 24 then
	                Cls()
	                NewDrawString(-1, -1, str, C_GOLD, CC.DefaultFont + i)
	                ShowScreen()
	                lib.Delay(500)
	            else
	                lib.Delay(1)
	            end
	        end
	    end
  	end
	
    --谢无悠CC.WarWidth, CC.WarHeight
	if WAR.JTQF[pid] == 1 then 
	   CleanWarMap(4, 0)
	--   local a = math.random(0,WAR.Person[WAR.CurID]["坐标X"]*2)
	--   local b = math.random(0,WAR.Person[WAR.CurID]["坐标Y"]*2)
	   local a = math.random(0,CC.WarWidth)
	   local b = math.random(0,CC.WarHeight)
	   WarDrawAtt(a,b, atkfanwei, 3)
	   WAR.WS = 0
   --   CleanWarMap(4, 0)
	--  local a,b = math.random(WAR.Person[WAR.CurID]["坐标X"]), math.random(WAR.Person[WAR.CurID]["坐标Y"])
   --   for i = 0, WAR.PersonNum - 1 do
    --    if WAR.Person[i]["我方"] == WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
     --     SetWarMap(a, b, 4, 1)
     --   end
    --  end
	end
	
	if WAR.YHDF[pid] == 1 then --17-2-10
	   CleanWarMap(4, 0)
	   local a = math.random(0,CC.WarWidth)
	   local b = math.random(0,CC.WarHeight)
	   WarDrawAtt(a,b, atkfanwei, 3)
	   WAR.WS = 0
	end
	
	if DT3(pid , 51) and WAR.HMXC > 0 and WAR.DZXY == 1 then --慕容幻梦星辰全屏攻击
        CleanWarMap(4, 0)
        for i = 0, WAR.PersonNum - 1 do
            if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
                SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
            end
        end	
	    WAR.WS = 1
	    WAR.HMXC = WAR.HMXC - 1
	end
	
	if DT(pid, 113) and WAR.DZXY == 1 then --慕容博几率全屏反击
		local jl = 25
		jl = jl + math.modf(JY.Person[pid]["实战"] / 50)
		if JLSD(10, 10 + jl, pid) then
			CleanWarMap(4, 0)
			for i = 0, WAR.PersonNum - 1 do
				if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
					SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
				end
			end	
			WAR.WS = 1	
			WAR.Person[id][CC.TXDH] = 26
			if WAR.Person[id][CC.TXWZ3] == nil then
				WAR.Person[id][CC.TXWZ3] = "幻梦星辰"
			else
				WAR.Person[id][CC.TXWZ3] = "幻梦星辰・" .. WAR.Person[id][CC.TXWZ3]
			end			
		end
	end
	
	if T7DFWM(pid) and WAR.DZXY == 1 and yongjian(wugong) and juexing()>1 then --东方未明剑系反击特效
		CleanWarMap(4, 0)
		for i = 0, WAR.PersonNum - 1 do
			if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
				SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
			end
		end	
		ng=ng+sixi(pid, 2)*10
		WAR.WS = 1	
	end
	
	if WAR.ZCDZ ==1 and hasDZ(pid,1)  and yongjian(wugong) then ---沼跃鱼：战意组件1
		ng=ng+sixi(pid, 2)*10
    end
	
	if WAR.LYR == 1 then --林月如指令全屏攻击 LYR(pid) and 
		CleanWarMap(4, 0)
		for i = 0, WAR.PersonNum - 1 do
			if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
				SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
			end
		end	
		WAR.WS = 1			
	end
	
	if WAR.WSSZ == 1 and math.random(10)<6 then --万兽山庄
		CleanWarMap(4, 0)
		for i = 0, WAR.PersonNum - 1 do
			if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
				SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
			end
		end	
		WAR.WS = 1			
	end
	
	if WAR.BFTX == 1 then --冰封天下
		CleanWarMap(4, 0)
		for i = 0, WAR.PersonNum - 1 do
			if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
				SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
			end
		end	
		WAR.WS = 1
        for j = 0, WAR.PersonNum - 1 do
            if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
                local tmppid = WAR.Person[j]["人物编号"]
		        WAR.ICEXS[tmppid] = 1
		        WAR.ICE[tmppid] = WAR.ICE[tmppid] or 0 + 50
				WAR.XNXS[tmppid] = 1
            end
        end		
	end

    if T3XYK(pid) and JLSD(10, 40, pid) and juexing() > 2 then 
		for j = 0, WAR.PersonNum - 1 do
		    local tmppid = WAR.Person[j]["人物编号"]
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
			   WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"],"生命", - math.modf(JY.Person[pid]["内力"]/5))
			   --JY.Person[WAR.Person[j]["人物编号"]]["生命"] = JY.Person[WAR.Person[j]["人物编号"]]["生命"] - math.modf(JY.Person[pid]["内力"]/5)
				WAR.ICEXS[tmppid] = 1
				WAR.ICE[tmppid] = WAR.ICE[tmppid] or 0 + 5
				WAR.XNXS[tmppid] = 1
			end
		end	
		WAR.WS = 1
		if WAR.Person[id][CC.TXWZ1] == nil then
			WAR.Person[id][CC.TXWZ1] = "千里冰封 万里雪飘"
		else
			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+千里冰封 万里雪飘"
		end
		    WAR.Person[id][CC.TXDH] = 144		
	end

    if T2SQ(pid) and (JLSD(10, 40, pid) or WAR.LQZ[pid] == 100) and juexing() > 2 then 
		for j = 0, WAR.PersonNum - 1 do
		    local tmppid = WAR.Person[j]["人物编号"]
			if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
			  WAR.Person[j]["真伤点数"] = (WAR.Person[j]["真伤点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"],"生命", - math.modf(JY.Person[pid]["内力"]/5))
			   WAR.HOTXS[tmppid] = 1
				WAR.HOT[tmppid] = WAR.HOT[tmppid] or 0 + 5
				WAR.XNXS[tmppid] = 1
			end
		end	
		WAR.WS = 1
		if WAR.Person[id][CC.TXWZ1] == nil then
			WAR.Person[id][CC.TXWZ1] = "临渊羡鱼 隔岸观火"
		else
			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1].."+临渊羡鱼 隔岸观火"
		end
		    WAR.Person[id][CC.TXDH] = 119		
	end   

     --聂风1觉后40%全屏攻击
	if NF(pid) and math.random(100) <= 40 and juexing() > 0 then 
        CleanWarMap(4, 0)
        for i = 0, WAR.PersonNum - 1 do
            if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
                SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
            end
        end	
	    WAR.WS = 1	
	    WAR.Person[id][CC.TXDH] = 6
		if WAR.Person[id][CC.TXWZ2] ~= nil then
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2] .."+风神怒・怒沉万脉思照冷"
		else
			WAR.Person[id][CC.TXWZ2] = "风神怒・怒沉万脉思照冷"
		end
			ng = ng + 2000
	end

    if BJY(pid) and yongquan(wugong) and JY.Person[0]["拳掌功夫"] > 300 and JLSD(10,40,pid) and juexing() > 0 then --愁云惨淡
		CleanWarMap(4, 0)
		for i = 0, WAR.PersonNum - 1 do
			if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
				SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
			end
		end	
	    WAR.WS = 1
        if WAR.Person[WAR.CurID][CC.TXWZ1] ~= nil then
			WAR.Person[WAR.CurID][CC.TXWZ1] = WAR.Person[WAR.CurID][CC.TXWZ1] .."+排云掌・愁云惨淡"
		else
			WAR.Person[WAR.CurID][CC.TXWZ1] = "排云掌・愁云惨淡"
		end
		    ng = ng + 2000
	end	

	local t, s = hitall(pid)
	if t then
		CleanWarMap(4, 0)
		for i = 0, WAR.PersonNum - 1 do
			if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
				SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
			end
		end	
		WAR.WS = 1	
		WAR.Person[id][CC.TXDH] = 26
		if s ~= "" then
			if WAR.Person[id][CC.TXWZ3] == nil then
				WAR.Person[id][CC.TXWZ3] = s
			else
				WAR.Person[id][CC.TXWZ3] = WAR.Person[id][CC.TXWZ3] .. "+" .. s
			end				
		end
	end
	
	if WAR.WAWY2 == 1 then
		CleanWarMap(4, 0)
		for i = 0, WAR.PersonNum - 1 do
			if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
				SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
			end
		end
	end
            
    local xb = JY.Wugong[wugong]["类型"]
    local pz = math.modf(tianshu()*3)+math.modf((101-JY.Person[pid]["资质"])/5) --增强资质出大招
    
    --主角剑神大招，全屏攻击
    if pid == 0 and putong() == 2 and 150 <= sixi(pid, 2) 
		and yongjian(wugong) and --0 < JY.Person[pid]["武功10"] and 
		JLSD(10, 30 + pz, pid) and juexing() > 0 then
        CleanWarMap(4, 0)
        for i = 0, WAR.PersonNum - 1 do
            if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
                SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
            end
        end
        WAR.Person[id][CC.TXDH] = 6
        if WAR.Person[id][CC.TXWZ3] == nil then
            WAR.Person[id][CC.TXWZ3] = ZJTF[2]
        else
            WAR.Person[id][CC.TXWZ3] = ZJTF[2] .. "・" .. WAR.Person[id][CC.TXWZ3]
        end
        ng = ng + 1500
        WAR.WS = 1
        Cls()
	    zssdz(pid)
        for i = 12, 30 do
            NewDrawString(-1, -1, ZJTF[2] .. TFSSJ[2], C_WHITE, 25 + i)
            ShowScreen()
            if i == 30 then
                Cls()
		        local a = JY.Person[pid]["半身像"]*2
                lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
                lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
                NewDrawString(-1, -1, ZJTF[2] .. TFSSJ[2], C_WHITE, 25 + i)
                ShowScreen()
                lib.Delay(500)
            else
                lib.Delay(1)
            end
        end
	  --[[
      if JY.HEADXZ == 1 then    --大贴图
        lib.PicLoadCache(91, 2, 100, -1, 1)
      else
        lib.PicLoadCache(91, 2, -1, 1, 1)
      end
      ShowScreen()
      lib.Delay(40)
      for i = 12, 24 do
        NewDrawString(-1, -1, ZJTF[2] .. TFSSJ[2], C_GOLD, 25 + i)
        ShowScreen()
        if i == 24 then
          Cls()
          NewDrawString(-1, -1, ZJTF[2] .. TFSSJ[2], C_GOLD, 25 + i)
          ShowScreen()
          lib.Delay(500)
        else
          lib.Delay(1)
        end
      end]]
      WAR.JSYX = 1
    end  
	if (wglw(pid,182) or (DT(pid,5) and PersonGT(pid,182))) and WAR.LQZ[pid] == 100 then
		zssdz(pid)
        for i = 12, 30 do
            NewDrawString(-1, -1, "太极奥义 厚积薄发", C_WHITE, 25 + i)
            ShowScreen()
            if i == 30 then
                Cls()
		        local a = JY.Person[pid]["半身像"]*2
                lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
                lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
                NewDrawString(-1, -1, "太极奥义 厚积薄发", C_WHITE, 25 + i)
                ShowScreen()
                lib.Delay(500)
            else
                lib.Delay(1)
            end
        end
	elseif 	wglw1(pid,16) and wglw(pid,182) and WAR.tmp[3000 + pid] >= 1500 then
		zssdz(pid)
        for i = 12, 30 do
            NewDrawString(-1, -1, "太极奥义 厚积薄发", C_WHITE, 25 + i)
            ShowScreen()
            if i == 30 then
                Cls()
		        local a = JY.Person[pid]["半身像"]*2
                lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
                lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
                NewDrawString(-1, -1, "太极奥义 厚积薄发", C_WHITE, 25 + i)
                ShowScreen()
                lib.Delay(500)
            else
                lib.Delay(1)
            end
        end
    end
	if WAR.LQZ[pid] == 100 and T3XYK(pid) and juexing() > 1 then ----
	    zssdz(pid)
        for i = 12, 30 do
            NewDrawString(-1, -1, "万里龙城 封狼居胥", C_WHITE, 25 + i)
            ShowScreen()
            if i == 30 then
                Cls()
		        local a = JY.Person[pid]["半身像"]*2
                lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
                lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
                NewDrawString(-1, -1, "万里龙城 封狼居胥", C_WHITE, 25 + i)
                ShowScreen()
                lib.Delay(500)
            else
                lib.Delay(1)
            end
        end
    end
    if WAR.LQZ[pid] == 100 and WAR.DZXY ~= 1 and WAR.SQFJ ~= 1 and DT(pid,50) and (pid == 0 or pid ==50) and WAR.ACT==4 then ----
	    zssdz(pid)
        for i = 12, 30 do
            NewDrawString(-1, -1, "盖世神勇・龙牙天冲", C_WHITE, 25 + i)
            ShowScreen()
            if i == 30 then
                Cls()
		        local a = JY.Person[pid]["半身像"]*2
                lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
                lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
                NewDrawString(-1, -1, "盖世神勇・龙牙天冲", C_WHITE, 25 + i)
                ShowScreen()
                lib.Delay(500)
            else
                lib.Delay(1)
            end
        end
    end
    if DT(pid,27) and (pid == 0 or pid == 27) and JLSD(10,40,pid) then--WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 and GetS(86, 2, 12, 5) == 3 and pid == 27 then ----
	    zssdz(pid)
        for i = 12, 30 do
            NewDrawString(-1, -1, "风云再起・天人化生", C_WHITE, 25 + i)
            ShowScreen()
            if i == 30 then
                Cls()
		        local a = JY.Person[pid]["半身像"]*2
                lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
                lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
                NewDrawString(-1, -1, "风云再起・天人化生", C_WHITE, 25 + i)
                ShowScreen()
                lib.Delay(500)
            else
                lib.Delay(1)
           end
        end
	    WAR.TLHS = 1
	end
    if DT(pid,5) and (pid == 0 or pid == 5) and JLSD(10,40,pid) then--WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 and GetS(86, 2, 12, 5) == 3 and pid == 27 then ----
	    zssdz(pid)
        for i = 12, 30 do
            NewDrawString(-1, -1, "太极宗师・太极之势", C_WHITE, 25 + i)
            ShowScreen()
            if i == 30 then
                Cls()
		        local a = JY.Person[pid]["半身像"]*2
                lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
                lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
                NewDrawString(-1, -1, "太极宗师・太极之势", C_WHITE, 25 + i)
                ShowScreen()
                lib.Delay(500)
            else
                lib.Delay(1)
             end
        end
	    WAR.TLHS = 2
	end
    if WAR.SPIRIT[pid] ~= nil and WAR.SPIRIT[pid] >= 130 and WAR.LQZ[pid] ~= nil and WAR.LQZ[pid] >= 100 and MPPD(pid) == 4 and wglw(pid,182) and WAR.BG[pid] ~= nil and WAR.WJ[pid] ~= nil and (WAR.BG[pid] + WAR.WJ[pid]) > 600 then
		WAR.BG[pid] = math.modf((WAR.BG[pid] or 0)*0.1)
		WAR.WJ[pid] = math.modf((WAR.WJ[pid] or 0)*0.1)
		if wugong == 16 and wglw1(pid,16) then
			WAR.DWRY = 1
			fightnum = 3
			zssdz(pid)
			for i = 12, 30 do
				NewDrawString(-1, -1, "太极真意 开太极", C_WHITE, 25 + i)
				ShowScreen()
				if i == 30 then
					Cls()
					local a = JY.Person[pid]["半身像"]*2
					lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
					lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
					NewDrawString(-1, -1, "太极真意 开太极", C_WHITE, 25 + i)
					ShowScreen()
					lib.Delay(500)
				else
					lib.Delay(1)
				end
			end
			for tj = 0, WAR.PersonNum-1 do 
				local tjid = WAR.Person[tj]["人物编号"]
				if WAR.Person[tj]["死亡"] == false and WAR.Person[tj]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
					WAR.Person[tj]["内伤点数"] = (WAR.Person[tj]["内伤点数"] or 0) + AddPersonAttrib(tjid,"受伤程度",100)
					WAR.ZDNS[tjid] = (WAR.ZDNS[tjid] or 0) + 50
					WAR.Person[tj].Time = -400
					if JY.Person[tjid]["内力"] < JY.Person[pid]["内力"] then
						WAR.Person[tj]["真伤点数"] = (WAR.Person[tj]["真伤点数"] or 0) + AddPersonAttrib(tjid,"生命", -math.modf((JY.Person[pid]["内力"]-JY.Person[tjid]["内力"])))
						if JY.Person[tjid]["生命"] < 1 then
							JY.Person[tjid]["生命"] = 1
						end
					end
					WAR.XNXS[tjid] = 1
				end
			end
		elseif wugong == 46 and wglw1(pid,46) then	
			WAR.DWRY = 1
			fightnum = 3
			zssdz(pid)
			for i = 12, 30 do
				NewDrawString(-1, -1, "太极真意 演无极", C_WHITE, 25 + i)
				ShowScreen()
				if i == 30 then
					Cls()
					local a = JY.Person[pid]["半身像"]*2
					lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
					lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
					NewDrawString(-1, -1, "太极真意 演无极", C_WHITE, 25 + i)
					ShowScreen()
					lib.Delay(500)
				else
					lib.Delay(1)
				end
			end
			for tj = 0, WAR.PersonNum-1 do 
				local tjid = WAR.Person[tj]["人物编号"]
				if WAR.Person[tj]["死亡"] == false and WAR.Person[tj]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
					WAR.Person[tj]["内伤点数"] = (WAR.Person[tj]["内伤点数"] or 0) + AddPersonAttrib(tjid,"受伤程度",100)
					WAR.ZDNS[tjid] = (WAR.ZDNS[tjid] or 0) + 50
					WAR.Person[tj].Time = -400
					if JY.Person[tjid]["内力"] < JY.Person[pid]["内力"] then
						WAR.Person[tj]["真伤点数"] = (WAR.Person[tj]["真伤点数"] or 0) + AddPersonAttrib(tjid,"生命", -math.modf((JY.Person[pid]["内力"]-JY.Person[tjid]["内力"])))
						if JY.Person[tjid]["生命"] < 1 then
							JY.Person[tjid]["生命"] = 1
						end
					end
					WAR.XNXS[tjid] = 1
				end
			end
		end
	end	
	
	if WAR.SPIRIT[pid] ~= nil and WAR.SPIRIT[pid] >= 130 and WAR.LQZ[pid] ~= nil and WAR.LQZ[pid] >= 100 and MPPD(pid) == 4 and DT(pid,5) and WAR.BG[pid] ~= nil and WAR.WJ[pid] ~= nil and (WAR.BG[pid] + WAR.WJ[pid]) > 600 then
		if wugong == 16 then
			fightnum = 3
			zssdz(pid)
			for i = 12, 30 do
				NewDrawString(-1, -1, "太极真意 开太极", C_WHITE, 25 + i)
				ShowScreen()
				if i == 30 then
					Cls()
					local a = JY.Person[pid]["半身像"]*2
					lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
					lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
					NewDrawString(-1, -1, "太极真意 开太极", C_WHITE, 25 + i)
					ShowScreen()
					lib.Delay(500)
				else
					lib.Delay(1)
				end
			end
			for tj = 0, WAR.PersonNum-1 do 
				local tjid = WAR.Person[tj]["人物编号"]
				if WAR.Person[tj]["死亡"] == false and WAR.Person[tj]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
					WAR.Person[tj]["内伤点数"] = (WAR.Person[tj]["内伤点数"] or 0) + AddPersonAttrib(tjid,"受伤程度",100)
					WAR.ZDNS[tjid] = (WAR.ZDNS[tjid] or 0) + 50
					WAR.Person[tj].Time = -400
					if JY.Person[tjid]["内力"] < JY.Person[pid]["内力"] then
						WAR.Person[tj]["真伤点数"] = (WAR.Person[tj]["真伤点数"] or 0) + AddPersonAttrib(tjid,"生命", -math.modf((JY.Person[pid]["内力"]-JY.Person[tjid]["内力"])))
						if JY.Person[tjid]["生命"] < 1 then
							JY.Person[tjid]["生命"] = 1
						end
					end
					WAR.XNXS[tjid] = 1
				end
			end
		elseif wugong == 46 then	
			fightnum = 3
			zssdz(pid)
			for i = 12, 30 do
				NewDrawString(-1, -1, "太极真意 演无极", C_WHITE, 25 + i)
				ShowScreen()
				if i == 30 then
					Cls()
					local a = JY.Person[pid]["半身像"]*2
					lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
					lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
					NewDrawString(-1, -1, "太极真意 演无极", C_WHITE, 25 + i)
					ShowScreen()
					lib.Delay(500)
				else
					lib.Delay(1)
				end
			end
			for tj = 0, WAR.PersonNum-1 do 
				local tjid = WAR.Person[tj]["人物编号"]
				if WAR.Person[tj]["死亡"] == false and WAR.Person[tj]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
					WAR.Person[tj]["内伤点数"] = (WAR.Person[tj]["内伤点数"] or 0) + AddPersonAttrib(tjid,"受伤程度",100)
					WAR.ZDNS[tjid] = (WAR.ZDNS[tjid] or 0) + 50
					WAR.Person[tj].Time = -400
					if JY.Person[tjid]["内力"] < JY.Person[pid]["内力"] then
						WAR.Person[tj]["真伤点数"] = (WAR.Person[tj]["真伤点数"] or 0) + AddPersonAttrib(tjid,"生命", -math.modf((JY.Person[pid]["内力"]-JY.Person[tjid]["内力"])))
						if JY.Person[tjid]["生命"] < 1 then
							JY.Person[tjid]["生命"] = 1
						end
					end
					WAR.XNXS[tjid] = 1
				end
			end
		end
		WAR.BG[pid] = math.modf((WAR.BG[pid] or 0)*0.1)
		WAR.WJ[pid] = math.modf((WAR.WJ[pid] or 0)*0.1)
	end
	if DT(pid,114) and (pid == 0 or pid == 114) and JLSD(10,40,pid) then--WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 and GetS(86, 2, 12, 5) == 3 and pid == 27 then ----
	    zssdz(pid)
        for i = 12, 30 do
            NewDrawString(-1, -1, "灵佛神隐・天地独尊", C_WHITE, 25 + i)
            ShowScreen()
            if i == 30 then
                Cls()
		        local a = JY.Person[pid]["半身像"]*2
                lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
                lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
                NewDrawString(-1, -1, "灵佛神隐・天地独尊", C_WHITE, 25 + i)
                ShowScreen()
                lib.Delay(500)
            else
                lib.Delay(1)
            end
        end
        for i = 0, WAR.PersonNum - 1 do
            if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
		        local a = math.modf((WAR.Person[i].Time + 500)/2)
		        WAR.Person[i].TimeAdd = -a
                --WAR.Person[i].Time = WAR.Person[i].Time - WAR.Person[i].TimeAdd 
            end
        end
	    --WAR.TLHS = 1
	end
	
    if DT(pid,583) and WAR.LQZ[pid] == 100 then
		zssdz(pid)
        for i = 12, 30 do
            NewDrawString(-1, -1, "森罗万道 万道莫名", C_WHITE, 25 + i)
            ShowScreen()
            if i == 30 then
                Cls()
		        local a = JY.Person[pid]["半身像"]*2
                lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
                lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
                NewDrawString(-1, -1, "森罗万道 万道莫名", C_WHITE, 25 + i)
                ShowScreen()
                lib.Delay(500)
            else
                lib.Delay(1)
            end
        end	
	end	
	
	--飞影彩蛋：真龙心法概率全屏攻击
	if inteam(pid) and PersonKF(pid, 91) and JY.ZLXF == 1 then
		local qpjl = math.modf(((JY.Person[pid]["生命最大值"] - JY.Person[pid]["生命"]) / JY.Person[pid]["生命最大值"]) * 100)
		if JLSD(10,20+qpjl,pid) then
			CleanWarMap(4, 0)
			for i = 0, WAR.PersonNum - 1 do
				if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
					SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
				end
			end
			WAR.Person[id][CC.TXWZ1] = "【龙威镇天地】"
			ng = ng + 2500
			WAR.WS = 1
		end
	end
	
    --飞影彩蛋：真龙心法概率全屏攻击
	if inteam(pid) and DT(pid,456) and JY.ZLXF == 1 then
		local qpjl = math.modf(((JY.Person[pid]["生命最大值"] - JY.Person[pid]["生命"]) / JY.Person[pid]["生命最大值"]) * 100)
		if JLSD(10,20+qpjl,pid) then
			CleanWarMap(4, 0)
			for i = 0, WAR.PersonNum - 1 do
				if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
					SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
				end
			end
			WAR.Person[id][CC.TXWZ1] = "【龙威镇天地】"
			ng = ng + 2500
			WAR.WS = 1
		end
	end	
	
    --一人一竹 横扫千军  12-29-
    if DT(pid,614) then
	  local dfnum = 0
	  for j = 0, WAR.PersonNum - 1 do
	  if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
	    	dfnum = dfnum + 1
	    end
	  end
	  local jl = dfnum*8
	  if JLSD(0,20+jl,pid) and dfnum > 1 then
      CleanWarMap(4, 0)
      for i = 0, WAR.PersonNum - 1 do
        if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
          SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
		  WAR.QJZB[WAR.Person[i]["人物编号"]] = 100
        end
      end
      WAR.Person[id][CC.TXDH] = 76
      WAR.Person[id][CC.TXWZ1] = "一人一竹 千军止步"
      ng = ng + 2500
      WAR.WS = 1
      end
    end
		 
	--沼跃鱼：李逍遥剑神大招，全屏攻击
    if T8LXY(pid) and ZYJ(pid) and yongjian(wugong) and WAR.LXYYJ==4 then
       CleanWarMap(4, 0)
       for i = 0, WAR.PersonNum - 1 do
         if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
            SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
         end
       end
       WAR.Person[id][CC.TXDH] = 6
       if WAR.Person[id][CC.TXWZ3] == nil then
          WAR.Person[id][CC.TXWZ3] = "剑神御风"
       else
          WAR.Person[id][CC.TXWZ3] = "剑神御风" .. "・" .. WAR.Person[id][CC.TXWZ3]
       end
       WAR.WS = 1
       Cls()
	   zssdz(pid)
       for i = 12, 30 do
        NewDrawString(-1, -1, "蜀山最高奥义" .. "剑神御风", C_WHITE, 25 + i)
        ShowScreen()
        if i == 30 then
          Cls()
		  local a = JY.Person[pid]["半身像"]*2
        lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
        lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
          NewDrawString(-1, -1, "蜀山最高奥义" .. "剑神御风", C_WHITE, 25 + i)
          ShowScreen()
          lib.Delay(500)
        else
          lib.Delay(1)
        end
       end
	  --[[
      lib.PicLoadCache(91, 20, 100, -1, 1)--大贴图
      ShowScreen()
      lib.Delay(500)
      for i = 12, 24 do
        NewDrawString(-1, -1, "蜀山最高奥义" .. "剑神御风", C_GOLD, 25 + i)
        ShowScreen()
        if i == 24 then
          Cls()
          NewDrawString(-1, -1, "蜀山最高奥义"  .. "剑神御风", C_GOLD, 25 + i)
          ShowScreen()
          lib.Delay(500)
        else
          lib.Delay(1)
        end
      end]]
    end   
	  
    --主角拳系大招
    if pid == 0 and putong() == 1 and 150 <= sixi(pid, 1) --0 < JY.Person[pid]["武功10"] and 
		and JLSD(10, 30 + pz, pid) and (yongquan(wugong)) and juexing() > 0 then
      WAR.Person[id][CC.TXDH] = 6
      if WAR.Person[id][CC.TXWZ3] == nil then
        WAR.Person[id][CC.TXWZ3] = ZJTF[1]
      else
        WAR.Person[id][CC.TXWZ3] = ZJTF[1] .. "・" .. WAR.Person[id][CC.TXWZ3]
      end
      ng = ng + 1200
      WAR.WS = 1
      Cls()
	  --[[
      if JY.HEADXZ == 1 then
        lib.PicLoadCache(91, 0, -1, -1, 1)
      else
        lib.PicLoadCache(91, 0, 25, 1, 1)
      end
      ShowScreen()
      lib.Delay(40)
      for i = 12, 24 do
        NewDrawString(-1, -1, ZJTF[1] .. TFSSJ[1], C_GOLD, 25 + i)
        ShowScreen()
        if i == 24 then
          Cls()
          NewDrawString(-1, -1, ZJTF[1] .. TFSSJ[1], C_GOLD, 25 + i)
          ShowScreen()
          lib.Delay(500)
        else
          lib.Delay(1)
        end
      end]]
	  zssdz(pid)
      for i = 12, 30 do
        NewDrawString(-1, -1, ZJTF[1] .. TFSSJ[1], C_WHITE, 25 + i)
        ShowScreen()
        if i == 30 then
          Cls()
		  local a = JY.Person[pid]["半身像"]*2
        lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
        lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
          NewDrawString(-1, -1, ZJTF[1] .. TFSSJ[1], C_WHITE, 25 + i)
          ShowScreen()
          lib.Delay(500)
        else
          lib.Delay(1)
        end
      end
      WAR.LXZQ = 1
    end
    
    --主角特系大招
    if pid == 0 and putong() == 4 and 150 <= sixi(pid, 4) --0 < JY.Person[pid]["武功10"] and 
		and JLSD(15, 35 + pz, pid) and yongte(wugong) and juexing() > 0 then
      WAR.Person[id][CC.TXDH] = 6
      if WAR.Person[id][CC.TXWZ3] == nil then
        WAR.Person[id][CC.TXWZ3] = ZJTF[4]
      else
        WAR.Person[id][CC.TXWZ3] = ZJTF[4] .. "・" .. WAR.Person[id][CC.TXWZ3]
      end
      ng = ng + 1000
      WAR.WS = 1
      Cls()
	  zssdz(pid)
      for i = 12, 30 do
        NewDrawString(-1, -1, ZJTF[4] .. TFSSJ[4], C_WHITE, 25 + i)
        ShowScreen()
        if i == 30 then
          Cls()
		  local a = JY.Person[pid]["半身像"]*2
        lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
        lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
          NewDrawString(-1, -1, ZJTF[4] .. TFSSJ[4], C_WHITE, 25 + i)
          ShowScreen()
          lib.Delay(500)
        else
          lib.Delay(1)
        end
      end
      WAR.GCTJ = 1
    end
    
    --主角刀系大招
    if pid == 0 and putong() == 3 and --0 < JY.Person[pid]["武功10"] and 
		150 <= sixi(pid, 3) and JLSD(10, 35 + pz, pid) 
		and yongdao(wugong) and juexing() > 0 then
      WAR.Person[id][CC.TXDH] = 6
      if WAR.Person[id][CC.TXWZ3] == nil then
        WAR.Person[id][CC.TXWZ3] = ZJTF[3]
      else
        WAR.Person[id][CC.TXWZ3] = ZJTF[3] .. "・" .. WAR.Person[id][CC.TXWZ3]
      end
      ng = ng + 2000
      WAR.WS = 1
      Cls()
	  zssdz(pid)
      for i = 12, 30 do
        NewDrawString(-1, -1, ZJTF[3] .. TFSSJ[3], C_WHITE, 25 + i)
        ShowScreen()
        if i == 30 then
          Cls()
		  local a = JY.Person[pid]["半身像"]*2
        lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
        lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
          NewDrawString(-1, -1, ZJTF[3] .. TFSSJ[3], C_WHITE, 25 + i)
          ShowScreen()
          lib.Delay(500)
        else
          lib.Delay(1)
        end
      end
      WAR.ASKD = 1
	  WAR.YZHYZ[pid] = limitX((WAR.YZHYZ[pid] or 0) + 25, 0, 100)
    end
	
	if DT(pid,1) and JX(pid) and ZYJ(pid) and JY.Person[pid]["武功" .. wugongnum] == 67 then --沼跃鱼：胡斐战意技能
      WAR.Person[id][CC.TXDH] = 6
      if WAR.Person[id][CC.TXWZ3] == nil then
        WAR.Person[id][CC.TXWZ3] = "一刀"
      else
        WAR.Person[id][CC.TXWZ3] = "一刀".. "・" .. WAR.Person[id][CC.TXWZ3]
      end
	  local DQ=sixi(pid,3)
      ng = ng + DQ*5
      WAR.WS = 1
      Cls()
	  zssdz(pid)
      for i = 12, 30 do
        NewDrawString(-1, -1, "胡刀最高奥义" .. "一刀", C_GOLD, 25 + i)
        ShowScreen()
        if i == 30 then
          Cls()
		 local a = JY.Person[pid]["半身像"]*2
        lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
        lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
          NewDrawString(-1, -1, "胡刀最高奥义" .. "一刀", C_GOLD, 25 + i)
          ShowScreen()
          lib.Delay(500)
        else
          lib.Delay(1)
        end
      end
      WAR.HDYD = DQ
    end
    
	if DT(pid, 58) and JX(pid) and (ZYJ(pid) or JLSD(10,30+math.modf(sixi(pid,2)/10),pid)) and JY.Person[pid]["武功" .. wugongnum] == 45 then --沼跃鱼：胡斐战意技能
      CleanWarMap(4, 0)
      for i = 0, WAR.PersonNum - 1 do
        if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
          SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
        end
      end
	  WAR.Person[id][CC.TXDH] = math.random(119,120)
      if WAR.Person[id][CC.TXWZ3] == nil then
        WAR.Person[id][CC.TXWZ3] = "玄铁荡剑式"
      else
        WAR.Person[id][CC.TXWZ3] = "玄铁荡剑式".. "・" .. WAR.Person[id][CC.TXWZ3]
      end
	  local DQ=sixi(pid,2)*5
	  DQ=DQ+math.modf(JY.Person[pid]["内力"]/5)
      ng = ng + DQ
      WAR.WS = 1
      Cls()
      zssdz(pid)
      for i = 12, 30 do
        NewDrawString(-1, -1, "独孤绝学" .. "玄铁荡剑式", C_GOLD, 25 + i)
        ShowScreen()
        if i == 30 then
          Cls()
		 local a = JY.Person[pid]["半身像"]*2
        lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
        lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
          NewDrawString(-1, -1, "独孤绝学" .. "玄铁荡剑式", C_GOLD, 25 + i)
          ShowScreen()
          lib.Delay(500)
        else
          lib.Delay(1)
        end
      end
      WAR.XTDJ= DQ
    end
	
	if DT(pid, 80) and JX(pid) and (ZYJ(pid) or JLSD(10,30+math.modf(sixi(pid,2)/10),pid)) and JY.Person[pid]["武功" .. wugongnum] == 46 then --沼跃鱼：胡斐战意技能
      CleanWarMap(4, 0)
      for i = 0, WAR.PersonNum - 1 do
        if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
          SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
        end
      end
	  WAR.Person[id][CC.TXDH] = 116
      if WAR.Person[id][CC.TXWZ3] == nil then
        WAR.Person[id][CC.TXWZ3] = "火云剑意"
      else
        WAR.Person[id][CC.TXWZ3] = "火云剑意".. "・" .. WAR.Person[id][CC.TXWZ3]
      end
	  local DQ=sixi(pid,2)*(5+WAR.NSTJ)
	  WAR.NSTJ=0
	  DQ=DQ+math.modf(JY.Person[pid]["内力"]/10)
      ng = ng + DQ
      WAR.WS = 1
      Cls()
      zssdz(pid)
      for i = 12, 30 do
        NewDrawString(-1, -1, "火手太极" .. "火云剑意", C_GOLD, 25 + i)
        ShowScreen()
        if i == 30 then
          Cls()
		 local a = JY.Person[pid]["半身像"]*2
        lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
        lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
          NewDrawString(-1, -1, "火手太极" .. "火云剑意", C_GOLD, 25 + i)
          ShowScreen()
          lib.Delay(500)
        else
          lib.Delay(1)
        end
      end
      WAR.NSTJ2= DQ
    end
	
    if pid == 0 and zjtype() == 4 and JX(pid) and (ZYJ(pid) or JLSD(10, 35 + pz, pid)) then
	 WAR.Person[id][CC.TXDH] = 6
	 local str1=JY.Person[578]["姓名"]
	 local str2=JY.Person[579]["姓名"]
      if WAR.Person[id][CC.TXWZ1] == nil then
        WAR.Person[id][CC.TXWZ1] = str2
      else
        WAR.Person[id][CC.TXWZ1] = str2.. "・" .. WAR.Person[id][CC.TXWZ1]
      end
      WAR.WS = 1
      Cls()
	  zssdz(pid)
      for i = 12, 30 do
        NewDrawString(-1, -1,str1.."最高奥义" .. str2, C_GOLD, 25 + i)
        ShowScreen()
        if i == 30 then
          Cls()
		    local a = JY.Person[pid]["半身像"]*2
        lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
        lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
          NewDrawString(-1, -1, str1.."最高奥义" .. str2, C_GOLD, 25 + i)
          ShowScreen()
          lib.Delay(500)
        else
          lib.Delay(1)
        end
      end
	  if hasDZ(pid,1) then ---沼跃鱼：战意组件1
      CleanWarMap(4, 0)
		for i = 0, WAR.PersonNum - 1 do
			if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
				SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)
			end
		end	
     end
	  if hasDZ(pid,8) and WAR.ACT==1 then
	   fightnum = 3
	   end
	   
	 if hasDZ(pid,12) then ---战意组建12-毒爆天心
		local aa=JY.Person[pid]["用毒能力"]
		for j = 0, WAR.PersonNum - 1 do
		  if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
		    local tid = WAR.Person[j]["人物编号"]
		    local bb=JY.Person[tid]["中毒程度"] + 1
			local cc=math.modf(aa*bb/150) + 100
		    JY.Person[WAR.Person[j]["人物编号"]]["生命"] = JY.Person[WAR.Person[j]["人物编号"]]["生命"] - cc
			if JY.Person[tid]["生命"] <= 0 then
				JY.Person[tid]["生命"] = 1
			end
		  end
		end		
	end

    if  hasDZ(pid,13) then ---战意组建13-药师仁心
		local aa=JY.Person[pid]["医疗能力"]
		local cc=math.modf(aa*100/150)
		for j = 0, WAR.PersonNum -1 do
		  if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
			local tid = WAR.Person[j]["人物编号"]
			JY.Person[WAR.Person[j]["人物编号"]]["生命"] = JY.Person[WAR.Person[j]["人物编号"]]["生命"] + cc
		  end
		end		
		 WAR.Person[WAR.CurID]["真伤点数"]=cc
	end
	
	 if  hasDZ(pid,14) then ---战意组建14-伤心小箭
		local aa=JY.Person[pid]["解毒能力"]
		for j = 0, WAR.PersonNum - 1 do
		  if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
		    local bb=JY.Person[WAR.Person[j]["人物编号"]]["受伤程度"] + 1
			local cc=math.modf(aa*bb/150) + 100
			JY.Person[WAR.Person[j]["人物编号"]]["生命"] = JY.Person[WAR.Person[j]["人物编号"]]["生命"] - cc
			if JY.Person[WAR.Person[j]["人物编号"]]["生命"] <= 0 then
				JY.Person[WAR.Person[j]["人物编号"]]["生命"] = 1
			end
		  end
		end		
	end
      WAR.ZCDZ = 1
    end
	
    if wugong==66 and (DT(pid,103) or DT(pid,595)) and WAR.CHD==1 then--沼跃鱼：鸠摩智残火刀终式大招
	  WAR.Person[id][CC.TXDH] = 109
      if WAR.Person[id][CC.TXWZ3] == nil then
        WAR.Person[id][CC.TXWZ3] = "终式.天地灰烬"
      else
        WAR.Person[id][CC.TXWZ3] = "终式.天地灰烬".. "・" .. WAR.Person[id][CC.TXWZ3]
      end
      WAR.WS = 1
      Cls()
	  zssdz(pid)
      for i = 12, 30 do
        NewDrawString(-1, -1, "迦楼罗琉璃残火刀" .. ".终式", C_GOLD, 25 + i)
        ShowScreen()
        if i == 30 then
          Cls()
	    local a = JY.Person[pid]["半身像"]*2
        lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
        lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
          NewDrawString(-1, -1, "迦楼罗琉璃残火刀" .. "终式", C_GOLD, 25 + i)
          ShowScreen()
          lib.Delay(500)
        else
          lib.Delay(1)
        end
      end
	  WAR.CHD=0
      WAR.CHDZS=1
    end
	
	if (yongnei(wugong) or wugong == 21) and DT(pid, 48) and ZYJ(pid) then--沼跃鱼：鸠摩智残火刀终式大招
	  WAR.Person[id][CC.TXDH] = 6
      if WAR.Person[id][CC.TXWZ3] == nil then
        WAR.Person[id][CC.TXWZ3] = "地龙玄冰玉"
      else
        WAR.Person[id][CC.TXWZ3] = "地龙玄冰玉".. "・" .. WAR.Person[id][CC.TXWZ3]
      end
      WAR.WS = 1
      Cls()
	  zssdz(pid)
      for i = 12, 30 do
        NewDrawString(-1, -1, "摩呼罗迦" .. ".霜冻翡翠", C_GOLD, 25 + i)
        ShowScreen()
        if i == 30 then
          Cls()
		  local a = JY.Person[pid]["半身像"]*2
        lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
        lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
          NewDrawString(-1, -1, "摩呼罗迦" .. "霜冻翡翠", C_GOLD, 25 + i)
          ShowScreen()
          lib.Delay(500)
        else
          lib.Delay(1)
        end
      end
      WAR.DLY=1--沼跃鱼：游坦之地龙玉
    end
	
    if wugong == 43 and DT(pid, 51) and ZYJ(pid) then--沼跃鱼：慕容复修罗大招
	  WAR.Person[id][CC.TXDH] = 6
      if WAR.Person[id][CC.TXWZ3] == nil then
        WAR.Person[id][CC.TXWZ3] = "修罗无惨"
      else
        WAR.Person[id][CC.TXWZ3] = "修罗无惨".. "・" .. WAR.Person[id][CC.TXWZ3]
      end
      WAR.WS = 1
      Cls()
	   zssdz(pid)
      for i = 12, 30 do
        NewDrawString(-1, -1, "阿修罗" .. ".无间地狱", C_GOLD, 25 + i)
        ShowScreen()
        if i == 30 then
          Cls()
		  local a = JY.Person[pid]["半身像"]*2
        lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
        lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
          NewDrawString(-1, -1, "阿修罗" .. "无间地狱", C_GOLD, 25 + i)
          ShowScreen()
          lib.Delay(500)
        else
          lib.Delay(1)
        end
      end
      WAR.XLWC=1--沼跃鱼：修罗无惨
    end
	
	if wugong == 14 and DT(pid, 49) and ZYJ(pid) then--沼跃鱼：夜叉终式
	  WAR.Person[id][CC.TXDH] = 6
      if WAR.Person[id][CC.TXWZ3] == nil then
        WAR.Person[id][CC.TXWZ3] = "螺旋生死符"
      else
        WAR.Person[id][CC.TXWZ3] = "螺旋生死符".. "・" .. WAR.Person[id][CC.TXWZ3]
      end
      WAR.WS = 1
      Cls()
	   zssdz(pid)
      for i = 12, 30 do
        NewDrawString(-1, -1, "夜叉终式" .. ".螺旋生死符", C_GOLD, 25 + i)
        ShowScreen()
        if i == 30 then
          Cls()
		   local a = JY.Person[pid]["半身像"]*2
        lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
        lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
          NewDrawString(-1, -1, "夜叉终式" .. "螺旋生死符", C_GOLD, 25 + i)
          ShowScreen()
          lib.Delay(500)
        else
          lib.Delay(1)
        end
      end
      WAR.LXSS=1--沼跃鱼：螺旋生死符
    end	
	
    if wugong == 49 and DT(pid, 53) and ZYJ(pid) then--沼跃鱼：段誉龙脉剑气
	  WAR.Person[id][CC.TXDH] = 6
      if WAR.Person[id][CC.TXWZ2] == nil then
        WAR.Person[id][CC.TXWZ2] = "龙脉剑气"
      else
        WAR.Person[id][CC.TXWZ2] = "龙脉剑气".. "・" .. WAR.Person[id][CC.TXWZ2]
      end
      WAR.WS = 1
      Cls()
	  zssdz(pid)
      for i = 12, 30 do
        NewDrawString(-1, -1, "龙王" .. ".龙剑交泰", C_GOLD, 25 + i)
        ShowScreen()
        if i == 30 then
          Cls()
		   local a = JY.Person[pid]["半身像"]*2
        lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
        lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
          NewDrawString(-1, -1, "龙王" .. "龙剑交泰", C_GOLD, 25 + i)
          ShowScreen()
          lib.Delay(500)
        else
          lib.Delay(1)
        end
      end
      WAR.LMJQ3=1--沼跃鱼：段誉龙脉剑气
    end
	
	if WAR.TDSX == 1 then --持瑶琴战意技and ZYJ(pid)
		  WAR.Person[id][CC.TXDH] = 6
		  if WAR.Person[id][CC.TXWZ2] == nil then
			WAR.Person[id][CC.TXWZ2] = "伏羲神天・大道无弦"
		  else
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].. "+" .. "大道无弦"
		  end
		  WAR.WS = 1
		  Cls()
		  zssdz(pid)
		  for i = 12, 30 do
			NewDrawString(-1, -1, "天响・伏羲神天响", C_GOLD, 25 + i)
			ShowScreen()
			if i == 30 then
			  Cls()
			   local a = JY.Person[pid]["半身像"]*2
			lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
			lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
			  NewDrawString(-1, -1, "天响・伏羲神天响", C_GOLD, 25 + i)
			  ShowScreen()
			  lib.Delay(500)
			else
			  lib.Delay(1)
			end
		  end	
    elseif WAR.TDSX == 2 then
		  WAR.Person[id][CC.TXDH] = 6
		  if WAR.Person[id][CC.TXWZ2] == nil then
			WAR.Person[id][CC.TXWZ2] = "阎王三更・至地十八响"
		  else
			WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].. "・+".."至地十八响"  
		  end
		  WAR.WS = 1
		  Cls()
		  zssdz(pid)
		  for i = 12, 30 do
			NewDrawString(-1, -1, "地响・阎王三更响", C_GOLD, 25 + i)
			ShowScreen()
			if i == 30 then
			  Cls()
			   local a = JY.Person[pid]["半身像"]*2
			lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
			lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
			  NewDrawString(-1, -1, "地响・阎王三更响", C_GOLD, 25 + i)
			  ShowScreen()
			  lib.Delay(500)
			else
			  lib.Delay(1)
			end
		  end
    end
	
    if ((NF(pid) and (JLSD(10,40,pid) or ZYBF(pid))) and yongdao(wugong)) and juexing() > 2 then --雪饮
        WAR.WS = 1
        Cls()
        for i = 12, 24 do
            NewDrawString(-1, -1, "魔念高涨・" .. "冰心驾驭", C_GOLD, 25 + i)
            ShowScreen()
            if i == 24 then
                Cls()
                NewDrawString(-1, -1, "魔念高涨・" .. "冰心驾驭", C_GOLD, 25 + i)
                ShowScreen()
                lib.Delay(500)
            else
                lib.Delay(1)
            end
        end
    end	
	
    if ((BJY(pid) and (JLSD(10,40,pid) or ZYBF(pid))) and yongjian(wugong)) and juexing() > 1 then --三霸剑
        WAR.WS = 1
        Cls()
        for i = 12, 24 do
            NewDrawString(-1, -1, "似云非云・" .. "无极霸剑", C_GOLD, 25 + i)
            ShowScreen()
            if i == 24 then
                Cls()
                NewDrawString(-1, -1, "似云非云・" .. "无极霸剑", C_GOLD, 25 + i)
                ShowScreen()
                lib.Delay(500)
            else
                lib.Delay(1)
            end
        end
    end		
	
    if wugong == 131 and jtyl(pid) and ZYJ(pid) then--谢无悠
	  WAR.Person[id][CC.TXDH] = 158
      WAR.WS = 1
      Cls()
      for i = 12, 24 do
        NewDrawString(-1, -1, "九天一流・" .. "一刀九式", C_GOLD, 25 + i)
        ShowScreen()
        if i == 24 then
          Cls()
          NewDrawString(-1, -1, "九天一流・" .. "一刀九式", C_GOLD, 25 + i)
          ShowScreen()
          lib.Delay(500)
        else
          lib.Delay(1)
        end
      end
    end		
	
	--小人物的愤怒 同时学会罗汉拳 松风 柴刀 杨家枪 并到极
	if (wugong == 1 or wugong == 27 or wugong == 50 or wugong == 68) and PersonKFJ(pid, 1) and PersonKFJ(pid, 27) and PersonKFJ(pid, 50) and PersonKFJ(pid, 68) then
		WAR.YANGKANG = 1
		WAR.BFX = 1
		WAR.BLX = 1
		WAR.BBF = 1
		WAR.BZS = 1
		
		local d = 0
		if GetS(113,0,0,0) == 996 then
			d = 20 --领悟草头百姓增加20%概率
		end
		--奥义・小人物的逆袭 同时学会九阴 九阳 易筋经 玄武 并到极 无门派 外功领悟草头百姓 满怒
		if PersonKF(pid, 106) and PersonKF(pid, 107) and PersonKF(pid, 108) and PersonKF(pid, 181) and MPPD(pid) == 0 and JY.Person[931]["无用13"] == 0 and GetS(113,0,0,0) == 996 and WAR.LQZ[pid] == 100 then
			for i = 1715, 1727 do
				CurIDTXDH(WAR.CurID, i, i, "奥义・小人物的逆袭", C_GOLD);
				lib.Delay(40)
			end
			for j = 0,WAR.PersonNum-1 do 
				if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[j]["我方"] and WAR.Person[j]["死亡"] == false then
					WAR.L_HQNZL[pid]=WAR.L_HQNZL[pid] or 20
					
					local tmpid = WAR.Person[j]["人物编号"]
					WAR.XRWDNX[tmpid] = 10
					
					WAR.SZWH[tmpid]=WAR.SZWH[tmpid] or 10
					WAR.PEACE[tmpid]=WAR.PEACE[tmpid] or 20
					WAR.KHCM[tmpid]=WAR.KHCM[tmpid] or 20
					WAR.ATKDOWN[tmpid]=WAR.ATKDOWN[tmpid] or 20
					WAR.DEFDOWN[tmpid]=WAR.DEFDOWN[tmpid] or 20
					WAR.SPDDOWN[tmpid]=WAR.SPDDOWN[tmpid] or 20
				end 
			end	
		--小人物的逆袭 无门派 外功领悟草头百姓
		elseif MPPD(pid) == 0 and JY.Person[931]["无用13"] == 0 and GetS(113,0,0,0) == 996 and (JLSD(10,30,pid) or WAR.LQZ[pid] == 100) then
			for i = 1715, 1727 do
				CurIDTXDH(WAR.CurID, i, i, "小人物的逆袭", C_GOLD);
				lib.Delay(40)
			end
			for j = 0,WAR.PersonNum-1 do 
				if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[j]["我方"] and WAR.Person[j]["死亡"] == false then
					WAR.L_HQNZL[pid]=WAR.L_HQNZL[pid] or 20
					
					local tmpid = WAR.Person[j]["人物编号"]
					WAR.SZWH[tmpid]=WAR.SZWH[tmpid] or 0 + 5
					WAR.ATKDOWN[tmpid]=WAR.ATKDOWN[tmpid] or 20
					WAR.DEFDOWN[tmpid]=WAR.DEFDOWN[tmpid] or 20
					WAR.SPDDOWN[tmpid]=WAR.SPDDOWN[tmpid] or 20
				end 
			end	
		elseif MPPD(pid) == 0 and JY.Person[931]["无用13"] == 0 and WAR.LQZ[pid] == 100 then
			for i = 1574, 1578 do
				CurIDTXDH(WAR.CurID, i, i, "奥义・小人物的愤怒", C_GOLD);
				lib.Delay(40)
			end
			WAR.XRWDFN = 2
		elseif JLSD(10,25 + d,pid) then
			for i = 1574, 1578 do
				CurIDTXDH(WAR.CurID, i, i, "小人物的愤怒", C_GOLD);
				lib.Delay(40)
			end
			WAR.QFY1[pid] = WAR.QFY1[pid] or 20
			WAR.QFY2[pid] = WAR.QFY2[pid] or 20
			WAR.QFY3[pid] = WAR.QFY3[pid] or 20
			
			WAR.LQZ[pid] = (WAR.LQZ[pid] or 0) + 10
			if WAR.LQZ[pid] >= 99 then
				WAR.LQZ[pid] = 99
			end

			WAR.SPIRIT[pid] = (WAR.SPIRIT[pid] or 0) + 5
			if WAR.SPIRIT[pid] >= WAR.SPIRITMAX[pid] then
				WAR.SPIRIT[pid] = WAR.SPIRITMAX[pid]
			end
			WAR.XRWDFN = 1
		end
    end
	
	if T7DFWM(pid) and WAR.DZXY == 1 and yongdao(wugong) and juexing()>1 then --东方未明刀系反击特效
	    ng = ng +sixi(pid,3)*10
        WAR.WS = 1
	end  
	
	if T7DFWM(pid) and WAR.DZXY == 1 and yongte(wugong) and juexing()>1 then --东方未明特系反击特效
	    ng = ng +sixi(pid,4)*10
        WAR.WS = 1
	end  
	
	if pid == 0 and putong() == 3 and WAR.KUANGDAO > 0 then --刀系狂刀显示
		local duanshu = ""
		local names = 
		{{1,"一" },
		{2, "二"},
		{3,"三" },
		{4, "四"},
		{5, "五"},
		{6, "六"},
		{7, "七"},
		{8, "八"},
		{9, "九"},
		{10, "一十"},
		{11, "一十一"},
		{12,"一十二" },
		{13, "一十三"},
		{14, "一十四"},
		{15, "一十五"},
		{16, "一十六"},
		{17, "一十七"},
		{18, "一十八"},
		{19, "一十九"},
		{20, "二十"},
		{21, "二十一"},
		{22, "二十二"},
		{23, "二十三"},
		{24, "二十四"},		
		}
		for i,v in ipairs(names) do
			if v[1] == WAR.KUANGDAO then
				duanshu = v[2]
				break
			end
		end
		Cls()
        NewDrawString(-1, -1, "狂刀决・"..duanshu, C_GOLD, 50)
        ShowScreen()
        lib.Delay(700)		
	end
	
	if J2YSS(pid) and WAR.DUOMINGJIAN > 0 then --剑系显示
		local duanshu = ""
		local names = 
		{{1,"剑一" },
		{2, "剑二"},
		{3, "剑三"},
		{4, "剑四"},
		{5, "剑五"},
		{6, "剑六"},
		{7, "剑七"},
		{8, "剑八"},
		{9, "剑九"},
		{10, "剑十"},
		{11, "剑十一"},
		{12,"剑十二" },
		{13, "剑十三"},
		{14, "破极.剑十四"},
		{15, "毁灭.剑十五"},		
		}
		for i,v in ipairs(names) do
			if v[1] == WAR.DUOMINGJIAN then
				duanshu = v[2]
				break
			end
		end
		Cls()
        NewDrawString(-1, -1, "夺命十三剑・"..duanshu, C_GOLD, 50)
        ShowScreen()
        lib.Delay(700)		
	end
	
    if pid == 0 and putong() == 5 and WAR.TIANGANG > 0 then --天罡斗气显示
		local duanshu = ""
		local names = 
		{{1,"一" },
		{2, "二"},
		{3,"三" },
		{4, "四"},
		{5, "五"},
		{6, "六"},
		{7, "七"},
		{8, "八"},
		{9, "九"},
		{10, "一十"},
		{11, "一十一"},
		{12,"一十二" },
		{13, "一十三"},
		{14, "一十四"},
		{15, "一十五"},
		{16, "一十六"},
		{17, "一十七"},
		{18, "一十八"},
		{19, "一十九"},
		{20, "二十"},
		{21, "二十一"},
		{22, "二十二"},
		{23, "二十三"},
		{24, "霸气压杀"},		
		}
		for i,v in ipairs(names) do
			if v[1] == WAR.TIANGANG then
				duanshu = v[2]
				break
			end
		end
		Cls()
        NewDrawString(-1, -1, "天罡斗气・"..duanshu, C_GOLD, 50)
        ShowScreen()
        lib.Delay(700)		
	end	

    --主角天罡大招
    if pid == 0 and putong() == 5 and (WAR.JSTG < 150 or WAR.JSTG2 == 0) and WAR.DZXY ~= 1 and JLSD(15, 35 + pz, pid) and juexing() > 0 then
      local tg = wgnumber(pid, 5)
	    if 0 < tg then --JY.Person[pid]["武功10"] then --tg == 10 then --天罡10内功出大招
	      Cls()
	  zssdz(pid)
	  	  WAR.Person[id][CC.TXDH] = math.random(119,120)
      if WAR.Person[id][CC.TXWZ3] == nil then
        WAR.Person[id][CC.TXWZ3] = "斗气.终极真罡"
      else
        WAR.Person[id][CC.TXWZ3] = "斗气.终极真罡".. "・" .. WAR.Person[id][CC.TXWZ3]
      end
      for i = 12, 30 do
        NewDrawString(-1, -1, ZJTF[5] .. TFSSJ[5], C_WHITE, 25 + i)
        ShowScreen()
        if i == 30 then
          Cls()
		  local a = JY.Person[pid]["半身像"]*2
        lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
        lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
          NewDrawString(-1, -1, ZJTF[5] .. TFSSJ[5], C_WHITE, 25 + i)
          ShowScreen()
          lib.Delay(500)
        else
          lib.Delay(1)
        end
      end
	      WAR.JSTG = 150
		  WAR.JSTG2 = 1
		  WAR.TIANGANG=24
	    end
	end
	  
	  --暗系大招
	if pid == 0 and putong() == 13 and sixi(pid, 5) >= 150 --and JY.Person[pid]["武功10"] > 0 
		and JLSD(15, 35 + pz, pid) and yongan(wugong) and juexing() > 0 then
		  Cls()
	  zssdz(pid)
      for i = 12, 30 do
        NewDrawString(-1, -1, ZJTF[13] .. TFSSJ[13], C_WHITE, 25 + i)
        ShowScreen()
        if i == 30 then
          Cls()
		  local a = JY.Person[pid]["半身像"]*2
        lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
        lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
          NewDrawString(-1, -1, ZJTF[13] .. TFSSJ[13], C_WHITE, 25 + i)
          ShowScreen()
          lib.Delay(500)
        else
          lib.Delay(1)
        end
      end	
		  ng = ng + 1000
		WAR.QJSF = 1	
	end
	  
	--蓝烟清：杨过 黯然神伤特效文字
    if fightnum == 3 and wugong == 25 and ((DT(pid, 58) and GetS(86,11,11,5) == 2) or (pid == 0 and putong() == 1)) then
    	--暂时加在这里
  		local ARSSJY = {"黯然极意・六神不安","黯然极意・倒行逆施","黯然极意・行尸走肉"}
  		WAR.Person[id][CC.TXWZ3] = ARSSJY[WAR.ACT];
  	end
	
	if DT(pid,152)  then --萧秋水几率3-5连击，出招式，随机杀气
		if WAR.XQSLJ > 0 and JX(pid) then 
			local ARSSJY = {"夺魄","噬灵","灭魂","追命"}
			if WAR.Person[id][CC.TXWZ2] == nil then
				WAR.Person[id][CC.TXWZ2] = ARSSJY[math.random(4)]	
			else
				WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].."+"..ARSSJY[math.random(4)]	
			end
			ng = ng + math.random(1000, 2000)
		end
	end
    
    if T6XQS(pid) then --萧秋水几率3-5连击，出招式，随机杀气
		if WAR.XQSLJ > 0 and juexing() > 2 then 
			local ARSSJY = {"玉石俱焚","海天一线","闪电惊鸿","老牛破车"}
			if WAR.Person[id][CC.TXWZ2] == nil then
				WAR.Person[id][CC.TXWZ2] = ARSSJY[math.random(4)]	
			else
				WAR.Person[id][CC.TXWZ2] = WAR.Person[id][CC.TXWZ2].."+"..ARSSJY[math.random(4)]	
			end
			ng = ng + math.random(1000, 2000)
		end
	end
	
    --怒气暴发(沼跃鱼：修改萧峰第四掌)
    if (WAR.LQZ[pid] == 100 and WAR.DZXY ~= 1 and WAR.SQFJ ~= 1) or (wugong==83 and wglw1(pid,83))then
		WAR.Person[id][CC.TXDH] = 6
		local str=""
		if DT(pid,50) and WAR.ACT==4 then
			str="・秘手・登峰造极・龙牙天冲"
		end
		if pid == 0 and putong() == 3 and juexing() > 0 then
			DHdisplay(1694, 1705, "狂刀一怒・血杀千里")
		end
		if wglw1(pid,58)  and WAR.XLEB > 0 then	
			DHdisplay(1540, 1551, "雄霸天下・阿鼻三刀")
			local BDQS = {"碎魂", "剖心", "枭首"}
			str="+阿鼻道・"..BDQS[WAR.XLEB]
			WAR.Person[id][CC.TXDH] = 126
			ng = ng + 1000
			WAR.WS = 1
		end	
		if WAR.Person[id][CC.TXWZ1] ~= nil then
			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. CC.WARS72..str
		else
			WAR.Person[id][CC.TXWZ1] = CC.WARS73..str   --会心之一击
		end
		ng = ng + 1500
    end
      
    --蓄力攻击
    if WAR.Actup[pid] ~= nil then
    	local str = CC.WARS74;
    	if PersonKF(pid, 103) then    --学龙象+1000杀集气
        ng = ng + 1000
        if PersonGT(pid, 103) then
			WAR.L_LXXL = 1;			--龙象造成迟缓
			if MPPD(pid) == 6 and MZ(pid) == 3 then
		    local mpdj = MPDJ(pid)
		    ng = ng + mpdj*200
		    end
		end
        str = "+"..JY.Wugong[103]["名称"]..CC.WARS74;
      else
      	ng = ng + 600
      end
		if DT(pid, 39) then --龙岛主蓄力+800
			ng = ng + 800
		end     
      if WAR.Person[id][CC.TXWZ1] ~= nil then
        WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. str  --蓄力攻击
      else
        WAR.Person[id][CC.TXWZ1] = CC.WARS75
      end
    end
    
    --蓝烟清：装备屠龙刀，使用等级为极的刀法提高40%暴击率，暴击的情况下有50%机率大幅度杀集气，并且造成流血。杀集气量与武功威力有关
  	if WAR.L_TLD == 1 then
			ng = ng + JY.Wugong[wugong]["攻击力10"];
			WAR.Person[WAR.CurID][CC.TXWZ3] = JY.Thing[43]["名称"].."・"..CC.WARS29
  	end
  	 
	 --蓝烟清：密宗暴击的情况下大幅度杀集气，并且杀集气量与武功威力有关
	if WAR.L_TLD1 == 1 then
			ng = ng + JY.Wugong[wugong]["攻击力10"];
			WAR.Person[WAR.CurID][CC.TXWZ3] = "密宗苦修".."・".."释迦掷象"
  	end	
	
    --brolycjw: 石中玉攻击的地方，如果有石破天，那么就为无误伤攻击
  	if DT(pid, 591) and WAR.Person[id]["我方"] then --pid == 591 武骧金星：单通判定修正
	    for i = 0, CC.WarWidth - 1 do
	      for j = 0, CC.WarHeight - 1 do
	        local effect = GetWarMap(i, j, 4)
	        if 0 < effect then
	          local emeny = GetWarMap(i, j, 2)
	    			if 0 <= emeny and WAR.Person[emeny]["人物编号"] == 38 then
	    				WAR.WS = 1;
	    				if WAR.Person[id][CC.TXWZ1] ~= nil then
	        			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+相煎何太急"
	      			else
	        			WAR.Person[id][CC.TXWZ1] = "相煎何太急"
	      			end
	    				break;
	    			end
	    		end
	    	end
	    end
	end
	  
	--brolycjw: 石破天攻击的地方，如果有石中玉，那么就为无误伤攻击
  	if DT(pid, 38) and WAR.Person[id]["我方"] then --pid == 38 武骧金星：单通判定修正
	    for i = 0, CC.WarWidth - 1 do
	      for j = 0, CC.WarHeight - 1 do
	        local effect = GetWarMap(i, j, 4)
	        if 0 < effect then
	          local emeny = GetWarMap(i, j, 2)
	    			if 0 <= emeny and WAR.Person[emeny]["人物编号"] == 591 then
	    				WAR.WS = 1;
	    				if WAR.Person[id][CC.TXWZ1] ~= nil then
	        			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+相煎何太急"
	      			else
	        			WAR.Person[id][CC.TXWZ1] = "相煎何太急"
	      			end
	    				break;
	    			end
	    		end
	    	end
	    end
    end
	  
	--豸苗: 谢云流 森九岚误伤攻击
  	if XYL(pid) and WAR.Person[id]["我方"] then --pid == 591 武骧金星：单通判定修正
	    for i = 0, CC.WarWidth - 1 do
	      for j = 0, CC.WarHeight - 1 do
	        local effect = GetWarMap(i, j, 4)
	        if 0 < effect then
	          local emeny = GetWarMap(i, j, 2)
	    			if 0 <= emeny and WAR.Person[emeny]["人物编号"] == 92 and SJL(929) then
	    				WAR.WS = 1;
	    				if WAR.Person[id][CC.TXWZ1] ~= nil then
	        			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+师徒同心"
	      			else
	        			WAR.Person[id][CC.TXWZ1] = "师徒同心"
	      			end
	    				break;
	    			end
	    		end
	    	end
	    end
	end

    --豸苗: 谢云流 森九岚误伤攻击
  	if SJL(pid) and WAR.Person[id]["我方"] then --pid == 591 武骧金星：单通判定修正
	    for i = 0, CC.WarWidth - 1 do
	      for j = 0, CC.WarHeight - 1 do
	        local effect = GetWarMap(i, j, 4)
	        if 0 < effect then
	          local emeny = GetWarMap(i, j, 2)
	    			if 0 <= emeny and WAR.Person[emeny]["人物编号"] == 0 and XYL(0) then
	    				WAR.WS = 1;
	    				if WAR.Person[id][CC.TXWZ1] ~= nil then
	        			WAR.Person[id][CC.TXWZ1] = WAR.Person[id][CC.TXWZ1] .. "+师徒同心"
	      			else
	        			WAR.Person[id][CC.TXWZ1] = "师徒同心"
	      			end
	    				break;
	    			end
	    		end
	    	end
	    end
	end
	  
	for i = 0, CC.WarWidth - 1 do--17-3-2
		for j = 0, CC.WarHeight - 1 do
			local effect = GetWarMap(i, j, 4)
			if effect > 0 then
				local tmpem = GetWarMap(i, j, 2)
				if tmpem > -1 and WAR.Person[tmpem]["人物编号"] ~= nil 
					and MP11(WAR.Person[tmpem]["人物编号"])
					and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[tmpem]["我方"] and WAR.MJYW[WAR.Person[tmpem]["人物编号"]] ~= 1 then
					local a = 6		
					if WAR.JQ[WAR.Person[tmpem]["人物编号"]] ~= nil and WAR.JQ[WAR.Person[tmpem]["人物编号"]] > 0 then 
						a = a + WAR.JQ[WAR.Person[tmpem]["人物编号"]]
					end
					if JLSD(10,20+a,WAR.Person[tmpem]["人物编号"]) then
						lib.Delay(50)
						local tmppid = WAR.CurID	
						WAR.CurID = tmpem
						DHdisplay(2279, 2299, "秘剑演武 剑步谜影")
						WAR.MJYW[WAR.Person[tmpem]["人物编号"]] = 1
						WAR.CurID = tmppid
						lib.Delay(200)					
					end
				end	
			end
		end
	end
	--蓝烟清：持瑶琴
  	--[[if wugong == 73  then
  		WAR.WS = 1;
	    for i = 0, CC.WarWidth - 1 do
	      for j = 0, CC.WarHeight - 1 do
	        local effect = GetWarMap(i, j, 4)
	        if 0 < effect then
	          local emeny = GetWarMap(i, j, 2)
	    			if 0 <= emeny and WAR.Person[id]["我方"] == WAR.Person[emeny]["我方"] and emeny ~= WAR.CurID then
	    				local tp = WAR.Person[emeny]["人物编号"];
	    				WAR.Person[emeny]["体力点数"] = (WAR.Person[emeny]["体力点数"] or 0) + AddPersonAttrib(tp, "体力", 10);
	    				AddPersonAttrib(tp, "受伤程度", -10);
	    				SetWarMap(i, j, 4, 2)
	    			end
	    		end
	    	end
	    end
	end]]
	  
	if WAR.ACT == 1 then --dodge
		for i = 0, CC.WarWidth - 1 do
			for j = 0, CC.WarHeight - 1 do
	        local effect = GetWarMap(i, j, 4)
				if effect > 0 then
					local tmpem = GetWarMap(i, j, 2)
	    			if tmpem > -1 and WAR.Person[tmpem]["人物编号"] ~= nil 
						and MPPD(WAR.Person[tmpem]["人物编号"]) == 7 
						and WAR.LB[WAR.Person[tmpem]["人物编号"]] ~= nil
						and WAR.LBPD[WAR.Person[tmpem]["人物编号"]] == nil 
						and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[tmpem]["我方"] and WAR.SQFJ ~= 1 then
						reseteffect(WAR.LB, WAR.Person[tmpem]["人物编号"])
						WAR.LBPD[WAR.Person[tmpem]["人物编号"]] = 1
						lib.Delay(50)
						local tmppid = WAR.CurID	
						WAR.CurID = tmpem
						local tmpmove = WAR.Person[WAR.CurID]["移动步数"]		
						WAR.Person[WAR.CurID]["移动步数"] = 5	
						DIYdisplay(CC.NTalk3)
						lib.Delay(100)
						DIYdisplay(CC.NTalk4)
						War_MoveMenu()
						WAR.Person[WAR.CurID]["移动步数"] = tmpmove
						WAR.CurID = tmppid
						lib.Delay(200)	
	    			end
	    		end
	    	end
	    end		
	end
	WAR.LBPD = {}	
	
	if WAR.ACT == 1 then --dodge
		for i = 0, CC.WarWidth - 1 do
			for j = 0, CC.WarHeight - 1 do
	        local effect = GetWarMap(i, j, 4)
				if effect > 0 then
					local tmpem = GetWarMap(i, j, 2)
	    			if tmpem > -1 and WAR.Person[tmpem]["人物编号"] ~= nil 
						and wglw1(WAR.Person[tmpem]["人物编号"],48)
						and WAR.BXJF4[WAR.Person[tmpem]["人物编号"]] ~= nil
						and WAR.BXJF4PD[WAR.Person[tmpem]["人物编号"]] == nil 
						and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[tmpem]["我方"] and WAR.SQFJ ~= 1 then
						reseteffect(WAR.BXJF4, WAR.Person[tmpem]["人物编号"])
						WAR.WAR.BXJF4PD[WAR.Person[tmpem]["人物编号"]] = 1
						lib.Delay(50)
						local tmppid = WAR.CurID	
						WAR.CurID = tmpem
						local tmpmove = WAR.Person[WAR.CurID]["移动步数"]		
						WAR.Person[WAR.CurID]["移动步数"] = 5	
						DIYdisplay("裂空・流星飞堕")
						lib.Delay(100)
						--DIYdisplay(CC.NTalk4)
						War_MoveMenu()
						WAR.Person[WAR.CurID]["移动步数"] = tmpmove
						WAR.CurID = tmppid
						lib.Delay(200)	
	    			end
	    		end
	    	end
	    end		
	end
	WAR.BXJF4PD = {}	
	
	if WAR.ACT < 10 then ----沼跃鱼：滕青山狐步
		for i = 0, CC.WarWidth - 1 do
			for j = 0, CC.WarHeight - 1 do
	        local effect = GetWarMap(i, j, 4)
				if effect > 0 then
					local tmpem = GetWarMap(i, j, 2)
	    			if tmpem > -1 and WAR.Person[tmpem]["人物编号"] ~= nil 
						and T13TQS(tmpem) and WAR.Person[tmpem]["人物编号"] ==0 
						and WAR.HB[WAR.Person[tmpem]["人物编号"]] ~= nil
						--and WAR.HBPD[WAR.Person[tmpem]["人物编号"]] == nil 
						and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[tmpem]["我方"] and WAR.SQFJ ~= 1 
						and math.random(10) >= 4 then
						if WAR.HB[WAR.Person[tmpem]["人物编号"]] ~= nil then 
							WAR.HB[WAR.Person[tmpem]["人物编号"]] = (WAR.HB[WAR.Person[tmpem]["人物编号"]] or 0 ) - 1
							--reseteffect(WAR.HB, WAR.Person[tmpem]["人物编号"])
						end
						--WAR.HBPD[WAR.Person[tmpem]["人物编号"]] = 1
						lib.Delay(50)
						local tmppid = WAR.CurID  					
                        local tmp1=WAR.Person[WAR.CurID][CC.TXWZ1]
						local tmp2=WAR.Person[WAR.CurID][CC.TXWZ2]
						local tmp3=WAR.Person[WAR.CurID][CC.TXWZ3]
						local tmp4=WAR.Person[WAR.CurID][CC.TXDH]
						WAR.CurID = tmpem
                        local tmpx=WAR.Person[WAR.CurID]["坐标X"]
						local tmpy=WAR.Person[WAR.CurID]["坐标Y"]
						local tmpmove = WAR.Person[WAR.CurID]["移动步数"]		
						WAR.Person[WAR.CurID]["移动步数"] = 5	
						DIYdisplay("天狐闪.料敌杀机")
						lib.Delay(100)
						War_MoveMenu()
						WAR.Person[WAR.CurID]["移动步数"] = tmpmove
                        WAR.SQFJ=1
						WarDrawMap(0)
						War_Fight_Sub(tmpem, 1, WAR.Person[tmpem]["坐标X"], WAR.Person[tmpem]["坐标Y"])
						local tmpx=WAR.Person[tmpem]["坐标X"]-1
						local tmpy=WAR.Person[tmpem]["坐标Y"]-1
						WAR.SQFJ=0
						DIYdisplay("天狐返.先手攻击")
						--addeffect(WAR.HB, WAR.Person[tmpem]["人物编号"], 1)
						WAR.CurID = tmppid
                        SetWarMap(tmpx, tmpy, 4, 3)
						WAR.Person[WAR.CurID][CC.TXWZ1]=tmp1
						WAR.Person[WAR.CurID][CC.TXWZ2]=tmp2
						WAR.Person[WAR.CurID][CC.TXWZ3]=tmp3
						WAR.Person[WAR.CurID][CC.TXDH]=tmp4
						lib.Delay(200)	
	    			end
	    		end
	    	end
	    end		
	end
	--WAR.HBPD = {}
	
	if WAR.ACT < 10 then ----沼跃鱼：滕青山狐步
		for i = 0, CC.WarWidth - 1 do
			for j = 0, CC.WarHeight - 1 do
	        local effect = GetWarMap(i, j, 4)
				if effect > 0 then
					local tmpem = GetWarMap(i, j, 2)
	    			if tmpem > -1 and WAR.Person[tmpem]["人物编号"] ~= nil 
						and (WAR.Person[tmpem]["人物编号"] == 598 and DT(WAR.Person[tmpem]["人物编号"],598))
						and (JLSD(0,30+(WAR.SWHH1+WAR.SWFY1)*3,WAR.Person[tmpem]["人物编号"] ))
						and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[tmpem]["我方"] and WAR.SQFJ ~= 1 then
						reseteffect(WAR.HB, WAR.Person[tmpem]["人物编号"])
						lib.Delay(50)
						local tmppid = WAR.CurID  					
                        local tmp1=WAR.Person[WAR.CurID][CC.TXWZ1]
						local tmp2=WAR.Person[WAR.CurID][CC.TXWZ2]
						local tmp3=WAR.Person[WAR.CurID][CC.TXWZ3]
						local tmp4=WAR.Person[WAR.CurID][CC.TXDH]
						WAR.CurID = tmpem
                        local tmpx=WAR.Person[WAR.CurID]["坐标X"]
						local tmpy=WAR.Person[WAR.CurID]["坐标Y"]
						local tmpmove = WAR.Person[WAR.CurID]["移动步数"]			
						DIYdisplay("天狐闪.料敌杀机")
						lib.Delay(100)
                        WAR.SQFJ=1
						WarDrawMap(0)
						War_Fight_Sub(tmpem, 1, WAR.Person[tmpem]["坐标X"], WAR.Person[tmpem]["坐标Y"])
						local tmpx=WAR.Person[tmpem]["坐标X"]-1
						local tmpy=WAR.Person[tmpem]["坐标Y"]-1
						WAR.SQFJ=0
						DIYdisplay("天狐返.先手攻击")
						addeffect(WAR.HB, WAR.Person[tmpem]["人物编号"], 1)
						WAR.CurID = tmppid
                        SetWarMap(tmpx, tmpy, 4, 3)
						WAR.Person[WAR.CurID][CC.TXWZ1]=tmp1
						WAR.Person[WAR.CurID][CC.TXWZ2]=tmp2
						WAR.Person[WAR.CurID][CC.TXWZ3]=tmp3
						WAR.Person[WAR.CurID][CC.TXDH]=tmp4
						lib.Delay(200)	
	    			end
	    		end
	    	end
	    end		
	end
	
	if math.random(10) <= 4 and juexing() >= 2 then ----豸苗：谢云流错步剑1-10-
		for i = 0, CC.WarWidth - 1 do
			for j = 0, CC.WarHeight - 1 do
	        local effect = GetWarMap(i, j, 4)
				if effect > 0 then
					local tmpem = GetWarMap(i, j, 2)
	    			if tmpem > -1 and WAR.Person[tmpem]["人物编号"] ~= nil 
                        and WAR.Person[tmpem]["人物编号"] == 0 and XYL(0) 
						and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[tmpem]["我方"] then
						lib.Delay(50)
						local tmppid = WAR.CurID	
						      WAR.CurID = tmpem
						local tmpmove = WAR.Person[WAR.CurID]["移动步数"]						
						WAR.Person[WAR.CurID]["移动步数"] = 5	
						DIYdisplay("秘技")
						lib.Delay(100)
						DIYdisplay("错步剑")
						WAR.XYMJ = -1
						War_MoveMenu()
						WAR.Person[WAR.CurID]["移动步数"] = tmpmove
						WAR.CurID = tmppid
						lib.Delay(200)					
	    			end
	    		end
	    	end
	    end		
	end
    --if math.random(10) <= 5 then 	--聂风捕风捉影
        --for i = 0, CC.WarWidth - 1 do
	        --for j = 0, CC.WarHeight - 1 do
	        --local effect = GetWarMap(i, j, 4)
	            --if effect > 0 then
		            --local tmpem = GetWarMap(i, j, 2)
	                --if tmpem > -1 and WAR.Person[tmpem]["人物编号"] ~= nil 
                    --and WAR.Person[tmpem]["人物编号"] == 0 and NF(0) 
		            --and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[tmpem]["我方"] then
		            --lib.Delay(50)
		            --local tmppid = WAR.CurID	
		            --WAR.CurID = tmpem
		            --local tmpmove = WAR.Person[WAR.CurID]["移动步数"]						
		            --WAR.Person[WAR.CurID]["移动步数"] = 8	
		            --DIYdisplay("捕风")
		            --lib.Delay(100)
		            --DIYdisplay("捉影")
		            --WAR.BFZY = -1
		            --War_MoveMenu()
		            --WAR.Person[WAR.CurID]["移动步数"] = tmpmove
		            --WAR.CurID = tmppid
		            --lib.Delay(200)		
		            --local x,y = WAR.Person[i]["坐标X"],WAR.Person[i]["坐标Y"]
		            --for j = 0,WAR.PersonNum-1 do 
		                --if WAR.Person[j]["我方"] == WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == true then 
		                    --if WAR.FSJY[WAR.Person[j]["人物编号"]]== WAR.Person[i]["人物编号"] then
			                    --xunhuan = false
		                        --JY.Person[WAR.FSJY[50+WAR.Person[i]["人物编号"]]]["生命"] = JY.Person[WAR.Person[i]["人物编号"]]["生命"]
			                    --WAR.Person[i]["死亡"] = true
			                    --WAR.BFZY[WAR.Person[j]["人物编号"]] = nil
			                    --WAR.Person[j]["死亡"] = false
			                    --WAR.BFZY[WAR.Person[j]["人物编号"]] = 1
		                    --end  
		                --end 
		            --end				
	                --end
	            --end
	        --end
	    --end	
    --end
	if math.random(10) <= 5 then 	
        for i = 0, CC.WarWidth - 1 do
	        for j = 0, CC.WarHeight - 1 do
	        local effect = GetWarMap(i, j, 4)
	            if effect > 0 then
		            local tmpem = GetWarMap(i, j, 2)
	                if tmpem > -1 and WAR.Person[tmpem]["人物编号"] ~= nil
                    and ((DT(WAR.Person[tmpem]["人物编号"],92) and (WAR.Person[tmpem]["人物编号"] == GX(0) or WAR.Person[tmpem]["人物编号"] == 0)) or 
					wglw(WAR.Person[tmpem]["人物编号"],186) and PersonGT(WAR.Person[tmpem]["人物编号"],186)) 
		            and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[tmpem]["我方"] then
		            lib.Delay(50)
		            local tmppid = WAR.CurID	
		            WAR.CurID = tmpem
		            local tmpmove = WAR.Person[WAR.CurID]["移动步数"]						
		            WAR.Person[WAR.CurID]["移动步数"] = 6	
		            DIYdisplay("清风袭月雪飘云")
		            lib.Delay(100)
		            DIYdisplay("大雁啼沙鹤天翔")
		            WAR.BFZY = -1
		            War_MoveMenu()
		            WAR.Person[WAR.CurID]["移动步数"] = tmpmove
		            WAR.CurID = tmppid
		            lib.Delay(200)		
		            local x,y = WAR.Person[i]["坐标X"],WAR.Person[i]["坐标Y"]
		                for j = 0,WAR.PersonNum-1 do 
		                    if WAR.Person[j]["我方"] == WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == true then 
		                        if WAR.FSJY[WAR.Person[j]["人物编号"]]== WAR.Person[i]["人物编号"] then
			                        xunhuan = false
		                            JY.Person[WAR.FSJY[50+WAR.Person[i]["人物编号"]]]["生命"] = JY.Person[WAR.Person[i]["人物编号"]]["生命"]
			                        WAR.Person[i]["死亡"] = true
			                        WAR.BFZY[WAR.Person[j]["人物编号"]] = nil
			                        WAR.Person[j]["死亡"] = false
			                        WAR.BFZY[WAR.Person[j]["人物编号"]] = 1
		                        end  
		                    end 
		                end				
	                end
	            end
	        end
	    end	
    end
	if WAR.ACT < 10 then 
		for i = 0, CC.WarWidth - 1 do
			for j = 0, CC.WarHeight - 1 do
	        local effect = GetWarMap(i, j, 4)
				if effect > 0 then
					local tmpem = GetWarMap(i, j, 2)
	    			if tmpem > -1 and WAR.Person[tmpem]["人物编号"] ~= nil 
                        and KHT(WAR.Person[tmpem]["人物编号"]) and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[tmpem]["我方"] and JLSD(10,55,WAR.Person[tmpem]["人物编号"]) then
						WAR.KHZJ[WAR.Person[tmpem]["人物编号"]] = (WAR.KHZJ[WAR.Person[tmpem]["人物编号"]] or 0) + 100
						lib.Delay(50)
						local tmppid = WAR.CurID	
						WAR.CurID = tmpem	
						if wglw2(WAR.Person[tmpem]["人物编号"],196) and PersonKF(WAR.Person[tmpem]["人物编号"],196) and math.random(10) > 5 then
							WAR.AXSY4[WAR.Person[tmppid]["人物编号"]] = 1
						end
						DIYdisplay("魔葵奥义")
						lib.Delay(100)
						DIYdisplay("真・葵花真解")
						local ax, ay = WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"]
						if inteam(WAR.Person[WAR.CurID]["人物编号"]) then
							War_CalMoveStep(WAR.CurID, 12, 1) --武功移动步数
							local nx, ny = nil, nil
							while true do
								nx, ny = War_SelectMove() --显示+选择步数
								if nx ~= nil then
									if lib.GetWarMap(nx, ny, 2) > 0 or lib.GetWarMap(nx, ny, 5) > 0 then
									   QZXS(CC.EVB186)			--此处有人！请重新选择
									elseif CC.SceneWater[lib.GetWarMap(nx, ny, 0)] ~= nil then
									   QZXS(CC.EVB187)		--水面，不可进入！请重新选择
									else   
										break;
									end
								end
							end
							WarDrawMap(0)
							CurIDTXDH(WAR.CurID, 2474, 2484)
							lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 5, -1)
							lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 2, -1)
							WarDrawMap(0)
							CurIDTXDH(WAR.CurID, 2474, 2484)
							WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] = nx, ny
							WarDrawMap(0)
							CurIDTXDH(WAR.CurID, 2474, 2484)
							lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 5, WAR.Person[WAR.CurID]["贴图"])
							lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 2, WAR.CurID)
							WarDrawMap(0)
							CurIDTXDH(WAR.CurID, 2474, 2484)
						else
							War_AutoKHYX()
						end
						WAR.KHYX[WAR.Person[WAR.CurID]["人物编号"]] = {ax,ay}
						WAR.CurID = tmppid
						lib.Delay(200)			
	    			--end
					end
	    		end
	    	end
	    end		
	end
	if WAR.ACT < 10 then 
		for i = 0, CC.WarWidth - 1 do
			for j = 0, CC.WarHeight - 1 do
	        local effect = GetWarMap(i, j, 4)
				if effect > 0 then
					local tmpem = GetWarMap(i, j, 2)
	    			if tmpem > -1 and WAR.Person[tmpem]["人物编号"] ~= nil 
                        and ((DT(WAR.Person[tmpem]["人物编号"],27) and (WAR.Person[tmpem]["人物编号"] == 27 or WAR.Person[tmpem]["人物编号"] == 0)) or 
						wglw(WAR.Person[tmpem]["人物编号"],105) and PersonGT(WAR.Person[tmpem]["人物编号"],105)) 
						and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[tmpem]["我方"] and JLSD(10,40,WAR.Person[tmpem]["人物编号"]) then
						WAR.KHSY[WAR.Person[tmpem]["人物编号"]] = (WAR.KHSY[WAR.Person[tmpem]["人物编号"]] or 0) + 100
						lib.Delay(50)
						local tmppid = WAR.CurID	
						      WAR.CurID = tmpem	
							  if wglw2(WAR.Person[tmpem]["人物编号"],196) and PersonKF(WAR.Person[tmpem]["人物编号"],196) and math.random(10) > 5 then
								WAR.AXSY4[WAR.Person[tmppid]["人物编号"]] = 1
							  end	
						DIYdisplay("葵花真解")
						lib.Delay(100)
						DIYdisplay("真・葵花移形")
						local ax, ay = WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"]
						if inteam(WAR.Person[WAR.CurID]["人物编号"]) then
    War_CalMoveStep(WAR.CurID, 12, 1) --武功移动步数
    local nx, ny = nil, nil
    while true do
	   nx, ny = War_SelectMove() --显示+选择步数
	if nx ~= nil then
	if lib.GetWarMap(nx, ny, 2) > 0 or lib.GetWarMap(nx, ny, 5) > 0 then
       QZXS(CC.EVB186)			--此处有人！请重新选择
	elseif CC.SceneWater[lib.GetWarMap(nx, ny, 0)] ~= nil then
	   QZXS(CC.EVB187)		--水面，不可进入！请重新选择
	else   
	break;
	end
	end
	end
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 2300, 2317)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 5, -1)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 2, -1)
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 2300, 2317)
	    WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] = nx, ny
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 2300, 2317)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 5, WAR.Person[WAR.CurID]["贴图"])
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 2, WAR.CurID)
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 2300, 2317)
						else
		                War_AutoKHYX()
						end
						WAR.KHYX[WAR.Person[WAR.CurID]["人物编号"]] = {ax,ay}
						WAR.CurID = tmppid
						lib.Delay(200)			
	    			--end
					end
	    		end
	    	end
	    end		
	end
	if WAR.ACT < 10 then 
		for i = 0, CC.WarWidth - 1 do
			for j = 0, CC.WarHeight - 1 do
	        local effect = GetWarMap(i, j, 4)
				if effect > 0 then
					local tmpem = GetWarMap(i, j, 2)
	    			if tmpem > -1 and WAR.Person[tmpem]["人物编号"] ~= nil 
                        and ((DT(WAR.Person[tmpem]["人物编号"],617) and (WAR.Person[tmpem]["人物编号"] == 617 or WAR.Person[tmpem]["人物编号"] == 0)) or 
						wglw(WAR.Person[tmpem]["人物编号"],105) and PersonGT(WAR.Person[tmpem]["人物编号"],105)) 
						and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[tmpem]["我方"] and JLSD(10,40,WAR.Person[tmpem]["人物编号"]) then
						WAR.KHSY[WAR.Person[tmpem]["人物编号"]] = (WAR.KHSY[WAR.Person[tmpem]["人物编号"]] or 0) + 100
						lib.Delay(50)
						local tmppid = WAR.CurID	
						      WAR.CurID = tmpem	
							  if wglw2(WAR.Person[tmpem]["人物编号"],196) and PersonKF(WAR.Person[tmpem]["人物编号"],196) and math.random(10) > 5 then
								WAR.AXSY4[WAR.Person[tmppid]["人物编号"]] = 1
							  end
						DIYdisplay("葵花真解")
						lib.Delay(100)
						DIYdisplay("真・葵花移形")
						local ax, ay = WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"]
						if inteam(WAR.Person[WAR.CurID]["人物编号"]) then
    War_CalMoveStep(WAR.CurID, 12, 1) --武功移动步数
    local nx, ny = nil, nil
    while true do
	   nx, ny = War_SelectMove() --显示+选择步数
	if nx ~= nil then
	if lib.GetWarMap(nx, ny, 2) > 0 or lib.GetWarMap(nx, ny, 5) > 0 then
       QZXS(CC.EVB186)			--此处有人！请重新选择
	elseif CC.SceneWater[lib.GetWarMap(nx, ny, 0)] ~= nil then
	   QZXS(CC.EVB187)		--水面，不可进入！请重新选择
	else   
	break;
	end
	end
	end
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 2300, 2317)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 5, -1)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 2, -1)
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 2300, 2317)
	    WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] = nx, ny
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 2300, 2317)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 5, WAR.Person[WAR.CurID]["贴图"])
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 2, WAR.CurID)
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 2300, 2317)
						else
		                War_AutoKHYX()
						end
						WAR.KHYX[WAR.Person[WAR.CurID]["人物编号"]] = {ax,ay}
						WAR.CurID = tmppid
						lib.Delay(200)			
	    			--end
					end
	    		end
	    	end
	    end		
	end
	if WAR.ACT < 10 then 
		for i = 0, CC.WarWidth - 1 do
			for j = 0, CC.WarHeight - 1 do
	        local effect = GetWarMap(i, j, 4)
				if effect > 0 then
					local tmpem = GetWarMap(i, j, 2)
	    			if tmpem > -1 and WAR.Person[tmpem]["人物编号"] ~= nil 
                        and NF(tmpem) and WAR.Person[tmpem]["人物编号"] ==0 
						and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[tmpem]["我方"] 
	                    and JLSD(10,85,WAR.Person[tmpem]["人物编号"]) then
						lib.Delay(50)
						local tmppid = WAR.CurID	
						      WAR.CurID = tmpem	
						DIYdisplay("风无相")
						lib.Delay(100)
						DIYdisplay("步风足影")
						local ax, ay = WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"]
						if inteam(WAR.Person[WAR.CurID]["人物编号"]) then
    War_CalMoveStep(WAR.CurID, 18, 1) --武功移动步数
    local nx, ny = nil, nil
    while true do
	   nx, ny = War_SelectMove() --显示+选择步数
	if nx ~= nil then
	if lib.GetWarMap(nx, ny, 2) > 0 or lib.GetWarMap(nx, ny, 5) > 0 then
       QZXS(CC.EVB186)			--此处有人！请重新选择
	elseif CC.SceneWater[lib.GetWarMap(nx, ny, 0)] ~= nil then
	   QZXS(CC.EVB187)		--水面，不可进入！请重新选择
	else   
	break;
	end
	end
	end
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 2703, 2730)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 5, -1)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 2, -1)
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 2703, 2730)
	    WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] = nx, ny
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 2703, 2730)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 5, WAR.Person[WAR.CurID]["贴图"])
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 2, WAR.CurID)
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 2703, 2730)
						else
		                War_AutoKHYX()
						end
						WAR.KHYX[WAR.Person[WAR.CurID]["人物编号"]] = {ax,ay}
						WAR.CurID = tmppid
						lib.Delay(200)			
	    			--end
					end
	    		end
	    	end
	    end		
	end
	if WAR.ACT < 10 then 
		for i = 0, CC.WarWidth - 1 do
			for j = 0, CC.WarHeight - 1 do
	        local effect = GetWarMap(i, j, 4)
				if effect > 0 then
					local tmpem = GetWarMap(i, j, 2)
	    			if tmpem > -1 and WAR.Person[tmpem]["人物编号"] ~= nil 
                        and (WAR.Person[tmpem]["人物编号"] == 600 and DT(WAR.Person[tmpem]["人物编号"],600))
						and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[tmpem]["我方"] 
	                    and JLSD(10,100,WAR.Person[tmpem]["人物编号"]) then
						lib.Delay(50)
						local tmppid = WAR.CurID	
						      WAR.CurID = tmpem	
						DIYdisplay("速水无痕")
						lib.Delay(100)
						DIYdisplay("纵走梅花")
						local ax, ay = WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"]
						if inteam(WAR.Person[WAR.CurID]["人物编号"]) then
    War_CalMoveStep(WAR.CurID, 18, 1) --武功移动步数
    local nx, ny = nil, nil
    while true do
	   nx, ny = War_SelectMove() --显示+选择步数
	if nx ~= nil then
	if lib.GetWarMap(nx, ny, 2) > 0 or lib.GetWarMap(nx, ny, 5) > 0 then
       QZXS(CC.EVB186)			--此处有人！请重新选择
	elseif CC.SceneWater[lib.GetWarMap(nx, ny, 0)] ~= nil then
	   QZXS(CC.EVB187)		--水面，不可进入！请重新选择
	else   
	break;
	end
	end
	end
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 2336, 2365)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 5, -1)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 2, -1)
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 2336, 2365)
	    WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] = nx, ny
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 2336, 2365)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 5, WAR.Person[WAR.CurID]["贴图"])
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 2, WAR.CurID)
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 2336, 2365)
						else
		                War_AutoKHYX()
						end
						WAR.KHYX[WAR.Person[WAR.CurID]["人物编号"]] = {ax,ay}
						WAR.CurID = tmppid
						lib.Delay(200)			
	    			--end
					end
	    		end
	    	end
	    end		
	end
	if WAR.ACT < 10 then   --凡总自带
		for i = 0, CC.WarWidth - 1 do
			for j = 0, CC.WarHeight - 1 do
	        local effect = GetWarMap(i, j, 4)
				if effect > 0 then
					local tmpem = GetWarMap(i, j, 2)
	    			if tmpem > -1 and WAR.Person[tmpem]["人物编号"] ~= nil 
                        and (WAR.Person[tmpem]["人物编号"] == 457 and DT(WAR.Person[tmpem]["人物编号"],457))
						and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[tmpem]["我方"] 
	                    and JLSD(10,85,WAR.Person[tmpem]["人物编号"]) then
						lib.Delay(50)
						local tmppid = WAR.CurID	
						      WAR.CurID = tmpem	
						DIYdisplay("奥义")
						lib.Delay(100)
						DIYdisplay("真・天机闪")
						local ax, ay = WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"]
						if inteam(WAR.Person[WAR.CurID]["人物编号"]) then
    War_CalMoveStep(WAR.CurID, 11, 1) --武功移动步数
    local nx, ny = nil, nil
    while true do
	   nx, ny = War_SelectMove() --显示+选择步数
	if nx ~= nil then
	if lib.GetWarMap(nx, ny, 2) > 0 or lib.GetWarMap(nx, ny, 5) > 0 then
       QZXS(CC.EVB186)			--此处有人！请重新选择
	elseif CC.SceneWater[lib.GetWarMap(nx, ny, 0)] ~= nil then
	   QZXS(CC.EVB187)		--水面，不可进入！请重新选择
	else   
	break;
	end
	end
	end
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 2300, 2317)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 5, -1)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 2, -1)
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 2300, 2317)
	    WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] = nx, ny
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 2300, 2317)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 5, WAR.Person[WAR.CurID]["贴图"])
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 2, WAR.CurID)
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 2300, 2317)
						else
		                War_AutoKHYX()
						end
						WAR.KHYX[WAR.Person[WAR.CurID]["人物编号"]] = {ax,ay}
						WAR.CurID = tmppid
						lib.Delay(200)			
	    			--end
					end
	    		end
	    	end
	    end		
	end
    if WAR.ACT < 10 then --17-2-19-幻光步
		for i = 0, CC.WarWidth - 1 do
			for j = 0, CC.WarHeight - 1 do
	        local effect = GetWarMap(i, j, 4)
				if effect > 0 then
					local tmpem = GetWarMap(i, j, 2)
	    			if tmpem > -1 and WAR.Person[tmpem]["人物编号"] ~= nil 
                        and ((wglw(WAR.Person[tmpem]["人物编号"],93) and PersonGT(WAR.Person[tmpem]["人物编号"],93)) or (DT(WAR.Person[tmpem]["人物编号"],66) and PersonKF(WAR.Person[tmpem]["人物编号"],93)) or (DT(WAR.Person[tmpem]["人物编号"],558) and PersonKF(WAR.Person[tmpem]["人物编号"],93))) and inteam(WAR.Person[tmpem]["人物编号"])
						and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[tmpem]["我方"] and WAR.HGB[100+WAR.Person[tmpem]["人物编号"]] ~= nil then
						lib.Delay(50)
						local tmppid = WAR.CurID	
						      WAR.CurID = tmpem	
						WAR.SHML[WAR.Person[tmppid]["人物编号"]] = 1
						DHdisplay(2151, 2165, "接引离斯毒火海 幻光游世常自在")
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 2300, 2317)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 5, -1)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 2, -1)
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 2300, 2317)
	    WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] = WAR.HGB[100+WAR.Person[WAR.CurID]["人物编号"]][1], WAR.HGB[100+WAR.Person[WAR.CurID]["人物编号"]][2]
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 2300, 2317)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 5, WAR.Person[WAR.CurID]["贴图"])
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 2, WAR.CurID)
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 2300, 2317)
		               WAR.HGB[100+WAR.Person[WAR.CurID]["人物编号"]] = nil
						--local nx, ny = War_AutoEscape()
		                --War_AutoKHYX()
						WAR.CurID = tmppid
						lib.Delay(200)					
	    			--end
					end
	    		end
	    	end
	    end		
	end
	WAR.SEVENSTAR = {}
	if hasTF(pid, 36) then
		local n = 0;
		for i = 0, CC.WarWidth - 1 do
		  for j = 0, CC.WarHeight - 1 do
			local effect = GetWarMap(i, j, 4)
			if 0 < effect then
				local emeny = GetWarMap(i, j, 2)
					if 0 <= emeny and WAR.Person[id]["我方"] ~= WAR.Person[emeny]["我方"] 
						and WAR.Person[emeny]["死亡"] == false then
						n = n + 1
					end
				end
			end
		end	
		WAR.SEVENSTAR[pid] = n
	end
	
	if MPPD(pid) == 11 and (JLSD(10,60,pid) or WAR.MJYW[pid] == 1) then 
	   WAR.ZMYJ = 1 --17-3-1-
	  if WAR.Person[id][CC.TXWZ3] ~= nil then
      	WAR.Person[id][CC.TXWZ3] = "致命・"..WAR.Person[id][CC.TXWZ3]
      else
      	WAR.Person[id][CC.TXWZ3] = "致命"
      end
	end
	
	if wglw(pid,178) or (DT(pid,69) and PersonKF(pid,178)) or T9ZY(pid) or DT(pid,602) then --九龙功
	  if WAR.Person[id][CC.TXWZ3] ~= nil then
      	WAR.Person[id][CC.TXWZ3] = "狂龙・"..WAR.Person[id][CC.TXWZ3]
      else
      	WAR.Person[id][CC.TXWZ3] = "狂龙"
      end
	  WAR.KLYH = 1
	  if WAR.SLCS[100+pid] ~= nil and WAR.SLCS[100+pid] > 0 then 
	     WAR.SLCS[100+pid] = WAR.SLCS[100+pid] -1
		 if WAR.SLCS[100+pid] <= 0 then 
		    WAR.SLCS[100+pid] = nil 
		 end	
	  end
	end
	
    if wglw(pid,182) or (DT(pid,5) and PersonGT(pid,182)) then
	    if WAR.TJSG[100+pid] ~= nil and WAR.TJSG[100+pid] > 0 then 
	        WAR.TJSG[100+pid] = WAR.TJSG[100+pid] -1
		    if WAR.TJSG[100+pid] <= 0 then 
		        WAR.TJSG[100+pid] = nil 
		    end	
	    end
		if WAR.Person[id][CC.TXWZ3] ~= nil then
      	    WAR.Person[id][CC.TXWZ3] = "太极・"..WAR.Person[id][CC.TXWZ3]
        else
      	    WAR.Person[id][CC.TXWZ3] = "太极"
        end
		WAR.TJJS = 1
	end
	
    if wglw(pid,183) or (DT(pid,615) and PersonGT(pid,183)) then
	    if WAR.XSSG[100+pid] ~= nil and WAR.XSSG[100+pid] > 0 then 
	        WAR.XSSG[100+pid] = WAR.XSSG[100+pid] -1
		    if WAR.XSSG[100+pid] <= 0 then 
		        WAR.XSSG[100+pid] = nil 
		    end	
	    end
		if WAR.Person[id][CC.TXWZ3] ~= nil then
      	    WAR.Person[id][CC.TXWZ3] = "洗髓・"..WAR.Person[id][CC.TXWZ3]
        else
      	    WAR.Person[id][CC.TXWZ3] = "洗髓"
        end
		WAR.XSJS = 1
	end	
		
    if wglw(pid,184) and PersonGT(pid,184) or DT(pid,665) then
	    if WAR.YJMC[100+pid] ~= nil and WAR.YJMC[100+pid] > 0 then 
	        WAR.YJMC[100+pid] = WAR.YJMC[100+pid] -1
		    if WAR.YJMC[100+pid] <= 0 then 
		        WAR.YJMC[100+pid] = nil 
		    end	
	    end
		if WAR.Person[id][CC.TXWZ3] ~= nil then
      	    WAR.Person[id][CC.TXWZ3] = "瑜伽・"..WAR.Person[id][CC.TXWZ3]
        else
      	    WAR.Person[id][CC.TXWZ3] = "瑜伽"
        end
		WAR.YJJS = 1
	end			
		
    --特效文字1，动画为红色圈
    if WAR.Person[id][CC.TXWZ1] ~= nil and WAR.Person[id][CC.TXDH] == -1 then
      WAR.Person[id][CC.TXDH] = 88
    end

    WAR.HIT = 0
    --计算伤害的敌人
    for i = 0, CC.WarWidth - 1 do
		for j = 0, CC.WarHeight - 1 do
			local effect = GetWarMap(i, j, 4)
			if 0 < effect then
				local emeny = GetWarMap(i, j, 2)
				if 0 <= emeny and emeny ~= WAR.CurID then		--如果有人，并且不是当前控制人
					if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emeny]["我方"] and WAR.HIT == 0 then
						WAR.HIT = 1
					end				
					if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emeny]["我方"] 
						or ((GetS(0, 0, 0, 0) ~= 1 or WAR.tmp[1000 + pid] ~= nil) 
						or (ZHEN_ID < 0 and WAR.WS == 0)) or WAR.WXXY1==1 then
						if (WAR.MJYW[WAR.Person[emeny]["人物编号"]] == 1 or WAR.JSJY[200+WAR.Person[emeny]["人物编号"]] ~= nil) then --剑势剑影
						elseif JY.Wugong[wugong]["伤害类型"] == 1 and (fightscope == 0 or fightscope == 3) then
							WAR.Person[emeny]["内力点数"] = (WAR.Person[emeny]["内力点数"] or 0) - 300
							SetWarMap(i, j, 4, 3)
							WAR.Effect = 3
						else
							WAR.Person[emeny]["生命点数"] = (WAR.Person[emeny]["生命点数"] or 0) - War_WugongHurtLife(emeny, wugong, level, ng)
							WAR.Effect = 2
							SetWarMap(i, j, 4, 2)
						end
					end
				end
			end
		end
    end

    local dhxg = JY.Wugong[wugong]["武功动画&音效"]
    if WAR.LXZQ == 1 then
      dhxg = 72
    elseif WAR.JSYX == 1 then
        dhxg = 80
    elseif WAR.ASKD == 1 then
        dhxg = 66
    elseif WAR.GCTJ == 1 then
        dhxg = 108
    elseif WAR.DJJIAN == 1 or WAR.DJGZ==2 then
        dhxg = 109
    elseif WAR.DJDAO == 1 or WAR.DJGZ==3 then
        dhxg = 108
	elseif WAR.DJGZ==4 then
        dhxg = 118
	elseif WAR.DJSX == 1 then
        dhxg = 120
    elseif WAR.XQS == 1 then
      dhxg = 145
    elseif WAR.XQS == 2 then
        dhxg = 66
    elseif WAR.XQS == 3 then
        dhxg = 167
	elseif WAR.XQS == 4 then
        dhxg = 146
	elseif WAR.XQS == 5 then
        dhxg = 185
    elseif WAR.XQS == 6 then
        dhxg = 108
    elseif WAR.XQS == 7 then
        dhxg = 168
	elseif WAR.XQS == 8 then
        dhxg = 10
    elseif WAR.NSTJ2 >0 then
        dhxg = 181
	elseif WAR.ZBT2>0  then
	    dhxg = 111
	elseif wglw1(pid,58)  and WAR.XLEB > 0 then
        dhxg = 131
	--elseif wugong == 48 then
		--dhxg = 159
	elseif wugong == 11 then
		dhxg = 165	
	elseif wugong == 68 and wglw1(pid,68) then
		dhxg = 9	
	elseif wugong == 18 and wglw1(pid,18) and WAR.TZPT > 0 then
		local aa = WAR.TZPT
		dhxg = JY.Wugong[aa]["武功动画&音效"]
    end
    
	--War_ShowFight(pid, wugong, JY.Wugong[wugong]["武功类型"], level, x, y, dhxg, ZHEN_ID)
    War_ShowFight(pid, wugong, JY.Wugong[wugong]["类型"], level, x, y, dhxg, ZHEN_ID)
    
    War_Show_Count(WAR.CurID);		--显示当前控制人的点数
    
    WAR.Person[WAR.CurID]["经验"] = WAR.Person[WAR.CurID]["经验"] + 2
    local rz = 0
    if WAR.Person[id]["我方"] then
    	rz = 4;
    else
    	rz = 40
    end
    
    if JY.WGLVXS == 1 then
      rz = 100
    end
	
    --武功增加经验和升级
    --if inteam(pid) or GetS(103, 0, 0, 1) == pid then --nino：伪主角武功可以升级
	if JY.Person[pid]["武功等级" .. wugongnum] < 900 then
		--JY.Person[pid]["武功等级" .. wugongnum] = JY.Person[pid]["武功等级" .. wugongnum] + 5 + Rnd(10) 武骧金星：武功不能通过空挥到LV10
	   elseif JY.Person[pid]["武功等级" .. wugongnum] < 999 then
	   	if inteam(pid) or GetS(103, 0, 0, 1) == pid then JY.Person[pid]["武功等级" .. wugongnum] = JY.Person[pid]["武功等级" .. wugongnum] + 100 end
		if 999 <= JY.Person[pid]["武功等级" .. wugongnum] then
			JY.Person[pid]["武功等级" .. wugongnum] = 999
			PlayWavAtk(42)
			DrawStrBoxWaitKey(string.format(CC.WARS76, JY.Person[pid]["姓名"], JY.Wugong[JY.Person[pid]["武功" .. wugongnum]]["名称"]), C_ORANGE, CC.DefaultFont)
			ShowScreen()
			lib.Delay(200)
			Cls()
			ShowScreen()
	       
			--练到极+1四维
			local tmpwugong=JY.Person[pid]["武功" .. wugongnum]
			if yongquan(wugong) then
				AddPersonAttrib(pid, "拳掌功夫", 1)
			elseif yongjian(wugong) then
				AddPersonAttrib(pid, "御剑能力", 1)
			elseif yongdao(wugong) then
				AddPersonAttrib(pid, "耍刀技巧", 1)
			elseif yongte(wugong) then
				AddPersonAttrib(pid, "特殊兵器", 1)
			elseif yongan(wugong) then
				AddPersonAttrib(pid, "暗器技巧", 1)	
			end

            --阴阳捣乱刃到极，御剑耍刀各上升30点	       
			if wugong == 77 then
				if (wglw1(pid,77) or ((DT(pid,605) or DT(pid,627))and JX(pid))) then
					say("剑转刀、刀转剑...，奇思妙想阿...", pid);
					ShowScreen()
					AddPersonAttrib(pid, "御剑能力", 100)
					AddPersonAttrib(pid, "耍刀技巧", 100)
					QZXS(JY.Person[pid]["姓名"].."刀剑属性各上升100点！")
				else	
					say("这一刀一剑的功夫好神奇....", pid);
					ShowScreen()
					AddPersonAttrib(pid, "御剑能力", 30)
					AddPersonAttrib(pid, "耍刀技巧", 30)
					QZXS(JY.Person[pid]["姓名"].."刀剑属性各上升30点！")
				end	
			end
		
			if wugong == 155 then	--五指秘刀增加拳法
			    say("刀中含拳，有意思....", pid);
				ShowScreen()
				AddPersonAttrib(pid, "拳掌功夫", 50)
			    QZXS(JY.Person[pid]["姓名"].."拳掌上升50点")
			end

			--石破天 太玄神功为极，增加轻功50
			if pid == 38 and JY.Person[pid]["武功" .. wugongnum] == 102 then
				say(CC.say2, 38)
				DrawStrBoxWaitKey(CC.say3, C_ORANGE, CC.DefaultFont)
				ShowScreen()
				AddPersonAttrib(pid, "轻功", 50)
				AddPersonAttrib(pid, "拳掌功夫", 150)
				AddPersonAttrib(pid, "御剑能力", 150)
				AddPersonAttrib(pid, "耍刀技巧", 100)
				AddPersonAttrib(pid, "特殊兵器", 100)
				AddPersonAttrib(pid, "暗器技巧", 100)
				QZXS(JY.Person[pid]["姓名"].."全系数上升!")
			end
			
			if (wglw(pid,102) or T5BCF(pid)) and wugong == 102 then
				say("这太玄经不愧为旷世绝学啊！", pid);
				ShowScreen()
				AddPersonAttrib(pid, "拳掌功夫", 150)
				AddPersonAttrib(pid, "御剑能力", 150)
				AddPersonAttrib(pid, "耍刀技巧", 100)
				AddPersonAttrib(pid, "特殊兵器", 100)
				AddPersonAttrib(pid, "暗器技巧", 100)
				QZXS(JY.Person[pid]["姓名"].."全系数上升!")
			end	
            
			if wugong == 17 and wglw1(pid,17) then	--领悟一阳指增加拳法系数
			    say("原来一阳指如此神妙!!!", pid);
				ShowScreen()
				AddPersonAttrib(pid, "拳掌功夫", 150)
			    QZXS(JY.Person[pid]["姓名"].."拳掌系数上升150点")
			end	

			if wugong == 67 and wglw1(pid,67) then	--胡刀加耍刀技巧
			    say("胡大哥家的刀法真的太有意思了!!!", pid);
				ShowScreen()
				AddPersonAttrib(pid, "耍刀技巧", 200)
			    QZXS(JY.Person[pid]["姓名"].."耍刀技巧上升200点")
			end
		
            if wugong == 11 and wglw1(pid,11) then	--领悟摧坚神爪增加拳法系数
			    say("九阴真经的武学真是高深莫测!!!", pid);
				ShowScreen()
				AddPersonAttrib(pid, "拳掌功夫", 150)
			    QZXS(JY.Person[pid]["姓名"].."拳掌功夫上升150点")
			end			
		
            if wugong == 42 and wglw1(pid,42) then	--领悟玉女剑法增加御剑系数
			    say("古墓剑法如此精妙!!!", pid);
				ShowScreen()
				AddPersonAttrib(pid, "御剑能力", 100)
			    QZXS(JY.Person[pid]["姓名"].."御剑能力上升100点")
			end				
		
			--石破天 太玄神功为极，增加轻功50
	       
			--狄云 神照功为极，增加轻功25点
			if pid == 37 and JY.Person[pid]["武功" .. wugongnum] == 94 then
				say(CC.LTalk88, 37)
				--DrawStrBoxWaitKey(CC.LTalk89, C_ORANGE, CC.DefaultFont)
				DrawStrBoxWaitKey( "狄云领悟神照经的真髓!", C_ORANGE, CC.DefaultFont)		 
				ShowScreen()
				AddPersonAttrib(pid, "轻功", 25)
				setJX(pid)
			end
	       
			if pid == 61 and wugong == 9 then	--欧阳克重练灵蛇拳
				say("这功夫好熟悉....", 61);
				DrawStrBoxWaitKey("欧阳克攻轻各上升20点 拳掌上升100点", C_ORANGE, CC.DefaultFont)
				AddPersonAttrib(pid, "攻击力", 20)
				AddPersonAttrib(pid, "轻功", 20)
				AddPersonAttrib(pid, "拳掌功夫", 100)
				setJX(61)
				QZXS("欧阳克觉醒灵蛇拳奥义！")
				if GetS(113,0,0,0) == 0 then
					if JY.Person[0]["性别"] == 0 then
					say("(...那个所谓「大哥」带我回来之后，对我也不错...)", 61);
					say("大哥，我想起了一些这套蛇拳的法诀", 61);
					say("就告诉大哥当作近日来照顾我的回报吧", 61);
					end
					if DrawStrBoxYesNo(-1, -1, "要听么？", C_WHITE, 30) == true then
						QZXS("学会灵蛇拳奥义！")
						SetS(113,0,0,0,9)
						say("多谢欧阳贤弟了", 0);
					else
						say("（我脸皮可没这么厚...）", 0);
						say("多谢贤弟美意，但我想算了吧", 0);
						say("好", 61);
					end
				end	
			end	
            
            if pid == 582 and wugong == 58 and PersonKF(pid,57) then --木婉清双刀到极
               say("善恶一念间..",582)
               DrawStrBoxWaitKey("木婉清三维提升200点，耍刀提升100点", C_ORANGE, CC.DefaultFont)
               AddPersonAttrib(pid, "攻击力", 200)
			   AddPersonAttrib(pid, "轻功", 200)
			   AddPersonAttrib(pid, "防御力", 200)
               AddPersonAttrib(pid, "耍刀技巧", 100)
               setJX(582)
               QZXS("修罗再临")
               if GetS(113,0,0,0) == 0 then
               	if JY.Person[0]["耍刀技巧"] > 350 then	
                   say("(渡人不如渡己，修罗也可成佛，你要试试么？)", 582);
				if DrawStrBoxYesNo(-1, -1, "试试看？", C_WHITE, 30) == true then
				   QZXS("领悟修罗刀！")
				   SetS(113,0,0,0,58)
				   say("我好像懂了。。");
				else
				   say("婉妹？",0);
				   say("没事。",582);
				end
				end
				end
			end
				   			
			if pid == 9 and wugong == 93 then
				say("这波斯明教的神功果然厉害", 9);
				DrawStrBoxWaitKey("张无忌轻功上升30点", C_ORANGE, CC.DefaultFont)
				DrawStrBoxWaitKey("张无忌奇门上升30点", C_ORANGE, CC.DefaultFont)
				ShowScreen()
				AddPersonAttrib(pid, "轻功", 30)
				AddPersonAttrib(pid, "特殊兵器", 30)
			end						
		
			--胡斐，胡家刀法到极，增加60点耍刀技巧
			if pid == 1 and wugong == 67 then
				say("刀法真是越练越精妙", 1);
				DrawStrBoxWaitKey("胡斐耍刀技巧增加50点", C_ORANGE, CC.DefaultFont)
				ShowScreen()
				AddPersonAttrib(pid, "耍刀技巧", 50)
				if sixi(pid,3)>=250 then
				say("终于领悟了刀法的精要", 1);
				DrawStrBoxWaitKey("胡斐觉醒了战技.一刀", C_ORANGE, CC.DefaultFont)
				setJX(pid)
				end
			end
			
			--杨过，独孤九剑到极后，将玄铁剑法练到极，觉醒战意技
           if pid == 58 and wugong == 45 then
               for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
                   if JY.Person[pid]["武功" .. i] == 47 and JY.Person[pid]["武功等级" .. i] >= 999 then
        	       say("独孤前辈的绝学真是高深莫测啊", 1);
				   DrawStrBoxWaitKey("杨过御剑能力增加50点", C_ORANGE, CC.DefaultFont)
				   ShowScreen()
				   AddPersonAttrib(pid, "御剑能力", 50)
				   say("原来这就是举轻若重", 58);
				   DrawStrBoxWaitKey("杨过觉醒了战技.玄铁九剑", C_ORANGE, CC.DefaultFont)
				   setJX(pid)    
                   end
               end
           end
		   
		   if pid == 58 and wugong == 47 then
               for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
                   if JY.Person[pid]["武功" .. i] == 45 and JY.Person[pid]["武功等级" .. i] >= 999 then
        	       say("独孤前辈的绝学真是高深莫测啊", 1);
				   DrawStrBoxWaitKey("杨过御剑能力增加50点", C_ORANGE, CC.DefaultFont)
				   ShowScreen()
				   AddPersonAttrib(pid, "御剑能力", 50)
				   say("原来这就是举重若轻", 58);
				   DrawStrBoxWaitKey("杨过觉醒了战技.玄铁九剑", C_ORANGE, CC.DefaultFont)
				   setJX(pid)    
                   end
               end
           end

			if pid == 161 and wugong == 3 and sixi(pid,1) >=100 and sixi(pid,5)>=200 then	--杨过，独孤九剑到极后，将玄铁剑法练到极，觉醒战意技
				for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
					if JY.Person[pid]["武功" .. i] == 170 and JY.Person[pid]["武功等级" .. i] >= 999 then
						say("赤练之名，将更无远弗届！", 161);
						DrawStrBoxWaitKey("李莫愁拳掌、暗器、用毒能力上限大增", C_ORANGE, CC.DefaultFont)
						AddPersonAttrib(pid, "拳掌功夫", 50)
						AddPersonAttrib(pid, "暗器技巧", 100)
						setJX(pid)    
					end
				end
			end
			
			if pid == 161 and wugong == 170 and sixi(pid,1) >=100 and sixi(pid,5)>=200 then	--杨过，独孤九剑到极后，将玄铁剑法练到极，觉醒战意技
				for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
					if JY.Person[pid]["武功" .. i] == 3 and JY.Person[pid]["武功等级" .. i] >= 999 then
						say("赤练之名，将更无远弗届！", 161);
						DrawStrBoxWaitKey("李莫愁拳掌、暗器、用毒能力上限大增", C_ORANGE, CC.DefaultFont)
						AddPersonAttrib(pid, "拳掌功夫", 50)
						AddPersonAttrib(pid, "暗器技巧", 100)
						setJX(pid)    
					end
				end
			end
		end
	elseif JY.Person[pid]["武功等级" .. wugongnum] >= 999 and WAR.HIT == 1 and WAR.ZDDH ~= 226 then
		local tmp3 = math.modf(JY.Person[pid]["资质"] / 25) + 1
		tmp3 = math.modf(3 * (tmp3 - 1))
		JY.Person[pid]["武功等级" .. wugongnum] = limitX(JY.Person[pid]["武功等级" .. wugongnum] + 2 + math.random(2) + tmp3, 1000, 32000)
	end
       
	--武功提升普通等级
	if level < 10 and level < math.modf(JY.Person[pid]["武功等级" .. wugongnum] / 100) + 1 then
		level = math.modf(JY.Person[pid]["武功等级" .. wugongnum] / 100) + 1
		DrawStrBox(-1, -1, string.format(CC.WARS77, JY.Wugong[JY.Person[pid]["武功" .. wugongnum]]["名称"], level), C_ORANGE, CC.DefaultFont)
		ShowScreen()
		lib.Delay(500)
		Cls()
		ShowScreen()
	end
    --end
	  
	--消耗的内力
	local nl = nil
	if JY.Person[pid]["武功" .. wugongnum] == 43 then    --斗转星移 消耗
		nl = math.modf((level + 3) / 2) * JY.Wugong[wugong]["消耗内力点数"]
		if DT(pid, 51) then    --慕容复消耗减半
			nl = math.modf(nl / 2)
		end
		if wglw1(pid, 43) then    --慕容复消耗减半
			nl = 0
		end
	else
		if inteam(pid) then
			nl = math.modf((level + 3) / 2) * JY.Wugong[wugong]["消耗内力点数"]
		else
			nl = math.modf((level + 3) / 4) * JY.Wugong[wugong]["消耗内力点数"]
		end
	end

	--纯阳无极功消耗内力减25%-50%
	if PersonGT(pid, 99) then
		nl = math.modf(nl*0.5);
	elseif PersonKF(pid, 99) then
		nl = math.modf(nl*0.75);
	end

	if pid == 0 and putong() == 1 and yongquan(wugong) then
		nl = math.modf(nl * (1 - math.min(0.5, sixi(0, 1)/1000)))
	end
	
    --瑜伽密乘消耗内力减少
	if PersonGT(pid, 184) then
		nl = math.modf(nl/4);
	elseif PersonKF(pid, 184) then
		nl = math.modf(nl/3);
	end	
	
	--蓝烟清：谢逊攻击，只消耗一半内力
	if DT(pid , 13) then
		nl = math.modf(nl/2);
	end

    --段思平消耗25%内力
	if DT(pid , 602) then
		nl = math.modf(nl/4);
	end

    --聂风魔心渡后内力消耗减少
    if NF(pid) and juexing() > 2 then
		nl = math.modf(nl/5);
	end

	--1-26-
	for i = 1, #CC.ZGT8 do
		if (CC.ZGT8[i][1] ==  WAR.HLTX or CC.ZGT8[i][2] ==  WAR.HLTX) and (wglw(pid,102) or (DT(pid,38) and PersonKF(pid,102))) then
			nl = math.modf(nl * (CC.ZGT8[i][3] / 100))
			break
		end
	end	
	--主功体减内力消耗
	for i = 1, #CC.ZGT8 do
		if (CC.ZGT8[i][1] == wugong or (T12YMZ(pid) and wugong == 112)) and (PersonGT(pid, CC.ZGT8[i][2]) or ((PersonGT(pid,9999) and (JY.Thing[224]["加攻击力"]) == CC.ZGT8[i][2] or JY.Thing[224]["加防御力"]) == CC.ZGT8[i][2])) then
			nl = math.modf(nl * (CC.ZGT8[i][3] / 100))
			break
		end
	end	
	--and (PersonGT(pid, CC.ZGT8[i][2]) or ((PersonGT(pid,9999) and (JY.Thing[224]["加攻击力"]) == CC.ZGT8[i][2] or JY.Thing[224]["加防御力"]) == CC.ZGT8[i][2])) then
     --天赋武功12.26
    for i,v in ipairs(CC.TFWG) do
    if ((v[1] == pid) or (v[1] == cxzj() and pid == 0)) and v[2] == wugong then
      nl = math.modf(nl/2)
	  break
    end
    end
    --天赋武功12.26
    if pid == 0 and (putong() > 0 or teshu() > 0) and wugong == GetS(112,1,0,0) then
	    nl = math.modf(nl/2)				
    end--12.26
    if pid == 0 and (putong() > 0 or teshu() > 0) and wugong == GetS(112,4,0,0) then
	    nl = math.modf(nl/2)				
    end
	if pid == 92 and wugong == JY.Person[578]["攻击力"] then 
	    nl = math.modf(nl/2)
    end
    --天赋武功12.26
    for i,v in ipairs(CC.TFWG1) do
      if ((v[1] == pid) or (v[1] == cxzj() and pid == 0)) and v[2] == wugong then
         nl = math.modf(nl/2)
	     break
      end
    end
    for i,v in ipairs(CC.TFNG) do
      if ((v[1] == pid) or (v[1] == cxzj() and pid == 0)) and v[2] == wugong then
         nl = math.modf(nl/2)
	     break
      end
    end
    for i,v in ipairs(CC.TFNG1) do
      if ((v[1] == pid) or (v[1] == cxzj() and pid == 0)) and v[2] == wugong then
         nl = math.modf(nl/2)
	     break
      end
    end
  
	--豸苗：折梅手
	for i = 1, #CC.ZGT8 do
	for l = 1,10 do
	local jl = 15 + math.modf(JY.Person[pid]["实战"] / 20)+ math.modf(JY.Person[pid]["武学常识"] / 10)
	    if wugong == 14 and (JLSD(0,5+jl,pid) or (MPPD(pid)==7 and JLSD(0,15,pid))) and JY.Person[pid]["内力"] >= 7000 then
	    if JY.Person[pid]["武功" .. l] == CC.ZGT8[i][1] then
			nl = math.modf(nl * (CC.ZGT8[i][3] / 100))
			WAR.ZMS = 1
			break
		end
		end
	end	
	end
	
	if WAR.ZBX[pid] ~= nil then --醉八仙内力*2
		nl = math.modf(nl * 2)
	end
	if MPPD(pid) == 3 then
		nl = math.modf(nl * 0.8) --古墓内力-20%
	end

	if hasTF(pid, 56) then
		nl = math.modf(nl * 0.8) 
	end		

	if hasTF(pid, 125) then
		nl = math.modf(nl * 1.5)
	end
	
	if MPPD(pid) == 6 and WAR.WSDL[pid] ~= nil then
		nl = math.modf(nl * 1.5)
	end	
	
	if wugong == 83 and wglw1(pid,83) then
		nl = math.modf(nl * 3)
	end
	
	if wglw1(pid,18) and WAR.TZQJ2[pid] ~= nil then
		nl = 0
	end	
	
	AddPersonAttrib(pid, "内力", -(nl))    

    
    if JY.Person[pid]["内力"] < 0 then
      JY.Person[pid]["内力"] = 0
    end
    
    if JY.Person[pid]["生命"] <= 0 then
      break;
    end
    
  	DrawTimeBar2()
  	
  	--蓝烟清：独孤求败每次攻击之后X加1
  	if DT(pid , 592) then
	  	if WAR.L_DGQB_X >= 10 then
	  		WAR.L_DGQB_X = 1;
	  	else
	  		WAR.L_DGQB_X = WAR.L_DGQB_X + 1;
	  	end
  	end
	
    --[[if XYL(pid) then --豸苗：谢云流叠刃
   if WAR.L_HQJK == 1 then
   WAR.L_XYL_X = 1
   elseif WAR.L_DR == 1 then
   WAR.L_XYL_X = WAR.L_XYL_X + 1
   end
   end]]
    --豸苗：谢云流三环套月
    if XYL(pid) and WAR.XYLCZ == 2 then
       if WAR.BJ == 1 then 
	   WAR.SHTY = WAR.SHTY + 2
	   else
       WAR.SHTY = WAR.SHTY + 1
	   end
	   if WAR.SHTY > 5 then
	      WAR.SHTY = 5
	   end
    end	   
    if WAR.LW[pid] ~= nil and yongjian(wugong) then --豸苗：谢云流乱武--17-3-2--九龙功
	 if JLSD(10, 20 + MPDJ(pid) * 10, pid) or (XYL(pid) and JLSD(10,60,pid)) then
       fightnum = fightnum + 1
  	 end
	 if fightnum >= 6 then 
	   fightnum = 6
	 elseif fightnum < 3 then 
       	fightnum = 3 
	 end
	 if WAR.XYMJ1 == 1 or WAR.DZXY ~= 0 then 
       	fightnum = 1 
	 end
    end
  	--蓝烟清：使用非柔云剑法时，释放累加值
  	--if wugong ~= 36 and WAR.L_RYJF[pid] ~= nil then
  		--WAR.L_RYJF[pid] = 36;
		
  	--end
  	
  	--蓝烟清：五岳剑法 特效取消
  	--[[
  	if WAR.L_WYJFA ~= 0 then
  		if JLSD(20, 90, pid) then
  			WAR.L_WYJFA = wugong;
  		else
  			WAR.L_WYJFA = 0;
  		end
  	end]]
  	
    WAR.ACT = WAR.ACT + 1   --统计攻击次数累加1
    WAR.YDLLJ = WAR.YDLLJ + 1
  	--蓝烟清：攻击范围内的敌人全部死亡时取消连击
  	local flag = 0;
  	local n = 0;
    for i = 0, CC.WarWidth - 1 do
      for j = 0, CC.WarHeight - 1 do
        local effect = GetWarMap(i, j, 4)
        if 0 < effect then
			local emeny = GetWarMap(i, j, 2)
			if 0 <= emeny and WAR.Person[id]["我方"] ~= WAR.Person[emeny]["我方"] then
				n = n + 1;
				if JY.Person[WAR.Person[emeny]["人物编号"]]["生命"] > 0 then
					flag = 1;
				end
			end
    	end
	  end
    end
    
    if flag == 0 and n > 0 then
    	break;
    end
    end
    WAR.WAWY2 = 0

	--蓝烟清：五岳剑法 特效取消
	--WAR.L_WYJFA = 0;
  
    --计算消耗的体力
    local jtl = 0
    if 1100 <= WAR.WGWL then
       jtl = 7 + math.random(2)
    elseif 900 <= WAR.WGWL then
       jtl = 5 + math.random(2)
    elseif 600 <= WAR.WGWL then
       jtl = 3 + math.random(2)
    else
       jtl = 1 + math.random(2)
    end
    --豸苗：北丐
	if DT(pid,69) and (wugong == 26 or wugong == 80) then 
	   jtl = jtl - 4
	end
	if PersonGT(pid, 108) then --易筋主功体消耗体力-5
		jtl = jtl - 5
	end
	
	if PersonGT(pid, 105) then --葵花主功体消耗体力-5
		jtl = jtl - 5
	end	
	
	if PersonGT(pid, 150) then --金关主功体消耗体力-4
		jtl = jtl - 4
	elseif PersonKF(pid, 150) then
		jtl = jtl - 2
	end		
	
	if PersonGT(pid, 98) then --小无相主功体消耗体力-2-4
		jtl = jtl - 4
	elseif PersonKF(pid, 98) then
		jtl = jtl - 2
	end
	
	if PersonGT(pid, 121) then --玉女主功体消耗体力-2
		jtl = jtl - 2
	end	
	
    if PersonGT(pid, 183) then --洗髓主功体消耗体力
		jtl = jtl - 8
	elseif PersonKF(pid, 183) then
		jtl = jtl - 5
	end	
	
	if DT(pid, 12) then
		jtl = jtl + 3
	end
    --天赋武功12.26
    for i,v in ipairs(CC.TFWG) do
      if ((v[1] == pid) or (v[1] == cxzj() and pid == 0)) and v[2] == wugong then
         jtl = jtl - 3
	     break
      end
    end
    if wglw(pid,592) and (wugong == 45 or wugong == 47) then 
	     jtl = jtl - 3					
    end
    --天赋武功12.26
    if pid == 0 and (putong() > 0 or teshu() > 0) and wugong == GetS(112,1,0,0) then
	   jtl = jtl - 3				
    end--12.26
    --天赋武功12.26
    if pid == 0 and (putong() > 0 or teshu() > 0) and wugong == GetS(112,2,0,0) then
	   jtl = jtl - 3
    end	  
    if pid == 0 and (putong() > 0 or teshu() > 0) and wugong == GetS(112,4,0,0) then
	   jtl = jtl - 3				
    end
	if pid == 92 and wugong == JY.Person[578]["攻击力"] then
	   jtl = jtl - 3
    end
    --天赋武功12.26
    for i,v in ipairs(CC.TFWG1) do
      if ((v[1] == pid) or (v[1] == cxzj() and pid == 0)) and v[2] == wugong then
         jtl = jtl - 3
	     break
      end
    end
    for i,v in ipairs(CC.TFNG) do
      if ((v[1] == pid) or (v[1] == cxzj() and pid == 0)) and v[2] == wugong then
         jtl = jtl - 3
	     break
      end
    end
    for i,v in ipairs(CC.TFNG1) do
      if ((v[1] == pid) or (v[1] == cxzj() and pid == 0)) and v[2] == wugong then
        jtl = jtl - 3
	    break
      end
    end
	
	if jtl <= 0 then jtl = 1 end --最少消耗体力1
    --人厨子
    if DT(pid , 89) then
   	--人厨子攻击不消耗体力
    elseif wglw(pid,90) then 
  
    elseif wglw1(pid,33) then 
  
    else
  	if WAR.Person[WAR.CurID]["我方"] then
    	if WAR.DZXYLV[pid]~=nil then --斗转反击体力消耗减半
			AddPersonAttrib(pid, "体力", math.modf(jtl/2))
			if wglw1(pid,43) or DT(pid,108) then
			AddPersonAttrib(pid, "体力", math.modf(jtl/2))
			end
		else 
           AddPersonAttrib(pid, "体力", -(jtl))		
		end
    	--被太玄神功攻击后，体力消耗加倍
 			--[[if WAR.L_TXSG[pid] ~= nil then
 				AddPersonAttrib(pid, "体力", -(jtl));
 				WAR.L_TXSG[pid] = nil;
				    if WAR.DZXYLV[pid]~=nil then
						AddPersonAttrib(pid, "体力", math.modf(jtl/2))
					end
 			end]]
  	else
    	AddPersonAttrib(pid, "体力", -math.modf(jtl/2));
    	--[[if WAR.DZXYLV[pid]~=nil then --斗转反击体力消耗减半
			AddPersonAttrib(pid, "体力", math.modf(jtl/4))
		end		]]
    	--被太玄神功攻击后，体力消耗加倍
 			--[[if WAR.L_TXSG[pid] ~= nil then
 				AddPersonAttrib(pid, "体力", -math.modf(jtl/2));
 				WAR.L_TXSG[pid] = nil;
				-if WAR.DZXYLV[pid]~=nil then --斗转反击体力消耗减半
					AddPersonAttrib(pid, "体力", math.modf(jtl/4))
				end				
 			end]]
  	end
    end
    
    --斗转星移计算
    local dz = {}
    local dznum = 0
    for i = 0, WAR.PersonNum - 1 do
    if WAR.Person[i]["反击武功"] ~= -1 and WAR.Person[i]["反击武功"] ~= 9999 then
      dznum = dznum + 1
      dz[dznum] = {i, WAR.Person[i]["反击武功"], x - WAR.Person[WAR.CurID]["坐标X"], y - WAR.Person[WAR.CurID]["坐标Y"]}
      WAR.Person[i]["反击武功"] = 9999
    end
    end
    for i = 1, dznum do
    local tmp = WAR.CurID
    WAR.CurID = dz[i][1]
    WAR.DZXY = 1
    
    if WAR.DZXYLV[WAR.Person[WAR.CurID]["人物编号"]] == 1 then
      WAR.DZXYLV[WAR.Person[WAR.CurID]["人物编号"]] = 60
    elseif WAR.DZXYLV[WAR.Person[WAR.CurID]["人物编号"]] == 2 then
        WAR.DZXYLV[WAR.Person[WAR.CurID]["人物编号"]] = 85
    elseif WAR.DZXYLV[WAR.Person[WAR.CurID]["人物编号"]] == 3 then
        WAR.DZXYLV[WAR.Person[WAR.CurID]["人物编号"]] = 110
    end
    
	if WAR.DZXYLV[WAR.Person[WAR.CurID]["人物编号"]] ~= nil then
		if DT3(WAR.Person[dz[i][1]]["人物编号"],51) and inteam(51) and WAR.HMXC > 0 then
			War_Fight_Sub(dz[i][1], dz[i][2] + 100, dz[i][3], dz[1][4])
		elseif ((DT(WAR.Person[dz[i][1]]["人物编号"],51) and inteam(51)) or  
			(douzhuankekong(WAR.Person[dz[i][1]]["人物编号"]))) and WAR.AutoFight == 0 then --慕容可控，主角观武后可控
			War_Fight_Sub(dz[i][1], dz[i][2] + 100)
		else
			War_Fight_Sub(dz[i][1], dz[i][2] + 100, dz[i][3], dz[1][4])
		end
	end
	
    WAR.Person[WAR.CurID]["反击武功"] = -1
    WAR.DZXYLV[WAR.Person[WAR.CurID]["人物编号"]] = nil
    WAR.CurID = tmp
    WAR.DZXY = 0
    end
      
    for i = 0, WAR.PersonNum - 1 do
    local tmppid = WAR.Person[i]["人物编号"]
	
	--飞影彩蛋：真龙心法【真龙・逆鳞】反击显示
		if WAR.DWRY ~= 1 then	
			if WAR.CLFJ[tmppid] ~= nil and JY.ZLXF == 1 then
				if JY.Person[tmppid]["生命"] > 0 then
					local tmp = WAR.CurID
					lib.Delay(50)
					WAR.CurID = i
					WAR.Person[i]["真伤点数"] = (WAR.Person[i]["真伤点数"] or 0) + AddPersonAttrib(tmppid, "生命", 100);
					WAR.Person[i]["内力点数"] = (WAR.Person[i]["内力点数"] or 0) + AddPersonAttrib(tmppid, "内力", 1000);
					WAR.Person[i]["体力点数"] = (WAR.Person[i]["体力点数"] or 0) + AddPersonAttrib(tmppid, "体力", 10);
					WAR.Person[i]["受伤点数"] = (WAR.Person[i]["受伤点数"] or 0) + AddPersonAttrib(tmppid, "受伤程度", -50);
					if MPPD(tmppid) ~= 1 and MPPD(tmppid) ~= 8 then
						WAR.Person[i]["中毒点数"] = (WAR.Person[i]["中毒点数"] or 0) + AddPersonAttrib(tmppid, "中毒程度", -50)
					end
					if WAR.LQZ[tmppid] ~= nil and WAR.LQZ[tmppid] < 100 then
						WAR.LQZ[tmppid] = 99
					end
					DIYdisplay("真龙・逆鳞")
					lib.Delay(100)
					War_ExecuteMenu_Sub(WAR.CLFJ[tmppid][2], WAR.CLFJ[tmppid][3], 4, 32)
					WAR.CLFJ[tmppid] = nil
					WAR.CurID = tmp
				else
					WAR.CLFJ[tmppid] = nil
				end
			end
			
			if WAR.XYFJ[tmppid] ~= nil then --雪饮反击
				if JY.Person[tmppid]["生命"] > 0 then
					local tmp = WAR.CurID
					lib.Delay(50)
					WAR.CurID = i		
					DIYdisplay("刀气反击・雪饮封寒")
					lib.Delay(150)
					War_ExecuteMenu_Sub(WAR.XYFJ[tmppid][2], WAR.XYFJ[tmppid][3], 4, 33)
					WAR.XYFJ[tmppid] = nil
					WAR.CurID = tmp
				else
					WAR.XYFJ[tmppid] = nil
				end
			end		
			
			if WAR.WQYJ[tmppid] ~= nil then --无求易诀
				if JY.Person[tmppid]["生命"] > 0 then
					local tmp = WAR.CurID
					lib.Delay(50)
					WAR.CurID = i		
					DIYdisplay("无求易诀・斗转星移")
					lib.Delay(150)
					War_ExecuteMenu_Sub(WAR.WQYJ[tmppid][2], WAR.WQYJ[tmppid][3], 4, 33)
					WAR.WQYJ[tmppid] = nil
					WAR.CurID = tmp
				else
					WAR.WQYJ[tmppid] = nil
				end
			end		
			
            if WAR.SLFJ[tmppid] ~= nil then --森罗反击
				if JY.Person[tmppid]["生命"] > 0 then
					local tmp = WAR.CurID
					lib.Delay(50)
					WAR.CurID = i
					DIYdisplay("万道森罗・戒守之道")		
					lib.Delay(150)
					War_ExecuteMenu_Sub(WAR.SLFJ[tmppid][2], WAR.SLFJ[tmppid][3], 4, 33)
					WAR.SLFJ[tmppid] = nil
					WAR.CurID = tmppid
				else
					WAR.SLFJ[tmppid] = nil
				end
			end 		
			
			if WAR.DGFJ[tmppid] ~= nil then	
				if JY.Person[tmppid]["生命"] > 0 then
					local tmp = WAR.CurID
					lib.Delay(50)
					WAR.CurID = i		
					DIYdisplay("后发先至")
					lib.Delay(150)
					War_ExecuteMenu_Sub(WAR.DGFJ[tmppid][2], WAR.DGFJ[tmppid][3], 4, 33)
					WAR.DGFJ[tmppid] = nil
					WAR.CurID = tmp
				else
					WAR.DGFJ[tmppid] = nil
				end
			end		
			
			if WAR.YFZ[tmppid] ~= nil then
				if JY.Person[tmppid]["生命"] > 0 then
					local tmp = WAR.CurID
					lib.Delay(50)
					WAR.CurID = i		
					DIYdisplay("玉蜂针・反击")
					lib.Delay(100)
					War_ExecuteMenu_Sub(WAR.YFZ[tmppid][2], WAR.YFZ[tmppid][3], 4, 33)
					WAR.YFZ[tmppid] = nil
					WAR.CurID = tmp
				else
					WAR.YFZ[tmppid] = nil
				end
			end
			
			if WAR.FGYJ[tmppid] ~= nil then
				if JY.Person[tmppid]["生命"] > 0 then
					local tmp = WAR.CurID
					lib.Delay(50)
					WAR.CurID = i		
					DIYdisplay("反戈一击")
					lib.Delay(100)
					War_ExecuteMenu_Sub(WAR.FGYJ[tmppid][2], WAR.FGYJ[tmppid][3], 4, 33)
					WAR.FGYJ[tmppid] = nil
					WAR.CurID = tmp
				else
					WAR.FGYJ[tmppid] = nil
				end
			end	
			
			if WAR.KHFJ[tmppid] ~= nil then
				if JY.Person[tmppid]["生命"] > 0 then
					local tmp = WAR.CurID
					lib.Delay(50)
					WAR.CurID = i		
					DIYdisplay("无影神针")
					lib.Delay(100)
					War_ExecuteMenu_Sub(WAR.KHFJ[tmppid][2], WAR.KHFJ[tmppid][3], 4, 33)
					WAR.KHFJ[tmppid] = nil
					WAR.CurID = tmp
				else
					WAR.KHFJ[tmppid] = nil
				end
			end	
			
			if WAR.BHFJ[tmppid] ~= nil then--沼跃鱼：白虎斗气反击
				if JY.Person[tmppid]["生命"] > 0 then
					local tmp = WAR.CurID
					lib.Delay(50)
					WAR.CurID = i		
					DIYdisplay("白虎斗气・睚眦必报")
					lib.Delay(100)
					War_ExecuteMenu_Sub(WAR.BHFJ[tmppid][2], WAR.BHFJ[tmppid][3], 4, 33)
					WAR.BHFJ[tmppid] = nil
					WAR.CurID = tmp
				else
					WAR.BHFJ[tmppid] = nil
				end
			end
			
			if WAR.TM[tmppid] ~= nil then --唐门反击
				if JY.Person[tmppid]["生命"] > 0 then
					local tmp = WAR.CurID
					local aq = randomanqi()
					lib.Delay(50)
					WAR.CurID = i		
					DIYdisplay("器绝十方・"..JY.Thing[aq]["名称"])
					lib.Delay(150)
					War_ExecuteMenu(4, aq)
					WAR.TM[tmppid] = nil
					WAR.CurID = tmp
				else
					WAR.TM[tmppid] = nil
				end
			end	
		end	
    end 
	    
    --水镜四奇发动云体风身
    if WAR.YTFS == -1 then
       for i = 0, WAR.PersonNum - 1 do
           if (WAR.Person[i]["人物编号"] == 0 and T2SQ(WAR.Person[i]["人物编号"])) or DT(WAR.Person[i]["人物编号"], 662) then
           local tmp = WAR.CurID
              WAR.CurID = i
              WAR.SQFJ = 1
              WAR.YTFS = 0
              WarDrawMap(0)
              CurIDTXDH(i, 1209, 1224)
              CurIDTXDH(i, 1186, 1191)
              Cls()
              lib.PicLoadCache(91, 14, 150, -1, 1)
              ShowScreen()
              lib.Delay(500)
            for ii = 12, 24 do
                NewDrawString(-1, -1, CC.WARS78, C_GOLD, 25 + ii)
                ShowScreen()
                if ii == 24 then
                   Cls()
                   NewDrawString(-1, -1, CC.WARS78, C_GOLD, 25 + ii)
                   ShowScreen()
                   lib.Delay(500)
                else
                   lib.Delay(1)
                end
            end
        
        --云体风身反击
        War_Fight_Sub(i, 2, WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"])
       
	   if WAR.YTFS1<9 then--沼跃鱼：云体冷却加速化
	   WAR.YTFS1 = WAR.YTFS1+1
	   end
	   
		if (WAR.Person[i]["人物编号"] == 0 and T2SQ(WAR.Person[i]["人物编号"])) and ZYBF(WAR.Person[i]["人物编号"])  then --沼跃鱼：云体战意下最大化
        WAR.YTFS1 = 9
		end
		
		WAR.YTFS = WAR.YTFS1*10
		WAR.SQFJ = 0
        --洗武功
		if T2SQ(WAR.Person[i]["人物编号"]) then
			for w = 1, 10 do
				if JY.Person[0]["武功" .. w] == JY.Person[0]["武功2"] and w ~= 2 then
					JY.Person[0]["武功2"] = WAR.YT1
					JY.Person[0]["武功等级2"] = WAR.YT2
				end
			end
        end
        WAR.CurID = tmp
      end
    end    
    end
  
    --豸苗：谢云流错步剑1-10-
    if WAR.XYMJ == -1 and WAR.SQFJ ~= 1 then
    for i = 0, WAR.PersonNum - 1 do
      if WAR.Person[i]["人物编号"] == 0 and XYL(WAR.Person[i]["人物编号"]) and JY.Person[WAR.Person[i]["人物编号"]]["生命"] > 0 then
        local tmp = WAR.CurID
        WAR.CurID = i
        WAR.SQFJ = 1
        WAR.XYMJ = 0
		WAR.XYMJ1 = 1
		
        WarDrawMap(0)
        CurIDTXDH(i, 2197, 2208)
        CurIDTXDH(i, 2209, 2219)     
        --错步剑反击
		    local n = 1
		    for w = 1, 10 do
			    if XYL(WAR.Person[i]["人物编号"]) and JY.Person[0]["武功" .. w] == 131 then
				n = w
				end
			end	
        War_Fight_Sub(i, n, WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"])
		WAR.SQFJ = 0
		WAR.XYMJ1 = 0
      end
    end    
    end

    if WAR.GBWZ1==-1 and WAR.SQFJ ~= 1 then
    for i = 0, WAR.PersonNum - 1 do
      if DT(WAR.Person[i]["人物编号"],517) and JY.Person[WAR.Person[i]["人物编号"]]["生命"] > 0 then
		local tmp = WAR.CurID
        WAR.CurID = i
        WAR.SQFJ = 1
		WAR.GBWZ1=0
        WarDrawMap(0)
        CurIDTXDH(i, 2197, 2208)
        CurIDTXDH(i, 2209, 2219)     
        --错步剑反击
		    local n = 1
		    for w = 1, 12 do
			    if DT(WAR.Person[i]["人物编号"],517) and JY.Person[WAR.Person[i]["人物编号"]]["武功" .. w] == 110 then
				n = w
				end
			end	
        War_Fight_Sub(i, n, WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"])
		WAR.SQFJ = 0
		WAR.CurID = tmp
      end
    end
    end
  
    if WAR.SHITOUFJ == -1 and WAR.SQFJ ~= 1 then
 
	 for i = 0, WAR.PersonNum - 1 do
      if WAR.Person[i]["人物编号"] == 0 and T4WXS(WAR.Person[i]["人物编号"]) and JY.Person[WAR.Person[i]["人物编号"]]["生命"] > 0 then
		local tmp = WAR.CurID
        WAR.CurID = i
        WAR.SQFJ = 1
		WAR.SHITOUFJ =0
		WAR.SHITOUJY=math.random(2,3)
        WarDrawMap(0)
        CurIDTXDH(i, 2197, 2208)
        CurIDTXDH(i, 2209, 2219)     
        --刀剑逆杀
			local n = 1
		    for w = 1, 12 do
			    if T4WXS(WAR.Person[i]["人物编号"]) and (yongjian(JY.Person[0]["武功" .. w]) or yongdao(JY.Person[0]["武功" .. w]))  then
				n = w
				end
			end	
		 War_Fight_Sub(i, 1, WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"])
		
		WAR.SQFJ = 0
		WAR.CurID = tmp
      end
    end   
    end

    --料敌先机
    if WAR.JJWS == -1 and WAR.SQFJ ~= 1 then	
        for i = 0, WAR.PersonNum - 1 do
            if wglw1(WAR.Person[i]["人物编号"],47) and JY.Person[WAR.Person[i]["人物编号"]]["生命"] > 0 then
                local tmp = WAR.CurID
                WAR.CurID = i
                WAR.SQFJ = 1
                WAR.DGJJ_LDXJ = 0
		        WAR.JJWS = 1
                WarDrawMap(0)
                CurIDTXDH(i, 1313, 1325)
                CurIDTXDH(i, 1327, 1341)     
                --九剑反击
		        local n = 1
		        for w = 1, 10 do
			        if wglw1(WAR.Person[i]["人物编号"],47) and JY.Person[0]["武功" .. w] == 47 then
				        n = w
				    end
			    end	
                War_Fight_Sub(i, n, WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"])
		        WAR.SQFJ = 0
		        WAR.JJWS = 0
            end
        end    
    end     

	if WAR.TQFJ == -1 and WAR.SQFJ ~= 1 then	
        for i = 0, WAR.PersonNum - 1 do
            if wglw1(WAR.Person[i]["人物编号"],16) and JY.Person[WAR.Person[i]["人物编号"]]["生命"] > 0 then
               local tmp = WAR.CurID
                WAR.CurID = i
                WAR.SQFJ = 1
                WarDrawMap(0)
		        local n = 1
		        for w = 1, 12 do
			        if wglw1(WAR.Person[i]["人物编号"],16) and JY.Person[0]["武功" .. w] == 16 then
				        n = w
				    end
			    end	
                War_Fight_Sub(i, n, WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"])
		        WAR.SQFJ = 0
				WAR.TQFJ = 0
				WAR.CurID = tmp
            end
        end    
    end

	if WAR.JSFJ == -1 and WAR.SQFJ ~= 1 then	
        for i = 0, WAR.PersonNum - 1 do
			local jsrw = WAR.Person[i]["人物编号"]
            if (wglw1(jsrw,40) or (DT(jsrw,91) and JX(jsrw)) or DT(jsrw,630)) and JY.Person[WAR.Person[i]["人物编号"]]["生命"] > 0 then
               local tmp = WAR.CurID
                WAR.CurID = i
                WAR.JSFJ = 2
                WarDrawMap(0)
		        local n = 1
		        for w = 1, 12 do
			        if wglw1(WAR.Person[i]["人物编号"],40) and JY.Person[0]["武功" .. w] == 40 then
				        n = w
				    end
			    end	
                War_Fight_Sub(i, n, WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"])
		        --WAR.SQFJ = 0
				WAR.JSFJ = 0
				WAR.CurID = tmp
            end
        end    
    end

    --武功位置移动
    --[[if wugongnum > 1 then
	local aa = JY.Person[pid]["武功" .. wugongnum]
	local bb = JY.Person[pid]["武功等级" .. wugongnum]
	for i = wugongnum, 2, -1 do
		JY.Person[pid]["武功" .. i] = JY.Person[pid]["武功" .. i - 1]
		JY.Person[pid]["武功等级" .. i] = JY.Person[pid]["武功等级" .. i - 1]
	end
	JY.Person[pid]["武功1"] = aa
	JY.Person[pid]["武功等级1"] = bb	
    end]]
  
    return 1;
end


function War_SelectMove()
    local x0 = WAR.Person[WAR.CurID]["坐标X"]
    local y0 = WAR.Person[WAR.CurID]["坐标Y"]
    local x = x0
    local y = y0
    while true do
    local x2 = x
    local y2 = y
    WarDrawMap(1, x, y)
    WarShowHead(GetWarMap(x, y, 2))
    ShowScreen()
    local key = WaitKey(1)
    if key == VK_UP then
      y2 = y - 1
    elseif key == VK_DOWN then
      y2 = y + 1
    elseif key == VK_LEFT then
      x2 = x - 1
    elseif key == VK_RIGHT then
      x2 = x + 1
    elseif key == VK_SPACE or key == VK_RETURN then
      return x, y
    elseif key == VK_ESCAPE then
      return nil
    elseif key > 999999 then
      local kind, mx, my = nil, nil, nil
      if key > 1999999 then
        kind = 1
        key = key - 2000000
      else
        kind = 0
        key = key - 1000000
      end
      mx = math.modf((key) / 1000)
      my = math.fmod(key, 1000)
      mx = mx - CC.ScreenW / 2
      my = my - CC.ScreenH / 2
      mx = (mx) / CC.XScale
      my = (my) / CC.YScale
      mx, my = (mx + my) / 2, (my - mx) / 2
      if mx > 0 then
        mx = mx + 0.99
      else
        mx = mx - 0.01
      end
      if my > 0 then
        my = my + 0.99
      else
        mx = mx - 0.01
      end
      mx = math.modf(mx)
      my = math.modf(my)
      for i = 0, 10 do
        if mx + i <= 63 then
          if my + i > 63 then
            break;
          end
        end
        local hb = GetS(JY.SubScene, x0 + mx + i, y0 + my + i, 4)
        if CONFIG.Zoom == 1 then
          hb = hb * 2
        end
        if math.abs(hb - CC.YScale * i * 2) < 5 then
          mx = mx + i
          my = my + i
        end
      end
      x2, y2 = mx + x0, my + y0
      
      if kind == 1 then
      	return x, y
    	end
    end
     
    if GetWarMap(x2, y2, 3) ~= nil then
		if GetWarMap(x2, y2, 3) < 128 then
			x = x2
			y = y2
		end
    end
    end
end

--获取武功最小内力
function War_GetMinNeiLi(pid)
    if JY.Person[pid]["武功1"] == 0 then return 0 end
    local minv = math.huge
    for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
    local tmpid = JY.Person[pid]["武功" .. i]
    if tmpid > 0 and JY.Wugong[tmpid]["消耗内力点数"] < minv then
      minv = JY.Wugong[tmpid]["消耗内力点数"]
    end
    end
    return minv
end

function War_Manual()
    local r = nil
    local tmppid = WAR.Person[WAR.CurID]["人物编号"]
    local x, y, move, pic = WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], WAR.Person[WAR.CurID]["移动步数"], WAR.Person[WAR.CurID]["贴图"]
    while true do
	  WAR.ShowHead = 1
	  if MPPD(tmppid) == 9 and WAR.TMMS[tmppid] == 2 then 
	  if WAR.ACSJ[100+tmppid] == nil or WAR.ACSJ[200+tmppid] == nil or WAR.ACSJ[300+tmppid] == nil then 
	  acsj()
	  end
	  if WAR.TMMS[400+tmppid] == nil then
      qjb()  
	  end
	  end
	  r = War_Manual_Sub()
	  if r == 1 or r == -1 then
	    WAR.Person[WAR.CurID]["移动步数"] = 0  
	  elseif r == 0 then
	    SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 2, -1)
	    SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 5, -1)
	    WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], WAR.Person[WAR.CurID]["移动步数"] = x, y, move
	    SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 2, WAR.CurID)
	    SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 5, pic)
	  elseif r == -12 and WAR.LQZ[tmppid] ~= nil and WAR.LQZ[tmppid] >= 100 then --主功体切换 武骧金星：只有暴怒时才不消耗回合
	
	  elseif r == -11 and (DT3(tmppid , 1) or DT3(tmppid , 91) or DT3(tmppid , 38) or DT3(tmppid , 662) or T5BCF(tmppid) or (T8LXY(tmppid) and WAR.LXYZLPD == 1)) then --指令
		
	  elseif r == -11 and WAR.JUNSHEN == 1 and T3XYK(tmppid) then	
		
	  elseif r == -13 and ownMP() and (DT3(tmppid, 1) or DT3(tmppid, 91) or DT3(tmppid, 38) or DT3(tmppid, 55)) then
	  
	  elseif r == 18 then
		local wife = 0
		for i = 0, WAR.PersonNum - 1 do
			if WAR.Person[i]["人物编号"] == 597 and WAR.Person[i]["死亡"] == false then
				wife = 1
				break
			end
		end
		if wife == 1 then
			WAR.ShowHead = 0
			say("我不是在了吗？",597,1)
		else
			WAR.ShowHead = 0
			local x = WAR.Person[WAR.CurID]["坐标X"]
			local y = WAR.Person[WAR.CurID]["坐标Y"]
			for j = 1, 5 do
				if GetWarMap(x + 1, y - 3 + j, 2) < 0 then
					NewWARPersonZJ(597, true, x + 1, y - 3 + j, false, 2)
					WAR.Person[WAR.PersonNum - 1].Time = 900
					local wy
					wy = WAR.CurID
					WAR.CurID = WAR.PersonNum - 1
					WarDrawMap(0)
					say("老公谁要伤你？我帮你打他。",597,1)
					WAR.CurID = wy
					WAR.WAWY = 1
					local t1 = 0
					local t2 = 597
					zhanyi(t1, 10, 1)
					zhanyi(t2, 10, 1)
					for j = 0, 10 do
						lib.GetKey()
						local str = JY.Person[t1]["姓名"].."＆"..JY.Person[t2]["姓名"].."    战意各自提升十点"
						local str2 = "惊鸿照影"
						Cls()
						DrawBox(150, CC.ScreenH / 3 + 30, CC.ScreenW - 150, CC.ScreenH / 3 * 2 - 20, C_BLACK)
						lib.PicLoadCache(1, gethead(t1) * 2, CC.ScreenW / 4 - 10, CC.ScreenH / 2 - 35, 1)
						lib.PicLoadCache(1, gethead(t2) * 2, CC.ScreenW / 4 + 90, CC.ScreenH / 2 - 35, 1)
						NewDrawString(-1, CC.ScreenH + 120, str, C_ORANGE, 25)	
						NewDrawString(CC.ScreenW / 2 * 3 - 150, -1, str2, C_GOLD, 50 + j)
						ShowScreen()							
						lib.Delay(30)	
					end		
					lib.Delay(300)	
					break
				end
			end
		end
	  else
		if r == -2 then
			WAR.HIDE[tmppid] = nil
		end
	  	break;
	  end
	  
	end
	WAR.ShowHead = 0
	WarDrawMap(0)
	return r
end
	      
--手动战斗菜单
function War_Manual_Sub()
    local pid = WAR.Person[WAR.CurID]["人物编号"]
    local isEsc = 0
    local warmenu = {}
	local function War_GongTiMenu ()
		local pid = WAR.Person[WAR.CurID]["人物编号"]
		Cls();
		DrawStrBox(CC.MainSubMenuX, CC.MainSubMenuY,"选择主功体", C_WHITE, CC.DefaultFont);
		local menu = {};
		local WGid
		for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
			WGid = JY.Person[pid]["武功"..i];
			if yongnei(WGid, 0) and WGid ~= 91 then	---显示内功
				if WGid == 106 and --九阳需阳性
					(JY.Person[pid]["内力性质"] == 1 or JY.Person[pid]["内力性质"] == 3) then
					menu[#menu + 1] = {JY.Wugong[WGid]["名称"],nil,1,WGid};
				elseif WGid == 107 and --九阴需阴性
					(JY.Person[pid]["内力性质"] == 0 or JY.Person[pid]["内力性质"] == 3) then
					menu[#menu + 1] = {JY.Wugong[WGid]["名称"],nil,1,WGid};
				elseif WGid ~= 106 and WGid ~= 107 then
					menu[#menu + 1] = {JY.Wugong[WGid]["名称"],nil,1,WGid};
				end
			end
		end
		if #menu == 0 then		
			QZXS("没有可用内功")
			return 0;
		end
		local r = ShowMenu(menu,table.getn(menu),0,CC.MainSubMenuX,CC.MainSubMenuY+CC.SingleLineHeight,0,0,1,1,CC.DefaultFont,C_ORANGE,C_WHITE);
		if r <= 0 then
			return 0
		end	

		JY.Person[pid]["声望"] = menu[r][4] --设置功体
		QZXS(JY.Person[pid]["姓名"].."的主功体设置为"..JY.Wugong[JY.Person[pid]["声望"]]["名称"])

		if twogt(pid) and #menu > 1 then
			Cls()
			DrawStrBox(CC.MainSubMenuX, CC.MainSubMenuY,"选择副功体", C_WHITE, CC.DefaultFont);
			menu = {};
			for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
				WGid = JY.Person[pid]["武功"..i];
				if yongnei(WGid, 0) and WGid ~= 91 and WGid ~= JY.Person[pid]["声望"] then	---显示内功
					if WGid == 106 and --九阳需阳性
						(JY.Person[pid]["内力性质"] == 1 or JY.Person[pid]["内力性质"] == 3) then
						menu[#menu + 1] = {JY.Wugong[WGid]["名称"],nil,1,WGid};
					elseif WGid == 107 and --九阴需阴性
						(JY.Person[pid]["内力性质"] == 0 or JY.Person[pid]["内力性质"] == 3) then
						menu[#menu + 1] = {JY.Wugong[WGid]["名称"],nil,1,WGid};
					else
						menu[#menu + 1] = {JY.Wugong[WGid]["名称"],nil,1,WGid};
					end
				end
			end	
			r = ShowMenu(menu,#menu,0,CC.MainSubMenuX,CC.MainSubMenuY+CC.SingleLineHeight,0,0,1,1,CC.DefaultFont,C_ORANGE,C_WHITE);
			if r <= 0 then
				return 0
			end	

			JY.Person[pid]["外号"] = menu[r][4] --设置功体
			QZXS("副功体设置为"..JY.Wugong[menu[r][4]]["名称"])

		end		
		WAR.GTMENU = 0 --一个回合只能换一次
		return 1
	end
    warmenu = {
    {"移动", War_MoveMenu, 1}, 
    {"攻击", DIY_War_FightMenu, 1}, 
    {"用毒", War_PoisonMenu, 1}, 
    {"解毒", War_DecPoisonMenu, 1}, 
    {"医疗", War_DoctorMenu, 1}, 
    {"物品", War_ThingMenu, 1}, 
    {"蓄力", War_ActupMenu, 1}, 
    {"防御", War_DefupMenu, 1}, 
    {"状态", War_StatusMenu, 1}, 
    {"休息", War_RestMenu, 1}, 
    {"特色", War_TgrtsMenu, 1}, 
    {"功体", War_GongTiMenu, WAR.GTMENU}, 
    {"门派", War_MPMenu, WAR.OWN}, 
    {"武学", War_WXMenu,1}, 
    {"自动", War_AutoMenu, 1},
    {"待机", War_Wait, 1}, --武骧金星：允许待机
    {"投降", War_Retreat, 1} --武骧金星：允许在战斗中投降
    }

    if pid == 0 and GetS(103, 0, 0, 1) == 455 then
	   warmenu[18]={"无忧", nil, 1}
    else
	   warmenu[18]={"无效", nil, 0}	
    end

    warmenu[19]={"外功", War_WGLW, 0} 		--19外功领悟指令
	---warmenu[20]={"换刀", War_ThingMenu1, 1}			--20胡刀领悟换刀指令
    --QZXS(tostring(WAR.GTMENU))
    --[[if WAR.GTMENU == 0 then
	   warmenu[12][3] = 0
    end]]
	
	if not inteam(pid) then
		warmenu[6][3] = 0
	end

    if WAR.TJZS[2000+pid] ~= nil then----
		warmenu[1][3] = 0
	end
	if MPPD(pid) == 0 then
		warmenu[13][3] = 0
	else
		local mptype = MPPD(pid)
		local mpdj = MPDJ(pid)
		if ownMP() and mptype == 63 then
			warmenu[13][1] = ownMPstat(1)[4]
			if mpdj < 3 then
				warmenu[13][3] = 0
			end
		else
			warmenu[13][1] = CC.MP[mptype][4]
		end
		if mpdj < 2 or JY.Person[pid]["体力"] <= 50 then
			warmenu[13][3] = 0
		end
		if mptype == 7 then
			if tianshu() < 7 or hasthing(66) == false then
				warmenu[13][3] = 0
			end
		end
	end
	
    if WAR.BZ[pid] ~= nil then
	   warmenu[2][3] = 0	
    end
  
    if WAR.TMT[pid] ~= nil then
  	   warmenu[2][3] = 0	
    end
	--特色指令
    if (pid ~= 0 and GRTS[pid] ~= nil) or (pid == 0 and GetS(103, 0, 0, 1) < 1) then
       warmenu[11][1] = GRTS[pid]
    elseif pid == 0 and GetS(103, 0, 0, 1) > 0 and GRTS[GetS(103, 0, 0, 1)] ~= nil then
       warmenu[11][1] = GRTS[GetS(103, 0, 0, 1)]
    else
       warmenu[11][3] = 0
    end
  
    --虚竹
    if CXTRT(pid, 49) then
    local t = 0
    for i = 0, WAR.PersonNum - 1 do
      local wid = WAR.Person[i]["人物编号"]
      if WAR.TZ_XZ_SSH[wid] == 1 and WAR.Person[i]["死亡"] == false then
        t = 1
      end
    end
    if t == 0 then
      warmenu[11][3] = 0
    end
    if JY.Person[pid]["体力"] < 20 then   --体力小于20不显示特色指令
    	warmenu[11][3] = 0
    end
    end
  
    if CXTRT(pid, 83) then --何铁手龙眠指令
    local yes = 0
    for i = 0, WAR.PersonNum - 1 do
		local wid = WAR.Person[i]["人物编号"]
        if WAR.Person[i]["我方"] == false and WAR.Person[i]["死亡"] == false 
			and RealJL(WAR.CurID, i, 4) and WAR.GUDUVICTIE[wid] == nil then
        yes = 1
		break
      end
    end
    if yes == 0 then
      warmenu[11][3] = 0
    end  
    if JY.Person[pid]["体力"] < 20 then   
    	warmenu[11][3] = 0
    end
    end
  
    if CXTRT(pid, 76) then --王语嫣点破指令
    local yes = 0
    for i = 0, WAR.PersonNum - 1 do
		local wid = WAR.Person[i]["人物编号"]
        if WAR.Person[i]["我方"] == false and WAR.Person[i]["死亡"] == false 
			and RealJL(WAR.CurID, i, 6) then
        yes = 1
		break
      end
    end
    if yes == 0 then
      warmenu[11][3] = 0
    end  
    if JY.Person[pid]["体力"] < 20 then   
    	warmenu[11][3] = 0
    end
    end 
  
    if CXTRT(pid, 90) then --钟灵灵貂指令
    if JY.Person[pid]["体力"] < 10 then
    	warmenu[11][3] = 0
    end	
    end
  
    if CXTRT(pid, 663) then --双儿刺杀指令
    if JY.Person[pid]["体力"] < 10 then
    	warmenu[11][3] = 0
    end	
    end 
  
    if CXTRT(pid, 72) then --田归农谗言指令
    if JY.Person[pid]["体力"] < 10 then
    	warmenu[11][3] = 0
    end	
    end 
  
    if CXTRT(pid, 11) then --杨逍乾坤指令
    if JY.Person[pid]["体力"] < 20 or JY.Person[pid]["内力"] < 1000 or WAR.YX > 0 then
    	warmenu[11][3] = 0
    end	
    end   
  
    --祖千秋
    if CXTRT(pid, 88) then
    local yes = 0
    for i = 0, WAR.PersonNum - 1 do
      if WAR.Person[i]["我方"] == true and WAR.Person[i]["死亡"] == false and RealJL(WAR.CurID, i, 5) and i ~= WAR.CurID then
        yes = 1
      end
    end
    if yes == 0 then
      warmenu[11][3] = 0
    end
    if JY.Person[pid]["体力"] < 10 then
    	warmenu[11][3] = 0
    end
    end
  
    --人厨子
    if CXTRT(pid, 89) then
    local px, py = WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"]
    local mxy = {
			{WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] + 1}, 
			{WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] - 1}, 
			{WAR.Person[WAR.CurID]["坐标X"] + 1, WAR.Person[WAR.CurID]["坐标Y"]}, 
			{WAR.Person[WAR.CurID]["坐标X"] - 1, WAR.Person[WAR.CurID]["坐标Y"]}}

    local yes = 0
    for i = 1, 4 do
      if GetWarMap(mxy[i][1], mxy[i][2], 2) >= 0 then
        local mid = GetWarMap(mxy[i][1], mxy[i][2], 2)
        if inteam(WAR.Person[mid]["人物编号"]) then
        	yes = 1
    		end
      end  
    end
    if yes == 0 then
      warmenu[11][3] = 0
    end
    if JY.Person[pid]["体力"] < 25 then
   		warmenu[11][3] = 0
   	end
    end

	--张无忌
    if CXTRT(pid, 9) then
    local yes = 0
    for i = 0, WAR.PersonNum - 1 do
      if WAR.Person[i]["我方"] == true and WAR.Person[i]["死亡"] == false and RealJL(WAR.CurID, i, 8) and i ~= WAR.CurID then
        yes = 1
      end
    end
    if yes == 0 then
      warmenu[11][3] = 0
    end
    if JY.Person[pid]["体力"] < 10 then
			warmenu[11][3] = 0
    end
    end
  
    --[[
    if pid == 9 and JY.Person[pid]["体力"] < 20 then
       warmenu[11][3] = 0
    end]]
  
    --蓝烟清：霍青桐统率指令
    if CXTRT(pid, 74) then
    if JY.Person[pid]["体力"] <= 10 then
    	warmenu[11][3] = 0
    end
    end
  
    --狄云神照指令
    if CXTRT(pid, 37) then
    if JY.Person[pid]["内力"] <= 2000 or WAR.DYWY[pid] == 1 then
    	warmenu[11][3] = 0
    end
    end  
  
    --慕容幻梦
    if CXTRT(pid, 51) then
    if JY.Person[pid]["内力"] <= 500 or JY.Person[pid]["体力"] <= 5 or WAR.HMXC > 0 then
    	warmenu[11][3] = 0
    end
    end    
  
    --袁承志虎乱
    if CXTRT(pid, 54) then
	if WAR.YCZHL[pid] ~= nil and WAR.YCZHL[pid] > 0 then
		warmenu[11][3] = 0
	end
    end
  
    --青青大暴指令
    if CXTRT(pid, 91) then
    if JY.Person[pid]["体力"] <= 20 or WAR.QQDB == 1 then
    	warmenu[11][3] = 0
    end
    end  
  
    --石破天飒行指令
    if CXTRT(pid, 38) then
    if JY.Person[pid]["体力"] <= 15 or WAR.SAXING ~= -1 then
    	warmenu[11][3] = 0
    end
    end  
  
    --胡斐飞狐指令
    if CXTRT(pid, 1) then
    if JY.Person[pid]["体力"] <= 10 or WAR.HUFEI == 1 then
    	warmenu[11][3] = 0
    end
    end  

    --水镜灵罡指令
    if CXTRT(pid, 662) then
    if WAR.LINGGANG == 1 then
    	warmenu[11][3] = 0
    end
    end   
  
    --郭靖灵罡指令
    if CXTRT(pid, 55) then
    if WAR.LINGGANG == 1 then
    	warmenu[11][3] = 0
    end
    end

    --黄蓉奇阵指令
    if CXTRT(pid, 56) then
    if JY.Person[pid]["体力"] <= 20 then
    	warmenu[11][3] = 0
    end
    end    
  
   --欧阳克蛇笛指令
    if CXTRT(pid, 61) then
    if JY.Person[pid]["体力"] <= 15 or WAR.SHEDI == 1 then
    	warmenu[11][3] = 0
    end
    end    
  
    --独孤求败 神雕指令
    if CXTRT(pid, 592) then
    if JY.Person[pid]["体力"] <= 15 or WAR.SHENDIAO == 1 then
    	warmenu[11][3] = 0
    end
    end    

    --殷离千蛛指令
    if CXTRT(pid, 631) then
    if JY.Person[pid]["体力"] <= 15 or WAR.QIANZHU == 1 then
    	warmenu[11][3] = 0
    end
    end

    --蓝凤凰金蟾指令
    if CXTRT(pid, 25) then
    if JY.Person[pid]["体力"] <= 15 or WAR.JINCHAN == 1 then
    	warmenu[11][3] = 0
    end
    end

    --郭靖灵雕指令
    if CXTRT(pid, 55) then
    if JY.Person[pid]["体力"] <= 15 or WAR.LINGDIAO == 1 then
    	warmenu[11][3] = 0
    end
    end
	
    --阿青心猿指令
    if CXTRT(pid, 614) then
    if JY.Person[pid]["体力"] <= 15 or WAR.XINYUAN == 1 then
    	warmenu[11][3] = 0
    end
    end	
	
    --岳老三鳄神指令
    if CXTRT(pid, 44) then
    if JY.Person[pid]["体力"] <= 15 or WAR.ESHEN == 1 then
    	warmenu[11][3] = 0
    end
    end		
  
    --龙女御蜂指令
    if CXTRT(pid, 59) then
    if JY.Person[pid]["体力"] <= 15 or WAR.YUFENG == 0 then
    	warmenu[11][3] = 0
    end
    end 

    --杨过机变指令
    if CXTRT(pid, 58) then
    if WAR.JIBIAN > 0 then
    	warmenu[11][3] = 0
    end
    end     
  
    --隼人森罗指令
    if CXTRT(pid, 583) then
    if WAR.SLZL > 0 then
    	warmenu[11][3] = 0
    end
    end  

    --张召重激励指令
    if CXTRT(pid, 80) then
    if JY.Person[pid]["体力"] <= 15 then
    	warmenu[11][3] = 0
    end
    end   
  
    if CXTRT(pid, 581) then --曲非烟清弦指令
    if JY.Person[pid]["体力"] <= 15 or JY.Person[pid]["武器"] ~= 54 then
    	warmenu[11][3] = 0
    end
    end    
  
    if CXTRT(pid, 73) then --任盈盈幽韵指令
    if JY.Person[pid]["体力"] <= 15 or JY.Person[pid]["武器"] ~= 54 then
    	warmenu[11][3] = 0
    end
    end     
  
    --程灵素 阿紫引毒指令
    if CXTRT(pid, 2) or CXTRT(pid, 47) then
    local yes = 0
    for i = 0, WAR.PersonNum - 1 do
      if WAR.Person[i]["我方"] == false and WAR.Person[i]["死亡"] == false and RealJL(WAR.CurID, i, 8) then
        yes = 1
		break
      end
    end
    if yes == 0 then
      warmenu[11][3] = 0
    end  
    if JY.Person[pid]["体力"] <= 10 then
    	warmenu[11][3] = 0
    end
    end  
  
    if CXTRT(pid, 63) then --程英青箫指令
    if JY.Person[pid]["体力"] <= 20 or JY.Person[pid]["内力"] <= 500 then
    	warmenu[11][3] = 0
    end
    end    

    if CXTRT(pid, 656) then --赵灵儿梦蛇
  	GRTS[pid] = "梦蛇"
  	GRTSSAY[pid] = "效果：除自身外我方全体怒气为100且*      集气+200；每场战斗限两次*条件：内力1000点怒气100点以上*消耗：内力700点怒气100点"			
  	warmenu[11][1] = "梦蛇"
  	local display = 0
  	for j = 0, WAR.PersonNum - 1 do
  		if WAR.Person[j]["人物编号"] ~= pid and WAR.Person[j]["死亡"] == false 
  			and WAR.Person[j]["我方"] then
  			display = 1	
  			break;
  		end
  	end	 		
  	if JY.Person[pid]["内力"] <= 1000 or display == 0 or WAR.ZLEZL >= 2 
  		or WAR.LQZ[pid] == nil or WAR.LQZ[pid] < 100 then
  		warmenu[11][3] = 0
  	end
    elseif CXTRT(pid, 655) then --林月如指令
  	GRTS[pid] = "七诀"
  	GRTSSAY[pid] = "效果：此次攻击变为全屏攻击*      每场战斗限三次*条件：体力15点内力1000点以上*消耗：体力10点内力500点"			
  	warmenu[11][1] = "七诀"	
  	if JY.Person[pid]["内力"] <= 1000 or WAR.LYRZL >= 3 or JY.Person[pid]["体力"] <= 15 then
  		warmenu[11][3] = 0
  	end			
    elseif CXTRT(pid, 657) then --阿奴指令
  	GRTS[pid] = "夺魂"
  	GRTSSAY[pid] = "效果：中术者50时序内持续减血*      自身50时序内持续加血*条件：体力50点以上*消耗：体力15点"			
  	warmenu[11][1] = "夺魂"	
  	if JY.Person[pid]["体力"] <= 50 then
  		warmenu[11][3] = 0
  	end		
    end
	
    if CXTRT(pid, 92) then --mm宿缘
	local display = 0
	for j = 0, WAR.PersonNum - 1 do
		if WAR.Person[j]["人物编号"] == 0 and WAR.Person[j]["死亡"] == false then
			display = 1	
			break;
		end
	end	 
	if JY.Person[pid]["体力"] <= 10 or WAR.MMSY >= 5 or display == 0 then
		warmenu[11][3] = 0
	end 
    end
  
    --蓝烟清：平一指疗伤指令
    if CXTRT(pid, 28) then
  	if JY.Person[pid]["体力"] < 20 then
    	warmenu[11][3] = 0
    end
    end
  
    if (wglw1(pid,98) and GetS(113,0,0,0) == 98 and PersonKF(pid,98)) or (PersonKF(pid,98) and (DT(pid,618) or NF(pid))) then
		warmenu[19][1] = "模拟"
		warmenu[19][3] = 1
		if JY.Person[pid]["体力"] <= 10 then
			warmenu[19][3] = 0
		end
	elseif (wglw1(pid,67) and GetS(113,0,0,0) == 67 and PersonKF(pid,67)) or (DT(pid, 1) and JX(pid)) or (DT(pid, 621) and JX(pid)) then
		warmenu[19][1] = "换武"
		warmenu[19][3] = 1
		if JY.Person[pid]["体力"] <= 0 then
			warmenu[19][3] = 0
		end
	else
		warmenu[19][3] = 0
    end
	if (wglw1(pid,67) and GetS(113,0,0,0) == 67 and PersonKF(pid,67)) or (DT(pid, 1) and JX(pid)) or (DT(pid, 621) and JX(pid)) then
		warmenu[19][1] = "换刀"
		if JY.Person[pid]["体力"] <= 0 then
			warmenu[19][3] = 0
		end
    end
    if wglw(pid,98) and GetS(111,0,0,0) == 98 then
       warmenu[14][1] = "幻化"
   	if JY.Person[pid]["体力"] <= 10 then
		warmenu[14][3] = 0
	end
       elseif wglw(pid,108) then
       warmenu[14][1] = "洗髓"
   	if JY.Person[pid]["体力"] <= 10 or JY.Person[pid]["等级"] < 30 then
		warmenu[14][3] = 0
	end
       elseif PersonKF(pid,47) and pid == 0 and GetS(111, 0, 0, 0) == 592 then	
        warmenu[14][1] = "先机"
   	if JY.Person[pid]["体力"] <= 10 or WAR.HFXZ == 1 then
		warmenu[14][3] = 0
	end
       elseif wglw(pid,151) then	
        warmenu[14][1] = "金刚"
   	if JY.Person[pid]["体力"] <= 10 or WAR.JGBH[pid] ~= nil then
		warmenu[14][3] = 0
	end	
      elseif wglw(pid,103) then	
       warmenu[14][1] = "龙象"
   	if JY.Person[pid]["体力"] <= 10 or WAR.LXXL[pid] ~= nil then
		warmenu[14][3] = 0
	end	
      elseif wglw(pid,105) then	
       warmenu[14][1] = "涅"
   	if JY.Person[pid]["体力"] <= 10 or WAR.KHNP1[pid] ~= nil then
		warmenu[14][3] = 0
	end		
       elseif wglw(pid,105) then	
        warmenu[14][1] = "变幻"
   	if JY.Person[pid]["体力"] <= 10 or WAR.KHNP1[pid] ~= nil then
		warmenu[14][3] = 0
	end	
       elseif wglw(pid,92) then	
        warmenu[14][1] = "狮吼"
   	if JY.Person[pid]["体力"] <= 10 or WAR.SHG ==1 then
		warmenu[14][3] = 0
	end	
       elseif wglw(pid,104) then	
        warmenu[14][1] = "逆运"
   	if JY.Person[pid]["体力"] <= 10 or WAR.NYZJ[pid] ~= nil then
		warmenu[14][3] = 0
	end
       elseif ((PersonKF(pid,85) and pid == 0) or T1LEQ(pid)) and GetS(111, 0, 0, 0) == 85 then	
        warmenu[14][1] = "北冥"
   	if JY.Person[pid]["体力"] <= 10 or WAR.BMSG == 1 then
		warmenu[14][3] = 0
	end
       elseif wglw(pid,100) then	
        warmenu[14][1] = "先天"
   	if JY.Person[pid]["体力"] <= 10 or WAR.XTG > 0 then
		warmenu[14][3] = 0
	end
       elseif wglw(pid,999) then	
        warmenu[14][1] = "互搏"
   	if JY.Person[pid]["体力"] <= 10 or WAR.ZYHB1[pid] ~= nil then
		warmenu[14][3] = 0
	end
       elseif wglw(pid,96) then	
        warmenu[14][1] = "罗汉"
   	if JY.Person[pid]["体力"] <= 10 or WAR.XLFH[pid] ~= nil then
		warmenu[14][3] = 0
	end
       elseif wglw(pid,93) then
        warmenu[14][1] = "圣火"
   	if JY.Person[pid]["体力"] <= 10 then
		warmenu[14][3] = 0
	end
       elseif wglw(pid,87) then
        warmenu[14][1] = "化功"
   	if JY.Person[pid]["体力"] <= 10 then
		warmenu[14][3] = 0
	end
       elseif wglw(pid,88) then
        warmenu[14][1] = "吸星"
   	if JY.Person[pid]["体力"] <= 10 or WAR.WXXY == 1 then
		warmenu[14][3] = 0
	end
       elseif wglw(pid,94) then
        warmenu[14][1] = "神照"
   	if JY.Person[pid]["体力"] <= 10 then
		warmenu[14][3] = 0
	end
       elseif wglw(pid,6) then
        warmenu[14][1] = "潮音"
   	if JY.Person[pid]["体力"] <= 10 or WAR.BHCS[pid] == 1 then
		warmenu[14][3] = 0
	end
       elseif wglw(pid,90) then
        warmenu[14][1] = "混元"
   	if JY.Person[pid]["体力"] < 50 or WAR.HYYQ[pid] == 1 then
		warmenu[14][3] = 0
	end
       elseif wglw(pid,124) then
        warmenu[14][1] = "冰封"
   	if JY.Person[pid]["体力"] < 10 or WAR.BFQL[pid] == 1 then
		warmenu[14][3] = 0
	end
       elseif wglw(pid,102) then--1-26-
        warmenu[14][1] = "太玄"
   	if JY.Person[pid]["体力"] < 10 or WAR.HLTX1[pid] ~= nil then
		warmenu[14][3] = 0
	end
		elseif wglw(pid,189) then--1-26-
        warmenu[14][1] = "阴阳"
   	if JY.Person[pid]["体力"] < 10 or WAR.YYMZL == 1 then
		warmenu[14][3] = 0
	end
    else
 	warmenu[14][3] = 0
    end	
 
    if CXTRT(pid, 618) then
  	   warmenu[14][3] = 0
    end
  
    --蓝烟清：李文秀天铃指令
    if CXTRT(pid, 590) and WAR.L_LWX == 1 then
  	   warmenu[11][3] = 0
    end

    if CXTRT(pid, 664) and JY.Person[pid]["体力"] < 5 then
  	   warmenu[11][3] = 0
    end
  
    if T5BCF(pid) then --白愁飞三指弹天
	GRTS[0] = "惊神"
	GRTSSAY[0] = "效果：使用后出现惊神指极意--三指弹天*条件：体力10以上 *消耗：无"	
	warmenu[11][1] = "惊神"
	if JY.Person[pid]["体力"] <= 10 or juexing() < 3 or WAR.BCFZL ~= 0 then
		warmenu[11][3] = 0
	end
    elseif T8LXY(pid) then --李逍遥奇术指令
	GRTS[0] = "奇术"
	GRTSSAY[0] = "效果：江湖历练中领悟的各种奇术*条件：体力10点以上*消耗：视具体指令而定"	
	warmenu[11][1] = "奇术"
	if JY.Person[pid]["体力"] <= 10 or WAR.LXYZLPD == 1 then
		warmenu[11][3] = 0
	end  	
    --elseif T9ZY(pid) then --赵云白马指令
	--GRTS[0] = "白马"
	--GRTSSAY[0] = "效果：骑上白马，化身义从；*      三个回合之内能力上升*条件：体力50点内力点2000以上*消耗：体力20点内力1000点"	
	--warmenu[11][1] = "白马"
	--if JY.Person[pid]["体力"] <= 50 or JY.Person[pid]["内力"] <= 2000 
	--	or (juexing() < 1 and WAR.ZYZL == 1) or (juexing() >= 1 and WAR.ZYZL == 3) then
	--	warmenu[11][3] = 0
	--end    
    elseif T3XYK(pid) then --萧雨客军神指令
	GRTS[0] = "军神"
	GRTSSAY[0] = "效果：使用血翼军神的各种战斗技巧*条件：体力20点以上内力1000点以上*消耗：视具体指令而定"	
	warmenu[11][1] = "军神"
	if JY.Person[pid]["体力"] <= 20 or JY.Person[pid]["内力"] <= 1000 or WAR.JUNSHEN == 1 then
		warmenu[11][3] = 0
	end 
    elseif T10XXZ(pid) then --武骧金星：萧笑竹森罗指令
	GRTS[0] = "森罗"
	GRTSSAY[0] = "效果：模仿一个在场队友的天赋能力"	
	warmenu[11][1] = "森罗"	
    elseif T13TQS(pid) then --沼跃鱼：滕青山兽王指令
	GRTS[0] = "兽王"
	GRTSSAY[0] = "效果：使用兽王的各种战斗技巧*条件：体力10点以上*消耗：视具体指令而定"	
	warmenu[11][1] = "兽王"
	if JY.Person[pid]["体力"] <= 10 then
		warmenu[11][3] = 0
	end 
    elseif pid == 0 and putong() == 8 then
	GRTS[0] = "五毒"
	GRTSSAY[0] = "效果：使用五行奇毒*条件：体力10点以上*消耗：视具体指令而定"	
	warmenu[11][1] = "五毒"
	if JY.Person[pid]["体力"] <= 10 then
		warmenu[11][3] = 0
	end
    elseif pid == 0 and putong() == 12 then --武骧金星：乾坤皆阵斗策指令
    GRTS[0] = "斗策"
    GRTSSAY[0] = "效果：使用八部斗策*消耗：体力8点"	
	warmenu[11][1] = "斗策"
	if JY.Person[pid]["体力"] < 8 then
		warmenu[11][3] = 0
	end	
    elseif pid == 0 and putong() == 10 then
	GRTS[0] = "空空"
	GRTSSAY[0] = "效果：使用妙手之术*条件：体力10点以上*消耗：视具体指令而定"	
	warmenu[11][1] = "空空"
	if JY.Person[pid]["体力"] <= 10 then
		warmenu[11][3] = 0
	end  	
    elseif pid == 0 and putong() == 11 then
 	GRTS[0] = "豪掷"
	GRTSSAY[0] = "效果：豪赌一场，效果随机*条件：体力10点以上*消耗：每掷一次体力5点"	
	warmenu[11][1] = "豪掷"
	if JY.Person[pid]["体力"] <= 10 then
		warmenu[11][3] = 0
	end
    elseif XYL(pid) and juexing() > 1  
    and JY.Person[pid]["声望"] == 180 then
	GRTS[0] = "太虚"
	GRTSSAY[0] = "效果：可使用纯阳宫武学*条件：体力10点以上*消耗：视具体指令而定"	
	warmenu[11][1] = "太虚"
	if JY.Person[pid]["体力"] <= 10 then
		warmenu[11][3] = 0
	end
	elseif NF(pid) then --聂风魔刀指令
	GRTS[0] = "魔刀"
	GRTSSAY[0] = "效果：使用魔刀战斗技巧*条件：体力10点以上*消耗：视具体指令而定"	
	warmenu[11][1] = "魔刀"
	if JY.Person[pid]["体力"] <= 10 then
		warmenu[11][3] = 0
	end 
    elseif pid == 0 and GetS(103, 0, 0, 1) < 1 then 
	warmenu[11][3] = 0 
    end
    --elseif pid == 0 and GetS(103, 0, 0, 1) < 1 then  --蓝烟清：主角召唤独孤前辈 武骧金星：取消召唤指令
  	--if WAR.L_DGQB_ZL == 1 or JY.Person[pid]["体力"] < 50 or JY.Person[pid]["内力"] < 500 or JY.Person[592]["声望"] > 3 or GetS(86,10,20,5) ~= 1 then
  		--warmenu[11][3] = 0
  	--end
    --end
  
    --蓝烟清：田伯光 特色指令
    if CXTRT(pid, 29) then
  	if (GetS(86,10,12,5) ~= 1 and GetS(86,10,12,5) ~= 2) or JY.Person[pid]["内力"] < 200 or JY.Person[pid]["体力"] < 20 then
  		warmenu[11][3] = 0
  	end
    end
  
    --出左右时，只有攻击和休息可见
    if WAR.ZYHB == 2 then
    for i = 1, #warmenu do
      if i == 2 or i == 10 then
        i = i + 1
      end
      warmenu[i][3] = 0
    end
    end
    if WAR.ZYHB2 == 2 then
    for i = 1, #warmenu do
      if i == 2 or i == 10 then
        i = i + 1
      end
      warmenu[i][3] = 0
    end
    end
    --体力小于5或者已经移动过时，移动不可见
    if JY.Person[pid]["体力"] <= 5 or WAR.Person[WAR.CurID]["移动步数"] <= 0 then
       warmenu[1][3] = 0
       isEsc = 1
    end

    if WAR.Person[WAR.CurID]["移动步数"] <= 0 then --武骧金星：移动后不可以待机
       warmenu[16][3] = 0
       isEsc = 1
    end
  
    if XYL(pid) then 
       WAR.Person[WAR.CurID]["移动步数"] = WAR.Person[WAR.CurID]["移动步数"] + math.modf(JY.Person[pid]["轻功"]/200) --豸苗：谢云流增加移动距离
    end
    if DT(pid,597) then 
       WAR.Person[WAR.CurID]["移动步数"] = WAR.Person[WAR.CurID]["移动步数"] + math.modf(JY.Person[pid]["轻功"]/50) --谢无悠
    end
    if MPPD(pid)==16 then 
       WAR.Person[WAR.CurID]["移动步数"] = WAR.Person[WAR.CurID]["移动步数"] + math.modf(JY.Person[pid]["轻功"]/150) --全真金雁功
    end
	if NF(pid) and juexing() > 0 then 
       WAR.Person[WAR.CurID]["移动步数"] = WAR.Person[WAR.CurID]["移动步数"] + 16 --聂风1觉增加移动步数
    end
	if (PersonGT(pid, 181) and (DT(pid, 455))) or (wglw(pid,181) and PersonGTJL(pid,181)) or DT(pid,600) then
		WAR.Person[WAR.CurID]["移动步数"] = WAR.Person[WAR.CurID]["移动步数"] + 10
	end 	
		
    --判断最小内力，是否可显示攻击
    local minv = War_GetMinNeiLi(pid)
    if JY.Person[pid]["内力"] < minv or JY.Person[pid]["体力"] < 10 then
       warmenu[2][3] = 0
    end
    if JY.Person[pid]["体力"] < 10 or (JY.Person[pid]["用毒能力"] + MPAttrib(pid, 5)) < 20 then
       warmenu[3][3] = 0
    end
    if JY.Person[pid]["体力"] < 10 or (JY.Person[pid]["解毒能力"] + MPAttrib(pid, 6)) < 20 then
       warmenu[4][3] = 0
    end
    if JY.Person[pid]["体力"] < 50 or (JY.Person[pid]["医疗能力"] + MPAttrib(pid, 4)) < 20 then
       warmenu[5][3] = 0
    end
  
    --逆运走火状态
    if WAR.tmp[1000 + pid] == 1 then
    for i = 3, #warmenu do
      warmenu[i][3] = 0
    end
    warmenu[10][3] = 1
    end
  
    --新华山论剑，不可使用物品
    if WAR.ZDDH == 238 then
      warmenu[6][3] = 0
    end
 
    lib.GetKey()
    Cls()
    DrawTimeBar_sub(CC.ScreenW * 5 / 8, CC.ScreenW * 15 / 16, CC.FontSmall * 5)
    local test = ShowMenu(warmenu, #warmenu, #warmenu, CC.MainMenuX, CC.MainMenuY, 0, 0, 1, isEsc, CC.DefaultFont, C_ORANGE, C_WHITE)
    --QZXS(tostring(test))
	local chain  --手动战斗战意增长
	if WAR.Person[WAR.CurID]["我方"] then
		chain = WAR.MYCHAIN
	else
		chain = WAR.URCHAIN
	end
	if test == -2 then
		zhanyi(pid, (1.5 * (1 + chain / 30)))
	elseif test == -3 or test == -4 or test == -5 then
		zhanyi(pid, (0.5 * (1 + chain / 30)))
	elseif test == -6 then
		zhanyi(pid, (0.4 * (1 + chain / 30)))
	elseif test == -7 then
		zhanyi(pid, (0.65 * (1 + chain / 30)))
	elseif test == -8 or test == -10 then
		zhanyi(pid, (0.25 * (1 + chain / 30)))
	elseif test == -11 or test == -13 then
		zhanyi(pid, (1 * (1 + chain / 30)))
	end
    return test
end


--修炼武功
function War_PersonTrainBook(pid)
    local p = JY.Person[pid]
    local thingid = p["修炼物品"]
    if thingid < 0 then
       return 
    end
    JY.Thing[101]["加御剑能力"] = 1
    JY.Thing[123]["加拳掌功夫"] = 1
    local wugongid = JY.Thing[thingid]["练出武功"]
    local wg = 0
    if JY.Person[pid]["武功12"] > 0 and wugongid >= 0 then
		for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
			if JY.Thing[thingid]["练出武功"] == JY.Person[pid]["武功" .. i] then
				wg = 1
				break
			end
		end
		if wg == 0 then		--修复第一版本，不可修炼武功的BUG
			return 
		end
	end
    --[[
	if JY.Person[pid]["武功" .. HHH_GAME_SETTING["WG_COUNT_MAX"] ] ~= nil and JY.Person[pid]["武功" .. HHH_GAME_SETTING["WG_COUNT_MAX"] ] > 0 
		and JY.Person[pid]["武功等级" .. HHH_GAME_SETTING["WG_COUNT_MAX"] ] ~= nil and JY.Person[pid]["武功等级" .. HHH_GAME_SETTING["WG_COUNT_MAX"] ] >= 0 
		and wugongid ~= nil and wugongid >= 0 then
		-- help.util.debug("hhh_1_7")
		for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
			if JY.Thing[thingid]["练出武功"] == JY.Person[pid]["武功" .. i] then
				wg = 1
			end
		end
		if wg == 0 then
			-- 修复第一版本，不可修炼武功的BUG
			--if not repWugong_Found then
				-- help.util.debug("hhh_1_6")
				return
			--end
			-- help.util.debug("hhh_1_7")
		end
	end]]
	
    local yes1, yes2, kfnum = false, false, nil
    while true do 
	  local needpoint = TrainNeedExp(pid)
	  if needpoint <= p["修炼点数"] then
	    yes1 = true
	    AddPersonAttrib(pid, "生命最大值", JY.Thing[thingid]["加生命最大值"])
	    if thingid == 139 then
	      AddPersonAttrib(pid, "生命最大值", -15)
	      AddPersonAttrib(pid, "生命", -15)
	      if JY.Person[pid]["生命最大值"] < 1 then
	        JY.Person[pid]["生命最大值"] = 1
	      end
	    end
	    if JY.Person[pid]["生命"] < 1 then
	      JY.Person[pid]["生命"] = 1
	    end
	    if p["内力性质"] ~= 3 then
			if JY.Thing[thingid]["改变内力性质"] == 2 then --武骧金星：九阴九阳也可以改变内力性质
			  p["内力性质"] = 2
			elseif JY.Thing[thingid]["改变内力性质"] == 3 then
			  p["内力性质"] = 0
			elseif JY.Thing[thingid]["改变内力性质"] == 4 then
			  p["内力性质"] = 1
			end
		end	
	    
	    AddPersonAttrib(pid, "内力最大值", JY.Thing[thingid]["加内力最大值"])
	    AddPersonAttrib(pid, "攻击力", JY.Thing[thingid]["加攻击力"])
	    AddPersonAttrib(pid, "轻功", JY.Thing[thingid]["加轻功"])
	    AddPersonAttrib(pid, "防御力", JY.Thing[thingid]["加防御力"])
		if hasHZ(85) or hasTF(pid, 85) then --hasTF(pid, 85) then --王语嫣三围加倍 武骧金星：免去换印信的麻烦
			AddPersonAttrib(pid, "攻击力", JY.Thing[thingid]["加攻击力"])
			AddPersonAttrib(pid, "轻功", JY.Thing[thingid]["加轻功"])
			AddPersonAttrib(pid, "防御力", JY.Thing[thingid]["加防御力"])		
		end
		if NF(pid) then 
		    AddPersonAttrib(pid, "拳掌功夫", JY.Thing[thingid]["加拳掌功夫"] * 6)
	        AddPersonAttrib(pid, "御剑能力", JY.Thing[thingid]["加御剑能力"] * 6)
	        AddPersonAttrib(pid, "耍刀技巧", JY.Thing[thingid]["加耍刀技巧"] * 6)
	        AddPersonAttrib(pid, "特殊兵器", JY.Thing[thingid]["加特殊兵器"] * 6)
		    AddPersonAttrib(pid, "暗器技巧", JY.Thing[thingid]["加暗器技巧"] * 6)		
		end
		if MPPD(pid) == 10 then ----沼跃鱼：桃花岛
		    local gfqx = MPDJ(pid)
			AddPersonAttrib(pid, "攻击力", JY.Thing[thingid]["加攻击力"]*gfqx)
			AddPersonAttrib(pid, "轻功", JY.Thing[thingid]["加轻功"]*gfqx)
			AddPersonAttrib(pid, "防御力", JY.Thing[thingid]["加防御力"]*gfqx)		
		end
	    AddPersonAttrib(pid, "医疗能力", JY.Thing[thingid]["加医疗能力"])
	    AddPersonAttrib(pid, "用毒能力", JY.Thing[thingid]["加用毒能力"])
	    AddPersonAttrib(pid, "解毒能力", JY.Thing[thingid]["加解毒能力"])
	    AddPersonAttrib(pid, "抗毒能力", JY.Thing[thingid]["加抗毒能力"])
	    if T7DFWM(pid) then		--黄蓉和东方未明 双倍兵器值 hasTF(pid, 84) 武骧金星：免去换印信的麻烦
	      AddPersonAttrib(pid, "拳掌功夫", JY.Thing[thingid]["加拳掌功夫"] * 2)
	      AddPersonAttrib(pid, "御剑能力", JY.Thing[thingid]["加御剑能力"] * 2)
	      AddPersonAttrib(pid, "耍刀技巧", JY.Thing[thingid]["加耍刀技巧"] * 2)
	      AddPersonAttrib(pid, "特殊兵器", JY.Thing[thingid]["加特殊兵器"] * 2)
		  AddPersonAttrib(pid, "暗器技巧", JY.Thing[thingid]["加暗器技巧"] * 2)
		elseif T6XQS(pid) then
	      AddPersonAttrib(pid, "拳掌功夫", JY.Thing[thingid]["加拳掌功夫"])
	      AddPersonAttrib(pid, "耍刀技巧", JY.Thing[thingid]["加耍刀技巧"])
	      AddPersonAttrib(pid, "特殊兵器", JY.Thing[thingid]["加特殊兵器"])			
		  AddPersonAttrib(pid, "御剑能力", JY.Thing[thingid]["加御剑能力"] * 2)
		  AddPersonAttrib(pid, "暗器技巧", JY.Thing[thingid]["加暗器技巧"])
	    elseif CXTRT(pid, 590) then		--李文秀 双倍特殊兵器值
	      AddPersonAttrib(pid, "拳掌功夫", JY.Thing[thingid]["加拳掌功夫"])
	      AddPersonAttrib(pid, "御剑能力", JY.Thing[thingid]["加御剑能力"])
	      AddPersonAttrib(pid, "耍刀技巧", JY.Thing[thingid]["加耍刀技巧"])
	      AddPersonAttrib(pid, "特殊兵器", JY.Thing[thingid]["加特殊兵器"]*2)
		  AddPersonAttrib(pid, "暗器技巧", JY.Thing[thingid]["加暗器技巧"])
	    else
	      AddPersonAttrib(pid, "拳掌功夫", JY.Thing[thingid]["加拳掌功夫"])
	      AddPersonAttrib(pid, "御剑能力", JY.Thing[thingid]["加御剑能力"])
	      AddPersonAttrib(pid, "耍刀技巧", JY.Thing[thingid]["加耍刀技巧"])
	      AddPersonAttrib(pid, "特殊兵器", JY.Thing[thingid]["加特殊兵器"])
		  AddPersonAttrib(pid, "暗器技巧", JY.Thing[thingid]["加暗器技巧"])
	    end

		--飞影彩蛋：真龙心法兵器值、三维高成长
		if PersonKF(pid, 91) and inteam(pid) and JY.Person[pid]["武功2"] == 91 and JY.Wugong[91]["名称"] == "赤血真龙诀" then
			AddPersonAttrib(pid, "拳掌功夫", JY.Thing[thingid]["加拳掌功夫"] * 2)
			AddPersonAttrib(pid, "御剑能力", JY.Thing[thingid]["加御剑能力"] * 2)
			AddPersonAttrib(pid, "耍刀技巧", JY.Thing[thingid]["加耍刀技巧"] * 2)
			AddPersonAttrib(pid, "特殊兵器", JY.Thing[thingid]["加特殊兵器"] * 2)
			AddPersonAttrib(pid, "暗器技巧", JY.Thing[thingid]["加暗器技巧"] * 2)
			AddPersonAttrib(pid, "攻击力", JY.Thing[thingid]["加攻击力"])
			AddPersonAttrib(pid, "轻功", JY.Thing[thingid]["加轻功"])
			AddPersonAttrib(pid, "防御力", JY.Thing[thingid]["加防御力"])
		end
		
		if hasHZ(84) or hasTF(pid, 84) then
	      AddPersonAttrib(pid, "拳掌功夫", JY.Thing[thingid]["加拳掌功夫"])
	      AddPersonAttrib(pid, "御剑能力", JY.Thing[thingid]["加御剑能力"])
	      AddPersonAttrib(pid, "耍刀技巧", JY.Thing[thingid]["加耍刀技巧"])
	      AddPersonAttrib(pid, "特殊兵器", JY.Thing[thingid]["加特殊兵器"])
		  AddPersonAttrib(pid, "暗器技巧", JY.Thing[thingid]["加暗器技巧"])		
		end
		
		if MPPD(pid) == 10 then		----沼跃鱼：桃花岛
		  local tssx = MPDJ(pid)
	      AddPersonAttrib(pid, "拳掌功夫", JY.Thing[thingid]["加拳掌功夫"]*(tssx))
	      AddPersonAttrib(pid, "御剑能力", JY.Thing[thingid]["加御剑能力"]*(tssx))
	      AddPersonAttrib(pid, "耍刀技巧", JY.Thing[thingid]["加耍刀技巧"]*(tssx))
	      AddPersonAttrib(pid, "特殊兵器", JY.Thing[thingid]["加特殊兵器"]*(tssx))
		  AddPersonAttrib(pid, "暗器技巧", JY.Thing[thingid]["加暗器技巧"]*(tssx))
		end---

        if MPPD(pid) == 17 or (GX(pid) and JX(pid)) then  --峨眉派系数
	      AddPersonAttrib(pid, "拳掌功夫", JY.Thing[thingid]["加拳掌功夫"] * 3)
	      AddPersonAttrib(pid, "御剑能力", JY.Thing[thingid]["加御剑能力"] * 3)
	      AddPersonAttrib(pid, "耍刀技巧", math.modf(JY.Thing[thingid]["加耍刀技巧"] * 2.5))
	      AddPersonAttrib(pid, "特殊兵器", math.modf(JY.Thing[thingid]["加特殊兵器"] * 2.5))
		  AddPersonAttrib(pid, "暗器技巧", math.modf(JY.Thing[thingid]["加暗器技巧"] * 2.5))
		end		

        if MPPD(pid) == 18 then  --崆峒拳系
	      AddPersonAttrib(pid, "拳掌功夫", JY.Thing[thingid]["加拳掌功夫"] * 2)
		end		

        if MPPD(pid) == 18 then  --崆峒特系
	      AddPersonAttrib(pid, "特殊兵器", JY.Thing[thingid]["加特殊兵器"] * 2)
		end	

        if MPPD(pid) == 18 then  --崆峒暗系
	      AddPersonAttrib(pid, "暗器技巧", JY.Thing[thingid]["加暗器技巧"] * 2)
		end	
		
		if MPPD(pid) == 3 then --古墓强化
			AddPersonAttrib(pid, "御剑能力", JY.Thing[thingid]["加御剑能力"] * 1.5)
			AddPersonAttrib(pid, "暗器技巧", JY.Thing[thingid]["加暗器技巧"] * 1.5)
		end	
		
		if (wglw1(pid,77) or ((DT(pid,605) or DT(pid,627))and JX(pid))) then
			AddPersonAttrib(pid, "御剑能力", JY.Thing[thingid]["加御剑能力"] * 3)
			AddPersonAttrib(pid, "耍刀技巧", JY.Thing[thingid]["加耍刀技巧"] * 3)
			AddPersonAttrib(pid, "特殊兵器", JY.Thing[thingid]["加特殊兵器"] * 3)
		end	
		
		if MPPD(pid) == 19 then
			AddPersonAttrib(pid, "御剑能力", JY.Thing[thingid]["加御剑能力"] * 3)
			AddPersonAttrib(pid, "耍刀技巧", JY.Thing[thingid]["加耍刀技巧"] * 3)
		end	
		
		local bb = {"攻击力", "防御力", "轻功", "拳掌功夫", "御剑能力", "耍刀技巧", "特殊兵器"}
		local bb2 = {"加攻击力", "加防御力", "加轻功", "加拳掌功夫", "加御剑能力", "加耍刀技巧", "加特殊兵器"}
		for i = 1, #bb do
			if blqs(pid, i) then
				AddPersonAttrib(pid, bb[i], JY.Thing[thingid][bb2[i]])
			end
		end

		--[[武骧金星：修正BUG
		if hasHZ(14) then	--玲珑印
			if JY.Thing[thingid]["加拳掌功夫"] > 0 then
				AddPersonAttrib(pid, "拳掌功夫", 1)
			end
			if JY.Thing[thingid]["加御剑能力"] > 0 then
				AddPersonAttrib(pid, "御剑能力", 1)
			end
			if JY.Thing[thingid]["加耍刀技巧"] > 0 then
				AddPersonAttrib(pid, "耍刀技巧", 1)
			end
			if JY.Thing[thingid]["加特殊兵器"] > 0 then
				AddPersonAttrib(pid, "特殊兵器", 1)
			end			
			if JY.Thing[thingid]["加暗器技巧"] > 0 then
				AddPersonAttrib(pid, "暗器技巧", 1)
			end					
		end
	    ]]
	    --蓝烟清：StarShine萧中慧的天赋，额外增加三围
	    if CXTRT(pid, 77) then		-- 萧中慧天赋 pid == 77
			AddPersonAttrib(pid,"攻击力",JY.Thing[thingid]["加耍刀技巧"]);
			AddPersonAttrib(pid,"轻功",JY.Thing[thingid]["加耍刀技巧"]);
			AddPersonAttrib(pid,"防御力",JY.Thing[thingid]["加耍刀技巧"]);
		end

	    AddPersonAttrib(pid, "武学常识", JY.Thing[thingid]["加武学常识"])
	    AddPersonAttrib(pid, "品德", JY.Thing[thingid]["加品德"])
	    AddPersonAttrib(pid, "攻击带毒", JY.Thing[thingid]["加攻击带毒"])
	    if JY.Thing[thingid]["加攻击次数"] == 1 then
	      p["左右互搏"] = 1
	    end
	    if thingid > 186 then
	      p["修炼点数"] = p["修炼点数"] - needpoint
	    end
	    if JY.WGLVXS == 0 and thingid < 187 then
	      p["修炼点数"] = p["修炼点数"] - needpoint
	    end
	    
	    if wugongid >= 0 then 
	       yes2 = true
	       local oldwugong = 0
	       for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
	           if p["武功" .. i] == wugongid then
	              oldwugong = 1
	              p["武功等级" .. i] = math.modf((p["武功等级" .. i] + 100) / 100) * 100
	              kfnum = i
	              break;
	           end
	       end
	       if oldwugong == 0 then
			  for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
			      if p["武功" .. i] == 0 then
			         p["武功" .. i] = wugongid
			         p["武功等级" .. i] = 0;
			         kfnum = i
			         break;
			      end
			  end
		   end
	    end
	    
	  else
	  	break;
	  end
	end
	if yes1 then
		DrawStrBoxWaitKey(string.format(CC.WARS126, p["姓名"], JY.Thing[thingid]["名称"]), C_WHITE, CC.DefaultFont)
	end
	if yes2 then
		DrawStrBoxWaitKey(string.format(CC.WARS127, JY.Wugong[wugongid]["名称"], math.modf(p["武功等级" .. kfnum] / 100) + 1), C_WHITE, CC.DefaultFont)
	end
end

--特色指令
function War_WXMenu(flag, flag2)
    local pid = WAR.Person[WAR.CurID]["人物编号"]
    Cls()
    WAR.ShowHead = 0
    WarDrawMap(0)
  	local function ownPD(id, p)
		if (flag == nil or flag ~= 1) and id == 0 then
			return true
		end
		return false
	end
 	if (flag == nil or flag ~= 1) then	 
  		if wglw(pid,98) then
			 if JY.Person[pid]["体力"] >= 10 then
				Cls()		
				local dxp = {}
				local num = 1
				for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
					local wid = JY.Person[pid]["武功" .. i]
					if wid == 9999 then wid = JY.Thing[224]["加攻击力"] end
					if wid > 0 and wid <= JY.WugongNum - 1 and JY.Wugong[wid]["类型"] == 0 then
						if wid == 98 then --小无不能选择
						elseif wid == 43 and (JY.Person[50]["姓名"] ~= "乔峰" or not hasthing(147)) then --斗转需要完成天龙邪
						elseif wid == 180 and MPPD(pid) ~= 11 then --太虚剑意需要门派是一刀流
						elseif wid == 181 and GetS(86, 2, 10, 5) ~= 1 then --玄武真功需要打赢过夫妻阵
						elseif wid == 203 and GetS(86, 10, 20, 5) ~= 1 then -- 怒海剑涛需要打赢过独孤求败
						else
							dxp[num] = {}
							dxp[num][1] = JY.Wugong[wid]["名称"]
							dxp[num][2] = nil
							dxp[num][3] = 1
							dxp[num][4] = wid
							num = num + 1
						end
					end
				end
				if num <= 1 then
					DrawStrBoxWaitKey("没有可幻化的武功", C_WHITE, 30)
					return 0							
				end			
				DrawStrBox(CC.MainMenuX, CC.MainMenuY, "武中无相・内功幻化", C_GOLD, 30)
				local r = ShowMenu(dxp, num - 1, 10, CC.MainMenuX, CC.MainMenuY + 45, 0, 0, 1, 0, CC.DefaultFont, C_RED, C_GOLD)
				SetS(111,0,0,0,dxp[r][4]) 
				SetS(111, 1, 0, 0, 98)
				return 0
				--[[
				local zhilingnum = 4
				local qishu = JYMsgBox("幻化", "要选择哪一个指令？", {"一", "二", "三", "四"}, zhilingnum, pid)
			    if qishu <= 0 then
					return 0
				end	
				if qishu == 1 then
				local hh1 = JYMsgBox("幻化一", "要选择哪一个指令？", {"北", "罗", "易", "先", "龙", "逆", "狮", "金", "葵", "互", "火"}, 11, pid)	
			    if hh1 <= 0 then
					return 0
				end		
				if hh1 == 1 and (PersonKF(pid,85) or T1LEQ(pid)) then
				    local zh = JYMsgBox("北冥神功", "海纳百川", CC.EVB173, 2, pid)
					if zh == 1 then
					    SetS(111,0,0,0,85) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end	
				elseif hh1 == 2 and PersonKF(pid,96) then
				    local zh = JYMsgBox("罗汉伏魔功", "赤心降魔", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,96) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end		
				elseif hh1 == 3 and PersonKF(pid,108) then
				    local zh = JYMsgBox("易筋神功", "锻骨洗髓", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,108) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end			
				elseif hh1 == 4 and PersonKF(pid,100) then
				    local zh = JYMsgBox("先天功", "先天重生", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,100) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end		
				elseif hh1 == 5 and PersonKF(pid,103) then
				    local zh = JYMsgBox("龙象般若功", "龙象之力", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,103) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end	
				elseif hh1 == 6 and PersonKF(pid,104) then
				    local zh = JYMsgBox("逆运筋脉", "走火入魔", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,104) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end	
				elseif hh1 == 7 and PersonKF(pid,92) then
				    local zh = JYMsgBox("狮吼功", "狮王怒吼", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,92) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end		
				elseif hh1 == 8 and PersonKF(pid,151) then
				    local zh = JYMsgBox("金刚不坏", "罗汉金身", CC.EVB173, 2, pid)			
					if zh == 1 then
					    SetS(111,0,0,0,151) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end						
				elseif hh1 == 9 and PersonKF(pid,105) then
				    local zh = JYMsgBox("葵花神功", "葵花辟邪", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,105) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end	
				elseif hh1 == 10 and JY.Person[pid]["左右互搏"] == 1 then
				    local zh = JYMsgBox("左右互搏", "左右互搏", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,999) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end	
				elseif hh1 == 11 and PersonKF(pid,93) then
				    local zh = JYMsgBox("圣火神功", "光明圣火", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,93) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				else
				    QZXS("未曾学得此武功，请重新选择")
					return 0
				end	
            elseif qishu == 2 then 	
				local hh2 = JYMsgBox("幻化二", "要选择哪一个指令？", {"化", "吸", "神", "潮", "混", "冰", "玄", "乾", "关", "天", "女"}, 11, pid)	
			    if hh2 <= 0 then
					return 0
				end	
				if hh2 == 1 and PersonKF(pid,87) then
				    local zh = JYMsgBox("化功大法", "邪毒化功", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,87) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				elseif hh2 == 2 and PersonKF(pid,88) then
				    local zh = JYMsgBox("吸星大法", "万象吸引", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,88) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				elseif hh2 == 3 and PersonKF(pid,94) then
				    local zh = JYMsgBox("神照功", "入神座照", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,94) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				elseif hh2 == 4 and PersonKF(pid,6) then
				    local zh = JYMsgBox("碧海潮生功", "桃花影落", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,6) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				elseif hh2 == 5 and PersonKF(pid,90) then
				    local zh = JYMsgBox("混元功", "混如一气", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,90) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				elseif hh2 == 6 and PersonKF(pid,124) then
				    local zh = JYMsgBox("寒冰真气", "冻气侵袭", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,124) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				elseif hh2 == 7 and PersonKF(pid,102) then--1-26-
				    local zh = JYMsgBox("太玄神功", "万元归宗", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,102) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				elseif hh2 == 8 and PersonKF(pid,97) then--1-26-
				    local zh = JYMsgBox("乾坤大挪移", "乾坤逆转", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,97) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end	
				elseif hh2 == 9 and PersonKF(pid,150) then--1-26-
				    local zh = JYMsgBox("金关玉锁诀", "全真内劲", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,150) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				elseif hh2 == 10 and PersonKF(pid,152) then--1-26-
				    local zh = JYMsgBox("天南易阳诀", "大理神功", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,152) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end	
				elseif hh2 == 11 and PersonKF(pid,121) then--1-26-
				    local zh = JYMsgBox("玉女心经", "沉鱼落雁", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,121) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end		
				else	
				    QZXS("未曾学得此武功，请重新选择")
					return 0
				end	
			elseif qishu == 3 then
				local hh3 = JYMsgBox("幻化三", "要选择哪一个指令？", {"阴", "阳", "荒", "虚", "纯", "擒", "蛤", "紫","太", "洗", "瑜"}, 11, pid)	
			    if hh3 <= 0 then
					return 0
				end	
				if hh3 == 1 and PersonKF(pid,107) then
				    local zh = JYMsgBox("九阴神功", "万寿道藏", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,107) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				elseif hh3 == 2 and PersonKF(pid,106) then
				    local zh = JYMsgBox("九阳神功", "万般皆通", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,106) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end	
				elseif hh3 == 3 and PersonKF(pid,101) then
				    local zh = JYMsgBox("八荒六合功", "唯我独尊", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,101) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end		
				elseif hh3 == 4 and PersonKF(pid,180) then
				    local zh = JYMsgBox("太虚剑意", "纯阳武学", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,180) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end	
				elseif hh3 == 5 and PersonKF(pid,99) then
				    local zh = JYMsgBox("纯阳无极功", "武当绝技", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,99) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end		
				elseif hh3 == 6 and PersonKF(pid,178) then
				    local zh = JYMsgBox("擒龙功", "丐帮秘学", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,178) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end			
				elseif hh3 == 7 and PersonKF(pid,95) then
				    local zh = JYMsgBox("蛤蟆功", "天蛤神气", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,95) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end		
				elseif hh3 == 8 and PersonKF(pid,89) then
				    local zh = JYMsgBox("紫霞神功", "华山气宗", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,89) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end			
				elseif hh3 == 9 and PersonKF(pid,182) then
				    local zh = JYMsgBox("太极神功", "浑圆一体", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,182) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end					
				elseif hh3 == 10 and PersonKF(pid,183) then
				    local zh = JYMsgBox("洗髓神功", "武道禅宗", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,183) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end				
				elseif hh3 == 11 and PersonKF(pid,184) then
				    local zh = JYMsgBox("瑜伽密乘", "密宗之宝", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,184) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end							
				else
				    QZXS("未曾学得此武功，请重新选择")
					return 0
				end	
			elseif qishu == 4 then
				local hh4 = JYMsgBox("幻化三", "要选择哪一个指令？", {"临", "武", "峨", "少", "神", "磨", "真", "剑", "？", "？", "？"}, 11, pid)	
			    if hh4 <= 0 then
					return 0
				end	
				if hh4 == 1 and PersonKF(pid,153) then
					local zh = JYMsgBox("临济十二庄", "峨眉绝学", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,153) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end		
				elseif hh4 == 2 and PersonKF(pid,186) then		
				    local zh = JYMsgBox("武当九阳功", "九阳之纯", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,185) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				elseif hh4 == 3 and PersonKF(pid,186) then
				    local zh = JYMsgBox("峨眉九阳功", "九阳之博", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,186) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end	
				elseif hh4 == 4 and PersonKF(pid,187) then
				    local zh = JYMsgBox("少林九阳功", "九阳之高", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,187) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end		
				elseif hh4 == 5 and PersonKF(pid,188) then
				    local zh = JYMsgBox("神足经", "瑜伽秘术", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,188) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end	
				elseif hh4 == 6 and PersonKF(pid,189) then
				    local zh = JYMsgBox("阴阳磨", "天地熔炉", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,189) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				elseif hh4 == 7 and PersonKF(pid,181) then
				    local zh = JYMsgBox("玄武真功", "十强武道", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,181) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				elseif hh4 == 8 and PersonKF(pid,203) then
				    local zh = JYMsgBox("怒海剑涛", "无我无剑", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(111,0,0,0,203) 
						SetS(111, 1, 0, 0, 98)
						return 0
					else
						return 0
					end						
				else
				    QZXS("未曾学得此武功，请重新选择")
					return 0
				end			
			end
		]]
			end
		elseif wglw(pid,108) then
		    local zhilingnum = 2
			if JY.Person[pid]["体力"] > 10 then			
			local qishu = JYMsgBox("洗髓", "是否要洗髓？", {"是", "否"}, zhilingnum, pid)
			    if qishu == 1 then
					local T = {}
			        for a = 1, 1000 do
				    local b = "" .. a
					    T[b] = a
				    end
			            DrawStrBoxWaitKey(CC.EVB124, C_WHITE, 30)
			            JY.Person[0]["资质"] = -1
			        while JY.Person[0]["资质"] == -1 do
				        local r = GetPinyin1(32, CC.ScreenH - CC.Fontbig * 6)
				    if T[r] ~= nil and T[r] > -1 and T[r] < 101 then
					         JY.Person[0]["资质"] = T[r]
				    else
					         DrawStrBoxWaitKey(CC.EVB125, C_WHITE, 30)
				    end
					end
				return 1	
			    else
				    return 0
			    end	
			end
		elseif PersonKF(pid,47) and pid == 0 and GetS(111, 0, 0, 0) == 592 then
		    local zhilingnum = 2
			if JY.Person[pid]["体力"] > 10 then			
			local qishu = JYMsgBox("料敌先机", "目标集气位置大于900时，自身立刻行动*消耗：自身体力值15点", {"是", "否"}, zhilingnum, pid)
			    if qishu == 1 then
				   if WAR.HFXZ > 0 or JY.Person[pid]["体力"] < 15 then
				      DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
				   else
			       for i = 1326, 1342 do
				       CurIDTXDH(WAR.CurID, i, i, "料敌先机 后发先至");		--动画显示	
				       lib.Delay(10)
			       end				   
	               WAR.HFXZ = 1
				   AddPersonAttrib(pid, "体力", -15)
				   end
			    else
				    return 0
			    end	
			end
        elseif wglw(pid,151) then
		    local zhilingnum = 2
			if JY.Person[pid]["体力"] > 10 then			
			local qishu = JYMsgBox("金刚不坏", "2回合内必定减伤80*消耗：自身体力值25点", {"是", "否"}, zhilingnum, pid)
			    if qishu == 1 then
				   if WAR.JGBH[pid] ~= nil or JY.Person[pid]["体力"] < 25 then
				      DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
				   else
			       for i = 1378, 1399 do
				       CurIDTXDH(WAR.CurID, i, i, "金刚不坏 神功护体");		--动画显示	
				       lib.Delay(10)
			       end				   
	               addeffect(WAR.JGBH, pid, 3)
				   AddPersonAttrib(pid, "体力", -25)
				   return 1
				   end
			    else
				    return 0
			    end	
			end
		elseif wglw(pid,103) then
			local zhilingnum = 2
			if JY.Person[pid]["体力"] > 10 then			
			local qishu = JYMsgBox("龙象蓄力", "3回合内自动蓄力,主运龙象必出龙象之力*消耗：自身体力值20点", {"是", "否"}, zhilingnum, pid)
			    if qishu == 1 then
				   if WAR.LXXL[pid] ~= nil or JY.Person[pid]["体力"] < 20 then
				      DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
				   else
			       for i = 2219, 2242 do
				       CurIDTXDH(WAR.CurID, i, i, "龙象之力 龙象蓄力");		--动画显示	
				       lib.Delay(10)
			       end				   
	               addeffect(WAR.LXXL, pid, 4)
				   AddPersonAttrib(pid, "体力", -20)
				   return 1
				   end
			    else
				    return 0
			    end	
			end
        elseif wglw(pid,105) then
			local zhilingnum = 2
			if JY.Person[pid]["体力"] > 10 then			
			local qishu = JYMsgBox("葵花涅", "根据不同性别获得不同效果加成,葵花移形几率提升*消耗：自身体力值20点,时序消耗内力15点", {"是", "否"}, zhilingnum, pid)
			if qishu <= 0 then
					return 0
				end
			    if qishu == 1 then
				   if WAR.KHNP1[pid] ~= nil or JY.Person[pid]["体力"] < 20 then
				      DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
				   else
					if JY.Person[0]["性别"] == 0 then
			           for i = 494, 506 do
				           CurIDTXDH(WAR.CurID, i, i, "葵花涅 祸乱苍生");		--动画显示	
				           lib.Delay(10)
			           end
					   WAR.KHNP1[pid] = 1
  					elseif JY.Person[0]["性别"] == 1 then
			           for i = 456, 469 do
				           CurIDTXDH(WAR.CurID, i, i, "葵花涅 魅惑苍生");		--动画显示	
				           lib.Delay(10)
			           end
						WAR.KHNP1[pid] = 2
  					elseif JY.Person[0]["性别"] == 2 then
			           for i = 678, 691 do
				           CurIDTXDH(WAR.CurID, i, i, "葵花涅 阴阳相生");		--动画显示	
				           lib.Delay(10)
			           end
					   WAR.KHNP1[pid] = 3
					end   
				   AddPersonAttrib(pid, "体力", -20)
				   return 1
				   end
			    else
				    return 0
			    end	
			end	 	
		elseif wglw(pid,92) then
			local zhilingnum = 2
			if JY.Person[pid]["体力"] > 10 then			
			local qishu = JYMsgBox("狮王咆哮", "全体晕眩20时序,内伤100,出狮吼功强制内伤15点*消耗：自身体力值20点", {"是", "否"}, zhilingnum, pid)
			    if qishu == 1 then
				   if WAR.SHG == 1 or JY.Person[pid]["体力"] < 20 then
				      DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
				   else
			       for i = 2523, 2538 do
				       CurIDTXDH(WAR.CurID, i, i, "兽王狮吼 狮王咆哮");		--动画显示	
				       lib.Delay(10)
			       end
			            for i = 0, WAR.PersonNum - 1 do			      	  
				        local tmppid = WAR.Person[i]["人物编号"]
				        if WAR.Person[i]["死亡"] == false and WAR.Person[i]["我方"] == false then
						   JY.Person[tmppid]["受伤程度"] = 100
						   WAR.SZWH[tmppid] = 20
					    end						
				        end				   
	               WAR.SHG = 1
				   AddPersonAttrib(pid, "体力", -20)
				   return 1
				   end
			    else
				    return 0
			    end	
			end
		elseif wglw(pid,104) then
			local zhilingnum = 2
			if JY.Person[pid]["体力"] > 10 then			
			local qishu = JYMsgBox("逆筋异脉", "被攻击几率直接暴怒,集气进入走火状态*消耗：自身体力值20点,时序消耗内力15点", {"是", "否"}, zhilingnum, pid)
			    if qishu == 1 then
				   if WAR.NYZJ[pid] ~= nil or JY.Person[pid]["体力"] < 20 then
				      DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
				   else
			       for i = 2596, 2610 do
				       CurIDTXDH(WAR.CurID, i, i, "逆筋异脉 倒行逆施");		--动画显示	
				       lib.Delay(10)
			       end			   
	               WAR.NYZJ[pid] = 1
				   AddPersonAttrib(pid, "体力", -20)
				   return 1
				   end
			    else
				    return 0
			    end	
			end
		elseif ((PersonKF(pid,85) and pid == 0) or T1LEQ(pid)) and GetS(111, 0, 0, 0) == 85 then
			local zhilingnum = 2
			if JY.Person[pid]["体力"] > 10 then		
            local qishu = JYMsgBox("北冥神功", "要选择哪一个指令？", {"海纳百川", "化为己用"}, zhilingnum, pid)				
			    if qishu == 1 then
				   if WAR.BMSG == 1 then
				      DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
				   else
			       for i = 2813, 2826 do
				       CurIDTXDH(WAR.CurID, i, i, "北冥神功 海纳百川");		--动画显示	
				       lib.Delay(10)
			       end	
				   		local xnl = nil
						local xnl1 = nil
						local xnl2 = nil
			            for i = 0, WAR.PersonNum - 1 do			      	  
				        local tmppid = WAR.Person[i]["人物编号"]
				        if WAR.Person[i]["死亡"] == false and WAR.Person[i]["我方"] == false then
						   xnl = math.modf(JY.Person[tmppid]["内力最大值"] *0.15)
						   xnl1 = math.modf(JY.Person[tmppid]["生命最大值"] *0.15)
						   xnl2 = math.modf(JY.Person[tmppid]["体力"] *0.15)
						   AddPersonAttrib(tmppid, "内力", -xnl)
						   AddPersonAttrib(tmppid, "生命", -xnl1)
						   AddPersonAttrib(tmppid, "体力", -xnl2)
                           AddPersonAttrib(pid, "内力", xnl)
						   AddPersonAttrib(pid, "生命", xnl1)
						   AddPersonAttrib(pid, "体力", xnl2)
		                   AddPersonAttrib(pid, "内力最大值", math.modf(xnl * 2 / 3 + 10))
					    end						
				        end						
	               WAR.BMSG = 1
				   return 1
				   end
			    elseif qishu == 2 then
					local xy = JYMsgBox("北冥神功", "吸收对方主功体内力，自身获得对方主功体效果，敌方无法主功体加力护体", CC.EVB173, 2, pid)
					if xy ~= 1 then
						return 0
					end
					   if JY.Person[pid]["内力"] < 500 then
				          DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						  return 0
				       else
					    DHdisplay(1173, 1187, "北冥神功 化为己用")
						local nx, ny, victim, victimid = selectPerson(7, 1)
						if nx == -1 then
							return 0
						end
						CleanWarMap(4, 0)
						SetWarMap(WAR.Person[victim]["坐标X"],WAR.Person[victim]["坐标Y"], 4, 2)						
						WAR.BMGT = JY.Person[victimid]["声望"]
						WAR.BMGT2 = victimid
						War_ShowFight(pid, 0, 0, 0, WAR.Person[WAR.CurID]["坐标X"],WAR.Person[WAR.CurID]["坐标Y"], 185)	
				        AddPersonAttrib(pid, "内力", -500)
						return 1
				       end
				else
				    return 0
			    end	
			end
		elseif wglw(pid,100) then
			local zhilingnum = 2
			if JY.Person[pid]["体力"] > 10 then			
			local qishu = JYMsgBox("先天境界", "重生前后开启效果不同*消耗：自身体力值20点", {"是", "否"}, zhilingnum, pid)
			    if qishu == 1 then
				   if WAR.XTG > 0 or JY.Person[pid]["体力"] < 20 then
				      DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
				   else
				       if WAR.WCY2 < 1 then
			               for i = 2596, 2610 do
				               CurIDTXDH(WAR.CurID, i, i, "先天神功 先天之境");		--动画显示	
				                lib.Delay(10)
			               end			   
	                       WAR.XTG = 1
					   elseif WAR.WCY2 > 0 then
					       for i = 2596, 2610 do
				               CurIDTXDH(WAR.CurID, i, i, "先天神功 先天重生");		--动画显示	
				                lib.Delay(10)
			               end			   
	                       WAR.XTG = 2
						   WAR.WCY2 = 0
					   end
				   AddPersonAttrib(pid, "体力", -20)
				   return 1
				   end
			    else
				    return 0
			    end	
			end
        elseif JY.Person[pid]["左右互搏"] == 1 and wglw(pid,999) then
			local zhilingnum = 2
			if JY.Person[pid]["体力"] > 10 then			
			local qishu = JYMsgBox("左右互搏", "三回合内必定出左右，左右必定连击且无法被连击,双武功组合必出特效*消耗：自身体力值20点", {"是", "否"}, zhilingnum, pid)
			    if qishu == 1 then
				   if WAR.ZYHB1[pid] ~= nil or JY.Person[pid]["体力"] < 20 then
				      DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
				   else
			       for i = 2301, 2317 do
				       CurIDTXDH(WAR.CurID, i, i, "左右开弓 双手互搏");		--动画显示	
				       lib.Delay(10)
			       end			   
	               addeffect(WAR.ZYHB1, pid, 4)
				   AddPersonAttrib(pid, "体力", -20)
				   return 1
				   end
			    else
				    return 0
			    end	
			end
		elseif wglw(pid,96) then
		    local zhilingnum = 2
			if JY.Person[pid]["体力"] > 10 then
			local qishu = JYMsgBox("降龙伏虎", "全体敌方攻防集气效果降低15%,自身被攻击战意不减*消耗：自身体力值20点,时序消耗内力15点", {"是", "否"}, zhilingnum, pid)
			    if qishu == 1 then
				   if WAR.XLFH[pid] ~= nil or JY.Person[pid]["体力"] < 20 then
				      DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
				   else
			       for i = 2242, 2259 do
				       CurIDTXDH(WAR.CurID, i, i, "罗汉伏魔 降龙伏虎");		--动画显示	
				       lib.Delay(10)
			       end
					WAR.XLFH[pid] = 1	
				    AddPersonAttrib(pid, "体力", -20)
				   return 1
				   end
			    else
				    return 0
			    end	
			end
		elseif wglw(pid,93) then
		    local zhilingnum = 6
			if JY.Person[pid]["体力"] > 10 then
			local qishu = JYMsgBox("光明圣火", "明教圣火密令*消耗：根据不同指令而定", {"暗尘", "罪缚", "暗邢", "极乐", "贪魔", "幻光"}, zhilingnum, pid)
			    if qishu <= 0 then
					return 0
				end
			    if qishu == 1 then
					local xy = JYMsgBox("暗尘弥散", "隐身50时序*消耗：内力200点", CC.EVB173, 2, pid)
					if xy ~= 1 then
						return 0
					end
				       if WAR.HIDE[pid] ~= nil or JY.Person[pid]["内力"] < 200 then
				          DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						  return 0
				       else
			           for i = 657, 678 do
				       CurIDTXDH(WAR.CurID, i, i, "筋肉分离散 毛骨森似寒");		--动画显示	
				       lib.Delay(10)
			           end
					   WAR.HIDE[pid] = 50
				       AddPersonAttrib(pid, "内力", -200)
					   return 1
				       end
			    elseif qishu == 2 then
					local xy = JYMsgBox("业海罪缚", "目标集气速度降低50%，持续80时序*消耗：内力500点", CC.EVB173, 2, pid)
					if xy ~= 1 then
						return 0
					end
				       if JY.Person[pid]["内力"] < 500 then
				          DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						  return 0
				       else
					    DHdisplay(1173, 1187, "不舍千般虚妄业 难离业海万罪缚")
						local nx, ny, victim, victimid = selectPerson(7, 1)
						if nx == -1 then
							return 0
						end
						CleanWarMap(4, 0)
						SetWarMap(WAR.Person[victim]["坐标X"],WAR.Person[victim]["坐标Y"], 4, 2)						
						WAR.KHG[victimid] = 80
						War_ShowFight(pid, 0, 0, 0, WAR.Person[WAR.CurID]["坐标X"],WAR.Person[WAR.CurID]["坐标Y"], 185)	
				        AddPersonAttrib(pid, "内力", -500)
						return 1
				       end
				elseif qishu == 3 then
					local xy = JYMsgBox("怖畏暗邢", "目标伤害降低50%，持续两回合*消耗：内力500点", CC.EVB173, 2, pid)
					if xy ~= 1 then
						return 0
					end
				       if JY.Person[pid]["内力"] < 500 then
				          DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						  return 0
				       else
					    DHdisplay(1540, 1551, "众生若生怖畏心 自有暗邢自缚日")
						local nx, ny, victim, victimid = selectPerson(7, 1)
						if nx == -1 then
							return 0
						end
						CleanWarMap(4, 0)
						SetWarMap(WAR.Person[victim]["坐标X"],WAR.Person[victim]["坐标Y"], 4, 2)						
						WAR.BWAX[victimid] = 80
						War_ShowFight(pid, 0, 0, 0, WAR.Person[WAR.CurID]["坐标X"],WAR.Person[WAR.CurID]["坐标Y"], 185)	
				        AddPersonAttrib(pid, "内力", -500)
						return 1
				       end
				elseif qishu == 4 then
					local xy = JYMsgBox("极乐引", "自身6格范围内敌方无法移动*消耗：内力300点", CC.EVB173, 2, pid)
					if xy ~= 1 then
						return 0
					end
				       if WAR.JLY == 1 or JY.Person[pid]["内力"] < 300 then
				          DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						  return 0
				       else
					        DHdisplay(1551, 1572, "极乐世界永恒安 令离魔王犯纲毒")
					        CleanWarMap(4, 0)
					   		local x1 = WAR.Person[WAR.CurID]["坐标X"];
			                local y1 = WAR.Person[WAR.CurID]["坐标Y"];
			                for ex = x1 - 5, x1 + 5 do
				            for ey = y1 - 5, y1 + 5 do
					            SetWarMap(ex, ey, 4, 1)
					        if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
						        local ep = GetWarMap(ex, ey, 2)
						        if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[ep]["我方"] then
							       WAR.L_NOT_MOVE[WAR.Person[ep]["人物编号"]] = 1
							       SetWarMap(ex, ey, 4, 4)
						        end
					        end
				            end
			                end
			                War_ShowFight(pid,0,0,0,x1,y1,30);
				            AddPersonAttrib(pid, "内力", -300)
							return 1
				       end
				elseif qishu == 5 then
					local xy = JYMsgBox("贪魔体", "自身无法攻击且受到的伤害降低80%，持续两回合*消耗：内力500点", CC.EVB173, 2, pid)
					if xy ~= 1 then
						return 0
					end
				       if WAR.TMT[pid] ~= nil or JY.Person[pid]["内力"] < 1000 then
				          DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						  return 0
				       else
			           for i = 2987, 3009 do
				       CurIDTXDH(WAR.CurID, i, i, "忏罪消业降贪魔 净体不畏毒火海");		--动画显示	
				       lib.Delay(10)
			           end
					   addeffect(WAR.TMT, pid, 3)
				       AddPersonAttrib(pid, "内力", -1000)
					   return 1
				       end
				elseif qishu == 6 then
					local xy = JYMsgBox("幻光步", "移动至10格范围内任意地点*消耗：内力500点", CC.EVB173, 2, pid)
					if xy ~= 1 then
						return 0
					end
				       if JY.Person[pid]["内力"] < 500 then
				          DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						  return 0
				       else
                       local nyp = {}
                             DrawStrBox(CC.MainMenuX, CC.MainMenuY, CC.EVB183, C_GOLD, 30)
                             War_CalMoveStep(WAR.CurID, 10, 1) --武功移动步数
                             local nx, ny = nil, nil
                             while true do
	                         nx, ny = War_SelectMove() --显示+选择步数
	                         if nx ~= nil then
		                     if lib.GetWarMap(nx, ny, 2) > 0 or lib.GetWarMap(nx, ny, 5) > 0 then
		                        QZXS(CC.EVB186)			--此处有人！请重新选择
	                       	 elseif CC.SceneWater[lib.GetWarMap(nx, ny, 0)] ~= nil then
	                          	QZXS(CC.EVB187)		--水面，不可进入！请重新选择
	       	                 else
	       		             break;
	                   end
	                 end
	                end
	    PlayWavE(5)
	    CurIDTXDH(WAR.CurID, 1382, 1398, "接引离斯毒火海 幻光游世常自在")		--九阳明尊 挪移乾坤
	    local pid = WAR.CurID
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 1382, 1390)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 5, -1)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 2, -1)
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 1390, 1398)
	    WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] = nx, ny
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 1382, 1390)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 5, WAR.Person[WAR.CurID]["贴图"])
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 2, WAR.CurID)
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 1390, 1398)
	    WAR.CurID = pid
			          --[[ for i = 1849, 1864 do
				       CurIDTXDH(WAR.CurID, i, i, "接引离斯毒火海 幻光游世常自在");		--动画显示	
				       lib.Delay(10)
			           end]]
				       AddPersonAttrib(pid, "内力", -500)
					   return 1
				       end
			    end	
			end
		elseif wglw(pid,87) then
			local zhilingnum = 2
			if JY.Person[pid]["体力"] > 10 then		
            local qishu = JYMsgBox("化功大法", "散去目标内功", {"是", "否"}, zhilingnum, pid)				
			    if qishu == 1 then
					   if JY.Person[pid]["内力"] < 500 then
				          DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						  return 0
				       else
					    DHdisplay(1173, 1187, "化功大法 散功")
						local nx, ny, victim, victimid = selectPerson(7, 1)
						if nx == -1 then
							return 0
						end
						CleanWarMap(4, 0)
						SetWarMap(WAR.Person[victim]["坐标X"],WAR.Person[victim]["坐标Y"], 4, 2)		
						local zhilingnum = 0
						for n=1,HHH_GAME_SETTING["WG_COUNT_MAX"] do
						    if JY.Person[victimid]["武功"..n] > 0 then 
							zhilingnum = zhilingnum + 1
							end
						end	
						 local hg = JYMsgBox("化功大法", "散去目标哪个内功", {"一", "二", "三", "四", "五", "六", "七", "八", "九", "十"}, zhilingnum, pid)	
						 if hg == -1 then
						    return 0
						 end
						 if hg == 1 then 
						    WAR.SGDF = JY.Person[victimid]["武功1"]
							WAR.SGDF2 = victimid
						 elseif hg == 2 then 	
						    WAR.SGDF = JY.Person[victimid]["武功2"]
							WAR.SGDF2 = victimid
						 elseif hg == 3 then 	
						    WAR.SGDF = JY.Person[victimid]["武功3"]
							WAR.SGDF2 = victimid
						 elseif hg == 4 then 	
						    WAR.SGDF = JY.Person[victimid]["武功4"]
							WAR.SGDF2 = victimid
						 elseif hg == 5 then 	
						    WAR.SGDF = JY.Person[victimid]["武功5"]
							WAR.SGDF2 = victimid
						 elseif hg == 6 then 	
						    WAR.SGDF = JY.Person[victimid]["武功6"]
							WAR.SGDF2 = victimid
						 elseif hg == 7 then 	
						    WAR.SGDF = JY.Person[victimid]["武功7"]
							WAR.SGDF2 = victimid
						 elseif hg == 8 then 	
						    WAR.SGDF = JY.Person[victimid]["武功8"]
							WAR.SGDF2 = victimid
						 elseif hg == 9 then 	
						    WAR.SGDF = JY.Person[victimid]["武功9"]
							WAR.SGDF2 = victimid
						 elseif hg == 10 then 	
						    WAR.SGDF = JY.Person[victimid]["武功10"]
							WAR.SGDF2 = victimid
						 end
						War_ShowFight(pid, 0, 0, 0, WAR.Person[WAR.CurID]["坐标X"],WAR.Person[WAR.CurID]["坐标Y"], 185)	
				        AddPersonAttrib(pid, "内力", -500)
						return 1
				       end
				else
				    return 0
			    end	
			end
		elseif wglw(pid,88) then
			local zhilingnum = 2
			if JY.Person[pid]["体力"] > 10 then		
            local qishu = JYMsgBox("万象吸引", "时序吸收10格范围内敌方10点内力，目标流血时额外时序流血5点", {"是", "否"}, zhilingnum, pid)				
			    if qishu == 1 then
					   if JY.Person[pid]["内力"] < 500 or WAR.WXXY == 1 then
				          DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						  return 0
				       else
			               for i = 1123, 1141 do
				               CurIDTXDH(WAR.CurID, i, i, "吸星大法 万象吸引");		--动画显示	
				                lib.Delay(10)
			               end
				          WAR.WXXY = 1
				          return 1
			           end	
				else
				    return 0
			    end
			end	
		elseif wglw(pid,94) then
			local zhilingnum = 2
			if JY.Person[pid]["体力"] > 10 then		
            local qishu = JYMsgBox("神照功", "入座神照", {"复生", "续命"}, zhilingnum, pid)	
			        if qishu <= 0 then
					    return 0
				    end			
			    if qishu == 1 then
				    local sz= JYMsgBox("神照复生", "拥有两次复活自己或者队友的能力", {"是", "否"}, zhilingnum, pid)
					if sz ~= 1 then
						return 0
					end
					   if JY.Person[pid]["内力"] < 500 or WAR.RZSZ1 == 2 then
				          DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						  return 0
				       else
					    DHdisplay(1540, 1551, "神照神功 入座神照")
						local nx, ny, victim, victimid = selectPerson(7, 2)
						if nx == -1 then
							return 0
						end
						CleanWarMap(4, 0)
						SetWarMap(WAR.Person[victim]["坐标X"],WAR.Person[victim]["坐标Y"], 4, 2)
						if WAR.RZSZ[victimid] == 1 then 
						DrawStrBoxWaitKey("目标已经受到神照", C_WHITE, 30)
						return 0
						else
						WAR.RZSZ[victimid] = 1
						WAR.RZSZ1 = WAR.RZSZ1+1
						War_ShowFight(pid, 0, 0, 0, WAR.Person[WAR.CurID]["坐标X"],WAR.Person[WAR.CurID]["坐标Y"], 185)	
				        AddPersonAttrib(pid, "内力", -500)
				          return 1
						end
			           end
				elseif qishu == 2 then
				    local sz= JYMsgBox("生死同归", "选择敌方目标，己方生命不满将由此目标每人时序15点生命续命，限定一次", {"是", "否"}, zhilingnum, pid)
					if sz ~= 1 then
						return 0
					end	 
					   if JY.Person[pid]["内力"] < 500 or WAR.SSTG1 == 1 then
				          DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						  return 0
				       else
					    DHdisplay(1540, 1551, "入座神照 神照续命")
						local nx, ny, victim, victimid = selectPerson(7, 1)
						if nx == -1 then
							return 0
						end
						CleanWarMap(4, 0)
						SetWarMap(WAR.Person[victim]["坐标X"],WAR.Person[victim]["坐标Y"], 4, 2)
						if WAR.RZSZ[victimid] == 1 then 
						DrawStrBoxWaitKey("目标已经被选中", C_WHITE, 30)
						return 0
						else
						WAR.SSTG[victimid] = 1
						WAR.SSTG1 = 1
						War_ShowFight(pid, 0, 0, 0, WAR.Person[WAR.CurID]["坐标X"],WAR.Person[WAR.CurID]["坐标Y"], 185)	
				        AddPersonAttrib(pid, "内力", -500)
				          return 1
						end
			           end					
				else
				    return 0
			    end
			end	
		elseif wglw(pid,6) then
			local zhilingnum = 2
			if JY.Person[pid]["体力"] > 10 then		
            local qishu = JYMsgBox("碧海潮生曲", "所有敌方状态进入负波动状态，我方进入正波动状态，时序耗内20点", {"是", "否"}, zhilingnum, pid)				
			    if qishu == 1 then
					   if JY.Person[pid]["内力"] < 500 or WAR.BHCS[pid] == 1 then
				          DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						  return 0
				       else
			               for i = 1123, 1141 do
				               CurIDTXDH(WAR.CurID, i, i, "魔音灌耳 碧海潮生曲");		--动画显示	
				                lib.Delay(10)
			               end
				          WAR.BHCS[pid] = 1
				          return 1
			           end	
				else
				    return 0
			    end
			end
		elseif wglw(pid,90) then
			local zhilingnum = 2
			if JY.Person[pid]["体力"] > 50 then		
            local qishu = JYMsgBox("混元一气", "攻击必出招式，招式杀气翻倍，学有神行百变时，被攻击必定触发神行百变，时序耗体力2点", {"是", "否"}, zhilingnum, pid)				
			    if qishu == 1 then
					   if JY.Person[pid]["体力"] < 50 or WAR.HYYQ[pid] == 1 then
				          DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						  return 0
				       else
			               for i = 2523, 2538 do
				               CurIDTXDH(WAR.CurID, i, i, "混元一气 大海无量");		--动画显示	
				                lib.Delay(10)
			               end
				          WAR.HYYQ[pid] = 1
				          return 1
			           end	
				else
				    return 0
			    end
			end
		elseif wglw(pid,124) then
			local zhilingnum = 2
			if JY.Person[pid]["体力"] > 50 then		
            local qishu = JYMsgBox("寒冰气场", "自身8格范围内敌方集气降低30%，时序被冰封，时序耗自身内力15点", {"是", "否"}, zhilingnum, pid)				
			    if qishu == 1 then
					   if JY.Person[pid]["体力"] < 10 or WAR.BFQL[pid] == 1 then
				          DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						  return 0
				       else
			               for i = 2872, 2899 do
				               CurIDTXDH(WAR.CurID, i, i, "寒冰真气 冰封千里");		--动画显示	
				                lib.Delay(10)
			               end
				          WAR.BFQL[pid] = 1
				          return 1
			           end	
				else
				    return 0
			    end
			end
		elseif wglw(pid,102) then--1-26-
			local zhilingnum = 2
			if JY.Person[pid]["体力"] > 10 then		
            local qishu = JYMsgBox("万般归一", "五回合内随机出自身所学武功的组合特效", {"是", "否"}, zhilingnum, pid)				
			    if qishu == 1 then
					   if JY.Person[pid]["体力"] < 10 or WAR.HLTX1[pid] ~= nil then
				          DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						  return 0
				       else
			               for i = 2523, 2538 do
				               CurIDTXDH(WAR.CurID, i, i, "太玄神经 万般归一");		--动画显示	
				                lib.Delay(10)
			               end
				          addeffect(WAR.HLTX1, pid, 6)
				          return 1
			           end	
				else
				    return 0
			    end
			end
		elseif wglw(pid,189) then--1-26-
			local zhilingnum = 2
			if JY.Person[pid]["体力"] >= 0 then		
            local qishu = JYMsgBox("阳神阴圣", "依内力性质触发不同效果", {"是", "否"}, zhilingnum, pid)				
			    if qishu == 1 then
					   if JY.Person[pid]["体力"] < 0 or WAR.YYMZL == 1 then
				          DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						  return 0
				       else
			               for i = 1941, 1949 do
				               CurIDTXDH(WAR.CurID, i, i, "阳神降世 阴圣再临");		--动画显示	
				                lib.Delay(10)
			               end
							WAR.YYMZL = 1
							JY.Person[pid]["生命"] = JY.Person[pid]["生命最大值"]
							JY.Person[pid]["内力"] = JY.Person[pid]["内力最大值"]
							JY.Person[pid]["体力"] = 100
							if JY.Person[pid]["内力性质"] == 0 then
								WAR.YSZL[pid] = 50
							elseif	JY.Person[pid]["内力性质"] == 1 then
								WAR.YSJS[pid] = 50
							elseif 	JY.Person[pid]["内力性质"] == 2 then
								if math.random(10) > 5 then
								WAR.YSZL[pid] = 50
								else
								WAR.YSJS[pid] = 50
								end
							elseif	JY.Person[pid]["内力性质"] == 3 then
								WAR.YSZL[pid] = 50
								WAR.YSJS[pid] = 00
							end	
				          return 1
			           end	
				else
				    return 0
			    end
			end	
		else
		    QZXS("未曾领悟武学招式")
		end	
		end			
  end
  
--特色指令
function War_TgrtsMenu(flag, flag2)
    local pid = WAR.Person[WAR.CurID]["人物编号"]
    Cls()
    WAR.ShowHead = 0
    WarDrawMap(0)
    local yn
	if flag == nil or flag ~= 1 then		
		if pid == 0 then
			yn = JYMsgBox(CC.EVB172 .. GRTS[cxzj()], GRTSSAY[cxzj()], CC.EVB173, 2, pid)
		elseif ZLE(pid) then
			yn = JYMsgBox(CC.EVB172 .. GRTS[pid], GRTSSAY[pid], CC.EVB173, 2, 311)
		elseif LYR(pid) then
			yn = JYMsgBox(CC.EVB172 .. GRTS[pid], GRTSSAY[pid], CC.EVB173, 2, 312)
		elseif AN(pid) then
			yn = JYMsgBox(CC.EVB172 .. GRTS[pid], GRTSSAY[pid], CC.EVB173, 2, 25)
		else
			yn = JYMsgBox(CC.EVB172 .. GRTS[pid], GRTSSAY[pid], CC.EVB173, 2, pid)
		end	
	else
		yn = JYMsgBox(CC.EVB172 .. GRTS[flag2], GRTSSAY[flag2], CC.EVB173, 2, pid)
	end
    if yn == 2 then
       return 0
    end
  
	local function ownPD(id, p)
		if ((id == p) or CXTRT(id, p)) and (flag == nil or flag ~= 1) then
			return true
		end
		if ownMP() and MPPD(id) == 63 and (flag ~= nil and flag == 1) 
			and (flag2 ~= nil and flag2 == p) then
			return true
		end
		return false
	end


local function DIYWar_SelectMove()
    local x0 = WAR.Person[WAR.CurID]["坐标X"]
    local y0 = WAR.Person[WAR.CurID]["坐标Y"]
    local x = x0
    local y = y0
    while true do
    local x2 = x
    local y2 = y
    WarDrawMap(1, x, y)
    WarShowHead(GetWarMap(x, y, 2))
    ShowScreen()
    local key = WaitKey(1)
    if key == VK_UP then
      y2 = y - 1
    elseif key == VK_DOWN then
      y2 = y + 1
    elseif key == VK_LEFT then
      x2 = x - 1
    elseif key == VK_RIGHT then
      x2 = x + 1
    elseif key == VK_SPACE or key == VK_RETURN then
      return x, y
    elseif key == VK_ESCAPE then
      return nil, nil	  
    elseif key > 999999 then
      local kind, mx, my = nil, nil, nil
      if key > 1999999 then
        kind = 1
        key = key - 2000000
      else
        kind = 0
        key = key - 1000000
      end
      mx = math.modf((key) / 1000)
      my = math.fmod(key, 1000)
      mx = mx - CC.ScreenW / 2
      my = my - CC.ScreenH / 2
      mx = (mx) / CC.XScale
      my = (my) / CC.YScale
      mx, my = (mx + my) / 2, (my - mx) / 2
      if mx > 0 then
        mx = mx + 0.99
      else
        mx = mx - 0.01
      end
      if my > 0 then
        my = my + 0.99
      else
        mx = mx - 0.01
      end
      mx = math.modf(mx)
      my = math.modf(my)
      for i = 0, 10 do
        if mx + i <= 63 then
          if my + i > 63 then
            break;
          end
        end
        local hb = GetS(JY.SubScene, x0 + mx + i, y0 + my + i, 4)
        if CONFIG.Zoom == 1 then
          hb = hb * 2
        end
        if math.abs(hb - CC.YScale * i * 2) < 5 then
          mx = mx + i
          my = my + i
        end
      end
      x2, y2 = mx + x0, my + y0
      
      if kind == 1 then
      	return x, y
    	end
    end
    
    if GetWarMap(x2, y2, 3) < 128 then
      x = x2
      y = y2
    end
    end
end
 
  --段誉  
    if ownPD(pid , 53) then
    if JY.Person[pid]["体力"] > 20 then
      WAR.TZ_DY = 1
      PlayWavE(16)
      CurIDTXDH(WAR.CurID, 1080, 1085, CC.EVB174)
      CurIDTXDH(WAR.CurID, 1086, 1093, CC.EVB175)
      JY.Person[pid]["体力"] = JY.Person[pid]["体力"] - 10
    else
    	DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
    	return 0
    end
    end
    --豸苗：李秋水
    if ownPD(pid , 118) then
    if JY.Person[pid]["体力"] > 20 then
      WAR.LQSLB = 1
      PlayWavE(16)
      CurIDTXDH(WAR.CurID, 1080, 1085, CC.EVB174)
      CurIDTXDH(WAR.CurID, 1086, 1093, CC.EVB175)
      JY.Person[pid]["体力"] = JY.Person[pid]["体力"] - 10
    else
    	DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
    	return 0
    end
    end
    if ownPD(pid,114) then --扫地洗髓--17-2-19
		    local zhilingnum = 2
			if JY.Person[pid]["体力"] > 10 then			
			local qishu = JYMsgBox("洗髓", "是否要洗髓？", {"是", "否"}, zhilingnum, pid)
			    if qishu == 1 then
					local T = {}
			        for a = 1, 1000 do
				    local b = "" .. a
					    T[b] = a
				    end
			            DrawStrBoxWaitKey(CC.EVB124, C_WHITE, 30)
			            JY.Person[0]["资质"] = -1
			        while JY.Person[0]["资质"] == -1 do
				        local r = GetPinyin1(32, CC.ScreenH - CC.Fontbig * 6)
				    if T[r] ~= nil and T[r] > -1 and T[r] < 101 then
					         JY.Person[0]["资质"] = T[r]
				    else
					         DrawStrBoxWaitKey(CC.EVB125, C_WHITE, 30)
				    end
					end
				return 1	
			    else
				    return 0
			    end	
			end
	end  
    --虚竹
    if ownPD(pid , 49) then
    if JY.Person[pid]["体力"] > 20 and JY.Person[pid]["内力"] > 1000 then
      JY.Person[pid]["体力"] = JY.Person[pid]["体力"] - 5
      JY.Person[pid]["内力"] = JY.Person[pid]["内力"] - 500
      local ssh = {}
      local num = 1
      for i = 0, WAR.PersonNum - 1 do
        local wid = WAR.Person[i]["人物编号"]
        if WAR.TZ_XZ_SSH[wid] == 1 and WAR.Person[i]["死亡"] == false then
          if WAR.FXDS[wid] == nil then
            WAR.FXDS[wid] = 25
          else
            WAR.FXDS[wid] = WAR.FXDS[wid] + 25
          end
          if WAR.FXDS[wid] > 50 then
            WAR.FXDS[wid] = 50
          end
          WAR.TZ_XZ_SSH[wid] = nil
          if WAR.Person[i].Time > 995 then
            WAR.Person[i].Time = 995
          end
		  if WAR.TZ_XZ_SSH2[wid]~=nil then
		  if WAR.TZ_XZ_SSH2[wid] >0 and WAR.TZ_XZ_SSH2[wid] <4 and WAR.Person[i]["死亡"] == false then
		     local aa=math.modf(JY.Person[wid]["内力"]/(7-WAR.TZ_XZ_SSH2[wid]))
		     WAR.Person[i]["内力点数"] = (WAR.Person[i]["内力点数"] or 0) + AddPersonAttrib(wid, "内力", -aa)
		  elseif WAR.TZ_XZ_SSH2[wid]>=4 and WAR.Person[i]["死亡"] == false then
			 local aa=math.modf(JY.Person[wid]["内力"]/(7-WAR.TZ_XZ_SSH2[wid]))
			 local bb= math.modf(aa/20)
			 WAR.Person[i]["内力点数"] = (WAR.Person[i]["内力点数"] or 0) + AddPersonAttrib(wid, "内力", -aa)
			 WAR.Person[i]["生命点数"] = (WAR.Person[i]["生命点数"] or 0) + AddPersonAttrib(wid, "生命", -bb)
		  end
		  WAR.TZ_XZ_SSH2[wid] = nil
		  end
          ssh[num] = {}
          ssh[num][1] = i
          ssh[num][2] = wid
          num = num + 1
        end
      end
      local name = {}
      for i = 1, num - 1 do
        name[i] = {}
        name[i][1] = JY.Person[ssh[i][2]]["姓名"]
        name[i][2] = nil
        name[i][3] = 1
      end
      DrawStrBox(CC.MainMenuX, CC.MainMenuY, CC.EVB177, C_GOLD, 30)
      ShowMenu(name, num - 1, 10, CC.MainMenuX, CC.MainMenuY + 45, 0, 0, 1, 0, CC.DefaultFont, C_RED, C_GOLD)
      Cls()
      PlayWavAtk(32)
      CurIDTXDH(WAR.CurID, 1325, 1344, CC.EVB178)
      PlayWavE(8)
      local sssid = lib.SaveSur(0, 0, CC.ScreenW, CC.ScreenH)
      for DH = 114, 129 do
        for i = 1, num - 1 do
          local x0 = WAR.Person[WAR.CurID]["坐标X"]
          local y0 = WAR.Person[WAR.CurID]["坐标Y"]
          local dx = WAR.Person[ssh[i][1]]["坐标X"] - x0
          local dy = WAR.Person[ssh[i][1]]["坐标Y"] - y0
          local rx = CC.XScale * (dx - dy) + CC.ScreenW / 2
          local ry = CC.YScale * (dx + dy) + CC.ScreenH / 2
          local hb = GetS(JY.SubScene, dx + x0, dy + y0, 4)
          if CONFIG.Zoom == 1 then
            hb = hb * 2
          end
          ry = ry - hb
          lib.PicLoadCache(3, DH * 2, rx, ry, 2, 192)
          if DH > 124 then
            DrawString(rx - 10, ry - 15, CC.EVB179, C_GOLD, 30)
          end
        end
        lib.ShowSurface(0)
        lib.LoadSur(sssid, 0, 0)
        lib.Delay(30)
      end
      lib.FreeSur(sssid)
    else
    	DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
    	return 0
    end
    end
  
    if ownPD(pid , 83) then --何铁手龙眠蛊
    if JY.Person[pid]["体力"] > 20 and JY.Person[pid]["内力"] > 1000 then
      JY.Person[pid]["体力"] = JY.Person[pid]["体力"] - 15
      JY.Person[pid]["内力"] = JY.Person[pid]["内力"] - 500
      local lmg = {}
      local num = 1
      for i = 0, WAR.PersonNum - 1 do
        local wid = WAR.Person[i]["人物编号"]
        if WAR.Person[i]["我方"] == false and WAR.Person[i]["死亡"] == false 
			and RealJL(WAR.CurID, i, 4) and WAR.GUDUVICTIE[wid] == nil then
          WAR.GUDUVICTIE[wid] = 2
          lmg[num] = {}
          lmg[num][1] = i
          lmg[num][2] = wid
          num = num + 1
        end
      end
      local name = {}
      for i = 1, num - 1 do
        name[i] = {}
        name[i][1] = JY.Person[lmg[i][2]]["姓名"]
        name[i][2] = nil
        name[i][3] = 1
      end
      DrawStrBox(CC.MainMenuX, CC.MainMenuY, "下蛊：", C_GOLD, 30)
      ShowMenu(name, num - 1, 10, CC.MainMenuX, CC.MainMenuY + 45, 0, 0, 1, 0, CC.DefaultFont, C_RED, C_GOLD)
      Cls()
      local sssid = lib.SaveSur(0, 0, CC.ScreenW, CC.ScreenH)
      for DH = 575, 586 do
        for i = 1, num - 1 do
          local x0 = WAR.Person[WAR.CurID]["坐标X"]
          local y0 = WAR.Person[WAR.CurID]["坐标Y"]
          local dx = WAR.Person[lmg[i][1]]["坐标X"] - x0
          local dy = WAR.Person[lmg[i][1]]["坐标Y"] - y0
          local rx = CC.XScale * (dx - dy) + CC.ScreenW / 2
          local ry = CC.YScale * (dx + dy) + CC.ScreenH / 2
          local hb = GetS(JY.SubScene, dx + x0, dy + y0, 4)
          if CONFIG.Zoom == 1 then
            hb = hb * 2
          end
          ry = ry - hb
          lib.PicLoadCache(3, DH * 2, rx, ry, 2, 192)
          if DH > 580 then
            DrawString(rx - 10, ry - 25, "中蛊", C_GOLD, 30)
          end
        end
        lib.ShowSurface(0)
        lib.LoadSur(sssid, 0, 0)
        lib.Delay(30)
      end
      lib.FreeSur(sssid)
    else
    	DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
    	return 0
    end
    end  
  
    --人厨子
    if ownPD(pid , 89) then
    if JY.Person[pid]["体力"] > 25 and JY.Person[pid]["内力"] > 300 then
      local px, py = WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"]
      local mxy = {
      {WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] + 1}, 
      {WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] - 1}, 
      {WAR.Person[WAR.CurID]["坐标X"] + 1, WAR.Person[WAR.CurID]["坐标Y"]}, 
      {WAR.Person[WAR.CurID]["坐标X"] - 1, WAR.Person[WAR.CurID]["坐标Y"]}}
      local zdp = {}
      local num = 1
      for i = 1, 4 do
        if GetWarMap(mxy[i][1], mxy[i][2], 2) >= 0 then
          local mid = GetWarMap(mxy[i][1], mxy[i][2], 2)
          if inteam(WAR.Person[mid]["人物编号"]) then
          	zdp[num] = WAR.Person[mid]["人物编号"]
          	num = num + 1
        	end
        end
        
      end
      local zdp2 = {}
      for i = 1, num - 1 do
        zdp2[i] = {}
        zdp2[i][1] = JY.Person[zdp[i]]["姓名"] .. "・" .. JY.Person[zdp[i]]["体力"]
        zdp2[i][2] = nil
        zdp2[i][3] = 1
      end
      DrawStrBox(CC.MainMenuX, CC.MainMenuY, CC.EVB180, C_GOLD, 30)
      local r = ShowMenu(zdp2, num - 1, 10, CC.MainMenuX, CC.MainMenuY + 45, 0, 0, 1, 0, CC.DefaultFont, C_RED, C_GOLD)
      Cls()
      AddPersonAttrib(zdp[r], "体力", 50)
      AddPersonAttrib(pid, "体力", -25)
      AddPersonAttrib(pid, "内力", -300)
      PlayWavE(28)
      lib.Delay(10)
      CurIDTXDH(WAR.CurID, 1367, 1377, CC.EVB181)
      local Ocur = WAR.CurID
      for i = 0, WAR.PersonNum - 1 do
        if WAR.Person[i]["人物编号"] == zdp[r] then
          WAR.CurID = i
        end
      end
      WarDrawMap(0)
      PlayWavE(36)
      lib.Delay(100)
      CurIDTXDH(WAR.CurID, 1355, 1365, CC.EVB182)
      WAR.CurID = Ocur
      WarDrawMap(0)
    else
    	DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
    	return 0
    end
    end
  
    --张无忌
    if ownPD(pid , 9) then
    if JY.Person[pid]["体力"] > 10 and JY.Person[pid]["内力"] > 500 then
      local nyp = {}
      local num = 1
      for i = 0, WAR.PersonNum - 1 do
        if WAR.Person[i]["我方"] == true and WAR.Person[i]["死亡"] == false and RealJL(WAR.CurID, i, 8) and i ~= WAR.CurID then
          nyp[num] = {}
          nyp[num][1] = JY.Person[WAR.Person[i]["人物编号"]]["姓名"]
          nyp[num][2] = nil
          nyp[num][3] = 1
          nyp[num][4] = i
          num = num + 1
        end
      end
      DrawStrBox(CC.MainMenuX, CC.MainMenuY, CC.EVB183, C_GOLD, 30)
      local r = ShowMenu(nyp, num - 1, 10, CC.MainMenuX, CC.MainMenuY + 45, 0, 0, 1, 0, CC.DefaultFont, C_RED, C_GOLD)
      Cls()
      local mid = WAR.Person[nyp[r][4]]["人物编号"]
      QZXS(CC.EVB184 .. JY.Person[mid]["姓名"] .. CC.EVB185)
      War_CalMoveStep(WAR.CurID, 8, 1) --武功移动步数
      local nx, ny = nil, nil
      while true do
	      nx, ny = War_SelectMove() --显示+选择步数
	      if nx ~= nil then
		      if lib.GetWarMap(nx, ny, 2) > 0 or lib.GetWarMap(nx, ny, 5) > 0 then
		        QZXS(CC.EVB186)			--此处有人！请重新选择
	      	elseif CC.SceneWater[lib.GetWarMap(nx, ny, 0)] ~= nil then
	        	QZXS(CC.EVB187)		--水面，不可进入！请重新选择
	       	else
	       		break;
	        end
	      end
	    end
	    PlayWavE(5)
	    CurIDTXDH(WAR.CurID, 1382, 1398, CC.EVB188)		--九阳明尊 挪移乾坤
	    local Ocur = WAR.CurID
	    WAR.CurID = nyp[r][4]
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 1382, 1390)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 5, -1)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 2, -1)
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 1390, 1398)
	    WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] = nx, ny
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 1382, 1390)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 5, WAR.Person[WAR.CurID]["贴图"])
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 2, WAR.CurID)
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 1390, 1398)
	    WAR.CurID = Ocur
	    AddPersonAttrib(pid, "体力", -10)
	    AddPersonAttrib(pid, "内力", -500)
	    
	  else
	  	DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
	  	return 0
	  end
	end
	
	--祖千秋
	if ownPD(pid , 88) then
	  if JY.Person[pid]["体力"] > 10 and JY.Person[pid]["内力"] > 700 then
	    local dxp = {}
	    local num = 1
	    for i = 0, WAR.PersonNum - 1 do --搜集5格内人物资料
	      if WAR.Person[i]["我方"] == true and WAR.Person[i]["死亡"] == false and RealJL(WAR.CurID, i, 5) and i ~= WAR.CurID then
	        dxp[num] = {}
	        dxp[num][1] = JY.Person[WAR.Person[i]["人物编号"]]["姓名"] --姓名
	        dxp[num][2] = nil
	        dxp[num][3] = 1
	        dxp[num][4] = i --战场编号
	        num = num + 1
	      end
	    end
	    DrawStrBox(CC.MainMenuX, CC.MainMenuY, CC.EVB189, C_GOLD, 30)
	    local r = ShowMenu(dxp, num - 1, 10, CC.MainMenuX, CC.MainMenuY + 45, 0, 0, 1, 0, CC.DefaultFont, C_RED, C_GOLD)
	    Cls()
	    local mid = WAR.Person[dxp[r][4]]["人物编号"] --选择人物，实际编号
	    PlayWavE(28)
	    lib.Delay(10)
	    CurIDTXDH(WAR.CurID, 1458, 1442, CC.EVB190)
	    local Ocur = WAR.CurID
	    WAR.CurID = dxp[r][4] --选择的人物暂时变行动人物，战场动画移动
	    WarDrawMap(0)
	    PlayWavE(36)
	    lib.Delay(100)
	    CurIDTXDH(WAR.CurID, 1442, 1458, CC.EVB191)
	    WAR.CurID = Ocur
	    WarDrawMap(0)
	    WAR.Person[dxp[r][4]].Time = WAR.Person[dxp[r][4]].Time + 500
	    if WAR.Person[dxp[r][4]].Time > 999 then
	      WAR.Person[dxp[r][4]].Time = 999
	    end
	    AddPersonAttrib(pid, "体力", -10)
	    AddPersonAttrib(pid, "内力", -1000)
	  else
	  	DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
	  	return 0
		end
	end
	
	--蓝烟清：霍青桐统率指令，我方全体集气值加200点
	if ownPD(pid , 74) then
		if JY.Person[pid]["体力"] > 10 and JY.Person[pid]["内力"] > 150 then
			CurIDTXDH(WAR.CurID, 1186, 1192, GRTS[74]);		--动画显示
			for i = 0, WAR.PersonNum - 1 do
				if WAR.Person[i]["我方"] == true and WAR.Person[i]["死亡"] == false and i ~= WAR.CurID then
					WAR.Person[i].Time = WAR.Person[i].Time + 200;
					if WAR.Person[i].Time > 999 then
						WAR.Person[i].Time = 999;
					end
				end
			end
			AddPersonAttrib(pid, "体力", -10)
	    AddPersonAttrib(pid, "内力", -150)
	    lib.Delay(100)
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
	  	return 0
		end
	end
	
	if ownPD(pid, 37) then --狄云神照指令
		if JY.Person[pid]["内力"] >= 2000 then
			for i = 1790, 1801 do
				CurIDTXDH(WAR.CurID, i, i, "极意・神照无影");		--动画显示	
				lib.Delay(10)
			end
			WAR.DYWY[pid] = 1
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
	  	return 0
		end	
	end
	
	if ownPD(pid, 54) then --袁承志虎乱
		for i = 1251, 1257 do
			CurIDTXDH(WAR.CurID, i, i, "虎乱无双");		--动画显示	
			lib.Delay(10)
		end
		WAR.YCZHL[pid] = 100
		zhanyi(pid, 3, 1)
	end		
	
	if ownPD(pid , 91) then --青青大暴指令
		if JY.Person[pid]["体力"] > 20 then
			for i = 1251, 1257 do
				CurIDTXDH(WAR.CurID, i, i, "大暴青青 逆我者亡");		--动画显示	
				lib.Delay(10)
			end
			AddPersonAttrib(pid, "体力", -10)
			WAR.QQDB = 1
			--War_FightMenu()
			--WAR.QQDB = 0
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
	  	return 0
		end
	end	
	
	if ownPD(pid , 1) then --胡斐飞狐指令
		if JY.Person[pid]["体力"] > 10 then
			for i = 1790, 1801 do
				CurIDTXDH(WAR.CurID, i, i, "踏雪无痕 神行飞天");		--动画显示	
				lib.Delay(10)
			end
			AddPersonAttrib(pid, "体力", -5)
			WAR.HUFEI = 1
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
	  	return 0
		end
	end		
	
	if ownPD(pid , 662) then --水镜灵罡指令
		if WAR.LINGGANG == 0 then
			WAR.LINGGANG = 1
			local lgmenu = JYMsgBox("灵罡指令", "要转换成哪种内力？", {"阴性", "阳性", "调和"}, 3, pid)	
			if lgmenu == 1 then
				JY.Person[pid]["内力性质"] = 0
				QZXS("内力转换为阴性")
				if JY.Person[pid]["声望"] == 106 then
					JY.Person[pid]["声望"] = 0
					QZXS("取消九阳神功的主功体特效")
				end				
			elseif lgmenu == 2 then
				JY.Person[pid]["内力性质"] = 1
				QZXS("内力转换为阳性")
				if JY.Person[pid]["声望"] == 107 then
					JY.Person[pid]["声望"] = 0
					QZXS("取消九阴神功的主功体特效")
				end
			else
				JY.Person[pid]["内力性质"] = 2
				QZXS("内力转换为调和")
				if JY.Person[pid]["声望"] == 106 then
					JY.Person[pid]["声望"] = 0
					QZXS("取消九阳神功的主功体特效")
				end		
				if JY.Person[pid]["声望"] == 107 then
					JY.Person[pid]["声望"] = 0
					QZXS("取消九阴神功的主功体特效")
				end		
			end
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
	  	return 0
		end
	end		
  
    if ownPD(pid , 55) then --郭靖灵罡指令
		if WAR.LINGGANG == 0 then
			WAR.LINGGANG = 1
			local lgmenu = JYMsgBox("灵罡指令", "要转换成哪种内力？", {"阴性", "阳性", "调和"}, 3, pid)	
			if lgmenu == 1 then
				JY.Person[pid]["内力性质"] = 0
				QZXS("内力转换为阴性")
				if JY.Person[pid]["声望"] == 106 then
					JY.Person[pid]["声望"] = 0
					QZXS("取消九阳神功的主功体特效")
				end				
			elseif lgmenu == 2 then
				JY.Person[pid]["内力性质"] = 1
				QZXS("内力转换为阳性")
				if JY.Person[pid]["声望"] == 107 then
					JY.Person[pid]["声望"] = 0
					QZXS("取消九阴神功的主功体特效")
				end
			else
				JY.Person[pid]["内力性质"] = 2
				QZXS("内力转换为调和")
				if JY.Person[pid]["声望"] == 106 then
					JY.Person[pid]["声望"] = 0
					QZXS("取消九阳神功的主功体特效")
				end		
				if JY.Person[pid]["声望"] == 107 then
					JY.Person[pid]["声望"] = 0
					QZXS("取消九阴神功的主功体特效")
				end		
			end
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
	  	return 0
		end
	end		
  
	if ownPD(pid , 56) then --黄蓉奇阵指令
		if JY.Person[pid]["体力"] >= 20 then
		    War_CalMoveStep(WAR.CurID, 8, 1) --武功移动步数
			local nx, ny = nil, nil
			local victim = -1
			local victimid = -1
			while true do
				nx, ny = DIYWar_SelectMove() --显示+选择步数
				if nx == nil then
					return 0
				end
				if nx ~= nil then
					if lib.GetWarMap(nx, ny, 2) < 0 and lib.GetWarMap(nx, ny, 5) < 0 then
						QZXS("此处无人，请重新选择")			
					elseif GetWarMap(nx, ny, 2) == nil or GetWarMap(nx, ny, 2) < 0 then
						QZXS("此处无人，请重新选择")	
					else
						victim = GetWarMap(nx, ny, 2)
						victimid = WAR.Person[victim]["人物编号"]
						if WAR.Person[WAR.CurID]["我方"] == WAR.Person[victim]["我方"] then
							QZXS("不能选择我方人物")	
						elseif WAR.QIZHEN[victimid] == 1 then
							QZXS("此人已经在阵内！")	
						else
							break;
						end
					end
				end
			end
			WAR.QIZHEN[victimid] = 1
			WAR.L_NOT_MOVE[victimid] = 1
			QZXS(JY.Person[victimid]["姓名"].."被奇门八阵所困！")
			AddPersonAttrib(pid, "体力", -15)		
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
			return 0
		end	
	end	
   
   
	if ownPD(pid , 76) then --王语嫣点破指令
		if JY.Person[pid]["体力"] >= 20 then
		    War_CalMoveStep(WAR.CurID, 6, 1) --武功移动步数
			local nx, ny = nil, nil
			local victim = -1
			local victimid = -1
			while true do
				nx, ny = DIYWar_SelectMove() --显示+选择步数
				if nx == nil then
					return 0
				end
				if nx ~= nil then
					if lib.GetWarMap(nx, ny, 2) < 0 and lib.GetWarMap(nx, ny, 5) < 0 then
						QZXS("此处无人，请重新选择")			
					elseif GetWarMap(nx, ny, 2) == nil or GetWarMap(nx, ny, 2) < 0 then
						QZXS("此处无人，请重新选择")	
					else
						victim = GetWarMap(nx, ny, 2)
						victimid = WAR.Person[victim]["人物编号"]
						if WAR.Person[WAR.CurID]["我方"] == WAR.Person[victim]["我方"] then
							QZXS("不能选择我方人物")	
						else
							break;
						end
					end
				end
			end
			WAR.WYY[victimid] = 1
			
			QZXS(JY.Person[victimid]["姓名"].."被点破")
			AddPersonAttrib(pid, "体力", -5)		
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
			return 0
		end	
	end	   
 
	if ownPD(pid, 73) then --任盈盈幽韵指令
		if JY.Person[pid]["体力"] >= 15 and JY.Person[pid]["内力"] >= 1000 then
		    local tmprandom = math.random(3)			
			if tmprandom == 1 then
				for i = 2301, 2316 do
					CurIDTXDH(WAR.CurID, i, i, "浔阳夜月");		
					lib.Delay(10)
				end				
				for i = 0, WAR.PersonNum - 1 do
					local tmppid = WAR.Person[i]["人物编号"]
					if WAR.Person[i]["死亡"] == false and not WAR.Person[i]["我方"] then
					 WAR.ATKDOWN[tmppid] = 30
					end
				end				
			elseif tmprandom == 2 then
				for i = 2301, 2316 do
					CurIDTXDH(WAR.CurID, i, i, "平沙落雁");			
					lib.Delay(10)
				end				
				for i = 0, WAR.PersonNum - 1 do
					local tmppid = WAR.Person[i]["人物编号"]
					if WAR.Person[i]["死亡"] == false and not WAR.Person[i]["我方"] then
					  WAR.SPDDOWN[tmppid] = 30
					end
				end					
			else
				for i = 2301, 2316 do
					CurIDTXDH(WAR.CurID, i, i, "阳春白雪");			
					lib.Delay(10)
				end				
				for i = 0, WAR.PersonNum - 1 do
					local tmppid = WAR.Person[i]["人物编号"]
					if WAR.Person[i]["死亡"] == false and not WAR.Person[i]["我方"] then
					  WAR.DEFDOWN[tmppid] = 30
					end
				end								
			end
			AddPersonAttrib(pid, "体力", -10)
			AddPersonAttrib(pid, "内力", -600)
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
			return 0
		end	
	end	  
 
	if ownPD(pid , 581) then --曲非烟清弦指令
		if JY.Person[pid]["体力"] >= 15 and JY.Person[pid]["内力"] >= 1000 then
		    local tmprandom = math.random(4)			
			if tmprandom == 1 then
				for i = 2301, 2316 do
					CurIDTXDH(WAR.CurID, i, i, "飞燕凌波");		--飞燕凌波 30时序内速度+5	
					lib.Delay(10)
				end				
				for i = 0, WAR.PersonNum - 1 do
					local tmppid = WAR.Person[i]["人物编号"]
					if WAR.Person[i]["死亡"] == false and WAR.Person[i]["我方"] then
					  WAR.QFY1[tmppid] = 30
					end
				end				
			elseif tmprandom == 2 then
				for i = 2301, 2316 do
					CurIDTXDH(WAR.CurID, i, i, "破虏令");			
					lib.Delay(10)
				end				
				for i = 0, WAR.PersonNum - 1 do
					local tmppid = WAR.Person[i]["人物编号"]
					if WAR.Person[i]["死亡"] == false and WAR.Person[i]["我方"] then
					  WAR.QFY2[tmppid] = 30
					end
				end					
			elseif tmprandom == 3 then
				for i = 2301, 2316 do
					CurIDTXDH(WAR.CurID, i, i, "空山鸣涧");			
					lib.Delay(10)
				end				
				for i = 0, WAR.PersonNum - 1 do
					local tmppid = WAR.Person[i]["人物编号"]
					if WAR.Person[i]["死亡"] == false and WAR.Person[i]["我方"] then
					  WAR.QFY3[tmppid] = 30
					end
				end					
			else				
				for i = 2301, 2316 do
					CurIDTXDH(WAR.CurID, i, i, "寒梅映雪");		--寒梅映雪回伤10回毒20回血100	
					lib.Delay(10)
				end		
				for i = 0, WAR.PersonNum - 1 do
					local tmppid = WAR.Person[i]["人物编号"]
					if WAR.Person[i]["死亡"] == false and WAR.Person[i]["我方"] then
					  AddPersonAttrib(tmppid, "受伤程度", -10)
					  AddPersonAttrib(tmppid, "中毒程度", -20)
					  AddPersonAttrib(tmppid, "生命", 100)
					end
				end				
			end
			AddPersonAttrib(pid, "体力", -10)
			AddPersonAttrib(pid, "内力", -600)
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
			return 0
		end	
	end	  
	
	if ownPD(pid , 38) then --石破天飒行指令
		if JY.Person[pid]["体力"] > 15 then
			for i = 1209, 1228 do
				CurIDTXDH(WAR.CurID, i, i, "银鞍照白马 飒沓如流星");		--动画显示	
				lib.Delay(10)
			end
			AddPersonAttrib(pid, "体力", -10)
			WAR.SAXING = 0
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
	  	return 0
		end
	end			
	
	
	if ownPD(pid , 51) then --慕容幻梦
		if JY.Person[pid]["体力"] > 5 and JY.Person[pid]["内力"] > 500 then
			for i = 1637, 1654 do
				CurIDTXDH(WAR.CurID, i, i, "斗转星移・幻梦星辰");		--动画显示	
				lib.Delay(10)
			end
			AddPersonAttrib(pid, "体力", -5)
			AddPersonAttrib(pid, "内力", -500)
			WAR.HMXC = 3
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
	  	return 0
		end
	end			
	
	if ownPD(pid , 11) then --杨逍乾坤
		if JY.Person[pid]["体力"] > 20 and JY.Person[pid]["内力"] > 1000 then
			for i = 1637, 1654 do
				CurIDTXDH(WAR.CurID, i, i, "乾坤无极");		--动画显示	
				lib.Delay(10)
			end
			AddPersonAttrib(pid, "体力", -15)
			WAR.YX = 3
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
	  	return 0
		end
	end		
	
	if ownPD(pid , 92) then --mm宿缘
		if JY.Person[pid]["体力"] > 10 then
			for i = 1552, 1571 do
				CurIDTXDH(WAR.CurID, i, i, "但为君故 沉吟至今");		--动画显示	
				lib.Delay(10)
			end
			AddPersonAttrib(pid, "体力", -2)
			WAR.MMSY = WAR.MMSY + 1
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
			return 0
		end	
	end

	if ownPD(pid, 656) then --赵灵儿梦蛇
		if JY.Person[pid]["内力"] > 700 and WAR.LQZ[pid] ~= nil and WAR.LQZ[pid] >= 100 then
			for i = 1229, 1243 do
				CurIDTXDH(WAR.CurID, i, i, "梦蛇觉醒");		--动画显示	
				lib.Delay(10)
			end
			for i = 0, WAR.PersonNum - 1 do			      	  
				local tmppid = WAR.Person[i]["人物编号"]
				if WAR.Person[i]["死亡"] == false and WAR.Person[i]["我方"] and tmppid ~= 92 then
					WAR.LQZ[tmppid] = 100
					WAR.Person[i].Time = WAR.Person[i].Time + 200;						
					if WAR.Person[i].Time > 999 then
						WAR.Person[i].Time = 999;
					end						
				end
			end
			WAR.LQZ[pid] = 0
			AddPersonAttrib(pid, "内力", -700)
			WAR.ZLEZL = WAR.ZLEZL + 1
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
			return 0
		end				
	elseif ownPD(pid, 655) then --林月如指令
		if JY.Person[pid]["内力"] > 1000 and JY.Person[pid]["体力"] > 10 then
			for i = 97, 112 do
				CurIDTXDH(WAR.CurID, i, i, "七诀剑气");		--动画显示	
				lib.Delay(10)
			end
			WAR.LYR = 1
			War_FightMenu()
			AddPersonAttrib(pid, "内力", -500)
			AddPersonAttrib(pid, "体力", -10)
			WAR.LYRZL = WAR.LYRZL + 1
			WAR.LYR = 0
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
			return 0
		end			
	elseif ownPD(pid, 657) then		--阿奴夺魂指令
		if JY.Person[pid]["体力"] > 50 then
			War_CalMoveStep(WAR.CurID, 8, 1) --武功移动步数
			local nx, ny = nil, nil
			local victim = -1
			local victimid = -1
			while true do
				nx, ny = War_SelectMove() --显示+选择步数
				if nx == nil then
					return 0
				end
				if nx ~= nil then
					if lib.GetWarMap(nx, ny, 2) < 0 and lib.GetWarMap(nx, ny, 5) < 0 then
						QZXS("此处无人，请重新选择")			
					elseif GetWarMap(nx, ny, 2) == nil or GetWarMap(nx, ny, 2) < 0 then
						QZXS("此处无人，请重新选择")	
					else
						victim = GetWarMap(nx, ny, 2)
						victimid = WAR.Person[victim]["人物编号"]
						if WAR.Person[WAR.CurID]["我方"] == WAR.Person[victim]["我方"] then
							QZXS("不能选择我方人物")	
						else
							break;
						end
					end
				end
			end
			for xx = 0, 63 do
				for yy = 0, 63 do
					SetWarMap(xx, yy, 4, -1)
				end
			end
			SetWarMap(nx, ny, 4, 6)
			War_ShowFight(pid,0,0,0,nx,ny,54);
			SetWarMap(nx, ny, 4, -1)
			AddPersonAttrib(pid, "体力", -15)	
			WAR.AN[victimid] = 50
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
			return 0
		end
	end
			
	if ownPD(pid , 61) then --欧阳克蛇笛指令
		if JY.Person[pid]["体力"] >= 15 and WAR.SHEDI == 0  then		
			AddPersonAttrib(pid, "体力", -10)
			WAR.SHEDI = 1
			--JY.Person[419]["攻击力"]=370
			--JY.Person[419]["防御力"]=280
			--JY.Person[419]["轻功"]=350
			--JY.Person[419]["武功等级1"]=999
			--JY.Person[419]["武功2"]=95
			--JY.Person[419]["武功等级2"]=999		
			--JY.Person[419]["声望"]=95	
			--JY.Person[419]["内力最大值"]=4000
			--JY.Person[419]["生命最大值"]=1800		
			--JY.Person[419]["内力"]=4000
			--JY.Person[419]["生命"]=1800				
			--WAR.NPC[419] = 1000
			local x, y = WE_xy(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] - 1)
			NewWARPersonZJ(419, true, x, y, false, 2);
			local s = nil
			s = WAR.CurID
			WAR.CurID = WAR.PersonNum - 1
			Talk("嘶~~~嘶~~~嘶~~~", 419)  
			WAR.CurID = s
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
			return 0
	  end
	end	
	
	if ownPD(pid , 592) then --独孤求败神雕指令
		if JY.Person[pid]["体力"] >= 15 and WAR.SHENDIAO == 0  then		
			AddPersonAttrib(pid, "体力", -10)
			WAR.SHENDIAO = 1
			--JY.Person[607]["攻击力"]=450
			--JY.Person[607]["防御力"]=300
			--JY.Person[607]["轻功"]=250
			--JY.Person[607]["武功等级1"]=999
			--JY.Person[607]["武功2"]=103 --武骧金星：功体搭配
			--JY.Person[607]["武功等级2"]=999		
			--JY.Person[607]["声望"]=103	
			--JY.Person[607]["内力最大值"]=5000
			--JY.Person[607]["生命最大值"]=1800	
			--JY.Person[607]["内力"]=5000
			--JY.Person[607]["生命"]=1800					
			--WAR.NPC[607] = 1000
			local x, y = WE_xy(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] - 1)
			NewWARPersonZJ(607, true, x, y, false, 2);
			local s = nil
			s = WAR.CurID
			WAR.CurID = WAR.PersonNum - 1
			Talk("嘎~~~嘎~~~嘎~~~", 607)  
			WAR.CurID = s
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
			return 0
	  end
	end

	if ownPD(pid , 631) then --殷离千蛛指令
		if JY.Person[pid]["体力"] >= 15 and WAR.QIANZHU == 0 then		
			AddPersonAttrib(pid, "体力", -10)
			WAR.QIANZHU = 1
			local x, y = WE_xy(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] - 1)
			NewWARPersonZJ(430, true, x, y, false, 2);
			local s = nil
			s = WAR.CurID
			WAR.CurID = WAR.PersonNum - 1
			Talk("吱~~~吱~~~吱~~~", 430)  
			WAR.CurID = s
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
			return 0
	  end
	end

	if ownPD(pid , 25) then --蓝凤凰金蟾指令
		if JY.Person[pid]["体力"] >= 15 and WAR.JINCHAN == 0 then		
			AddPersonAttrib(pid, "体力", -10)
			WAR.JINCHAN = 1
			local x, y = WE_xy(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] - 1)
			NewWARPersonZJ(440, true, x, y, false, 2);
			local s = nil
			s = WAR.CurID
			WAR.CurID = WAR.PersonNum - 1
			Talk("咕~~~咕~~~咕~~~", 440)  
			WAR.CurID = s
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
			return 0
	  end
	end

	if ownPD(pid , 55) then --郭靖灵雕指令
		if JY.Person[pid]["体力"] >= 15 and WAR.LINGDIAO == 0 then		
			AddPersonAttrib(pid, "体力", -10)
			WAR.LINGDIAO = 1
			local x, y = WE_xy(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] - 1)
			NewWARPersonZJ(580, true, x, y, false, 2);
			local s = nil
			s = WAR.CurID
			WAR.CurID = WAR.PersonNum - 1
			Talk("嘎~~~嘎~~~嘎~~~", 580)  
			WAR.CurID = s
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
			return 0
	  end
	end
	
	if ownPD(pid,614) then --阿青心猿指令
		if JY.Person[pid]["体力"] >= 15 and WAR.XINYUAN == 0 then		
			AddPersonAttrib(pid, "体力", -10)
			WAR.XINYUAN = 1
			local x, y = WE_xy(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] - 1)
			NewWARPersonZJ(613, true, x, y, false, 2);
			local s = nil
			s = WAR.CurID
			WAR.CurID = WAR.PersonNum - 1
			Talk("喔喔~~~喔喔", 613)  
			WAR.CurID = s
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
			return 0
	  end
	end	
	
	if ownPD(pid,44) then --岳老三鳄神指令
		if JY.Person[pid]["体力"] >= 15 and WAR.ESHEN == 0 then		
			AddPersonAttrib(pid, "体力", -10)
			WAR.ESHEN = 1
			local x, y = WE_xy(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] - 1)
			NewWARPersonZJ(611, true, x, y, false, 2);
			local s = nil
			s = WAR.CurID
			WAR.CurID = WAR.PersonNum - 1
			Talk("吼嘎~~~", 611)  
			WAR.CurID = s
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
			return 0
	  end
	end		

    if ownPD(pid,583) then --隼人森罗指令
		if WAR.SLZL == 0 then
			local qishu = JYMsgBox("森罗", "要使用以下那种战术进行战斗？", {"天地","奇正", "阴阳", "生灭",  "取消"}, 5, pid)
			if qishu == 1 then
				local fenshen_count = (WAR.YFS_COUNT[pid] or 0)
				if fenshen_count >= 6 then
					DrawStrBoxWaitKey("已经为 "..JY.Person[pid]["姓名"].." 制造分身", C_WHITE, 30)
					return 0
				else				
					say("天时合微逢・地表化九宫", pid) 
					if WAR.XIANSHU_COUNT_INONEACTION == 0 then
						AddPersonAttrib(pid, "体力", -10)
						AddPersonAttrib(pid, "内力", -300)
					end
					local shadowCount = 1
					if JY.DIFF >= 5 then
						shadowCount = 3
					elseif JY.DIFF >= 3 then
						shadowCount = 2
					end
					local debug = false
					if debug then
						shadowCount = 6
					end
					local now_person_count = WAR.PersonNum - 1		-- 记录增加人之前的人数，一会循环用来从这个数以后遍历新的人
					for iiiii=1,shadowCount do
						local x, y = WE_xy(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] - 1 -(iiiii-1))
						NewWARPersonZJ(pid, true, x, y, false, 2);
						WAR.Person[WAR.PersonNum - 1].Time	= WAR.Person[WAR.CurID].Time
						WAR.Person[WAR.PersonNum - 1]["我方"] = true				--刚创建的是 WAR.Person[WAR.PersonNum - 1]
					end
					WAR.YFS_COUNT[pid]	= (WAR.YFS_COUNT[pid] or 0) + shadowCount
					return 
				end
			elseif qishu == 2 then
				local zl = JYMsgBox("复生", "复生战场上被击退任意一员*消耗：体力10点内力300点", CC.EVB173, 2, pid)
				if zl == 1 then
					local dxp = {}
					local num = 1
					for i = 0, WAR.PersonNum - 1 do 
						if WAR.Person[i]["死亡"] and WAR.Person[i]["人物编号"] ~= pid then
							dxp[num] = {}
							dxp[num][1] = JY.Person[WAR.Person[i]["人物编号"]]["姓名"]
							dxp[num][2] = nil
							dxp[num][3] = 1
							dxp[num][4] = i
							num = num + 1
						end
					end
					if num <= 1 then
						DrawStrBoxWaitKey("目前无人被击退", C_WHITE, 30)
						return 0
					end
					Cls()
					local r = ShowMenu(dxp, num - 1, 10, CC.MainMenuX, CC.MainMenuY + 45, 0, 0, 1, 0, CC.DefaultFont, C_RED, C_GOLD)
					if r > 0 then
						say("奇道险五行・正朔极北风", pid) 
						if WAR.XIANSHU_COUNT_INONEACTION == 0 then
							AddPersonAttrib(pid, "体力", -10)
							AddPersonAttrib(pid, "内力", -300)
						end
						Cls()
						local mid = WAR.Person[dxp[r][4]]["人物编号"] 
						local nx, ny = WE_xy(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] - 1)
						WAR.Person[dxp[r][4]]["死亡"] = false
						WAR.Person[dxp[r][4]]["我方"] = true
						lib.SetWarMap(nx, ny, 2, -1)
						lib.SetWarMap(nx, ny, 5, -1)														
						PlayWavE(28)
						lib.Delay(10)
						CurIDTXDH(WAR.CurID, 1760, 1777, "万道森罗・复生")
						local Ocur = WAR.CurID
						WAR.CurID = dxp[r][4] 
						WarDrawMap(0)
						PlayWavE(36)
						lib.Delay(50)
						lib.SetWarMap(nx, ny, 2, dxp[r][4])
						lib.SetWarMap(nx, ny, 5, WAR.Person[dxp[r][4]]["贴图"])
						WAR.Person[WAR.CurID]["坐标X"]	= nx
						WAR.Person[WAR.CurID]["坐标Y"]	= ny
						WAR.Person[dxp[r][4]]["人方向"] = WAR.Person[WAR.CurID]["人方向"]
						CurIDTXDH(WAR.CurID, 1967, 1981, "")
						lib.Delay(100)
						WAR.CurID = Ocur
						WarDrawMap(0)
						JY.Person[mid]["体力"] = 100
						JY.Person[mid]["生命"] = JY.Person[mid]["生命最大值"] 
						JY.Person[mid]["内力"] = JY.Person[mid]["内力最大值"]
					end
				else
					return 0
				end
			elseif qishu == 3 then	
			    Cls()
				say("阴像晨不物・阳威幕入穷", pid) 
                local x1 = CC.MainSubMenuX
                local y1 = CC.MainSubMenuY + CC.SingleLineHeight
                CC.DYRW = -1
                CC.DYRW2 = -1
    	        DrawStrBox(x1, y1, "谁要替换天赋？",C_WHITE, CC.DefaultFont);
	            local cc = {}
	            local id = -1
	            for j = 1, CC.TeamNum do
		            cc[j] = {"", nil, 0}
		            id = JY.Base["队伍" .. j]	
		            if id >= 0 and duiyou(id) then
			            cc[j] = { JY.Person[id]["姓名"], nil, 1}
		            end
	            end
	            local numItem = table.getn(cc);
	            local dd = CC.DefaultFont;
	            local r = ShowMenu(cc,numItem,0,x1,y1+40,0,0,1,1,dd,C_ORANGE,C_WHITE);
                if r == 0 then  
		            do return end
		        end	
                id = JY.Base["队伍" .. r]
	            CC.DYRW = id
                Cls()
                local aa = 0
                local menu = {}
                for aa = 1, #CC.TFlist do
                    menu[aa] = {CC.TFlist[aa][1], nil, 1, aa}
                end
                local bb = ShowMenu3(menu,#menu,10,-2,-2,-2,-2,2,2,22,C_GOLD,C_WHITE,nil, nil,M_DimGray,C_RED)
                Cls()
                aa = menu[bb][4]
                local a = JYMsgBox("隼人天隐","选择要替换的天赋",{"１","２","３","４","５"},5,545);
                setTF(id, aa, a)
			elseif qishu == 4 then	
			    local nexty
				local s;		
	            local r;		
	            local pid;		
	            local f;		
	            local kfid;		
	            local i = nil
			    Cls()
			    say("生邦有迟命・灭世我称雄", pid) 
				DrawStrBox(CC.MainSubMenuX, CC.MainSubMenuY, "森罗唯我・万道由心", C_WHITE, CC.DefaultFont);
			    nexty = CC.MainSubMenuY + CC.SingleLineHeight;
			    s = SelectTeamMenu(CC.MainSubMenuX, nexty);
			    if s == 0 then 
			        return 
				end 	
			    pid = JY.Base["队伍"..s];
		        local wailw = 0
				local ms1 = JYMsgBox(JY.Person[pid]["姓名"].."外功领悟",
					"请选择想要领悟的外功："..
					"*1降龙 2黯然 3太极剑 4六脉 5火焰刀 "..
					"*6阴风刀 7伏魔杖 8打狗棒 9生死符 10葵花针"..
					"*11取消",
					{"1","2","3","4","5","6","7","8","9","10","11"}
					,11,320)
				if ms1 == 1 then           wailw = 26    --领悟降龙
				    elseif ms1 == 2 then   wailw = 25    --领悟黯然
				    elseif ms1 == 3 then   wailw = 46    --领悟太极剑
				    elseif ms1 == 4 then   wailw = 49    --领悟六脉
				    elseif ms1 == 5 then   wailw = 66    --领悟火焰刀	
				    elseif ms1 == 6 then   wailw = 140   --领悟阴风刀
				    elseif ms1 == 6 then   wailw = 86    --领悟伏魔杖
				    elseif ms1 == 6 then   wailw = 80    --领悟打狗棒
				    elseif ms1 == 6 then   wailw = 176   --生死符
				    elseif ms1 == 6 then   wailw = 177   --葵花针
				end
				if pid == 0 then
					setLW1(wailw)
				elseif pid > 0 then
					JY.Person[pid]["无用16"] = wailw
				end
				QZXS(JY.Person[pid]["姓名"].."领悟"..JY.Wugong[wailw]["名称"])		  
			end			
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
		end
		return 0
	end		

	if ownPD(pid,58) then --杨过机变指令
		if WAR.JIBIAN == 0 then
			WAR.JIBIAN = 1
			local qishu = JYMsgBox("机变", "要使用哪一个门派的技能？", {"古墓", "白驼", "桃花", "全真", "丐帮", "密宗"}, 6, pid)
			if qishu == 1 then
				JoinMP(pid,3,2)
			elseif qishu == 2 then
				JoinMP(pid,8,1)
			elseif qishu == 3 then
				JoinMP(pid,10,1)
			elseif qishu == 4 then
				JoinMP(pid,16,1)
			elseif qishu == 5 then
				JoinMP(pid,2,1)
			elseif qishu == 6 then
				JoinMP(pid,6,1)
			else
				JoinMP(pid,3,2)
			end					
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
		end
		return 0
	end		
	
	if ownPD(pid , 59) then --龙女御蜂指令
		if JY.Person[pid]["体力"] >= 15 and WAR.YUFENG > 0 then		
			AddPersonAttrib(pid, "体力", -10)
			WAR.YUFENG = WAR.YUFENG - 1
			CleanWarMap(4, 0)
			for i = 0, WAR.PersonNum - 1 do			      	  
				local tmppid = WAR.Person[i]["人物编号"]
				if WAR.Person[i]["死亡"] == false and WAR.Person[i]["我方"] == false then
					SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 6)	
					JY.Person[tmppid]["生命"] = JY.Person[tmppid]["生命"] - 200
					if JY.Person[tmppid]["生命"] <= 0 then 
						JY.Person[tmppid]["生命"] = 1
						AddPersonAttrib(tmppid, "中毒程度", 20)
				  end				  
				end
			end
			local x1 = WAR.Person[WAR.CurID]["坐标X"];
			local y1 = WAR.Person[WAR.CurID]["坐标Y"];
			War_ShowFight(pid,0,0,0,x1,y1,34);
			QZXS("全体敌人伤血200点")
			CleanWarMap(4, 0)
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
			return 0
	  end
	end

	if ownPD(pid, 80) then --张召重激励
		if JY.Person[pid]["体力"] >= 15 then
			AddPersonAttrib(pid, "体力", -10)
			CleanWarMap(4, 0)
			for i = 0, WAR.PersonNum - 1 do
				local tmppid = WAR.Person[i]["人物编号"]
				if WAR.Person[i]["死亡"] == false and WAR.Person[i]["我方"] then					
					zhanyi(tmppid, 2, 1)
					WAR.LQZ[tmppid] = limitX((WAR.LQZ[tmppid] or 0) + 20, 0, 100)
					SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 1)	
				end
			end
			local x1 = WAR.Person[WAR.CurID]["坐标X"];
			local y1 = WAR.Person[WAR.CurID]["坐标Y"];
			War_ShowFight(pid,0,0,0,x1,y1,6);
			CleanWarMap(4, 0)			
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
			return 0
		end
	end

	
	if ownPD(pid, 63) then --程英青箫
		if JY.Person[pid]["体力"] >= 20 and JY.Person[pid]["内力"] >= 500 then
			for i = 2318, 2336 do
				CurIDTXDH(WAR.CurID, i, i, "桃花秘传・碧海潮生曲");		--动画显示	
				lib.Delay(10)
			end
			JY.Person[pid]["体力"] = JY.Person[pid]["体力"] - 10
			JY.Person[pid]["内力"] = JY.Person[pid]["内力"] - 350
			for i = 0, WAR.PersonNum - 1 do
				local tmppid = WAR.Person[i]["人物编号"]
				if WAR.Person[i]["死亡"] == false and WAR.Person[i]["我方"] then
				  AddPersonAttrib(tmppid, "受伤程度", -35)
				end
			end
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
			return 0
		end
	end
  
	--蓝烟清：平一指疗伤指令，我方全体回复一定生命值和内伤
	if ownPD(pid, 28) then
		if JY.Person[pid]["体力"] >= 50 and JY.Person[pid]["内力"] > 250 then
			CleanWarMap(4,0);
			AddPersonAttrib(pid, "体力", -10)
	    AddPersonAttrib(pid, "内力", -250)
			for i = 0, WAR.PersonNum - 1 do
				if WAR.Person[i]["我方"] == true and WAR.Person[i]["死亡"] == false then
					local id = WAR.Person[i]["人物编号"];
					local add = JY.Person[pid]["医疗能力"]/4 + JY.Person[pid]["医疗能力"]*WAR.PYZ/16 + math.random(30);		--和杀人数有关
					if add > JY.Person[pid]["医疗能力"]/2 then	--最大为医疗值的一半
						add = JY.Person[pid]["医疗能力"]/2 + math.random(30) + 30;
					end
					
					add = math.modf(add);		
					WAR.Person[i]["内伤点数"] = (WAR.Person[i]["内伤点数"] or 0) + AddPersonAttrib(id, "受伤程度", -math.modf((add) / 5));
					WAR.Person[i]["生命点数"] = (WAR.Person[i]["生命点数"] or 0) + AddPersonAttrib(id, "生命", add);
					
					
					SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 4, 4)
					
				end
			end
			WAR.Person[WAR.CurID][CC.TXWZ2] = GRTS[28];
			
			War_ShowFight(pid,0,0,0,WAR.Person[WAR.CurID]["坐标X"],WAR.Person[WAR.CurID]["坐标Y"],0);
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
	  	return 0
		end
	end
	
	--Star：萧中慧--慧心
	if ownPD(pid, 77) then
		if JY.Person[pid]["生命"] > 500 and JY.Person[pid]["受伤程度"] < 50 then
			local zjwid = nil
			for i = 0, WAR.PersonNum - 1 do
				if WAR.Person[i]["人物编号"] == 625 and WAR.Person[i]["死亡"] == false then
					zjwid = i
					break
				end
			end
			if zjwid ~= nil then
				DrawStrBoxWaitKey("我心本慧・侠女柔情", C_RED, 36)
				--say("慧妹！", 625)
				--say("袁大哥！",77)
				JY.Person[pid]["生命"] = 1
				JY.Person[pid]["受伤程度"] = 100
				WAR.Person[WAR.CurID].Time = -500
				JY.Person[625]["生命"] = JY.Person[625]["生命最大值"]
				JY.Person[625]["受伤程度"] = 0
				WAR.Person[zjwid].Time = 999
				WAR.FXDS[625] = nil
				WAR.LQZ[625] = 100
			else
				DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)		-- "未满足发动条件"
				return 0
			end

		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)		-- "未满足发动条件"
			return 0
		end
	end
	
	--蓝烟清：李文秀天铃指令，全体队友回复李文秀当前生命、内力、体力的一半，并回复内伤、封穴、流血状态。
	--使用后李文秀生命、内力、体力为1，内伤、封穴、流血为满
	if ownPD(pid, 590) then
		if WAR.L_LWX == 0 then
			CurIDTXDH(WAR.CurID, 940, 963, GRTS[590]);		--动画显示
			lib.Delay(100);
			for i = 0, WAR.PersonNum - 1 do
				if WAR.Person[i]["我方"] == true and WAR.Person[i]["死亡"] == false and i ~= WAR.CurID then
					local id = WAR.Person[i]["人物编号"];
					
					AddPersonAttrib(id, "生命", math.modf(JY.Person[590]["生命"]/2));
					AddPersonAttrib(id, "内力", math.modf(JY.Person[590]["内力"]/2));
					AddPersonAttrib(id, "体力", math.modf(JY.Person[590]["体力"]/2));
					JY.Person[id]["受伤程度"] = 0;
					WAR.FXDS[id] = nil;
					WAR.LXZT[id] = nil;

				end
			end
			
			JY.Person[590]["生命"] = 1;
			JY.Person[590]["内力"] = 1;
			JY.Person[590]["体力"] = 1;
			JY.Person[590]["受伤程度"] = 100;
			WAR.FXDS[590] = 50
			WAR.LXZT[590] = 100
			WAR.L_LWX = 1;
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
	  	return 0
		end
	end

	if ownPD(pid , 72) then --田归农谗言指令
		if JY.Person[pid]["体力"] >= 20 then
		    War_CalMoveStep(WAR.CurID, 5, 1) --武功移动步数
			local nx, ny = nil, nil
			local victim = -1
			local victimid = -1
			while true do
				nx, ny = DIYWar_SelectMove() --显示+选择步数
				if nx == nil then
					return 0
				end
				if nx ~= nil then
					if lib.GetWarMap(nx, ny, 2) < 0 and lib.GetWarMap(nx, ny, 5) < 0 then
						QZXS("此处无人，请重新选择")			
					elseif GetWarMap(nx, ny, 2) == nil or GetWarMap(nx, ny, 2) < 0 then
						QZXS("此处无人，请重新选择")	
					else
						victim = GetWarMap(nx, ny, 2)
						victimid = WAR.Person[victim]["人物编号"]
						if WAR.Person[WAR.CurID]["我方"] == WAR.Person[victim]["我方"] then
							QZXS("不能选择我方人物")	
						else
							break;
						end
					end
				end
			end
			if WAR.LQZ[victimid] ~= nil then
				WAR.LQZ[victimid] = WAR.LQZ[victimid] - 30
				if WAR.LQZ[victimid] <= 0  then
					WAR.LQZ[victimid] = nil
				end
			end
			QZXS(JY.Person[victimid]["姓名"].."怒气降低30点")
			AddPersonAttrib(pid, "体力", -5)
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
			return 0
		end	
	end		
	
	if ownPD(pid , 90) then --钟灵灵貂指令
		if JY.Person[pid]["体力"] >= 10 then
		    War_CalMoveStep(WAR.CurID, 5, 1) --武功移动步数
			local nx, ny = nil, nil
			local victim = -1
			local victimid = -1
			while true do
				nx, ny = War_SelectMove() --显示+选择步数
				if nx == nil then
					return 0
				end
				if nx ~= nil then
					if lib.GetWarMap(nx, ny, 2) < 0 and lib.GetWarMap(nx, ny, 5) < 0 then
						QZXS("此处无人，请重新选择")			
					elseif GetWarMap(nx, ny, 2) == nil or GetWarMap(nx, ny, 2) < 0 then
						QZXS("此处无人，请重新选择")	
					else
						victim = GetWarMap(nx, ny, 2)
						victimid = WAR.Person[victim]["人物编号"]
						if WAR.Person[WAR.CurID]["我方"] == WAR.Person[victim]["我方"] then
							QZXS("不能选择我方人物")	
						else
							break;
						end
					end
				end
			end
			for xx = 0, 63 do
				for yy = 0, 63 do
					SetWarMap(xx, yy, 4, -1)
				end
			end
			SetWarMap(nx, ny, 4, 6)
			AddPersonAttrib(victimid, "中毒程度", 30)	
			War_ShowFight(pid,0,0,0,nx,ny,37);
			
			if WAR.ZDDH ~= 341 then --武骧金星：队友挑战任务中不能偷东西			
				local itemid = -1
				local itemnumber = 0
				local hasitem = 0
				
				for i = 1, 4 do
					if JY.Person[victimid]["携带物品数量" .. i] > 0 and JY.Person[victimid]["携带物品" .. i] > -1 then
						hasitem = 1
						break
					end
				end
				if hasitem == 0 then
					QZXS(JY.Person[victimid]["姓名"].."身上没有物品")	
				else
					local itemrandom
					while itemid == -1 do
						itemrandom = math.random(4)
						if JY.Person[victimid]["携带物品数量" .. itemrandom] > 0 and 
							JY.Person[victimid]["携带物品" .. itemrandom] > -1 then				
							itemnumber =JY.Person[victimid]["携带物品数量" .. itemrandom]
							itemid = JY.Person[victimid]["携带物品" .. itemrandom]
						end
					end
					if itemnumber == JY.Person[victimid]["携带物品数量" .. itemrandom] then
						JY.Person[victimid]["携带物品数量" .. itemrandom] = 0
						JY.Person[victimid]["携带物品" .. itemrandom] = -1
					else
						JY.Person[victimid]["携带物品数量" .. itemrandom] = 
							JY.Person[victimid]["携带物品数量" .. itemrandom] - itemnumber
					end
					instruct_32(itemid, itemnumber)
					QZXS("窃取"..JY.Thing[itemid]["名称"]..tostring(itemnumber).."件")	
				end
			end
			SetWarMap(nx, ny, 4, -1)	
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
			return 0
		end	
	end		
	
	if ownPD(pid , 663) then --飞影测试：双儿背刺指令
		if JY.Person[pid]["体力"] >= 50 then
		
		-- 仿照钟灵灵貂写的攻击位置选择语句
		    War_CalMoveStep(WAR.CurID, 1, 1) --武功移动步数
			local nx, ny = nil, nil
			local victim = -1
			local victimid = -1
			while true do
				nx, ny = War_SelectMove() --显示+选择步数
				if nx == nil then
					return 0
				end
				if nx ~= nil then
					if lib.GetWarMap(nx, ny, 2) < 0 and lib.GetWarMap(nx, ny, 5) < 0 then
						QZXS("此处无人，请重新选择")			
					elseif GetWarMap(nx, ny, 2) == nil or GetWarMap(nx, ny, 2) < 0 then
						QZXS("此处无人，请重新选择")	
					else
						victim = GetWarMap(nx, ny, 2)
						victimid = WAR.Person[victim]["人物编号"]
						if WAR.Person[WAR.CurID]["我方"] == WAR.Person[victim]["我方"] then
							QZXS("不能选择我方人物")	
						else
							break;
						end
					end
				end
			end
			for xx = 0, 63 do
				for yy = 0, 63 do
					SetWarMap(xx, yy, 4, -1)
				end
			end
			SetWarMap(nx, ny, 4, 6)
			War_ShowFight(pid,0,0,0,nx,ny,37);
			
		--飞影测试：背刺基础算法
		--1、判断敌我双方相对位置关系
			local xdwz = nil
			if WAR.Person[WAR.CurID]["坐标Y"] == WAR.Person[victim]["坐标Y"] then --如果双方Y坐标相同，那双方左右关系。
				if WAR.Person[WAR.CurID]["坐标X"] > WAR.Person[victim]["坐标X"] then --我方X坐标大，则我方在右侧
					xdwz = 1	--我方在右
				else
					xdwz = 2	--我方在左
				end
			elseif WAR.Person[WAR.CurID]["坐标X"] == WAR.Person[victim]["坐标X"] then --如果双方X坐标相同，那双方上下关系。
				if WAR.Person[WAR.CurID]["坐标Y"] > WAR.Person[victim]["坐标Y"] then --我方Y坐标大，则我方在上侧
					xdwz = 0	--我方在上
				else
					xdwz = 3	--我方在下
				end
			else --非上下左右关系时
				xdwz = -1
			end
		--2、判断是否背刺
			local beici = nil
			if WAR.Person[victim]["人方向"] == xdwz then
				beici = 0	 --敌人朝向与我方位置相同，正面硬杠状态。
			elseif WAR.Person[victim]["人方向"] + xdwz == 3 then
				beici = 1	 --背面爆菊花状态
			else
				beici = -1	 --侧面攻击状态
			end
		--3、添加效果
			if beici == 0 then
				JY.Person[victimid]["生命"] = JY.Person[victimid]["生命"] - 100
				WAR.SZWH[victimid]=WAR.SZWH[victimid] or 0 + 30
				QZXS(JY.Person[victimid]["姓名"].."正面凿击,损失生命100点,眩晕30时序。")
			elseif beici == 1 then
				local sm = math.modf(JY.Person[victimid]["生命"]/2)+300
				JY.Person[victimid]["生命"] = JY.Person[victimid]["生命"]-sm
				if JY.Person[victimid]["生命"] < 0 then
				JY.Person[victimid]["生命"] = 0
			end
				QZXS(JY.Person[victimid]["姓名"].."受到背刺，损失生命"..sm.."点。")
			elseif  beici == -1 then
				JY.Person[victimid]["生命"] = JY.Person[victimid]["生命"] - 300
				QZXS(JY.Person[victimid]["姓名"].."受到侧击，损失生命100点。")
			end
		--4、死亡判断
			if JY.Person[victimid]["生命"] < 1 then
				WAR.Person[victim]["死亡"] = true
			end
		AddPersonAttrib(pid, "体力", -30)
		else
			DrawStrBoxWaitKey("体力不足，无法暗杀", C_WHITE, 30)
			return 0
		end	
	end
	
	if ownPD(pid, 2) or ownPD(pid, 47) then --程灵素引毒指令
		if JY.Person[pid]["体力"] >= 10 then
		    War_CalMoveStep(WAR.CurID, 8, 1) --武功移动步数
			local nx, ny = nil, nil
			local victim = -1
			local victimid = -1
			while true do
				nx, ny = War_SelectMove() --显示+选择步数
				if nx == nil then
					return 0
				end
				if nx ~= nil then
					if lib.GetWarMap(nx, ny, 2) < 0 and lib.GetWarMap(nx, ny, 5) < 0 then
						QZXS("此处无人，请重新选择")			
					elseif GetWarMap(nx, ny, 2) == nil or GetWarMap(nx, ny, 2) < 0 then
						QZXS("此处无人，请重新选择")	
					else
						victim = GetWarMap(nx, ny, 2)
						victimid = WAR.Person[victim]["人物编号"]
						if WAR.Person[WAR.CurID]["我方"] == WAR.Person[victim]["我方"] then
							QZXS("不能选择我方人物")	
						else
							break;
						end
					end
				end
			end
			for xx = 0, 63 do
				for yy = 0, 63 do
					SetWarMap(xx, yy, 4, -1)
				end
			end
			SetWarMap(nx, ny, 4, 6)
			--WAR.Effect = 6
			AddPersonAttrib(victimid,"中毒程度", 5);
			local poi = JY.Person[victimid]["中毒程度"]
			local aa = math.modf(poi * 2)
			local bb = math.modf(poi * 3)
			local lifelost = math.random(aa, bb) + math.random(5)
			JY.Person[victimid]["生命"] = JY.Person[victimid]["生命"] - lifelost
			War_ShowFight(pid,0,0,0,nx,ny,97);
			QZXS(JY.Person[victimid]["姓名"].."毒发，损失生命"..tostring(lifelost).."点")	
			SetWarMap(nx, ny, 4, -1)
			AddPersonAttrib(pid, "体力", -2)		
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
			return 0
		end	
	end	
	
	--蓝烟清：王难姑特色指令 - 施毒  周围五格范围内的敌人时序中毒并时序减血
	if ownPD(pid , 17) then
		if JY.Person[pid]["体力"] >= 30 and JY.Person[pid]["内力"] >= 300 then
			CleanWarMap(4,0);
			AddPersonAttrib(pid, "体力", -15)
			AddPersonAttrib(pid, "内力", -300)
			local x1 = WAR.Person[WAR.CurID]["坐标X"];
			local y1 = WAR.Person[WAR.CurID]["坐标Y"];
			for ex = x1 - 5, x1 + 5 do
				for ey = y1 - 5, y1 + 5 do
					SetWarMap(ex, ey, 4, 1)
					if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
						local ep = GetWarMap(ex, ey, 2)
						if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[ep]["我方"] then
							WAR.L_WNGZL[WAR.Person[ep]["人物编号"]] = 50;			--50时序内持续减中毒+减血
							SetWarMap(ex, ey, 4, 4)
						end
					end
				end
			end
			War_ShowFight(pid,0,0,0,x1,y1,30);
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
	  	return 0
	  end
	end
	
	--brolycjw：胡青牛特色指令 - 群疗  周围四格范围内的队友时序回内伤并按比例回血
	if ownPD(pid , 16) then
		if JY.Person[pid]["体力"] >= 30 and JY.Person[pid]["内力"] >= 300 then
			CleanWarMap(4,0);
			AddPersonAttrib(pid, "体力", -15)
	    AddPersonAttrib(pid, "内力", -300)
			local x1 = WAR.Person[WAR.CurID]["坐标X"];
			local y1 = WAR.Person[WAR.CurID]["坐标Y"];
			
			for ex = x1 - 4, x1 + 4 do
	      for ey = y1 - 4, y1 + 4 do
	        SetWarMap(ex, ey, 4, 1)
	        if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
	          local ep = GetWarMap(ex, ey, 2)
	          if WAR.Person[WAR.CurID]["我方"] == WAR.Person[ep]["我方"] then
	          
	          	WAR.L_HQNZL[WAR.Person[ep]["人物编号"]] = 20;			--20时序内持续回血+回内伤
		          SetWarMap(ex, ey, 4, 4)
		        end
	        end
	      end
	    end
			War_ShowFight(pid,0,0,0,x1,y1,0);
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
	  	return 0
	  end
	end

	if ownPD(pid, 664) then --武骧金星：小宝石灰指令
		if JY.Person[pid]["体力"] >= 5 then
			CleanWarMap(4,0);
			AddPersonAttrib(pid, "体力", -5)
			daode(-1)
			local x1 = WAR.Person[WAR.CurID]["坐标X"];
			local y1 = WAR.Person[WAR.CurID]["坐标Y"];
			
			for ex = x1 - 4, x1 + 4 do
				for ey = y1 - 4, y1 + 4 do
					SetWarMap(ex, ey, 4, 1)
					if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
						local ep = GetWarMap(ex, ey, 2)
						if ep ~= WAR.CurID and (WAR.KHCM[WAR.Person[ep]["人物编号"]] == nil or WAR.KHCM[WAR.Person[ep]["人物编号"]] <= 0) then WAR.KHCM[WAR.Person[ep]["人物编号"]] = 2 end
						if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[ep]["我方"] then RW.fame = math.max(RW.fame - 2, 0) end
						SetWarMap(ex, ey, 4, 4)
					end
				end
			end
			War_ShowFight(pid,0,0,0,x1,y1,JY.Thing[31]["暗器动画编号"]);
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
	  	return 0
	  end
	end
	
	if (flag == nil or flag ~= 1) then	
		if T5BCF(pid) then --白愁飞三指弹天
			if JY.Person[pid]["体力"] > 10 and JY.Person[pid]["内力"] > math.modf((WAR.LQZ[pid] or 0) * 5) 
				and juexing() >= 3 then	
				local word = ""	
				while true do
					Cls()
					local lgmenu = JYMsgBox("三指弹天", "要选择哪一个招式？", {"破煞", "惊梦", "天敌"}, 3, pid)	
					if lgmenu == 1  then				
						WAR.BCFZL = 1
						word = "三指弹天・破煞"
						break
					elseif lgmenu == 2  then
						WAR.BCFZL = 2
						word = "三指弹天・惊梦"
						break
					elseif lgmenu == 3 then
						WAR.BCFZL = 3
						word = "三指弹天・天敌"
						break
					else					
						QZXS("怒气值过低，无法满足招式要求。")
					end
				end
				
				for i = 1706, 1732 do
					CurIDTXDH(WAR.CurID, i, i, word);			
					lib.Delay(10)
				end
			else
				DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
				return 0
			end			
		--elseif T9ZY(pid) then --赵云白马指令
		--	if JY.Person[pid]["体力"] > 20 and JY.Person[pid]["内力"] > 1000 then	
		--		JY.Person[pid]["体力"] = JY.Person[pid]["体力"] - 20
		--		JY.Person[pid]["内力"] = JY.Person[pid]["内力"] - 1000
		--		WAR.ZY = 3
		--		WAR.ZYZL = WAR.ZYZL + 1
		--		for i=1, #ZYDATA do
		--			JY.Person[582][ZYDATA[i]] = JY.Person[0][ZYDATA[i]];
		--		end
		--	else
		--		DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
		--		return 0
		--	end
		elseif T10XXZ(pid) then --武骧金星：萧笑竹森罗指令
			local function compare(a,b)
				if a >= b then return 1 end
				return 0 
			end
			
			local zhiling = JYMsgBox("森罗", "要选择哪一个指令？", {"星辰", "虚空", "轮回"}, 3, pid)	
			if zhiling <= 0 then
				return 0
			end
			
			if zhiling == 1 then
				local dxp = {
					{"灵犀真拳",nil,compare(JY.Person[0]["拳掌功夫"], 120)},
					{"剑神一笑",nil,compare(JY.Person[0]["御剑能力"], 120)},
					{"傲世狂刀",nil,compare(JY.Person[0]["耍刀技巧"], 120)},
					{"棍藏天机",nil,compare(JY.Person[0]["特殊兵器"], 120)},
					{"绝世天罡",nil,compare(JY.Person[0]["内力最大值"], 5000)},
					{"仁者无敌",nil,compare(JY.Person[0]["品德"], 90)},
					{"回天圣手",nil,compare(JY.Person[0]["医疗能力"], 250)},
					{"欲天摩罗",nil,compare(JY.Person[0]["用毒能力"], 250)},
					{"血海飘零",nil,compare(JY.Person[0]["生命最大值"], 1500)},
					{"凌空摘星",nil,compare(JY.Person[0]["轻功"], 450)},
					{"盘龙九注",nil,compare(JY.Person[0]["攻击力"], 450)},
					{"指掌乾坤",nil,compare(JY.Person[0]["防御力"], 450)},
					{"千魂弄巧",nil,compare(JY.Person[0]["暗器技巧"], 120)},
				}
				local num = table.getn(dxp);
				if num <= 0 then return 0 end
				if putong() > 0 then
					say("我现在的能力是"..dxp[putong()][1].."，要换成哪个能力？") 
				else
					say("我现在的能力是万象森罗，要换成哪个能力？") 
				end
				local r = ShowMenu(dxp, num, 10, CC.MainMenuX, CC.MainMenuY + 45, 0, 0, 1, 0, CC.DefaultFont, C_RED, C_GOLD)
				if r > 0 then JY.Person[0]["无用13"] = r end
			elseif zhiling == 2 then
				if DrawStrBoxYesNo(-1, -1, "要更换天赋武功么？", C_WHITE, 30) == true then
					SetS(112,1,0,0,0)
					SetS(112,2,0,0,0)
					SetS(112,3,0,0,0)
					tfkf()
				else
					return 0
				end
			elseif zhiling == 3 then
				local duixiang = JY.Person[pid]["无用12"]
				if duixiang <= 0 or DrawStrBoxYesNo(-1, -1, "现在模仿的是"..JY.Person[duixiang]["姓名"].."，你想更换模仿对象么？", C_WHITE, 30) == true then		
					local dxp = {}
					local num = 1
					for i = 0, WAR.PersonNum - 1 do 
						if WAR.Person[i]["我方"] and WAR.Person[i]["死亡"] == false and i ~= WAR.CurID then
							dxp[num] = {}
							dxp[num][1] = JY.Person[WAR.Person[i]["人物编号"]]["姓名"] 
							dxp[num][2] = nil
							dxp[num][3] = 1
							dxp[num][4] = i
							num = num + 1
						end
					end
					if num <= 1 then
						DrawStrBoxWaitKey("场上没有其他我方人物", C_WHITE, 30)
						return 0							
					end
					DrawStrBox(CC.MainMenuX, CC.MainMenuY, "森罗", C_GOLD, 30)
					local r = ShowMenu(dxp, num - 1, 10, CC.MainMenuX, CC.MainMenuY + 45, 0, 0, 1, 0, CC.DefaultFont, C_RED, C_GOLD)
					Cls()
					local victimid = WAR.Person[dxp[r][4]]["人物编号"]
					if juexing() <= 0 or DrawStrBoxYesNo(-1, -1, "要模仿对方的天赋么？", C_WHITE, 30) == true then
						JY.Person[pid]["无用12"] = victimid
					end
					if JY.Person[victimid]["武功1"] > 0 and (juexing() <= 0 or DrawStrBoxYesNo(-1, -1, "要模仿对方的武功么？", C_WHITE, 30) == true) then
						JY.Person[pid]["武功1"] = JY.Person[victimid]["武功1"] 
					end
					if juexing() <= 0 or DrawStrBoxYesNo(-1, -1, "要模仿对方的技能么？", C_WHITE, 30) == true then
						for i = 1, 5 do 
							JY.Person[pid]["技能"..i] = JY.Person[victimid]["技能"..i]							
						end
					end
					DHdisplay(1400, 1440, CC.WARS92)
				else
					return 0
				end
			end
		elseif pid == 0 and putong() == 11 then
			if JY.Person[pid]["体力"] > 10 then	
				say("看我心想事成！")				
				local m = {"空汤瓶", "空汤瓶", "玉麒麟", "金孔雀", "半钱"}
				local n = {"我方", "敌方", "我方"}
				local name = {}
				local num = {}
				for i = 0, WAR.PersonNum - 1 do
					if 	WAR.Person[i]["死亡"] == false then
						name[#name + 1] = JY.Person[WAR.Person[i]["人物编号"]]["姓名"]
						num[#num + 1] = WAR.Person[i]["人物编号"]
					end
				end
				if juexing() > 0 then
					m = {"空汤瓶", "空汤瓶", "玉麒麟", "金孔雀", "半钱", "龙凤白", "至尊宝", "天地人", "福禄寿"}					
				end
				local eft, target = -1, -1	
				local t = -1
				local s = ""
				local s2 = ""
				for i = 1, 20 do
					Cls()
					t = math.random(#m)
					eft = t
					s = m[t]
					tb2(s, 200, nil, nil, 60)
					ShowScreen()
					lib.Delay(10 + i * 10)
				end
				lib.Delay(150)
				if eft == 8 or eft == 9 then
					n = name
				end
				for i = 1, 20 do
					Cls()
					t = math.random(#n)
					target = t
					s2 = n[t]
					if eft <= 2 then
						s2 = "无"
						tb2(s, 200, nil, nil, 60)
						tb2(s2, 430, nil, C_ORANGE, 60)
						ShowScreen()
						lib.Delay(150)
						break
					end
					tb2(s, 200, nil, nil, 60)
					tb2(s2, 430, nil, C_ORANGE, 60)
					ShowScreen()
					lib.Delay(10 + i * 10)
				end
				WaitKey()	
				Cls()
				if juexing() > 0 and yesno("要重新掷过吗？") then
					AddPersonAttrib(pid, "体力", -5)
					m = {"空汤瓶", "空汤瓶", "玉麒麟", "金孔雀", "半钱"}
					n = {"我方", "敌方", "我方"}				
					eft, target = -1, -1	
					t = -1
					s = ""
					s2 = ""
					for i = 1, 20 do
						Cls()
						t = math.random(#m)
						eft = t
						s = m[t]
						tb2(s, 200, nil, nil, 60)
						ShowScreen()
						lib.Delay(10 + i * 10)
					end
					lib.Delay(150)
					if eft == 8 or eft == 9 then
						n = name
					end
					for i = 1, 20 do
						Cls()
						t = math.random(#n)
						target = t
						s2 = n[t]
						if eft <= 2 then
							s2 = "无"
							tb2(s, 200, nil, nil, 60)
							tb2(s2, 430, nil, C_ORANGE, 60)
							ShowScreen()
							lib.Delay(150)
							break
						end
						tb2(s, 200, nil, nil, 60)
						tb2(s2, 430, nil, C_ORANGE, 60)
						ShowScreen()
						lib.Delay(10 + i * 10)
					end
					WaitKey()								
				end
				CleanWarMap(4, 0)
				if eft <=  7 then
					if n[target] == "我方" then
						target = true
					else
						target = false
					end
				end
				if eft <= 2 then
					say("啊！落空了！")
				elseif eft == 3 then					
					for i = 0, WAR.PersonNum - 1 do
						if WAR.Person[i]["我方"] == target and WAR.Person[i]["死亡"] == false then
							SetWarMap(WAR.Person[i]["坐标X"],WAR.Person[i]["坐标Y"], 4, 2)
							WAR.QFY2[WAR.Person[i]["人物编号"]] = 50 + math.modf(JY.Person[pid]["实战"] / 10)
						end
					end					
					War_ShowFight(pid, 0, 0, 0, WAR.Person[WAR.CurID]["坐标X"],WAR.Person[WAR.CurID]["坐标Y"], 84)	
				elseif eft == 4 then
					for i = 0, WAR.PersonNum - 1 do
						if WAR.Person[i]["我方"] == target and WAR.Person[i]["死亡"] == false then
							SetWarMap(WAR.Person[i]["坐标X"],WAR.Person[i]["坐标Y"], 4, 2)
							WAR.QFY1[WAR.Person[i]["人物编号"]] = 50 + math.modf(JY.Person[pid]["实战"] / 10)
						end
					end						
					War_ShowFight(pid, 0, 0, 0, WAR.Person[WAR.CurID]["坐标X"],WAR.Person[WAR.CurID]["坐标Y"], 85)
				elseif eft == 5 then
					for i = 0, WAR.PersonNum - 1 do
						if WAR.Person[i]["我方"] == target and WAR.Person[i]["死亡"] == false then
							SetWarMap(WAR.Person[i]["坐标X"],WAR.Person[i]["坐标Y"], 4, 2)
							WAR.QFY3[WAR.Person[i]["人物编号"]] = 50 + math.modf(JY.Person[pid]["实战"] / 10)
						end
					end				
					War_ShowFight(pid, 0, 0, 0, WAR.Person[WAR.CurID]["坐标X"],WAR.Person[WAR.CurID]["坐标Y"], 86)	
				elseif eft == 6 then
					for i = 0, WAR.PersonNum - 1 do
						if WAR.Person[i]["我方"] == target and WAR.Person[i]["死亡"] == false then
							SetWarMap(WAR.Person[i]["坐标X"],WAR.Person[i]["坐标Y"], 4, 2)
							WAR.Person[i].Time = 999
						end
					end		
					War_ShowFight(pid, 0, 0, 0, WAR.Person[WAR.CurID]["坐标X"],WAR.Person[WAR.CurID]["坐标Y"], 149)
				elseif eft == 7 then
					for i = 0, WAR.PersonNum - 1 do
						if WAR.Person[i]["我方"] == target and WAR.Person[i]["死亡"] == false then
							SetWarMap(WAR.Person[i]["坐标X"],WAR.Person[i]["坐标Y"], 4, 2)
							WAR.HITALL[WAR.Person[i]["人物编号"]] = 1
							if WAR.Person[i]["人物编号"] == 0 then
								WAR.HITALL[WAR.Person[i]["人物编号"]] = 2
							end
						end
					end				
					War_ShowFight(pid, 0, 0, 0, WAR.Person[WAR.CurID]["坐标X"],WAR.Person[WAR.CurID]["坐标Y"], 133)	
				elseif eft == 8 then
					for i = 0, WAR.PersonNum - 1 do
						if WAR.Person[i]["人物编号"] == num[target] then
							SetWarMap(WAR.Person[i]["坐标X"],WAR.Person[i]["坐标Y"], 4, 2)
							JY.Person[num[target]]["生命"] = 1
							JY.Person[num[target]]["内力"] = 1
							break
						end
					end		
					War_ShowFight(pid, 0, 0, 0, WAR.Person[WAR.CurID]["坐标X"],WAR.Person[WAR.CurID]["坐标Y"], 77)	
				elseif eft == 9 then
					for i = 0, WAR.PersonNum - 1 do
						if WAR.Person[i]["人物编号"] == num[target] then
							SetWarMap(WAR.Person[i]["坐标X"],WAR.Person[i]["坐标Y"], 4, 2)
							AddPersonAttrib(num[target], "生命", 10000)
							AddPersonAttrib(num[target], "内力", 10000)
							break
						end
					end		
					War_ShowFight(pid, 0, 0, 0, WAR.Person[WAR.CurID]["坐标X"],WAR.Person[WAR.CurID]["坐标Y"], 153)
				end		
				CleanWarMap(4, 0)
				AddPersonAttrib(pid, "体力", -5)
			else
				DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
				return 0
			end						
		elseif pid == 0 and putong() == 10 then
			if JY.Person[pid]["体力"] > 10 then	
				local zhilingnum = 1
				local bonus = 0
				zhilingnum = zhilingnum + limitX(math.modf(JY.Person[pid]["实战"] / 100), 0, 2)
				if juexing() > 0 then
					zhilingnum = 4
					bonus = 30
				end
				Cls()
				local qishu = JYMsgBox("空空", "要选择哪一个指令？", {"探囊", "偷心", "窃艺", "猎命"}, zhilingnum, pid)	
				if qishu <= 0 then
					return 0
				end
				if qishu == 1 then
					local xy = JYMsgBox("探囊", "获取目标敌人的一件物品*消耗：体力5点", CC.EVB173, 2, pid)
					if xy ~= 1 or WAR.ZDDH == 341 then
						return 0
					end					
					if JY.Person[pid]["体力"] > 5 then
						local nx, ny, victim, victimid = selectPerson(7, 1)
						if nx == -1 then
							return 0
						end
						if JLSD(10, 10 + bonus, pid) then
							WAR.FXXS[victimid] = 1 
							WAR.FXDS[victimid] = (WAR.FXDS[victimid] or 0) + 5 + math.modf(JY.Person[pid]["实战"] / 25)
						end
						CleanWarMap(4, 0)
						SetWarMap(nx, ny, 4, 2)
						War_ShowFight(pid, 0, 0, 0, nx, ny, 56)	
						SetWarMap(nx, ny, 4, -1)	
						AddPersonAttrib(pid, "体力", -5)							
						local itemid = -1
						local itemnumber = 0
						local hasitem = 0						
						for i = 1, 4 do
							if JY.Person[victimid]["携带物品数量" .. i] > 0 and JY.Person[victimid]["携带物品" .. i] > -1 then
								hasitem = 1
								break
							end
						end
						if hasitem == 0 then
							QZXS(JY.Person[victimid]["姓名"].."身上没有物品")	
						else
							local itemrandom
							while itemid == -1 do
								itemrandom = math.random(4)
								if JY.Person[victimid]["携带物品数量" .. itemrandom] > 0 and 
									JY.Person[victimid]["携带物品" .. itemrandom] > -1 then				
									itemnumber =JY.Person[victimid]["携带物品数量" .. itemrandom]
									itemid = JY.Person[victimid]["携带物品" .. itemrandom]
								end
							end
							if itemnumber == JY.Person[victimid]["携带物品数量" .. itemrandom] then
								JY.Person[victimid]["携带物品数量" .. itemrandom] = 0
								JY.Person[victimid]["携带物品" .. itemrandom] = -1
							else
								JY.Person[victimid]["携带物品数量" .. itemrandom] = 
									JY.Person[victimid]["携带物品数量" .. itemrandom] - itemnumber
							end
							instruct_32(itemid, itemnumber)
							QZXS("窃取"..JY.Thing[itemid]["名称"]..tostring(itemnumber).."件")	
						end								
					else
						DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						return 0
					end
				elseif qishu == 2 then
					local xy = JYMsgBox("偷心", "使目标敌人进入魅惑状态*仅对小兵有效*消耗：体力10点", CC.EVB173, 2, pid)
					if xy ~= 1 then
						return 0
					end							
					if JY.Person[pid]["体力"] > 10 then
						local nx, ny, victim, victimid = selectPerson(5, 1)
						if nx == -1 then
							return 0
						end
						local tmpcount = 0
						for i = 0, WAR.PersonNum - 1 do
							if WAR.Person[i]["死亡"] == false and WAR.Person[i]["我方"] == false then
								tmpcount = tmpcount + 1
							end
						end			
						if tmpcount < 2 then
							QZXS("只剩一个敌人的时候无法使用")	
							return 0
						end						
						CleanWarMap(4, 0)
						SetWarMap(nx, ny, 4, 2)
						if JLSD(10, 10 + bonus, pid) then
							WAR.FXXS[victimid] = 1 
							WAR.FXDS[victimid] = (WAR.FXDS[victimid] or 0) + 5 + math.modf(JY.Person[pid]["实战"] / 25)
						end						
						War_ShowFight(pid, 0, 0, 0, nx, ny, 0)	
						if xiaobin(victimid) and (WAR.NPC[victimid] == nil or WAR.NPC[victimid] <= 0) then
							WAR.NPC[victimid] = 50 + math.modf(JY.Person[pid]["实战"] / 10)	
							WAR.Person[victim]["我方"] = WAR.Person[WAR.CurID]["我方"] 
							tb(JY.Person[victimid]["姓名"].."进入魅惑状态！")
						end						
						SetWarMap(nx, ny, 4, -1)							
						AddPersonAttrib(pid, "体力", -10)							
					else
						DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						return 0
					end
				elseif qishu == 3 then					
					local xy = JYMsgBox("窃艺", "习得目标敌人随机一项武功*消耗：体力10点内力500点", CC.EVB173, 2, pid)
					if xy ~= 1 then
						return 0
					end							
					if JY.Person[pid]["体力"] > 10 and JY.Person[pid]["内力"] > 500 then
						local nx, ny, victim, victimid = selectPerson(5, 1)
						if nx == -1 then
							return 0
						end
						CleanWarMap(4, 0)
						SetWarMap(nx, ny, 4, 2)
						if JLSD(10, 10 + bonus, pid) then
							WAR.FXXS[victimid] = 1 
							WAR.FXDS[victimid] = (WAR.FXDS[victimid] or 0) + 5 + math.modf(JY.Person[pid]["实战"] / 25)
						end						
						War_ShowFight(pid, 0, 0, 0, nx, ny, 123)	
						local m = {}
						for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
							if JY.Person[victimid]["武功"..i] > 0 then
								m[#m + 1] = JY.Person[victimid]["武功"..i]
							end
						end
						if #m > 0 then
							local w = m[math.random(#m)]
							JY.Person[pid]["武功1"] = w
							JY.Person[pid]["武功等级1"] = 999
							tb(JY.Person[pid]["姓名"].."偷学"..JY.Wugong[w]["名称"].."成功！")
						else
							tb("目标没有任何武功")
						end					
						SetWarMap(nx, ny, 4, -1)							
						AddPersonAttrib(pid, "体力", -10)	
						AddPersonAttrib(pid, "内力", -500)							
					else
						DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						return 0
					end
				elseif qishu == 4 then
					local s = "盗取目标的一项天赋*自身获得该天赋且目标失去该天赋一定时序*消耗：体力15点内力500点"
					if WAR.NOTF ~= nil then
						s = s.."*".."现猎得天赋＜"..CC.SK[WAR.NOTF[2]][1].."＞"
					end
					local xy = JYMsgBox("猎命", s, CC.EVB173, 2, pid)
					if xy ~= 1 then
						return 0
					end							
					if JY.Person[pid]["体力"] > 15 and JY.Person[pid]["内力"] > 500 then
						local nx, ny, victim, victimid = selectPerson(5, 1)
						if nx == -1 then
							return 0
						end
						CleanWarMap(4, 0)
						if JLSD(10, 10 + bonus, pid) then
							WAR.FXXS[victimid] = 1 
							WAR.FXDS[victimid] = (WAR.FXDS[victimid] or 0) + 5 + math.modf(JY.Person[pid]["实战"] / 25)
						end								
						SetWarMap(WAR.Person[victim]["坐标X"],WAR.Person[victim]["坐标Y"], 4, 2)
						War_ShowFight(pid, 0, 0, 0, WAR.Person[WAR.CurID]["坐标X"],WAR.Person[WAR.CurID]["坐标Y"], 145)							
						local m = {}
						for i = 1, 5 do 
							if JY.Person[victimid]["技能"..i] > 0 then
								m[#m + 1] = {CC.SK[JY.Person[victimid]["技能"..i]][1], nil, 1, JY.Person[victimid]["技能"..i]}
							end							
						end
						if #m > 0 then
							Cls()
							local r = ShowMenu3(m,#m,1,-2,-2,-2,-2,1,0,CC.DefaultFont,C_GOLD,C_WHITE,nil,nil,M_DimGray,C_RED)
							if r > 0 then
								WAR.NOTF = {victimid, m[r][4], 100 + math.modf(JY.Person[pid]["实战"] / 5)}
								tb(JY.Person[pid]["姓名"].."猎取"..m[r][1].."成功！")
							end
						else
							tb("目标没有任何天赋")
						end

						AddPersonAttrib(pid, "体力", -15)
						AddPersonAttrib(pid, "内力", -500)							
					else
						DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						return 0
					end
				end
			else
				DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
				return 0
			end				
		elseif pid == 0 and putong() == 8 then
			if JY.Person[pid]["体力"] > 10 then	
				local zhilingnum = 2
				local bonus = 0
				if juexing() > 0 then bonus = 30 end
				zhilingnum = zhilingnum + limitX(math.modf(JY.Person[pid]["实战"] / 100), 0, 3)
				Cls()
				local qishu = JYMsgBox("五毒", "要选择哪一个指令？", {"乾天", "离火", "坎水", "巽风", "坤地"}, zhilingnum, pid)	
				if qishu <= 0 then
					return 0
				end
				if qishu == 1 then
					local xy = JYMsgBox("乾天", "目标周边三格敌人进入毒击状态*消耗：体力10点内力500点", CC.EVB173, 2, pid)
					if xy ~= 1 then
						return 0
					end					
					if JY.Person[pid]["体力"] > 10 and JY.Person[pid]["内力"] > 500 then
						local nx, ny, victim, victimid = selectPerson(7, 1)
						if nx == -1 then
							return 0
						end
						CleanWarMap(4, 0)
						for i = 0, WAR.PersonNum - 1 do
							if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and 
								WAR.Person[i]["死亡"] == false and RealJL(victim, i, 3) then
								SetWarMap(WAR.Person[i]["坐标X"],WAR.Person[i]["坐标Y"], 4, 2)
								WAR.L_WNGZL[WAR.Person[i]["人物编号"]] = 50 + math.modf(JY.Person[pid]["实战"] / 10) + bonus
							end
						end		
						War_ShowFight(pid, 0, 0, 0, WAR.Person[WAR.CurID]["坐标X"],WAR.Person[WAR.CurID]["坐标Y"], 111)	
						AddPersonAttrib(pid, "体力", -10)
						AddPersonAttrib(pid, "内力", -500)							
					else
						DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						return 0
					end
				elseif qishu == 4 then
					local xy = JYMsgBox("巽风", "目标周边五格所有人进入破兵和碎甲状态*消耗：体力15点内力600点", CC.EVB173, 2, pid)
					if xy ~= 1 then
						return 0
					end							
					if JY.Person[pid]["体力"] > 15 and JY.Person[pid]["内力"] > 600 then
						local nx, ny, victim, victimid = selectPerson(7, 1)
						if nx == -1 then
							return 0
						end
						CleanWarMap(4, 0)
						for i = 0, WAR.PersonNum - 1 do
							if WAR.Person[i]["人物编号"] ~= WAR.Person[WAR.CurID]["人物编号"] and 
								WAR.Person[i]["死亡"] == false and RealJL(victim, i, 5) then
								SetWarMap(WAR.Person[i]["坐标X"],WAR.Person[i]["坐标Y"], 4, 2)
								WAR.ATKDOWN[WAR.Person[i]["人物编号"]] = 20 + math.modf(JY.Person[pid]["实战"] / 10) + bonus
								WAR.DEFDOWN[WAR.Person[i]["人物编号"]] = 20 + math.modf(JY.Person[pid]["实战"] / 10) + bonus
							end
						end		
						War_ShowFight(pid, 0, 0, 0, WAR.Person[WAR.CurID]["坐标X"],WAR.Person[WAR.CurID]["坐标Y"], 146)	
						AddPersonAttrib(pid, "体力", -15)
						AddPersonAttrib(pid, "内力", -600)							
					else
						DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						return 0
					end
				elseif qishu == 2 then					
					local xy = JYMsgBox("离火", "目标敌人灼烧且进入混乱状态*消耗：体力10点内力300点", CC.EVB173, 2, pid)
					if xy ~= 1 then
						return 0
					end							
					if JY.Person[pid]["体力"] > 10 and JY.Person[pid]["内力"] > 300 then
						local nx, ny, victim, victimid = selectPerson(7, 1)
						if nx == -1 then
							return 0
						end
						CleanWarMap(4, 0)
						SetWarMap(WAR.Person[victim]["坐标X"],WAR.Person[victim]["坐标Y"], 4, 2)
						WAR.HOT[victimid] = limitX((WAR.HOT[victimid] or 0) + 30, 0, 50) + bonus
						WAR.CONFUSE[victimid] = math.modf(JY.Person[pid]["实战"] / 10) + bonus
						--WAR.CONFUSEO[victimid] = WAR.Person[victim]["我方"]
						War_ShowFight(pid, 0, 0, 0, WAR.Person[WAR.CurID]["坐标X"],WAR.Person[WAR.CurID]["坐标Y"], 167)	
						AddPersonAttrib(pid, "体力", -10)
						AddPersonAttrib(pid, "内力", -300)							
					else
						DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						return 0
					end
				elseif qishu == 3 then
					local xy = JYMsgBox("坎水", "目标敌人冰封且进入冰心状态*消耗：体力20点内力200点", CC.EVB173, 2, pid)
					if xy ~= 1 then
						return 0
					end							
					if JY.Person[pid]["体力"] > 20 and JY.Person[pid]["内力"] > 200 then
						local nx, ny, victim, victimid = selectPerson(7, 1)
						if nx == -1 then
							return 0
						end
						CleanWarMap(4, 0)
						SetWarMap(WAR.Person[victim]["坐标X"],WAR.Person[victim]["坐标Y"], 4, 2)						
						WAR.ICE[victimid] = limitX((WAR.ICE[victimid] or 0) + 30, 0, 50) + bonus
						WAR.PEACE[victimid] = math.modf(JY.Person[pid]["实战"] / 10) + bonus
						--WAR.LQZ[victimid] = 0
						War_ShowFight(pid, 0, 0, 0, WAR.Person[WAR.CurID]["坐标X"],WAR.Person[WAR.CurID]["坐标Y"], 145)	
						AddPersonAttrib(pid, "体力", -20)
						AddPersonAttrib(pid, "内力", -200)							
					else
						DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						return 0
					end
				elseif qishu == 5 then
					local xy = JYMsgBox("坤地", "目标敌人中毒100且一定时序内无法解毒*消耗：体力20点", CC.EVB173, 2, pid)
					if xy ~= 1 then
						return 0
					end							
					if JY.Person[pid]["体力"] > 20 then
						local nx, ny, victim, victimid = selectPerson(7, 1)
						if nx == -1 then
							return 0
						end
						CleanWarMap(4, 0)
						SetWarMap(WAR.Person[victim]["坐标X"],WAR.Person[victim]["坐标Y"], 4, 2)						
						AddPersonAttrib(victimid,"中毒程度", 100)
						WAR.POISON[victimid] = math.modf(JY.Person[pid]["实战"] / 10) + bonus
						War_ShowFight(pid, 0, 0, 0, WAR.Person[WAR.CurID]["坐标X"],WAR.Person[WAR.CurID]["坐标Y"], 185)	
						AddPersonAttrib(pid, "体力", -20)					
					else
						DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						return 0
					end	
				end
			else
				DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
				return 0
			end

		elseif pid == 0 and putong() == 12 then --武骧金星：八部斗策开始
			if JY.Person[pid]["体力"] >= 8 then	
				local zhilingnum = 1 + tianshu()
				zhilingnum = math.min(zhilingnum, 8)
				Cls()
				local qishu = JYMsgBox("斗策", "要选择哪一个指令？", {"乾", "修", "摩", "夜", "紧", "迦", "龙", "天"}, zhilingnum, pid)	
				if qishu <= 0 then
					return 0
				end
				if qishu == 1 then
					local zh = JYMsgBox("乾达婆", "恢复指定队友生命350 内伤35", CC.EVB173, 2, pid)
					if zh == 1 then
						local dxp = {}
						local num = 1
						for i = 0, WAR.PersonNum - 1 do 
							if WAR.Person[i]["我方"] and WAR.Person[i]["死亡"] == false and i ~= WAR.CurID then
								dxp[num] = {}
								dxp[num][1] = JY.Person[WAR.Person[i]["人物编号"]]["姓名"] 
								dxp[num][2] = nil
								dxp[num][3] = 1
								dxp[num][4] = i
								num = num + 1
							end
						end
						if num <= 1 then
							DrawStrBoxWaitKey("场上没有可施展的目标", C_WHITE, 30)
							return 0							
						end
						DrawStrBox(CC.MainMenuX, CC.MainMenuY, "乾达婆", C_GOLD, 30)
						local r = ShowMenu(dxp, num - 1, 10, CC.MainMenuX, CC.MainMenuY + 45, 0, 0, 1, 0, CC.DefaultFont, C_RED, C_GOLD)
						Cls()
						local mid = WAR.Person[dxp[r][4]]["人物编号"]
						AddPersonAttrib(pid, "体力", -8)
						WAR.DOUCE = WAR.DOUCE + 1
						zhanyi(pid, 2)						
						AddPersonAttrib(mid, "生命", 350)
						AddPersonAttrib(mid, "受伤程度", -35)
						DHdisplay(1345, 1364, "八部斗策 香阴 乾闼婆")
					else
						return 0
					end
				elseif qishu == 2 then
					local zh = JYMsgBox("阿修罗", "指定队友下次攻击增加一次连击且首击必暴击", CC.EVB173, 2, pid)
					if zh == 1 then
						local dxp = {}
						local num = 1
						for i = 0, WAR.PersonNum - 1 do 
							if WAR.Person[i]["我方"] and WAR.Person[i]["死亡"] == false and i ~= WAR.CurID then
								dxp[num] = {}
								dxp[num][1] = JY.Person[WAR.Person[i]["人物编号"]]["姓名"] 
								dxp[num][2] = nil
								dxp[num][3] = 1
								dxp[num][4] = i
								num = num + 1
							end
						end
						if num <= 1 then
							DrawStrBoxWaitKey("场上没有可施展的目标", C_WHITE, 30)
							return 0							
						end
						DrawStrBox(CC.MainMenuX, CC.MainMenuY, "阿修罗", C_GOLD, 30)
						local r = ShowMenu(dxp, num - 1, 10, CC.MainMenuX, CC.MainMenuY + 45, 0, 0, 1, 0, CC.DefaultFont, C_RED, C_GOLD)
						Cls()
						local mid = WAR.Person[dxp[r][4]]["人物编号"]
						AddPersonAttrib(pid, "体力", -8)
						WAR.DOUCE = WAR.DOUCE + 1
						zhanyi(pid, 2)
						WAR.AXL = mid
						DHdisplay(1345, 1364, "八部斗策 非天 阿修罗")
					else
						return 0					
					end
				elseif qishu == 3 then					
					local xy = JYMsgBox("摩呼罗迦", "敌全体集气下降200点 封穴4至6时序", CC.EVB173, 2, pid)
					if xy == 1 then
						DrawStrBox(CC.MainMenuX, CC.MainMenuY, "摩呼罗迦", C_GOLD, 30)
						Cls()					
						AddPersonAttrib(pid, "体力", -8)
						WAR.DOUCE = WAR.DOUCE + 1
						zhanyi(pid, 2)
						for i = 0, WAR.PersonNum - 1 do 
							if WAR.Person[i]["我方"] == false and WAR.Person[i]["死亡"] == false and i ~= WAR.CurID then
								WAR.Person[i].Time = math.max(WAR.Person[i].Time - 200, -500)
								WAR.FXXS[WAR.Person[i]["人物编号"]] = 1 --封穴判定
								if WAR.FXDS[WAR.Person[i]["人物编号"]] ~= nil then
									WAR.FXDS[WAR.Person[i]["人物编号"]] = WAR.FXDS[WAR.Person[i]["人物编号"]] + math.random(4,6) --封穴点数
								else
									WAR.FXDS[WAR.Person[i]["人物编号"]] = math.random(4,6)
								end
							end
						end
						DHdisplay(1345, 1364, "八部斗策 地龙 摩呼罗迦")
					else
						return 0					
					end
				elseif qishu == 4 then
					local zh = JYMsgBox("夜叉", "提升指定队友怒气值60点及恢复体力15点", CC.EVB173, 2, pid)
					if zh == 1 then
						local dxp = {}
						local num = 1
						for i = 0, WAR.PersonNum - 1 do 
							if WAR.Person[i]["我方"] and WAR.Person[i]["死亡"] == false and i ~= WAR.CurID then
								dxp[num] = {}
								dxp[num][1] = JY.Person[WAR.Person[i]["人物编号"]]["姓名"] 
								dxp[num][2] = nil
								dxp[num][3] = 1
								dxp[num][4] = i
								num = num + 1
							end
						end
						if num <= 1 then
							DrawStrBoxWaitKey("场上没有可施展的目标", C_WHITE, 30)
							return 0							
						end
						DrawStrBox(CC.MainMenuX, CC.MainMenuY, "夜叉", C_GOLD, 30)
						local r = ShowMenu(dxp, num - 1, 10, CC.MainMenuX, CC.MainMenuY + 45, 0, 0, 1, 0, CC.DefaultFont, C_RED, C_GOLD)
						Cls()
						local mid = WAR.Person[dxp[r][4]]["人物编号"]
						AddPersonAttrib(pid, "体力", -8)
						WAR.DOUCE = WAR.DOUCE + 1
						zhanyi(pid, 2)
						WAR.LQZ[mid] = (WAR.LQZ[mid] or 0) + 60
						--怒气暴发
						if WAR.LQZ[mid] ~= nil and 100 < WAR.LQZ[mid] then
							WAR.LQZ[mid] = 100
							WAR.Person[dxp[r][4]][CC.TXDH] = 6
							if WAR.Person[dxp[r][4]][CC.TXWZ3] ~= nil then
							WAR.Person[dxp[r][4]][CC.TXWZ3] = WAR.Person[dxp[r][4]][CC.TXWZ3] .. CC.WARS117
							else
								WAR.Person[dxp[r][4]][CC.TXWZ3] = CC.WARS118
							end
							if hasTF(mid, 44) then
								JY.Person[mid]["受伤程度"] = 0
							end
						end	
						if ZYJ(mid) then
						   	if WAR.Person[dxp[r][4]][CC.TXWZ3] ~= nil then
							WAR.Person[dxp[r][4]][CC.TXWZ3] = WAR.Person[dxp[r][4]][CC.TXWZ3] .. "战意勃发"
							else
								WAR.Person[dxp[r][4]][CC.TXWZ3] = "战意勃发"
							end 
						end
						AddPersonAttrib(mid, "体力", 15)
						DHdisplay(1345, 1364, "八部斗策 执金刚神 夜叉")
					else
						return 0					
					end
				elseif qishu == 5 then
					local xy = JYMsgBox("紧那罗", "降低指定敌方人物的怒气值60点", CC.EVB173, 2, pid)
					if xy == 1 then
						local dxp = {}
						local num = 1
						for i = 0, WAR.PersonNum - 1 do 
							if WAR.Person[i]["我方"] == false and WAR.Person[i]["死亡"] == false and i ~= WAR.CurID then
								dxp[num] = {}
								dxp[num][1] = JY.Person[WAR.Person[i]["人物编号"]]["姓名"] 
								dxp[num][2] = nil
								dxp[num][3] = 1
								dxp[num][4] = i
								num = num + 1
							end
						end
						if num <= 1 then
							DrawStrBoxWaitKey("场上没有可施展的目标", C_WHITE, 30)
							return 0							
						end
						DrawStrBox(CC.MainMenuX, CC.MainMenuY, "紧那罗", C_GOLD, 30)
						local r = ShowMenu(dxp, num - 1, 10, CC.MainMenuX, CC.MainMenuY + 45, 0, 0, 1, 0, CC.DefaultFont, C_RED, C_GOLD)
						Cls()
						local mid = WAR.Person[dxp[r][4]]["人物编号"]
						AddPersonAttrib(pid, "体力", -8)
						WAR.DOUCE = WAR.DOUCE + 1
						zhanyi(pid, 2)
						WAR.LQZ[mid] = limitX((WAR.LQZ[mid] or 0) - 60, 0, 100)
						DHdisplay(1345, 1364, "八部斗策 人非人 紧那罗")
					else
						return 0					
					end
				elseif qishu == 6 then
					local xy = JYMsgBox("迦楼罗", "提升指定队友当前集气值750点", CC.EVB173, 2, pid)
					if xy == 1 then
						local dxp = {}
						local num = 1
						for i = 0, WAR.PersonNum - 1 do 
							if WAR.Person[i]["我方"] and WAR.Person[i]["死亡"] == false and i ~= WAR.CurID then
								dxp[num] = {}
								dxp[num][1] = JY.Person[WAR.Person[i]["人物编号"]]["姓名"] 
								dxp[num][2] = nil
								dxp[num][3] = 1
								dxp[num][4] = i
								num = num + 1
							end
						end
						if num <= 1 then
							DrawStrBoxWaitKey("场上没有可施展的目标", C_WHITE, 30)
							return 0							
						end
						DrawStrBox(CC.MainMenuX, CC.MainMenuY, "迦楼罗", C_GOLD, 30)
						local r = ShowMenu(dxp, num - 1, 10, CC.MainMenuX, CC.MainMenuY + 45, 0, 0, 1, 0, CC.DefaultFont, C_RED, C_GOLD)
						Cls()
						local mid = WAR.Person[dxp[r][4]]["人物编号"]
						AddPersonAttrib(pid, "体力", -8)
						WAR.DOUCE = WAR.DOUCE + 1
						zhanyi(pid, 2)
						WAR.Person[dxp[r][4]].Time = WAR.Person[dxp[r][4]].Time + 750
						if WAR.Person[dxp[r][4]].Time > 999 then
						WAR.Person[dxp[r][4]].Time = 999
						end
						DHdisplay(1345, 1364, "八部斗策 金翅鸟 迦楼罗")
					else
						return 0					
					end
				elseif qishu == 7 then					
					local xy = JYMsgBox("龙王", "提升全体队友战意值十点", CC.EVB173, 2, pid)
					if xy == 1 then
						DrawStrBox(CC.MainMenuX, CC.MainMenuY, "龙王", C_GOLD, 30)
						Cls()					
						AddPersonAttrib(pid, "体力", -8)
						WAR.DOUCE = WAR.DOUCE + 1
						zhanyi(pid, 2)
						for i = 0, WAR.PersonNum - 1 do 
							if WAR.Person[i]["我方"] and WAR.Person[i]["死亡"] == false and i ~= WAR.CurID then
								zhanyi(WAR.Person[i]["人物编号"], 10)
							end
						end
						DHdisplay(1345, 1364, "八部斗策 那伽 龙王")
					else
						return 0					
					end
				elseif qishu == 8 then
					local zl = JYMsgBox("天王", "召唤一名斗神助战（不能与本体同时在场）", CC.EVB173, 2, pid)
					if zl == 1 then				
						local doushen = JY.Person[pid]["无用12"]
						if doushen <= 0 or DrawStrBoxYesNo(-1, -1, "现在的斗神是"..JY.Person[doushen]["姓名"].."，你想召唤新的斗神么？", C_WHITE, 30) == true then
							local dxp = {}
							local num = 1
							for i = 0, WAR.PersonNum - 1 do 
								if WAR.Person[i]["我方"] == false and WAR.Person[i]["死亡"] == false and i ~= WAR.CurID and not duiyou(WAR.Person[i]["人物编号"]) then
									dxp[num] = {}
									dxp[num][1] = JY.Person[WAR.Person[i]["人物编号"]]["姓名"] 
									dxp[num][2] = nil
									dxp[num][3] = 1
									dxp[num][4] = i
									num = num + 1
								end
							end
							if num <= 1 then
								DrawStrBoxWaitKey("场上没有可施展的目标", C_WHITE, 30)
								return 0							
							end
							DrawStrBox(CC.MainMenuX, CC.MainMenuY, "天王", C_GOLD, 30)
							local r = ShowMenu(dxp, num - 1, 10, CC.MainMenuX, CC.MainMenuY + 45, 0, 0, 1, 0, CC.DefaultFont, C_RED, C_GOLD)
							Cls()
							local mid = WAR.Person[dxp[r][4]]["人物编号"]
							JY.Person[pid]["无用12"] = mid
							doushen = JY.Person[pid]["无用12"]
						end
						local benti = 0
						for i = 0, WAR.PersonNum - 1 do 
							if WAR.Person[i]["死亡"] == false and i ~= WAR.CurID then
								if WAR.Person[i]["人物编号"] == doushen then
									benti = 1
									break
								end
							end
						end
						if benti == 1 then
							return 0
						end
						local x, y = WE_xy(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] - 1)
						NewWARPersonZJ(doushen, true, x, y, false, 2);
						AddPersonAttrib(pid, "体力", -8)
						WAR.DOUCE = WAR.DOUCE + 1
						zhanyi(pid, 2)
						DHdisplay(1345, 1364, "八部斗策 提婆 天王")
					else
						return 0
					end								
				end
					
			end --八部斗策结束
			
		elseif T3XYK(pid) then
			if JY.Person[pid]["体力"] > 20 then	
				local zhilingnum = 1
				if juexing() > 0 then
					zhilingnum = 2
				end
				if juexing() > 1 then
					zhilingnum = 3
				end
				if juexing() > 2 then
					zhilingnum = 4
				end			
				Cls()
				local qishu = JYMsgBox("军神", "要选择哪一个指令？", {"血翼", "影杀", "指挥", "再临"}, zhilingnum, pid)	
				if qishu <= 0 then
					return 0
				end
				if qishu == 1 then
					local xy = JYMsgBox("血翼", "此回合必暴击且得到实战加倍*消耗：体力10点", CC.EVB173, 2, pid)
					if xy == 1 then
						DHdisplay(2513, 2522, "血翼")
						AddPersonAttrib(pid, "体力", -10)
						WAR.JUNSHEN = 1
					else
						return 0
					end
				elseif qishu == 2 then
					if WAR.JUNSHEN2 ~= 0 then
						DrawStrBoxWaitKey("已经制造过分身了", C_WHITE, 30)
						return 0
					end				
					local tj = "现有体力生命内力的一半"
					if juexing() > 2 then
						tj = "体力10点"
					end
					local fs = JYMsgBox("分身", "制造一个影分身参战*消耗："..tj, CC.EVB173, 2, pid)
					if fs == 1 then
						if juexing() > 2 then
							say("Ｒ真・影分身！") 
							AddPersonAttrib(pid, "体力", -10)
							--AddPersonAttrib(pid, "内力", -600)
						else
							AddPersonAttrib(pid, "体力", -math.modf(JY.Person[pid]["体力"] * 0.5))
							AddPersonAttrib(pid, "生命", -math.modf(JY.Person[pid]["生命"] * 0.5))
							AddPersonAttrib(pid, "内力", -math.modf(JY.Person[pid]["内力"] * 0.5))
							say("Ｒ影分身！")  
						end						
						local x, y = WE_xy(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] - 1)
						NewWARPersonZJ(pid, true, x, y, false, 2);
						WAR.JUNSHEN2 = 1	
					else
						return 0
					end
				elseif qishu == 3 then
					local zh = JYMsgBox("指挥", "令一个队友集气值提升至1000*消耗：体力15点内力1000点", CC.EVB173, 2, pid)
					if zh == 1 then
						local dxp = {}
						local num = 1
						for i = 0, WAR.PersonNum - 1 do 
							if WAR.Person[i]["我方"] and WAR.Person[i]["死亡"] == false and i ~= WAR.CurID then
								dxp[num] = {}
								dxp[num][1] = JY.Person[WAR.Person[i]["人物编号"]]["姓名"] 
								dxp[num][2] = nil
								dxp[num][3] = 1
								dxp[num][4] = i
								num = num + 1
							end
						end
						if num <= 1 then
							DrawStrBoxWaitKey("场上没有可施展的目标", C_WHITE, 30)
							return 0							
						end
						DrawStrBox(CC.MainMenuX, CC.MainMenuY, "指挥", C_GOLD, 30)
						local r = ShowMenu(dxp, num - 1, 10, CC.MainMenuX, CC.MainMenuY + 45, 0, 0, 1, 0, CC.DefaultFont, C_RED, C_GOLD)
						Cls()
						local mid = WAR.Person[dxp[r][4]]["人物编号"] 
						PlayWavE(28)
						lib.Delay(10)
						CurIDTXDH(WAR.CurID, 1458, 1442, "军神技・指挥")
						local Ocur = WAR.CurID
						WAR.CurID = dxp[r][4] --选择的人物暂时变行动人物，战场动画移动
						WarDrawMap(0)
						PlayWavE(36)
						lib.Delay(100)
						CurIDTXDH(WAR.CurID, 1442, 1458, "集气提升至1000")
						WAR.CurID = Ocur
						WarDrawMap(0)
						WAR.Person[dxp[r][4]].Time = 1000
						AddPersonAttrib(pid, "体力", -15)
						AddPersonAttrib(pid, "内力", -1000)						
					else
						return 0
					end
				elseif qishu == 4 then
					if WAR.JUNSHEN3 ~= 0 then
						DrawStrBoxWaitKey("每场战斗限用一次", C_WHITE, 30)
						return 0					
					end
					local zl = JYMsgBox("再临", "复活被击退队友一员*消耗：体力20点内力1000点", CC.EVB173, 2, pid)
					if zl == 1 then
						local dxp = {}
						local num = 1
						for i = 0, WAR.PersonNum - 1 do 
							if WAR.Person[i]["我方"] and WAR.Person[i]["死亡"] and WAR.Person[i]["人物编号"] ~= pid then
								dxp[num] = {}
								dxp[num][1] = JY.Person[WAR.Person[i]["人物编号"]]["姓名"] 
								dxp[num][2] = nil
								dxp[num][3] = 1
								dxp[num][4] = i
								num = num + 1
							end
						end
						if num <= 1 then
							DrawStrBoxWaitKey("目前无人被击退", C_WHITE, 30)
							return 0
						end						
						DrawStrBox(CC.MainMenuX, CC.MainMenuY, "再临", C_GOLD, 30)
						local r = ShowMenu(dxp, num - 1, 10, CC.MainMenuX, CC.MainMenuY + 45, 0, 0, 1, 0, CC.DefaultFont, C_RED, C_GOLD)
						Cls()
						local mid = WAR.Person[dxp[r][4]]["人物编号"] 
						local nx, ny = WE_xy(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] - 1)
						WAR.Person[dxp[r][4]]["死亡"] = false
						lib.SetWarMap(nx, ny, 5, -1)
						lib.SetWarMap(nx, ny, 2, -1)														
						PlayWavE(28)
						lib.Delay(10)
						CurIDTXDH(WAR.CurID, 1458, 1442, "军神技・再临")
						local Ocur = WAR.CurID
						WAR.CurID = dxp[r][4] 
						WarDrawMap(0)
						PlayWavE(36)
						lib.Delay(50)						
						lib.SetWarMap(nx, ny, 5, dxp[r][4])
						lib.SetWarMap(nx, ny, 2, WAR.Person[dxp[r][4]]["贴图"])		
						WAR.Person[dxp[r][4]]["人方向"]	= WAR.Person[WAR.CurID]["人方向"]	
						CurIDTXDH(WAR.CurID, 2611, 2641, "")
						lib.Delay(100)	
						WAR.CurID = Ocur
						WarDrawMap(0)
						JY.Person[mid]["体力"] = 100
						JY.Person[mid]["生命"] = JY.Person[mid]["生命最大值"] 
						JY.Person[mid]["内力"] = JY.Person[mid]["内力最大值"]
						WAR.JUNSHEN3 = 1
					else
						return 0
					end			
				end
			else
				DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
				return 0
			end			
		
		elseif T8LXY(pid) then --李逍遥奇术指令
			if JY.Person[pid]["体力"] > 10 then	
				local word = ""	
				local zhilingnum = 1
				if tianshu() >= 2 then
					zhilingnum = 2
				end
				if tianshu() >= 4 then
					zhilingnum = 3
				end
				if tianshu() >= 7 then
					zhilingnum = 4
				end
				if tianshu() >= 10 and juexing() >= 3 then -- JY.Person[pid]["武功10"] > 0 and
					zhilingnum = 5
				end
				Cls()
				local qishu = JYMsgBox("奇术", "要选择哪一个招式？", {"妙手", "冰心", "醉仙", "云体", "酒神"}, zhilingnum, pid)	
				if qishu <= 0 then
					return 0
				end
				if qishu == 1 then
					local miaoshou = JYMsgBox("飞龙探云手", "窃取敌人物品，数量随机*消耗：无", CC.EVB173, 2, pid)
					if miaoshou == 1 and WAR.ZDDH ~= 341 then --武骧金星：队友挑战任务中不能偷东西
						War_CalMoveStep(WAR.CurID, 5, 1) --武功移动步数
						local nx, ny = nil, nil
						local victim = -1
						local victimid = -1
						while true do
							nx, ny = War_SelectMove() --显示+选择步数
							if nx == nil then
								return 0
							end
							if nx ~= nil then
								if lib.GetWarMap(nx, ny, 2) < 0 and lib.GetWarMap(nx, ny, 5) < 0 then
									QZXS("此处无人，请重新选择")			
								elseif GetWarMap(nx, ny, 2) == nil or GetWarMap(nx, ny, 2) < 0 then
									QZXS("此处无人，请重新选择")	
								else
									victim = GetWarMap(nx, ny, 2)
									victimid = WAR.Person[victim]["人物编号"]
									if WAR.Person[WAR.CurID]["我方"] == WAR.Person[victim]["我方"] then
										QZXS("不能选择我方人物")	
									else
										break;
									end
								end
							end
						end
						for xx = 0, 63 do
							for yy = 0, 63 do
								SetWarMap(xx, yy, 4, -1)
							end
						end
						SetWarMap(nx, ny, 4, 6)
						War_ShowFight(pid,0,0,0,nx,ny,56);
						
						local itemid = -1
						local itemnumber = 0
						local hasitem = 0
						
						for i = 1, 4 do
							if JY.Person[victimid]["携带物品数量" .. i] > 0 and JY.Person[victimid]["携带物品" .. i] > -1 then
								hasitem = 1
								break
							end
						end
						if hasitem == 0 then
							QZXS(JY.Person[victimid]["姓名"].."身上没有物品")	
						else
							local itemrandom
							while itemid == -1 do
								itemrandom = math.random(4)
								if JY.Person[victimid]["携带物品数量" .. itemrandom] > 0 and 
									JY.Person[victimid]["携带物品" .. itemrandom] > -1 then				
									itemnumber =JY.Person[victimid]["携带物品数量" .. itemrandom]
									itemid = JY.Person[victimid]["携带物品" .. itemrandom]
								end
							end
							if itemnumber == JY.Person[victimid]["携带物品数量" .. itemrandom] then
								JY.Person[victimid]["携带物品数量" .. itemrandom] = 0
								JY.Person[victimid]["携带物品" .. itemrandom] = -1
							else
								JY.Person[victimid]["携带物品数量" .. itemrandom] = 
									JY.Person[victimid]["携带物品数量" .. itemrandom] - itemnumber
							end
							instruct_32(itemid, itemnumber)
							QZXS("窃取"..JY.Thing[itemid]["名称"]..tostring(itemnumber).."件")	
						end			
						SetWarMap(nx, ny, 4, -1)						
					else
						return 0
					end
				elseif qishu == 2 then
					local bingxin = JYMsgBox("冰心决", "降低敌人怒气值20点*消耗：自身怒气值10点", CC.EVB173, 2, pid)
					if bingxin == 1 then
						if WAR.LQZ[0] == nil or WAR.LQZ[0] < 10 then
							DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
							return 0
						end
						War_CalMoveStep(WAR.CurID, 8, 1) --武功移动步数
						local nx, ny = nil, nil
						local victim = -1
						local victimid = -1
						while true do
							nx, ny = DIYWar_SelectMove() --显示+选择步数
							if nx == nil then
								return 0
							end
							if nx ~= nil then
								if lib.GetWarMap(nx, ny, 2) < 0 and lib.GetWarMap(nx, ny, 5) < 0 then
									QZXS("此处无人，请重新选择")			
								elseif GetWarMap(nx, ny, 2) == nil or GetWarMap(nx, ny, 2) < 0 then
									QZXS("此处无人，请重新选择")	
								else
									victim = GetWarMap(nx, ny, 2)
									victimid = WAR.Person[victim]["人物编号"]
									if WAR.Person[WAR.CurID]["我方"] == WAR.Person[victim]["我方"] then
										QZXS("不能选择我方人物")	
									else
										break;
									end
								end
							end
						end
						for xx = 0, 63 do
							for yy = 0, 63 do
								SetWarMap(xx, yy, 4, -1)
							end
						end
						SetWarMap(nx, ny, 4, 6)
						War_ShowFight(pid,0,0,0,nx,ny,80);
						WAR.LQZ[0] = WAR.LQZ[0] - 10
						if WAR.LQZ[0] == 0 then
							WAR.LQZ[0] = nil
						end
						if WAR.LQZ[victimid] ~= nil then
							WAR.LQZ[victimid] = WAR.LQZ[victimid] - 20
							if WAR.LQZ[victimid] <= 0  then
								WAR.LQZ[victimid] = nil
							end
						end
						if WAR.SPIRIT[victimid] ~= nil then
							WAR.SPIRIT[victimid] = WAR.SPIRIT[victimid] - 20
							if WAR.SPIRIT[victimid] <= 0  then
								WAR.SPIRIT[victimid] = nil
							end
						end
						QZXS(JY.Person[victimid]["姓名"].."怒气降低20点".."战意降低20点")
						SetWarMap(nx, ny, 4, -1)	
					else
						return 0
					end
				elseif qishu == 3 then
					local zuixian = JYMsgBox("醉仙望月步", "接下来三次攻击必连击*消耗：体力20点", CC.EVB173, 2, pid)
					if zuixian == 1 then
						if JY.Person[0]["体力"] < 20 then
							DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
							return 0
						end
						JY.Person[0]["体力"] = JY.Person[0]["体力"] - 20
						for i = 1345, 1364 do
							CurIDTXDH(WAR.CurID, i, i, "醉仙望月步");		--动画显示	
							lib.Delay(10)
						end	
						WAR.LXYLJ = 3
						--WAR.LXYZLPD = 1
					else
						return 0
					end
				elseif qishu == 4 then
					local xianfeng = JYMsgBox("仙风云体术", "30时序内高几率回避伤害*消耗：体力15点", CC.EVB173, 2, pid)
					if xianfeng == 1 then
						if JY.Person[0]["体力"] < 15 then
							DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
							return 0
						end
						JY.Person[0]["体力"] = JY.Person[0]["体力"] - 15
						for i = 1305, 1324 do
							CurIDTXDH(WAR.CurID, i, i, "仙风云体术");		--动画显示	
							lib.Delay(10)
						end	
						WAR.LXYXF = 30
					else
						return 0
					end			
				else
					local jianshen = JYMsgBox("酒神咒", "此回合的攻击无视防御与特*效伤害最大生命值八分之一*条件：内力1000点以上*消耗：怒气100点内力500点", CC.EVB173, 2, pid)--沼跃鱼：李逍遥酒神咒
					if jianshen == 1 then
						if JY.Person[0]["内力"] < 1000 or (WAR.LQZ[0] == nil or WAR.LQZ[0] < 100) then
							DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
							return 0
						end
						WAR.LQZ[0] = nil
						JY.Person[0]["内力"] = JY.Person[0]["内力"] - 500
						for i = 1624, 1636 do
							CurIDTXDH(WAR.CurID, i, i, "酒神.气吞天下");		--动画显示	
							lib.Delay(10)
						end						
						WAR.LXYJS = 1
						WAR.LXYJSTS = 1
						War_FightMenu()
						WAR.LXYJS = 0
						WAR.LXYJSTS = 0				
					else
						return 0
					end				
				end
			else
				DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
				return 0
			end
		elseif T13TQS(pid) then
			if JY.Person[pid]["体力"] > 10 then	
				local zhilingnum = 2
				local bonus = 0
				if juexing() > 0 then bonus = 30 end
				zhilingnum = zhilingnum + limitX(math.modf(JY.Person[pid]["实战"] / 100), 0, 3)
				Cls()
				local qishu = JYMsgBox("兽王", "要选择哪一个招式？", {"狮吼", "蛇毒", "豹隐", "狐魅", "龙息"}, zhilingnum, pid)
				if qishu <= 0 then
					return 0
				end
				if qishu == 1 then
					local xy = JYMsgBox("狮吼", "敌全体集气下降500点 封穴且受内伤*消耗：体力10点", CC.EVB173, 2, pid)
					if xy ~= 1 then
					return 0
					end
					if JY.Person[pid]["体力"] > 10 then
						DrawStrBox(CC.MainMenuX, CC.MainMenuY, "狮吼", C_GOLD, 30)
						Cls()					
						for i = 0, WAR.PersonNum - 1 do 
							if WAR.Person[i]["我方"] == false and WAR.Person[i]["死亡"] == false and i ~= WAR.CurID then
								WAR.Person[i].Time = limitX(WAR.Person[i].Time-500,-500,1000)
								WAR.FXXS[WAR.Person[i]["人物编号"]] = 1 --封穴判定
								if WAR.FXDS[WAR.Person[i]["人物编号"]] ~= nil then
									WAR.FXDS[WAR.Person[i]["人物编号"]] = WAR.FXDS[WAR.Person[i]["人物编号"]] + math.random(4,6) --封穴点数
								else
									WAR.FXDS[WAR.Person[i]["人物编号"]] = math.random(4,6)
								end
								AddPersonAttrib(WAR.Person[i]["人物编号"],"受伤程度", math.random(10,20))
							end
						end
						DHdisplay(1345, 1364, "兽王心经.如耳损.狮王怒吼")
						AddPersonAttrib(pid, "体力", -10)
					else
						DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						return 0
					end
				elseif qishu == 2 then
					local xy = JYMsgBox("蛇毒", "目标敌人中毒100，毒击状态且一定时序内无法解毒*消耗：体力20点", CC.EVB173, 2, pid)
					if xy ~= 1 then
						return 0
					end							
					if JY.Person[pid]["体力"] > 20 then
						local nx, ny, victim, victimid = selectPerson(7, 1)
						if nx == -1 then
							return 0
						end
						CleanWarMap(4, 0)
						SetWarMap(WAR.Person[victim]["坐标X"],WAR.Person[victim]["坐标Y"], 4, 2)						
						AddPersonAttrib(victimid,"中毒程度", 100)
						WAR.POISON[victimid] = math.modf(JY.Person[pid]["实战"] / 10) + bonus
                        WAR.L_WNGZL[victimid] = 50 + math.modf(JY.Person[pid]["实战"] / 10) + bonus
						War_ShowFight(pid, 0, 0, 0, WAR.Person[WAR.CurID]["坐标X"],WAR.Person[WAR.CurID]["坐标Y"], 185)	
						DHdisplay(1345, 1364, "兽王心经.如舌痹.蛇王剧毒")
						AddPersonAttrib(pid, "体力", -20)	
					else
						DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						return 0
					end	
										
				elseif qishu == 3 then
					local xy = JYMsgBox("豹隐", "自己进入隐蔽状态，隐蔽时攻击则提高1-2倍伤害*消耗：体力15点内力600点", CC.EVB173, 2, pid)
					if xy ~= 1 then
						return 0
					end							
					if JY.Person[pid]["体力"] > 15 and JY.Person[pid]["内力"] > 600 then				
					    WAR.HIDE[pid]= 30
						DHdisplay(1345, 1364, "兽王奥义.如眼拙.豹王匿踪")
						AddPersonAttrib(pid, "体力", -15)
						AddPersonAttrib(pid, "内力", -600)							
					else
						DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						return 0
					end
				elseif qishu == 4 then					
					local xy = JYMsgBox("狐媚", "目标周边五格所有人进入全面低迷状态*消耗：体力20点内力600点", CC.EVB173, 2, pid)
					if xy ~= 1 then
						return 0
					end							
					if JY.Person[pid]["体力"] > 20 and JY.Person[pid]["内力"] > 600 then
						local nx, ny, victim, victimid = selectPerson(7, 1)
						if nx == -1 then
							return 0
						end
						CleanWarMap(4, 0)
						for i = 0, WAR.PersonNum - 1 do
							if WAR.Person[i]["人物编号"] ~= WAR.Person[WAR.CurID]["人物编号"] and 
								WAR.Person[i]["死亡"] == false and RealJL(victim, i, 5) then
								SetWarMap(WAR.Person[i]["坐标X"],WAR.Person[i]["坐标Y"], 4, 2)
								WAR.ATKDOWN[WAR.Person[i]["人物编号"]] = 20 + math.modf(JY.Person[pid]["实战"] / 10) + bonus
								WAR.DEFDOWN[WAR.Person[i]["人物编号"]] = 20 + math.modf(JY.Person[pid]["实战"] / 10) + bonus
								WAR.SPDDOWN[WAR.Person[i]["人物编号"]] = 20 + math.modf(JY.Person[pid]["实战"] / 10) + bonus
							end
						end		
						War_ShowFight(pid, 0, 0, 0, WAR.Person[WAR.CurID]["坐标X"],WAR.Person[WAR.CurID]["坐标Y"], 146)	
						AddPersonAttrib(pid, "体力", -20)
						AddPersonAttrib(pid, "内力", -600)
					    DHdisplay(1345, 1364, "兽王奥义.如体酥.狐王魅香")					
					else
						DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						return 0
					end
				elseif qishu == 5 then
					local xy = JYMsgBox("龙息", "目标敌人遭受冰火吐息攻击*消耗：体力20点内力200点", CC.EVB173, 2, pid)
					if xy ~= 1 then
						return 0
					end							
					if JY.Person[pid]["体力"] > 20 and JY.Person[pid]["内力"] > 200 then
						local nx, ny, victim, victimid = selectPerson(7, 1)
						if nx == -1 then
							return 0
						end
						CleanWarMap(4, 0)
						SetWarMap(WAR.Person[victim]["坐标X"],WAR.Person[victim]["坐标Y"], 4, 2)
						War_ExecuteMenu_Sub(WAR.Person[victim]["坐标X"], WAR.Person[victim]["坐标Y"], 4, 35)
						WAR.ICE[victimid] = limitX((WAR.ICE[victimid] or 0) + 30, 0, 50) + bonus
						WAR.HOT[victimid] = limitX((WAR.ICE[victimid] or 0) + 30, 0, 50) + bonus
						WAR.PEACE[victimid] = limitX((WAR.ICE[victimid] or 0) + 30, 0, 50) + bonus
						if WAR.LQZ[victimid] ~= nil then
							WAR.LQZ[victimid] = WAR.LQZ[victimid] - 20
							if WAR.LQZ[victimid] <= 0  then
								WAR.LQZ[victimid] = nil
							end
						end
						if WAR.SPIRIT[victimid] ~= nil then
							WAR.SPIRIT[victimid] = WAR.SPIRIT[victimid] - 20
							if WAR.SPIRIT[victimid] <= 0  then
								WAR.SPIRIT[victimid] = nil
							end
						end
						War_ShowFight(pid, 0, 0, 0, WAR.Person[WAR.CurID]["坐标X"],WAR.Person[WAR.CurID]["坐标Y"], math.random(145,167))	
						AddPersonAttrib(pid, "体力", -20)
						AddPersonAttrib(pid, "内力", -200)
						DHdisplay(1345, 1364, "兽王奥义.如意乏.龙王吐息")
					else
						DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						return 0
					end
				end
			else
				DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
				return 0
			end	
		elseif XYL(pid) then
			   	local zhilingnum = 3
			    if JY.Person[pid]["体力"] >= 10 then
				Cls()
				local qishu = JYMsgBox("太虚", "要选择哪一个指令？", {"乾坤", "紫气", "抱元"}, zhilingnum, pid)	
			    if qishu <= 0 then
					return 0
				end
			        if qishu == 1 then
					local xy = JYMsgBox("转乾坤", "两回合内减伤60%*消耗：内力200点", CC.EVB173, 2, pid)
					if xy ~= 1 then
						return 0
					end
				       if WAR.ZQK[pid] ~= nil or JY.Person[pid]["内力"] < 200 then
				          DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						  return 0
				       else
			           for i = 1849, 1864 do
				       CurIDTXDH(WAR.CurID, i, i, "纯阳决 转乾坤");		--动画显示	
				       lib.Delay(10)
			           end
					   addeffect(WAR.ZQK, pid, 4)
				       AddPersonAttrib(pid, "内力", -200)
				       end
			        elseif qishu == 2 then
					local xy = JYMsgBox("紫气东来", "四回合内攻击效果和集气速度提升40%*消耗：内力1000点", CC.EVB173, 2, pid)
					if xy ~= 1 then
						return 0
					end
				       if WAR.ZQDL[pid] ~= nil or JY.Person[pid]["内力"] < 1000 then
				          DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						  return 0
				       else
			           for i = 2558, 2582 do
				       CurIDTXDH(WAR.CurID, i, i, "坐忘经 紫气东来");		--动画显示	
				       lib.Delay(10)
			           end
					   addeffect(WAR.ZQDL, pid, 5)
				       AddPersonAttrib(pid, "内力", -1000)
				       end
					elseif qishu == 3 then
					local xy = JYMsgBox("抱元守缺", "恢复自身最大内力值60%的内力，限定一次*消耗：无", CC.EVB173, 2, pid)
					if xy ~= 1 then
						return 0
					end
				       if WAR.BYSQ == 1 then
				          DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						  return 0
				       else
			           for i = 1001, 1026 do
				       CurIDTXDH(WAR.CurID, i, i, "坐忘经 抱元守缺");		--动画显示	
				       lib.Delay(10)
					   AddPersonAttrib(pid, "内力", math.modf(JY.Person[pid]["内力最大值"]*0.6))
			           end
					   WAR.BYSQ = 1
				       end
			        end	
			    end
		elseif NF(pid) then
				local zhilingnum = 3
				if JY.Person[pid]["体力"] >= 10 then
				Cls()
				local qishu = JYMsgBox("魔刀", "要选择哪一个招式？", {"麒麟魔", "无情刃", "血魔功"}, zhilingnum, pid)
				if qishu <= 0 then
					return 0
				end
				if qishu == 1 then
					local xy = JYMsgBox("麒麟魔", "敌全体集气下降500点 封穴且受内伤", CC.EVB173, 2, pid)
					if xy ~= 1 then
					return 0
					end
					if JY.Person[pid]["体力"] > 10 then
						DrawStrBox(CC.MainMenuX, CC.MainMenuY, "麒麟魔", C_GOLD, 30)
						Cls()					
						for i = 0, WAR.PersonNum - 1 do 
							if WAR.Person[i]["我方"] == false and WAR.Person[i]["死亡"] == false and i ~= WAR.CurID then
								WAR.Person[i].Time = limitX(WAR.Person[i].Time-500,-500,1000)
								WAR.FXXS[WAR.Person[i]["人物编号"]] = 1 --封穴判定
								if WAR.FXDS[WAR.Person[i]["人物编号"]] ~= nil then
									WAR.FXDS[WAR.Person[i]["人物编号"]] = WAR.FXDS[WAR.Person[i]["人物编号"]] + math.random(20,50) --封穴点数
								else
									WAR.FXDS[WAR.Person[i]["人物编号"]] = math.random(20,50)
								end
								AddPersonAttrib(WAR.Person[i]["人物编号"],"受伤程度", math.random(50,100))
							end
						end
						DHdisplay(1759, 1777, "麒麟魔")
					else
						DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
						return 0
					end
				elseif qishu == 2 then
					local xy = JYMsgBox("无情刃", "降低指定敌方人物的怒气值100点", CC.EVB173, 2, pid)
					if xy == 1 then
						local dxp = {}
						local num = 1
						for i = 0, WAR.PersonNum - 1 do 
							if WAR.Person[i]["我方"] == false and WAR.Person[i]["死亡"] == false and i ~= WAR.CurID then
								dxp[num] = {}
								dxp[num][1] = JY.Person[WAR.Person[i]["人物编号"]]["姓名"] 
								dxp[num][2] = nil
								dxp[num][3] = 1
								dxp[num][4] = i
								num = num + 1
							end
						end
						if num <= 1 then
							DrawStrBoxWaitKey("场上没有可施展的目标", C_WHITE, 30)
							return 0							
						end
						DrawStrBox(CC.MainMenuX, CC.MainMenuY, "无情刃", C_GOLD, 30)
						local r = ShowMenu(dxp, num - 1, 10, CC.MainMenuX, CC.MainMenuY + 45, 0, 0, 1, 0, CC.DefaultFont, C_RED, C_GOLD)
						Cls()
						local mid = WAR.Person[dxp[r][4]]["人物编号"]
						AddPersonAttrib(pid, "体力", -5)
						WAR.DOUCE = WAR.DOUCE + 1
						zhanyi(pid, 2)
						WAR.LQZ[mid] = limitX((WAR.LQZ[mid] or 0) - 100, 0, 100)
						DHdisplay(2691, 2702, "无情刃")
					else
						return 0					
					end			
				elseif qishu == 3 then
					local xy = JYMsgBox("血魔功", "以血为刃 敌人下一回合无法行动", CC.EVB173, 2, pid)
					if JY.Person[pid]["体力"] >= 10 then
		                War_CalMoveStep(WAR.CurID, 99, 1) --武功移动步数
			            local nx, ny = nil, nil
			            local victim = -1
			            local victimid = -1
			            while true do
				        nx, ny = DIYWar_SelectMove() --显示+选择步数
				        if nx == nil then
					        return 0
				        end
				        if nx ~= nil then
					        if lib.GetWarMap(nx, ny, 2) < 0 and lib.GetWarMap(nx, ny, 5) < 0 then
						        QZXS("此处无人，请重新选择")			
					        elseif GetWarMap(nx, ny, 2) == nil or GetWarMap(nx, ny, 2) < 0 then
						        QZXS("此处无人，请重新选择")	
					    else
						        victim = GetWarMap(nx, ny, 2)
						        victimid = WAR.Person[victim]["人物编号"]
						        if WAR.Person[WAR.CurID]["我方"] == WAR.Person[victim]["我方"] then
							        QZXS("不能选择我方人物")	
						        elseif WAR.QIZHEN[victimid] == 1 then
							        QZXS("此人已经被血魔功所困！")	
						        else
							        break;
						        end
					        end
				        end
			        end
			            WAR.QIZHEN[victimid] = 1
			            WAR.L_NOT_MOVE[victimid] = 1
			            QZXS(JY.Person[victimid]["姓名"].."被血魔功所困！")
		            else
			            DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
			            return 0
		            end					
				elseif qishu == 4 then
					local xy = JYMsgBox("魔横行", "与敌人互换生命", CC.EVB173, 2, pid)
					CleanWarMap(4, 0)
			        local nx, ny, victim, victimid = selectPerson(4, 1)
			        if nx == -1 then
				       return 0
			        end
			        Cls()
			        SetWarMap(nx, ny, 4, 2)
			        DIYdisplay(CC.ASKILL[6][2])
			        War_ShowFight(pid,0,0,0,nx,ny,98);	
			        QZXS(JY.Person[victimid]["姓名"].."与"..JY.Person[pid]["姓名"].."血量交换")		
			        SetWarMap(nx, ny, 4, -1)			
			        AddPersonAttrib(pid, "体力", -5)	
			        local tmpratio1 = JY.Person[pid]["生命"] / JY.Person[pid]["生命最大值"]
			        local tmpratio2 = JY.Person[victimid]["生命"] / JY.Person[victimid]["生命最大值"]
			        JY.Person[pid]["生命"] = math.modf(tmpratio2 * JY.Person[pid]["生命最大值"])
			        JY.Person[victimid]["生命"] = math.modf(tmpratio1 * JY.Person[victimid]["生命最大值"])
			        if JY.Person[pid]["生命"] < 1 then JY.Person[pid]["生命"] = 1 end
			            if JY.Person[victimid]["生命"] < 1 then JY.Person[victimid]["生命"] = 1 end			
			                addeffect(WAR.HUANXUE, pid, 1)
				        end
			        else
				    DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
					DHdisplay(494, 505, "魔横行")
				    return 0
			        end		
						
    
    --[[ 武骧金星：修正指令冲突的问题			
		elseif pid == 0 and cxzj() == 0 then --蓝烟清：主角召唤独孤求败
			if JY.Person[pid]["体力"] >= 50 and JY.Person[pid]["内力"] >= 500 and WAR.L_DGQB_ZL == 0  then		
				AddPersonAttrib(pid, "体力", -15)
				AddPersonAttrib(pid, "内力", -500)	
				local x, y = WE_xy(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] - 1)
				NewWARPersonZJ(592, true, x, y, false, 2);
				local s = nil
				s = WAR.CurID
				WAR.CurID = WAR.PersonNum - 1
				Talk("难得如此大战，不来参加真是可惜啊~~~哈哈~~~", 592)  
				WAR.CurID = s
				WAR.L_DGQB_ZL = 1;
				JY.Person[592]["声望"] = JY.Person[592]["声望"] + 1;
			else
				DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
				return 0
			end
    --]]
		end
	end	
	
	--蓝烟清：田伯光指令
	if ownPD(pid , 29) then
		if JY.Person[pid]["体力"] >= 20 and JY.Person[pid]["内力"] >= 200 then
			AddPersonAttrib(pid, "内力", -200)
			if GetS(86,10,12,5) == 1 then			--浪荡
				AddPersonAttrib(pid, "体力", -10)
				WAR.L_TBGZL = 1;
			elseif GetS(86,10,12,5) == 2 then		--戒色
				AddPersonAttrib(pid, "体力", -10)
				WAR.L_TBGZL = 2;
			end	    
			War_FightMenu();
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
			return 0
		end
	end
	return 1
end

--战斗蓄力
function War_ActupMenu()
    local p = WAR.CurID
    local id = WAR.Person[p]["人物编号"]
    local x0, y0 = WAR.Person[p]["坐标X"], WAR.Person[p]["坐标Y"]
    local str=""
    if DT(id,64) and JX(id)  then----周伯通蓄力
    WAR.Actup[id] = 2
    WAR.ZBT1=WAR.ZBT1 +1
    if WAR.ZBT1>7 then
    WAR.ZBT1=7
    end
    local aa=WAR.ZBT1
    str=aa.."重螺旋气劲"
    elseif PersonGT(id, 107) and (wglw(id,107) or DT(id,599)) then			--龙象，蓄力必成功
    WAR.Actup[id] = 2
	WAR.ZBT3=1
	str="螺旋九影积蓄"
    elseif PersonKF(id, 103) or MPPD(id)==6 then			--龙象，蓄力必成功
    WAR.Actup[id] = 2
    elseif JLSD(15, 85, id) then
    WAR.Actup[id] = 2
    end
    if WAR.Actup[id] ~= 2 then
    Cls()
    DrawStrBox(-1, -1, CC.WARS122, C_GOLD, 30)
    ShowScreen()
    lib.Delay(500)
    else
    local hb = GetS(JY.SubScene, x0, y0, 4)
    if CONFIG.Zoom == 1 then
      hb = hb * 2
    end
    local ssid = lib.SaveSur(CC.ScreenW / 2 - 80, CC.ScreenH / 2 - hb - 150, CC.ScreenW / 2 + 80, CC.ScreenH / 2 - hb + 30)
    for ii = 1343, 1353 do
      lib.PicLoadCache(3, ii * 2, CC.ScreenW / 2, CC.ScreenH / 2 - hb, 2, 192)
      ShowScreen()
      lib.Delay(30)
      lib.LoadSur(ssid, CC.ScreenW / 2 - 80, CC.ScreenH / 2 - hb - 150)
    end
    lib.FreeSur(ssid)
    Cls()
    DrawStrBox(-1, -1, CC.WARS123..str, C_GOLD, 30)
    ShowScreen()
    lib.Delay(500)
    end
    return 1
end

--战斗防御
function War_DefupMenu()
    local p = WAR.CurID
    local id = WAR.Person[p]["人物编号"]
    local x0, y0 = WAR.Person[p]["坐标X"], WAR.Person[p]["坐标Y"]
    WAR.Defup[id] = 1
    Cls()
    local hb = GetS(JY.SubScene, x0, y0, 4)
    if CONFIG.Zoom == 1 then
    hb = hb * 2
  end
  
    local ssid = lib.SaveSur(CC.ScreenW / 2 - 80, CC.ScreenH / 2 - hb - 150, CC.ScreenW / 2 + 80, CC.ScreenH / 2 - hb + 30)
    for ii = 1355, 1365 do
    lib.PicLoadCache(3, ii * 2, CC.ScreenW / 2, CC.ScreenH / 2 - hb, 2, 192)
    ShowScreen()
    lib.Delay(30)
    lib.LoadSur(ssid, CC.ScreenW / 2 - 80, CC.ScreenH / 2 - hb - 150)
    end
    lib.FreeSur(ssid)
    DrawStrBox(-1, -1, CC.WARS121, C_GOLD, 30)		--防御开始
    ShowScreen()
    lib.Delay(500)
    return 1
end

--设置人物的集气值，返回一个综合值以便循环刷新集气条
function GetJiqi()
    local num, total = 0, 0
    local function getnewmove(x, flag)
    if not flag then
      x = x * 2
    end
    if x > 160 then
      return 6 + (x - 160) / 60
    elseif x > 80 then
      return 4 + (x - 80) / 40
    elseif x > 30 then
      return 2 + (x - 30) / 25
    else
      return x / 15
    end
    end
    local function getnewmove1(a, b, flag)
    local x = (a * 2 + b) / 3
    if not flag then
      x = x * 2
    end
    if x > 5600 then
      return 8 + math.min((x - 5600) / 1200, 3)
    elseif x > 3600 then
      return 6 + (x - 3600) / 1200
    elseif x > 2000 then
      return 4 + (x - 2000) / 1000
    elseif x > 800 then
      return 2 + (x - 800) / 800
    else
      return x / 400
    end
    end
    for i = 0, WAR.PersonNum - 1 do
		if not WAR.Person[i]["死亡"] then
			local id = WAR.Person[i]["人物编号"]
			local nsyxjq = 0
			if inteam(id) then
				nsyxjq = math.modf(JY.Person[id]["受伤程度"] / 5*1.5)
			else
				nsyxjq = math.modf(JY.Person[id]["受伤程度"] / 10*1.5)
			end
			if T11CJR(id) then nsyxjq = 0 end
			if MPPD(id) == 11 and MPDJ(id) > 2 then nsyxjq = 0 end
				WAR.Person[i].TimeAdd = math.modf(getnewmove(WAR.Person[i]["轻功"]*0.85, inteam(id)) + getnewmove1(JY.Person[id]["内力"]/5, JY.Person[id]["内力最大值"]/5, inteam(id)) - JY.Person[id]["中毒程度"] / 10 - nsyxjq + JY.Person[id]["体力"] / 30 + 5)
		  
			if (JY.Person[id]["内力性质"] == 3) or JY.Person[id]["内力性质"] == 2 then --武骧金星：调和效果
				--WAR.Person[i].TimeAdd = math.modf(getnewmove(WAR.Person[i]["轻功"], inteam(id)) + 2 * getnewmove1(JY.Person[id]["内力"], JY.Person[id]["内力最大值"], inteam(id)) - JY.Person[id]["中毒程度"] / 20 - nsyxjq + JY.Person[id]["体力"] / 30 + 5)	  
				WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd*1.3)
			end
		  
			if not inteam(id) then 
				WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd*(0.8+JY.Thing[202][WZ7]/30))
			end	
			--WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd * 0.5)
			
			--日月神教
			if T7DFWM(id) then
				local jsyx = math.modf(sixi(0,2)/50)
				WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd * (1 + 0.05 * (jsyx)))
			end
		
			if DT(id, 114) then --豸苗：扫地僧佛渡集气--17-2-9-
				WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd*(2-WAR.SDQQ*0.1))
			end	
		
			if WAR.KHNP1[id] == 3 then --豸苗：葵花涅
				WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd*1.3)
			end

			if PersonGT(id, 102) and WAR.TXJ[id] ~= nil then
				WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd*1.5)
			end   
			
			if WAR.KHSY[id] ~= nil then
				WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd * 5)
			end   		
			
			if DT(id, 14) then --韦一笑集气速度
				local qf = wgnumber(id, 1)
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + math.modf(qf * 2)
			end

			if T5BCF(id) and juexing() >= 2 and JLSD(10, 20, id) and WAR.ZYHB ~= 1 then		--白愁飞偷集气
				local timechange = WAR.Person[i]["Time"]
				local victim = -1
				for j = 0,WAR.PersonNum -1 do
					if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == false then                            			   			                   
						if WAR.Person[j]["Time"] > timechange then
							timechange = WAR.Person[j]["Time"]
							victim = j
						end
					end
				end	
				if victim ~= -1 then
					WAR.Person[victim]["Time"] = WAR.Person[i]["Time"]
					WAR.Person[i]["Time"] = timechange													                                
					ShowScreen();
					lib.Delay(40)
					for i = 12,24 do
						NewDrawString(-1,-1,"昂扬独步天下",C_GOLD,25+i)
						ShowScreen();
						if i==24 then
							Cls();							
							NewDrawString(-1,-1,"昂扬独步天下",C_GOLD,25+i)
							ShowScreen();
							lib.Delay(500);
						else
							lib.Delay(1);
						end						
					end
					for i = 12,24 do
						NewDrawString(-1,-1,"鸿鹄志在红尘",C_GOLD,25+i)
						ShowScreen();
						if i == 24 then
							Cls();							
							NewDrawString(-1,-1,"鸿鹄志在红尘",C_GOLD,25+i)
							ShowScreen();
							lib.Delay(500);
						else
							lib.Delay(1);
						end						
					end
				end
			end
		  
			if KHT(id) and WAR.ZYHB ~= 1 then	
				local aa = 25
				local timechange = WAR.Person[i]["Time"]
				local victim = -1
				if wglw2(id,196) then
					aa = aa + 5
				end
				if JLSD(10, aa, id)	then
					for j = 0,WAR.PersonNum -1 do
						if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == false then                            			   			                   
							if WAR.Person[j]["Time"] > timechange then
								timechange = WAR.Person[j]["Time"]
								victim = j
							end
						end
					end	
					if victim ~= -1 then
						WAR.Person[victim]["Time"] = WAR.Person[i]["Time"]
						WAR.Person[i]["Time"] = timechange													                                
						ShowScreen();
						lib.Delay(40)
						for i = 12,24 do
							NewDrawString(-1,-1,"葵影遮天偷天换日",C_GOLD,25+i)
							ShowScreen();
							if i==24 then
								Cls();							
								NewDrawString(-1,-1,"葵影遮天偷天换日",C_GOLD,25+i)
								ShowScreen();
								lib.Delay(500);
							else
								lib.Delay(1);
							end						
						end
						for i = 12,24 do
							NewDrawString(-1,-1,"电光火石唯快不破",C_GOLD,25+i)
							ShowScreen();
							if i == 24 then
								Cls();							
								NewDrawString(-1,-1,"电光火石唯快不破",C_GOLD,25+i)
								ShowScreen();
								lib.Delay(500);
							else
								lib.Delay(1);
							end						
						end
					end
				end	
			end
			if WAR.ZQDL[id] ~= nil then 
				WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd*1.4)
			end
		  
			if DT(id , 99) and JY.Person[0]["品德"] < 30 then --云中鹤，品德越低速度越高
				local bonus = math.modf((1 + (30 - JY.Person[0]["品德"]) / 100))
				WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd * bonus)
			end 
		  
			if T1LEQ(id) then --027生命越少集气越快
				WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd * 
				(1 + 1 * ((JY.Person[id]["生命最大值"] - JY.Person[id]["生命"]) / JY.Person[id]["生命最大值"])))
			end
		  
			if id == 0 and T6XQS(0) then --萧秋水御剑每+40集气速度+5%
				local yujian = math.modf(sixi(id, 2) / 40)
				WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd * (1 + (0.05 * yujian)))
			end
			if DT(id,582) then  --木婉清集气速度
		       WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + math.modf(WAR.Person[i].TimeAdd * 0.5) 
		    end
		  
			for j = 0, WAR.PersonNum - 1 do 
				if hasTF(WAR.Person[j]["人物编号"], 71) then
					if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[i]["我方"] then
						WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd * 1.1)	
					end
				end
			end
		  
			for j = 0, WAR.PersonNum - 1 do --沼跃鱼：萧峰帝释天威效果--己方加速
				if DT(WAR.Person[j]["人物编号"], 50) and (WAR.Person[j]["人物编号"] == 0 or WAR.Person[j]["人物编号"] == 50) and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[i]["我方"] then
					local aa = WAR.Person[j]["人物编号"]
					local bb = WAR.SPIRIT[aa]
					local cc = (math.max(bb,100)-100)/250
					if cc > 0.25 then
						cc = 0.25
					end
					if DT(WAR.Person[j]["人物编号"], 50) and (WAR.Person[j]["人物编号"] == 0 or WAR.Person[j]["人物编号"] == 50) and WAR.LQZ[WAR.Person[j]["人物编号"]] ~= nil and WAR.LQZ[WAR.Person[j]["人物编号"]] == 100 then
						cc = cc * 2
					end
						WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd * (1+cc))
				end
			end
		 
			for j = 0, WAR.PersonNum - 1 do 
				if jiasu(WAR.Person[j]["人物编号"]) > 0 then
					if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[i]["我方"] then
						WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd * (1 + jiasu(WAR.Person[j]["人物编号"])));	
					end				
				end
			end
		  
			--敌人根据难度集气速度额外增加
			--nino: 伪主角模式队友不加集气
			if not inteam(id) then
				if JY.Thing[202][WZ7] == 1 then
					WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd * 0.9)
				elseif JY.Thing[202][WZ7] > 2 then
					WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd * 1.1)
				end
			end	  
		  
			local jp = math.modf(JY.Person[id]["实战"] / 20) --实战加集气速度--1-28-
			WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd * (1 + (jp * 0.02)))  --1-28-

			WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd * (0.7+WAR.SPIRIT[id] * 0.003))--1-28-
		  
			if MPPD(id) == 2 then --打狗棍阵
				local dgbz = 0
				for j = 0, WAR.PersonNum - 1 do
					local tmppid = WAR.Person[j]["人物编号"]
					if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[i]["我方"] and MPPD(tmppid) == 2 and tmppid ~= id then
						dgbz = dgbz + 2
					end
				end
				if dgbz > 10 then
					dgbz = 10
				end
					WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd * (1 + (dgbz * 0.01)))
			end
		
			if hasTF(id, 89) or MPPD(id) == 12 then WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd + 0.5 * getnewmove(WAR.Person[i]["轻功"], inteam(id))) end
		  
			if MPPD(id) == 1 then --星宿中毒越高速度越快
				local mpdj=MPDJ(id)
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + math.modf(JY.Person[id]["中毒程度"] / 10 * mpdj)
			end
		  
			if MPPD(id) == 8 and PersonGT(id,95) then --白驼中毒期间速度增快
				local mpdj = MPDJ(id)
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + math.modf(JY.Person[id]["中毒程度"] / 10 * mpdj)
			end
		  
			if hasTF(id, 20) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + math.modf(JY.Person[id]["中毒程度"] / 10)
			end
		  
			if id == 0 and putong() == 8 then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + math.modf(JY.Person[id]["中毒程度"] / 10)
			end
			  
			WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + qingshen(id)
		  
			--田伯光 万里独行 人越少集气越快
			if DT(id, 29) then
				local tmp = 16
				--WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 20
				for j = 0, WAR.PersonNum - 1 do
					if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[i]["我方"] then
						if GetS(86,10,12,5) ~= 0 then		--田伯光剧情过后，集气值减少
							tmp = tmp - 1
						else
							tmp = tmp - 1.5
						end
					end		
				end
				if tmp < 0 then tmp = 0 end	
					WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd + tmp)
				
				if WAR.L_TBGZL == 2 then	--戒色指令提高集气速度
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 5
				end
			end   

			--12-29-一人一竹 横扫千军
			if DT(id, 614) then
				local tmp = 0
				--WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 20
				for j = 0, WAR.PersonNum - 1 do
					if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] then
						tmp = tmp + 1
					end		
				end
				WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd + tmp*2)
			end
			
			if putong() == 12 and id == 0 then --武骧金星：八部斗策集气速度提升
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + math.min(16, 2 * WAR.DOUCE)
			end
		  
			if DT(id,50) then  --沼跃鱼：萧峰天将底力加速
				local aa=math.modf((JY.Person[id]["生命最大值"]-JY.Person[id]["生命"] )/30)
				if aa >= 25 then
					aa=25
				end
				if WAR.LQZ[id] ~= nil and WAR.LQZ[id]==100 then
					aa=math.modf(aa*1.5)
				end
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd +aa
			end
		 
			if wglw1(id,58) and WAR.LQZ[id] ~= nil and WAR.LQZ[id] == 100 then
				local aa = math.modf((JY.Person[id]["生命最大值"]-JY.Person[id]["生命"]) / 30)
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + math.min(40, aa)
			end
		 
			if T13TQS(id) and juexing() > 2 then  --沼跃鱼：滕青山兽血沸腾加速
				local aa=WAR.SWFY+WAR.SWHH
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd +aa+1
			end

			if T9ZY(id) and juexing() > 0 then  --沼跃鱼：滕青山兽血沸腾加速
				local aa = WAR.ZYSP * 5
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + aa + 1
			end
	 
			if wssz(id) and WAR.LQZ[id] ~= nil and WAR.LQZ[id] == 100 then  --沼跃鱼：滕文婷兽血沸腾加速
				local aa = WAR.SWFY1 + WAR.SWHH1
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + aa + 1
			end
		 
			if id == 0 and putong() == 11 then
				if WAR.PLJZ["集气速度"] ~= nil then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + WAR.PLJZ["集气速度"]
				end
			end

			--brolycjw: 独孤求败，额外集气速度
			if DT(id, 592) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 10 + WAR.L_DGQB_X*2
			end
			--萧雨客额外集气速度
			if T3XYK(id) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + WAR.XYKS 
			end
			--聂风额外集气速度
			if NF(id) and juexing() > 0 then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 20 
			end	
			if DT(id,48) and JX(id) and WAR.ICE[id] ~= nil then--游坦之觉醒并有冰封时额外加集气速度
				local aa=math.modf(WAR.ICE[id] / 5)
				if aa < 5 then aa = 5 end
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + aa
			end	
			--白龙剑
			if JY.Person[id]["武器"] == 39 then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 12
			end	 
			--凝碧剑
			if JY.Person[id]["武器"] == 41 then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 15
			end	 
			--白虹剑
			if JY.Person[id]["武器"] == 42 then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 20
			end		
			--绣花针
			if JY.Person[id]["武器"] == 298 then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 30
			end	
			--金铃索带
			if JY.Person[id]["武器"] == 310 then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 35
			end
			--步惊云额外集气速度
			if BJY(id) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 10 
			end	
			--段思平额外集气速度
			if DT(id,602) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 15 
			end	
			if wglw(id,181) or (PersonGT(id, 181) and (DT(id, 600))) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 25
			end
			--九剑领悟额外集气速度
			if wglw1(id,47) or (PersonKF(id, 47) and (DT(id, 592))) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 20
			end
			--神照经领悟额外集气速度
			if wglw(id,94) or (DT(id,632) and PersonGT(id,94)) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 15
			end
			--葵花领悟后额外集气速度
			if (wglw(id,105) and PersonGT(id, 105)) or (PersonGT(id, 105) and (DT(id, 455))) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 20
			end
			--葵花神针领悟额外集气速度
			if DT(id, 27) or wglw1(id,177) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 25
			end
			--罗汉伏魔功额外集气速度
			if (wglw(id,96) or (id == 400 and JY.Person[id]["姓名"] == "慧聪") or DT(id,38) or DT(id,615)) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 10
			end
			--峨嵋九阳
			if wglw(id,186) and PersonGT(id,186) then 
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 15
			end	
			if wglw(id,188) or (DT(id,48) and PersonGT(id,188)) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 20
			end	
			--豸苗：魔音・碧海潮声
			if wglw(id,6) or DT(id,57) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + WAR.BHZC*2
			end		  
			--豸苗：独孤精髓
			if wglw(id,592) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 10 + WAR.L_DG_X*2
			end	  
			--豸苗: 谢云流，额外集气速度
			if XYL(id) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 10
			end
			if jtyl(id) then --谢无悠
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 20
			end
			--豸苗: 森九岚，额外集气速度
			if SJL(id) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 5
			end    	 
			if DT(id,662) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 15
			end    	 			
				
			if MPPD(id) == 9 then --唐门模式
				if WAR.TMMS[id] == 1 and WAR.TMMS[200+id] ~= nil and WAR.TMMS[200+id] > 0 then 
					WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd * (1 + WAR.TMMS[200 + id] * 0.25))
				end
			end
			--其徐如林集气加成
			if WAR.FLHS2 > 60 then
				if wglw1(id,31) and id == 0 then
		  
			else
					WAR.FLHS2 = 60
				end
			end
			--其徐如林
			if id == 0 then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + WAR.FLHS2
			end
			if hasTF(id, 153) then
				if WAR.Person[i].TimeAdd >= 30 then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 30
				end 
			end			
			if WAR.XYYF[id] ~= nil then
				if WAR.XYYF[id] > 20 then
					WAR.XYYF[id] = 20
				end
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + WAR.XYYF[id]
			end
			--昆仑门人 集气速度额外加成
			if MPPD(id) == 19 and PersonGT(id,204) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + limitX((math.modf(sixi(id,2))/50),0,10)
			end	
			
			--崆峒弟子 集气速度额外加成
			if MPPD(id) == 18 then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 12   
			end	
			--崆峒三老 集气速度额外加成
			if DT(id, 8) or DT(id, 166) or DT(id, 167) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 35   
			end 
			--金轮法王  集气速度额外加成
			if DT(id, 62) or DT(id , 594)	then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 20
			end 		
			--血刀老祖 集气速度额外加成
			if DT(id, 97) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + WAR.XDLZ
			end
			--峨眉额外集气速度
			if MPPD(id) == 17 or (GX(id) and JX(id)) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 15
			end	
			--周伯通螺旋拳意 集气速度额外加成
			if DT(id, 64) and JX(id) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + WAR.ZBT1*5
			end
			--太极神功集气速度额外加成
			if PersonGT(id,182) then 
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 8
			end	
			if (wglw(id, 107) and PersonGT(id,107)) or DT(id,599)  then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 25 * WAR.ZBT3
			end
		  
			--王重阳、一灯 重生前额外集气速度+5 真打加速
			if DT(id, 129) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + WAR.WCY * 5
				if WAR.WCY3 > 0 then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd +(8-WAR.WCY3)* 5
				end
			end
		  
			--王重阳、一灯 重生前额外集气速度+5
			if DT(id , 65) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + WAR.WCY1 * 5
			end
			
			--豸苗：先天重生
			if wglw(id,100) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + WAR.WCY2 * 5
			end
		  
			--瑜伽密乘
			if wglw(id,184) and PersonGT(id,184) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd * 2
			end	
		
			if (wglw(id,107) and PersonGT(id,107)) or DT(id,599) then --九阴领悟：蛇行狸翻
				local aa = math.modf(JY.Person[id]["轻功"] / 40)
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + aa
			end
		  
			if DT(id,601) then --林朝英集气速度
				local aa = math.modf(JY.Person[id]["轻功"] / 40)
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + aa
			end

			if (wglw(id,94) and PersonGT(id,94)) or DT(id,632) then	
				local aa = math.modf(JY.Person[id]["轻功"] / 10)
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + aa
			end
		
			if DT(id,600) then 
				local a1 = math.modf(JY.Person[id]["轻功"]/20)
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + a1
			end	
		
			if DT(id,153) and JX(id) then --赵半山觉醒后集气速度
				local aa = math.modf(JY.Person[id]["暗器技巧"]/40)
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + aa
			end	
		  
			--真田幸村
			if DT(id, 553) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + WAR.YZB2 * 4
			end
			  
			if DT(id, 629) then --阿九集气加成怒气/10
				if WAR.LQZ[id] ~= nil and WAR.LQZ[id] > 0 then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + math.modf(WAR.LQZ[id] * 0.1)
				end
			end
			  
			--蓝烟清：brolycjw杨过黯然神伤特效 集气速度加成
			--每多10点内伤集气速度增加5
			if DT(id, 58) and JY.Person[58]["受伤程度"] > 50 and GetS(86,11,11,5) == 2 then
				--平滑设置计算新的加成，比如内伤为55时，增加2点集气速度
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + math.floor(JY.Person[58]["受伤程度"] - 50) / 2;
			end
		   
			if MPPD(id) == 10 then   
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + MPDJ(id) * 2
			end
		  
			if getHZ(id, 1) then   --乘云令
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 5
			end	  
			  
			--宋青书 有女的+集气
			if id == 82 then
				local s = 0
				for j = 0, WAR.PersonNum - 1 do
					if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] and JY.Person[WAR.Person[j]["人物编号"]]["性别"] == 1 then
						s = s + 1
					end
				end
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + s
			end
			
			if DT1(id,82) then
				local s = 0
				for j = 1, CC.TeamNum do
					if JY.Base["队伍"..j] == -1 then
						break  	
					end
					if JY.Person[JY.Base["队伍"..j]]["性别"] == 1 then
						s = s + 1
					end
				end
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + s
			end
		  
			if DT3(id, 37) then --狄云指令集气速度+10
				if WAR.DYWY[id] == 1 then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 10
				end
			end

			--郭靖，我方每死亡一个人，集气速度+1
			if id == 55 then
				local xz = 0
				for j = 0, WAR.PersonNum - 1 do
					if WAR.Person[j]["死亡"] == true and WAR.Person[j]["我方"] == WAR.Person[i]["我方"] then
						WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 1
					end
				end
			end
			if DT1(id, 55) then
				local xz = 0
				for j = 0, WAR.PersonNum - 1 do
					if WAR.Person[j]["死亡"] == true then
						WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 1
					end
				end
			end
		  
			if MPPD(id) == 13 then --沼跃鱼：明教圣火阵
				local shz = 0
				local xg = MPDJ(id)
				for j = 0, WAR.PersonNum - 1 do
					if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[i]["我方"] then
						shz = shz + 1
					end
				end
				if shz > 8 then
					shz = 8
				end		
				if shz >= 2 then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + shz * xg
				end
			end
		 
			--洪安通己方每多一人集气速度+0.5
			if DT(id, 71) or DT(id, 596) then
				local xz = 0
				for j = 0, WAR.PersonNum - 1 do
					if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[i]["我方"] then
						WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 0.5
					end
				end
				WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd)
			end
		  
			if DT(id, 135) then
				local xz = 0
				for j = 0, WAR.PersonNum - 1 do
					if WAR.Person[j]["死亡"] == false and WAR.Person[j]["人物编号"] ~= id then
						WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 0.5
					end
				end
				WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd)
			end

			--圣火三使，同时在场时，每人集气速度额外+20点
			if (WAR.ZDDH == 14 or WAR.ZDDH == 360) and (id == 173 or id == 174 or id == 175) then
				local shz = 0
				for j = 0, WAR.PersonNum - 1 do
					if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[i]["我方"] then
						shz = shz + 1
					end
				end
				if shz == 3 then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 20
				end
			end

			--天机盘龙阵
			if WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 and GetS(86, 2, 9, 5) == 3 and (id == 5 or id == 27 or id == 50 or id == 64 or id == 114 or id == 129 or id == 140 or id == 558 or id == 599 or id == 601 or id == 602 or id == 615 or id == 618)then
				local ssdf = 0
				for j = 1,WAR.PersonNum -1 do
					if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] then
						ssdf = ssdf + 1
					end
				end
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + ssdf * 2
			end  
			--宗师阵
			if WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 and GetS(86, 2, 11, 5) == 3 and (id == 5 or id == 50 or id == 64 or id == 129 or id == 558 or id == 599 or id == 601)then
				local ssdf = 0
				for j = 1,WAR.PersonNum-1 do
					if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] then
						ssdf = ssdf + 1
					end
				end
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + ssdf * 2
			end
			--四神封绝
			if WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 and GetS(86, 2, 12, 5) == 3 and (id == 5 or id == 27 or id == 50 or id == 114)then
				local ssdf = 0
				for j = 1,WAR.PersonNum-1 do
					if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] then
						ssdf = ssdf + 1
					end
				end
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + ssdf * 2
			end
			--天龙传说
			if WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 and GetS(86, 2, 14, 5) == 3 and (id == 602 or id == 615 or id == 618)then
				local ssdf = 0
				for j = 1,WAR.PersonNum-1 do
					if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] then
						ssdf = ssdf + 1
					end
				end
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + ssdf * 2
			end
			
			--豸苗：18铜人
			if WAR.ZDDH == 217 then
				local sbtr = 0
				for j = 0, WAR.PersonNum - 1 do
					if WAR.Person[j]["我方"] == false and WAR.Person[j]["死亡"] == false then
						sbtr = sbtr + 1
					end
				end
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + math.modf(sbtr * 0.5)
			end
			
			--蓝烟清：天罡北斗阵
			if WAR.ZDDH == 73 and WAR.Person[i]["我方"] == false then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 5
			end
			
			--平一指，集气速度额外加成3*杀人数
			if DT(id, 28) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + WAR.PYZ * 3
			end

			if id == 0 and putong() == 10 and WAR.LKZX ~= 0 then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + WAR.LKZX
			end
		  
			if DT(id, 78) then --梅超风练九阴集气+5 id == 78
				if PersonKF(id, 107) then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 5
				end
			end

			--蓝烟清：brolycjw 杨过死后，小龙女与主角同时在场时，增加集气速度
			if DT(id , 59) and GetS(86,11,11,5) == 1 then
				for j = 0, WAR.PersonNum - 1 do
					if WAR.Person[j]["人物编号"] == 0 and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then

						local value = (JY.Person[0]["实战"] + JY.Person[59]["实战"])/2000;	--(小龙女实战 + 主角实战) / 2000			
						WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + math.floor(value*20);	--小龙女集气速度增加
						WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd + math.floor(value*20);	--主角集气速度增加
						WAR.JQSDXS[WAR.Person[j]["人物编号"]] = WAR.Person[j].TimeAdd
						WAR.JQSDXS[WAR.Person[i]["人物编号"]] = WAR.Person[i].TimeAdd		
						break;
					end
				end
			end		  
		  
			--MM给主角加集气速度
			if not T8LXY(0) then
				if id == 0 and WAR.LRZ == 1 then
					for j = 0, WAR.PersonNum - 1 do
						if WAR.Person[j]["人物编号"] == 92 and WAR.Person[j]["死亡"] == false and
							WAR.Person[j]["我方"] == WAR.Person[i]["我方"] then
							WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 5 + WAR.MMSY
							break;
						end
					end
				end
			end
			
			if DT1(id, 92) and not T8LXY(0) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 5 + WAR.MMSY
			end
		  
			if not T8LXY(0) then
				if DT(id, 92) then --id == 92
					for j = 0, WAR.PersonNum - 1 do
						if WAR.Person[j]["人物编号"] == 0 and WAR.Person[j]["死亡"] == false then
							WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 5 + WAR.MMSY --主角在场mm也加速度				
							break;
						end
					end	  
				end
			end		  
			  
			--蓝烟清：装备白马 集气速度+5点，李文秀装备白马额外+30点
			if inteam(id) and JY.Person[id]["无用15"] == 230 then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 30;
				if DT(id, 590) or DT(id, 132) then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 30;
				end
			end
			  
			if inteam(id) and JY.Person[id]["无用15"] == 248 then --白雕+20点
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 20;
			end

			if inteam(id) and JY.Person[id]["武器"] == 41 then --凝碧剑+1点集气速度
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 1;
			end       
			  
			--主功体加集气
			if PersonKF(id, 6) then --碧海潮声功加集气速度
				if PersonGT(id, 6) then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 2;
				else
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 1;
				end
			end	        

			if PersonKF(id, 93) then --圣火加集气速度
				if PersonGT(id, 93) then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 3;
				else
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 1;
				end
			end

			if PersonKF(id, 94) then --神照功加集气速度
				if PersonGT(id, 94) then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 1;
				else
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 1;
				end
			end 

			if PersonKF(id, 95) then --蛤蟆功加集气速度
				if PersonGT(id, 95) then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 1;
				else
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 1;
				end
			end 

			if PersonKF(id, 96) then --罗汉伏魔功加集气速度
				if PersonGT(id, 95) then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 1;
				else
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 1;
				end
			end 

			if PersonKF(id, 98) then --小无相功加集气速度
				if PersonGT(id, 98) then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 3;
				else
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 1;
				end
			end	

			if PersonKF(id, 100) then --先天功加集气速度
				if PersonGT(id, 100) then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 1;
				else
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 1;
				end
			end 

			if PersonKF(id, 101) then --八荒六合功加集气速度
				if PersonGT(id, 101) then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 3;
				else
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 1;
				end
			end

			if PersonKF(id, 102) then --太玄加集气速度
				if PersonGT(id, 102) then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 4;
				else
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 2;
				end
			end	
		  
			if PersonKF(id, 105) then --葵花神功加集气速度
				if PersonGT(id, 105) then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 8;
				else
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 3;
				end
			end
					  
			if PersonKF(id, 121) then --玉女加集气速度
				if PersonGT(id, 121) then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 5;
				else
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 2;
				end
			end	

			if PersonKF(id, 124) then --寒冰真气加集气速度
				if PersonGT(id, 124) then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 2;
				else
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 1;
				end
			end

			if PersonGT(id, 150) then --金关玉锁诀加集气
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 2
			elseif PersonKF(id, 150) then 
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 1;
			end
			
			if PersonGT(id,189) then --阴阳磨主功体加集气
				if JY.Person[id]["内力性质"] ~= 2 then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 5
				end
			elseif PersonKF(id,189) then
				if JY.Person[id]["内力性质"] ~= 2 then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 3
				end
			end

			if PersonKF(id, 151) then --金刚不坏体加集气速度
				if PersonGT(id, 151) then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 1;
				else
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 1;
				end
			end 
		
			if PersonKF(id, 152) then --天南益阳诀加集气速度
				if PersonGT(id, 152) then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 2;
				else
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 1;
				end
			end

			if PersonKF(id, 153) then --临济十二庄加集气速度
				if PersonGT(id, 153) then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 2;
				else
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 1;
				end
			end

			if PersonKF(id, 178) then --擒龙功加集气速度
				if PersonGT(id, 178) then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 1;
				else
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 1;
				end
			end 
		  
			if PersonKF(id, 185) then  --武当九阳功
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 1;	
				if PersonGT(id, 185) then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 3;	
				end
			end	
		
			if PersonKF(id, 107) and PersonGT(id, 104) then --有九阴时逆运主功体速度+2
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 2;
			end
		  
			--轻功速度加5
			--[[
			if PersonKF(id,115) or PersonKF(id,116) or PersonKF(id,117) or PersonKF(id,143) or PersonKF(id,179) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 5;
			end
			if PersonKF(id,190) or PersonKF(id,191) or PersonKF(id,192) or PersonKF(id,193) or PersonKF(id,194) or PersonKF(id,195) or PersonKF(id,196)
				or PersonKF(id,197) or PersonKF(id,198) or PersonKF(id,199) or PersonKF(id,200) or PersonKF(id,205) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 5
			end
			]]
			
			for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
				if yongqing(JY.Person[id]["武功"..i]) then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 5
					break
				end
			end
			
			--天赋轻功
			for k,v in ipairs(CC.TFQG) do
				if ((v[1] == id) or (v[1] == cxzj() and id == 0)) and PersonKF(id,v[2]) then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + v[3]*5
					break
				end
			end
			
			--天赋轻功
			if id == 0 and (putong() > 0 or teshu() > 0) and PersonKF(id,GetS(112,3,0,0)) then
			   WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 5			
			end
			
			if id == 92 and PersonKF(id,JY.Person[578]["轻功"]) then 
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 5			
			end
			
			if PersonKF(id,119) then --天罗地网+5
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 5;
			end	  
		  
			if MPPD(id)==16 then --天罗地网+5
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + math.modf(JY.Person[id]["内力"] / 800 * MPDJ(id));
			end
		  
			if PersonKF(id,118) then --瞬息千里+5 减轻内伤对集气负效果
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 5;
				if JY.Person[id]["受伤程度"] >= 10 then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + math.modf(JY.Person[id]["受伤程度"] / 10) 
				end
				if wglw2(id,118) or DT(id,617) then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + math.modf(JY.Person[id]["受伤程度"] / 5) 
				end	
			end
			
			if hasTF(id, 19) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + math.modf(JY.Person[id]["受伤程度"] / 10)
			end
		  
			if id == 0 and putong() == 9 and WAR.LXZT[0] ~= nil then --血海飘零加集气
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + math.modf(WAR.LXZT[0]/15)
			end
				
			if WAR.ZDDH == 128 and inteam(id) == false and not DT(id, 553) and JY.Thing[202][WZ7] > 1 then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 10
			end
		  
			if WAR.QFY1[id] ~= nil and WAR.QFY1[id] > 0 then --飞燕凌波 50时序内速度+5
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 5;
			end	  
		  
			if MPPD(id) == 11 and MPDJ(id) > 2 then 
				WAR.YDSD[id] = WAR.Person[i].TimeAdd
			end	 
	-------------------------------------------------------------------	
			for j = 0, WAR.PersonNum - 1 do --遁甲符
				if getHZ(WAR.Person[j]["人物编号"], 25) then
					if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] then
						WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd * 0.9);	
					end
					break
				end
			end	  
			
			for j = 0, WAR.PersonNum - 1 do 
				if hasTF(WAR.Person[j]["人物编号"], 74) then
					if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] then
						WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd * 0.9)	
					end
				end
			end
			
			 --豸苗：谢烟客控鹤功
			if WAR.KHG[id] ~= nil then
				WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd * 0.5) 
			end   
			
			--豸苗：欧阳锋蛇毒
			if WAR.OYFSD[id] ~= nil then
				WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd*0.8)
			end 
			
			--金关领悟 杀意波动
			local id = WAR.Person[i]["人物编号"]
				for j = 0, WAR.PersonNum-1 do 
				local df = WAR.Person[j]["人物编号"] 			
				local offset1 = math.abs(WAR.Person[i]["坐标X"] - WAR.Person[j]["坐标X"]) 
				local offset2 = math.abs(WAR.Person[i]["坐标Y"] - WAR.Person[j]["坐标Y"])
				local offset=offset1+offset2
				if (wglw(df,150) and PersonGT(df, 150))  or (DT(df,619) and PersonKF(df, 150) and JX(df))  then
							
				if WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false  then
					local xn = math.modf((JY.Person[df]["内力"])/250)
					if xn <= 20 then
						xn = 20
					end
					if offset <= 10 then
						xn = math.modf(xn * (1 + (10 - offset) / 10))
					end
					if WAR.SPIRIT[df] >= 120 then
						xn = math.modf(xn*(1 + (WAR.SPIRIT[df] -120) / 100))
					end
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd - xn
					if WAR.Person[i].TimeAdd <= 3 then
						WAR.Person[i].TimeAdd=3
					end
				end
				end	
			end
			
			local id = WAR.Person[i]["人物编号"]--辟邪 极阳妖力
				for j = 0, WAR.PersonNum-1 do 
				local df = WAR.Person[j]["人物编号"] 			
				local offset1 = math.abs(WAR.Person[i]["坐标X"] - WAR.Person[j]["坐标X"]) 
				local offset2 = math.abs(WAR.Person[i]["坐标Y"] - WAR.Person[j]["坐标Y"])
				local offset=offset1+offset2
				if wglw1(df,48) or (DT(df,36) and PersonKF(df, 48) and JX(df))  then		
					if WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false  then
						local xn = math.modf((JY.Person[df]["内力"])/300)
						if xn <= 20 then
							xn = 20
						end
						if offset <= 10 then
							xn = math.modf(xn * (1 + (10 - offset) / 10))
						end
						if WAR.SPIRIT[df] >= 120 then
							xn = math.modf(xn*(1 + (WAR.SPIRIT[df] -120) / 100))
						end
						WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd - xn
						if WAR.Person[i].TimeAdd <= 5 then
							WAR.Person[i].TimeAdd = 5
						end
					end
				end	
			end
			
			local id = WAR.Person[i]["人物编号"] --天佛气场
			for j = 0, WAR.PersonNum-1 do 
				local df = WAR.Person[j]["人物编号"] 			
				local offset1 = math.abs(WAR.Person[i]["坐标X"] - WAR.Person[j]["坐标X"]) 
				local offset2 = math.abs(WAR.Person[i]["坐标Y"] - WAR.Person[j]["坐标Y"])
				local offset=offset1+offset2
				if ((MPPD(df)==5 and PersonGT(df, 108)) and MPDJ(df)>1) or DT(df,615) or WAR.YJZQ[df] ~= nil then
					local mpdj=MPDJ(df)*3 			
					if WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false and (offset1<=mpdj and offset2<=mpdj) then
						local xn = math.modf((JY.Person[df]["内力"] - JY.Person[id]["内力"]) / 200)
						if xn <= 10 then
							xn = 10
						end
						if offset <= 10 then
							xn = math.modf( xn * ( 1 + (10 - offset) / 10))
						end
						if xn >= 40 then
							xn = 40
						end
						if DT(df,615) then
							xn = 40
						end
						WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd * (1-0.015 * xn))
					end
				end	
			end	 
			  
			for j = 0, WAR.PersonNum - 1 do --沼跃鱼：萧峰帝释天威效果--敌方减速
				if DT(WAR.Person[j]["人物编号"], 50) and (WAR.Person[j]["人物编号"]==0 or WAR.Person[j]["人物编号"]==50) and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] then
					local aa = WAR.Person[j]["人物编号"]
					local bb = WAR.SPIRIT[aa]
					local cc = (math.max(bb,100) - 100) / 250
					if cc > 0.25 then
						cc = 0.25
					end
					if DT(WAR.Person[j]["人物编号"], 50) and (WAR.Person[j]["人物编号"] == 0 or WAR.Person[j]["人物编号"] == 50) and WAR.LQZ[WAR.Person[j]["人物编号"]] ~= nil and WAR.LQZ[WAR.Person[j]["人物编号"]] == 100 then
						cc = cc * 2
					end
					WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd * ( 1 - cc))
				end
			end

			--寒冰真气
			for j = 0, WAR.PersonNum - 1 do
				if WAR.Person[j]["人物编号"]==0 and WAR.BFQL[WAR.Person[j]["人物编号"]] == 1 and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] then
					WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd * 0.7)
				end
			end	
			
			for j = 0, WAR.PersonNum - 1 do --豸苗：降龙伏虎
				if WAR.Person[j]["人物编号"] == 0 and WAR.XLFH[WAR.Person[j]["人物编号"]] ~= nil and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] then
					WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd * 0.7)
				end
			end	
			
			if WAR.WYWX[id] ~= nil then --17-3-1
				WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd * 0.7)
			end	 
			  
			if WAR.YRKG[id] ~= nil and WAR.YRKG[id] > 0 then --以柔克刚
				WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd * 0.5)
			end 	 
		  
			if WAR.SPDDOWN[id] ~= nil and WAR.SPDDOWN[id] > 0 then --速度减少
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd - 10;
			end
		  
		   --[[冰封30+减集气速度17-2-12--
			if WAR.ICE[id] ~= nil and WAR.ICE[id] >0 then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd - 5
				if WAR.ICE[id] > 20 then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd - 5
				end	
				if WAR.ICE[id] > 20 and WAR.HBZQ[id] ~= nil then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd - 5
				elseif WAR.ICE[id] > 30 and WAR.HBZQ[id] ~= nil then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd - 10 
				elseif WAR.ICE[id] > 40 and WAR.HBZQ[id] ~= nil then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd - 15
				end	
			end	]]  
		  
			--[[蓝烟清：被迟缓时，集气速度减半
			if WAR.CHZ[id] ~= nil and WAR.CHZ[id] > 0 and not (wglw(id,99) or DT(id,5)) then
				WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd * 0.5)
			end ]]
		  
			if WAR.QIZHEN[id] ~= nil and WAR.QIZHEN[id] == 1 then --黄蓉奇阵对象集气速度-5
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd - 5;
			end
			
			if WAR.ZDDH == 331 and WAR.Person[i]["我方"] == true then --五行八卦阵
				local num = 0
				for zz = 0, WAR.PersonNum - 1 do
					if WAR.Person[zz]["死亡"] == false and WAR.Person[zz]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
						num = num + 1
				   end
				end
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd - num
			end	  
			
			--玉女经
			for j = 0, WAR.PersonNum - 1 do
				if ((DT(WAR.Person[j]["人物编号"],59) and PersonKF(WAR.Person[j]["人物编号"],121)) or wglw(WAR.Person[j]["人物编号"],121) or (DT(WAR.Person[j]["人物编号"],601) )) and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.LQZ[WAR.Person[i]["人物编号"]]==100 then
					WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd *0.5)
				end
			end

			--剑神集气速度加成5%
			--东方未明剑法+5%集气
			--蓝烟清：连城剑法，也加成
			--if putong() == 2 and id == 0 then
				--local jsyx = wgnumber(0, 2)
				--WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd +5 * (jsyx)
			--end
		  
			if WAR.Person[i].TimeAdd < 5 then
				WAR.Person[i].TimeAdd = 5
			end
				
			if DT(id, 617) then --武骧金星：春风醉集气速度永远最大
				WAR.Person[i].TimeAdd = 100
			end
		
			if NF(id) and juexing() > 2 then --聂风3觉后集气速度
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd+math.modf((sixi(id,3) + sixi(id,4)) * 1.5)
			end	
		
			if BJY(id) and juexing() > 1 then --步惊云2觉集气速度
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd+math.modf((sixi(id,1) + sixi(id,2)) * 0.5)
			end   	
		
            if DT(id, 583) then --隼人天隐集气速度
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd+math.modf(sixi(id,1) * sixi(id,2) * sixi(id,3) * sixi(id,4) *  sixi(id,5))
			end			
		
			if DT(id, 600) then --武无敌集气速度
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd+math.modf(sixi(id,1) * sixi(id,2) * sixi(id,3) * sixi(id,4) *  sixi(id,5) * 10)
			end	
		
			if DT(id, 602) then --段思平集气速度
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd+math.modf(sixi(id,1) * sixi(id,2) * 6)
			end	
		
			if DT(id, 603) then --木灵子集气速度
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd+math.modf(sixi(id,1) * 7)
			end		
		
			if DT(id, 585) then --小二集气速度
			   WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 15
			end	
		
			if DT(id, 3) and JX(id) then --沼跃鱼：苗人凤集气速度
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd+math.modf(sixi(id,2) / 15)
			end
		  
			if J1ZBF(id) and JX(id) then --沼跃鱼：苗人凤集气速度
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd+math.modf(sixi(id,2) / 15)
			end
			
			--if D1GHYD(id) and 
			
			if DT(id,152) and JX(id) then --沼跃鱼：追魂剑集气速度
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd+math.modf(sixi(id,2) / 20)
			end
		  
			if wglw1(id,155) and WAR.Actup[id]~=nil then --沼跃鱼：追魂剑集气速度
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd * 2 + math.modf(sixi(id,1) / 30) + math.modf(sixi(id,3) / 30)
			end 
		  
			if T4WXS(id) then --沼跃鱼：王小石集气速度
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + math.modf((sixi(id,2)+sixi(id,3)) / 15)
			end
		  
			if DT(id, 621) and JX(id) then --沼跃鱼：胡一刀集气速度
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + math.modf(sixi(id,3) / 15)
			end	
		
			if wglw(id,182) or (DT(id,5) and PersonGT(id,182)) then --太极神功		
				WAR.JQSDXS[id] = math.modf(WAR.Person[i].TimeAdd * 3)
			else
				WAR.JQSDXS[id] = WAR.Person[i].TimeAdd * 2
			end	      
		
			if wglw1(id,47) or DT(id,592) then --独孤九剑
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 15
			end		
			
			if MPPD(id) == 11 and MPDJ(id) > 2 then 
				if putong() == 2 and id == 0 then 
					local jsyx = wgnumber(0, 2)
					WAR.Person[i].TimeAdd = WAR.YDSD[id] + 5 * (jsyx)
				else 
					WAR.Person[i].TimeAdd = WAR.YDSD[id]
				end
			end	 
			
			if WAR.Person[i].TimeAdd > 100 then
				WAR.Person[i].TimeAdd = 100
			end
			
			--木桩不集气
			if (id == 445 or id == 446) and WAR.ZDDH == 226 then
				WAR.Person[i].TimeAdd = 0
			end
			
			--冰封减集气
			if WAR.ICE[id] ~= nil and WAR.BPD[id] == nil and not (DT(id,48) and JX(id)) then
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd - 6
				if WAR.ICE[id] > 50 then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd - (WAR.ICE[id]) / 4
				end
				if WAR.Person[i].TimeAdd < 0 then
					WAR.Person[i].TimeAdd = 0
				end
			end		
			
			--冰魄毒减集气
			if WAR.BPD[id] ~= nil then
				local aa = WAR.Person[i].Time
				if WAR.Person[i].Time < 0 then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd - 0
				elseif 	WAR.Person[i].Time >= 0 then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd - (math.ceil(aa/33.3))
				end
				if WAR.Person[i].TimeAdd < 0 then
					WAR.Person[i].TimeAdd = 0
				end
			end	
			--昆仑门人云龙三折
			if PersonKF(id,205) then
				local aa = math.ceil(WAR.Person[i].Time/33.3)
				if aa > 5 then aa = 5 end
				if 	WAR.Person[i].Time >= 0 then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + aa
				else
					WAR.Person[i].TimeAdd = math.modf(WAR.Person[i].TimeAdd * 1.3)
				end
				if WAR.YLSZ[id] ~= nil then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + WAR.YLSZ[id]
				end	
			end	
			
			if WAR.WDWJJ[id] ~= nil then
				local aa = math.modf(WAR.WDWJJ[id]*2)
				if aa > 25 then aa = 25 end
				WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd - aa
			end	
			
			if WAR.FDLJ1[id] ~= nil or WAR.FDLJ2[id] ~= nil then
				if WAR.FDLJ2[id] > 0 then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd - 10
				end
				if WAR.FDLJ1[id] > 0 then
					WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd - 5
				end	
			end	
			
			if JY.ZJSL == 1 and not inteam(id) and WAR.Person[i]["我方"] == false then
				WAR.Person[i].TimeAdd = 0
			end   
			  
			if wglw2(id,193) and PersonKF(id,193) then--扫叶腿锁集气下限
				if WAR.Person[i].TimeAdd < 30 then
					WAR.Person[i].TimeAdd = 30
				end
			end	
			  
			WAR.JQSDXS[id] = WAR.Person[i].TimeAdd
		  
			if WAR.LQZ[id] == 100 then
				--if DT(id, 112) then --萧远山怒气速度+200%
					--WAR.JQSDXS[id] = math.modf(WAR.Person[i].TimeAdd * 3)
			--else
				if wglw(id,178) or ((DT(id,69) or DT(id,50)) and PersonKF(id,178)) or T9ZY(id) or DT(id,602) then --九龙功
					WAR.JQSDXS[id] = math.modf(WAR.Person[i].TimeAdd * 3)
				else
					WAR.JQSDXS[id] = WAR.Person[i].TimeAdd * 2
				end
			--end
			end
			  
			num = num + 1
			total = total + WAR.Person[i].TimeAdd
		end
    end
  
    --蓝烟清：水笙在场，敌方集气速度减3点
    for i = 0, WAR.PersonNum - 1 do
        local jiqiid = WAR.Person[i]["人物编号"] 
		if DT(WAR.Person[i]["人物编号"] , 589) and WAR.Person[i]["死亡"] == false then --and WAR.Person[i]["我方"] then
    	    for j = 0, WAR.PersonNum - 1 do
    		    if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] then
    			    WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - 3;
    			    if WAR.Person[j].TimeAdd < 0 then		--开始集气不可以有负数出来，主要是木桩集气小于3的
    				    WAR.Person[j].TimeAdd = 0;
    			    end
    			    WAR.JQSDXS[WAR.Person[j]["人物编号"]] = WAR.Person[j].TimeAdd;		--重新显示集气值
    		    end
    	    end
    	    break;
        end
		
		if DT(WAR.Person[i]["人物编号"] , 56) and WAR.Person[i]["死亡"] == false then --and WAR.Person[i]["我方"] then 武骧金星：黄蓉减速
			local renshu = 0
			for j = 0, WAR.PersonNum - 1 do
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] then
					renshu = renshu + 1
				end
			end
			renshu = math.modf(renshu * 0.5)
					
			for j = 0, WAR.PersonNum - 1 do
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] then		
					WAR.Person[j].TimeAdd = WAR.Person[j].TimeAdd - renshu;
					if WAR.Person[j].TimeAdd < 0 then		--开始集气不可以有负数出来，主要是木桩集气小于3的
						WAR.Person[j].TimeAdd = 0;
					end
					
					WAR.JQSDXS[WAR.Person[j]["人物编号"]] = WAR.Person[j].TimeAdd;		--重新显示集气值
				end
			end
			break;
		end	
	
	--豸苗：浮光掠影
		if hasTF(WAR.Person[i]["人物编号"],140) then
			local fgly = WAR.Person[i].TimeAdd
			for j = 0,WAR.PersonNum-1 do
				if WAR.Person[j]["死亡"]==false then                            			   			                   
					if WAR.Person[j].TimeAdd>fgly then
						fgly=WAR.Person[j].TimeAdd
						WAR.Person[i].TimeAdd=fgly
					 end
				end
			end
			if WAR.LQZ[WAR.Person[i]["人物编号"]] == 100 then
				WAR.JQSDXS[WAR.Person[i]["人物编号"]] = fgly * 2
			else
				WAR.JQSDXS[WAR.Person[i]["人物编号"]] = fgly
			end
		end
		if PersonKF(WAR.Person[i]["人物编号"],190) then --流云逐月
			local lyzy = WAR.Person[i].TimeAdd
			if wglw2(jiqiid,190) then
				if lyzy < 150 then
					lyzy = lyzy + 30
				end	
			end	
			for j = 0,WAR.PersonNum-1 do
				if WAR.Person[j]["死亡"]==false then                            			   			                   
					if WAR.Person[j].TimeAdd>=lyzy then
						lyzy=lyzy + 15
					 end
				end
			end
			if WAR.LQZ[WAR.Person[i]["人物编号"]] == 100 then
				WAR.JQSDXS[WAR.Person[i]["人物编号"]] = lyzy * 2
			else
				WAR.JQSDXS[WAR.Person[i]["人物编号"]] = lyzy
			end
			WAR.Person[i].TimeAdd=lyzy
		end
    end
  
    WAR.JQSD_WMM = 0
  
    for i = 0, WAR.PersonNum - 1 do
        local p = WAR.Person[i]["人物编号"]
        if DT(p , 76) and inteam(p) and WAR.Person[i]["死亡"] == false then
            WAR.JQSD_WMM = 1
        end
    end
  
    WAR.LifeNum = num
    return math.modf(1.2 * ((total) / (num) + (num) - 2))
end

--武功范围选择
War_KfMove = function(movefanwei, atkfanwei)
    local kind = movefanwei[1] or 0
    local len = movefanwei[2] or 0
    local x0 = WAR.Person[WAR.CurID]["坐标X"]
    local y0 = WAR.Person[WAR.CurID]["坐标Y"]
    local x = x0
    local y = y0
    if kind ~= nil then
    if kind == 0 then
      War_CalMoveStep(WAR.CurID, len, 1)
	  elseif kind == 1 then
	    War_CalMoveStep(WAR.CurID, len * 2, 1)
	    for r = 1, len * 2 do
	      for i = 0, r do
	        local j = r - i
	        if len < i or len < j then
	          SetWarMap(x0 + i, y0 + j, 3, 255)
	          SetWarMap(x0 + i, y0 - j, 3, 255)
	          SetWarMap(x0 - i, y0 + j, 3, 255)
	          SetWarMap(x0 - i, y0 - j, 3, 255)
	        end
	      end
	    end
	  elseif kind == 2 then
	    War_CalMoveStep(WAR.CurID, len, 1)
	    for i = 1, len - 1 do
	      for j = 1, len - 1 do
	        SetWarMap(x0 + i, y0 + j, 3, 255)
	        SetWarMap(x0 - i, y0 + j, 3, 255)
	        SetWarMap(x0 + i, y0 - j, 3, 255)
	        SetWarMap(x0 - i, y0 - j, 3, 255)
	      end
	    end
	  elseif kind == 3 then
	    War_CalMoveStep(WAR.CurID, 2, 1)
	    SetWarMap(x0 + 2, y0, 3, 255)
	    SetWarMap(x0 - 2, y0, 3, 255)
	    SetWarMap(x0, y0 + 2, 3, 255)
	    SetWarMap(x0, y0 - 2, 3, 255)
	  else
	    War_CalMoveStep(WAR.CurID, 0, 1)
	  end
    end
  
    local  function between(num_1, num_2, num_3, flag)
    if not flag then
      flag = 0
    end
    if num_3 < num_2 then
      num_2, num_3 = num_3, num_2
    end
    if flag == 0 and num_2 < num_1 and num_1 < num_3 then
      return true
    elseif flag == 1 and num_2 <= num_1 and num_1 <= num_3 then
      return true
    else
      return false
    end
    end
  
    while true do
    local x2 = x
    local y2 = y
    WarDrawMap(1, x, y)
    WarDrawAtt(x, y, atkfanwei, 1)

	local x0, y0 = WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"]
	for i = 0, WAR.PersonNum - 1 do
		if WAR.Person[WAR.CurID]["我方"] == WAR.Person[i]["我方"] and i ~= WAR.CurID and WAR.Person[i]["死亡"] == false and WAR.SQFJ ~= 1 then
			local nx = WAR.Person[i]["坐标X"]
			local ny = WAR.Person[i]["坐标Y"]
			local fid = WAR.Person[i]["人物编号"]
			local love
			if (DT(WAR.Person[WAR.CurID]["人物编号"], 455) and fid == 597) or (WAR.Person[WAR.CurID]["人物编号"] == 597 and DT(fid, 455)) then
				love = 1
			end   
			if love == 1 then
				if math.abs(nx-x0)+math.abs(ny-y0)<9 then
					local flagx, flagy = 0, 0
					if math.abs(nx - x0) <= 1 then
						flagx = 1
					end
					if math.abs(ny - y0) <= 1 then
						flagy = 1
					end
					if x0 == nx then
						flagy = 1
					end
					if y0 == ny then
						flagx = 1
					end
					if between(x, x0, nx, flagx) and between(y, y0, ny, flagy) then
						local dx = nx - x0
						local dy = ny - y0
						local size = CC.FontSmall;
						local rx = CC.XScale * (dx - dy) + CC.ScreenW / 2
						local ry = CC.YScale * (dx + dy) + CC.ScreenH / 2
							
						local hb = GetS(JY.SubScene, dx + x0, dy + y0, 4)
								
						DrawString(rx - size, ry-hb-size/2, "合击", M_Red, size);
						WAR.Person[i]["人方向"] = 3 - War_Direct(x0, y0, x, y)
					end
				end
			end
		end
	end
	
    WarShowHead(GetWarMap(x, y, 2))
    ShowScreen()

    local key = WaitKey(1)

    if key == VK_UP then
      y2 = y - 1
    elseif key == VK_DOWN then
      y2 = y + 1
    elseif key == VK_LEFT then
      x2 = x - 1
    elseif key == VK_RIGHT then
      x2 = x + 1
    elseif (key == VK_SPACE or key == VK_RETURN) and (kind < 2 or x ~= x0 or y ~= y0) then
      return x, y

    elseif key == VK_ESCAPE then
      return nil
    elseif key > 999999 then
      local kk, mx, my = nil, nil, nil
      if key > 1999999 then
        kk = 1
        key = key - 2000000
      else
        kk = 0
        key = key - 1000000
      end
      mx = math.modf((key) / 1000)
      my = math.fmod(key, 1000)
      mx = mx - CC.ScreenW / 2
      my = my - CC.ScreenH / 2
      mx = (mx) / CC.XScale
      my = (my) / CC.YScale
      mx, my = (mx + my) / 2, (my - mx) / 2
      if mx > 0 then
        mx = mx + 0.99
      else
        mx = mx - 0.01
      end
      if my > 0 then
        my = my + 0.99
      else
        mx = mx - 0.01
      end
      mx = math.modf(mx)
      my = math.modf(my)
      for i = 1, 20 do
        if mx + i > 63 or my + i > 63 then
           return;
        end
        local hb = GetS(JY.SubScene, mx + i, my + i, 4)
        if CONFIG.Zoom == 1 then
          hb = hb * 2
        end
        if math.abs(hb - CC.YScale * i * 2) < 8 then
          mx = mx + i
          my = my + i
        end
      end
      
      x2, y2 = mx + x0, my + y0
	    if kk == 1 and (kind < 2 or x ~= x0 or y ~= y0) then
	      return x, y					
	    end
	    
    end
    if x2 >= 0 and x2 < CC.WarWidth and y2 >= 0 and y2 < CC.WarHeight then
			if GetWarMap(x2, y2, 3) ~= nil and GetWarMap(x2, y2, 3) < 128 then
	      x = x2
	      y = y2
		  end
		end
    end
   end
   --WarDrawAtt 
   WarDrawAtt = function(x, y, fanwei, flag, cx, cy, atk)
   local x0, y0 = nil
   if cx == nil or cy == nil then
     x0 = WAR.Person[WAR.CurID]["坐标X"]
     y0 = WAR.Person[WAR.CurID]["坐标Y"]
   else
     x0, y0 = cx, cy
   end
   local kind = fanwei[1]			--攻击范围
   local len1 = fanwei[2]
   local len2 = fanwei[3]
   local len3 = fanwei[4]
   local len4 = fanwei[5]
   local xy = {}
   local num = 0
    if kind == 0 then
      num = 1
      xy[1] = {x, y}
    elseif kind == 1 then
    if not len1 then
      len1 = 0
    end
    if not len2 then
      len2 = 0
    end
    num = num + 1
    xy[num] = {x, y}
    for i = 1, len1 do
      xy[num + 1] = {x + i, y}
      xy[num + 2] = {x - i, y}
      xy[num + 3] = {x, y + i}
      xy[num + 4] = {x, y - i}
      num = num + 4
    end
    for i = 1, len2 do
      xy[num + 1] = {x + i, y + i}
      xy[num + 2] = {x - i, y - i}
      xy[num + 3] = {x - i, y + i}
      xy[num + 4] = {x + i, y - i}
      num = num + 4
    end
    elseif kind == 2 then
    for tx = x - len1, x + len1 do
      for ty = y - len1, y + len1 do
        if len1 < math.abs(tx - x) + math.abs(ty - y) then
          
        else
        	num = num + 1
        	xy[num] = {tx, ty}
        end
        
      end
    end
    elseif kind == 3 then
    if not len2 then
      len2 = len1
    end
    local dx, dy = math.abs(x - x0), math.abs(y - y0)
    if dy < dx then
      len1, len2 = len2, len1
    end
    for tx = x - len1, x + len1 do
      for ty = y - len2, y + len2 do
        num = num + 1
        xy[num] = {tx, ty}
      end
    end
    elseif kind == 5 then
    if not len1 then
      len1 = 0
    end
    if not len2 then
      len2 = 0
    end
    num = num + 1
    xy[num] = {x, y}
    for i = 1, len1 do
      xy[num + 1] = {x + i, y}
      xy[num + 2] = {x - i, y}
      xy[num + 3] = {x, y + i}
      xy[num + 4] = {x, y - i}
      num = num + 4
    end
    if len2 > 0 then
      xy[num + 1] = {x + 1, y + 1}
      xy[num + 2] = {x + 1, y - 1}
      xy[num + 3] = {x - 1, y + 1}
      xy[num + 4] = {x - 1, y - 1}
      num = num + 4
    end
    for i = 2, len2 do
      xy[num + 1] = {x + i, y + 1}
      xy[num + 2] = {x - i, y - 1}
      xy[num + 3] = {x - i, y + 1}
      xy[num + 4] = {x + i, y - 1}
      xy[num + 5] = {x + 1, y + i}
      xy[num + 6] = {x - 1, y - i}
      xy[num + 7] = {x - 1, y + i}
      xy[num + 8] = {x + 1, y - i}
      num = num + 8
    end
    elseif kind == 6 then
    if not len2 then
      len2 = len1
    end
    xy[1] = {x + 1, y}
    xy[2] = {x - 1, y}
    xy[3] = {x, y + 1}
    xy[4] = {x, y - 1}
    num = num + 4
    if len1 > 0 or len2 > 0 then
      xy[5] = {x + 1, y + 1}
      xy[6] = {x + 1, y - 1}
      xy[7] = {x - 1, y + 1}
      xy[8] = {x - 1, y - 1}
      num = num + 4
      for i = 2, len1 do
        xy[num + 1] = {x + i, y + 1}
        xy[num + 2] = {x - i, y + 1}
        xy[num + 3] = {x + i, y - 1}
        xy[num + 4] = {x - i, y - 1}
        num = num + 4
      end
      for i = 2, len2 do
        xy[num + 1] = {x + 1, y + i}
        xy[num + 2] = {x + 1, y - i}
        xy[num + 3] = {x - 1, y + i}
        xy[num + 4] = {x - 1, y - i}
        num = num + 4
      end
    end
    elseif kind == 7 then
    if not len2 then
      len2 = len1
    end
    if len1 == 0 then
      for i = y - len2, y + len2 do
        num = num + 1
        xy[num] = {x, i}
      end
    elseif len2 == 0 then
      for i = x - len1, x + len1 do
        num = num + 1
        xy[num] = {i, y}
      end
    else
      for i = x - len1, x + len1 do
        num = num + 1
        xy[num] = {i, y}
        num = num + 1
        xy[num] = {i, y + len2}
        num = num + 1
        xy[num] = {i, y - len2}
      end
      for i = 1, len2 - 1 do
        xy[num + 1] = {x, y + i}
        xy[num + 2] = {x, y - i}
        xy[num + 3] = {x - len1, y + i}
        xy[num + 4] = {x - len1, y - i}
        xy[num + 5] = {x + len1, y + i}
        xy[num + 6] = {x + len1, y - i}
        num = num + 6
      end
    end
    elseif kind == 8 then
    xy[1] = {x, y}
    num = 1
    for i = 1, len1 do
      xy[num + 1] = {x + i, y}
      xy[num + 2] = {x - i, y}
      xy[num + 3] = {x, y + i}
      xy[num + 4] = {x, y - i}
      xy[num + 5] = {x + i, y + len1}
      xy[num + 6] = {x - i, y - len1}
      xy[num + 7] = {x + len1, y - i}
      xy[num + 8] = {x - len1, y + i}
      num = num + 8
    end
    elseif kind == 9 then
    xy[1] = {x, y}
    num = 1
    for i = 1, len1 do
      xy[num + 1] = {x + i, y}
      xy[num + 2] = {x - i, y}
      xy[num + 3] = {x, y + i}
      xy[num + 4] = {x, y - i}
      xy[num + 5] = {x - i, y + len1}
      xy[num + 6] = {x + i, y - len1}
      xy[num + 7] = {x + len1, y + i}
      xy[num + 8] = {x - len1, y - i}
      num = num + 8
    end
    elseif x == x0 and y == y0 then
       return 0
    elseif kind == 10 then
       if not len2 then
          len2 = 0
    end
    if not len3 then
      len3 = 0
    end
    if not len4 then
      len4 = 0
    end
    local fx, fy = x - x0, y - y0
    if fx > 0 then
      fx = 1
    elseif fx < 0 then
      fx = -1
    end
    if fy > 0 then
      fy = 1
    elseif fy < 0 then
      fy = -1
    end
    local dx1, dy1, dx2, dy2 = -fy, fx, fy, -fx
    dx1 = -(dx1 + fx) / 2
    dx2 = -(dx2 + fx) / 2
    dy1 = -(dy1 + fy) / 2
    dy2 = -(dy2 + fy) / 2
    if dx1 > 0 then
      dx1 = 1
    elseif dx1 < 0 then
      dx1 = -1
    end
    if dx2 > 0 then
      dx2 = 1
    elseif dx2 < 0 then
      dx2 = -1
    end
    if dy1 > 0 then
      dy1 = 1
    elseif dy1 < 0 then
      dy1 = -1
    end
    if dy2 > 0 then
      dy2 = 1
    elseif dy2 < 0 then
      dy2 = -1
    end
    for i = 0, len1 - 1 do
      num = num + 1
      xy[num] = {x + i * fx, y + i * fy}
    end
    for i = 0, len2 - 1 do
      num = num + 1
      xy[num] = {x + dx1 + i * fx, y + dy1 + i * fy}
      num = num + 1
      xy[num] = {x + dx2 + i * fx, y + dy2 + i * fy}
    end
    for i = 0, len3 - 1 do
      num = num + 1
      xy[num] = {x + 2 * dx1 + i * fx, y + 2 * dy1 + i * fy}
      num = num + 1
      xy[num] = {x + 2 * dx2 + i * fx, y + 2 * dy2 + i * fy}
    end
    for i = 0, len4 - 1 do
      num = num + 1
      xy[num] = {x + 3 * dx1 + i * fx, y + 3 * dy1 + i * fy}
      num = num + 1
      xy[num] = {x + 3 * dx2 + i * fx, y + 3 * dy2 + i * fy}
    end
    elseif kind == 11 then
    local fx, fy = x - x0, y - y0
    if fx > 1 then
      fx = 1
    elseif fx < -1 then
      fx = -1
    end
    if fy > 1 then
      fy = 1
    elseif fy < -1 then
      fy = -1
    end
    local dx1, dy1, dx2, dy2 = -fy, fx, fy, -fx
    if fx ~= 0 and fy ~= 0 then
      dx1 = -(dx1 + fx) / 2
      dx2 = -(dx2 + fx) / 2
      dy1 = -(dy1 + fy) / 2
      dy2 = -(dy2 + fy) / 2
      len1 = math.modf(len1 * 0.7071)
      for i = 0, len1 do
        num = num + 1
        xy[num] = {x + i * fx, y + i * fy}
        for j = 1, 2 * i + 1 do
          num = num + 1
          xy[num] = {x + i * fx + j * (dx1), y + i * fy + j * (dy1)}
          num = num + 1
          xy[num] = {x + i * fx + j * (dx2), y + i * fy + j * (dy2)}
        end
      end
    else
      for i = 0, len1 do
        num = num + 1
        xy[num] = {x + i * fx, y + i * fy}
        for j = 1, len1 - i do
          num = num + 1
          xy[num] = {x + i * fx + j * (dx1), y + i * fy + j * (dy1)}
          num = num + 1
          xy[num] = {x + i * fx + j * (dx2), y + i * fy + j * (dy2)}
        end
      end
    end
    elseif kind == 12 then
    local fx, fy = x - x0, y - y0
    if fx > 1 then
      fx = 1
    elseif fx < -1 then
      fx = -1
    end
    if fy > 1 then
      fy = 1
    elseif fy < -1 then
      fy = -1
    end
    local dx1, dy1, dx2, dy2 = -fy, fx, fy, -fx
    if fx ~= 0 and fy ~= 0 then
      dx1 = (dx1 + fx) / 2
      dx2 = (dx2 + fx) / 2
      dy1 = (dy1 + fy) / 2
      dy2 = (dy2 + fy) / 2
      len1 = math.modf(len1 * 1.41421)
      for i = 0, len1 do
        if i <= len1 / 2 then
          num = num + 1
          xy[num] = {x + i * fx, y + i * fy}
        end
        for j = 1, len1 - i * 2 do
          num = num + 1
          xy[num] = {x + i * fx + j * (dx1), y + i * fy + j * (dy1)}
          num = num + 1
          xy[num] = {x + i * fx + j * (dx2), y + i * fy + j * (dy2)}
        end
      end
    else
      for i = 0, len1 do
        num = num + 1
        xy[num] = {x + i * fx, y + i * fy}
        for j = 1, i do
          num = num + 1
          xy[num] = {x + i * fx + j * (dx1), y + i * fy + j * (dy1)}
          num = num + 1
          xy[num] = {x + i * fx + j * (dx2), y + i * fy + j * (dy2)}
        end
      end
    end
    elseif kind == 13 then
    local fx, fy = x - x0, y - y0
    if fx > 1 then
      fx = 1
    elseif fx < -1 then
      fx = -1
    end
    if fy > 1 then
      fy = 1
    elseif fy < -1 then
      fy = -1
    end
    local xx = x + fx * len1
    local yy = y + fy * len1
    for tx = xx - len1, xx + len1 do
      for ty = yy - len1, yy + len1 do
        if len1 < math.abs(tx - xx) + math.abs(ty - yy) then
          do return end
        end
        num = num + 1
        xy[num] = {tx, ty}
      end
    end
    else
    return 0
    end
  
    if flag == 1 then
    local thexy = function(nx, ny, x, y)
	    local dx, dy = nx - x, ny - y
	    local hb = lib.GetS(JY.SubScene, nx, ny, 4)
	    if CONFIG.Zoom == 1 then
	      hb = hb * 2
	    end
	    return CC.ScreenW / 2 + CC.XScale * (dx - dy), CC.ScreenH / 2 + CC.YScale * (dx + dy) - hb
    end
    
    for i = 1, num do
    	if xy[i][1] >= 0 and xy[i][1] < CC.WarWidth and xy[i][2] >= 0 and xy[i][2] < CC.WarHeight then
      	local tx, ty = thexy(xy[i][1], xy[i][2], x0, y0)
	      --蓝烟清：显示命中的人的点为黑色
	      if GetWarMap(xy[i][1], xy[i][2], 2) ~= nil and GetWarMap(xy[i][1], xy[i][2], 2) >= 0 and GetWarMap(xy[i][1], xy[i][2], 2) ~= WAR.CurID then
					if not inteam(WAR.Person[GetWarMap(xy[i][1], xy[i][2], 2)]["人物编号"]) and WAR.Person[WAR.CurID]["我方"] then
		      	local x0 = WAR.Person[WAR.CurID]["坐标X"];
		      	local y0 = WAR.Person[WAR.CurID]["坐标Y"];
		      	local dx = xy[i][1] - x0
		        local dy = xy[i][2] - y0
		        local size = CC.FontSmall;
		        local rx = CC.XScale * (dx - dy) + CC.ScreenW / 2
		        local ry = CC.YScale * (dx + dy) + CC.ScreenH / 2
		        
		        local hb = GetS(JY.SubScene, dx + x0, dy + y0, 4)
		        if CONFIG.Zoom == 1 then
		          hb = hb * 2
		        end
		        ry = ry - hb - 120;
		        
		        if ry < 1 then			--加上这个，防止看不到血的情况
		        	ry = 1;
		        end
		      	
		      	--显示选中人物的生命值
		      	local color = RGB(245, 251, 5);
		      	local hp = JY.Person[WAR.Person[GetWarMap(xy[i][1], xy[i][2], 2)]["人物编号"]]["生命"];
		      	local maxhp = JY.Person[WAR.Person[GetWarMap(xy[i][1], xy[i][2], 2)]["人物编号"]]["生命最大值"];
		      	
		      	local ns = JY.Person[WAR.Person[GetWarMap(xy[i][1], xy[i][2], 2)]["人物编号"]]["受伤程度"];
		      	local zd = JY.Person[WAR.Person[GetWarMap(xy[i][1], xy[i][2], 2)]["人物编号"]]["中毒程度"];
		      	local len = #(string.format("%d/%d",hp,maxhp));
		      	rx = rx - len*size/4;
		      	
		      	--颜色根据所受的内伤确定
		      	if ns < 33 then
				      color = RGB(236, 200, 40)
				    elseif ns < 66 then
				      color = RGB(244, 128, 32)
				    else
				      color = RGB(232, 32, 44)
				    end
		      	
		      	DrawString(rx, ry, string.format("%d",hp), color, size);
		      	DrawString(rx + #string.format("%d",hp)*size/2, ry, "/", C_GOLD, size);
		      	
		      	if zd == 0 then
				      color = RGB(252, 148, 16)
				    elseif zd < 50 then
				      color = RGB(120, 208, 88)
				    else
				      color = RGB(56, 136, 36)
				    end
				    DrawString(rx + #string.format("%d",hp)*size/2 + size/2 , ry, string.format("%d", maxhp), color, size)
		      end
		      
	      	lib.PicLoadCache(0, 0, tx, ty, 2, 200)
	      	
	      else
	      	lib.PicLoadCache(0, 0, tx, ty, 2, 112)
	      end
      end
    end

    elseif flag == 2 then
    local diwo = WAR.Person[WAR.CurID]["我方"]
	local pid = WAR.Person[WAR.CurID]["人物编号"]
    local atknum = 0
    for i = 1, num do
      if xy[i][1] >= 0 and xy[i][1] < CC.WarWidth and xy[i][2] >= 0 and xy[i][2] < CC.WarHeight then
        local id = GetWarMap(xy[i][1], xy[i][2], 2)      
	      if id ~= -1 and id ~= WAR.CurID then
	        local xa, xb, xc = nil, nil, nil
			local eid = WAR.Person[id]["人物编号"]
	        if diwo ~= WAR.Person[id]["我方"] then
	          xa = 2
	        else
	          if GetS(0, 0, 0, 0) == 1 then
	            xa = -0.5
		      else
		        xa = 0
		      end
	        end
			if xa > 0 and DT(eid, 664) and JX(eid) and JY.Person[pid]["性别"] == 1 and JY.Person[eid]["性别"] == 0 then
				xa = 0
			end
			if xa > 0 and WAR.UNDEAD[eid] ~= nil and WAR.UNDEAD[eid] > 0 then
				xa = 0
			end
			if xa ~= 0 then
				local hp = JY.Person[WAR.Person[id]["人物编号"]]["生命"]
				if hp < atk / 6 then
					xb = 2
				elseif hp < atk / 3 then
					xb = 1
				else
					xb = 0
				end
				local danger = JY.Person[WAR.Person[id]["人物编号"]]["内力最大值"]
				xc = danger / 500
				atknum = atknum + xa * math.modf(xb * (xc) + 5)
			end
	    end
      end
    end
    return atknum
    elseif flag == 3 then
    for i = 1, num do
    	if xy[i][1] >= 0 and xy[i][1] < CC.WarWidth and xy[i][2] >= 0 and xy[i][2] < CC.WarHeight then
      	SetWarMap(xy[i][1], xy[i][2], 4, 1)
      end
    end
    end
end

--显示战斗说明
function MyWarInstruce(title, strtable)
	local size = CC.DefaultFont;
	local color = C_GOLD;
	local w=size*24+2*CC.MenuBorderPixel;
	local h=size*18+2*CC.MenuBorderPixel;
	local x=(CC.ScreenW-size*24-2*CC.MenuBorderPixel)/2;
	local y=(CC.ScreenH-size*18-2*CC.MenuBorderPixel)/2;
	Cls()
	DrawBox(x,y,x+w-1,y+h-1,C_WHITE);
	DrawString((x+w-1)/2 - #title*size*3/16,y+CC.MenuBorderPixel+size,title,color,size*3/2);
	
	for i,v in pairs(strtable) do
		DrawString(x+CC.MenuBorderPixel + 10,y+(size+CC.MenuBorderPixel)*i*2 + 2*size,v[1],color,size);
		DrawString(x+CC.MenuBorderPixel + 10 + #v[1]*size/2,y+(size+CC.MenuBorderPixel)*i*2 + 2*size,v[2],color,size);
	end
	lib.GetKey()
	ShowScreen()
	WaitKey()
end
--战斗主函数
function WarMain(warid, isexp)
    WarLoad(warid)			--初始化战斗数据
    WarSelectTeam()			--选择我方
    WarSelectEnemy()		--选择敌人
	for i = 7, CC.TeamNum do
		if WAR.SelectPerson[i] ~= nil and WAR.SelectPerson[i] > 0 then
			local x, y = WE_xy(WAR.Person[0]["坐标X"], WAR.Person[0]["坐标Y"] - 1)	
			NewWARPersonZJ(JY.Base["队伍" .. i], true, x, y, false, 2);							
		end 
	end
    --insert?
  			--local x, y = WE_xy(WAR.Person[1]["坐标X"], WAR.Person[1]["坐标Y"] - 1)
			--NewWARPersonZJ(592, true, x, y, false, 2);
    --蓝烟清：战斗时如果队友为敌方，增强实力
    local haszj = 0
    for a = 0, WAR.PersonNum - 1 do 
	local aa = WAR.Person[a]["人物编号"]
	if aa == zj() then haszj = 1 end
    end	
    joinPet()
    if haszj == 1 and cxzj() == 0 and GetS(86,10,20,5) == 1 and WAR.Data["自动选择参战人1"] == -1 and GetS(111, 0, 0, 0) ~= 592 then --蓝烟清：主角召唤独孤求败 --武骧金星：改成战斗开始时询问
	if DrawStrBoxYesNo(-1, -1, "是否请独孤求败出战？", C_WHITE, 30) == true then
		if WAR.L_DGQB_ZL == 0 then		
			AddPersonAttrib(0, "体力", -15)
			AddPersonAttrib(0, "内力", -500)	
			local x, y = WE_xy(WAR.Person[0]["坐标X"], WAR.Person[0]["坐标Y"] - 1)
			NewWARPersonZJ(592, true, x, y, false, 2);
			local s = nil
			s = WAR.CurID
			WAR.CurID = WAR.PersonNum - 1
			Talk("难得如此大战，不来参加真是可惜啊~~~哈哈~~~", 592)  
			WAR.CurID = s
			WAR.L_DGQB_ZL = 1;
		else
			DrawStrBoxWaitKey(CC.EVB176, C_WHITE, 30)
			return 0
		end
	end
    end
  
    for i = 0, WAR.PersonNum - 1 do
    local p = WAR.Person[i]["人物编号"];
    if jtyl(p) then 
       WAR.SJSM[1000+p] = JY.Person[p]["生命最大值"]
    end
    if wssz(p) then 
       WAR.SSFN[1000+p] = JY.Person[p]["生命最大值"]
    end
    if ycfy(p) then 
       if WAR.Person[i]["我方"] == true then 
	      WAR.DW[p] = 1
	   elseif WAR.Person[i]["我方"] == false then
		  WAR.DW[p] = 2
	   end
    end 
     if WAR.Person[i]["我方"] == true then
	    WAR.CONFUSEO[p] = 1
	 elseif WAR.Person[i]["我方"] == false then
	    WAR.CONFUSEO[p] = 2
	 end
end 
    --离线队友加成
    if WAR.ZDDH ~= 342 and WAR.ZDDH ~= 20 and WAR.ZDDH ~= 241 and WAR.ZDDH ~= 204 then
	  for i = 0, WAR.PersonNum - 1 do	
		local p = WAR.Person[i]["人物编号"];
		if duiyou(p) and not inteam(p) and not DT(p, 606) and WAR.Person[i]["我方"] == false then
			WAR.tmp[4000 + i] = {p};
			if JY.Person[p]["生命最大值"] <= JY.Thing[202][WZ7] * 80 then --弱的？
				WAR.tmp[4000+i][2] = JY.Thing[202][WZ7] * 200 + 100 - JY.Person[p]["生命最大值"];
				JY.Person[p]["生命最大值"] = JY.Thing[202][WZ7] * 200 + 100 --100改500
			else
				WAR.tmp[4000+i][2] = JY.Thing[202][WZ7] * JY.Person[p]["生命最大值"] + 100 - JY.Person[p]["生命最大值"]
				JY.Person[p]["生命最大值"] = JY.Thing[202][WZ7] * JY.Person[p]["生命最大值"] + 100 --100改700
			end
					
			JY.Person[p]["生命"] = JY.Person[p]["生命最大值"]
		  
		  --难度内力
		  if JY.Person[p]["内力最大值"] <= JY.Thing[202][WZ7] * 200 + 100 then
			WAR.tmp[4000+i][3] = JY.Thing[202][WZ7] * 300 + 100 - JY.Person[p]["内力最大值"];
			JY.Person[p]["内力最大值"] = JY.Thing[202][WZ7] * 300 + 100 --100改600
			
		  elseif JY.Person[p]["内力最大值"] < CC.PersonAttribMax["内力最大值"] * 2 then
			WAR.tmp[4000+i][3] = 600 * JY.Thing[202][WZ7];
			JY.Person[p]["内力最大值"] = JY.Person[p]["内力最大值"] + 600 * JY.Thing[202][WZ7] --+800
			end
			
			JY.Person[p]["内力"] = JY.Person[p]["内力最大值"]
		end
	  end
    end
    for i = 0, WAR.PersonNum - 1 do
    local p = WAR.Person[i]["人物编号"];
        if txjid(p) then
           for j = 0, WAR.PersonNum - 1 do 
	          if WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] then 
                  WAR.JSYZ[WAR.Person[j]["人物编号"]] = 1
	          end 
	       end   
        end
    end
    CleanMemory()
    lib.PicInit()
    lib.ShowSlow(50, 1)
    
    WarLoadMap(WAR.Data["地图"])	--加载战斗地图 
  
    --飞影：根据自动战斗参数判定战斗是否为自动战斗
	   WAR.AutoFight = JY.ZDZD
	
    --雪山落花流水战役
    if WAR.ZDDH == 42 then
      SetS(2, 24, 31, 1, 0)
      SetS(2, 30, 34, 1, 0)
      SetS(2, 27, 27, 1, 0)
    end
  
    for i = 0, 63 do
    for j = 0, 63 do
      lib.SetWarMap(i, j, 0, lib.GetS(JY.SubScene, i, j, 0))
      lib.SetWarMap(i, j, 1, lib.GetS(JY.SubScene, i, j, 1))
    end
    end

    if JY.Status == GAME_MMAP then --test main map
	local maplist = {38, 51, 53, 62, 63, 73, 78, 80, 81, 86, 87, 93, 97, 98, 99, 103, 105}
	local randommap = maplist[math.random(#maplist)]
	for i = 0, 63 do
		for j = 0, 63 do
			lib.SetWarMap(i, j, 0, lib.GetS(randommap, i, j, 0))
			lib.SetWarMap(i, j, 1, lib.GetS(randommap, i, j, 1))
		end
	end	
    end
  
    if WAR.ZDDH == 291 then
	local randommap = math.random(105)
	for i = 0, 63 do
		for j = 0, 63 do
			lib.SetWarMap(i, j, 0, lib.GetS(randommap, i, j, 0))
			lib.SetWarMap(i, j, 1, lib.GetS(randommap, i, j, 1))
		end
	end	
    end

    --新华山论剑
    if WAR.ZDDH == 238 then
    for x = 24, 34 do
      for y = 24, 34 do
        lib.SetWarMap(x, y, 0, 1030)
      end
    end
    for y = 23, 35 do
      lib.SetWarMap(23, y, 1, 1174)
      lib.SetWarMap(35, y, 1, 1174)
    end
    for x = 24, 35 do
      lib.SetWarMap(x, 35, 1, 1174)
      lib.SetWarMap(x, 23, 1, 1174)
    end
    lib.SetWarMap(23, 23, 0, 1174)
    lib.SetWarMap(35, 35, 0, 1174)
    lib.SetWarMap(23, 35, 0, 1174)
    lib.SetWarMap(35, 23, 0, 1174)
    lib.SetWarMap(23, 23, 1, 2960)
    lib.SetWarMap(35, 35, 1, 2960)
    lib.SetWarMap(23, 35, 1, 2960)
    lib.SetWarMap(35, 23, 1, 2960)
    end
  
    --杀东方不败
    if WAR.ZDDH == 54 then
       lib.SetWarMap(11, 36, 1, 2)
    end
  
    --改变游戏状态
    local gamestatus = JY.Status 
    JY.Status = GAME_WMAP
  
    --加载贴图文件
    lib.PicLoadFile(CC.WMAPPicFile[1], CC.WMAPPicFile[2], 0)
    lib.PicLoadFile(CC.HeadPicFile[1], CC.HeadPicFile[2], 1)  
    lib.PicLoadFile(CC.GamePicFile[1], CC.GamePicFile[2], 90)
    lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55, 110)
    if JY.HEADXZ == 1 then
       CC.SXTFDJ = {CONFIG.DataPath .. "tfdj.idx", CONFIG.DataPath .. "tfdj.grp"}
    else
       CC.SXTFDJ = {CONFIG.DataPath .. "tfdjb.idx", CONFIG.DataPath .. "tfdjb.grp"}
    end
  
    lib.PicLoadFile(CC.SXTFDJ[1], CC.SXTFDJ[2], 91)
    lib.PicLoadFile(CC.HeadPicFile[1], CC.HeadPicFile[2], 99, 50) --25为比例
    if CC.LoadThingPic == 1 then
       lib.PicLoadFile(CC.WpPic[1], CC.WpPic[2], 2)
    end
    if CONFIG.Zoom == 1 then
	   lib.PicLoadFile(CC.HZPicFile[1], CC.HZPicFile[2], 9)
    else
	   lib.PicLoadFile(CC.HZPicFile[1], CC.HZPicFile[2], 9, 50)
    end

    lib.PicLoadFile(CC.EffectFile[1], CC.EffectFile[2], 3)
    if CONFIG.MP3 ~= 1 and (WAR.ZDDH == 133 or WAR.ZDDH == 134) then
       WAR.Data["音乐"] = 6
    end
    local mu = math.random(5) + 49
    PlayMIDI(mu)
  
    if WAR.ZDDH == 238 then
       PlayMIDI(27)
    end
    if WAR.ZDDH == 217 then
       PlayMIDI(55)
    end 
    
    local first = 0          --第一次显示战斗标记
    local warStatus = nil		 --战斗状态
  
    --人物重新赋值
    --for i = 0, WAR.PersonNum - 1 do
    --  for s = 1, 80 do
    --    JY.Person[WAR.Person[i]["人物编号"]][PSX[s]] = JY.Person[WAR.Person[i]["人物编号"]][PSX[s]]
    --  end
    --end
  
    WarPersonSort()			--按轻功排序
    CleanWarMap(2, -1)
  
    for i = 0, WAR.PersonNum - 1 do	
    if i == 0 then
      WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"] = WE_xy(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"])
    else
      WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"] = WE_xy(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], i)
    end
    SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 2, i)
    
    local pid = WAR.Person[i]["人物编号"]
    lib.PicLoadFile(string.format(CC.FightPicFile[1], JY.Person[pid]["头像代号"]), string.format(CC.FightPicFile[2], JY.Person[pid]["头像代号"]), 4 + i)
    end
    local function getnewmove(x)
    if x > 150 then
      return 7 + (x - 150) / 80
    elseif x > 70 then
      return 5 + (x - 70) / 40
    elseif x > 30 then
      return 3 + (x - 30) / 20
    else
      return x / 10
    end
    end
    local function getnewmove1(a, b)
    local x = (a * 2 + b) / 3
    if x > 4000 then
      return 8 + (x - 4000) / 1000
    elseif x > 2400 then
      return 6 + (x - 2400) / 800
    elseif x > 1200 then
      return 4 + (x - 1200) / 600
    elseif x > 400 then
      return 2 + (x - 400) / 400
    else
      return x / 200
    end
    end
    local function getdelay(x, y)
         return math.modf(1.5 * (x / y + y - 3))
    end
    for i = 0, WAR.PersonNum - 1 do
        WAR.Person[i]["贴图"] = WarCalPersonPic(i)
    end
    WarSetPerson()
    WAR.CurID = 0
    WarDrawMap(0)
    lib.ShowSlow(50, 0)
	
	--优化集气卡顿 缓存队友数据 考虑到演武场必须放在WarSetPerson之后 start 20200427
	JY.MyTeamData = {}
	for i = 1, CC.TeamNum do
	  local tmpid = JY.Base["队伍" .. i]
	  JY.MyTeamData[tmpid] = tmpid
	end
	--优化集气卡顿 缓存队友数据 考虑到演武场必须放在WarSetPerson之后 end 20200427
	
    if WAR.ZDDH == 166 then
	say("想当年我们四兄弟长城义结金兰，曾豪言壮志，必定称霸一方。",35,0,"无酒不欢")
	say("多年过去了，我大哥扫地修行，精研佛理。我二哥但求一败，归隐深山。我三哥开宗立派，广收弟子。",35,0,"无酒不欢")
	say("而我隐姓埋名，看淡名利，现在当一个普通的小兵。",35,0,"无酒不欢")
	say("………………………………………………")
    end
	if GetS(86, 2, 10, 5) == 3 then
	say("师傅云游四海，如今就由我一人来考验你们。",35,0,"无酒不欢")
	say("如果短时间不能胜过我请自行投降，师傅请了无悠来帮忙考验你们。",35,0,"无酒不欢")
	end		
    if T11CJR(0) and WAR.Data["自动选择参战人1"] == 0 and JY.Person[0]["武学常识"] == 0 then
	   JY.Person[0]["武学常识"] = 10
	  say("顺吾者生，逆吾者亡，万恶的罪魁，藏镜人也！")
    end
    for i = 0, WAR.PersonNum - 1 do
    WAR.Person[i].Time = math.modf((800 - i * 1000 / WAR.PersonNum) * 0.5)
	
	if hasTF(WAR.Person[i]["人物编号"], 12) then
		WAR.Person[i].Time = 999
	end
	--主动怒气爆发
	if JY.Person[WAR.Person[i]["人物编号"]]["觉醒"] > 0 then
	    if WAR.LQZ[WAR.Person[i]["人物编号"]] == nil then 
		   WAR.LQZ[WAR.Person[i]["人物编号"]] = 0
		end
	end	

    --岳灵珊 每个剑法到极+50点初始集气 
    if DT(WAR.Person[i]["人物编号"], 79) then
      local JF = 0
	  local id = WAR.Person[i]["人物编号"]
	  JF = wgnumber(id, 2)
      WAR.Person[i].Time = WAR.Person[i].Time + (JF) * 50
    end
	
    if DT(WAR.Person[i]["人物编号"], 76) then --王语嫣每个武功+50集气
      local WYY = 0
      for j = 1, 10 do
        if JY.Person[WAR.Person[i]["人物编号"]]["武功" .. j] > 0 then
          WYY = WYY + 50
        end
      end
      WAR.Person[i].Time = WAR.Person[i].Time + WYY
    end
    
    if DT(WAR.Person[i]["人物编号"], 90) then --钟灵初始集气+50%
      WAR.Person[i].Time = math.modf(WAR.Person[i].Time * 1.5)
    end	
    
	if WAR.Person[i]["人物编号"] == 0 and putong() == 13 then
		WAR.Person[i].Time = WAR.Person[i].Time + 100 * wgnumber(WAR.Person[i]["人物编号"], 6)
	end	
	
     if WAR.Person[i]["人物编号"] == 0 and T7DFWM(0) then --东方未明暗系初始集气
		WAR.Person[i].Time = WAR.Person[i].Time + 50 * wgnumber(WAR.Person[i]["人物编号"], 6)
	    end	
	
    --太极神功初始集气50
	if wglw(i,182) or (DT(i,5) and PersonGT(i,182)) then
        WAR.Person[i].Time = 50
    end	
	
    --血刀老祖 初始集气900
    if DT(WAR.Person[i]["人物编号"], 97) then
        WAR.Person[i].Time = 900
    end
    
    if DT(WAR.Person[i]["人物编号"], 583) then
        WAR.Person[i].Time = 800
    end	
	
    if DT(WAR.Person[i]["人物编号"], 600) then
	    WAR.Person[i].Time = 1000
	end			
	
    --聂风觉醒十方后开场立即行动
    if NF(WAR.Person[i]["人物编号"], 0) and juexing() > 1 then
        WAR.Person[i].Time = 1000
    end		

    if wglw1(i,47) or (PersonKF(i, 47) and (DT(i, 592))) then	
		WAR.Person[i].Time = 1000
	end
	
	WAR.Person[i].Time = WAR.Person[i].Time + startjiqi(WAR.Person[i]["人物编号"])
	
    --太监初始集气-300
    if JY.Person[WAR.Person[i]["人物编号"]]["性别"] == 2 then
		if WAR.Person[i]["人物编号"] == 0 and GetS(86,15,15,5) == 1 then --白马邪线宫后集气没惩罚

		elseif MPPD(WAR.Person[i]["人物编号"]) == 12 and GetS(54,0,0,1) == 2 and MPDJ(WAR.Person[i]["人物编号"]) >= 3 then--日月神教
		
		elseif WAR.Person[i]["人物编号"] == 0 and GetS(111, 0, 0, 0) == 105 then
		
		elseif WAR.Person[i]["人物编号"] == 0 and hasSK(40) then
		
		elseif hasTF(WAR.Person[i]["人物编号"], 133) then
		
		elseif DT(WAR.Person[i]["人物编号"],19) or WAR.Person[i]["人物编号"] == 189
			or DT(WAR.Person[i]["人物编号"],27) then
		
		else
			WAR.Person[i].Time = -300
		end
    end
    
    --林平之 初始集气700
    if DT(WAR.Person[i]["人物编号"], 36) then
      WAR.Person[i].Time = 700
    end
    
	        
	if getHZ(WAR.Person[i]["人物编号"], 2) then --御风令+300
	  WAR.Person[i].Time = WAR.Person[i].Time + 300
	end	
	
    --李芷沅山洞，两个木桩
    if WAR.Person[i]["人物编号"] == 445 and WAR.ZDDH == 226 then
      WAR.Person[i].Time = 999
    end
    if WAR.Person[i]["人物编号"] == 446 and WAR.ZDDH == 226 then
      WAR.Person[i].Time = 900
    end
    
    --圣火神功 初始集气加200 设为主功体+500
    local id = WAR.Person[i]["人物编号"]
    if PersonKF(id, 93) then
      WAR.Person[i].Time = WAR.Person[i].Time + 200
	  if PersonGT(id, 93) then
		WAR.Person[i].Time = WAR.Person[i].Time + 300
	  end
    end
    if WAR.Person[i].Time > 990 then
      WAR.Person[i].Time = 990
    end
	
	--武骧金星：阿珂降低敌方男性初始集气
    if DT(WAR.Person[i]["人物编号"], 86) and WAR.Person[i]["死亡"] == false then
		for j = 0, WAR.PersonNum - 1 do
			if JY.Person[WAR.Person[j]["人物编号"]]["性别"] == 0 and WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false then
				WAR.Person[j].Time = WAR.Person[j].Time - 200
			end
		end
	end
	
	if DT(WAR.Person[i]["人物编号"], 604) and WAR.Person[i]["死亡"] == false then
		for j = 0, WAR.PersonNum - 1 do
			if  WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false then
				WAR.Person[j].Time = WAR.Person[j].Time - 200
			end
		end
	end
	
  	WAR.Person[i]["移动步数"] = math.modf((getnewmove(WAR.Person[i]["轻功"])) - JY.Person[id]["中毒程度"] / 50 - JY.Person[id]["受伤程度"] / 60 + JY.Person[id]["体力"] / 70 - 1)
	  
	if WAR.Person[i]["移动步数"] < 1 then
      WAR.Person[i]["移动步数"] = 1
    end
    end
    --木桩
    JY.Person[445]["姓名"] = CC.WARS1
    JY.Person[446]["姓名"] = CC.WARS1
    if WAR.ZDDH == 226 then
       JY.Person[445]["姓名"] = CC.WARS2
       JY.Person[446]["姓名"] = CC.WARS3
    end
    
    --东方不败，无左右
    JY.Person[27]["左右互搏"] = 0
  
    --战场上显示物品
    for a = 0, WAR.PersonNum - 1 do
    for s = 1, 4 do
      if JY.Person[WAR.Person[a]["人物编号"]]["携带物品数量" .. s] == nil or JY.Person[WAR.Person[a]["人物编号"]]["携带物品数量" .. s] < 1 then
        JY.Person[WAR.Person[a]["人物编号"]]["携带物品" .. s] = -1
        JY.Person[WAR.Person[a]["人物编号"]]["携带物品数量" .. s] = 0;
      end
    end
    end
	
	local YANGJI = {}
	local YINJI = {}
	for a = 0, WAR.PersonNum - 1 do
		if hasTF(WAR.Person[a]["人物编号"], 13) then
		  WAR.LQZ[WAR.Person[a]["人物编号"]] = 100 
		end
		if DT(WAR.Person[a]["人物编号"], 8) or DT(WAR.Person[a]["人物编号"], 167) or DT(WAR.Person[a]["人物编号"], 168) then
		  AddPersonAttrib(WAR.Person[a]["人物编号"], "受伤程度", 20)
		end
		if wglw(WAR.Person[a]["人物编号"], 189) or DT(WAR.Person[a]["人物编号"], 603) then--阴阳磨领悟
			if math.random(10) > 5 then
				YANGJI[#YANGJI + 1] = a
			else
				YINJI[#YINJI + 1] = a
			end
		end	
		if hasTF(WAR.Person[a]["人物编号"], 14) then
		for j = 0, WAR.PersonNum - 1 do
			if WAR.Person[a]["我方"] ~= WAR.Person[j]["我方"] then
				AddPersonAttrib(WAR.Person[j]["人物编号"], "中毒程度", 10)
				AddPersonAttrib(WAR.Person[j]["人物编号"], "内力", -1000)
			end
		end
		end
		if WAR.Person[a]["人物编号"] == 0 and putong() == 8 and juexing() > 0 then
		AddPersonAttrib(WAR.Person[a]["人物编号"], "中毒程度", 100)
		end
		ceshi()
	end
	
	--优化阳极阴极显示 天机弹出太多次了 start 20200501
	if #YANGJI > 0 or #YINJI > 0 then
		local ssid = lib.SaveSur(0, 0, CC.ScreenW, CC.ScreenH)
		for ii = 1849, 1860 do
			local x0 = WAR.Person[WAR.CurID]["坐标X"]
			local y0 = WAR.Person[WAR.CurID]["坐标Y"]
			for ji = 1, #YANGJI do
				local jindex = YANGJI[ji]
				local dx = WAR.Person[jindex]["坐标X"] - x0
				local dy = WAR.Person[jindex]["坐标Y"] - y0
				local rx = CC.XScale * (dx - dy) + CC.ScreenW / 2
				local ry = CC.YScale * (dx + dy) + CC.ScreenH / 2
				local hb = GetS(JY.SubScene, dx + x0, dy + y0, 4)
				if CONFIG.Zoom == 1 then
					hb = hb * 2
				end
				ry = ry - hb
				lib.PicLoadCache(3, ii * 2, rx, ry, 0)
				DrawString(rx - 60, ry - 5, "阳极状态", C_GOLD, 30)
			end
			for ji = 1, #YINJI do
				local jindex = YINJI[ji]
				local dx = WAR.Person[jindex]["坐标X"] - x0
				local dy = WAR.Person[jindex]["坐标Y"] - y0
				local rx = CC.XScale * (dx - dy) + CC.ScreenW / 2
				local ry = CC.YScale * (dx + dy) + CC.ScreenH / 2
				local hb = GetS(JY.SubScene, dx + x0, dy + y0, 4)
				if CONFIG.Zoom == 1 then
					hb = hb * 2
				end
				ry = ry - hb
				lib.PicLoadCache(3, ii * 2, rx, ry, 0)
				DrawString(rx - 60, ry - 5, "阴极状态", C_GOLD, 30)
			end
			ShowScreen()
			lib.Delay(40)
			lib.LoadSur(ssid, 0, 0)
		end
		lib.FreeSur(ssid)
	end
	--优化阳极阴极显示 天机弹出太多次了 end 20200501
	
local function fightcombo()
	local combo = {}
	for i = 1, #CC.COMBO do
		if GetS(99,0,1,0) > 0 and CC.COMBO[i][1] == 77 then 
		   CC.COMBO[i][2] = 0
		end   
		combo[i] = {CC.COMBO[i][1], CC.COMBO[i][2], CC.COMBO[i][3]}
	end
	for i = 0, WAR.PersonNum - 1 do
		local t = WAR.Person[i]["人物编号"]
		for j = 1, #combo do
			lib.GetKey()
			if t == combo[j][1] then
				for z = 0, WAR.PersonNum - 1 do
					local t2 = WAR.Person[z]["人物编号"]
					if t2 == combo[j][2] and WAR.Person[i]["我方"] == WAR.Person[z]["我方"] then
						combo[j][4] = 1
						--break
					end
				end
			end
		end
	end
	for i = 1, #combo do
		if combo[i][4] ~= nil and combo[i][4] == 1 then
			local t1 = combo[i][1]
			local t2 = combo[i][2]
			zhanyi(t1, 10, 1)
			zhanyi(t2, 10, 1)
			for j = 0, 10 do
				lib.GetKey()
				local str = JY.Person[t1]["姓名"].."＆"..JY.Person[t2]["姓名"].."    战意各自提升十点"
				local str2 = combo[i][3]
				Cls()
				DrawBox(150, CC.ScreenH / 3 + 30, CC.ScreenW - 150, CC.ScreenH / 3 * 2 - 20, C_BLACK)
				lib.PicLoadCache(1, gethead(t1) * 2, CC.ScreenW / 4 - 10, CC.ScreenH / 2 - 35, 1)
				lib.PicLoadCache(1, gethead(t2) * 2, CC.ScreenW / 4 + 90, CC.ScreenH / 2 - 35, 1)
				NewDrawString(-1, CC.ScreenH + 120, str, C_ORANGE, 25)	
				NewDrawString(CC.ScreenW / 2 * 3 - 150, -1, str2, C_GOLD, 50 + j)
				ShowScreen()							
				lib.Delay(10)	
			end		
			lib.Delay(100)	
		end
	end
end  
  
	for a = 0, WAR.PersonNum - 1 do --战意初始化
	local aa = WAR.Person[a]["人物编号"]
	--if aa == zj() then haszj = 1 end
    WAR.SPIRIT[aa] = 100
	WAR.SPIRITMAX[aa] = 140
	WAR.SPIRITMIN[aa] = 90
	
    if NF(aa) and juexing() > 2 then --聂风战意增加
		WAR.SPIRIT[aa] = 150	
		WAR.SPIRITMIN[aa] = 100		
		WAR.SPIRITMAX[aa] = 200	
	end		
	
    if BJY(aa) and juexing() > 1 then --步惊云战意增加
		WAR.SPIRIT[aa] = 150	
		WAR.SPIRITMIN[aa] = 100		
		WAR.SPIRITMAX[aa] = 200	
	end
   
    if DT(aa,582) and JX(aa) then --木婉清战意增加
    	WAR.SPIRIT[aa] = 100	
		WAR.SPIRITMIN[aa] = 100		
		WAR.SPIRITMAX[aa] = 200
    end
	
	if DT(aa, 112) then --萧远山战意增加
		WAR.SPIRIT[aa] = 120	
		WAR.SPIRITMIN[aa] = 100		
		WAR.SPIRITMAX[aa] = 170	
	end	
	
	if DT(aa, 50) then --萧远山战意增加
		WAR.SPIRIT[aa] = 120	
		WAR.SPIRITMIN[aa] = 120		
		WAR.SPIRITMAX[aa] = 200	
	end	
	
	if DT(aa, 70) then --玄慈战意增加
		WAR.SPIRITMAX[aa] = 170
	end
	
	if wglw2(aa,199) and PersonKF(aa,199) then
		WAR.SPIRITMIN[aa] = WAR.SPIRITMIN[aa] + 10		
		WAR.SPIRITMAX[aa] = WAR.SPIRITMAX[aa] + 10
		if MPPD(aa) == 15 then
			WAR.SPIRITMIN[aa] = WAR.SPIRITMIN[aa] + 10		
			WAR.SPIRITMAX[aa] = WAR.SPIRITMAX[aa] + 10
		end
	end	
	
	if T1LEQ(aa) then
		if juexing() >= 1 then
			WAR.SPIRIT[aa] = 110	
		end
	end
	
    if WAR.XLGJ == 3 or WAR.XLGJ == 4 or WAR.XLGJ == 5 then  --降龙混劲加战意
		WAR.SPIRIT[pid] = WAR.SPIRIT[pid] + 5	
	end
	
	if DT(aa,582) and JX(aa) then --木婉清加战意
	   WAR.SPIRIT[aa] = WAR.SPIRIT[aa] + 5
	end
	   
	
    if PersonKF(aa, 186) then  --峨嵋九阳功
		WAR.SPIRIT[aa] = WAR.SPIRIT[aa] + 3	
		if PersonGT(aa, 186) then
			WAR.SPIRIT[aa] = WAR.SPIRIT[aa] + 5
		end		
	end	
	
	if JX(aa) then --觉醒人物战意增加
	    WAR.SPIRIT[aa] = WAR.SPIRIT[aa] + 10
		WAR.SPIRITMIN[aa] = WAR.SPIRITMIN[aa]+10
		if DT(aa, 49) then
		WAR.SPIRIT[aa] = WAR.SPIRIT[aa] + 10
		WAR.SPIRITMIN[aa] = WAR.SPIRITMIN[aa]+10
		elseif DT(aa,103) or DT(aa,595) then
		WAR.SPIRIT[aa] = WAR.SPIRIT[aa] + 10
		WAR.SPIRITMIN[aa] = WAR.SPIRITMIN[aa]+10
		elseif DT(aa,47) then
		WAR.SPIRIT[aa] = WAR.SPIRIT[aa] + 10
		WAR.SPIRITMIN[aa] = WAR.SPIRITMIN[aa]+10
		elseif DT(aa,48) then
		WAR.SPIRIT[aa] = WAR.SPIRIT[aa] + 10
		WAR.SPIRITMIN[aa] = WAR.SPIRITMIN[aa]+10
		elseif DT(aa,50) then
		WAR.SPIRIT[aa] = WAR.SPIRIT[aa] + 10
		WAR.SPIRITMIN[aa] = WAR.SPIRITMIN[aa]+10
		elseif DT(aa,51) then
		WAR.SPIRIT[aa] = WAR.SPIRIT[aa] + 10
		WAR.SPIRITMIN[aa] = WAR.SPIRITMIN[aa]+10
		elseif DT(aa,53) then
		WAR.SPIRIT[aa] = WAR.SPIRIT[aa] + 10
		WAR.SPIRITMIN[aa] = WAR.SPIRITMIN[aa]+10
	    elseif DT(aa,104) then
		WAR.SPIRIT[aa] = WAR.SPIRIT[aa] + 10
		WAR.SPIRITMIN[aa] = WAR.SPIRITMIN[aa]+10
		end
	end
	
	if DT(aa, 632) and JY.Person[zj()]["品德"] > 50 then --丁典战意
		zhanyi(aa, math.modf((JY.Person[zj()]["品德"] - 50) * 0.5), 1)
	end
	zhanyi(aa, jiazhanyi(aa), 1)
    end  
	
  	for i = 0, WAR.PersonNum - 1 do --小昭减敌人战意加自己战意
		local aa = WAR.Person[i]["人物编号"]
		if aa == 66 then
			for j = 0, WAR.PersonNum - 1 do
				local bb = WAR.Person[j]["人物编号"]
				if WAR.Person[i]["我方"] ~= WAR.Person[j]["我方"] then
					zhanyi(bb, -5)
				else
					zhanyi(bb, 5)
				end
			end
			break
		end
		if aa == 15 then
			for j = 0, WAR.PersonNum - 1 do
				local bb = WAR.Person[j]["人物编号"]
				if WAR.Person[i]["我方"] == WAR.Person[j]["我方"] then
					zhanyi(bb, 10)
				end
			end
			break		
		end
		if aa == 604 then
			for j = 0, WAR.PersonNum - 1 do
				local bb = WAR.Person[j]["人物编号"]
				if WAR.Person[i]["我方"] == WAR.Person[j]["我方"] then
					zhanyi(bb, 20)
				end
			end
			break		
		end
		if wglw(aa,121) or (DT(aa,59) and PersonKF(aa,121)) or (DT(aa,601) )then --17-3-3玉女经
			for j = 0, WAR.PersonNum - 1 do
				local bb = WAR.Person[j]["人物编号"]
				if WAR.Person[i]["我方"] ~= WAR.Person[j]["我方"] then
					zhanyi(bb, -10)
					WAR.QX1[bb] = 1
				end
			end
			break		
		end
	end
  
    fightcombo()
  
    if (WAR.ZDDH == 14 or WAR.ZDDH == 360) then
    say(CC.s42, 173, 0)   --妙风使
    say(CC.s43, 174, 1)   --流云使
    say(CC.s44, 175, 5)   --辉月使！Ｈ圣火三绝阵！
    for i = 80, 120 do
      NewDrawString(-1, -1, "圣火三绝阵", C_GOLD, i)
      ShowScreen()
      if i == 120 then
        Cls()
        NewDrawString(-1, -1, "圣火三绝阵", C_GOLD, i)
        ShowScreen()
        lib.Delay(300)
        WaitKey()
      else
        lib.Delay(1)
      end
    end
    end
  
	if WAR.ZDDH == 272 then
		if GetS(1, 1, 0, 1) == 1 then
			instruct_0()
			say("小畜生骂谁？",58,0,"杨过") 	
			instruct_0()
			say("小畜生骂你！",84,0,"霍都") 				
			instruct_0()
			say("不错，正是小畜生骂我！",58,0,"杨过") 	
			instruct_0()
			say("天下英雄请了，小王杀此顽童，那是他自取其咎，须怪不得小王。",84,0,"霍都") 		
			instruct_0()
			say("天下英雄请了，小顽童杀此王子，那是他自取其咎，须怪不得小顽童！",58,0,"杨过") 	
			instruct_0()				
		elseif GetS(1, 1, 0, 1) == 2 then
			instruct_0()
			say("小孩子，我来和你比武！",160,0,"达尔巴") 	
			instruct_0()			
		elseif GetS(1, 1, 0, 1) == 3 then

		end				
	end
  
    --MM特效
    for a = 0, WAR.PersonNum - 1 do
    if DT(WAR.Person[a]["人物编号"] , 92) and WAR.Person[a]["我方"] == true then
      WAR.LRZ = 1
    end
    end
  
    --武无敌在场敌方集气全体为0...
	for a = 0, WAR.PersonNum - 1 do
        if DT(WAR.Person[a]["人物编号"], 600) then
            if WAR.Person[a]["敌方"] == true then
                WAR.Person[a].Time = 0
            end
        end
    end

    for i = 1, 10 do
    JY.Wugong[80]["移动范围" .. i] = 3
    JY.Wugong[80]["杀伤范围" .. i] = 2
    JY.Wugong[113]["移动范围" .. i] = 4
    JY.Wugong[113]["杀伤范围" .. i] = 0
    end
    JY.Wugong[80]["攻击范围"] = 0
    JY.Wugong[113]["攻击范围"] = 3
    
  
    --密道成昆战，我方集气全体为0...
    if WAR.ZDDH == 237 then
    for a = 0, WAR.PersonNum - 1 do
      if WAR.Person[a]["我方"] == true then
        WAR.Person[a].Time = 0
      end
    end
    end
  
    --新华山论剑
    if WAR.ZDDH == 238 then
    for i = 80, 120 do
      NewDrawString(-1, -1, CC.EVB200, C_GOLD, i)
      ShowScreen()
      if i == 120 then
        Cls()
        NewDrawString(-1, -1, CC.EVB200, C_GOLD, i)
        ShowScreen()
        lib.Delay(300)
        WaitKey()
      else
        lib.Delay(1)
      end
    end
    end
  
    --豸苗：18铜人
    if WAR.ZDDH == 217 then 
    for i = 80, 120 do
      NewDrawString(-1, -1, "十八铜人阵", C_GOLD, i)
      ShowScreen()
      if i == 120 then
        Cls()
        NewDrawString(-1, -1, "十八铜人阵", C_GOLD, i)
        ShowScreen()
        lib.Delay(300)
        --WaitKey()
      else
        lib.Delay(1)
      end
    end
    end

    --天机盘龙
    if WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 and GetS(86, 2, 9, 5) == 3 then
      for i = 80, 120 do
      NewDrawString(-1, -1, "天机盘龙", C_GOLD, i)
      ShowScreen()
      if i == 120 then
        Cls()
        NewDrawString(-1, -1, "天机盘龙", C_GOLD, i)
        ShowScreen()
        lib.Delay(300)
        --WaitKey()
      else
        lib.Delay(1)
      end
	  end
    end

    --宗师
    if WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 and GetS(86, 2, 11, 5) == 3 then
      for i = 80, 120 do
      NewDrawString(-1, -1, "一代宗师", C_GOLD, i)
      ShowScreen()
      if i == 120 then
        Cls()
        NewDrawString(-1, -1, "一代宗师", C_GOLD, i)
        ShowScreen()
        lib.Delay(300)
        --WaitKey()
      else
        lib.Delay(1)
      end
	  end
    end

    --四神封绝
    if WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 and GetS(86, 2, 12, 5) == 3 then
		for i = 80, 120 do
		NewDrawString(-1, -1, "四神封绝", C_GOLD, i)
		ShowScreen()
		  if i == 120 then
			Cls()
			NewDrawString(-1, -1, "四神封绝", C_GOLD, i)
			ShowScreen()
			lib.Delay(300)
			--WaitKey()
		  else
			lib.Delay(1)
		  end
		end
		if JY.Person[0]["武功2"] == 91 and JY.Wugong[91]["名称"] == "六如隼龙诀" then --飞影彩蛋：真龙心法触发条件
			say("这是……六如隼龙诀！！！",220,0,"小二")
			say("看来，你已经掌握了龙之国度流传的苍龙的心法。",220,0,"小二")
			say("那么，且让我帮你觉醒真龙的血脉，以最强的姿态，迎接四神的挑战吧。",220,0,"小二")
			say("沸腾吧，龙之血脉！！！",220,0,"小二")
			JY.ZLXF = 1
			JY.Wugong[91]["名称"] = "赤血真龙诀"
			for i = 80, 120 do
				NewDrawString(-1, -1, "【赤血真龙诀】", C_RED, i)
				ShowScreen()
				if i == 120 then
					Cls()
					NewDrawString(-1, -1, "【赤血真龙诀】", C_RED, i)
					ShowScreen()
					lib.Delay(300)
					--WaitKey()
				else
					lib.Delay(1)
				end
			end
		end
    end
  
    if WAR.ZDDH >= 0 then 
    for a = 0, WAR.PersonNum - 1 do
    if jtyl(WAR.Person[a]["人物编号"]) then 
      for i = 40, 80 do
      NewDrawString(-1, -1, "九天一流 世间无悠", C_GOLD, i)
      ShowScreen()
      if i == 80 then
        Cls()
        NewDrawString(-1, -1, "九天一流 世间无悠", C_GOLD, i)
        ShowScreen()
        lib.Delay(400)
        --WaitKey()
      else
        lib.Delay(1)
      end
    end
	end
	end
    end  
  
    if WAR.ZDDH >= 0 then 
    for a = 0, WAR.PersonNum - 1 do
    if wssz(WAR.Person[a]["人物编号"]) then 
      for i = 40, 80 do
      NewDrawString(-1, -1, "万兽奔腾 蛮荒郡主", C_GOLD, i)
      ShowScreen()
      if i == 80 then
        Cls()
        NewDrawString(-1, -1, "万兽奔腾 蛮荒郡主", C_GOLD, i)
        ShowScreen()
        lib.Delay(400)
        --WaitKey()
      else
        lib.Delay(1)
      end
    end
	WAR.WSSZ=1
	end
	end
    end  
  
  
  
    if WAR.ZDDH >= 0 then
		--优化九阴领悟显示 天机弹出太多次了 start 20200501
		local JYTX = {}
		for a = 0, WAR.PersonNum - 1 do
			if (wglw(WAR.Person[a]["人物编号"],107) and PersonGT(WAR.Person[a]["人物编号"],107)) or DT(WAR.Person[a]["人物编号"],599) then 
				JYTX[#JYTX + 1] = a
			end
		end
		if #JYTX > 0 then
			Cls()
			local ssid = lib.SaveSur(0, 0, CC.ScreenW, CC.ScreenH)
			for ii = 1528, 1540 do
				for ji = 1, #JYTX do
					local jindex = JYTX[ji];
					--1355, 1365   1343,1353
					--for ii = 1574, 1578 do
					--for ii = 1610, 1616 do
					local x0 = WAR.Person[WAR.CurID]["坐标X"]
					local y0 = WAR.Person[WAR.CurID]["坐标Y"]
					local dx = WAR.Person[jindex]["坐标X"] - x0
					local dy = WAR.Person[jindex]["坐标Y"] - y0
					local rx = CC.XScale * (dx - dy) + CC.ScreenW / 2
					local ry = CC.YScale * (dx + dy) + CC.ScreenH / 2
					local hb = GetS(JY.SubScene, dx + x0, dy + y0, 4)
					if CONFIG.Zoom == 1 then
						hb = hb * 2
					end
					ry = ry - hb

					lib.PicLoadCache(3, ii, rx, ry, 0)
					DrawString(rx - 130, ry - 5, "九阴身法 蛇行狸翻", C_GOLD, 30)
				end
				ShowScreen()
				lib.Delay(40)
				lib.LoadSur(ssid, 0, 0)
			end
			lib.FreeSur(ssid)
		end
		--优化九阴领悟显示 天机弹出太多次了 end 20200501
	end
  
    if WAR.ZDDH >= 0 then 
        for a = 0, WAR.PersonNum - 1 do
            if DT(WAR.Person[a]["人物编号"], 600) then 
                for i = 40, 80 do
                    NewDrawString(-1, -1, "云游隐士 十强武者", C_GOLD, i)
                    ShowScreen()
                    if i == 80 then
                        Cls()
                        NewDrawString(-1, -1, "云游隐士 十强武者", C_GOLD, i)
                        ShowScreen()
                        lib.Delay(400)
                        --WaitKey()
                    else
                        lib.Delay(1)
                    end
                end
	        end
	    end
    end  
  
    if WAR.ZDDH >= 0 then 
        for a = 0, WAR.PersonNum - 1 do
            if DT(WAR.Person[a]["人物编号"], 583) then 
                for i = 40, 80 do
                    NewDrawString(-1, -1, "无双霸者 隐剑门主", C_GOLD, i)
                    ShowScreen()
                    if i == 80 then
                        Cls()
                        NewDrawString(-1, -1, "无双霸者 隐剑门主", C_GOLD, i)
                        ShowScreen()
                        lib.Delay(400)
                        --WaitKey()
                    else
                        lib.Delay(1)
                    end
                end
	        end
	    end
    end 

    if WAR.ZDDH >= 0 then 
        for a = 0, WAR.PersonNum - 1 do
            if DT(WAR.Person[a]["人物编号"], 617) then 
                for i = 40, 80 do
                    NewDrawString(-1, -1, "怡红公子 强势回归", C_GOLD, i)
                    ShowScreen()
                    if i == 80 then
                        Cls()
                        NewDrawString(-1, -1, "怡红公子 强势回归", C_GOLD, i)
                        ShowScreen()
                        lib.Delay(400)
                        --WaitKey()
                    else
                        lib.Delay(1)
                    end
                end
	        end
	    end
    end  

    if WAR.ZDDH >= 0 then 
        for a = 0, WAR.PersonNum - 1 do
            if KHT(WAR.Person[a]["人物编号"]) then 
                for i = 40, 80 do
                    NewDrawString(-1, -1, "魔葵降世 祸乱苍生", C_GOLD, i)
                    ShowScreen()
                    if i == 80 then
                        Cls()
                        NewDrawString(-1, -1, "魔葵降世 祸乱苍生", C_GOLD, i)
                        ShowScreen()
                        lib.Delay(400)
                        --WaitKey()
                    else
                        lib.Delay(1)
                    end
                end
	        end
	    end
    end  

    --全真七子，天罡北斗阵
    if WAR.ZDDH == 73 then
  	for i = 80, 120 do
      NewDrawString(-1, -1, "天罡北斗阵", C_GOLD, i)
      ShowScreen()
      if i == 120 then
        Cls()
        NewDrawString(-1, -1, "天罡北斗阵", C_GOLD, i)
        ShowScreen()
        lib.Delay(300)
        --WaitKey()
      else
        lib.Delay(1)
      end
    end
    end
  
    if WAR.ZDDH == 331 then
  	for i = 80, 120 do
      NewDrawString(-1, -1, "五行八卦阵", C_GOLD, i)
      ShowScreen()
      if i == 120 then
        Cls()
        NewDrawString(-1, -1, "五行八卦阵", C_GOLD, i)
        ShowScreen()
        lib.Delay(300)
        --WaitKey()
      else
        lib.Delay(1)
      end
    end
    end
  
    --蓝烟清：新逆运走火，伤害、暴击率、连击率上升，七分失控
    for i = 0, WAR.PersonNum - 1 do
  	--敌人不会，已方才会走火失控
  	if inteam(WAR.Person[i]["人物编号"])and PersonKF(WAR.Person[i]["人物编号"], 107) == false then
	    if wglw(WAR.Person[i]["人物编号"],104) then --豸苗：逆运精义
		WAR.L_NYZH[WAR.Person[i]["人物编号"]] = nil
		elseif PersonKF(WAR.Person[i]["人物编号"], 104) then
  		WAR.L_NYZH[WAR.Person[i]["人物编号"]] = 1; --没有九阴，逆运走火
		end
  	end
    end
  	
    --显示战斗说明
    if CC.ShowWarInstruction == 1 then
	  local war_title = "战斗说明"
		local war_strtable = {{"胜利条件：","敌方全灭"},{"失败条件：","我方全灭"},{"奖励说明：","无"}};
		if WAR.ZDDH == 237 then
			war_strtable[1][2] = "撑过100个时序";
		elseif WAR.ZDDH == 76 then
			war_strtable[2][2] = "无";
			war_strtable[3][2] = "胜利可获得千年灵芝两个";
		elseif WAR.ZDDH == 80 then
			war_strtable[2][2] = "无";
			war_strtable[3][2] = "胜利可增加四项兵器值各十点";
		elseif WAR.ZDDH == 100 then
			war_strtable[2][2] = "无";
			war_strtable[3][2] = "胜利可获得天王保命丹两个";
		elseif WAR.ZDDH == 172 then
			war_strtable[2][2] = "无";
			war_strtable[3][2] = "胜利可获得蛤蟆功法";
		elseif WAR.ZDDH == 173 then
			war_strtable[2][2] = "无";
			war_strtable[3][2] = "胜利可获得天山雪莲两个";
		elseif WAR.ZDDH == 188 then
			war_strtable[2][2] = "无";
			war_strtable[3][2] = "胜利可增加拳掌功夫十点";
		elseif WAR.ZDDH == 211 then
			war_strtable[2][2] = "无";
			war_strtable[3][2] = "胜利可增加防御力、轻功各十点";
		elseif WAR.ZDDH == 86 then
			war_strtable[2][2] = "无";
			war_strtable[3][2] = "胜利后可获得化功大法";	
		elseif WAR.ZDDH == 75 or WAR.ZDDH == 4 then
			war_strtable[2][2] = "无";
			war_strtable[3][2] = "胜利后主角可获得50实战";	
		elseif WAR.ZDDH == 77 then
			QZXS(string.format("%s 实战增加%s点",JY.Person[0]["姓名"],30));
			war_strtable[2][2] = "无";
			war_strtable[3][2] = "胜利后主角可获得30实战";	
		elseif WAR.ZDDH > 42 and  WAR.ZDDH < 47 then
			QZXS(string.format("%s 实战增加%s点",JY.Person[0]["姓名"],20));
			war_strtable[2][2] = "无";
			war_strtable[3][2] = "胜利后主角可获得20实战";	
		elseif WAR.ZDDH == 161 then
			QZXS(string.format("%s 实战增加%s点",JY.Person[0]["姓名"],70));
			war_strtable[2][2] = "无";
			war_strtable[3][2] = "胜利后主角可获得70实战";			
		end
		  
		  if WAR.ZDDH ~= 226 then
			MyWarInstruce(war_title, war_strtable);
		  end
	end
  
    warStatus = 0
    buzhen()
    for i = 0,WAR.PersonNum-1 do --17-2-19-幻光步
		if (wglw(WAR.Person[i]["人物编号"],93) or (DT(WAR.Person[i]["人物编号"],66) and PersonKF(WAR.Person[i]["人物编号"],93))) and inteam(WAR.Person[i]["人物编号"]) then
			WAR.CurID = i
			WAR.ShowHead = 1
			--WAR.ShowHead = 1
			QZXS("请选择定位坐标")  -- DrawStrBox(CC.MainMenuX, CC.MainMenuY, CC.EVB183, C_GOLD, 30)
			War_CalMoveStep(WAR.CurID, 20, 1) --武功移动步数
			local nx, ny = nil, nil
			while true do
				nx, ny = War_SelectMove() --显示+选择步数
				if nx ~= nil then
					if lib.GetWarMap(nx, ny, 2) > 0 or lib.GetWarMap(nx, ny, 5) > 0 then
						QZXS(CC.EVB186)			--此处有人！请重新选择
					elseif CC.SceneWater[lib.GetWarMap(nx, ny, 0)] ~= nil then
						QZXS(CC.EVB187)		--水面，不可进入！请重新选择
					else
						QZXS("已定位坐标点")
						WAR.HGB[100+WAR.Person[i]["人物编号"]] = {nx,ny}
					WAR.ShowHead = 0
					break;
					end
				end
			end
		end
    end
    for i = 0,WAR.PersonNum-1 do--蛤蟆九天17-2-23
		if wglw(WAR.Person[i]["人物编号"],95) or ((DT(WAR.Person[i]["人物编号"],60) or DT(WAR.Person[i]["人物编号"],620)) and PersonKF(WAR.Person[i]["人物编号"],95)) then 
		   WAR.HMJT[WAR.Person[i]["人物编号"]] = 1000
		end
		if MP11(WAR.Person[i]["人物编号"]) then --17-3-1
		   WAR.CurID = i
		   WAR.ShowHead = 1
		   DHdisplay(2279, 2299, "秘剑演武 剑步谜影")
		   WAR.MJYW[WAR.Person[i]["人物编号"]] = 1
		end
		if wglw(WAR.Person[i]["人物编号"],105) or (DT(WAR.Person[i]["人物编号"],27) and PersonKF(WAR.Person[i]["人物编号"],105)) then 
		   WAR.KHYX[WAR.Person[i]["人物编号"]] = {WAR.Person[i]["坐标X"],WAR.Person[i]["坐标Y"]}
		end
		if MPPD(WAR.Person[i]["人物编号"]) == 9 then --唐门模式1
			local hh2 = JYMsgBox("攻击模式", "请选择攻击模式？", {"惊羽决", "天罗诡道"}, 2, WAR.Person[i]["人物编号"])	
			if hh2 <= 0 then
				return 0
			end	
			if hh2 == 1 then 
			WAR.TMMS[WAR.Person[i]["人物编号"]] = 1
			else 
			WAR.TMMS[WAR.Person[i]["人物编号"]] = 2 
			--acsj()
			end
			--WAR.TMMS[WAR.Person[i]["人物编号"]] = 1
		end
    end
    if haszj == 1 and putong() == 11 then
	Cls()
	if yesno("要试试手气吗？") then
		CC.PLJZ = {"攻击力", "防御力", "气攻值", "气防值", "连击率", "暴击率", "加力率", "护体率", "集气速度", "生命值", "内力值"}
		CC.PLJZ2 = {-20, -20, -20, -20, -10, -10, -10, -10, -2, -1, -3}
		local c, r, r2
		local s = {"", "", "", "", ""}
		local ratio = 3
		if juexing() > 0 then ratio = 5 end
		for j = 1, ratio do
			for i = 1, 15 do
				c = math.random(#CC.PLJZ)
				r = CC.PLJZ[c]
				while true do
					r2 = math.random(CC.PLJZ2[c], (-CC.PLJZ2[c]) * 3)
					if r2 ~= 0 then break end
				end
				s[j] = r
				if CC.PLJZ[c] == "生命值" or CC.PLJZ[c] == "内力值" then
					s[j] = s[j].."时序"
				end
				if r2 >= 0 then
					s[j] = s[j].."+"
				end
				s[j] = s[j]..r2
				if CC.PLJZ[c] == "集气速度" or CC.PLJZ[c] == "生命值" or CC.PLJZ[c] == "内力值" then
					s[j] = s[j] .."点"
				else
					s[j] = s[j] .."%"
				end	
				Cls()
				if ratio == 3 then
					tb2(s[1], nil, 180, nil, 50)
					tb2(s[2], nil, 250, nil, 50)
					tb2(s[3], nil, 320, nil, 50)	
				else
					tb2(s[1], nil, 110, nil, 50)
					tb2(s[2], nil, 180, nil, 50)
					tb2(s[3], nil, 250, nil, 50)
					tb2(s[4], nil, 320, nil, 50)	
					tb2(s[5], nil, 390, nil, 50)				
				end
				ShowScreen()
				lib.Delay(100 + i * 10)
			end
			WAR.PLJZ[CC.PLJZ[c]] = r2
			table.remove(CC.PLJZ, c)
			table.remove(CC.PLJZ2, c)
			WaitKey()
		end	
	end  
    end
  
    WAR.Delay = GetJiqi()
    local startt, endt = lib.GetTime()
    while true do
    WarDrawMap(0)
    WAR.ShowHead = 0
    DrawTimeBar()
    lib.GetKey()
    ShowScreen()
    if WAR.ZYHB == 1 then
	   if WAR.ZYHB3 == 1 and WAR.ZYHB2 == 1 then --左右三连
	   WAR.ZYHB = 1
	   WAR.ZYHB2 = 2
	   else 
       WAR.ZYHB = 2
	   end
    end
    if WAR.ZDDH == 83 then     --四帮主之战，乔峰用铁掌
      JY.Person[50]["武功1"] = 26
    end
    local reget = false
    
    
    for p = 0, WAR.PersonNum - 1 do
      if WAR.Person[p]["死亡"] == false and WAR.Person[p].Time > 1000 then
      	
        WarDrawMap(0)
        ShowScreen()
        local surid = lib.SaveSur(CC.ScreenW - 80, 0, CC.ScreenW, 200)
        lib.Delay(10)
        local keypress = lib.GetKey()
        if WAR.AutoFight == 1 and (keypress == VK_SPACE or keypress == VK_RETURN) then
          WAR.AutoFight = 0
        end
        lib.FreeSur(surid)
        reget = true
        local id = WAR.Person[p]["人物编号"]
        
        --左右触发之后，不可移动
        if WAR.ZYHB == 2 then
          WAR.Person[p]["移动步数"] = 0
        elseif WAR.L_NOT_MOVE[WAR.Person[p]["人物编号"]] ~= nil and WAR.L_NOT_MOVE[WAR.Person[p]["人物编号"]] >= 1 then
        	WAR.Person[p]["移动步数"] = 0
        	WAR.L_NOT_MOVE[WAR.Person[p]["人物编号"]] = nil
			WAR.QIZHEN[WAR.Person[p]["人物编号"]] = nil 
		elseif WAR.QJBMS[WAR.Person[p]["人物编号"]] ~= nil then 
            WAR.Person[p]["移动步数"] = 0	
			WAR.QIZHEN[WAR.Person[p]["人物编号"]] = nil
        else  --计算移动步数     	
          WAR.Person[p]["移动步数"] = math.modf((getnewmove(WAR.Person[p]["轻功"])) - JY.Person[id]["中毒程度"] / 50 - JY.Person[id]["受伤程度"] / 60 + JY.Person[id]["体力"] / 70 - 1)
          
		  if PersonKF(id, 93) then --nino 圣火+移动1
			WAR.Person[p]["移动步数"] = WAR.Person[p]["移动步数"] + 1
		  end
		  
		  if PersonKF(id, 118) and MPPD(id) == 8 then --瞬息千里移动+1
			WAR.Person[p]["移动步数"] = WAR.Person[p]["移动步数"] + 1
		  end
		  
		  if PersonKF(id, 192) and wglw2(id,192) then --金雁功领悟移动+3
			WAR.Person[p]["移动步数"] = WAR.Person[p]["移动步数"] + 7
		  end
		  
  		  if PersonKF(id, 119) and MPPD(id)== 3 then --沼跃鱼：古墓天罗
			WAR.Person[p]["移动步数"] = WAR.Person[p]["移动步数"] + MPDJ(id)*2
		  end
		  
		  if PersonKF(id, 119) and DT(id,161) and JX(id) then
			WAR.Person[p]["移动步数"] = WAR.Person[p]["移动步数"] + 4
		  end
		  
		  if PersonKF(id, 191) then
			local aa = math.modf(JY.Person[id]["内力"]/2000)
				if aa < 2 then aa = 2 end
				WAR.Person[p]["移动步数"] = WAR.Person[p]["移动步数"] + aa
		  end		
		  
		  if hasTF(id, 18) then
		  	WAR.Person[p]["移动步数"] = WAR.Person[p]["移动步数"] + 3
		  end
		
		  if JY.Person[id]["受伤程度"] >= 50 and not PersonKF(id, 191) then
			WAR.Person[p]["移动步数"] = WAR.Person[p]["移动步数"] -1
			 if JY.Person[id]["受伤程度"] == 100 then
			 WAR.Person[p]["移动步数"] = WAR.Person[p]["移动步数"] -1
			 end
		  end
		  
		  if id == 0 and putong() == 10 then
		  	WAR.Person[p]["移动步数"] = WAR.Person[p]["移动步数"] + 3
		  end
		  for j = 0, WAR.PersonNum - 1 do --小昭，敌人移步数少五格
		  	if DT(WAR.Person[j]["人物编号"], 66) and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[p]["我方"] then
		  		WAR.Person[p]["移动步数"] = WAR.Person[p]["移动步数"] - 5
		  	end
		  end
		  
		  for j = 0, WAR.PersonNum - 1 do --沼跃鱼:黄药师，敌人移步数少1格
		  	if DT(WAR.Person[j]["人物编号"], 57) and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[p]["我方"] then
		  		WAR.Person[p]["移动步数"] = WAR.Person[p]["移动步数"] - 3
			end
		   if (MPPD(WAR.Person[j]["人物编号"])==10 and PersonGT(WAR.Person[j]["人物编号"],6)) and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[p]["我方"] then
		  		WAR.Person[p]["移动步数"] = WAR.Person[p]["移动步数"] - math.modf(MPDJ(WAR.Person[j]["人物编号"]))
		  	end
           if  wglw1(WAR.Person[j]["人物编号"],33) then
		        WAR.Person[p]["移动步数"] = WAR.Person[p]["移动步数"] - 3
			end
		  end
		  if MPPD(id) == 9  then --唐门模式
		     WAR.Person[p]["移动步数"] = WAR.Person[p]["移动步数"] +5
		  end
		  if MPPD(id) == 10 and PersonGT(id,6) then --唐门模式
		     local aa=math.modf(JY.Person[id]["轻功"]/150)
		     WAR.Person[p]["移动步数"] = WAR.Person[p]["移动步数"] +MPDJ(id)*aa
		  end		  
		  if WAR.Person[p]["移动步数"] < 1 then
		  	WAR.Person[p]["移动步数"] = 1
		  end		  
		end
        
		local tmpmax = 15
		if PersonKF(id, 93) then --nino 圣火最大移动+1
			tmpmax = tmpmax + 1	
		end
		if PersonKF(id, 118) then --nino 瞬息千里最大移动+1
			tmpmax = tmpmax + 1			  
		end	
		if PersonKF(id, 192) and wglw2(id,192) then --金雁功领悟最大移动+3
			tmpmax = tmpmax + 7 
		end
		if MPPD(id) == 9 then --唐门模式
		    tmpmax = tmpmax + 5	
		end
		if MPPD(id) == 10 and PersonGT(id,6) then --唐门模式
		    local aa=math.modf(JY.Person[id]["轻功"]/100)
		    tmpmax = tmpmax +MPDJ(id)*aa
		end			  
		if PersonKF(id, 119) and MPPD(id)== 3 then --沼跃鱼：古墓天罗
			tmpmax = tmpmax + 1	 + MPDJ(id)*2
		end
		if PersonKF(id, 119) and DT(id,161) then --沼跃鱼：古墓天罗
			tmpmax = tmpmax + 1	 + 4
		end
		if PersonKF(id, 191) then
			local aa = math.modf(JY.Person[id]["内力"]/2000)
			if aa < 2 then aa = 2 end
			    tmpmax = tmpmax + aa
		end
		if wglw(id,186) and PersonGT(id,186) then --峨嵋九阳功
		    tmpmax = tmpmax + 5
		end	
		if MPPD(id) == 9 and PersonGT(id,6)then --唐门模式
		    WAR.Person[p]["移动步数"] = WAR.Person[p]["移动步数"] +5
		end

        --最大移动步数15
        if WAR.Person[p]["移动步数"] > tmpmax then
			WAR.Person[p]["移动步数"] = tmpmax
        end
        
		WAR.SHENGHUO[p] = WAR.Person[p]["移动步数"] --圣火再移动步数记录
        
        WAR.ShowHead = 0
        WarDrawMap(0)
        WAR.Effect = 0
        WAR.CurID = p
        WAR.Person[p].TimeAdd = 0
        local r = nil
        local pid = WAR.Person[WAR.CurID]["人物编号"] --pid = id here...
		
		--无酒不欢：增加一个战场剧情
		if WAR.WAWY == 0 then
			for i = 0, WAR.PersonNum - 1 do
				local wj = WAR.Person[i]["人物编号"]
				if DT(wj, 455) then
					for j = 0, WAR.PersonNum - 1 do
						if WAR.Person[j]["人物编号"] == 597 and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] then
							say("老公你饿吗？我去给你下面",597,1)
							WAR.Person[j]["死亡"] = true
							lib.SetWarMap(WAR.Person[j]["坐标X"], WAR.Person[j]["坐标Y"], 5, -1)
							lib.SetWarMap(WAR.Person[j]["坐标X"], WAR.Person[j]["坐标Y"], 2, -1)
							WarDrawMap(0)
							break
						end
					end
				end
			end
		end
        WAR.Defup[pid] = nil
        if DT3(pid , 53) then
          WAR.TZ_DY = 0 --段誉行动后回复凌波
        end
		if DT3(pid , 118) then
          WAR.LQSLB = 0 --豸苗：李秋水凌波
        end
        --蓝烟清：田伯光行动后回复状态
        if DT3(pid , 29) then
        	WAR.L_TBGZL = 0;
        end
        --以下是蓄力的描写
		if hasTF(pid, 67) then
			if JLSD(10, 30, pid) then
				DHdisplay(2301, 2317, "壁观真如・蓄力")
				WAR.Actup[pid] = 1 
			end
		end	
		
        if PersonGT(pid,182) then  --太极神功蓄力
			if JLSD(10, 60, pid) then
			    DHdisplay(305, 309, "太极神功・蓄力")		
			    WAR.Actup[pid] = 1
				if wglw1(pid,16) then
				WAR.tmp[3000 + pid] = (WAR.tmp[3000 + pid] or 0)  + 500
				end
			end 	
		end	
		
		if PersonKF(pid, 103) and WAR.LXXL[pid] ~= nil then
			DHdisplay(2301, 2317, "龙象之力・蓄力")
			WAR.Actup[pid] = 2 
		end
		
		if wglw(pid, 103) or (PersonGT(pid, 103) and (DT(pid, 62) or DT(pid, 594))) or (DT(pid, 662) and PersonKF(pid, 103)) then
			if JLSD(10, 40, pid) then
			    DHdisplay(2301, 2317, "龙象之力・蓄力")
				WAR.Actup[pid] = 2 
			end
		end
		
        if NF(pid) and juexing() > 2 then
			if JLSD(10, 60, pid) then
			    DHdisplay(1258, 1274, "魔念高涨・蓄势待发")
			    WAR.Actup[pid] = 1 
			end	
		end			
		
        if DT(pid,599) or wglw1(pid,11) then  --摧坚神爪领悟	
			if JLSD(10,45,pid) then
			    DHdisplay(837, 845, "摧坚神爪・五指发劲")
			    WAR.Actup[pid] = 1 	
			end	
		end	
		
        if wglw(pid,185) or (PersonGT(pid,185) and DT(pid,5)) or DT(pid,666) then
			if JLSD(10,45,pid) then
			    DHdisplay(305, 309, "武当九阳・运劲")
			    WAR.Actup[pid] = 1 	
			end	
		end			
		
		if wglw1(pid,83) then  --无上大力领悟	
			if JLSD(10,50,pid) then
			    DHdisplay(837, 845, "大力法相・力贯三千")
			    WAR.Actup[pid] = 1 	
			end	
		end
		
		if wglw1(pid,67) or (DT(pid, 1) and JX(pid)) or (DT(pid, 621) and JX(pid)) then  --胡刀领悟
			if JLSD(10,45,pid) or (JY.Person[pid]["武器"] == 43 and JLSD(10,65,pid)) then
			    DHdisplay(1258, 1274, "刀气灌注・铁碎牙变")
			    WAR.Actup[pid] = 1 	
			end	
		end
		
		if wglw1(pid,155) and WAR.ZKSY1 == 1 or DT(pid,665) then
		    DHdisplay(2301, 2317, "真空手印・贯通蓄力")
			WAR.Actup[pid] = 2
            WAR.ZKSY1 = 0				
		end
		
        if WAR.JWDF > 0 then
			if JLSD(10, 60, pid) then
			    WAR.Actup[pid] = 1 
			end	
		end					
		
		if DT3(pid, 1) then --胡斐飞狐指令重置
			WAR.HUFEI = 0
		end
		WAR.HUFEI = 0 --???
		WAR.QQDB = 0
		WAR.LINGGANG = 0
		if pid == 0 and T5BCF(0) then --白愁飞连击重置
			WAR.BCFLJ = 0 
		end
		
		if T9ZY(pid) then --赵云连击重置
			WAR.ZYLJ = 0 
		end		
		if WAR.DUIZHAO ~= 0 then 
		   WAR.DUIZHAO = 0 
		end
		
		if WAR.HEJI ~= 0 then 
		   WAR.HEJI = 0 
		end
		
		if T8LXY(pid) then --李逍遥重置
			WAR.LXYZLPD = 0
			--WAR.LXYXF = 0
			WAR.LXYJS = 0
			WAR.LXYJSTS = 0			
		end
		
		if DT(pid,69) and JX(pid) then --觉醒洪七重置
			WAR.HQGS = 0
			WAR.HQGSTS = 0
			WAR.HQGS2 = 0
            WAR.HQGSTS2 = 0			
		end
		
		if DT(pid,55) and JX(pid) then --觉醒郭靖重置
			WAR.HQGS3 = 0
			WAR.HQGSTS3 = 0		
		end
		
		if MPPD(pid)==13 then --李逍遥重置
			WAR.MJZB[pid] = 0
			WAR.MJZB2[pid] = 0			
		end
		
		
		if pid == 0 and T6XQS(0) then --萧秋水连击重置
			WAR.XQSLJ = 0
		end
		
		if DT3(pid, 91) then --青青大暴指令重置
			WAR.QQDB = 0
		end
		
		if DT3(pid, 76) then --王语嫣点破指令重置
			WAR.WYY = {}
		end
		
		if T5BCF(pid) then --白愁飞指令重置
			WAR.BCFZL = 0
		end
 
		if DT3(pid, 662) then --水镜灵罡指令重置
			WAR.LINGGANG = 0
		end
		
        if DT3(pid, 55) then --郭靖灵罡指令重置
			WAR.LINGGANG = 0
		end		
		
		if DT(pid,5) then 
		     WAR.JLDL = 0
		end	 
		local function zidong(p)
			if WAR.ZDDH == 299 and (p == 55 or p == 583 or p == 584) then
				return true
			end
			if WAR.ZDDH == 342 and CC.MatchAuto == 1 then
				return true
			end
			if WAR.CONFUSE[p] ~= nil and WAR.CONFUSE[p] > 0 then
				return true
			end
			return false
		end
		
        --if instruct_16(pid) and WAR.Person[p]["我方"] and WAR.tmp[1000 + pid] ~= 1 then
        --蓝烟清：新逆运，七分疯狂三分清醒
        --if inteam(pid) and WAR.Person[p]["我方"] then --如果在队伍也是我方，加雕？
        --if (inteam(pid) or WAR.NPC[pid] ~= nil) and WAR.Person[p]["我方"] then
		if WAR.Person[p]["我方"] then
			if zidong(pid) or (WAR.L_NYZH[pid] ~= nil and PersonGT(pid, 104) == false and T11CJR(pid) == false
				and math.random(10) < 8) or ((WAR.HOT[pid] or 0) >= 30 and not wglw1(pid,68)) or WAR.SSNS[pid] ~= nil or WAR.JSJY[200+pid] ~= nil or WAR.QJBMS[pid] ~= nil then	--剑势剑影
				r = War_Auto() --新逆运70%随机操作，主功体不随机
			elseif WAR.AutoFight == 0 then
				r = War_Manual()
			else
				r = War_Auto()
			end
		else
			r = War_Auto()
		end  
		
        --如果发动左右互搏
        if WAR.ZYHB == 1 then
			WAR.KMWD1=WAR.KMWD1+1
			for j = 0, WAR.PersonNum - 1 do
				WAR.Person[j].Time = WAR.Person[j].Time - 15
				if WAR.Person[j].Time > 990 then
				  WAR.Person[j].Time = 990
				end
			end
			WAR.Person[p].Time = 1005
			WAR.ZYYD = WAR.Person[p]["移动步数"]
			WAR.ZYHBP = p 
			if WAR.XDXX > 0 then
				DrawStrBox(-1, -1, CC.WARS4 .. WAR.XDXX, C_ORANGE, CC.DefaultFont)
				ShowScreen()
				lib.Delay(500)
				Cls()
				ShowScreen()
				WAR.XDXX = 0
			end
 			if WAR.GUDUXIXUE > 0 then --显示铁手吸血
				DrawStrBox(-1, -1, "嗜血蛊吸取生命" .. WAR.GUDUXIXUE, C_ORANGE, CC.DefaultFont)
				ShowScreen()
				lib.Delay(500)
				Cls()
				ShowScreen()
				WAR.GUDUXIXUE = 0
	        end  		  
 			if WAR.VAMPIRE[pid] ~= nil then 
				DrawStrBox(-1, -1, "吸取生命" .. WAR.VAMPIRE[pid], C_ORANGE, CC.DefaultFont)
				ShowScreen()
				lib.Delay(500)
				Cls()
				ShowScreen()
				WAR.VAMPIRE[pid] = 0
	        end  				
			WAR.QKNY = 0
			if not hasTF(pid, 83) and JY.Person[129]["生命"] <= 0 and WAR.WCY < 1 then
				JY.Person[129]["生命"] = 1
			end
			if not hasTF(pid, 83) and JY.Person[65]["生命"] <= 0 and WAR.WCY1 < 1 then
				JY.Person[65]["生命"] = 1
			end
	        if not hasTF(pid, 83) and JY.Person[618]["生命"] <= 0 and WAR.WCY2 < 1 then
	          JY.Person[618]["生命"] = 1
	        end
	        --if JY.Person[id]["生命"] <= 0 and wglw(id,90) then
	        --   JY.Person[id]["生命"] = 1
	        --end
	        --if JY.Person[id]["生命"] <= 0 and jtyl(id) then
	        --   JY.Person[id]["生命"] = 1
	        --end
			if not hasTF(pid, 83) and WAR.ZDDH == 128 then
				for i = 0, WAR.PersonNum - 1 do
					if WAR.Person[i]["人物编号"] == 553 and JY.Person[553]["生命"] <= 0 then
					WAR.YZB = 1
					WAR.FXDS[553] = nil
					WAR.LXZT[553] = nil
					end
				end
				if WAR.YZB == 1 then
					if WAR.YZB2 < 3 then
						WAR.YZB = 0
						WAR.YZB2 = WAR.YZB2 + 1
						say(CC.WARS5, 553)
						JY.Person[553]["生命最大值"] = JY.Person[553]["生命最大值"] + 100
						JY.Person[553]["内力最大值"] = JY.Person[553]["内力最大值"] + 1000
						JY.Person[553]["生命"] = JY.Person[553]["生命最大值"]
						JY.Person[553]["内力"] = JY.Person[553]["内力最大值"]
						JY.Person[553]["中毒程度"] = 0
						JY.Person[553]["受伤程度"] = 0
						JY.Person[553]["体力"] = 100
						JY.Person[553]["攻击力"] = JY.Person[553]["攻击力"] + 100
						JY.Person[553]["防御力"] = JY.Person[553]["防御力"] + 100
						JY.Person[553]["轻功"] = JY.Person[553]["轻功"] + 80
						JY.Person[553]["武功1"] = 66
						JY.Person[553]["武功等级1"] = 999
						for j = 0, WAR.PersonNum - 1 do
						  if WAR.Person[j]["人物编号"] == 553 then
							WAR.Person[j].Time = 980
						  end
						end
					else
						if WAR.YZB3 == 0 then
							say(CC.WARS6, 553)
							say(CC.WARS7)
							say(CC.WARS8)
							WAR.YZB3 = 1
						end
					end
				end
			end
			if WAR.YJ > 0 then
				instruct_2(174, WAR.YJ)
				WAR.YJ = 0
			end
		 --steal
			for i=1,WAR.ZHUJUETDNUM do
				if WAR.ZHUJUETD[i]~=nil then
					instruct_2(WAR.ZHUJUETD[i], 1)
					WAR.ZHUJUETD[i]=nil
				end
			end
			WAR.ZHUJUETDNUM = 0
        else
	        if WAR.ZYHB == 2 then
	          WAR.ZYHB = 0
	        end
	        if wglw1(pid,77) or ((DT(pid,605) or DT(pid,627))and JX(pid)) then
				WAR.DJHB1[pid] = nil
				WAR.DJHB2[pid] = nil
				WAR.DJHB3[pid] = nil
			end	
	        WAR.Person[p].Time = WAR.Person[p].Time - 1000 --回合结束恢复集气
	        if WAR.Person[p].Time < -500 then
	          WAR.Person[p].Time = -500
	        end
        
	        --血刀吸血
	        if WAR.XDXX > 0 then
	          WAR.Person[WAR.CurID]["生命点数"] = WAR.XDXX;
	          War_Show_Count(WAR.CurID, CC.WARS4);
	          WAR.XDXX = 0
	        end
			
			if WAR.VAMPIRE[pid] ~= nil then
				WAR.Person[WAR.CurID]["生命点数"] = WAR.XDXX;
				War_Show_Count(WAR.CurID, "吸取生命");				
				WAR.VAMPIRE[pid] = nil
			end	
			
			--显示血手吸血
			if WAR.XIXUE > 0 then
	          WAR.Person[WAR.CurID]["生命点数"] = WAR.XIXUE;
	          --War_Show_Count(WAR.CurID);
	          WAR.XIXUE = 0
	        end
			
 			if WAR.GUDUXIXUE > 0 then --显示铁手吸血
	          WAR.Person[WAR.CurID]["生命点数"] = WAR.GUDUXIXUE;
	          War_Show_Count(WAR.CurID, "嗜血蛊吸取生命");
	          WAR.GUDUXIXUE = 0
	        end       			
			
			if WAR.DFWMXX > 0 then --东方未明刀系特技吸血
				WAR.Person[WAR.CurID]["生命点数"] = WAR.DFWMXX;
				War_Show_Count(WAR.CurID, "吞天噬日吸取生命");
				WAR.DFWMXX = 0
			end
			
			if WAR.TQSLW > 0 then --沼跃鱼：滕青山狼吻吸血
				WAR.Person[WAR.CurID]["生命点数"] = WAR.TQSLW;
				War_Show_Count(WAR.CurID, "狼吻吸取生命");
				WAR.TQSLW = 0
			end
			
			if pid == WAR.AXL then --武骧金星：清空阿修罗标志
				WAR.AXL = -1
			end
		
	        --罗汉伏魔功 每回合回复生命10% 主功体20%
			if PersonKF(pid, 96) and JY.Person[pid]["生命"] > 0 and WAR.XUEMO[pid] == nil
				and JY.Person[pid]["生命"] < JY.Person[pid]["生命最大值"]
				and JY.Person[pid]["生命"] < 1500 then
				local mm = 1500
				if JY.Person[pid]["生命最大值"] < 1500 then
					mm = JY.Person[pid]["生命最大值"]
				end
				local LK = nil
				if PersonGT(pid, 96) then
					LK = math.modf((mm - JY.Person[pid]["生命"]) * 0.2)
				else
					LK = math.modf((mm - JY.Person[pid]["生命"]) * 0.1)
				end
				if not inteam (pid) then
					LK = LK + math.random (50)
				end
				AddPersonAttrib(pid, "生命", LK)
				DrawStrBox(-1, -1, CC.WARS9 .. LK, C_ORANGE, CC.DefaultFont)
				ShowScreen()
				lib.Delay(400)
				Cls()
				ShowScreen()			
			end
	        
            --神足经 每回合回复生命10% 主功体20%
			if PersonKF(pid, 188) and JY.Person[pid]["生命"] > 0 and WAR.XUEMO[pid] == nil
				and JY.Person[pid]["生命"] < JY.Person[pid]["生命最大值"]
				and JY.Person[pid]["生命"] < 1500 then
				local mm = 1500
				if JY.Person[pid]["生命最大值"] < 1500 then
					mm = JY.Person[pid]["生命最大值"]
				end
				local LK = nil
				if PersonGT(pid, 188) then
					LK = math.modf((mm - JY.Person[pid]["生命"]) * 0.2)
				else
					LK = math.modf((mm - JY.Person[pid]["生命"]) * 0.1)
				end
				if not inteam (pid) then
					LK = LK + math.random (50)
				end
				AddPersonAttrib(pid, "生命", LK)
				DrawStrBox(-1, -1, CC.WARS138 .. LK, C_ORANGE, CC.DefaultFont)
				ShowScreen()
				lib.Delay(400)
				Cls()
				ShowScreen()			
			end			
			
			--崆峒长老
            if MPPD(pid) == 18 and MPDJ(pid) >= 4 and JY.Person[pid]["生命"] > 0 and PersonGT(pid,189) and WAR.XUEMO[pid] == nil
				and JY.Person[pid]["生命"] < JY.Person[pid]["生命最大值"]
				and JY.Person[pid]["生命"] < 1500  then 		
				local mm = 2000
				if JY.Person[pid]["生命最大值"] < 1500 then
					mm = JY.Person[pid]["生命最大值"]
				end
				local LK = nil
				LK = math.modf((mm - JY.Person[pid]["生命"]) * 0.3)
				if not inteam (pid) then
					LK = LK + math.random (50)
				end
				AddPersonAttrib(pid, "生命", LK)
				DrawStrBox(-1, -1, CC.WARS136 .. LK, C_ORANGE, CC.DefaultFont)
				ShowScreen()
				lib.Delay(400)
				Cls()
				ShowScreen()			
			end	
			
			if DT(pid, 3) then --苗人凤行动后恢复生命体力
				WAR.Person[WAR.CurID]["生命点数"] = AddPersonAttrib(pid, "生命", math.random(50, 100))
				WAR.Person[WAR.CurID]["体力点数"] = AddPersonAttrib(pid, "体力", math.random(5));
				local str=""
				if JX(pid) then
				local mm = 1500
				if JY.Person[pid]["生命最大值"] < 1500 then
					mm = JY.Person[pid]["生命最大值"]
				end
				local LK = nil
				LK = math.modf((mm - JY.Person[pid]["生命"]) * 0.2)
				WAR.Person[WAR.CurID]["生命点数"]=WAR.Person[WAR.CurID]["生命点数"]+AddPersonAttrib(pid, "生命", LK)
				str="苗家凤舞剑修复生机"
				end
				War_Show_Count(WAR.CurID,str)
			end
			
			if PersonKF(pid,198) then --苗人凤行动后恢复生命体力
				local aa = JY.Person[pid]["品德"] 
				if aa <35 then aa = 35 end 
				if JLSD(10,aa,pid) then
					WAR.Person[WAR.CurID]["生命点数"] = (WAR.Person[WAR.CurID]["生命点数"] or 0) + AddPersonAttrib(pid, "生命", 100)
					--str="君子风"
				end
				--War_Show_Count(WAR.CurID,str)
			end
			
			if (DT(pid,9) or wglw(pid,106)) and PersonGT(pid,106) then
				local jynl = math.modf((JY.Person[pid]["内力最大值"] or 0)*0.3)
				if JY.Person[pid]["内力"] < jynl then
					JY.Person[pid]["内力"] = jynl
					WAR.Person[WAR.CurID]["内力点数"] = jynl
				end
			end
			if WAR.NBH[pid] ~= nil then
				WAR.NBH[pid] = nil
			end
			if WAR.NHH[pid] ~= nil then
				WAR.NHH[pid] = nil
			end
			
			if WAR.YQHT[pid] == 2 then
				WAR.YQHT[pid] = nil 
			end
			--昆仑门人昆仑道罡
			if MPPD(pid) == 19 and PersonGT(pid,204) then
				local aa = math.random(2)
				if aa == 1 then
					WAR.KLDG[pid] = (WAR.KLDG[pid] or 0) + math.modf(sixi(pid,2)/5)
				elseif aa == 2 then
					WAR.KLDG[pid] = (WAR.KLDG[pid] or 0) + math.modf(sixi(pid,3)/5)
				end
				if WAR.KLDG[pid] ~= nil and WAR.KLDG[pid] > 5000 then
					WAR.KLDG[pid] = 5000
				end	
			end	
			
			if MPPD(pid) == 4 then
				if JLSD(10,40,pid) then
					if PersonGT(pid,182) then
						local qbg = math.modf(sixi(pid,1)/10)
						WAR.BG[pid] = (WAR.BG[pid] or 0) + qbg
						WAR.WJ[pid] = (WAR.WJ[pid] or 0) + qbg
					end
					if PersonGT(pid,99) then
						local jbg = math.modf(sixi(pid,2)/10)
						WAR.BG[pid] = (WAR.BG[pid] or 0) + jbg
						WAR.WJ[pid] = (WAR.WJ[pid] or 0) + jbg
					end
				else
					if WAR.BG[pid] ~= nil and WAR.BG[pid] < 1 then
						WAR.BG[pid] = nil
					end
					if WAR.WJ[pid] ~= nil and WAR.WJ[pid] < 1 then
						WAR.WJ[pid] = nil
					end		
				end
			end	
			
			if WAR.TZQJ12[pid] == 1 then
				WAR.TZQJ12[pid] = nil
			end	
			
			if WAR.TZQJ13[pid] == 1 then
				WAR.TZQJ13[pid] = nil
			end	
			
			if WAR.LXZS[pid] ~= nil then
				WAR.LXZS[pid] = nil
			end	
			
			if WAR.TZQJ4[pid] ~= nil then
				WAR.TZQJ4[pid] = WAR.TZQJ4[pid] - 1
				if WAR.TZQJ4[pid] < 1 then
					WAR.TZQJ4[pid] = nil
				end
			end	
			
			if WAR.PJTX == 1 then
				WAR.PJTX = 0
			end	
			
            if WAR.TLHD == 1 then
				WAR.TLHD = 0
			end 				
			
			if WAR.ZDDH == 166 and DT(pid, 455) then --武骧金星：无酒不欢
				say("哈哈，我去也！",35,0,"无酒不欢")
				WAR.Person[WAR.CurID]["死亡"] = true
			end
			
			if WAR.ZDDH == 166 and DT(pid, 457) then --凡总龙门
				say("小子，我们山水有相逢，下次再见，哈哈哈！",258,0,"紫落梵")
				WAR.Person[WAR.CurID]["死亡"] = true
			end
		
            if WAR.ZDDH == 166 and DT(pid, 456) then --安七龙门
				say("没意思，走了！",579,0,"安七")
				WAR.Person[WAR.CurID]["死亡"] = true
			end		
		
			if pid == 0 and putong() == 10 then
				WAR.LKZX = 0
				local jl = math.modf(JY.Person[pid]["实战"] / 20)
				if JLSD(10, 30 + jl, pid) then
					DHdisplay(2704, 2730, "长风破浪会有时 直挂云帆济沧海")					
					if juexing() > 0 then
						WAR.LKZX = 3 + math.random(5) + math.modf(JY.Person[pid]["实战"] / 50)
					else
						WAR.LKZX = math.random(5) + math.modf(JY.Person[pid]["实战"] / 50)
					end
				end
			end
			
			if pid == 0 and putong() == 8 and JY.Person[pid]["中毒程度"] > 0 then
				local ratio = 1
				if juexing() > 0 then
					ratio = 2
					for j = 0, WAR.PersonNum - 1 do
						local tmppid = WAR.Person[j]["人物编号"]
						if WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and 
							not WAR.Person[j]["死亡"] and RealJL(WAR.CurID, j, 5) then
							AddPersonAttrib(tmppid, "内力", -500)
						end
					end
				end
				local h = math.modf(JY.Person[pid]["中毒程度"] * 0.5 * ratio)
				local m = math.modf(JY.Person[pid]["中毒程度"] * 1.5 * ratio)
				local s = math.modf(JY.Person[pid]["中毒程度"] * ratio)
				WAR.Person[WAR.CurID]["生命点数"] = AddPersonAttrib(pid, "生命", h)
				WAR.Person[WAR.CurID]["内力点数"] = AddPersonAttrib(pid, "内力", m)
				WAR.Person[p].Time = WAR.Person[p].Time + s
				War_Show_Count(WAR.CurID)
			end
			
            if PersonKF(pid, 181) then  --玄武真功回内
	            local NK = nil
				if PersonGT(pid, 181) then
					NK = math.modf((JY.Person[pid]["内力最大值"] - JY.Person[pid]["内力"]) * 0.4)
				else
					NK = math.modf((JY.Person[pid]["内力最大值"] - JY.Person[pid]["内力"]) * 0.25)
				end
				AddPersonAttrib(pid, "内力", NK);
	            DrawStrBox(-1, -1, CC.WARS133 .. NK, C_ORANGE, CC.DefaultFont)
	            ShowScreen()
	            lib.Delay(400)
	            Cls()
	            ShowScreen()	          
	        end			
			
            if PersonGT(pid, 182) then  --太极神功回内
	            local NK = nil
				if PersonGT(pid, 181) then
					NK = math.modf((JY.Person[pid]["内力最大值"] - JY.Person[pid]["内力"]) * 0.2)
				else
					NK = math.modf((JY.Person[pid]["内力最大值"] - JY.Person[pid]["内力"]) * 0.15)
				end
				AddPersonAttrib(pid, "内力", NK);
	            DrawStrBox(-1, -1, CC.WARS135 .. NK, C_ORANGE, CC.DefaultFont)
	            ShowScreen()
	            lib.Delay(400)
	            Cls()
	            ShowScreen()	          
	        end				
			
	        --紫霞神功 每回合回复消耗的10%-20%内力
	        if PersonKF(pid, 89) then
	            local NK = nil
				if PersonGT(pid, 89) then
					NK = math.modf((JY.Person[pid]["内力最大值"] - JY.Person[pid]["内力"]) * 0.2)
				else
					NK = math.modf((JY.Person[pid]["内力最大值"] - JY.Person[pid]["内力"]) * 0.1)
				end
				AddPersonAttrib(pid, "内力", NK);
	            DrawStrBox(-1, -1, CC.WARS10 .. NK, C_ORANGE, CC.DefaultFont)
	            ShowScreen()
	            lib.Delay(400)
	            Cls()
	            ShowScreen()	          
	        end	
			
            --神足经 每回合回复消耗的10%-20%内力
	        if PersonKF(pid, 188) then
	            local NK = nil
				if PersonGT(pid, 188) then
					NK = math.modf((JY.Person[pid]["内力最大值"] - JY.Person[pid]["内力"]) * 0.2)
				else
					NK = math.modf((JY.Person[pid]["内力最大值"] - JY.Person[pid]["内力"]) * 0.1)
				end
				AddPersonAttrib(pid, "内力", NK);
	            DrawStrBox(-1, -1, CC.WARS139 .. NK, C_ORANGE, CC.DefaultFont)
	            ShowScreen()
	            lib.Delay(400)
	            Cls()
	            ShowScreen()	          
	        end				
			
            --崆峒长老
			if MPPD(pid) == 18 and MPDJ(pid) >= 4 and PersonGT(pid,189) then	
				local NK = nil
				NK = math.modf((JY.Person[pid]["内力最大值"] - JY.Person[pid]["内力"]) * 0.35)
				AddPersonAttrib(pid, "内力", NK);
	            DrawStrBox(-1, -1, CC.WARS137 .. NK, C_ORANGE, CC.DefaultFont)
	            ShowScreen()
	            lib.Delay(400)
	            Cls()
	            ShowScreen()	      
			end		
			
            --神足经恢复体力
			if PersonKF(pid, 188) then
	            WAR.Person[WAR.CurID]["体力点数"] = AddPersonAttrib(pid, "体力", 1);		
				if PersonGT(pid, 188) then
	                WAR.Person[WAR.CurID]["体力点数"] = AddPersonAttrib(pid, "体力", 2);	
				end
			end				
			
	        --混元功每回合回复体力3和内伤
			if PersonKF(pid, 90) then
	            local TK = nil
				local NS = nil
	            local ZD = 0
	            TK = 3
				NS = 5 + math.modf(JY.Person[pid]["受伤程度"]/10)
	            WAR.Person[WAR.CurID]["体力点数"] = AddPersonAttrib(pid, "体力", TK);
				AddPersonAttrib(pid, "内力", 100);
				AddPersonAttrib(pid, "受伤程度", -NS)
				if PersonGT(pid, 90) then --混元主功体恢复内力150 体力7
				    if XYL(pid) or jtyl(pid) then 
					AddPersonAttrib(pid, "内力", 500);
					WAR.Person[WAR.CurID]["体力点数"] = AddPersonAttrib(pid, "体力", 10);
					AddPersonAttrib(pid, "受伤程度", -10)
					else
					AddPersonAttrib(pid, "内力", 150);
					WAR.Person[WAR.CurID]["体力点数"] = AddPersonAttrib(pid, "体力", 7);
					AddPersonAttrib(pid, "受伤程度", -5)
					end
				end
	            War_Show_Count(WAR.CurID, CC.WARS11);	          
	        end
			if (XYL(pid) or jtyl(pid)) and PersonGT(pid, 180) then
					AddPersonAttrib(pid, "内力", 500);
					WAR.Person[WAR.CurID]["体力点数"] = AddPersonAttrib(pid, "体力", 10);
					AddPersonAttrib(pid, "受伤程度", -10)
			end
			if PersonGT(pid, 99) then --纯阳主功体 恢复受伤10
				AddPersonAttrib(pid, "受伤程度", -10)
			end
			
            if (wglw(pid,105) and PersonKF(pid, 105)) or (PersonKF(pid, 105) and (DT(pid, 455))) or DT(pid,617) then		--葵花领悟恢复体力
				WAR.Person[WAR.CurID]["体力点数"] = AddPersonAttrib(pid, "体力", 6);
            end	
			
            if (wglw(pid,106) and PersonGT(pid, 106)) or (PersonGT(pid, 106) and (DT(pid, 9))) then		--九阳领悟恢复体力
				WAR.Person[WAR.CurID]["体力点数"] = AddPersonAttrib(pid, "体力", 10);
            end				
			
            if PersonGT(pid,182) then  --太极神功恢复体力、内伤
				WAR.Person[WAR.CurID]["体力点数"] = AddPersonAttrib(pid, "体力", 5);
				AddPersonAttrib(pid, "受伤程度", -15)
            end							
			
            if PersonGT(pid,184) or DT(pid,665) then  --瑜伽密乘恢复体力
				WAR.Person[WAR.CurID]["体力点数"] = AddPersonAttrib(pid, "体力", 6);
            end				
			
			if WAR.TDZX1 == 1 and wglw(pid,153) then  --恢复体力
				WAR.Person[WAR.CurID]["体力点数"] = AddPersonAttrib(pid, "体力", 3);
            end
			
            if T2SQ(pid) then 
				WAR.Person[WAR.CurID]["体力点数"] = AddPersonAttrib(pid, "体力", 4);
			end				
			
			if PersonGT(pid, 6) and MPPD(pid)==10 then --沼跃鱼：桃花岛碧海潮生主功体触发东临碣石效果
				local XK = nil
				local NK = nil
				local NS = nil
				local mpdj=MPDJ(pid)*0.1
	            XK = (1000+WAR.XKZ*100) * mpdj
				NK = XK*3
				NS = 5 + math.modf(JY.Person[pid]["受伤程度"]/10)
				AddPersonAttrib(pid, "生命", XK);
				AddPersonAttrib(pid, "内力", NK);
				AddPersonAttrib(pid, "受伤程度", -NS);
				DHdisplay(1777, 1789, "东临碣石.万川归海");
			end
	        
			if DT(pid, 103) or DT(pid, 595)  then--迦楼罗回火
			  if  (JLSD(20,70,pid) and ZYBF(pid)) or JLSD(20,50,pid) then
   				local XK = nil
				local NK = nil
				local NS = nil
	            XK = WAR.LLH
				NK = WAR.LLH*5
				NS = math.modf(WAR.LLH/10)
				local HH=XK*3
				AddPersonAttrib(pid, "生命", XK);
				AddPersonAttrib(pid, "内力", NK);
				AddPersonAttrib(pid, "受伤程度", -NS);
				DHdisplay(2165, 2182, "迦楼罗虹吸固元回本");
				WAR.Person[p].Time = WAR.Person[p].Time + HH
				DHdisplay(2151, 2165, "琉璃焰回火真诀");
	            WAR.LLH=0
			else
			    WAR.LLH=0
            end
			end
			
			 if DT(pid,47) and JX(pid) then--阿紫苦痛汲取
			   if WAR.AZ > 0 then
					local XK = nil
					local NK = nil
					local NS = nil
					XK = math.modf(WAR.AZ/10)
					NK = math.modf(WAR.AZ/1.5)
					NS = math.modf(WAR.AZ/40)
					AddPersonAttrib(pid, "生命", XK);
					AddPersonAttrib(pid, "内力", NK);
					AddPersonAttrib(pid, "受伤程度", -NS);
					DHdisplay(2664, 2680, "紧那罗苦痛汲取");
					WAR.AZ=0
			   else
					WAR.AZ=100 
			   end
			end
			
			 if DT(pid, 53) and JX(pid) and WAR.LMJQ1>=0 then
				local lqz=WAR.LMJQ1
				local XK = 1000 * lqz*0.01
				if XK>=200 then
				XK=200
				end
				local NS = 5 + math.modf(JY.Person[pid]["受伤程度"]/10)
				AddPersonAttrib(pid, "生命", XK);
				AddPersonAttrib(pid, "受伤程度", -NS);
				DHdisplay(770, 783, "龙气调理");
			end

            if DT(id, 161) and WAR.LMC == 1 then --李莫愁			
				DIYdisplay("赤炼仙子・冰魄银针", M_PaleGreen)
				local tmpanqi = JY.Person[pid]["暗器技巧"]				
				War_ExecuteMenu(4, 34)
				JY.Person[id]["暗器技巧"] = tmpanqi
				WAR.LMC = 0
			end
			
        	if DT(id, 601) and WAR.LMC == 1 then --李莫愁冰魄银针
				DIYdisplay("古墓真传・寒玉飞针", M_Blue)
				local tmpanqi = JY.Person[pid]["暗器技巧"]
				War_ExecuteMenu(4, 34)
				JY.Person[id]["暗器技巧"]=tmpanqi+5
				if JY.Person[id]["暗器技巧"]>= 999 then----
				JY.Person[id]["暗器技巧"]=999
				end
				WAR.LMC = 0
			end			  

			if DT(id,153) and JX(id) and WAR.LMC == 1  then --赵半山觉醒后追加攻击一
                DIYdisplay("千臂如来・银龙翔空", M_Cyan)
				local tmpanqi = JY.Person[pid]["暗器技巧"]
                War_ExecuteMenu(4, 34)
				WAR.LMC = 0
				JY.Person[pid]["暗器技巧"]=tmpanqi+5
				if JY.Person[pid]["暗器技巧"]>= 999 then----
				JY.Person[pid]["暗器技巧"]=999
				end
			end
  
			if DT(id,153) and JX(id)  and WAR.LMC == 2  then --赵半山觉醒后追加攻击一
				DIYdisplay("千臂如来・群龙天舞", C_RED)
				local tmpanqi = JY.Person[pid]["暗器技巧"]
                 War_ExecuteMenu(4, 34)
            for j = 0, WAR.PersonNum - 1 do
			  if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
				JY.Person[WAR.Person[j]["人物编号"]]["生命"] = JY.Person[WAR.Person[j]["人物编号"]]["生命"] - 80
				if JY.Person[WAR.Person[j]["人物编号"]]["生命"] <= 0 then
					JY.Person[WAR.Person[j]["人物编号"]]["生命"] = 1
				end
			  end
			end			
				WAR.LMC = 0
				JY.Person[pid]["暗器技巧"]=tmpanqi+5
				if JY.Person[pid]["暗器技巧"]>= 999 then----
				JY.Person[pid]["暗器技巧"]=999
				end
      end
  
    if DT(id,153) and JX(id)  and WAR.LMC == 3  then --赵半山觉醒后追加攻击一
		DIYdisplay("千臂如来・毒龙击贼", M_Blue)
		local tmpanqi = JY.Person[pid]["暗器技巧"]
        War_ExecuteMenu(4, 34)
		WAR.QFY1[pid] = WAR.QFY1[pid] or 0 +math.modf(tmpanqi/10)
		WAR.LMC = 0
		JY.Person[pid]["暗器技巧"]=tmpanqi+5
		if JY.Person[pid]["暗器技巧"]>= 999 then----
			JY.Person[pid]["暗器技巧"]=999
		end
    end
	
	if DT(id, 129) and WAR.WCY3 > 0 then
	    WAR.WCY3 = WAR.WCY3 - 1   --沼跃鱼：重阳真打
	    if WAR.WCY3==0 then
	        local s=WAR.CurID
	        WAR.CurID=p
	        DHdisplay(1258, 1275, "北斗装攻.收招")
	        JY.Person[id]["内力"] = JY.Person[id]["内力最大值"]
	        JY.Person[id]["生命"] = JY.Person[id]["生命最大值"]
	        WAR.CurID = s
	    end
	end
	
	if (DT(id, 65) or MPPD(id) == 15)  and WAR.WCY4 > 0 then
        WAR.WCY4=WAR.WCY4-1--沼跃鱼：重阳真打
	    if WAR.WCY4==0  then
	 		local s = WAR.CurID
		    WAR.CurID = p
	        DHdisplay(1258, 1275, "六脉转龙.回天")
	        WAR.CurID=s
	    end
	end

	if wglw1(id,58)  and WAR.XLEB > 0 then
	    WAR.XLEB= WAR.XLEB - 1
		if WAR.XLEB == 0 then
			local s=WAR.CurID
	        WAR.CurID=p
			DHdisplay(3255, 3277,"阿鼻.刀意回转",M_Blue);
			WAR.XLEB = math.random(1,3)
			WAR.CurID=s
		end
	end	
	 
			--刀主大招，行动后恢复怒气
			--[[if id == 0 and putong() == 3 and WAR.YZHYZ[id] ~= nil and WAR.YZHYZ[id] > 0 then
				WAR.LQZ[id] = limitX((WAR.LQZ[id] or 0) + (WAR.YZHYZ[id]), 0, 100)
				WAR.YZHYZ[id] = 0
				if WAR.LQZ[id] ~= nil and WAR.LQZ[id] == 100 then
					DHdisplay(1694, 1705, "怒气爆发")
					if wglw1(id,58)  then
			            DHdisplay(2664, 2680, "雄霸天下.阿鼻三刀")
                        WAR.XLEB = math.random(1,3)
			        end	
				end
			end

			--修罗刀天外，行动后恢复怒气
			if wglw1(id,58) and WAR.YZHYZ[id] ~= nil and WAR.YZHYZ[id] > 0 then
				WAR.LQZ[id] = limitX((WAR.LQZ[id] or 0) + (WAR.YZHYZ[id]), 0, 100)
				WAR.YZHYZ[id] = 0
				if WAR.LQZ[id] ~= nil and WAR.LQZ[id] == 100 then
					local s=WAR.CurID
		            WAR.CurID=p
                    DHdisplay(2664, 2680, "雄霸天下.阿鼻三刀")
                    WAR.XLEB = math.random(1,3)
				    WAR.CurID=s
				end
			end	]]
	
	        --独孤九剑，集气+200
	        if PersonKF(id, 47) then
				WAR.Person[p].Time = WAR.Person[p].Time + 200
			end
            if DT(id,583) then
				WAR.Person[p].Time = WAR.Person[p].Time + 450
			end	
			if extrajq(id) > 0 then
				WAR.Person[p].Time = WAR.Person[p].Time + extrajq(id)
			end
			if MPPD(id) == 11 then --一刀流回气
				WAR.Person[p].Time = WAR.Person[p].Time + WAR.YDZM
				WAR.YDZM = 0
			end
	        if WAR.SJRF == 1 then
				WAR.Person[p].Time = WAR.Person[p].Time + 700
				WAR.SJRF = 0
			end 	
			if WAR.XZZ == 1 and (DT(id, 49) or D1GHYD(id)) then --虚竹集气+300
	          WAR.XZZ = 0
	          WAR.Person[p].Time = WAR.Person[p].Time + 300
	        end
			if WAR.XZZ == 1 and MPPD(id) == 8 then
				WAR.XZZ = 0
	          WAR.Person[p].Time = WAR.Person[p].Time + 150
			end
			
			if WAR.TDZX1 == 1 and wglw(id,153) then
				WAR.Person[p].Time = WAR.Person[p].Time + 300
				WAR.TDZX1 = 0
			end	
			
			if WAR.KLJZWF[pid] == 2 and WAR.XZZ == 1 then
				WAR.XZZ = 0
				WAR.Person[p].Time = WAR.Person[p].Time + 200
			end	
			
			if wglw1(pid,18) and WAR.XZZ == 1 then
				WAR.XZZ = 0
				WAR.Person[p].Time = WAR.Person[p].Time + 200
			end	
			
			if WAR.QDP1 >0 and DT(id, 104) then --乾达婆恢复集气
	          WAR.Person[p].Time = WAR.Person[p].Time + WAR.QDP1
			  WAR.QDP1 = 0 
	        end	  			
		    
			if DT(id, 50) then --沼跃鱼：萧峰天将底力恢复集气
	        local aa=math.modf((JY.Person[pid]["生命最大值"]-JY.Person[pid]["生命"] )/20)
	        if aa>=500 then
	        aa=500
	        end
			if WAR.LQZ[id] ~= nil and WAR.LQZ[id]==100 then
			aa=math.modf(aa*1.5)
			end
	        WAR.Person[p].Time = WAR.Person[p].Time + aa
	        end
			
            if wglw(id,94) or (DT(id,632) and PersonKF(id,94)) then			
			    WAR.Person[p].Time = WAR.Person[p].Time + 150
			    if PersonGT(id,94) then 
			        WAR.Person[p].Time = WAR.Person[p].Time + 250
			    end 
			end
				
			if wglw(id,99) or (DT(id,5) and PersonKF(id,99)) then 
			   WAR.Person[p].Time = WAR.Person[p].Time + 150
			   if PersonGT(id,99) then 
			   WAR.Person[p].Time = WAR.Person[p].Time + 150
			   end 
			end   
	        
			if WAR.ARJX == 4 then 
			   WAR.Person[p].Time = WAR.Person[p].Time + 300
			   WAR.ARJX = 0
			end 		
			
	        if WAR.ZSF == 1 and DT(id, 5) then --沼跃鱼：张三丰万法自然集气恢复修改
	          WAR.Person[p].Time = WAR.Person[p].Time + 500
			  if WAR.TJZX2>0 and WAR.TJZX1> WAR.TJZX2 then
			  WAR.Person[p].Time = WAR.Person[p].Time + (WAR.TJZX1-WAR.TJZX2)*60
			  WAR.TJZX1 =0 
			  WAR.TJZX2=0
			  end
	          WAR.ZSF = 0
	        end
			
			if WAR.LSQL2[id] == 1 and (wglw(id,99) or (DT(id,5) and PersonKF(id,99))) then 
			   WAR.Person[p].Time = WAR.Person[p].Time + 150
			   WAR.LSQL2[id] = nil
			end
			
			if WAR.WYJP == 1 then --五岳剑派
			  local mpdj = MPDJ(pid) * 50
	          WAR.Person[p].Time = WAR.Person[p].Time + mpdj
			  WAR.WYJP = 0
			end
			
			if WAR.TJL == 1 and getHZ(id, 28) then
	          WAR.Person[p].Time = WAR.Person[p].Time + 500
	          WAR.TJL = 0			
			end
			
			if WAR.BXJFHQ == 1 and (wglw1(id,48) or (DT(id,36) and PersonKF(id,48) and JX(id))) then
				WAR.Person[p].Time = WAR.Person[p].Time + 980
				WAR.BXJFHQ = 0
			end	
			
	        --[[
	        --朱九真，随机得到食材
	        if id == 81 and WAR.ZJZ == 0 and math.random(10) == 1 then
	          instruct_2(210, 1)
	          WAR.ZJZ = 1
	        end]]
			
			--[[武骧金星：取消暗器回收
			if MPPD(id) == 9 and JLSD(10, 20, id) and WAR.ZDDH ~= 226 and
				WAR.Person[WAR.CurID]["我方"] then --唐门10%随机得到暗器
				instruct_2(math.random(28, 35), 1)
			end
	        --]]
			
	        --一灯和王重阳，避免被反死
	        if not hasTF(pid, 83) and JY.Person[129]["生命"] <= 0 and WAR.WCY < 1 then
	          JY.Person[129]["生命"] = 1
	        end
	        if not hasTF(pid, 83) and JY.Person[65]["生命"] <= 0 and WAR.WCY1 < 1 then
	          JY.Person[65]["生命"] = 1
	        end
	        if not hasTF(pid, 83) and JY.Person[618]["生命"] <= 0 and WAR.WCY2 < 1 then
	          JY.Person[618]["生命"] = 1
	        end
	        if JY.Person[id]["生命"] <= 0 and wglw(id,90) then
	           JY.Person[id]["生命"] = 1
	        end
	        if JY.Person[id]["生命"] <= 0 and jtyl(id) then
	           JY.Person[id]["生命"] = 1
	        end
			if JY.Person[id]["生命"] <= 0 and DT(id, 600) then
	           JY.Person[id]["生命"] = 1
	        end
	        --小日本
	        if not hasTF(pid, 83) and WAR.ZDDH == 128 then
	          for i = 0, WAR.PersonNum - 1 do
	            if WAR.Person[i]["人物编号"] == 553 and JY.Person[553]["生命"] <= 0 then
	              WAR.YZB = 1
	              WAR.FXDS[553] = nil
	              WAR.LXZT[553] = nil
	            end
	          end
	        end
	          
	        --小日本，复活三次
	        if WAR.YZB == 1 then
	          if WAR.YZB2 < 3 then
	            WAR.YZB = 0
	            WAR.YZB2 = WAR.YZB2 + 1
	            say(CC.WARS5, 553)
	            JY.Person[553]["生命最大值"] = JY.Person[553]["生命最大值"] + 100
	            JY.Person[553]["内力最大值"] = JY.Person[553]["内力最大值"] + 1000
	            JY.Person[553]["生命"] = JY.Person[553]["生命最大值"]
	            JY.Person[553]["内力"] = JY.Person[553]["内力最大值"]
	            JY.Person[553]["中毒程度"] = 0
	            JY.Person[553]["受伤程度"] = 0
	            JY.Person[553]["体力"] = 100
	            JY.Person[553]["攻击力"] = JY.Person[553]["攻击力"] + 100
	            JY.Person[553]["防御力"] = JY.Person[553]["防御力"] + 100
	            JY.Person[553]["轻功"] = JY.Person[553]["轻功"] + 80
	            JY.Person[553]["武功1"] = 66
	            JY.Person[553]["武功等级1"] = 999
	            for j = 0, WAR.PersonNum - 1 do
	              if WAR.Person[j]["人物编号"] == 553 then
	                WAR.Person[j].Time = 990
	              end
	            end
	        	elseif WAR.YZB3 == 1 then
	            say(CC.WARS6, 553)
	            say(CC.WARS7)
	            say(CC.WARS8)
	            WAR.YZB3 = 1
	          end
	        end
	          
	        --主角，其疾如风，集气350，其他人100
	        if WAR.FLHS1 == 1 then
	          if id == 0 then
	            WAR.Person[p].Time = WAR.Person[p].Time + 350
	          end
				--[[for i = 0, WAR.PersonNum - 1 do
					if WAR.Person[i]["我方"] == true and WAR.Person[i]["死亡"] == false and WAR.Person[i]["人物编号"] ~= 0 then
						WAR.Person[i].Time = WAR.Person[i].Time + 100;
						if WAR.Person[i].Time > 999 then
							WAR.Person[i].Time = 999;
						end
					end
				end		]]	  
	          WAR.FLHS1 = 0
	        end
			if hasTF(id, 152) and JLSD(0, 50, id) then
				WAR.Person[p].Time = WAR.Person[p].Time + 350
				DHdisplay(878, 888, "其疾如风")
			end	
			if wglw(id,178) or ((DT(id,69) or DT(id,50)) and PersonKF(id,178)) or T9ZY(id) or DT(id,602) then --九龙功
	            if WAR.Defup[id] == 1 then
	               WAR.Person[p].Time = WAR.Person[p].Time + 500
	            else
	               WAR.Person[p].Time = WAR.Person[p].Time + 250
	            end  
	        end
			if WAR.GTJIQI~=0 then --主功体恢复集气
				if id == WAR.GTPID then
					WAR.Person[p].Time = WAR.Person[p].Time + WAR.GTJIQI
					WAR.GTJIQI=0 --主功体恢复集气数值
					WAR.GTPID=-1 --恢复集气数值对象
				end
			end
			
			--岳灵珊 每个剑法到极+25点集气
			if DT(id, 79) then
			    local JF = wgnumber(pid, 2)    			  
			    WAR.Person[p].Time = WAR.Person[p].Time + math.modf((JF) * 25)
			end		
			
			if id == 0 and putong() == 3 then --刀系每练1刀恢复集气10
				WAR.Person[p].Time = WAR.Person[p].Time + math.modf(wgnumber(0, 3) * 10)
			end
			
            if NF(id) and juexing() > 0 then
				WAR.Person[p].Time = WAR.Person[p].Time + sixi(id, 3)
                WAR.Person[p].Time = WAR.Person[p].Time + 300
			end								
			
            if PersonGT(id,182) then  --太极神功
				WAR.Person[p].Time = WAR.Person[p].Time + 200
				if PersonGT(id,182) and JLSD(10,40,id) then	
					WAR.Person[p].Time = WAR.Person[p].Time + 300
				end
			end 			
				
            if wglw(id,182) or (DT(id,5) and PersonGT(id,182)) then --太极神功				
				if WAR.Defup[id] == 1 then
	               WAR.Person[p].Time = WAR.Person[p].Time + 400
	            else
	               WAR.Person[p].Time = WAR.Person[p].Time + 200
	            end  
	        end
			
			if DT(id, 621) then --胡一刀行动后恢复集气
				WAR.Person[p].Time = WAR.Person[p].Time + sixi(id, 3)
				if JX(pid) then
				    WAR.Person[p].Time = WAR.Person[p].Time + sixi(id, 3)
				end
			end			
			
			if T13TQS(id) then ----沼跃鱼：滕青山拟兽式隼旋
                if WAR.TQSLH == 1 then 
				    local aa=WAR.SWHH*50
				    if aa>999 then
				        aa=999
				    end
                    WAR.Person[p].Time = WAR.Person[p].Time + aa
					WAR.TQSLH = 0
                end
            end
			
			if wssz(id) then ----沼跃鱼：滕文婷拟兽式隼旋
                if WAR.TQSLH == 1 then 
				    local aa=WAR.SWHH1*50
				    if aa>999 then
				        aa=999
				    end
                    WAR.Person[p].Time = WAR.Person[p].Time + aa
				    WAR.TQSLH = 0
                end
            end
			
			if DT(id,51) and juexing()>0 and WAR.DZXY == 1 and WAR.WJDZ2>0 then ----沼跃鱼：慕容无间斗转后             
				local aa=WAR.WJDZ2*20
				if aa>500 then
				    aa=500
				end
                WAR.Person[p].Time = WAR.Person[p].Time + aa
            end

			if DT3(id, 38) and WAR.SAXING ~= -1 then --石破天杀人加集气
				WAR.Person[p].Time = WAR.Person[p].Time + math.modf(WAR.SAXING * 200)
				WAR.SAXING = -1 --石破天飒行指令重置
			end
			
			if hasTF(id, 78) and WAR.DXQL[id] ~= nil and WAR.DXQL[id] > 0 then
				WAR.Person[p].Time = WAR.Person[p].Time + WAR.DXQL[id]
				WAR.DXQL[id] = 0
			end

            if WAR.KHSY[id] ~= nil and WAR.KHSY[id] > 0 then
				WAR.Person[p].Time = WAR.Person[p].Time + 100
				WAR.KHSY[id] = 0
			end	

			if DT(id, 67) then
				WAR.Person[p].Time = WAR.Person[p].Time + math.modf((JY.Person[id]["生命最大值"] - JY.Person[id]["生命"]) / 10)
			end
			
			if PersonKF(id, 119) then --天罗地网加集气位置100
				WAR.Person[p].Time = WAR.Person[p].Time + 100 + math.modf(JY.Person[id]["轻功"] / 5)		
			end
			
			if id==0 and putong() == 9 and WAR.XHPL==1 then --血海飘零加集气
				if WAR.LXZT[0]~=nil then
					WAR.Person[p].Time = WAR.Person[p].Time+math.modf(WAR.LXZT[0]*math.random(5,8))
					if WAR.Person[p].Time>900 then WAR.Person[p].Time=900 end
					WAR.XHPL=0
				end
			end
	        
	        ----蓝烟清：brolycjw杨过黯然神伤特效 行动后集气初始位置额外增加
	        --生命少过三分之一时每少100增加行动后集气位置加100
	        if DT(id , 58) and JY.Person[58]["生命"] < JY.Person[58]["生命最大值"]/2  and GetS(86,11,11,5) == 2 then
	        	--计算行动后初始集气位置每100点生命，增加100点
	        	WAR.Person[p].Time = WAR.Person[p].Time +math.floor(JY.Person[58]["生命最大值"]/2 - JY.Person[58]["生命"]);
	        end
	          
			if T7DFWM(id) then --东方未明剑系特技恢复集气
				if WAR.DFWMJIQI == 1 then
					WAR.Person[p].Time = WAR.Person[p].Time + 250
					WAR.DFWMJIQI = 0
				end
			end			
			--昆仑门人行动后回集气
			if MPPD(id) == 19 and PersonGT(id,204) then
				WAR.Person[p].Time = WAR.Person[p].Time + limitX((math.modf(sixi(id,3))/5),0,100)
			end	
			if id == 0 and zjtype() == 1 and tianshu() >= 4 and WAR.XKZ > 0 then 
				local aa=30*WAR.XKZ
				local bb=math.modf(WAR.XKZ*0.2)
				WAR.Person[p].Time = WAR.Person[p].Time + aa
				zhanyi(id,bb)
				local tmppid=WAR.CurID
				WAR.CurID= id
				DHdisplay(1966, 1981, "虚空藏恢复"..aa.."点集气")
				DHdisplay(2054, 2069, "虚空藏提升"..bb.."点战意") 	 			
				WAR.CurID=tmppid
				WAR.XKZ=0			
			elseif id == 0 and zjtype()==4 and tianshu()>=4 and  WAR.XKZ>0 then 
				local aa=30*WAR.XKZ
				local bb=math.modf(WAR.XKZ*0.2)
				WAR.Person[p].Time = WAR.Person[p].Time + aa
				zhanyi(id,bb)
				local tmppid=WAR.CurID
				WAR.CurID= id
				DHdisplay(1966, 1981, "次元步恢复"..aa.."点集气")
				DHdisplay(2054, 2069, "次元步提升"..bb.."点战意")
				WAR.Person[WAR.CurID]["体力点数"] = AddPersonAttrib(id, "体力", bb)		
				DHdisplay(2704, 2730, "次元步提升"..bb.."点体力")
				WAR.CurID=tmppid
				WAR.XKZ=0	
            end--12.27改
			
			--金雁功领悟回气
			if (wglw2(id,192) or DT(id,129)) and PersonKF(id,192) and WAR.XKZ > 0 then
				local aa=30*WAR.XKZ
				if id == 0 then
					aa = math.modf(aa/3)
				end	
				WAR.Person[p].Time = WAR.Person[p].Time + aa
				local tmppid = WAR.CurID
				WAR.CurID = p
				WarDrawMap(0)
				DHdisplay(3281, 3309, "金雁凌空")
				WAR.CurID=tmppid
				WAR.XKZ=0
			end	
			
            --森罗万道
			if DT(id,583) then
				local aa = math.modf(WAR.SXTJ / 20)
				aa = aa - WAR.SLWD
				if aa > 0 then
					local bb = math.random(1,35)
					if bb == 1 then JY.Person[id]["声望"] = 89 end        --紫霞神功
					if bb == 2 then JY.Person[id]["声望"] = 90 end        --混元功 
					if bb == 3 then JY.Person[id]["声望"] = 92 end	       --狮子吼
					if bb == 4 then JY.Person[id]["声望"] = 93 end        --圣火神功
					if bb == 5 then JY.Person[id]["声望"] = 94 end	       --神照功
					if bb == 6 then JY.Person[id]["声望"] = 95 end        --蛤蟆功
					if bb == 7 then JY.Person[id]["声望"] = 96 end        --罗汉伏魔功
					if bb == 8 then JY.Person[id]["声望"] = 97 end        --乾坤大挪移
					if bb == 9 then JY.Person[id]["声望"] = 98 end        --小无相功   
					if bb == 10 then JY.Person[id]["声望"] = 99 end       --纯阳无极功
					if bb == 11 then JY.Person[id]["声望"] = 100 end      --先天功    
					if bb == 12 then JY.Person[id]["声望"] = 101 end      --八荒六合功
					if bb == 13 then JY.Person[id]["声望"] = 102 end      --太玄神功
					if bb == 14 then JY.Person[id]["声望"] = 103 end      --龙象般若功
					if bb == 15 then JY.Person[id]["声望"] = 104 end      --逆运真经
					if bb == 16 then JY.Person[id]["声望"] = 105 end      --葵花神功
					if bb == 17 then JY.Person[id]["声望"] = 106          --九阳神功
						WAR.JYHT[id] = 5
					end	
					if bb == 18 then JY.Person[id]["声望"] = 107          --九阴神功
						WAR.JYZQ[id] = 5
					end 
					if bb == 19 then JY.Person[id]["声望"] = 108 end      --易筋神功
					if bb == 20 then JY.Person[id]["声望"] = 150 end      --金关玉锁诀
					if bb == 21 then JY.Person[id]["声望"] = 151 end      --金刚不坏体
					if bb == 22 then JY.Person[id]["声望"] = 152 end      --天南易阳决
					if bb == 23 then JY.Person[id]["声望"] = 178 end      --擒龙功
					if bb == 24 then JY.Person[id]["声望"] = 178 end      --擒龙功
					if bb == 25 then JY.Person[id]["声望"] = 180 end      --太虚剑意
					if bb == 26 then JY.Person[id]["声望"] = 181 end      --玄武真功
					if bb == 27 then JY.Person[id]["声望"] = 182 end      --太极神功
					if bb == 28 then JY.Person[id]["声望"] = 183 end      --洗髓神功
					if bb == 29 then JY.Person[id]["声望"] = 184 end      --瑜伽神功      
					if bb == 30 then JY.Person[id]["声望"] = 185 end      --武当九阳功
					if bb == 31 then JY.Person[id]["声望"] = 186 end      --峨眉九阳功
					if bb == 32 then JY.Person[id]["声望"] = 187 end      --少林九阳功
					if bb == 33 then JY.Person[id]["声望"] = 188 end      --神足经
					if bb == 34 then JY.Person[id]["声望"] = 189 end      --阴阳磨
					if bb == 35 then JY.Person[id]["声望"] = 203 end      --怒涛海潮
                    local name = JY.Wugong[JY.Person[id]["声望"]]["名称"]
                    WAR.SLWD = WAR.SLWD + 1
					DHdisplay(1124, 1141, "天地奇正 阴阳生灭")
                    lib.Delay(150)
                    DHdisplay(2279, 2299, "天地奇正 阴阳生灭")
                    lib.Delay(30)
					DHdisplay(1124, 1141, "森罗万道 "..name)
                    lib.Delay(150)
                    DHdisplay(2279, 2299, "森罗万道 "..name)
                    lib.Delay(30)
					local cc = math.random(100, 200) 
                    WAR.Person[p]["生命点数"] = AddPersonAttrib(id, "生命", cc)
                    QZXS(JY.Person[id]["姓名"].."的生命值增加"..cc.."点")
                    cc = math.random(300, 600) 
                    WAR.Person[p]["内力点数"] = AddPersonAttrib(id, "内力", cc)
                    QZXS(JY.Person[id]["姓名"].."的内力值增加"..cc.."点")
                    cc = math.random(2, 6)
                    WAR.Person[p]["体力点数"] = AddPersonAttrib(id, "体力", cc)	
                    QZXS(JY.Person[id]["姓名"].."的体力值增加"..cc.."点")
                    JY.Person[id]["受伤程度"] = 0
                    JY.Person[id]["中毒程度"] = 0
					WAR.LXZT[id] = 0
					WAR.LXXS[id] = 0
					WAR.ICE[id] = 0
		            WAR.HOT[id] = 0
					WAR.CHZ[id] = 0
				end
			end								
	
			if WAR.GUDUVICTIE[id] ~= nil then --何铁手龙眠蛊集气-250 中毒附加			
				WAR.Person[p].Time = WAR.Person[p].Time - 250 - JY.Person[id]["中毒程度"]
				if WAR.Person[p].Time < -500 then WAR.Person[p].Time = -500 end
				WAR.GUDUVICTIE[id] = WAR.GUDUVICTIE[id] - 1
				if WAR.GUDUVICTIE[id] <= 0 then 
					WAR.GUDUVICTIE[id] = nil
				end
			end
			
			if WAR.KMSHJQ[id] ~= nil then --沼跃鱼：空明守护的效果			
				WAR.Person[p].Time = WAR.Person[p].Time - 240 *WAR.KMSHJQ[id]
				if WAR.Person[p].Time < -500 then WAR.Person[p].Time = -500 end
				WAR.KMSHJQ[id] = nil
			end
			
			if DT(id,64) and WAR.ZBT1>0 then --沼跃鱼：空明蓄力读条	
                local aa=WAR.ZBT1
                if aa>=3 then
                aa=3
                end				
				WAR.Person[p].Time = WAR.Person[p].Time + 300 *aa
			end

			if (wglw(id, 107) and PersonGT(id,107) ) or DT(id,599) and WAR.ZBT3>0 then
                WAR.Person[p].TimeAdd = WAR.Person[p].TimeAdd + 600
            end
	          
	        --血刀老祖
	        if DT(id, 97) then
	          WAR.XDLZ = WAR.XDLZ + 1
	        end
	        
	        if WAR.YJ > 0 then
	          instruct_2(174, WAR.YJ)
	          WAR.YJ = 0
	        end
			
			--steal
		  for i=1,WAR.ZHUJUETDNUM do
			if WAR.ZHUJUETD[i]~=nil then
				instruct_2(WAR.ZHUJUETD[i], 1)
				WAR.ZHUJUETD[i]=nil
			end
		  end	
		  WAR.ZHUJUETDNUM = 0
			  
	        --盲目状态恢复
	        if WAR.KHCM[pid] == 1 or WAR.KHCM[pid] == 2 then
	          WAR.KHCM[pid] = nil
	          Cls()
	          DrawStrBox(-1, -1, CC.WARS12, C_ORANGE, CC.DefaultFont)
	          ShowScreen()
	          lib.Delay(500)
	        end
			if WAR.JTJD[pid] == 1 then --唐门模式 
			   WAR.JTJD[pid] = nil 
			end
			if WAR.TMMS[300+pid] == 1 then --唐门模式
			   WAR.TMMS[300+pid] = nil 
			   WAR.DPJ[pid] = 3
			end   
			if WAR.SLCS[100+pid] ~= nil and WAR.SLCS[100+pid] > 0 then --九龙功
			   WAR.SLCS[200+pid] = WAR.SLCS[100+pid]
			end
			if WAR.MJYW[pid] == 1 then --17-3-1
			   WAR.MJYW[pid] = 0 
			end   
	        if WAR.TJXL[pid] == 1 then
	           WAR.TJXL[pid] = nil
	        end
			if WAR.TJSG[100+pid] ~= nil and WAR.TJSG[100+pid] > 0 then 
			   WAR.TJSG[200+pid] = WAR.TJSG[100+pid]
			end
	        if jtyl(pid) and WAR.JTWW > 1 then
			   WAR.JTWW1 = 0 
	           WAR.JTWW = WAR.JTWW - 1
			   if WAR.JTWW == 1 then 
	          Cls()
			  DHdisplay(2197, 2219,"九天一流・万物两断")
	      --    DrawStrBox(-1, -1, "九天一流・斩断万物", C_ORANGE, CC.DefaultFont)
	      --    ShowScreen()
	          lib.Delay(50)
			   end
	        end
			if WAR.WYWX[pid] ~= nil then --17-3-1
			   WAR.WYWX[pid] = nil 
			end
            if WAR.JSJY[300+pid] ~= nil then 
			   WAR.JSJY[300+pid] = nil
            end			
			if (pid == 0 or DT(pid,129)) and WAR.LMBJ == 1 then 
			WAR.LMBJ = 0
			end 
            if WAR.TJZS[2000+pid] ~= nil then----
		       WAR.TJZS[2000+pid] = nil 
	        end
			if (pid == 0 or DT(pid,129)) and WAR.LMBJ1 == 1 then 
			WAR.LMBJ1 = 0
			end
			if WAR.WWDZ[pid] == 1 then --唯我独尊--17-2-27
	        WAR.WWDZ[pid] = nil
	        end	
			if (wglw(pid,106) or (DT(pid,9) and PersonGT(pid,106))) and JLSD(0,30,pid) then --17-2-10
		        if WAR.JYHT[pid] == nil then 
			        WAR.JYHT[pid] = 1 
			    else 	 
                    WAR.JYHT[pid] = WAR.JYHT[pid] + 1 
			    end
                if WAR.JYHT[pid] >= 5 then 
                    WAR.JYHT[pid] = 5
			    end
			end
			if WAR.YDLLJ > 1 then 
			    WAR.YDLLJ = 1 
			end   
			
			if wglw2(pid,194) and PersonKF(pid,194) and JLSD(10,50,pid) then
				WAR.HIDE[pid] = math.random(30,50)
			end	
			
			if (wglw(pid,107) or DT(pid,599)) and JLSD(0,30,pid) then --17-2-10
		        if WAR.JYZQ[pid] == nil then 
			        WAR.JYZQ[pid] = 1 
			    else 	 
                    WAR.JYZQ[pid] = WAR.JYZQ[pid] + 1 
			    end
                if WAR.JYZQ[pid] >= 5 then 
                    WAR.JYZQ[pid] = 5
			    end
			end			
			if wglw(pid,592) or DT(pid,592) then
		        if WAR.DGJY[pid] == nil then 
			        WAR.DGJY[pid] = 1 
			    else 	 
                    WAR.DGJY[pid] = WAR.DGJY[pid] + 1 
			    end
                if WAR.DGJY[pid] >= 5 then 
                    WAR.DGJY[pid] = 5
			    end
			end			
			if DT(pid,114) then -- --17-2-9
			    WAR.SDQQ = 7
			end   
	        if jtyl(pid) and WAR.SJSM[300+pid] == 1 then--1-26- 
	            Cls()
			    DHdisplay(2461, 2485,"九天一流・大悟晦")
	            lib.Delay(50)
			    WAR.SJSM[300+pid] = nil
	        end
			if wssz(pid) and WAR.SSFN[300+pid] == 1 then--1-26- 
	            Cls()
			    DHdisplay(2461, 2485,"兽神心经・麒麟降世")
	            lib.Delay(50)
			    WAR.SSFN[300+pid] = nil
	        end
			if (wglw(pid,102) or (DT(pid,38) and PersonKF(pid,102))) and WAR.HLTX == 1 then --1-26- 
			    WAR.HLTX = 0
			end 
			if WAR.ZYHB3 == 1 then --左右三连
			    WAR.ZYHB3 = 0
			end
			if WAR.ZYHB2 == 2 then  --左右三连
			    WAR.ZYHB2 = 0
			end
			if WAR.YHDF[pid] == 1 then --17-2-10-
			    WAR.YHDF[pid] = 0
			end
			
	        if WAR.JTQF[pid] == 1 then
	            WAR.JTQF[pid] = nil
	        end
			if DT(pid,5) and WAR.JLDL1 == 1 then
                WAR.tmp[3000 + pid] = 0
			    WAR.JLDL1 = 0
			end
			if WAR.XWGJ == 1 then --17-2-12-
			    WAR.XWGJ = 0 
			end   
			if WAR.FHXY[pid] ~= nil then 
	            WAR.FHXY[pid] = nil
	        end
			
	        if WAR.WXQQ[pid] == 1 then
	            WAR.WXQQ[pid] = nil
	        end
	        if WAR.XLDL[pid] == 1 then
				if WAR.ZLZS[pid] ~= nil then
					AddPersonAttrib(pid,"受伤程度",math.random(20,40))
				end
	            WAR.XLDL[pid] = nil
	        end
			if WAR.DPLX[pid] ==1 then
			    WAR.DPLX[pid] = nil
			end
			if WAR.HSBS[pid] ==1 then
			    WAR.HSBS[pid] = nil
			end
			
			if WAR.HSBS2[pid] ==1 then
			    WAR.HSBS2[pid] = nil
			end
			
			if WAR.QSLB[pid] ~= nil then --逍遥三圣
			    WAR.QSLB[pid] = nil 
			end
			
	        --蓄力，行动一次减1
	        if WAR.Actup[id] ~= nil then
	            WAR.Actup[id] = WAR.Actup[id] - 1
	        end
	        
	        if WAR.Actup[id] == 0 then
	            WAR.Actup[id] = nil
	        end
			
			if WAR.AXZX == 1 then
				WAR.AXZX = 0 
			end

			if WAR.AXZY == 1 then
				WAR.AXZY = 0 
			end
			
			if WAR.AXSY2[pid] ~= nil then
				WAR.AXSY2[pid] = WAR.AXSY2[pid] - 1
				if WAR.AXSY2[pid] == 0 then
					WAR.AXSY2[pid] = nil
				end
			end	
			
	        --袁承志 免内伤
	        if DT(id , 54) then
	            JY.Person[id]["受伤程度"] = 0
	        end
	        
			--豸苗：金刚不坏奥义免内伤
			if wglw(id, 151) or DT(id,615) then
			   JY.Person[id]["受伤程度"] = 0
			end
			
	        JY.Wugong[13]["名称"] = CC.WARS13
	        
            if wglw(id,184) and PersonGT(id,184) then
			   JY.Person[id]["受伤程度"] = 0
			end			
			
	        if hasTF(id, 24) then
	            WAR.ZBT[id] = (WAR.ZBT[id] or 0) + 1
	        end
	        
	        if getHZ(id, 32) then
	            WAR.SQL = WAR.SQL + 1
	        end	
			
			if (wglw(id,106) and PersonKF(id, 106)) or (PersonKF(id, 106) and (DT(id, 9))) then		--九阳领悟后免内伤、中毒
				JY.Person[id]["受伤程度"] = 0
                JY.Person[id]["中毒程度"] = 0
	        end	
			
	        if WAR.TGN == 1 then
	            say(CC.WARS14, 72)    --田归农杀掉苗人凤
	            JY.Person[72]["攻击力"] = JY.Person[72]["攻击力"] + 20
	            JY.Person[72]["防御力"] = JY.Person[72]["防御力"] + 20
	            JY.Person[72]["轻功"] = JY.Person[72]["轻功"] + 20
	            JY.Person[72]["武功1"] = 44
	            JY.Person[72]["武功等级1"] = 50
		        JY.Person[72]["武功2"] = 67
	            JY.Person[72]["武功等级2"] = 50
			    JY.Person[72]["左右互搏"] = 1
	            DrawStrBox(-1, -1, CC.WARS15, C_ORANGE, CC.DefaultFont)
	            ShowScreen()
	            lib.Delay(2000)
			    say("我终于掌握了胡苗两家的绝学，可以威震天下了，哈哈", 72) 
			    DrawStrBox(-1, -1,"田归农觉醒刀剑十杀奥义" , C_ORANGE, CC.DefaultFont)
	            ShowScreen()
	            lib.Delay(2000)
			    setJX(72,1)
				for i,v in ipairs(CC.TFWG) do
				  if v[1] == 72 then
					 v[2] = 44
					 break
				  end
				end
				for i,v in ipairs(CC.TFWG1) do
				  if v[1] == 72 then
					 v[2] = 67
					 break
				  end
				end
	            WAR.TGN = 0
	        end
			
			if WAR.YJ2==1 then
			    say("哈哈，这小子的胡家刀法归我了", 4)    --阎基杀掉胡斐
	            JY.Person[4]["攻击力"] = JY.Person[4]["攻击力"] + 20
	            JY.Person[4]["防御力"] = JY.Person[4]["防御力"] + 20
	            JY.Person[4]["轻功"] = JY.Person[4]["轻功"] + 20
	            JY.Person[4]["武功1"] = 67
	            JY.Person[4]["武功等级1"] = 50
			    JY.Person[4]["用毒能力"]=500
	            DrawStrBox(-1, -1, CC.WARS15, C_ORANGE, CC.DefaultFont)
	            ShowScreen()
	            lib.Delay(2000)
			    say("看我把胡家刀法和毒术合起来用，哈哈，赚大发了", 4) 
			    DrawStrBox(-1, -1,"阎基觉醒胡家毒刀" , C_ORANGE, CC.DefaultFont)
	            ShowScreen()
	            lib.Delay(2000)
			    setJX(4,1)
				for i,v in ipairs(CC.TFWG) do
				  if v[1] == 4 then
					 v[2] = 67
					 break
				  end
				end
	            WAR.YJ2 = 0
	        end
			
			
	        --赵灵儿林月如阿奴退场特效
			if WAR.MMTC == 1 then
				say("五气朝元！", 656)   
				for j = 0, WAR.PersonNum - 1 do
					if WAR.Person[j]["死亡"] == false and 
						WAR.Person[j]["我方"] then
						local tmppid = WAR.Person[j]["人物编号"]
						if tmppid ~= 656 then
							AddPersonAttrib(tmppid, "生命", 500)
						end
					end
				end					
				DrawStrBox(-1, -1, "我方全体恢复生命500点", C_ORANGE, CC.DefaultFont)
				ShowScreen()
				lib.Delay(2000)
				WAR.MMTC = 0			
			end
			
			if WAR.MMTC == 2 then
				say("乾坤一掷！", 655)   
				for j = 0, WAR.PersonNum - 1 do
					if WAR.Person[j]["死亡"] == false and 
						WAR.Person[j]["我方"] == false then
						local tmppid = WAR.Person[j]["人物编号"]
						 JY.Person[tmppid]["生命"] = JY.Person[tmppid]["生命"] - 300
						 AddPersonAttrib(tmppid, "受伤程度", 10)
						 if JY.Person[tmppid]["生命"] <= 0 then
							JY.Person[tmppid]["生命"] = 1
						 end
					end
				end					
				DrawStrBox(-1, -1, "敌人全体损失生命300点，内伤增加10点", C_ORANGE, CC.DefaultFont)
				ShowScreen()
				lib.Delay(2000)
				WAR.MMTC = 0			
			end

			if WAR.MMTC == 3 then
				say("万蛊蚀天！", 657)   
				for j = 0, WAR.PersonNum - 1 do
					if WAR.Person[j]["死亡"] == false and 
						WAR.Person[j]["我方"] == false then
						local tmppid = WAR.Person[j]["人物编号"]
						AddPersonAttrib(tmppid,"中毒程度", 50); 
					end
				end					
				DrawStrBox(-1, -1, "敌人全体中毒50点", C_ORANGE, CC.DefaultFont)
				ShowScreen()
				lib.Delay(2000)
				WAR.MMTC = 0			
			end
			
			if WAR.SHMP ~= -1 then
				JY.Person[WAR.SHMP]["生命"] = 0
				WAR.SHMP = -1
			end
			
			if DT(pid, 38) then --石破天行动后加战意
				zhanyi(pid, 2, 1)
			end
			
			if JX(pid) then --觉醒角色行动后加战意
				zhanyi(pid, 2, 1)
			end
			
			if DT(pid, 73) then
				for j = 0, WAR.PersonNum - 1 do
					if WAR.Person[j]["死亡"] == false and RealJL(WAR.CurID, j, 3) and
						WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
						local tmppid = WAR.Person[j]["人物编号"]
						AddPersonAttrib(tmppid, "体力", 3)
					end
				end						
			end
			
			if hasTF(pid, 62) then
				for j = 0, WAR.PersonNum - 1 do
					if WAR.Person[j]["死亡"] == false then
						local tmppid = WAR.Person[j]["人物编号"]
						AddPersonAttrib(tmppid, "受伤程度", -5)
						if WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
							AddPersonAttrib(tmppid, "生命", 50)
						end
					end
				end		
			end
			
			if hasTF(pid, 63) then
				for j = 0, WAR.PersonNum - 1 do
					if WAR.Person[j]["死亡"] == false and 
						WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
						local tmppid = WAR.Person[j]["人物编号"]
						AddPersonAttrib(tmppid, "内力", -500)
					end
				end				
			end
			
			if hasTF(pid, 66) then
				for j = 0, WAR.PersonNum - 1 do
					if WAR.Person[j]["死亡"] == false and 
						WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
						local tmppid = WAR.Person[j]["人物编号"]
						AddPersonAttrib(tmppid, "内力", 500)
					end
				end				
			end			
			
			if hasTF(pid, 135) then
				for j = 0, WAR.PersonNum - 1 do
					if WAR.Person[j]["死亡"] == false and 
						WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
						WAR.Person[j].Time = WAR.Person[j].Time + 100
						if WAR.Person[j].Time > 999 then WAR.Person[j].Time = 999 end
					end
				end				
			end		

			if hasTF(pid, 136) then
				for j = 0, WAR.PersonNum - 1 do
					if WAR.Person[j]["死亡"] == false and 
						WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and not jtyl(WAR.Person[j]["人物编号"]) then
						WAR.Person[j].Time = WAR.Person[j].Time - 100
						if WAR.Person[j].Time < -500 then WAR.Person[j].Time = -500 end
					end
				end				
			end					
			
			if WAR.WYWX[pid] == 1 then --17-3-3-秘剑演武・无影无相
				for j = 0, WAR.PersonNum - 1 do
					if WAR.Person[j]["死亡"] == false and 
						WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
						WAR.Person[j].Time = WAR.Person[j].Time - 200
						if WAR.Person[j].Time < -500 then WAR.Person[j].Time = -500 end
					end
					if WAR.Person[j]["死亡"] == false and 
						WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
						WAR.Person[j].Time = WAR.Person[j].Time + 200
						if WAR.Person[j].Time > 999 then WAR.Person[j].Time = 999 end
					end
				end				
			end
			
			if hasTF(pid, 64) then
				if JLSD(10, 30, pid) and (WAR.HIDE[pid] == nil or WAR.HIDE[pid] <= 0) then
					DHdisplay(2938, 2956, "天隐万相")
					WAR.HIDE[pid] = 30
				end
			end
			
  		    if MPPD(pid) == 13 and PersonGT(pid, 93)  then --沼跃鱼:明教焚影圣诀气息遮断
			   local aa=0
			    if PersonKF(pid,193) then
				 aa=aa+20
			    end
				if JLSD(10, 30+MPDJ(pid)*5+aa, pid) then
				DHdisplay(2938, 2956, "焚影秘传.遁入暗影")
				WAR.HIDE[pid] = WAR.HIDE[pid] or 0 +10*(MPDJ(pid)+1)
				WAR.QFY1[pid] = WAR.QFY1[pid] or 0 +10*(MPDJ(pid)+1)
				end
	        end
			
            --豸苗：碧针清掌17-2-25
            if DT(pid,164) then
                if ZYBF(pid) then
	                WAR.BZQZ = math.modf(JY.Person[pid]["内力"]*0.08)
	            else	
                    WAR.BZQZ = math.modf(JY.Person[pid]["内力"]*0.05)
	            end	
	            if WAR.BZQZ<50 then
	                WAR.BZQZ = 50 
	            end
            end
  
			--豸苗：太玄
			if (PersonGT(pid, 102) and wglw(pid,102)) or (DT(pid,38) and PersonKF(pid,102)) then
			    if JLSD(10, 30, pid) and (WAR.HIDE[pid] == nil or WAR.HIDE[pid] <= 0) then
					DHdisplay(2938, 2956, "事了拂衣去 深藏身与名")
					WAR.HIDE[pid] = 30
				end
			end

			if WAR.AXSY4[pid] == 1 then
				local a = math.random(2)
				if a == 1 then
					CleanWarMap(4, 0)
					local x1 = WAR.Person[WAR.CurID]["坐标X"];
					local y1 = WAR.Person[WAR.CurID]["坐标Y"];
					for ex = x1 - 99, x1 + 99 do
				        for ey = y1 - 99, y1 + 99 do
					        SetWarMap(ex, ey, 4, 1)
					        if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
						        local ep = GetWarMap(ex, ey, 2)
						        if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[ep]["我方"] and WAR.AXSY1[WAR.Person[ep]["人物编号"]] == nil then
							       WAR.AXSY1[WAR.Person[ep]["人物编号"]] = 30
							       SetWarMap(ex, ey, 4, 4)
						        end
					        end
				        end
			        end
				elseif a == 2 then 
					CleanWarMap(4, 0)
					local x1 = WAR.Person[WAR.CurID]["坐标X"];
			        local y1 = WAR.Person[WAR.CurID]["坐标Y"];
			        for ex = x1 - 99, x1 + 99 do
				        for ey = y1 - 99, y1 + 99 do
					        SetWarMap(ex, ey, 4, 1)
					        if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
						        local ep = GetWarMap(ex, ey, 2)
						        if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[ep]["我方"] and WAR.AXSY2[WAR.Person[ep]["人物编号"]] == nil then
							       WAR.AXSY2[WAR.Person[ep]["人物编号"]] = 3
							       SetWarMap(ex, ey, 4, 4)
						        end
					        end
				        end
			        end
				end	
			end	
			if WAR.SHML[pid] == 1 then 
			   local a = math.random(3)
			   if a == 1 then 
					DHdisplay(1551, 1572, "极乐世界永恒安 令离魔王犯纲毒")
					CleanWarMap(4, 0)
					local x1 = WAR.Person[WAR.CurID]["坐标X"];
			        local y1 = WAR.Person[WAR.CurID]["坐标Y"];
			        for ex = x1 - 8, x1 + 8 do
				        for ey = y1 - 8, y1 + 8 do
					        SetWarMap(ex, ey, 4, 1)
					        if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
						        local ep = GetWarMap(ex, ey, 2)
						        if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[ep]["我方"] then
							       WAR.L_NOT_MOVE[WAR.Person[ep]["人物编号"]] = 1
							       SetWarMap(ex, ey, 4, 4)
						        end
					        end
				        end
			        end
				elseif a == 2 then 
					DHdisplay(1540, 1551, "众生若生怖畏心 自有暗邢自缚日")
					CleanWarMap(4, 0)
					local x1 = WAR.Person[WAR.CurID]["坐标X"];
			        local y1 = WAR.Person[WAR.CurID]["坐标Y"];
			        for ex = x1 - 8, x1 + 8 do
				        for ey = y1 - 8, y1 + 8 do
					        SetWarMap(ex, ey, 4, 1)
					        if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
						        local ep = GetWarMap(ex, ey, 2)
						        if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[ep]["我方"] then
							       WAR.BWAX[WAR.Person[ep]["人物编号"]] = 50
							       SetWarMap(ex, ey, 4, 4)
						        end
					        end
				        end
			        end
				elseif a == 3 then 
					DHdisplay(1173, 1187, "不舍千般虚妄业 难离业海万罪缚")
					CleanWarMap(4, 0)
					local x1 = WAR.Person[WAR.CurID]["坐标X"];
			        local y1 = WAR.Person[WAR.CurID]["坐标Y"];
			        for ex = x1 - 8, x1 + 8 do
				        for ey = y1 - 8, y1 + 8 do
					        SetWarMap(ex, ey, 4, 1)
					        if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
						        local ep = GetWarMap(ex, ey, 2)
						        if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[ep]["我方"] then
							       WAR.KHG[WAR.Person[ep]["人物编号"]] = 50
							       SetWarMap(ex, ey, 4, 4)
						        end
					        end
				        end
			        end
			   end
			   WAR.SHML[pid] = nil
			end   
			if hasTF(pid, 65) or DT(pid,583) or DT(pid, 592) or DT(pid, 600) or NF(pid) or BJY(pid) or ((wglw1(pid,47) or DT(pid,592)) and WAR.DGJJ_ZJS == 1) or (WAR.KHZJ[pid] ~= nil) or (WAR.KLLY2[pid] ~= nil) then				
				War_RestMenu()
			end
			if T3XYK(pid) and JLSD(10, 60, pid) then				
				War_RestMenu()
			end
            if wglw(pid,89) or (PersonKF(pid,89) and DT(pid,19)) then --紫霞剑系
			    WAR.CHZ[pid] = nil
			    WAR.ICE[pid] = nil
			    WAR.HOT[pid] = nil
				--WAR.Person[WAR.CurID]["内力点数"] = AddPersonAttrib(pid, "内力", math.modf(JY.Person[pid]["内力最大值"]*0.1));
				if JY.Person[pid]["内力"] > 200 then
				    if WAR.ZXJQ[pid] == nil or WAR.ZXJQ[pid] < 10 then
				        local a = 10
					    if WAR.ZXJQ[pid] == nil then 
					        a = 10 
					    elseif WAR.ZXJQ[pid] ~= nil and WAR.ZXJQ[pid] < 10 then 
					        a = a - WAR.ZXJQ[pid]
					    end 
				        if math.modf(JY.Person[pid]["内力"]/200) > a then
					        WAR.ZXJQ[pid] = 10
						    WAR.Person[WAR.CurID]["内力点数"] = AddPersonAttrib(pid, "内力", -a*200);
					else
					    if WAR.ZXJQ[pid] == nil then 
						    WAR.ZXJQ[pid] = math.modf(JY.Person[pid]["内力"]/200)
						else
						    WAR.ZXJQ[pid] = WAR.ZXJQ[pid]+math.modf(JY.Person[pid]["内力"]/200)
						end
						    WAR.Person[WAR.CurID]["内力点数"] = AddPersonAttrib(pid, "内力", -math.modf(JY.Person[pid]["内力"]/200)*200);
					    end
					        War_Show_Count(WAR.CurID)
				    end
				end
				WAR.Person[WAR.CurID]["内力点数"] = AddPersonAttrib(pid, "内力", math.modf(JY.Person[pid]["内力最大值"]*0.1));
				War_Show_Count(WAR.CurID)
			end
			if NF(pid) then --创刀
			    WAR.CHZ[pid] = nil
			    WAR.ICE[pid] = nil
			    WAR.HOT[pid] = nil
				if JY.Person[pid]["内力"] > 200 then
				    if WAR.CDDQ[pid] == nil or WAR.CDDQ[pid] < 10 then
				        local a = 10
					    if WAR.CDDQ[pid] == nil then 
					        a = 10 
					    elseif WAR.CDDQ[pid] ~= nil and WAR.CDDQ[pid] < 10 then 
					        a = a - WAR.CDDQ[pid]
					    end 
				        if math.modf(JY.Person[pid]["内力"]/200) > a then
					        WAR.CDDQ[pid] = 10
						    WAR.Person[WAR.CurID]["内力点数"] = AddPersonAttrib(pid, "内力", -a*200);
					else
					    if WAR.CDDQ[pid] == nil then 
						    WAR.CDDQ[pid] = math.modf(JY.Person[pid]["内力"]/200)
						else
						    WAR.CDDQ[pid] = WAR.CDDQ[pid]+math.modf(JY.Person[pid]["内力"]/200)
						end
						WAR.Person[WAR.CurID]["内力点数"] = AddPersonAttrib(pid, "内力", -math.modf(JY.Person[pid]["内力"]/200)*200);
					end
					    War_Show_Count(WAR.CurID)
				    end
				end
				WAR.Person[WAR.CurID]["内力点数"] = AddPersonAttrib(pid, "内力", math.modf(JY.Person[pid]["内力最大值"]*0.1));
				War_Show_Count(WAR.CurID)
			end
			if BJY(pid) then --霍家剑气
			    WAR.CHZ[pid] = nil
			    WAR.ICE[pid] = nil
			    WAR.HOT[pid] = nil
				if JY.Person[pid]["内力"] > 200 then
				    if WAR.HJJQ[pid] == nil or WAR.HJJQ[pid] < 10 then
				        local a = 10
					    if WAR.HJJQ[pid] == nil then 
					        a = 10 
					    elseif WAR.HJJQ[pid] ~= nil and WAR.HJJQ[pid] < 10 then 
					        a = a - WAR.HJJQ[pid]
					    end 
				        if math.modf(JY.Person[pid]["内力"]/200) > a then
					        WAR.HJJQ[pid] = 10
						    WAR.Person[WAR.CurID]["内力点数"] = AddPersonAttrib(pid, "内力", -a*200);
					else
					    if WAR.HJJQ[pid] == nil then 
						    WAR.HJJQ[pid] = math.modf(JY.Person[pid]["内力"]/200)
						else
						    WAR.HJJQ[pid] = WAR.HJJQ[pid]+math.modf(JY.Person[pid]["内力"]/200)
						end
						WAR.Person[WAR.CurID]["内力点数"] = AddPersonAttrib(pid, "内力", -math.modf(JY.Person[pid]["内力"]/200)*200);
					end
					    War_Show_Count(WAR.CurID)
				    end
				end
				WAR.Person[WAR.CurID]["内力点数"] = AddPersonAttrib(pid, "内力", math.modf(JY.Person[pid]["内力最大值"]*0.1));
				War_Show_Count(WAR.CurID)
			end
			if hasTF(pid, 68) then
				if JLSD(10, 30, pid) then
					DHdisplay(2243, 2259, "潜龙在渊・防御")
					WAR.Defup[pid] = 1 
				end
			end
			if WAR.WZJS[pid] == 1 then
				WAR.Person[WAR.CurID]["生命点数"] = (WAR.Person[WAR.CurID]["生命点数"] or 0)+AddPersonAttrib(pid, "生命", -WAR.YDBS*30);
				War_Show_Count(WAR.CurID)
			   WAR.YDBS = 0
			   WAR.WZJS[pid] = nil
			end	  
			if PersonKF(pid,179) and PersonKF(pid,85) then 
				WAR.Person[WAR.CurID]["内力点数"] = AddPersonAttrib(pid, "内力", WAR.LBPM*100);
				if MPPD(pid) == 7 and MPDJ(pid) > 3 then
					WAR.Person[WAR.CurID]["内力点数"] = AddPersonAttrib(pid, "内力", WAR.LBPM*200)
				end
				War_Show_Count(WAR.CurID)
				WAR.LBPM = 0
			end
			if wglw(pid,178) or (DT(pid,69) and PersonKF(pid,178)) or T9ZY(pid) or DT(pid,602) then --九龙功
				if JLSD(10, 40, pid) then
					DHdisplay(2243, 2259, "潜龙在渊・防御")
					WAR.Defup[pid] = 1 
				end
			end
			if MP11(pid) then--and JLSD(10,40,pid)) or ((XYL(pid) or jtyl(pid)) and PersonKF(pid,115) and JLSD(10,20,pid)) then --17-3-1
			   local a = 1
			   if WAR.JQ[pid] ~= nil and WAR.JQ[pid] > 0 then 
			      a = a + WAR.JQ[pid]
			   end
			   if JLSD(10,30+a,pid) then 
               DHdisplay(2279, 2299, "秘剑演武 剑步谜影")--17-3-2
               WAR.MJYW[pid] = 1
			   end
            end
	        if wglw(pid,101) or ((DT(pid,117) or DT(pid,602)) and PersonKF(pid,101)) then	--唯我独尊--17-2-27
               WAR.Defup[pid] = 1
	        end
            if wglw(pid,182) or (DT(pid,5) and PersonGT(pid,182)) then 
				DHdisplay(370, 380, "太极神功・防御")
				WAR.Defup[pid] = 1 
			end
			if (DT(pid,64) or wglw(pid,999)) and WAR.ZYHB == 0 and WAR.ZYHB2 == 1 then --左右三连
				for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
					if JY.Person[pid]["武功" .. i] == WAR.ZYHB4 then
					DIYdisplay("空明互搏・"..JY.Wugong[WAR.ZYHB4]["名称"])
					if WAR.AutoFight == 1 or not WAR.Person[WAR.CurID]["我方"] then
						War_Fight_Sub(WAR.CurID, i, WAR.ZYHBS[1], WAR.ZYHBS[2])
					else
						War_Fight_Sub(WAR.CurID, i)
					end	
                    end					
				end
				WAR.ZYHBS = {}
				WAR.ZYHB4 = 0 --左右三连
				WAR.ZYHB2 = 0
			end
			if WAR.GSWS[1] ~= nil and not (DT(pid,69) and JX(pid)) then --丐世无双		
				for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
					if JY.Person[pid]["武功" .. i] == 80 then
					DIYdisplay("丐世无双・"..JY.Wugong[80]["名称"])
					if WAR.AutoFight == 1 or not WAR.Person[WAR.CurID]["我方"] then
						War_Fight_Sub(WAR.CurID, i, WAR.GSWS[1], WAR.GSWS[2])
					else
						War_Fight_Sub(WAR.CurID, i)
					end	
                    end					
				end
				WAR.GSWS = {}
			end	
			
			if WAR.GSWS1[1] ~= nil and not (DT(pid,69) and JX(pid)) then --丐世无双		
				for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
					if JY.Person[pid]["武功" .. i] == 26 then
					DIYdisplay("丐世无双・"..JY.Wugong[26]["名称"])
					if WAR.AutoFight == 1 or not WAR.Person[WAR.CurID]["我方"] then
						War_Fight_Sub(WAR.CurID, i, WAR.GSWS1[1], WAR.GSWS1[2])
					else
						War_Fight_Sub(WAR.CurID, i)
					end	
                    end					
				end
				WAR.GSWS1 = {}
			end	
			
			if WAR.GSWS[1] ~= nil and (DT(pid,69) and JX(pid)) then --丐世无双		
				for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
					if JY.Person[pid]["武功" .. i] == 80 then
					DIYdisplay("真神丐无双・".."龙纹打狗棒")
					WAR.HQGS=1
					WAR.HQGSTS=1
					if WAR.AutoFight == 1 or not WAR.Person[WAR.CurID]["我方"] then
						War_Fight_Sub(WAR.CurID, i, WAR.GSWS[1], WAR.GSWS[2])
					else
						War_Fight_Sub(WAR.CurID, i)
					end
                    WAR.HQGS=0
                    WAR.HQGSTS=0					
                    end					
				end
				WAR.GSWS = {}
			end	
			
			if WAR.GSWS1[1] ~= nil and (DT(pid,69) and JX(pid)) then --丐世无双		
				for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
					if JY.Person[pid]["武功" .. i] == 26 then
					DIYdisplay("真神丐无双・".."贪狼降龙掌")
					WAR.HQGS2=1
					WAR.HQGSTS2=1
					if WAR.AutoFight == 1 or not WAR.Person[WAR.CurID]["我方"] then
						War_Fight_Sub(WAR.CurID, i, WAR.GSWS1[1], WAR.GSWS1[2])
					else
						War_Fight_Sub(WAR.CurID, i)
					end	
					WAR.HQGS2=0
					WAR.HQGSTS2=0
                    end					
				end
				WAR.GSWS1 = {}
			end	
			
			if WAR.GSWS3[1] ~= nil and (DT(pid,55) and JX(pid)) then --翔龙箭		
				for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
					if JY.Person[pid]["武功" .. i] == 148 then
					DIYdisplay("射雕英雄・".."翔龙飞箭")
					WAR.HQGS3=1
					WAR.HQGSTS3=1
					if WAR.AutoFight == 1 or not WAR.Person[WAR.CurID]["我方"] then
						War_Fight_Sub(WAR.CurID, i, WAR.GSWS1[1], WAR.GSWS1[2])
					else
						War_Fight_Sub(WAR.CurID, i)
					end	
					WAR.HQGS3=0
					WAR.HQGSTS3=0
                    end					
				end
				WAR.GSWS1 = {}
			end	
			
			if DT(pid, 626) and WAR.HZD[1] ~= nil then --何足道			
				local wgmenu = {}
				for i = 1, CC.Kungfunum do
					local tmp = JY.Person[pid]["武功" .. i]
					if tmp > 0 and not yongnei(tmp)	and JY.Wugong[tmp]["攻击力10"] > 0 then
						wgmenu[#wgmenu + 1] = {i, tmp}
					end
				end
				if #wgmenu ~= 0 then
					local tmp = wgmenu[math.random(#wgmenu)]
					DIYdisplay("琴觅音踪・"..JY.Wugong[tmp[2]]["名称"])
					if WAR.AutoFight == 1 or not WAR.Person[WAR.CurID]["我方"] then
						War_Fight_Sub(WAR.CurID, tmp[1], WAR.HZD[1], WAR.HZD[2])
					else
						War_Fight_Sub(WAR.CurID, tmp[1])
					end						
				end
				WAR.HZD = {}
			end			

			if (PersonGT(pid, 181) and (DT(pid, 455))) or (wglw(pid,181) and JLSD(10,45,pid) and PersonGTJL(pid,181,WAR.NGJL)) or (DT(pid,600) and JLSD(10,100,pid)) or (NF(pid) and JLSD(10,60,pid)and WAR.LQZ[pid] == 100 and juexing() > 1) then
				local wgmenu = {}
				for i = 1, CC.Kungfunum do
					local tmp = JY.Person[pid]["武功" .. i]
					if tmp > 0 and not yongnei(tmp)	and JY.Wugong[tmp]["攻击力10"] > 0 then
						wgmenu[#wgmenu + 1] = {i, tmp}
					end
				end
				if #wgmenu ~= 0 then
					local tmp = wgmenu[math.random(#wgmenu)]
					DIYdisplay("十方进招・"..JY.Wugong[tmp[2]]["名称"])
					if WAR.AutoFight == 1 or not WAR.Person[WAR.CurID]["我方"] then
						War_Fight_Sub(WAR.CurID, tmp[1], WAR.WWD[1], WAR.WWD[2])
					else
						War_Fight_Sub(WAR.CurID, tmp[1])
					end						
				end
				WAR.WWD = {}
			end 
			
            if WAR.KHTJ[1] ~= nil then --魔葵		
				for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
					if JY.Person[pid]["武功" .. i] == 48 then
					DIYdisplay("魔葵降世・"..JY.Wugong[48]["名称"])
					if WAR.AutoFight == 1 or not WAR.Person[WAR.CurID]["我方"] then
						War_Fight_Sub(WAR.CurID, i, WAR.KHTJ[1], WAR.KHTJ[2])
					else
						War_Fight_Sub(WAR.CurID, i)
					end	
                    end					
				end
				WAR.KHTJ = {}
			end	
			
			if WAR.KHTJ1[1] ~= nil then --魔葵		
				for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
					if JY.Person[pid]["武功" .. i] == 177 then
					DIYdisplay("魔葵降世・"..JY.Wugong[177]["名称"])
					if WAR.AutoFight == 1 or not WAR.Person[WAR.CurID]["我方"] then
						War_Fight_Sub(WAR.CurID, i, WAR.KHTJ1[1], WAR.KHTJ1[2])
					else
						War_Fight_Sub(WAR.CurID, i)
					end	
                    end					
				end
				WAR.KHTJ1 = {}
			end				
			
			if WAR.LYDJLW[1] ~= nil then --两仪微尘	
				for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
					if JY.Person[pid]["武功" .. i] == 60 then
					DIYdisplay("阴阳生灭・反两仪刀")
					if WAR.AutoFight == 1 or not WAR.Person[WAR.CurID]["我方"] then
						War_Fight_Sub(WAR.CurID, i, WAR.LYDJLW[1], WAR.LYDJLW[2])
					else
						War_Fight_Sub(WAR.CurID, i)
					end	
                    end					
				end
				WAR.LYDJLW = {}
			end	
			
			if WAR.LYDJLW1[1] ~= nil then --两仪微尘 		
				for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
					if JY.Person[pid]["武功" .. i] == 37 then
					DIYdisplay("两仪流转・两仪剑法")
					if WAR.AutoFight == 1 or not WAR.Person[WAR.CurID]["我方"] then
						War_Fight_Sub(WAR.CurID, i, WAR.LYDJLW1[1], WAR.LYDJLW1[2])
					else
						War_Fight_Sub(WAR.CurID, i)
					end	
                    end					
				end
				WAR.LYDJLW1 = {}
			end
			
			if WAR.NTLW2[1] ~= nil then
				for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
					if JY.Person[pid]["武功" .. i] == 45 then
					DIYdisplay("怒涛不尽・剑潮无极")
					WAR.NTLW3 = 1
					if WAR.AutoFight == 1 or not WAR.Person[WAR.CurID]["我方"] then
						War_Fight_Sub(WAR.CurID, i, WAR.NTLW2[1], WAR.NTLW2[2])
					else
						War_Fight_Sub(WAR.CurID, i)
					end	
                    end					
				end
				WAR.NTLW2 = {}
			end	
			
			if WAR.FXDZ[1] ~= nil then --魔葵		
				for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
					if JY.Person[pid]["武功" .. i] == 139 then
					DIYdisplay("佛刑禅那・战佛降魔")
					if WAR.AutoFight == 1 or not WAR.Person[WAR.CurID]["我方"] then
						War_Fight_Sub(WAR.CurID, i, WAR.FXDZ[1], WAR.FXDZ[2])
					else
						War_Fight_Sub(WAR.CurID, i)
					end	
                    end					
				end
				WAR.FXDZ = {}
			end	
			
			if WAR.FXDZ1[1] ~= nil then --魔葵		
				for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
					if JY.Person[pid]["武功" .. i] == 65 then
					DIYdisplay("涤罪犀角・业火佛狱", M_DarkOrange)
					if WAR.AutoFight == 1 or not WAR.Person[WAR.CurID]["我方"] then
						War_Fight_Sub(WAR.CurID, i, WAR.FXDZ1[1], WAR.FXDZ1[2])
					else
						War_Fight_Sub(WAR.CurID, i)
					end	
                    end					
				end
				WAR.FXDZ1 = {}
			end
			
			if WAR.JSJZ2[1] ~= nil then
				for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
					if JY.Person[pid]["武功" .. i] == 173 then
					DIYdisplay("金光炫目・蛇锥夺魂")
					WAR.JSJZ3 = 1
					if WAR.AutoFight == 1 or not WAR.Person[WAR.CurID]["我方"] then
						War_Fight_Sub(WAR.CurID, i, WAR.JSJZ2[1], WAR.JSJZ2[2])
					else
						War_Fight_Sub(WAR.CurID, i)
					end
					WAR.JSJZ3 = 0	
                    end					
				end
				WAR.JSJZ2 = {}
			end
			
			if WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 and GetS(86, 2, 13, 5) == 3 then 
                if pid == 118 then 
			        DHdisplay(2279, 2299, "逍遥三圣 秋水凌波")
			        for j = 0,WAR.PersonNum-1 do 
				        if WAR.Person[WAR.CurID]["我方"] == WAR.Person[j]["我方"] and WAR.Person[j]["死亡"] == false then 
					        --WAR.Person[j]["生命点数"] = AddPersonAttrib(WAR.Person[j]["人物编号"], "生命", math.modf(JY.Person[WAR.Person[j]["人物编号"]]["生命最大值"]*0.1));
				            --War_Show_Count(WAR.CurID)
					        WAR.QSLB[WAR.Person[j]["人物编号"]] = 1
					    end
				    end	 
                end
                if pid == 117 then 
			        DHdisplay(2279, 2299, "逍遥三圣 不老长春")
			        for j = 0,WAR.PersonNum-1 do 
				        if WAR.Person[WAR.CurID]["我方"] == WAR.Person[j]["我方"] and WAR.Person[j]["死亡"] == false then 
					        WAR.Person[j]["生命点数"] = (WAR.Person[j]["生命点数"] or 0)+AddPersonAttrib(WAR.Person[j]["人物编号"], "生命", math.modf(JY.Person[WAR.Person[j]["人物编号"]]["生命最大值"]*0.1));
				            War_Show_Count(WAR.CurID)
					    end
				    end	 
                end	
                if pid == 116 then 
			        DHdisplay(2279, 2299, "逍遥三圣 北冥有鱼")
			        for j = 0,WAR.PersonNum-1 do 
				        if WAR.Person[WAR.CurID]["我方"] == WAR.Person[j]["我方"] and WAR.Person[j]["死亡"] == false then
					        local a = JY.Person[WAR.Person[j]["人物编号"]]["生命"]/JY.Person[WAR.Person[j]["人物编号"]]["生命最大值"]
						    local b = JY.Person[WAR.Person[j]["人物编号"]]["内力"]/JY.Person[WAR.Person[j]["人物编号"]]["内力最大值"]
						    if a < b then 
						        JY.Person[WAR.Person[j]["人物编号"]]["生命"] = math.modf(JY.Person[WAR.Person[j]["人物编号"]]["生命最大值"]*b)
						        JY.Person[WAR.Person[j]["人物编号"]]["内力"] = math.modf(JY.Person[WAR.Person[j]["人物编号"]]["内力最大值"]*a)
						    end   
					    end
				    end	 
                end			   
			end   
	        WAR.QKNY = 0
	        if WAR.LQZ[id] == 100 then
	            if MPPD(id) == 6 and WAR.XUEMO[id] ~= nil then
			    elseif DT(id, 50) then --武骧金星：萧峰加强
			    elseif T13TQS(id) and juexing()>2 then --沼跃鱼：滕青山兽血沸腾
			    elseif wssz(id) then --沼跃鱼：滕文婷兽血沸腾
			    elseif DT(id, 129) and WAR.WCY3>0 then --沼跃鱼：重阳真打
			    elseif DT(id, 65) and WAR.WCY4>0 then --沼跃鱼：重阳真打
			    elseif wglw1(id,58) then
				elseif DT(id,582) and JX(id) then --木婉清觉醒暴怒不退
			    elseif T9ZY(id) and WAR.ZYWS > 0 then
			    elseif WAR.ZDNQ[id] == 1 and PersonGT(id, 102) then 
					WAR.ZDNQ[id] = 0
				else
					WAR.LQZ[id] = 0
			    end
	        end
	        
			
			if WAR.XRWDFN > 0 then
				local tmpid = WAR.Person[WAR.CurID]["人物编号"]
				if WAR.LQZ[tmpid] ~= nil and WAR.LQZ[tmpid] >= 99 then
					WAR.LQZ[tmpid] = 100
				end
				WAR.XRWDFN = 0
			end
			
			--JY.Person[0]["生命"] = 1 --测试
			
	        --杨过 吼  龙儿~~
	        if WAR.XK == 1 then
	            for j = 0, WAR.PersonNum - 1 do
	                if WAR.Person[j]["人物编号"] == 58 and 0 < JY.Person[WAR.Person[j]["人物编号"]]["生命"] and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
	                    WAR.Person[j].Time = 980
	                    say(CC.WARS16, 58)
	                    WAR.XK = 2
	                end
	            end
	        end
			
			if WAR.LSH == 1 then --凌霜华退场
				say("霜华－－－－－－！！！！", 632)		
				WAR.LSH = 2
			end
	        
		    for j = 0, WAR.PersonNum - 1 do
			    if WAR.Person[j]["人物编号"] == 633 and not WAR.Person[j]["死亡"] and WAR.LSH2 == 1 then
				    WAR.Person[j].Time = 990
				    JY.Person[WAR.Person[j]["人物编号"]]["生命"] = JY.Person[WAR.Person[j]["人物编号"]]["生命"] - 200
				    if JY.Person[WAR.Person[j]["人物编号"]]["生命"] < 0 then JY.Person[WAR.Person[j]["人物编号"]]["生命"] = 1 end
				        WAR.LSH2 = 0
				    break
			    end
		    end			
			
			if WAR.PLJZ3 ~= 0 then
				if yesno("要发动一掷生死复活"..JY.Person[WAR.PLJZ3]["姓名"].."吗？") then
					local d = 0
					for i = 1, 10 do
						d = math.random(6) + 223
						Cls()
						lib.PicLoadCache(90, d * 2, CC.ScreenW / 2, CC.ScreenH / 2)
						ShowScreen()
						lib.Delay(20 + i * 10)
					end
					WaitKey()
					d = d - 223
					if math.fmod(d, 2) == 1 then
						say("一掷生死・生！")
						AddPersonAttrib(WAR.PLJZ3, "生命", 10000)		
					else
						tb("一掷生死失败！")
						JY.Person[zj()]["生命"] = 1
						JY.Person[zj()]["内力"] = 1
						JY.Person[zj()]["体力"] = 1
					end
				end
				WAR.PLJZ3 = 0
			end
			
	        --发动 难知如阴
	        if WAR.FLHS5 == 1 then
	            local z = WAR.CurID
	            for j = 0, WAR.PersonNum - 1 do
	                if WAR.Person[j]["人物编号"] == 0 and 0 < JY.Person[0]["生命"] then
	                    WAR.FLHS5 = 0
	                    WAR.CurID = j
	                end
	            end
	            if WAR.FLHS5 == 0 and WAR.AutoFight == 0 and WAR.tmp[1000] ~= 1 then
	                WAR.Person[WAR.CurID]["移动步数"] = 6
	                War_CalMoveStep(WAR.CurID, WAR.Person[WAR.CurID]["移动步数"], 0)
	                local x, y = nil, nil
	                while 1 do
	                x, y = War_SelectMove()
	                if x ~= nil then
	                    WAR.ShowHead = 0
	                    War_MovePerson(x, y)
	                    break;
	                end
	            end
	            end
	            WAR.FLHS5 = 0
	            WAR.CurID = z
	        end
	        
	        --圣火神功 攻击后可移动and inteam(WAR.Person[p]["人物编号"]
	        if (0 < WAR.Person[p]["移动步数"] or 0 < WAR.ZYYD or PersonGT(WAR.Person[p]["人物编号"], 93)) 
				and WAR.Person[p]["我方"] == true and WAR.AutoFight == 0 and WAR.tmp[1000 + id] ~= 1 
				and PersonKF(WAR.Person[p]["人物编号"], 93) and 0 < JY.Person[WAR.Person[p]["人物编号"]]["生命"] then--沼跃鱼：圣火或者拟兽式狼吻再移动
	            if 0 < WAR.ZYYD then
	                WAR.Person[p]["移动步数"] = WAR.ZYYD
	                War_CalMoveStep(p, WAR.ZYYD, 0)
	                WAR.ZYYD = 0
			else
	            if (PersonGT(WAR.Person[p]["人物编号"], 93)) and WAR.SHENGHUO[p] ~= nil then --沼跃鱼：圣火主功体或者拟兽式狼吻必定再移动
					WAR.Person[p]["移动步数"] = WAR.SHENGHUO[p]
				end
				    War_CalMoveStep(p, WAR.Person[p]["移动步数"], 0)
	            end
	                local x, y = nil, nil
	                while 1 do
	                x, y = War_SelectMove()
	                if x ~= nil then
	                    WAR.ShowHead = 0
	                    War_MovePerson(x, y)
	                    break;
	                end 
	            end
	        end
			
			if WAR.Person[p]["我方"] == true and WAR.AutoFight == 0 and WAR.tmp[1000 + id] ~= 1 
				and DT(WAR.Person[p]["人物编号"], 57) and 0 < JY.Person[WAR.Person[p]["人物编号"]]["生命"] then--沼跃鱼：圣火或者拟兽式狼吻再移动
	            if 0 < WAR.ZYYD then
	                WAR.Person[p]["移动步数"] = WAR.ZYYD
	                War_CalMoveStep(p, WAR.ZYYD, 0)
	                WAR.ZYYD = 0
				else
					if WAR.SHENGHUO[p] ~= nil then
						WAR.Person[p]["移动步数"] = 60-WAR.SHENGHUO[p]
					else
						WAR.Person[p]["移动步数"] = 30
					end
					if (PersonGT(WAR.Person[p]["人物编号"], 93)) and WAR.SHENGHUO[p] ~= nil then --沼跃鱼：圣火主功体或者拟兽式狼吻必定再移动
						WAR.Person[p]["移动步数"] = WAR.SHENGHUO[p] + 4
					end
					   DHdisplay(2704, 2730, "狂风身法再移动")
					   War_CalMoveStep(p, WAR.Person[p]["移动步数"], 0) --凡总必定再动
					if DT(WAR.Person[p]["人物编号"], 457) and WAR.SHENGHUO[p] ~= nil then
						WAR.Person[p]["移动步数"] = WAR.SHENGHUO[p] + 10
					end
					DHdisplay(1124, 1141, "再动")
					War_CalMoveStep(p, WAR.Person[p]["移动步数"], 0)
	            end
	                local x, y = nil, nil
	                while 1 do
	                x, y = War_SelectMove()
	                if x ~= nil then
	                    WAR.ShowHead = 0
	                    War_MovePerson(x, y)
	                    break;
	                end 
	            end
	        end
			
			if WAR.Person[p]["我方"] == true and WAR.AutoFight == 0 and WAR.tmp[1000 + id] ~= 1 
				and wglw1(WAR.Person[p]["人物编号"], 48) and WAR.BXJF == 5 and 0 < JY.Person[WAR.Person[p]["人物编号"]]["生命"] then--沼跃鱼：圣火或者拟兽式狼吻再移动
	            if 0 < WAR.ZYYD then
	                WAR.Person[p]["移动步数"] = WAR.ZYYD
	                War_CalMoveStep(p, WAR.ZYYD, 0)
	                WAR.ZYYD = 0
				else
					if (PersonGT(WAR.Person[p]["人物编号"], 93)) and WAR.SHENGHUO[p] ~= nil then --沼跃鱼：圣火主功体或者拟兽式狼吻必定再移动
						WAR.Person[p]["移动步数"] = WAR.SHENGHUO[p] + 2
					end
					DHdisplay(2704, 2730, "辟邪・迅影")
					War_CalMoveStep(p, WAR.Person[p]["移动步数"], 0)
				end
				local x, y = nil, nil
				while 1 do
					x, y = War_SelectMove()
					if x ~= nil then
						WAR.ShowHead = 0
						War_MovePerson(x, y)
						break;
					end 
	            end
	        end
			
			if (wglw(pid,93) or (DT(pid,66) and PersonKF(pid,93))) and inteam(pid) and WAR.HGB[100+pid] == nil then --17-2-19-幻光步
			    hgb()
			end
			if MPPD(pid) == 9 and WAR.TMMS[pid] == 2 then --唐门模式图穷匕见
			if WAR.ACSJ[100+pid] ~= nil and WAR.ACSJ[200+pid] ~= nil and WAR.ACSJ[300+pid] ~= nil then 
			   DHdisplay(657, 678, "图穷匕见")
			   CleanWarMap(4,0)
			local x1 = WAR.ACSJ[100+pid][1];
			local y1 = WAR.ACSJ[100+pid][2];
			for ex = x1 - 5, x1 + 5 do
				for ey = y1 - 5, y1 + 5 do
					SetWarMap(ex, ey, 4, 1)
					if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
						local ep = GetWarMap(ex, ey, 2)
						if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[ep]["我方"] then
				           --WAR.Person[ep]["生命点数"] = AddPersonAttrib(WAR.Person[ep]["人物编号"], "生命", -100);
				           --War_Show_Count(WAR.CurID)
					       if WAR.ACSJ[500+WAR.Person[ep]["人物编号"]] == nil then 
					       WAR.ACSJ[500+WAR.Person[ep]["人物编号"]] = 1
						   else 
						   WAR.ACSJ[500+WAR.Person[ep]["人物编号"]] = WAR.ACSJ[500+WAR.Person[ep]["人物编号"]]+1
						   end
							SetWarMap(ex, ey, 4, 4)
						end
					end
				end
			end
			--War_ShowFight(pid,0,0,0,x1,y1,135);
			local x1 = WAR.ACSJ[200+pid][1];
			local y1 = WAR.ACSJ[200+pid][2];
			for ex = x1 - 5, x1 + 5 do
				for ey = y1 - 5, y1 + 5 do
					SetWarMap(ex, ey, 4, 1)
					if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
						local ep = GetWarMap(ex, ey, 2)
						if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[ep]["我方"] then
				           --WAR.Person[ep]["生命点数"] = AddPersonAttrib(WAR.Person[ep]["人物编号"], "生命", -100);
				     --War_Show_Count(WAR.CurID)
					       if WAR.ACSJ[500+WAR.Person[ep]["人物编号"]] == nil then 
					       WAR.ACSJ[500+WAR.Person[ep]["人物编号"]] = 1
						   else 
						   WAR.ACSJ[500+WAR.Person[ep]["人物编号"]] = WAR.ACSJ[500+WAR.Person[ep]["人物编号"]]+1
						   end
							SetWarMap(ex, ey, 4, 4)
						end
					end
				end
			end
			--War_ShowFight(pid,0,0,0,x1,y1,135);
			local x1 = WAR.ACSJ[300+pid][1];
			local y1 = WAR.ACSJ[300+pid][2];
			for ex = x1 - 5, x1 + 5 do
				for ey = y1 - 5, y1 + 5 do
					SetWarMap(ex, ey, 4, 1)
					if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
						local ep = GetWarMap(ex, ey, 2)
						if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[ep]["我方"] then
				           --WAR.Person[ep]["生命点数"] = AddPersonAttrib(WAR.Person[ep]["人物编号"], "生命", -100);
				     --War_Show_Count(WAR.CurID)
					       if WAR.ACSJ[500+WAR.Person[ep]["人物编号"]] == nil then 
					       WAR.ACSJ[500+WAR.Person[ep]["人物编号"]] = 1
						   else 
						   WAR.ACSJ[500+WAR.Person[ep]["人物编号"]] = WAR.ACSJ[500+WAR.Person[ep]["人物编号"]]+1
						   end
							SetWarMap(ex, ey, 4, 4)
						end
					end
				end
			end
			for j = 0,WAR.PersonNum-1 do 
			   if WAR.Person[j]["我方"] ~=  WAR.Person[WAR.CurID]["我方"] and WAR.Person[j]["死亡"] == false and WAR.ACSJ[500+WAR.Person[j]["人物编号"]] ~= nil then 
			      WAR.Person[j]["生命点数"] = (WAR.Person[j]["生命点数"] or 0) + AddPersonAttrib(WAR.Person[j]["人物编号"], "生命", -WAR.ACSJ[500+WAR.Person[j]["人物编号"]]*70);
				  WAR.ACSJ[500+WAR.Person[j]["人物编号"]] = nil 
			   end 
			end   
			War_ShowFight(pid,0,0,0,x1,y1,135);
			WAR.ACSJ[100+pid] = nil
			WAR.ACSJ[200+pid] = nil
			WAR.ACSJ[300+pid] = nil
			end
			end
			if (wglw(pid,93) or (DT(pid,66) and PersonKF(pid,93))) and JLSD(10,40,pid) then 
				DHdisplay(657, 678, "筋肉分离散 毛骨森似寒")
				WAR.HIDE[pid] = 20
			end
			WAR.GTMENU = 1 --重置功体菜单显示
			WAR.OWN = 1 			
		
	        --雪山上杀血刀老祖后，恢复我方人物
	        if WAR.ZDDH == 7 then
	            for x = 0, WAR.PersonNum - 1 do
	                if WAR.Person[x]["人物编号"] == 97 and JY.Person[97]["生命"] <= 0 then
	                    for xx = 0, WAR.PersonNum - 1 do
	                        if WAR.Person[xx]["人物编号"] ~= 97 then
	                            WAR.Person[xx]["我方"] = true
	                        end
	                    end
	                end
	            end
	        end
	          
	        if WAR.ZDDH == 176 and 80 < JY.Person[0]["品德"] and WAR.EVENT1 == 0 and 300 < WAR.SXTJ then
	            for i = 32, 40 do
	                if GetWarMap(i, 32, 2) < 0 then
	                    NewWARPersonZJ(69, true, i, 33, false, 1)
	                    WAR.EVENT1 = 1
	                    local s = nil
	                    s = WAR.CurID
	                    WAR.CurID = WAR.PersonNum - 1
	                    say(CC.say1, 69)   --老叫化也来凑个热闹
	                    WAR.CurID = s
	                    break;
	                end
	            end
	        end

	        if WAR.ZDDH ~= 133 and 100 <= JY.Person[0]["品德"] and WAR.ZHDFBB == 0 and JY.Person[0]["生命"]< JY.Person[0]["生命最大值"]/2 
			    and GetS(54,0,0,1) == 2 and WAR.ZDDH ~= 226 and WAR.ZDDH ~= 20 and WAR.ZDDH ~= 341 and GetS(4, 7, 7, 5) == 2 then
	            for i = 32, 40 do
	                if GetWarMap(i, 32, 2) < 0 then
	                    NewWARPersonZJ(27, true, i, 33, false, 1)
	                    WAR.ZHDFBB = 1
	                    local s = nil
	                    s = WAR.CurID
	                    WAR.CurID = WAR.PersonNum - 1
				        if JY.Person[0]["性别"] == 1 then
	                        say("谁敢动我妹妹", 27)   --
				        else
				            say("谁敢动我弟弟", 27) 
				        end
	                    WAR.CurID = s
	                    break;
	                end
	            end
	        end
			
			if JY.SubScene == 113 and WAR.ZDDH >= 0 and WAR.HZZY == 0 and GetS(99,1,1,0) == 1 and GetS(106, 11, 0, 0) == 0 and 100 <= JY.Person[0]["品德"] then 
	            for i = 32, 40 do
	                if GetWarMap(i, 32, 2) < 0 then
	                    NewWARPersonZJ(455, true, i, 32, false, 1)
	                    local s = nil
	                    s = WAR.CurID
	                    WAR.CurID = WAR.PersonNum - 1
	                    say("唉，少侠麻烦不少啊。", 455)   --
	                    WAR.CurID = s
	                    break;
	                end
	            end
	            for i = 33, 40 do
	                if GetWarMap(i, 32, 2) < 0 then
	                    NewWARPersonZJ(597, true, i, 32, false, 1)
	                    local s = nil
	                    s = WAR.CurID
	                    WAR.CurID = WAR.PersonNum - 1
	                    say("谁敢动我老公和少侠我就打谁。", 597)   --
	                    WAR.CurID = s
	                    break;
	                end
	            end
			    WAR.HZZY = 1
			end 
			
            if WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 and GetS(86, 2, 9, 5) == 3 and 5 < WAR.SXTJ and WAR.TJPL == 0 and 100 <= JY.Person[0]["品德"] then			
                for i = 32, 40 do
	                if GetWarMap(i, 32, 2) < 0 then
	                    NewWARPersonZJ(455, true, i, 33, false, 1)
						WAR.Person[WAR.PersonNum - 1].Time = 1000
	                    WAR.TJPL = 1
	                    local s = nil
	                    s = WAR.CurID
	                    WAR.CurID = WAR.PersonNum - 1
	                    say("少侠小心。", 455)   
				        say("前辈！", 0) 
				        say("师傅让我来此助少侠破阵。", 455)	
				        say("多谢前辈。", 0)	
				        say("让我来破阵", 455)	
				        say("前辈小心！", 0)	 
	                    WAR.CurID = s
	                    break;
	                end
	            end
			end			
			
            if WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 and GetS(86, 2, 9, 5) == 3 and 15 < WAR.SXTJ and WAR.TJPL == 1 and 100 <= JY.Person[0]["品德"] then			
                for i = 32, 40 do
	                if GetWarMap(i, 32, 2) < 0 then
	                    NewWARPersonZJ(597, true, i, 33, false, 1)
						WAR.Person[WAR.PersonNum - 1].Time = 1000
	                    WAR.TJPL = 2
	                    local s = nil
	                    s = WAR.CurID
	                    WAR.CurID = WAR.PersonNum - 1
	                    say("天机盘龙阵如此厉害。", 597)   
				        say("无悠！", 455) 
				        say("谢宗主！", 0)	
				        say("老公，武大叔请我来助你", 597)			
				        say("师傅他老人家多虑了！", 455) 
				        say("老公！不要小瞧这个阵。", 597)
				        say("为什么？", 455)
				        say("武大叔说过，天机盘龙阵由当世高手组成，能挡千军万马，百万雄师！。", 597)
				        say("如此厉害？", 455)
				        say("不止如此，天机盘龙，千变万化，阵心不死，盘龙不灭！", 597)
				        say("如此，我拖住他们，你找到阵心将其击破", 455)
				        say("老公你自己也要小心！", 597)
				        say("你也要小心，老婆！", 455)
	                    WAR.CurID = s
	                    break;
	                end
	            end
			end							

            if WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 and GetS(86, 2, 14, 5) == 3 then
                for a = 0, WAR.PersonNum - 1 do
                    if WAR.Person[a]["我方"] == true then
                        WAR.Person[a].Time = 0
			        end
                end
            end		
			
	        --杀东方不败，任老怪出现
	        if WAR.ZDDH == 54 and WAR.EVENT1 == 0 then
	            for i = 0, WAR.PersonNum - 1 do
	                if WAR.Person[i]["人物编号"] == 73 and WAR.Person[i]["我方"] == true and JY.Person[WAR.Person[i]["人物编号"]]["生命"] <= 0 then
	                    for r = 31, 42 do
	                        if GetWarMap(r, 27, 2) < 0 then
	                            NewWARPersonZJ(26, true, r, 27, false, 2)
	                            WAR.Person[WAR.PersonNum - 1].Time = 900
	                            WAR.EVENT1 = 1
	                            local s = nil
	                            s = WAR.CurID
	                            WAR.CurID = WAR.PersonNum - 1
	                            say(CC.s22, 26)   --盈盈，你先退下！为父来会会你东方阿姨，哈哈哈----
	                            WAR.CurID = s
	                            break;
	                        end
	                    end
	                end
		        end
	        end				
			
	        if WAR.ZDDH >= 0 and WAR.EVENT1 == 0 then
	            for i = 0, WAR.PersonNum - 1 do
	                if WAR.Person[i]["人物编号"] == 617 and WAR.Person[i]["我方"] == true and JY.Person[WAR.Person[i]["人物编号"]]["生命"] <= 3000 then
	                    for r = 31, 42 do
							local x, y = WE_xy(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] - 1)
				            NewWARPersonZJ(598, true, x, y, false, 2);
	                        --NewWARPersonZJ(598, false, 48,47, false, 0)
	                        WAR.Person[WAR.PersonNum - 1].Time = 1000
	                        WAR.EVENT1 = 1
	                        local s = nil
	                        s = WAR.CurID
	                        WAR.CurID = WAR.PersonNum - 1
	                        say("春哥选技师！", 598) 
	                        WAR.CurID = s
	                        break;
	                    end
	                end
		        end
	        end	

			if WAR.ZDDH >= 0 and WAR.EVENT1 == 0 then
	            for i = 0, WAR.PersonNum - 1 do
	                if WAR.Person[i]["人物编号"] == 104 and WAR.Person[i]["我方"] == true and JY.Person[WAR.Person[i]["人物编号"]]["生命"] <= 100 then
						if WAR.ZDDH ~= 134 and WAR.ZDDH ~= 226 and WAR.ZDDH ~= 341 and WAR.ZDDH ~= 342 and JY.Person[50]["姓名"] == "萧峰" then
							for r = 31, 42 do
								local x, y = WE_xy(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] - 1)
								NewWARPersonZJ(50, true, x, y, false, 2);
								WAR.Person[WAR.PersonNum - 1].Time = 1000
								WAR.EVENT1 = 1
								local s = nil
								s = WAR.CurID
								WAR.CurID = WAR.PersonNum - 1
								WAR.LQZ[50] = 100
								Talk("阿朱小心，这等局面，便由我来应付！", 50)
								Talk("大哥，千万小心", 104) 		
								WAR.CurID = s
								break;
							end
						end
	                end
		        end
	        end	
			
			if WAR.ZDDH >= 0 and WAR.EVENT1 == 0 then
	            for i = 0, WAR.PersonNum - 1 do
	                if WAR.Person[i]["人物编号"] == 47 and WAR.Person[i]["我方"] == true and JY.Person[WAR.Person[i]["人物编号"]]["生命"] <= 100 then
	                    for r = 31, 42 do
							local x, y = WE_xy(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] - 1)
				            NewWARPersonZJ(48, true, x, y, false, 2);
	                        WAR.Person[WAR.PersonNum - 1].Time = 1000
	                        WAR.EVENT1 = 1
	                        local s = nil
	                        s = WAR.CurID
	                        WAR.CurID = WAR.PersonNum - 1
	                        WAR.LQZ[48] = 100
				            Talk("臭铁头，你在哪里？快来救我！！", 47) 	
							Talk("阿紫姑娘别怕，铁头会保护你！", 48)
				            Talk("笨铁头！快点，给本姑娘打死他们！", 47) 		
	                        WAR.CurID = s
	                        break;
	                    end
	                end
		        end
	        end	
			
				
            if GetS(86, 2, 10, 5) == 3 and JY.Person[429]["用毒能力"]==0 and WAR.SXTJ > 80 then
                NewWARPersonZJ(597, false, 48,47, false, 0)
                JY.Person[429]["用毒能力"]=1
                local s = nil
	            s = WAR.CurID
	            WAR.CurID = WAR.PersonNum - 1
	            say("老公我来了！", 597) 
				say("替武大叔做考验，好好玩！", 597) 
	            WAR.CurID = s
            end				
			
            if GetS(86, 2, 9, 5) == 3 and JY.Person[429]["用毒能力"]==0 and WAR.SXTJ > 10 then	
				NewWARPersonZJ(592, false, 48,47, false, 0)
                JY.Person[429]["用毒能力"]=1
                local s = nil
	            s = WAR.CurID
	            WAR.CurID = WAR.PersonNum - 1
	            say("哈哈哈，如此大战怎能少了某！", 592) 
	            WAR.CurID = s
            end						
			
            if WAR.ZDDH == 80 and JY.Person[429]["用毒能力"]==0 and WAR.SXTJ > 10 then
                NewWARPersonZJ(457, false, 48,47, false, 0)
                JY.Person[429]["用毒能力"]=1
                local s = nil
	            s = WAR.CurID
	            WAR.CurID = WAR.PersonNum - 1
	            say("谁如此大胆，来少林滋事？", 457)   
				say("师弟，是你吗？", 114) 
				say("师兄，大敌当前，有话稍后在说。", 457)	
				say("小子，如此大胆！", 457)			
			    say("是你.....你到底是何人？为何阻扰我？", 0) 
				say("阻扰？只能怪你滋扰少林了。", 457)
				say("今日之事，势在必行，谁也不能阻扰我！", 0)
				say("多说无益，进招吧！", 457)
				say("诸位小心了，阿弥陀佛！", 114)
				say("来吧！", 0)
	            WAR.CurID = s
			end							
			
            if WAR.ZDDH == 367 and JY.Person[429]["用毒能力"]==0 and WAR.SXTJ > 10 then
                NewWARPersonZJ(457, false, 48,47, false, 0)
                JY.Person[429]["用毒能力"]=1
                local s = nil
	            s = WAR.CurID
	            WAR.CurID = WAR.PersonNum - 1
	            say("哈哈哈哈，萧兄我来助你！", 457)   
				say("阁下是？", 50) 
				say("萧兄，不用管我是谁，只要知道我不是来为难你的就够了！", 457)	
				say("萧某先谢过兄台了！", 50)			
			    say("小子！之前我说过的，我们山水有相逢。", 457) 
				say("？？？？你是龙门客栈的那个........", 0)
				say("小子，记性不错，准备好了吗？", 457)
				say("铁头，国师，慕容公子，此人厉害万分，请小心应付。", 0)
				say("好！", 51)
				say("铁头明白！", 48)
				say("如此，小僧可要认真了！", 595)
	            WAR.CurID = s
			end				
			
	        if WAR.ZDDH == 54 and lib.GetWarMap(11, 36, 1) == 2 and inteam(WAR.Person[p]["人物编号"]) and WAR.Person[p]["坐标X"] == 12 and WAR.Person[p]["坐标Y"] == 36 then
	            lib.SetWarMap(11, 36, 1, 5420)
	            WarDrawMap(0)
	            say("AA")
	            say("OHMYGO", 27)
	            lib.SetWarMap(11, 36, 1, 0)
	        end
	       
		    --行动后回气上限
			if DT(WAR.Person[p]["人物编号"],49) and JX(WAR.Person[p]["人物编号"]) and 800 < WAR.Person[p].Time then--沼跃鱼：觉醒虚竹最大集气可以达到800
			    WAR.Person[p].Time = 800
			elseif DT(WAR.Person[p]["人物编号"],104) and JX(WAR.Person[p]["人物编号"]) and 900 < WAR.Person[p].Time then--沼跃鱼：觉醒虚竹最大集气可以达到800
			    WAR.Person[p].Time = 900
			elseif DT(WAR.Person[p]["人物编号"],621) and JX(WAR.Person[p]["人物编号"]) and 800 < WAR.Person[p].Time then--沼跃鱼：觉醒胡一刀最大集气可以达到800
			    WAR.Person[p].Time = 800
			elseif (wglw(id,99) or (DT(id,5) and PersonKF(id,99))) and JLSD(10,35,id) then
			    if WAR.Person[p].Time > 999 then 
			        WAR.Person[p].Time = 999
			    end
            elseif DT(WAR.Person[p]["人物编号"],64) and JX(WAR.Person[p]["人物编号"]) and WAR.ZBT1>0 and 800 < WAR.Person[p].Time then	
                WAR.Person[p].Time = 800
			elseif wglw2(id,192) and PersonKF(id,192) and 800 < WAR.Person[p].Time then	
                WAR.Person[p].Time = 800	
	        elseif wglw1(WAR.Person[p]["人物编号"],48) or (DT(WAR.Person[p]["人物编号"],36) and PersonKF(WAR.Person[p]["人物编号"],48) and JX(WAR.Person[p]["人物编号"])) then	
				if WAR.Person[p].Time > 999 then 
			        WAR.Person[p].Time = 999
			    end
			elseif 600 < WAR.Person[p].Time then --最大600集气，改了
	            WAR.Person[p].Time = 600
	        end
			
			--豸苗：谢云流封步剑
	        if WAR.JQNF[id] == 1 then
				WAR.Person[p].Time = -200
				WAR.JQNF[id] = 0
			end
			
			for j = 0, WAR.PersonNum - 1 do 
				if PersonGT(WAR.Person[j]["人物编号"], 108) then --易筋经免疫毒
				    if MPPD(WAR.Person[j]["人物编号"])==1 and DT(WAR.Person[j]["人物编号"],48) then
				        AddPersonAttrib(WAR.Person[j]["人物编号"], "中毒程度", 10)
				        AddPersonAttrib(WAR.Person[j]["人物编号"], "受伤程度", -10)
				    else
					    AddPersonAttrib(WAR.Person[j]["人物编号"], "中毒程度", -100)
				    end
				end
			end
			  
			reseteffect(WAR.ZBX, pid)
			reseteffect(WAR.BZ, pid)
			reseteffect(WAR.PD, pid) --豸苗：谢云流
			reseteffect(WAR.LW, pid) --豸苗：谢云流
			--reseteffect(WAR.JTWW, pid)
			reseteffect(WAR.JGBH, pid)
			reseteffect(WAR.LXXL, pid)
			reseteffect(WAR.ZYHB1, pid)
			reseteffect(WAR.ZQK, pid)
			reseteffect(WAR.ZQDL, pid)
			reseteffect(WAR.TMT, pid)
			if WAR.CONFUSE[pid] ~= nil and WAR.CONFUSE[pid] > 0 then
				local life = 0
				for i = 0, WAR.PersonNum - 1 do
					if WAR.Person[i]["死亡"] == false and JY.Person[WAR.Person[i]["人物编号"]]["生命"] > 0 and WAR.Person[i]["我方"] == WAR.Person[WAR.CurID]["我方"] then
						life = life + 1
					end
				end			
				if life > 1 and math.random(100) <= 50 then
					WAR.Person[WAR.CurID]["我方"] = not WAR.Person[WAR.CurID]["我方"]
				end
			end
			
			if T3XYK(pid) and WAR.JUNSHEN > 0 then
				WAR.JUNSHEN = 0
			end
			
			--if pid == 582 and WAR.ZY > 0 then --赵云白马指令重置
			--	WAR.ZY = WAR.ZY - 1
			--	if WAR.ZY == 0 then
			--		for i=1, #ZYDATA do
			--			JY.Person[0][ZYDATA[i]] = JY.Person[582][ZYDATA[i]];
			--		end
			--		local nx = WAR.Person[WAR.CurID]["坐标X"]
			--		local ny = WAR.Person[WAR.CurID]["坐标Y"]
			--		WAR.Person[WAR.ZYPOS]["坐标X"] = nx
			--		WAR.Person[WAR.ZYPOS]["坐标Y"] = ny
			--		--for i = 1345, 1364 do
			--		--	CurIDTXDH(WAR.CurID, i, i, "长坂英雄震天下");			
			--			--lib.Delay(5)
			--			--if i == 1357 then
			--				WAR.Person[WAR.ZYPOS]["死亡"] = false
			--				lib.SetWarMap(nx, ny, 5, -1)
			--				lib.SetWarMap(nx, ny, 2, -1)								
			--				lib.SetWarMap(nx, ny, 5, WAR.ZYPOS)
			--				lib.SetWarMap(nx, ny, 2, WAR.Person[WAR.ZYPOS]["贴图"])		
			--				WAR.Person[WAR.ZYPOS]["人方向"]	= WAR.Person[WAR.CurID]["人方向"]	
			--				WAR.Person[WAR.CurID]["死亡"] = true							
			--			--end
			--		--end						
			--	end
			--end
			
			if WAR.HITALL[pid] ~= nil and WAR.HITALL[pid] > 0 then
				WAR.HITALL[pid] = WAR.HITALL[pid] - 1
				if WAR.HITALL[pid] <= 0 then
					WAR.HITALL[pid] = nil
				end
			end
			
			if WAR.SJHB[pid] ~= nil then
				WAR.SJHB[pid] = nil
			end
			
			--if pid == 0 and T9ZY(pid) and WAR.ZY == 3 then 
			--	local nx = WAR.Person[WAR.CurID]["坐标X"]
			--	local ny = WAR.Person[WAR.CurID]["坐标Y"]
			--	WAR.ZYPOS = WAR.CurID
			--	for i = 1345, 1364 do
			--		CurIDTXDH(WAR.CurID, i, i, "长坂英雄震天下");			
			--		lib.Delay(10)
			--		if i == 1357 then
			--			WAR.Person[WAR.CurID]["死亡"] = true
			--			lib.SetWarMap(nx, ny, 5, -1)
			--			lib.SetWarMap(nx, ny, 2, -1)	
			--			NewWARPersonZJ(582, true, nx, ny, false, 2)				
			--		end
			--	end		
			--end
			
			if WAR.SXXYS[id] ~= nil then
				WAR.SXXYS[id] = WAR.SXXYS[id] - 1
				if WAR.SXXYS[id] == 0 then
					WAR.SXXYS[id] = nil
					JY.Person[id]["生命"] = 0
				end
			end
			
			if WAR.MYCHAINADD == 1 then --连锁重置
				WAR.MYCHAINADD = 0
			end
			if WAR.URCHAINADD == 1 then
				WAR.URCHAINADD = 0
			end			
		 
	        local pz = math.modf(JY.Person[0]["资质"] / 4)
	        --主角医生 大招
	        if id == 0 and putong() == 7 then
	        	if 50 < JY.Person[0]["体力"] then
	                if WAR.HTSS == 0 and juexing() > 0 and JLSD(25, 50 + pz, 0) then --and 0 < JY.Person[0]["武功10"] then
	                    CurIDTXDH(WAR.CurID, 1170, 1185)
	                    Cls()
	                    zssdz(id)
                        for i = 12, 30 do
                            NewDrawString(-1, -1, ZJTF[7] .. TFSSJ[7], C_WHITE, 25 + i)
                            ShowScreen()
                            if i == 30 then
                                Cls()
		                        local a = JY.Person[id]["半身像"]*2
                                lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
                                lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
                                NewDrawString(-1, -1, ZJTF[7] .. TFSSJ[7], C_WHITE, 25 + i)
                                ShowScreen()
                                lib.Delay(500)
                            else
                                lib.Delay(1)
                            end
                        end
	                    for j = 0, WAR.PersonNum - 1 do
	                        WAR.Person[j].Time = WAR.Person[j].Time - 10
	                        if 995 < WAR.Person[j].Time then
	                            WAR.Person[j].Time = 995
	                        end
	                    end
	                    WAR.Person[WAR.CurID].Time = 1005
	                    JY.Person[0]["体力"] = JY.Person[0]["体力"] - 10
	                    if JLSD(45, 50, 0) then
	                        WAR.HTSS = 0        
	                    else
	                        WAR.HTSS = 1
	                    end
	                end
	            else
	          	    WAR.HTSS = 0
	            end
	        end
		if DT(id,27) and (id == 27 or id == 0) and WAR.TLHS == 1 then ----
	        for j = 0, WAR.PersonNum - 1 do
	            WAR.Person[j].Time = WAR.Person[j].Time - 10
	            if 995 < WAR.Person[j].Time then
	                WAR.Person[j].Time = 995
	            end
	        end
	        WAR.Person[WAR.CurID].Time = 1005
			WAR.TLHS = 0
        end		
		
		if id == 0 and zjtype() == 4 and hasDZ(pid,7) then--沼跃鱼：战意组件7
	        if 50 < JY.Person[0]["体力"] then
	            if WAR.HTSS == 0 and juexing() > 0 and (JLSD(25, 50 + pz, 0) or ZYBF(id)) then --and 0 < JY.Person[0]["武功10"] then
	                CurIDTXDH(WAR.CurID, 1830, 1849,"八门回天")
	                Cls()
	                ShowScreen()
	                lib.Delay(40)
	                for j = 0, WAR.PersonNum - 1 do
	                    WAR.Person[j].Time = WAR.Person[j].Time - 10
	                    if 995 < WAR.Person[j].Time then
	                        WAR.Person[j].Time = 995
	                    end
	                end
	                WAR.Person[WAR.CurID].Time = 1005
	                JY.Person[0]["体力"] = JY.Person[0]["体力"] - 10
	                if JLSD(45, 50, 0) then
	                    WAR.HTSS = 0        
	                else
	                    WAR.HTSS = 1
	                end
	            end
	        else
	          	WAR.HTSS = 0
	        end
	    end
			  	
		if T9ZY(id) and WAR.ZYQT==4 then--沼跃鱼：赵云日月光华
	        CurIDTXDH(WAR.CurID, 1170, 1185,"空速流痕.日月光华")
	        Cls()
	        ShowScreen()
	        lib.Delay(40)
	        for j = 0, WAR.PersonNum - 1 do
	            WAR.Person[j].Time = WAR.Person[j].Time - 10
	            if 995 < WAR.Person[j].Time then
	                WAR.Person[j].Time = 995
	            end
	        end
	            WAR.Person[WAR.CurID].Time = 1005
	    end  

		if MPPD(id) == 9 and WAR.TMMS[id] == 1 and WAR.TMMS[100+id] == 1 then--唐门模式夺魄箭
	        for j = 0, WAR.PersonNum - 1 do
	            WAR.Person[j].Time = WAR.Person[j].Time - 10
	            if 995 < WAR.Person[j].Time then
	                WAR.Person[j].Time = 995
	            end
	        end
	            WAR.Person[WAR.CurID].Time = 1005
				WAR.TMMS[100+id] = nil
	    end
	   
		if WAR.LXQJ[100+pid] == 1 then --血龙
			DHdisplay(862, 876, "龙象气劲・爆")
			for j = 0, WAR.PersonNum-1 do 
			    if WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] and WAR.Person[j]["死亡"] == false then 
				    local a = 0 
					if WAR.LWZN[WAR.Person[j]["人物编号"]] ~= nil and WAR.LWZN[WAR.Person[j]["人物编号"]] > 0 then 
					    a = WAR.LWZN[WAR.Person[j]["人物编号"]]
					end
				    WAR.Person[j]["生命点数"] = (WAR.Person[j]["生命点数"] or 0)+AddPersonAttrib(WAR.Person[j]["人物编号"], "生命", -math.modf(100*(1+a*0.1)));
				    War_Show_Count(WAR.CurID)
				    --WAR.LXQJ[200+pid] = nil 
					WAR.LXQJ[100+pid] = nil
				end
		    end  
		end
		
		if WAR.LXQJ[200+pid] == 1 then --血龙
			DHdisplay(862, 876, "龙象气劲・爆")
			for j = 0, WAR.PersonNum-1 do 
			    if WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] and WAR.Person[j]["死亡"] == false then 
				    local a = 0 
					if WAR.LWZN[WAR.Person[j]["人物编号"]] ~= nil and WAR.LWZN[WAR.Person[j]["人物编号"]] > 0 then 
					    a = WAR.LWZN[WAR.Person[j]["人物编号"]]
					end
				    WAR.Person[j]["生命点数"] = (WAR.Person[j]["生命点数"] or 0)+AddPersonAttrib(WAR.Person[j]["人物编号"], "生命", -math.modf(100*(1+a*0.2)));
				    War_Show_Count(WAR.CurID)
					WAR.LXQJ[200+pid] = nil 
				    --WAR.LXQJ[100+pid] = nil
				end
		    end  
		end 
		
		if WAR.HYDM[100+pid] == 1 then --火焰刀
			DHdisplay(862, 876, "火焰刀・破")
			for j = 0, WAR.PersonNum-1 do 
			    if WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] and WAR.Person[j]["死亡"] == false then 
				    local a = 0 
					if WAR.HYDM[WAR.Person[j]["人物编号"]] ~= nil and WAR.HYDM[WAR.Person[j]["人物编号"]] > 0 then 
					    a = WAR.HYDX[WAR.Person[j]["人物编号"]]
					end
				    WAR.Person[j]["生命点数"] = (WAR.Person[j]["生命点数"] or 0)+AddPersonAttrib(WAR.Person[j]["人物编号"], "生命", -math.modf(100*(1+a*0.1)));
				    War_Show_Count(WAR.CurID) 
					WAR.HYDM[100+pid] = nil
				end
			end  
		end
		
		if WAR.HYDM[200+pid] == 1 then --火焰刀
			DHdisplay(862, 876, "火焰刀・破")
			for j = 0, WAR.PersonNum-1 do 
			    if WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] and WAR.Person[j]["死亡"] == false then 
				    local a = 0 
					if WAR.HYDM[WAR.Person[j]["人物编号"]] ~= nil and WAR.HYDM[WAR.Person[j]["人物编号"]] > 0 then 
					    a = WAR.HYDX[WAR.Person[j]["人物编号"]]
					end
				    WAR.Person[j]["生命点数"] = (WAR.Person[j]["生命点数"] or 0)+AddPersonAttrib(WAR.Person[j]["人物编号"], "生命", -math.modf(100*(1+a*0.2)));
				    War_Show_Count(WAR.CurID)
					WAR.HYDM[200+pid] = nil 
				end
			end  
		end 
		
		if WAR.XYDH[100+pid] == 1 then --雪饮神锋
			DHdisplay(2642, 2663, "雪饮神锋・寒")
			for j = 0, WAR.PersonNum-1 do 
			    if WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] and WAR.Person[j]["死亡"] == false then 
				    local a = 0 
					if WAR.XYDH[WAR.Person[j]["人物编号"]] ~= nil and WAR.XYDH[WAR.Person[j]["人物编号"]] > 0 then 
					    a = WAR.XYDQ[WAR.Person[j]["人物编号"]]
					end
				    WAR.Person[j]["生命点数"] = (WAR.Person[j]["生命点数"] or 0)+AddPersonAttrib(WAR.Person[j]["人物编号"], "生命", -math.modf(100*(1+a*0.1)));
				    War_Show_Count(WAR.CurID) 
					WAR.XYDH[100+pid] = nil
				end
			end  
		end
		
		if WAR.XYDH[200+pid] == 1 then --雪饮神锋
			DHdisplay(2642, 2663, "雪饮神锋・寒")
			for j = 0, WAR.PersonNum-1 do 
			    if WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] and WAR.Person[j]["死亡"] == false then 
				    local a = 0 
					if WAR.XYDH[WAR.Person[j]["人物编号"]] ~= nil and WAR.XYDH[WAR.Person[j]["人物编号"]] > 0 then 
					    a = WAR.XYDQ[WAR.Person[j]["人物编号"]]
					end
				    WAR.Person[j]["生命点数"] = (WAR.Person[j]["生命点数"] or 0)+AddPersonAttrib(WAR.Person[j]["人物编号"], "生命", -math.modf(100*(1+a*0.2)));
				    War_Show_Count(WAR.CurID)
					WAR.XYDH[200+pid] = nil 
				end
			end  
		end 
		
		if WAR.LHFY2[pid] ~= nil then
			DHdisplay(2642, 2663, "云龙气劲・绝")
			local aa = WAR.LHFY2[pid]
			if aa > math.modf(JY.Person[pid]["生命"] *0.9) then aa = math.modf(JY.Person[pid]["生命"] *0.9) end
			WAR.Person[WAR.CurID]["生命点数"] = (WAR.Person[WAR.CurID]["生命点数"] or 0)+AddPersonAttrib(pid, "生命", -aa)
			if WAR.WYQS[pid] == nil then
				WAR.WYQS[pid] = WAR.WYQS[pid] or 0 + 1
			end	
			WAR.LHFY2[pid] = nil
		end
		
		
		if DT(pid,5) and (pid == 0 or pid == 5) then----
	        local a = JY.Person[pid]["生命"]/JY.Person[pid]["生命最大值"]
	        local b = JY.Person[pid]["内力"]/JY.Person[pid]["内力最大值"]
		    if b < a then 
			    DHdisplay(1850, 1863, "阴阳相生")
				WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0)+AddPersonAttrib(pid, "内力", math.modf(a*JY.Person[pid]["内力最大值"]))
				War_Show_Count(WAR.CurID)
		    end   
		end
		
		if NF(pid) and juexing() > 2 then
	        local a = JY.Person[pid]["生命"]/JY.Person[pid]["生命最大值"]
	        local b = JY.Person[pid]["内力"]/JY.Person[pid]["内力最大值"]
			if b < a then 
			    DHdisplay(1258, 1272, "驾驭魔心 收放自如")
				WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0)+AddPersonAttrib(pid, "内力", math.modf(a*JY.Person[pid]["内力最大值"]))
				War_Show_Count(WAR.CurID)
			end   
		end
		
		if (wglw(pid,94) or (DT(pid,632) and PersonKF(pid,94))) and JLSD(10,35,pid) then 
			local a = JY.Person[pid]["生命"]/JY.Person[pid]["生命最大值"]
	        local b = JY.Person[pid]["内力"]/JY.Person[pid]["内力最大值"]
		    if b < a then 
			    DHdisplay(1001, 1025, "内气互通")
				WAR.Person[WAR.CurID]["内力点数"] = (WAR.Person[WAR.CurID]["内力点数"] or 0)+AddPersonAttrib(pid, "内力", math.modf(a*JY.Person[pid]["内力最大值"]))
				War_Show_Count(WAR.CurID)
			end 
		end
		
	    if JY.ZJSL == 1 then
	        for i = 0, WAR.PersonNum - 1 do
	            if WAR.Person[i]["我方"] == false then
	            end
	        end
	    end  
		
		if WAR.Person[WAR.CurID] then 
			local df = 0 
			local wf = 0
	        for i = 0, WAR.PersonNum - 1 do
	            if WAR.Person[i]["我方"] == true and JY.Person[WAR.Person[i]["人物编号"]]["生命"] > 0 then
				   wf = 1
	               --WAR.Person[i]["死亡"] = true
	            end
	            if WAR.Person[i]["我方"] == false and JY.Person[WAR.Person[i]["人物编号"]]["生命"] > 0 then
				   df = 1
	              --WAR.Person[i]["死亡"] = true
	            end
	        end
			for i = 0, WAR.PersonNum - 1 do
			    if df == 0 and WAR.Person[i]["我方"] ==true and WAR.Person[i]["死亡"] == false and WAR.CONFUSEO[WAR.Person[i]["人物编号"]] == 2 then 
			        WAR.Person[i]["我方"] = false
			    end
			    if wf == 0 and WAR.Person[i]["我方"] ==false and WAR.Person[i]["死亡"] == false and WAR.CONFUSEO[WAR.Person[i]["人物编号"]] == 1 then 
			        WAR.Person[i]["我方"] = true
			    end
			end
		end
			 
	    --成昆密道 200时序就跑
	    if WAR.ZDDH == 237 and 200 < WAR.SXTJ then
	        for i = 0, WAR.PersonNum - 1 do
	            if WAR.Person[i]["我方"] == false then
	                WAR.Person[i]["死亡"] = true
	            end
	        end
	        say(CC.s48, 18)  --(嗯，没功夫跟这小子纠缠了）
	    end
		
	    if WAR.ZDDH == 341 and 100 < WAR.SXTJ then
	        for i = 0, WAR.PersonNum - 1 do
	            if WAR.Person[i]["我方"] == false and WAR.Person[i]["人物编号"] == 618 then
	                WAR.Person[i]["死亡"] = true
				    say("少侠果然了得。", 618)  --(嗯，没功夫跟这小子纠缠了）
	            end
	        end
	    end
		
	    if WAR.ZDDH == 288 and 75 < WAR.SXTJ then --独孤真传领悟75时序
	        for i = 0, WAR.PersonNum - 1 do
	            if WAR.Person[i]["我方"] == false and WAR.Person[i]["人物编号"] == 592 then
	                WAR.Person[i]["死亡"] = true
				    say("独孤前辈的武学境界真是匪夷所思！", 0)  
	            end
	        end
	    end
		
        if WAR.ZDDH == 22 and 75 < WAR.SXTJ then --六如觉醒战老张75时序
	        for i = 0, WAR.PersonNum - 1 do
	            if WAR.Person[i]["我方"] == false and WAR.Person[i]["人物编号"] == 5 then
	                WAR.Person[i]["死亡"] = true
				    say("不错不错！", 5)  
	            end
	        end
	    end		
		
        if WAR.ZDDH == 281 and 45 < WAR.SXTJ then --武当入门领悟太极套45时序
	        for i = 0, WAR.PersonNum - 1 do
	            if WAR.Person[i]["我方"] == false and WAR.Person[i]["人物编号"] == 5 then
	                WAR.Person[i]["死亡"] = true
				    say("好好好，哈哈哈！", 5) 
	            end
	        end
	    end				
		
        if WAR.ZDDH == 379 and 75 < WAR.SXTJ then --太极领悟75时序
	        for i = 0, WAR.PersonNum - 1 do
	            if WAR.Person[i]["我方"] == false and WAR.Person[i]["人物编号"] == 5 then
	                WAR.Person[i]["死亡"] = true
				    say("好好好，哈哈哈！", 5) 
					say("多谢张真人赐教！", 0) 
	            end
	        end
	    end			
		
        if WAR.ZDDH == 223 and 100 < WAR.SXTJ then --少林箱子100时序达摩退场
	        for i = 0, WAR.PersonNum - 1 do
	            if WAR.Person[i]["我方"] == false and WAR.Person[i]["人物编号"] == 615 then
	                WAR.Person[i]["死亡"] = true
				    say("小村传人果然名不虚传，老和尚佩服！", 615)  
					say("多谢达摩祖师承让！", 0)
	            end
	        end
	    end				
		
	    if WAR.ZDDH == 288 and 50 < WAR.SXTJ then --天山六阳掌领悟50时序
	        for i = 0, WAR.PersonNum - 1 do
	            if WAR.Person[i]["我方"] == false and WAR.Person[i]["人物编号"] == 116 then
	                WAR.Person[i]["死亡"] = true
				    say("为师很欣慰。", 116)  
	            end
	        end
	    end
		
        if WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 and GetS(86, 2, 10, 5) == 3 and 30 < WAR.SXTJ then			
			for i = 0, WAR.PersonNum - 1 do
	            if WAR.Person[i]["我方"] == false and WAR.Person[i]["人物编号"] == 600 then
	                WAR.Person[i]["死亡"] = true
				    say("哈哈哈，英雄出少年。", 600)
				    say("多谢前辈承让。", 0)  
	            end
	        end
	    end
		
        if WAR.ZDDH == 367 and 500 < WAR.SXTJ then --搞事梵战一
	        for i = 0, WAR.PersonNum - 1 do
	            if WAR.Person[i]["我方"] == false and WAR.Person[i]["人物编号"] == 457 then
	                WAR.Person[i]["死亡"] = true
				    say("少侠武功了得！我先找帮手去！", 457) 
					say("..................", 0) 
					say("（装了逼就跑，真TM刺激！）", 457)  
	            end
	        end
	    end		
		
		--[[
	    if WAR.ZDDH == 172 and 500 < WAR.SXTJ then --单挑西毒撑过500时序
	        for i = 0, WAR.PersonNum - 1 do
	            if WAR.Person[i]["我方"] == false then
	                WAR.Person[i]["死亡"] = true
	            end
	        end
	            Talk("老顽童救命！", 0)  
	    end			]]
			
	    if WAR.ZDDH == 305 and 100 < WAR.SXTJ then --耶律齐觉醒战撑过100时序
	        for i = 0, WAR.PersonNum - 1 do
	            if WAR.Person[i]["我方"] == false then
	                WAR.Person[i]["死亡"] = true
	            end
	        end
				say("哈哈，好！不愧是我教出来的徒弟！", 64)
	    end			
			
	    if WAR.ZDDH == 281 and math.modf(50 * (MPDJ(0) + 1)) < WAR.SXTJ then --武当入门战
	        for i = 0, WAR.PersonNum - 1 do
	            if WAR.Person[i]["我方"] == false then
	                WAR.Person[i]["死亡"] = true
	            end
	        end
				Cls()
				say("哈哈，小兄弟武功又大进了！",5,0,"张三丰")			
				Cls()
				say("前辈承让！")					
	    end						
			
	    if ceshi2() then
		    if WAR.ZDDH ~= -1 then --测试用
				for i = 0, WAR.PersonNum - 1 do
					if not WAR.Person[i]["我方"] then
					    WAR.Person[i]["死亡"] = true
					end
				end			
		    end
		end
			
		ceshi()
	          
	    --冰糖恋：正十五大20时序胜利
	    if WAR.ZDDH == 134 and 20 < WAR.SXTJ and GetS(87,31,32,5) == 1 then
	        for i = 0, WAR.PersonNum - 1 do
	            if WAR.Person[i]["我方"] == false then
	                WAR.Person[i]["死亡"] = true
	            end
	        end
	            TalkEx(CC.TTalk98,269,0);
	    end
	
		--冰糖恋：邪十五大20时序胜利
	    if WAR.ZDDH == 133 and 20 < WAR.SXTJ and GetS(87,31,31,5) == 1 then
	        for i = 0, WAR.PersonNum - 1 do
	            if WAR.Person[i]["我方"] == false then
	                WAR.Person[i]["死亡"] = true
	            end
	        end
	            TalkEx(CC.TTalk98,269,0);
	    end
	        
        --夫妻阵挺过300时序胜利
	    if GetS(86, 2, 10, 5) == 3	and 300 < WAR.SXTJ then
			for i = 0, WAR.PersonNum - 1 do
	            if WAR.Person[i]["我方"] == false then
	                WAR.Person[i]["死亡"] = true
	            end
	        end
	            say("小兄弟功夫不错嘛，以后多行善举", 455)
			    say("如不行善举就是跟一刀流作对！", 597)	
			    say("...........晚辈明白！", 597)
	    end				
			
        --作者阵挺过200时序顺利
	    if GetS(86, 2, 15, 5) == 3 and 200 < WAR.SXTJ then
			for i = 0, WAR.PersonNum - 1 do
	            if WAR.Person[i]["我方"] == false then
	                WAR.Person[i]["死亡"] = true
	            end
	        end
	            say("小兄弟功夫不错！", 455)
			    say("能躲过我西瓜刀法的人不多，厉害！", 585)	
			    say("一刀流的武学是不是很诡异？<嘻嘻>", 597)
			    say("兽战拟法好玩吧？<嘻嘻>", 598)
				say("翻袖扫邪云，补天浴日付一笑，御秋水神风", 667)
				say("江湖后浪推前浪，老夫云游去也！", 600)
				say("晚辈只是侥幸....<运气好，运气好！>", 0)
	    end
		
        if WAR.ZDDH == 387 and 1000 < WAR.SXTJ then --新旧三绝
	        for i = 0, WAR.PersonNum - 1 do
	            if WAR.Person[i]["我方"] == false then
	                WAR.Person[i]["死亡"] = true
	            end
	        end
			say("没想到小兄弟年纪轻轻居然有此等武学造诣，春哥就放你过去，让你驰骋武林！", 617) --春哥
			say("ZZZ~ZZ~ZZZ（又睡过去了）！", 585) --小二
			say("小兄弟功夫不错！", 662) --水镜
			say("你……你怎么也那么骚！？", 455) --凡总
			say("哎，算了，拿你来活动活动筋骨，揍完了你，我要去找那个紫落梵算账！", 665) --组长
			say("小兄弟着实车技不错，过弯很六，佩服佩服！", 666) --车神
	    end				
		
        if WAR.ZDDH > 0 and WAR.ZDDH < 999 then
			JY.Person[600]["生命最大值"] = JY.Person[600]["生命最大值"] + 1000
			if JY.Person[600]["生命最大值"] <= 0 or JY.Person[600]["生命最大值"] >= 9999 then JY.Person[600]["生命最大值"] = 9999 end
			JY.Person[600]["生命"] = JY.Person[600]["生命最大值"]
		end 	
			
	    --蓝烟清：单挑，十八铜人 800时序胜利
	    if WAR.ZDDH == 217 and GetS(86,1,2,5) == 1 and 800 < WAR.SXTJ then
	        for i = 0, WAR.PersonNum - 1 do
	            if WAR.Person[i]["我方"] == false then
	                WAR.Person[i]["死亡"] = true
	            end
	        end
	            Talk(CC.LWARS2,0);		--呼呼~~终于闯过去了~~~少林十八铜人阵果然名不虚传~~
	    end
	        
	    --蓝烟清：群战，十八铜人 超过500时序失败
	    if WAR.ZDDH == 217 and GetS(86,1,2,5) == 2 and 500 < WAR.SXTJ then
	        Talk(CC.LWARS3,0);		--呼呼~~好可惜，差一点就成功了。少林十八铜人阵果然名不虚传
	        for i = 0, WAR.PersonNum - 1 do
	            if WAR.Person[i]["我方"] then
	                WAR.Person[i]["死亡"] = true
	            end
	        end
	    end
	        
	    --新华山论剑
	    if WAR.ZDDH == 238 then
	        local life = 0
	        WAR.NO1 = 114;
	        for i = 0, WAR.PersonNum - 1 do
	            if WAR.Person[i]["死亡"] == false and 0 < JY.Person[WAR.Person[i]["人物编号"]]["生命"] then
	                life = life + 1
	                if WAR.NO1 >= WAR.Person[i]["人物编号"] then
	              	    WAR.NO1 = WAR.Person[i]["人物编号"]
	                end
	            end
	        end
	          
	        if 1 < life then
	            local m, n = 0, 0
	            while true do			--防止全部随机到已方
	            if m >= 1 and n >= 1 then
	            	break;
	            else
	            	m = 0;
	            	n = 0;
	            end
	            	
		        for i = 0, WAR.PersonNum - 1 do
		            if WAR.Person[i]["死亡"] == false and 0 < JY.Person[WAR.Person[i]["人物编号"]]["生命"] then
		                if WAR.Person[i]["人物编号"] == 0 then
		                    WAR.Person[i]["我方"] = true
		                  	m = m + 1
			            elseif math.random(2) == 1 then
			                WAR.Person[i]["我方"] = true
			                m = m + 1
			        else
		                WAR.Person[i]["我方"] = false
		                	n = n + 1
		                end
		            end
		        end
		    end
	        end
	        end
	    	end
	    end
		    warStatus = War_isEnd()   --战斗是否结束？   0继续，1赢，2输
		if 0 < warStatus then	  
     		break;
    	end
    end
    if 0 < warStatus then     	
		break;
    end
    WarPersonSort(1)
    WAR.Delay = GetJiqi()
    startt = lib.GetTime()
    collectgarbage("step", 0)
    end
    local r = nil
    WAR.ShowHead = 0
 	
	--优化集气卡顿 战斗结束清除队友缓存数据 start 20200427
	JY.MyTeamData = nil
	--优化集气卡顿 战斗结束清除队友缓存数据 end 20200427
	
    --蓝烟清：战斗结束，敌方队友状态回复
    if WAR.ZDDH ~= 342 then
	    for i = 0, WAR.PersonNum - 1 do	
		    if WAR.tmp[4000 + i] ~= nil then
			    local n = WAR.tmp[4000 + i];
			    if n[1] ~= nil and n[2] ~= nil and n[3] ~= nil then
				    JY.Person[n[1]]["生命最大值"] = JY.Person[n[1]]["生命最大值"] - n[2]
				    JY.Person[n[1]]["内力最大值"] = JY.Person[n[1]]["内力最大值"] - n[3]
			    end
		    end
	    end
    end
	local wxzd = {17, 67, 226, 220, 224, 219, 79, 102, 82, 276, 279, 281, 20, 82, 214}
	local wx = 0
	for i = 1, #wxzd do
		if WAR.ZDDH == wxzd[i] then
			wx = 1
			break
		end
	end
	if wx == 0 then
		for i = 0, WAR.PersonNum - 1 do	 --敌方每出场一次加实战20-30
			local aa = WAR.Person[i]["人物编号"]
			if not duiyou(aa) then
				if xiaobin(aa) then
					AddPersonAttrib(aa, "实战", 20)
				else
					AddPersonAttrib(aa, "实战", 30)
				end
			end
		end 
	end

    --战斗结束后的奖励
    if WAR.ZDDH == 238 then
    PlayMIDI(100)
    PlayWavAtk(41)
    DrawStrBoxWaitKey(CC.EVB102, C_WHITE, CC.DefaultFont)
    DrawStrBoxWaitKey(CC.EVB103 .. JY.Person[WAR.NO1]["姓名"], C_RED, CC.DefaultFont)
    if WAR.NO1 == 0 then
      r = true
    else
      r = false
    end
    elseif warStatus == 1 then   --战斗胜利
    PlayMIDI(100)
    PlayWavAtk(41)
    DrawStrBoxWaitKey(CC.EVB82, C_WHITE, CC.DefaultFont)
	if WAR.ZDDH ~= 226 and hasSK(39) then
		instruct_2(174, math.random(50))
		instruct_2(209, math.random(10))
		instruct_2(210, math.random(10))
	end
    
	if WAR.ZDDH == 4 then
		QZXS(string.format("%s 实战增加%s点",JY.Person[0]["姓名"],15));
		AddPersonAttrib(0, "实战", 15)
	elseif WAR.ZDDH == 147 then 
		addHZ(122)
    elseif WAR.ZDDH == 14 then
		addthing(277, 1)		
	elseif WAR.ZDDH == 20 then 
		addHZ(95)
	elseif WAR.ZDDH == 22 and juexing() <= 0 then
        DrawStrBoxWaitKey(CC.EVB85, C_GOLD, CC.DefaultFont)
        AddPersonAttrib(0, "拳掌功夫", 10)
        AddPersonAttrib(0, "御剑能力", 10)
        AddPersonAttrib(0, "耍刀技巧", 10)
        AddPersonAttrib(0, "特殊兵器", 10)
		AddPersonAttrib(0, "暗器技巧", 10)
		addHZ(85)
		addHZ(113)
		tb(skpoint(100 * JY.DIFF))		
	elseif WAR.ZDDH == 54 then 
		addthing(337)
		addHZ(127)
		addHZ(146)
	elseif WAR.ZDDH == 38 then
		addthing(261)
	elseif WAR.ZDDH == 52 then
		addthing(282)
		addthing(330)
	elseif WAR.ZDDH == 67 then
		local aa = 0
		for i = 0, WAR.PersonNum - 1 do	 --单挑老顽童奖励
			if WAR.Person[i]["我方"] then
				aa = aa + 1
			end
		end 
		if aa <= 1 then
			addpic(20, 0, 1)
		end		
	elseif WAR.ZDDH == 73 then 
		addHZ(36)
	elseif WAR.ZDDH == 75 then
		QZXS(string.format("%s 实战增加%s点",JY.Person[0]["姓名"],15));
		AddPersonAttrib(0, "实战", 15)	
		addHZ(98)	
	elseif WAR.ZDDH == 76 then
		addHZ(92)
		DrawStrBoxWaitKey(CC.EVB84, C_GOLD, CC.DefaultFont)
		instruct_32(14, 2)
	elseif WAR.ZDDH == 77 then
		QZXS(string.format("%s 实战增加%s点",JY.Person[0]["姓名"],10));
		AddPersonAttrib(0, "实战", 10)
		addHZ(19)	
    elseif WAR.ZDDH == 80 then
		addHZ(114)
		tb(skpoint(30 * JY.DIFF))
	elseif WAR.ZDDH == 82 then
		addHZ(4)
	elseif WAR.ZDDH == 83 then
		addHZ(96)
    elseif WAR.ZDDH == 86 then
        instruct_2(66, 1)		
	elseif WAR.ZDDH == 90 then --武骧金星：宠物
		if not hasPet() then
			setPet(4)
		end
	elseif WAR.ZDDH == 95 then
		addHZ(72)
	elseif WAR.ZDDH == 100 then
        DrawStrBoxWaitKey(CC.EVB86, C_GOLD, CC.DefaultFont)
        instruct_32(8, 2)		
	elseif WAR.ZDDH == 101 then
		addHZ(102)
	elseif WAR.ZDDH == 136 then
		addHZ(73)		
	elseif WAR.ZDDH == 140 then
		addHZ(70)
	elseif WAR.ZDDH == 143 then
		addHZ(69)
	elseif WAR.ZDDH == 144 then
		addHZ(71)
	elseif WAR.ZDDH == 146 then
		addthing(124)		
	elseif WAR.ZDDH == 151 then 
		if not hasPet() then
			setPet(2)
		end
	elseif WAR.ZDDH == 152 then
		addHZ(59)
	elseif WAR.ZDDH == 161 then
		QZXS(string.format("%s 实战增加%s点",JY.Person[0]["姓名"],15));
		AddPersonAttrib(0, "实战", 15)		
	elseif WAR.ZDDH == 164 then
		addHZ(30)		
	elseif WAR.ZDDH == 165 then	
		addHZ(120)
    elseif WAR.ZDDH == 172 then
        DrawStrBoxWaitKey(CC.EVB87, C_GOLD, CC.DefaultFont)
        instruct_32(73, 1)
		addHZ(34)
		tb(skpoint(30 * JY.DIFF))
    elseif WAR.ZDDH == 173 then
        DrawStrBoxWaitKey(CC.EVB88, C_GOLD, CC.DefaultFont)
        instruct_32(17, 2)
    elseif WAR.ZDDH == 188 and juexing() <= 0 then
        --DrawStrBoxWaitKey(CC.EVB89, C_GOLD, CC.DefaultFont)
        --AddPersonAttrib(0, "拳掌功夫", 10)
		local bonus = JYMsgBox("恭喜！", "请选择一系指数奖励", {"拳", "剑", "刀", "棍", "暗"}, 5, 0)
		AddPersonAttrib(0, PSX[bonus+58], 10)
		addthing(338)
		tb(skpoint(20 * JY.DIFF))		
	elseif WAR.ZDDH == 189 then
		addHZ(82)
	elseif WAR.ZDDH == 191 then
		addthing(289)
	elseif WAR.ZDDH == 197 then
		addHZ(91)
	elseif WAR.ZDDH == 202 and WAR.SXTJ <= 100 then
		addthing(269)
	elseif WAR.ZDDH == 211 then
		addHZ(61)
		tb(skpoint(20 * JY.DIFF))		
	elseif WAR.ZDDH == 218 then
		addHZ(22)
    elseif WAR.ZDDH == 237 and 200 >= WAR.SXTJ then --成昆战得两印章
		addHZ(17)
		addHZ(18)
		tb(skpoint(100 * JY.DIFF))		
	elseif WAR.ZDDH == 260 then
		addHZ(93)
	elseif WAR.ZDDH == 331 then
		addthing(275)		
    elseif WAR.ZDDH == 358 then
		tb(skpoint(100 * JY.DIFF))
    elseif WAR.ZDDH == 360 then
		addthing(332, 1)		
	end
    
    --[[蓝烟清：战斗胜利，可随机偷取敌人身上的物品，只偷取药品
    local thing = {};
    local tnum = 0;
    for i = 0, WAR.PersonNum - 1 do
    	if WAR.Person[i]["我方"] == false then
    		local enid = WAR.Person[i]["人物编号"];
    		for j=1, 4 do
	    		if JY.Person[enid]["携带物品数量" .. j] ~= nil and 0 < JY.Person[enid]["携带物品数量" .. j] and -1 < JY.Person[enid]["携带物品" .. j] and JY.Person[enid]["携带物品" .. j] > 35 then --and JY.Person[enid]["携带物品" .. j] < 26 
					tnum = tnum + 1
					thing[tnum] = {JY.Person[enid]["携带物品" .. j], enid, j}
			    end
			  end
    	end	
    end
    if tnum > 0 and WAR.ZDDH ~= 342 then
    	local n = math.random(tnum);		--随机偷取
    	if thing[n] ~= nil then
    		local a = thing[n][1];		--物品ID号
    		local b = thing[n][2];		--人物的编号
    		local c = thing[n][3];		--携带的物品位置

    		JY.Person[b]["携带物品数量"..c] = JY.Person[b]["携带物品数量"..c] - 1;
    		if JY.Person[b]["携带物品数量"..c] < 1 then
    			JY.Person[b]["携带物品"..c] = -1;
    		end
			DrawStrBoxWaitKey(string.format("获得战利品：%s %d个", JY.Thing[a]["名称"], 1), C_GOLD, CC.DefaultFont)
			instruct_32(a, 1);
    	end
    end]]

    r = true
    elseif warStatus == 2 then   --战斗失败
    DrawStrBoxWaitKey(CC.EVB83, C_WHITE, CC.DefaultFont)
    r = false
    end
    War_EndPersonData(isexp, warStatus)
    if JY.SubScene ~= -1 and GetS(111, 1, 0, 0) == 98 then
       SetS(111, 1, 0, 0, 0)
	   SetS(111, 0, 0, 0, 98)
    end
    if JY.SubScene ~= -1 and GetS(113, 1, 0, 0) == 98 then
       SetS(113, 1, 0, 0, 0)
	   SetS(113, 0, 0, 0, 98)
    end	
    --战斗结束自动住店
    if inteam(663) then instruct_12() end
       lib.ShowSlow(50, 1)
    if JY.SubScene ~= -1 and 0 <= JY.Scene[JY.SubScene]["进门音乐"] then --test main map music change
       PlayMIDI(JY.Scene[JY.SubScene]["进门音乐"])
    else
      PlayMIDI(0)
    end
      CleanMemory()
    lib.PicInit()
  
    if JY.SubScene ~= -1 then --战斗后重设status
	JY.Status = GAME_SMAP
	lib.PicLoadFile(CC.SMAPPicFile[1], CC.SMAPPicFile[2], 0)
	lib.PicLoadFile(CC.HeadPicFile[1], CC.HeadPicFile[2], 1)
	lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55, 110)
	if CC.LoadThingPic == 1 then
		lib.PicLoadFile(CC.WpPic[1], CC.WpPic[2], 2)
	end	
	  if CONFIG.Zoom == 1 then
		lib.PicLoadFile(CC.HZPicFile[1], CC.HZPicFile[2], 9)
	  else
		lib.PicLoadFile(CC.HZPicFile[1], CC.HZPicFile[2], 9, 50)
	  end
	lib.PicLoadFile(CC.GamePicFile[1], CC.GamePicFile[2], 8)
    else
	JY.Status = GAME_MMAP --test main map reset
	lib.PicInit()
    Init_MMap()
    JY.SubScene = -1
    JY.oldSMapX = -1
    JY.oldSMapY = -1
    lib.DrawMMap(JY.Base["人X"], JY.Base["人Y"], GetMyPic())
    lib.GetKey()		
    end
    if WAR.ZDDH == 342 then
	   JY.Status = GAME_MATCH
	   Cls()
    end
    JY.Status = gamestatus
    Cls()
    return r
end

   --执行解毒
   --id1 解毒id2, 返回id2中毒减少点数
function ExecDecPoison(id1, id2)
    local add = JY.Person[id1]["解毒能力"] + MPAttrib(id1, 6)
    local value = JY.Person[id2]["中毒程度"]
    if add + 20 < value then
       return 0
    end
    add = limitX(math.modf(add / 3) + Rnd(10) - Rnd(10), 0, value)
    return -AddPersonAttrib(id2, "中毒程度", -add)
end

   --增加人物属性，如果有最大值限制，则应用最大值限制。最小值则限制为0
   --id 人物id
   --str属性字符串
   --value 要增加的值，负数表示减少
   --返回1,实际增加的值
   --返回2，字符串：xxx 增加/减少 xxxx，用于显示药品效果
function AddPersonAttrib(id, str, value)
	if id == 0 then
		id = zj()
	end
    local oldvalue = JY.Person[id][str]
	
	if oldvalue == nil then
	lib.Debug("error: person " .. id .. "," .. str .. " is nil")
	return 0, "" --尝试修复闪退问题
	end
	
    local attribmax = math.huge
    if str == "生命" then
       attribmax = JY.Person[id]["生命最大值"]
    elseif str == "内力" then
       attribmax = JY.Person[id]["内力最大值"]
    elseif CC.PersonAttribMax[str] ~= nil then
       attribmax = CC.PersonAttribMax[str]
    end
  
    if str == "实战" then
	   if T11CJR(id) then attribmax = 9999 end
    end
  
    if str == "生命最大值" then	
		if JY.Person[id]["资质"] < 21 then --武骧金星：笨蛋体力比较多
			attribmax = attribmax + (21 - JY.Person[id]["资质"]) * 25
		end	
		if MPPD(id) == 5 and MPDJ(id) > 2 then
			attribmax = attribmax + 200
		end
		--飞影彩蛋：真龙心法生命硬上限 +500
		if PersonKF(id, 91) and JY.Person[id]["武功2"] == 91 and JY.Wugong[91]["名称"] == "赤血真龙诀" then
			attribmax = attribmax + 500
		end
		
		if wglw(id,94) or (DT(id,632) and PersonKF(id,94)) then	
			attribmax = attribmax + 500	    
		end		
		
		attribmax = math.modf(attribmax * MPAttrib(id, 8))
		
		if hasTF(id, 129) then
			attribmax = math.modf(attribmax * 0.9)
		end  	
		if not duiyou(id) then
			attribmax = 5000
		end
		if (juexing() > 0 or JX(id)) then
			attribmax = math.modf(attribmax + 500)
		end	
    end
  
    if str == "内力最大值" then
		local nlmax = math.modf((JY.Person[id]["资质"] - 1) / 5) --5资质为一档，一档=250内
		attribmax = 9750 - nlmax * 250
		
		attribmax  = attribmax + (math.modf((101-JY.Person[id]["资质"])/20) * 300) --资质每少20点上限+300，1资+1500
			
		if ZLE(id) then --赵灵儿内力上限+3000
			attribmax = attribmax + 3000
		end
		
		if NF(id) and juexing() > 0 then --聂风内力上限+4000
			attribmax = attribmax + 4000
		end	
		
		if BJY(id) and juexing() > 0 then --步惊云内力上限+5000
			attribmax = attribmax + 5000
		end  	
		
		if wglw(id,94) or (DT(id,632) and PersonKF(id,94)) then	
			attribmax = attribmax + 1200
		end	
		
		if wglw(id,188) or (DT(id,48) and PersonGT(id,188)) then	 --神足经
			attribmax = attribmax + 1500
		end
		
		if wglw(id,102) or (DT(id,38) and PersonGT(id,102)) or (T5BCF(id) and PersonGT(id,102)) then	 --太玄经
			attribmax = attribmax + 1500
		end
		
		if wglw(id,203) or (DT(id,592) and PersonGT(id,203)) then	 --太玄经
			attribmax = attribmax + 1000
		end
		
		if id == 0 and T7DFWM(0) then --东方未明每学一个内功内力上限+200
			local tg = wgnumber(id, 5)
			attribmax = attribmax + math.modf(tg * 200)
		end
		
		if GX(id) and JX(id) then
			attribmax = attribmax + 1000
		end	
		
		if DT(id, 631) then
			local aa, bb = JX(id)
			if aa then
				attribmax = attribmax + bb * 50
			end	
		end
			
		if MPPD(id) == 2 and MPDJ(id) == 3 then
			attribmax = attribmax + 750
		end	
		
		if PersonKF(id, 85) then
			attribmax = attribmax + 750	--北冥内力硬上限+750	
		end
		
		--飞影彩蛋：真龙心法内力硬上限 +2500
		if PersonKF(id, 91) and JY.Person[id]["武功2"] == 91 and JY.Wugong[91]["名称"] == "赤血真龙诀" then
			attribmax = attribmax + 2500
		end
		
		if PersonKF(id, 88) then    --吸星内力硬上限+750
			attribmax = attribmax + 750		
		end
		
		if PersonKF(id, 108) then
			attribmax = attribmax + 600		
		end


		if id == 58 then
		  attribmax = attribmax - JY.Person[578]["半身像"] * 100	--武骧金星：修正杨过内力上限BUG
		end
		
		if id == 0 and putong() > 7 and juexing() > 0 then
			attribmax = attribmax + 1000		
		end
		
		attribmax = math.modf(attribmax * MPAttrib(id, 9))	
		
		if T1LEQ(id) or hasTF(id, 93) then
		  attribmax = 10000
		end 
		if DT(id, 583) then
		  attribmax = 10000
		elseif DT(id, 600) then
		  attribmax = 10000
		end   
		if DT(id, 603) then
		  attribmax = 10000
		end 
		if attribmax < 500 then
		  attribmax = 500
		end
		if not duiyou(id) then
			attribmax = 10000
		end	

		if wglw(id,85) or DT(id,118) or T1LEQ(id) then
		attribmax = math.min(attribmax, 12500)	
		attribmax = attribmax + 2500
		else
		attribmax = math.min(attribmax, 10000)
		end --武骧金星：内力不能超过10000点
    end

    if str == "用毒能力" and AN(id) then
      attribmax = 400
    end
    if str == "医疗能力" and AN(id) then
      attribmax = 400
    end
    if (str == "医疗能力" or str == "解毒能力") and id == 0 and putong() == 7 then
      attribmax = 500
    end
    if (str == "用毒能力" or str == "解毒能力") and id == 0 and putong() == 8 then
      attribmax = 500
    end
	if (wglw1(id,170) or DT(id,161)) and str == "用毒能力" then
		attribmax = attribmax + 150
	end	
	if DT(id,161) and JX(id) and str == "用毒能力" then
		attribmax = 400
	end	

    if str == "中毒程度" and value < 0 then
	if id == 0 and putong() == 8 then
		value = 0
	end
	if JY.Status == GAME_WMAP then
		if WAR.POISON[id] ~= nil and WAR.POISON[id] > 0 then
			value = 0
		end
	end
    end
    if str == "生命" and value > 0 then
		if JY.Status == GAME_WMAP then
			if WAR.XYWX[100+id] ~= nil and WAR.XYWX[100+id] > 0 then
				value = -value
			end
			if WAR.LXQJ[100+id] ~= nil and WAR.LXQJ[100+id] > 0 then 
			   WAR.LXQJ[200+id] = 1
			   WAR.LXQJ[100+id] = nil 
			end
			if WAR.HYDM[100+id] ~= nil and WAR.HYDM[100+id] > 0 then 
			   WAR.HYDM[200+id] = 1
			   WAR.HYDM[100+id] = nil 
			end
			if WAR.XYDH[100+id] ~= nil and WAR.XYDH[100+id] > 0 then 
			   WAR.XYDH[200+id] = 1
			   WAR.XYDH[100+id] = nil 
			end
		end
    end
    if str == "生命" and value < 0 then
		if JY.Status == GAME_WMAP then
			if jtyl(id) then
				value = 0
			end
			if MPPD(id) == 4 and wglw1(id,182) and (wglw1(id,16) or wglw1(id,46)) then
				local aa = math.modf((WAR.SPIRIT[id] or 0) - 80)
				if aa < 0 then aa = 0 end
				if JLSD(10,40+aa,id) then
				value = 0
				end
			end
			if wglw1(id,48) and WAR.BXJF2 == 1 then
				value = 0
			end	
		end
    end
	if str == "内力" and value < 0 then
		if JY.Status == GAME_WMAP then
			if MPPD(id) == 4 and wglw1(id,182) and (wglw1(id,16) or wglw1(id,46)) then
				local aa = math.modf((WAR.SPIRIT[id] or 0) - 120)
				if aa < 0 then aa = 0 end
				if JLSD(10,40+aa,id) then
				value = 0
				end
			end
		end
    end
    local newvalue = limitX(oldvalue + value, 0, attribmax)
    JY.Person[id][str] = newvalue
    local add = newvalue - oldvalue
    local showstr = ""
    if add > 0 then
       showstr = string.format("%s增加%d点！", str, add)
    elseif add < 0 then
       showstr = string.format("%s减少%d点！", str, -add)
    end
    return add, showstr
end
--显示物品菜单
function SelectThing(thing,thingnum, bg)    
	local xnum=9--小方框个数
	local ynum=4
	
	--local w=CC.ThingPicWidth*xnum+(xnum-1)*CC.ThingGapIn+2*CC.ThingGapOut;  --总体宽度
	--local h=CC.ThingPicHeight*ynum+(ynum-1)*CC.ThingGapIn+2*CC.ThingGapOut; --物品栏高度
    local w=CC.ScreenW
	local h=CC.ScreenH -(CC.ThingFontSize+2*CC.MenuBorderPixel)*2-10
	
	local dx=(CC.ScreenW-w)/2;
	local dy=(CC.ScreenH-h-2*(CC.ThingFontSize+2*CC.MenuBorderPixel+5))/2-50;
    local dx = 0
    local dy = 0
	
	local y1_1,y1_2,y2_1,y2_2,y3_1,y3_2;                  --名称，说明和图片的Y坐标

	local cur_line=0;
	local cur_x=0;
	local cur_y=0;
	local cur_thing=-1;

	while true do
		Cls();
		lib.PicLoadFile(CC.ThingPicFile[1], CC.ThingPicFile[2], 93)
		lib.PicLoadCache(93, 2, 500, 300)
		--  lib.LoadPicture(CONFIG.PicturePath .. "bj-2.png", 0, 0)
		if bg ~= nil then
			lib.LoadPicture(bg, -1, -1)
		end
		
		y1_1=dy;
		y1_2=y1_1+CC.ThingFontSize+2*CC.MenuBorderPixel;
		DrawBox(dx,y1_1,dx+w,y1_2,C_WHITE);
		y2_1=y1_2+5
		y2_2=y2_1+CC.ThingFontSize+2*CC.MenuBorderPixel
		DrawBox(dx,y2_1,dx+w,y2_2,C_WHITE);
		y3_1=y2_2+5;
		y3_2=y3_1+h;
		DrawBox(dx,y3_1,dx+w,y3_2,C_WHITE);

		for y=0,ynum-1 do
			for x=0,xnum-1 do
				local id=y*xnum+x+xnum*cur_line         --当前待选择物品
				local boxcolor;
				if x==cur_x and y==cur_y then
					boxcolor=C_WHITE;
					if thing[id]>=0 then
						cur_thing=thing[id];
						local str=JY.Thing[thing[id]]["名称"];
						--if JY.Thing[thing[id]]["练出武功"] > 0 then
							--str = str.."["..JY.Wugong[JY.Thing[thing[id]]["练出武功"]]["等级"].."级]"
						--end
						if JY.Thing[thing[id]]["类型"]==1 or JY.Thing[thing[id]]["类型"]==2 then
							if JY.Thing[thing[id]]["使用人"] >=0 then
								str=str .. "(" .. JY.Person[JY.Thing[thing[id]]["使用人"]]["姓名"] .. ")";
							end
						end
						str=string.format("%s X %d",str,thingnum[id]);
						local str2=JY.Thing[thing[id]]["物品说明"];
						if thing[id]==182 then
							str2=str2..string.format('(人%3d,%3d)',JY.Base['人X'],JY.Base['人Y'])
						end
						DrawString(dx+CC.ThingGapOut,y1_1+CC.MenuBorderPixel,str,C_GOLD,CC.ThingFontSize);
						DrawString(dx+CC.ThingGapOut,y2_1+CC.MenuBorderPixel,str2,C_ORANGE,CC.ThingFontSize);
						local myfont=math.modf(CC.ThingFontSize*0.65)--20
						local mx, my = dx+15 + 4 * myfont, h+10
						local myflag=0
						local myThing=JY.Thing[thing[id]]

--
						local function drawitem(ss,str,news)
							local mys
							if str==nil then
								mys=ss
							elseif myThing[ss]~=0 then
								if news==nil then
									if myflag==0 then
										mys=string.format(str..':%+d',myThing[ss])
									elseif myflag==1 then
										mys=string.format(str..':%d',myThing[ss])
									end
								else
									if myThing[ss]<0 then
										return
									end
									mys=string.format(str..':%s',news[myThing[ss]])
								end
							elseif myThing[ss]==0 and ss=="需内力性质" then
								mys=string.format(str..':%s',news[myThing[ss]])
							else
								return
							end
							
							local ccc=C_GOLD
							if ss=="需内力性质" then
								if myThing[ss]==0 then
									ccc=M_DeepSkyBlue
								elseif myThing[ss]==1 then
									ccc=C_ORANGE
								elseif myThing[ss]==2 then
									ccc=C_WHITE
								end
							end
							local mylen = myfont * string.len(mys) / 2 + 12
							if CC.ScreenW - dx < mx + mylen then
								my = my + myfont + 10
								mx = dx + 4 * myfont
							end
							DrawStrBox(mx,my,mys,ccc,myfont)
							mx=mx+mylen
						end

						if myThing["练出武功"] > 0 then
							local kfname = "习得:" .. JY.Wugong[myThing["练出武功"]]["名称"]
							DrawStrBox(mx, my, kfname, C_ORANGE, myfont)
							mx = mx + myfont * string.len(kfname) / 2 + 12
							local kflv = JY.Wugong[myThing["练出武功"]]["等级"].."级武功"
							DrawStrBox(mx, my, kflv, C_ORANGE, myfont)
							mx = mx + myfont * string.len(kflv) / 2 + 12
							if JY.Wugong[myThing["练出武功"]]["攻击力10"] > 0 then
								local kfwl = "威力:" .. JY.Wugong[myThing["练出武功"]]["攻击力10"] .. " 耗内:" .. 7 * JY.Wugong[myThing["练出武功"]]["消耗内力点数"]
								DrawStrBox(mx, my, kfwl, C_ORANGE, myfont)
								mx = mx + myfont * string.len(kfwl) / 2 + 12
							end
						end

						if myThing['类型']>0 then
							drawitem('加生命','生命')
							drawitem('加生命最大值','生命最大值')
							drawitem('加中毒解毒','中毒')
							drawitem('加体力','体力')
							if myThing['改变内力性质']==2 then
								drawitem('内力门路阴阳合一')
							elseif myThing['改变内力性质']==3 then
								drawitem('内力门路转为阴性')
							elseif myThing['改变内力性质']==4 then
								drawitem('内力门路转为阳性')
							end
							drawitem('加内力','内力')
							drawitem('加内力最大值','内力最大值')
							drawitem('加攻击力','攻击')
							drawitem('加轻功','轻功')
							drawitem('加防御力','防御')
							drawitem('加医疗能力','医疗')
							drawitem('加用毒能力','用毒')
							drawitem('加解毒能力','解毒')
							drawitem('加抗毒能力','抗毒')
							drawitem('加拳掌功夫','拳掌')
							drawitem('加御剑能力','御剑')
							drawitem('加耍刀技巧','耍刀')
							drawitem('加特殊兵器','特殊')
							drawitem('加暗器技巧','暗器')
							drawitem('加武学常识','武常')
							drawitem('加品德','品德')
							drawitem('加攻击次数','左右',{[0]='否','是'})
							drawitem('加攻击带毒','带毒')
							if myThing['类型'] == 1 and myThing['装备类型'] == 0 then
								local tmpvv = {}
								for v = 1, #CC.ExtraOffense do
									if CC.ExtraOffense[v][1] == thing[id] then
										tmpvv[#tmpvv + 1] = CC.ExtraOffense[v][2]
									end
								end
								if #tmpvv > 0 then
									local tmpss = "加成武功："
									for v = 1, #tmpvv do
										tmpss = tmpss..JY.Wugong[tmpvv[v]]["名称"].." "
									end
									drawitem(tmpss)
								end
							end
							if mx~=dx or my~=y3_2+2 then
								DrawStrBox(dx+15, h+10, " 效果:", C_RED, myfont)
							end
						end

						if myThing['类型']==1 or myThing['类型']==2 then
							if mx~=dx then
								mx=dx+4*myfont+12
								my=my+myfont+20
							end
							myflag=1
							local my2=my
							if myThing['仅修炼人物']>-1 then
								drawitem('仅限:'..JY.Person[myThing['仅修炼人物']]['姓名'])
							end
							drawitem('需内力性质','阴阳',{[0]='阴','阳','不限'})
							drawitem('需内力','内力')
							drawitem('需攻击力','攻击')
							drawitem('需轻功','轻功')
							drawitem('需用毒能力','用毒')
							drawitem('需医疗能力','医疗')
							drawitem('需解毒能力','解毒')
							drawitem('需拳掌功夫','拳掌')
							drawitem('需御剑能力','御剑')
							drawitem('需耍刀技巧','耍刀')
							drawitem('需特殊兵器','特殊')
							drawitem('需暗器技巧','暗器')
							drawitem('需资质','资质')
							drawitem('需经验','修炼经验')
							if mx~=dx or my~=my2 then
								DrawStrBox(dx+15,my2 ,' 需求:',C_RED,myfont)
							end
						end
					else
						cur_thing=-1;
					end
				else
					boxcolor=C_BLACK;
				end

				local boxx = dx + CC.ThingGapOut + x * (CC.ThingPicWidth*3-20 + CC.ThingGapIn)--小方框间距-5
				local boxy = y3_1 + CC.ThingGapOut + y * (CC.ThingPicHeight*3-20 + CC.ThingGapIn)
				lib.DrawRect(boxx, boxy, boxx + 101, boxy + 101, boxcolor) --小方框大小
				--[[if thing[id] >= 0 then
					if CC.LoadThingPic == 1 then
					--lib.LoadPicture(CONFIG.PicturePath .."wp"..thing[id]..".png", boxx + 1, boxy + 1)
						lib.PicLoadCache(2, thing[id] * 2, boxx + 1, boxy + 1, 1)
					else
					    lib.PicLoadCache(0, (thing[id] + CC.StartThingPic) * 2, boxx + 1, boxy + 1, 1)
					end
					lib.PicLoadCache(2, thing[id] * 2, boxx + 1, boxy + 1, 1)
				end]]
				--lib.PicLoadCache(2, thing[id] * 2, boxx + 1, boxy + 1, 1)
				if thing[id] >= 339 then 
				lib.PicLoadCache(2, (thing[id]+1) * 2, boxx + 1, boxy + 1, 1)
				else
				lib.PicLoadCache(2, thing[id] * 2, boxx + 1, boxy + 1, 1)
				end
			end
		end

		ShowScreen();

		local keypress=WaitKey(1);
		lib.Delay(100);
		if keypress==VK_ESCAPE then
			cur_thing=-1;
			break;
		elseif keypress==VK_RETURN or keypress==VK_SPACE then
			break;
		elseif keypress==VK_UP then
			if  cur_y == 0 then
				if  cur_line > 0 then
					cur_line = cur_line - 1;
				end
			else
				cur_y = cur_y - 1;
			end
		elseif keypress==VK_DOWN then
			if  cur_y ==ynum-1 then
				if  cur_line < (math.modf(CC.MyThingNum/xnum)-ynum) then
					cur_line = cur_line + 1;
				end
			else
				cur_y = cur_y + 1;
			end
		elseif keypress==VK_LEFT then
			if  cur_x > 0 then
				cur_x=cur_x-1;
			else
				cur_x=xnum-1;
			end
		elseif keypress==VK_RIGHT then
			if  cur_x ==xnum-1 then
				cur_x=0;
			else
				cur_x=cur_x+1;
			end
		elseif keypress==888 and cur_line>0 then
			cur_line=cur_line-1
		elseif keypress==999 and cur_line<(math.modf(CC.MyThingNum/xnum)-ynum) then
			cur_line=cur_line+1
		elseif keypress>999999 then
			local k,mx,my
			k=math.modf(keypress/1000000)
			keypress=math.fmod(keypress,1000000)
			mx=math.modf(keypress/1000)
			my=math.fmod(keypress,1000)
			if mx>dx and my>dy and mx<CC.ScreenW-dx and my<CC.ScreenH-dy then
				cur_x=math.modf((mx-dx-CC.ThingGapOut/2)/(CC.ThingPicWidth+CC.ThingGapIn))
				cur_y=math.modf((my-y3_1-CC.ThingGapOut/2)/(CC.ThingPicHeight+CC.ThingGapIn))
				if k==2 then
					break
				end
			end
		end
	end
	Cls();
	return cur_thing;
end

-- 读取游戏进度
-- id=0 新进度，=1/2/3 进度
function SBLDATAL(id)
    local sid = id
    JY.LID = id
    local v = 0
    local t1 = lib.GetTime()
    CC.SBL_Base = {}
    CC.SBL_Person = {}
    CC.SBL_Thing = {}
    CC.SBL_Scene = {}
    CC.SBL_Wugong = {}
    CC.SBL_Shop = {}

    --读取R*.idx文件
    local data = Byte.create(24)
    Byte.loadfile(data, CC.R_IDXFilename[0], 0, 24)
    local idx = {}
    idx[0] = 0
    for i = 1, 6 do
    idx[i] = Byte.get32(data, 4 * (i - 1))
    end
  
    --读取R*.grp文件
    JY.Data_Base = Byte.create(idx[1] - idx[0])
    Byte.loadfile(JY.Data_Base, CC.R_GRPFilename[id], idx[0], idx[1] - idx[0])
  
    --设置访问基本数据的方法，这样就可以用访问表的方式访问了。而不用把二进制数据转化
    local meta_t = {__index = function(t, k)
    return GetDataFromStruct(JY.Data_Base, 0, CC.Base_S, k)
    end, __newindex = function(t, k, v)
    SetDataFromStruct(JY.Data_Base, 0, CC.Base_S, k, v)
    end}
    setmetatable(JY.Base, meta_t)
  
  
	JY.PersonNum = math.floor((idx[2] - idx[1]) / CC.PersonSize)
	-- 人物
	JY.Data_Person = Byte.create(CC.PersonSize * JY.PersonNum)
	Byte.loadfile(JY.Data_Person, CC.R_GRPFilename[id], idx[1], CC.PersonSize * JY.PersonNum)

	help.data.load_person_data_new(id)
	help.playersetting.load_GameSetting_from_file(id)
  
    JY.ThingNum = math.floor((idx[3] - idx[2]) / CC.ThingSize)   --物品
    JY.Data_Thing = Byte.create(CC.ThingSize * JY.ThingNum)
    Byte.loadfile(JY.Data_Thing, CC.R_GRPFilename[id], idx[2], CC.ThingSize * JY.ThingNum)
    for i = 0, JY.ThingNum - 1 do
    JY.Thing[i] = {}
    local meta_t = {__index = function(t, k)
      return GetDataFromStruct(JY.Data_Thing, i * CC.ThingSize, CC.Thing_S, k)
    end, __newindex = function(t, k, v)
      SetDataFromStruct(JY.Data_Thing, i * CC.ThingSize, CC.Thing_S, k, v)
    end}
    setmetatable(JY.Thing[i], meta_t)
    end
  
    JY.SceneNum = math.floor((idx[4] - idx[3]) / CC.SceneSize)    --场景
    JY.Data_Scene = Byte.create(CC.SceneSize * JY.SceneNum)
    Byte.loadfile(JY.Data_Scene, CC.R_GRPFilename[id], idx[3], CC.SceneSize * JY.SceneNum)
    for i = 0, JY.SceneNum - 1 do
    JY.Scene[i] = {}
    local meta_t = {__index = function(t, k)
      return GetDataFromStruct(JY.Data_Scene, i * CC.SceneSize, CC.Scene_S, k)
    end, __newindex = function(t, k, v)
      SetDataFromStruct(JY.Data_Scene, i * CC.SceneSize, CC.Scene_S, k, v)
    end}
    setmetatable(JY.Scene[i], meta_t)
    end
  
    JY.WugongNum = math.floor((idx[5] - idx[4]) / CC.WugongSize)  --武功
    JY.Data_Wugong = Byte.create(CC.WugongSize * JY.WugongNum)
    Byte.loadfile(JY.Data_Wugong, CC.R_GRPFilename[id], idx[4], CC.WugongSize * JY.WugongNum)
    for i = 0, JY.WugongNum - 1 do
    JY.Wugong[i] = {}
    local meta_t = {__index = function(t, k)
      return GetDataFromStruct(JY.Data_Wugong, i * CC.WugongSize, CC.Wugong_S, k)
    end, __newindex = function(t, k, v)
      SetDataFromStruct(JY.Data_Wugong, i * CC.WugongSize, CC.Wugong_S, k, v)
    end}
    setmetatable(JY.Wugong[i], meta_t)
    end
  
    JY.ShopNum = math.floor((idx[6] - idx[5]) / CC.ShopSize)   --小宝商店
    JY.Data_Shop = Byte.create(CC.ShopSize * JY.ShopNum)
    Byte.loadfile(JY.Data_Shop, CC.R_GRPFilename[id], idx[5], CC.ShopSize * JY.ShopNum)
    for i = 0, JY.ShopNum - 1 do
    JY.Shop[i] = {}
    local meta_t = {__index = function(t, k)
      
      return GetDataFromStruct(JY.Data_Shop, i * CC.ShopSize, CC.Shop_S, k)
    end, __newindex = function(t, k, v)
      
      SetDataFromStruct(JY.Data_Shop, i * CC.ShopSize, CC.Shop_S, k, v)
    end}
    setmetatable(JY.Shop[i], meta_t)
    end
    if id == 0 then
    SetDataFromStruct = SetDataFromStruct1
    for i,v in pairs(CC.Base_S) do
      local tmp = JY.Base[i]
      JY.Base[i] = tmp
      tmp = JY.Base[i]
    end
    for i = 0, JY.PersonNum - 1 do
      for ii,vv in pairs(CC.Person_S) do
        local tmp = JY.Person[i][ii]
        JY.Person[i][ii] = tmp
      end
    end
    for i = 0, JY.ThingNum - 1 do
      for ii,vv in pairs(CC.Thing_S) do
        local tmp = JY.Thing[i][ii]
        JY.Thing[i][ii] = tmp
      end
    end
    for i = 0, JY.SceneNum - 1 do
      for ii,vv in pairs(CC.Scene_S) do
        local tmp = JY.Scene[i][ii]
        JY.Scene[i][ii] = tmp
      end
    end
    for i = 0, JY.WugongNum - 1 do
      for ii,vv in pairs(CC.Wugong_S) do
        local tmp = JY.Wugong[i][ii]
        JY.Wugong[i][ii] = tmp
      end
    end
    for i = 0, JY.ShopNum - 1 do
      for ii,vv in pairs(CC.Shop_S) do
        local tmp = JY.Shop[i][ii]
        JY.Shop[i][ii] = tmp
      end
    end
    end
    SetDataFromStruct = SetDataFromStruct2
    lib.LoadSMap(CC.S_Filename[id], CC.TempS_Filename, JY.SceneNum, CC.SWidth, CC.SHeight, CC.D_Filename[id], CC.DNum, 11)
    collectgarbage()
  
    JY.LOADTIME = lib.GetTime()
  
    JY.YEAR = GetS(14, 2, 1, 1)
    JY.MONTH = GetS(14, 2, 1, 2)
    JY.DAY = GetS(14, 2, 1, 3)
    JY.TL = GetS(14, 2, 1, 0)
    JY.TERM = GetS(14, 2, 1, 4)

    if JY.TL < 0 then JY.TL = 100 end
    if JY.YEAR < 1 then JY.YEAR = 1 end
    if JY.MONTH < 1 then JY.MONTH = 1 end
    if JY.DAY < 1 then JY.DAY = 1 end
	   JY.DIFF = JY.Thing[202][WZ7]
       DIYload(id) --需添加
    if sid > 0 then
       v = HSRSD(sid)
    end
    if v ~= HSRSDL() then
       --JY.Status = x
       --ZBXS()
    end

    local sid = id
    --RSDLSJLJC(sid)
    if id > 0 then
       GXDWPJLJC()		--Base数据检查，完全删除
       GPSXJLJC()		--人物携带物品数据、武功数据还原和检查，去掉部分
       GWPJC()			--人物装备数据还原，完全删除
       GCJJLJC()		--场景数据判断和还原，去掉部分
       GWGJC()			--武功数据还原，不需要
       GSDJC()			--商店数据还原，不需要
    end
       FINALWORK()
    if id > 0 then
       FINALWORK2()
    end
end

--物品整理
function Menu_WPZL()
    for i = 1, CC.MyThingNum do
        if JY.Base["物品" .. i] > -1 then
            for ii = i + 1, CC.MyThingNum do
                if JY.Base["物品" .. ii] > -1 and JY.Base["物品" .. ii] < JY.Base["物品" .. i] then
                    JY.Base["物品" .. i], JY.Base["物品" .. ii] = JY.Base["物品" .. ii], JY.Base["物品" .. i]
                    JY.Base["物品数量" .. i], JY.Base["物品数量" .. ii] = JY.Base["物品数量" .. ii], JY.Base["物品数量" .. i]
                end
            end
        end
    end
    Cls()
    DrawStrBoxWaitKey(CC.s33, C_WHITE, 30)
end
--读取进度菜单
function Menu_ReadRecord()
  local menu = {
{"进度一", nil, 1}, 
{"进度二", nil, 1}, 
{"进度三", nil, 1},
{"进度四", nil, 1},
{"进度五", nil, 1},
{"进度六", nil, 1},
{"进度七", nil, 1},
{"进度八", nil, 1},
{"进度九", nil, 1},
{"进度十", nil, 1},
{"自动档", nil, 1}}
    local r = ShowMenu(menu, 11, 0, CC.MainSubMenuX2, CC.MainSubMenuY, 0, 0, 1, 1, CC.DefaultFont, C_ORANGE, C_WHITE)
    if r == 0 then
       return 0
    elseif r > 0 then
       DrawStrBox(CC.MainSubMenuX2, CC.MainSubMenuY, "请稍候......", C_WHITE, CC.DefaultFont)
       ShowScreen()
       SBLDATAL(r)
	    if YC_Status() == 0 then
		    YC_Exit()
        elseif JY.Base["无用"] ~= -1 then
                if JY.SubScene < 0 then
                    CleanMemory()
		            lib.PicInit()--
                    lib.UnloadMMap()
        end
        lib.PicInit()
        lib.ShowSlow(50, 1)
        JY.Status = GAME_SMAP
        JY.SubScene = JY.Base["无用"]
        JY.MmapMusic = -1
        JY.MyPic = GetMyPic()
        Init_SMap(1)
    else
        JY.SubScene = -1
        JY.Status = GAME_FIRSTMMAP
                end
        return 1
    end
end


-- 写游戏进度
-- id=0 新进度，=1/2/3 进度
function SBLDATAS(id)
	DIYsave(id) --需添加
    local t1 = lib.GetTime()
    JY.SAVETIME = lib.GetTime()
    JY.GTIME = math.modf((JY.SAVETIME - JY.LOADTIME) / 60000)
    GetS(14, 2, 1, 4, GetS(14, 2, 1, 4) + JY.GTIME)
  
    SetS(14, 2, 1, 1, JY.YEAR)
    SetS(14, 2, 1, 2, JY.MONTH)
    SetS(14, 2, 1, 3, JY.DAY)
    SetS(14, 2, 1, 4, JY.TERM)
    SetS(14, 2, 1, 0, JY.TL)
  
    JY.LOADTIME = lib.GetTime()
    local sid = id
    JY.SID = id
    RDEBUG()      --无用的rdebug
    RSDLSJL(sid)	--随机数据验证很严格，不可少	
    GXDWPJL()		--保存身上的物品、武功、武功等级，不可少
    GPSXJL()	--主角携带物品数据，可减少
    GCJJL()		--场景数据保存，不可少

    local data = Byte.create(24)
    Byte.loadfile(data, CC.R_IDXFilename[0], 0, 24)
    local idx = {}
    idx[0] = 0
    for i = 1, 6 do
    idx[i] = Byte.get32(data, 4 * (i - 1))
    end

  
    Byte.savefile(JY.Data_Base, CC.R_GRPFilename[id], idx[0], idx[1] - idx[0])
    -- Byte.savefile(JY.Data_Person, CC.R_GRPFilename[id], idx[1], CC.PersonSize * JY.PersonNum)
	help.data.store_person_data(id, idx[1])
	help.playersetting.store_GameSetting_to_file(id)
	
    Byte.savefile(JY.Data_Thing, CC.R_GRPFilename[id], idx[2], CC.ThingSize * JY.ThingNum)
    Byte.savefile(JY.Data_Scene, CC.R_GRPFilename[id], idx[3], CC.SceneSize * JY.SceneNum)
    Byte.savefile(JY.Data_Wugong, CC.R_GRPFilename[id], idx[4], CC.WugongSize * JY.WugongNum)
    Byte.savefile(JY.Data_Shop, CC.R_GRPFilename[id], idx[5], CC.ShopSize * JY.ShopNum)
  
    --保存数据验证
    --[[
    local RidS = filelength(CC.R_GRPFilename[sid])
    local d = Byte.create(RidS)
    Byte.loadfile(d, CC.R_GRPFilename[sid], 0, RidS)
    local yz = Byte.hash(d, RidS)
    local a = tonumber(string.sub(yz.."", string.len(yz.."") - 4, string.len(yz.."") - 3));
    local b = tonumber(string.sub(yz.."", string.len(yz.."") - 3, string.len(yz.."") - 2));
    local c = tonumber(string.sub(yz.."", string.len(yz.."") - 2, string.len(yz.."") - 1));
    SetS(87, 9, 10, 5, a+b+c);
    SetS(87, 9, 9, 5, a);
    SetS(87, 9, 8, 5, b);
    SetS(87, 9, 7, 5, c);
    --数据验证保存结束
    ]]
  
    lib.SaveSMap(CC.S_Filename[id], CC.D_Filename[id])
  
    GPSXJLXZ()		--人物数据还原，可少
  
    local v = 0
    if sid > 0 then
       v = HSRSD(sid)
    end
    HSRSDS(v)
end

DrawBoxTitle_sub = function(x1, y1, x2, y2, tx1, ty1, tx2, ty2, color)
    local s = 4
    lib.DrawRect(x1 + s, y1, tx1, y1, color)
    lib.DrawRect(tx2, y1, x2 - s, y1, color)
    lib.DrawRect(x2 - s, y1, x2 - s, y1 + s, color)
    lib.DrawRect(x2 - s, y1 + s, x2, y1 + s, color)
    lib.DrawRect(x2, y1 + s, x2, y2 - s, color)
    lib.DrawRect(x2, y2 - s, x2 - s, y2 - s, color)
    lib.DrawRect(x2 - s, y2 - s, x2 - s, y2, color)
    lib.DrawRect(x2 - s, y2, x1 + s, y2, color)
    lib.DrawRect(x1 + s, y2, x1 + s, y2 - s, color)
    lib.DrawRect(x1 + s, y2 - s, x1, y2 - s, color)
    lib.DrawRect(x1, y2 - s, x1, y1 + s, color)
    lib.DrawRect(x1, y1 + s, x1 + s, y1 + s, color)
    lib.DrawRect(x1 + s, y1 + s, x1 + s, y1, color)
    DrawBox_1(tx1, ty1, tx2, ty2, color)
end

DrawStrBox2 = function(x, y, str, color, size, bjcolor)
    local strarray = {}
    local num, maxlen = nil, nil
    maxlen = 0
    num, strarray = Split(str, "*")
    for i = 1, num do
    local len = string.len(strarray[i])
    if maxlen < len then
      maxlen = len
    end
    end
    local w = size * maxlen / 2 + 2 * CC.MenuBorderPixel
    local h = 2 * CC.MenuBorderPixel + size * num
    if x == -1 then
       x = (CC.ScreenW - size / 2 * maxlen - 2 * CC.MenuBorderPixel) / 2
    end
    if y == -1 then
       y = (CC.ScreenH - size * num - 2 * CC.MenuBorderPixel) / 2
    end
    DrawBox2(x, y, x + w - 1, y + h - 1, C_WHITE, bjcolor)
    for i = 1, num do
    DrawString(x + CC.MenuBorderPixel, y + CC.MenuBorderPixel + size * (i - 1), strarray[i], color, size)
    end
end

--绘制一个带背景的白色方框，四角凹进
--苍炎已不再使用
function DrawBox2(x1, y1, x2, y2, color, bjcolor)
    local s = 4
    if not bjcolor then
       bjcolor = 0
    end
    if bjcolor >= 0 then
       lib.Background(x1, y1 + s, x1 + s, y2 - s, 128, bjcolor)
       lib.Background(x1 + s, y1, x2 - s, y2, 128, bjcolor)
       lib.Background(x2 - s, y1 + s, x2, y2 - s, 128, bjcolor)
    end
    if color >= 0 then
       local r, g, b = GetRGB(color)
       DrawBox_2(x1 + 1, y1, x2, y2, RGB(math.modf(r / 2), math.modf(g / 2), math.modf(b / 2)))
       DrawBox_2(x1, y1, x2 - 1, y2 - 1, color)
    end
end

--绘制四角凹进的方框
--苍炎已不再使用
function DrawBox_2(x1, y1, x2, y2, color)
    local s = 4
    lib.DrawRect(x1 + s, y1, x2 - s, y1, color)
    lib.DrawRect(x2 - s, y1, x2 - s, y1 + s, color)
    lib.DrawRect(x2 - s, y1 + s, x2, y1 + s, color)
    lib.DrawRect(x2, y1 + s, x2, y2 - s, color)
    lib.DrawRect(x2, y2 - s, x2 - s, y2 - s, color)
    lib.DrawRect(x2 - s, y2 - s, x2 - s, y2, color)
    lib.DrawRect(x2 - s, y2, x1 + s, y2, color)
    lib.DrawRect(x1 + s, y2, x1 + s, y2 - s, color)
    lib.DrawRect(x1 + s, y2 - s, x1, y2 - s, color)
    lib.DrawRect(x1, y2 - s, x1, y1 + s, color)
    lib.DrawRect(x1, y1 + s, x1 + s, y1 + s, color)
    lib.DrawRect(x1 + s, y1 + s, x1 + s, y1, color)
end

--HSRSD
function HSRSD(sid)
    local ss = 0
    local RidS = filelength(CC.R_GRPFilename[sid])
    local d = Byte.create(RidS)
    Byte.loadfile(d, CC.R_GRPFilename[sid], 0, RidS)
    ss = ss + Byte.hash(d, RidS)
    local RidS = filelength(CC.S_Filename[sid])
    local d = Byte.create(RidS)
    Byte.loadfile(d, CC.S_Filename[sid], 0, RidS)
    ss = ss + Byte.hash(d, RidS)
    local RidS = filelength(CC.D_Filename[sid])
    local d = Byte.create(RidS)
    Byte.loadfile(d, CC.D_Filename[sid], 0, RidS)
    ss = ss + Byte.hash(d, RidS)
    local d = Byte.create(1)
    return ss
end

function HSRSDS(v)
    local v1, v2, v3, v4 = 0, 0, 0, 0
    if v < 0 then
       v1 = 1
       v = -v
    end
    local y1 = 123454321
    if y1 < v then
       v = v - y1
       v2 = v2 + 1
    end
    local y2 = 32123
    if y2 < v then
       v = v - y2
       v3 = v3 + 1
    end
    v4 = v
    lib.LoadSMap(CC.S_Filename[0], CC.TempS_Filename, JY.SceneNum, CC.SWidth, CC.SHeight, CC.D_Filename[0], CC.DNum, 11)
    SetS(13, JY.SID, 1, 4, v1)
    SetS(13, JY.SID, 1, 5, v2)
    SetS(13, JY.SID, 2, 4, v3)
    SetS(13, JY.SID, 2, 5, v4)
    lib.SaveSMap(CC.S_Filename[0], CC.D_Filename[0])
    lib.LoadSMap(CC.S_Filename[JY.SID], CC.TempS_Filename, JY.SceneNum, CC.SWidth, CC.SHeight, CC.D_Filename[JY.SID], CC.DNum, 11)
end

function HSRSDL()
    local v1, v2, v3, v4 = 0, 0, 0, 0
    local y1 = 123454321
    local y2 = 32123
    local v = 0
    lib.LoadSMap(CC.S_Filename[0], CC.TempS_Filename, JY.SceneNum, CC.SWidth, CC.SHeight, CC.D_Filename[0], CC.DNum, 11)
    v1 = GetS(13, JY.LID, 1, 4)
    v2 = GetS(13, JY.LID, 1, 5)
    v3 = GetS(13, JY.LID, 2, 4)
    v4 = GetS(13, JY.LID, 2, 5)
    lib.LoadSMap(CC.S_Filename[JY.LID], CC.TempS_Filename, JY.SceneNum, CC.SWidth, CC.SHeight, CC.D_Filename[JY.LID], CC.DNum, 11)
    v = v4 + v3 * y2 + v2 * y1
    if v1 == 1 then
       v = -(v)
    end
    return v
end

--无用，浪费时间
function RDEBUG()

end


--人物携带物品数据 加密
function GPSXJL()
    for i = 1, #TeamP do
        for p = 1, 48 do
            if p > 40 and p < 45 then
                --JY.Person[TeamP[i]][PSXJL[p]] = math.random(20000) + 10000
            else
                --SetS(66, p, i, 5, JY.Person[TeamP[i]][PSXJL[p]] + 30)
            end
        end
    end
    --SetS(66, 13, 4, 5, GetS(66, 13, 4, 5) + 5)
end

--人物携带物品 还原
function GPSXJLXZ()
    JY.Person[36]["携带物品1"] = 78
    JY.Person[47]["携带物品1"] = 8
    JY.Person[49]["携带物品1"] = 75
    JY.Person[49]["携带物品2"] = 200
end

function GXDWPJL()
    for y = 1, 4 do
    for x = 1, 50 do
      SetS(5, x, y, 4, JY.Base["物品" .. x + y * 50 - 50])
      SetS(5, x, y, 5, JY.Base["物品数量" .. x + y * 50 - 50])
    end
    end
    for i = 1, 10 do
      SetS(5, i, 5, 5, JY.Base[BASEDATA[i]])
    end
	for i = 11, 10 + HHH_GAME_SETTING["WG_COUNT_MAX"] do
	   SetS(5, i, 5, 5, JY.Person[0]["武功等级" .. i - 10])
	end
end


--Base数据数据检查
function GXDWPJLJC()
	
end

--人物携带物品数据、武功数据还原和检查
function GPSXJLJC()
    --SetS(66, 13, 4, 5, GetS(66, 13, 4, 5) - 5)
  
    --人物携带物品判断
    for i = 0, JY.PersonNum-1 do
    for s = 1, 4 do
      if JY.Person[i]["携带物品数量" .. s] < 1 then
        JY.Person[i]["携带物品" .. s] = -1
      end
    end
    end
  
    --人物武功判断
    --[[ for p = 0, JY.PersonNum-1 do
    local r = 0
    if JY.Person[p]["武功1"] > 0 then
        if duiyou(p) then
		    r = 1
	    end
    end
    if r == 0 then
        for w = 1, 10 do
            if JY.Person[p]["武功" .. w] > 0 then
                if p < 191 then
                    JY.Person[p]["武功等级" .. w] = 999
                end
    else
                JY.Person[p]["武功等级" .. w] = 900
            end
        end
    end
    end
]]
end

--人物装备数据还原
function GWPJC()

end

--场景数据判断和还原
function GCJJLJC()
    for i = 0, 105 do
        for s = 2, 7 do
            if s ~= 3 then
                JY.Scene[i][CJSX[s]] = CSCJSX[i + 1][s] - 33
            end
        end
    end
end

--武功数据还原，不需要
function GWGJC()
	if JY.Wugong[91]["名称"] == YYGZT[1] then
    JY.Wugong[91]["攻击力10"] = 1300
    else
    if JY.Wugong[91]["名称"] == YYGZT[2] then
      JY.Wugong[91]["攻击力10"] = 1600
    end
    end
    --JY.WugongNum = JY.WugongNum +2
end

--商店数据还原，不需要
function GSDJC()
    --JY.ThingNum = JY.ThingNum +2 
end

--增加当前主角走路动画帧, 主地图和场景地图都使用
function AddMyCurrentPic()        ---增加当前主角走路动画帧,
    JY.MyCurrentPic=JY.MyCurrentPic+1;
end
--黄蓉，布阵
function hgb()
    for i = 0,WAR.PersonNum-1 do --17-2-19-幻光步
    if (wglw(WAR.Person[i]["人物编号"],93) or (DT(WAR.Person[i]["人物编号"],66) and PersonKF(WAR.Person[i]["人物编号"],93)) or (DT(WAR.Person[i]["人物编号"],558) and PersonKF(WAR.Person[i]["人物编号"],93))) and inteam(WAR.Person[i]["人物编号"]) then
    WAR.CurID = i
	WAR.ShowHead = 1
    --WAR.ShowHead = 1
    QZXS("请选择定位坐标")  -- DrawStrBox(CC.MainMenuX, CC.MainMenuY, CC.EVB183, C_GOLD, 30)
    War_CalMoveStep(WAR.CurID, 15, 1) --武功移动步数
    local nx, ny = nil, nil
    while true do
	   nx, ny = War_SelectMove() --显示+选择步数
	if nx ~= nil then
	if lib.GetWarMap(nx, ny, 2) > 0 or lib.GetWarMap(nx, ny, 5) > 0 then
       QZXS(CC.EVB186)			--此处有人！请重新选择
	elseif CC.SceneWater[lib.GetWarMap(nx, ny, 0)] ~= nil then
	   QZXS(CC.EVB187)		--水面，不可进入！请重新选择
	else
	   QZXS("已定位坐标点")
	   WAR.HGB[100+WAR.Person[i]["人物编号"]] = {nx,ny}
	   WAR.ShowHead = 0
	break;
	end
	end
	end
    end
    end
end
function acsj()--唐门模式暗藏杀机
    for i = 0,WAR.PersonNum-1 do --17-2-19-幻光步
    if MPPD(WAR.Person[i]["人物编号"]) == 9 and WAR.TMMS[WAR.Person[i]["人物编号"]] == 2 and inteam(WAR.Person[i]["人物编号"]) then
    WAR.CurID = i
	WAR.ShowHead = 1
    --WAR.ShowHead = 1
    QZXS("请选择暗藏杀机坐标")  -- DrawStrBox(CC.MainMenuX, CC.MainMenuY, CC.EVB183, C_GOLD, 30)
    War_CalMoveStep(WAR.CurID, 15, 1) --武功移动步数
    local nx, ny = nil, nil
    while true do
	   nx, ny = War_SelectMove() --显示+选择步数
	if nx ~= nil then
	   QZXS("已定位坐标点")
	   WAR.ACSJ[100+WAR.Person[i]["人物编号"]] = {nx,ny}
	   --WAR.ShowHead = 0
	   break;
	end
	end
	local nx, ny = nil, nil
	while true do
	   nx, ny = War_SelectMove() --显示+选择步数
	if nx ~= nil then
	   QZXS("已定位坐标点")
	   WAR.ACSJ[200+WAR.Person[i]["人物编号"]] = {nx,ny}
	  -- WAR.ShowHead = 0
	  break;
	end
	end
	local nx, ny = nil, nil
	while true do
	   nx, ny = War_SelectMove() --显示+选择步数
	if nx ~= nil then
	   QZXS("已定位坐标点")
	   WAR.ACSJ[300+WAR.Person[i]["人物编号"]] = {nx,ny}
	   WAR.ShowHead = 0
	   break;
	end
	end
	end
    end
end
  
function qjb() --唐门模式千机变
    local pid = WAR.Person[WAR.CurID]["人物编号"]
    QZXS("请选择安放坐标")  -- DrawStrBox(CC.MainMenuX, CC.MainMenuY, CC.EVB183, C_GOLD, 30)
    War_CalMoveStep(WAR.CurID, 15, 1) --武功移动步数
    local nx, ny = nil, nil
    while true do
	   nx, ny = War_SelectMove() --显示+选择步数
	if nx ~= nil then
	if lib.GetWarMap(nx, ny, 2) > 0 or lib.GetWarMap(nx, ny, 5) > 0 then
       QZXS(CC.EVB186)			--此处有人！请重新选择
	elseif CC.SceneWater[lib.GetWarMap(nx, ny, 0)] ~= nil then
	   QZXS(CC.EVB187)		--水面，不可进入！请重新选择
	else
	   --QZXS("已定位坐标点")
	   --WAR.ACSJ[100+WAR.Person[i]["人物编号"]] = {nx,ny}
	   --WAR.ShowHead = 0
	   break;
	end
	end
	end
	local mid = 30001+pid;				--定义一个临时的戚长发数据
	JY.Person[mid] = {};
	for i=1, #PSX do
		JY.Person[mid][PSX[i]] = JY.Person[pid][PSX[i]];--JY.Person[WAR.Person[nyft]["人物编号"]][PSX[i]];
	end
	JY.Person[mid]["姓名"] = "千机变"--JY.Person[WAR.Person[nyft]["人物编号"]]["姓名"]
	JY.Person[mid]["生命"] = JY.Person[pid]["生命最大值"]--JY.Person[WAR.Person[nyft]["人物编号"]]["生命"];
	JY.Person[mid]["无用12"] = pid--WAR.Person[nyft]["人物编号"]
	JY.Person[mid]["无用14"] = JY.Person[pid]["无用14"]--JY.Person[WAR.Person[nyft]["人物编号"]]["无用14"]
    for o = 1,HHH_GAME_SETTING["WG_COUNT_MAX"] do
	JY.Person[mid]["武功"..o] = JY.Person[pid]["武功"..o]
	JY.Person[mid]["武功等级"..o] = JY.Person[pid]["武功等级"..o]
    end
	if WAR.Person[WAR.CurID]["我方"] == true then 
	NewWARPersonZJ(mid, true, nx, ny, false, 1);
	WAR.DW[mid] = 1
	else
	NewWARPersonZJ(mid, false, nx, ny, false, 1);
	WAR.DW[mid] = 2
	end
	if pid == 0 and cxzj() > 0 then 
	   JY.Person[mid]["无用12"] = cxzj()
	end
	--WAR.TMMS[mid] = 3
	--WAR.Person[mid].Time = 999
	--WAR.JSJY[pid] = mid
	WAR.TMMS[400+pid] = mid
	WAR.TMMS[500+mid] = 100
	WAR.TMMS[600+mid] = pid
	--WAR.JSJY[300+mid] = 1
	WAR.SPIRITMIN[mid] = 100
	--WAR.UNDEAD[pid] = 15
	if jtyl(pid) then
	WAR.SJSM[1000+mid] = JY.Person[mid]["生命"]
	--WAR.YDSD[mid] = WAR.YDSD[pid]
	end
	if wssz(pid) then
	WAR.SSFN[1000+mid] = JY.Person[mid]["生命"]
	--WAR.YDSD[mid] = WAR.YDSD[pid]
	end
				local hh2 = JYMsgBox("攻击模式", "请选择攻击模式？", {"连弩", "重弩", "毒煞"}, 3, pid)	
			    if hh2 <= 0 then
					return 0
				end	
				if hh2 == 1 then 
				WAR.QJBMS[mid] = 1
				JY.Person[mid]["姓名"] = "千机变・连弩"
				elseif hh2 == 2 then 
				WAR.QJBMS[mid] = 2 
				JY.Person[mid]["姓名"] = "千机变・重弩"
				else
				WAR.QJBMS[mid] = 3 
				JY.Person[mid]["姓名"] = "千机变・毒煞"
				--acsj()
				end		
end
function buzhen()
	local pid = 56
	if hasSK(58) and not inteam(pid) then
		pid = zj()
	end
	if putong() == 12 then --武骧金星：乾坤皆阵布阵
		pid = 0
	end
    if not inteam(pid) then
       return 
    end
    if WAR.ZDDH == 238 or WAR.ZDDH == 291 then
       return 
    end
    say("要布置阵型吗？", pid)
    if not DrawStrBoxYesNo(-1, -1, "要布置阵型吗", C_WHITE, CC.DefaultFont) then
       return 
    end
    for i = 0, WAR.PersonNum - 1 do
    if WAR.Person[i]["我方"] then
      WAR.CurID = i
      WAR.ShowHead = 1
	  if pid == 0 and putong() == 12 then --武骧金星：乾坤皆阵可以移动八格
		War_CalMoveStep(WAR.CurID, 8, 0)
	  else
		War_CalMoveStep(WAR.CurID, math.modf(JY.Person[pid]["等级"] / 3 - 4), 0)
	  end
      local x, y = nil, nil
      while true do
        x, y = War_SelectMove()
        if x ~= nil then
          WAR.ShowHead = 0
          War_MovePerson(x, y)
        	break;
        end
      end
    end
    end
end
--合并矩形
function MergeRect(r1, r2)
    local res = {}
    res.x1 = math.min(r1.x1, r2.x1)
    res.y1 = math.min(r1.y1, r2.y1)
    res.x2 = math.max(r1.x2, r2.x2)
    res.y2 = math.max(r1.y2, r2.y2)
    return res
end
--计算200个D中有效的D
function Cal_D_Valid()
    if JY.D_Valid ~= nil then
       return 
    end
    local sceneid = JY.SubScene
    JY.D_Valid = {}
    JY.D_Valid_Num = 0
    for i = 0, CC.DNum - 1 do
    local x = GetD(sceneid, i, 9)
    local y = GetD(sceneid, i, 10)
    local v = GetS(sceneid, x, y, 3)
    if v >= 0 then
      JY.D_Valid[JY.D_Valid_Num] = i
      JY.D_Valid_Num = JY.D_Valid_Num + 1
    end
    end
end--计算贴图改变形成的Clip裁剪
    --(dx1,dy1) 新贴图和绘图中心点的坐标偏移。在场景中，视角不同而主角动时用到
    --pic1 旧的贴图编号
    --id1 贴图文件加载编号
    --(dx2,dy2) 新贴图和绘图中心点的偏移
    --pic2 旧的贴图编号
    --id2 贴图文件加载编号
    --返回，裁剪矩形 {x1,y1,x2,y2}
function Cal_PicClip(dx1, dy1, pic1, id1, dx2, dy2, pic2, id2)
    local w1, h1, x1_off, y1_off = lib.PicGetXY(id1, pic1 * 2)
    local old_r = {}
    old_r.x1 = CC.XScale * (dx1 - dy1) + CC.ScreenW / 2 - x1_off
    old_r.y1 = CC.YScale * (dx1 + dy1) + CC.ScreenH / 2 - y1_off
    old_r.x2 = old_r.x1 + w1
    old_r.y2 = old_r.y1 + h1
    local w2, h2, x2_off, y2_off = lib.PicGetXY(id2, pic2 * 2)
    local new_r = {}
    new_r.x1 = CC.XScale * (dx2 - dy2) + CC.ScreenW / 2 - x2_off
    new_r.y1 = CC.YScale * (dx2 + dy2) + CC.ScreenH / 2 - y2_off
    new_r.x2 = new_r.x1 + w2
    new_r.y2 = new_r.y1 + h2
    return MergeRect(old_r, new_r)
end
 --计算哪些坐标可以进入场景
--苍炎已不再使用
function Cal_EnterSceneXY()  
    JY.EnterSceneXY={};
    for id = 0,JY.SceneNum-1 do
		local scene=JY.Scene[id];
        if scene["外景入口X1"]>0 and scene["外景入口Y1"] then
            JY.EnterSceneXY[scene["外景入口Y1"]*CC.MWidth+scene["外景入口X1"]]=id;
		end
        if scene["外景入口X2"]>0 and scene["外景入口Y2"] then
            JY.EnterSceneXY[scene["外景入口Y2"]*CC.MWidth+scene["外景入口X2"]]=id;
		end
    end
end
    --场景是否可进
    --id 场景代号
    --x,y 当前主地图坐标
    --返回：场景id，-1表示没有场景可进
function CanEnterScene(x,y)         --场景是否可进
    if JY.EnterSceneXY==nil then    --如果为空，则重新产生数据。
	    Cal_EnterSceneXY();
	end

    local id=JY.EnterSceneXY[y*CC.MWidth+x];
    if id~=nil then
        local e=JY.Scene[id]["进入条件"];
		if e==0 then        --可进
			return id;
		elseif e==1 then    --不可进
			return -1
		elseif e==2 then    --有轻功高者进
			for i=1,CC.TeamNum do
				local pid=JY.Base["队伍" .. i];
				if pid>=0 then
					if JY.Person[pid]["轻功"]>=70 then
						return id;
					end
				end
			end
		end
	end
    return -1;
end
    --自定义的进入子场景的函数
    --需要进入的子场景编号
    --x进入子场景后人物的X坐标，传入-1则默认为入口X
    --y进入子场景后人物的Y坐标，传入-1则默认为入口Y
    --direct人物面对的方向
function My_Enter_SubScene(sceneid,x,y,direct)
	if JY.Status == GAME_SMAP then
	  JY.Base["无用"] = JY.SubScene
	else
	  JY.Base["无用"] = -1
	end
	SBLDATAS(11)
	
	JY.SubScene = sceneid;
	local flag = 1;   --是否自定义的xy坐标, 0是，1否
	if x == -1 and y == -1 then
		JY.Base["人X1"]=JY.Scene[sceneid]["入口X"];
  	JY.Base["人Y1"]=JY.Scene[sceneid]["入口Y"];
    else
  	JY.Base["人X1"] = x;
  	JY.Base["人Y1"] = y;
  	flag = 0;
	end
	
	if direct > -1 then
		JY.Base["人方向"] = direct;
	end
 			
	
	if JY.Status == GAME_MMAP then
		CleanMemory();
		lib.PicInit()--
		lib.UnloadMMap();
	end
    lib.PicInit();
    lib.ShowSlow(20,1)

	JY.Status = GAME_SMAP;  --改变状态
    JY.MmapMusic=-1;

	JY.Base["乘船"]=0;
    JY.MyPic=GetMyPic(); 
  
    --外景入口是个难点，有些子场景是通过跳转的方式进入的，需要判断
    --由于目前最多只能有一个子场景跳转，所以不需要进行循环判断
    local sid = JY.Scene[sceneid]["跳转场景"];
  
    if sid < 0 or (JY.Scene[sid]["外景入口X1"] <= 0 and JY.Scene[sid]["外景入口Y1"] <= 0) then
  	    JY.Base["人X"] = JY.Scene[sceneid]["外景入口X1"];  --改变出子场景后的XY坐标
		JY.Base["人Y"] = JY.Scene[sceneid]["外景入口Y1"];
	else
		JY.Base["人X"] = JY.Scene[sid]["外景入口X1"];  --改变出子场景后的XY坐标
		JY.Base["人Y"] = JY.Scene[sid]["外景入口Y1"];
	end

    Init_SMap(flag);  --重新初始化地图
  
    if flag == 0 then    --如果是自定义位置，先传送到那个位置，再显示场景名称
  	  DrawStrBox(-1,10,JY.Scene[JY.SubScene]["名称"],C_WHITE,CC.DefaultFont);
		ShowScreen();
		WaitKey();
    end
  
    Cls();
	
end

--改变大地图坐标
function ChangeMMap(x, y, direct)
    JY.Base["人X"] = x
    JY.Base["人Y"] = y
    JY.Base["人方向"] = direct
end--改变子场景时，人的坐标和方向
function ChangeSMap(sceneid, x, y, direct)
    JY.SubScene = sceneid
    JY.Base["人X1"] = x
    JY.Base["人Y1"] = y
    JY.Base["人方向"] = direct
end--清除内存
function CleanMemory()
    if CONFIG.CleanMemory == 1 then
       collectgarbage("collect")
    end
end----对矩形进行屏幕剪裁
--返回剪裁后的矩形，如果超出屏幕，返回空
function ClipRect(r)
    if CC.ScreenW <= r.x1 or r.x2 <= 0 or CC.ScreenH <= r.y1 or r.y2 <= 0 then
       return nil
    else
    local res = {}
    res.x1 = limitX(r.x1, 0, CC.ScreenW)
    res.x2 = limitX(r.x2, 0, CC.ScreenW)
    res.y1 = limitX(r.y1, 0, CC.ScreenH)
    res.y2 = limitX(r.y2, 0, CC.ScreenH)
    return res
    end
end
--快捷键定义
function FKJGN(k)

    if k == 282 then --and JY.Status == GAME_MMAP
       Menu_MCCS()
    elseif k == 283 then
    if JY.XZSPD == 1 then
      JY.XZSPD = 20
      QZXS(CC.s66)
    else
      JY.XZSPD = 1
      QZXS(CC.s65)
    end
    elseif k == 284 then
      Menu_DDTH()
    elseif k == 285 then
      Menu_WPZL()
    elseif k == 286 then
      --dofile(CONFIG.ScriptPath .. "DIY.lua")
	  Menu_MYDIY()
    elseif k == 287 then
      --Menu_SetMusic()
	  Menu_HYZB()
    elseif k == 288 then
	  Menu_FullScreen()
    elseif k == 113 or k == 290 then
      if DrawStrBoxYesNo(-1, -1, CC.s74, C_WHITE, 30) == true then
         JY.Status = x
      end
    elseif k == 105 or k == 101 then
    Cls()
    Menu_Thing()
    elseif k == 115 then
    Cls()
    local MS = JYMsgBox(CC.EVB111, CC.EVB112, KJDYSAVE, 4, 280)
    if MS < 4 then
      if JY.Status == GAME_SMAP then
        JY.Base["无用"] = JY.SubScene
      else
        JY.Base["无用"] = -1
      end
      SBLDATAS(MS)
      DrawStrBoxWaitKey(CC.EVB113, C_WHITE, 30)
    end
    elseif k == 108 then
    Cls()
    local MS = JYMsgBox(CC.EVB114, CC.EVB115, KJDYLOAD, 4, 280)
    if MS < 4 then
      SBLDATAL(MS)
      if YC_Status() == 0 then
		YC_Exit()
    elseif JY.Base["无用"] ~= -1 then
        if JY.SubScene < 0 then
          CleanMemory()
		  lib.PicInit()--
          lib.UnloadMMap()
        end
        lib.PicInit()
        lib.ShowSlow(50, 1)
        JY.Status = GAME_SMAP
        JY.SubScene = JY.Base["无用"]
        JY.MmapMusic = -1
        JY.MyPic = GetMyPic()
        Init_SMap(1)
      else
        JY.SubScene = -1
        JY.Status = GAME_FIRSTMMAP
      end
      DrawStrBoxWaitKey(CC.EVB116, C_WHITE, 30)
    end
    elseif k == 122 then
    Cls()
    Menu_Status()
    elseif k == 104  then		--按h直接回家 and JY.Status == GAME_MMAP
  	--My_Enter_SubScene(70, 27, 30, 2);
	Menu_HYZB()
    end
end
--学会六如时的动画
function CLJDH()
    lib.FillColor(0, 0, CC.ScreenW, CC.ScreenH, C_GOLD)
    ShowScreen()
    lib.Delay(100)
    lib.PicLoadFile(CC.EffectFile[1], CC.EffectFile[2], 10)
    lib.FillColor(0, 0, CC.ScreenW, CC.ScreenH, C_BLACK)
    local ssid = lib.SaveSur(CC.ScreenW / 2 - 100, 0, CC.ScreenW / 2 + 100, CC.ScreenH)
    for i = 1, 15 do
    NewDrawString(400, 250, FLHSYL[1], C_ORANGE, 30 + i)
    lib.PicLoadCache(10, (i + 1540) * 2, CC.ScreenW / 2, CC.ScreenH / 2, 2, 192)
    ShowScreen()
    if i == 15 then
      lib.Delay(10)
    else
      lib.Delay(1)
    end
    lib.LoadSur(ssid, CC.ScreenW / 2 - 100, 0)
    end
    for i = 1, 15 do
    lib.PicLoadCache(10, (i + 1540) * 2, CC.ScreenW / 2, CC.ScreenH / 2, 2, 192)
    NewDrawString(1200, 250, FLHSYL[2], C_ORANGE, 30 + i)
    ShowScreen()
    if i == 15 then
      lib.Delay(10)
    else
      lib.Delay(1)
    end
    lib.LoadSur(ssid, CC.ScreenW / 2 - 100, 0)
    end
    for i = 1, 15 do
    NewDrawString(200, 600, FLHSYL[3], C_ORANGE, 30 + i)
    lib.PicLoadCache(10, (i + 1540) * 2, CC.ScreenW / 2, CC.ScreenH / 2, 2, 192)
    ShowScreen()
    if i == 15 then
      lib.Delay(10)
    else
      lib.Delay(1)
    end
    lib.LoadSur(ssid, CC.ScreenW / 2 - 100, 0)
    end
    for i = 1, 15 do
    NewDrawString(1400, 600, FLHSYL[4], C_ORANGE, 30 + i)
    lib.PicLoadCache(10, (i + 1540) * 2, CC.ScreenW / 2, CC.ScreenH / 2, 2, 192)
    ShowScreen()
    if i == 15 then
      lib.Delay(10)
    else
      lib.Delay(1)
    end
    lib.LoadSur(ssid, CC.ScreenW / 2 - 100, 0)
    end
    for i = 1, 15 do
    NewDrawString(400, 950, FLHSYL[5], C_ORANGE, 30 + i)
    lib.PicLoadCache(10, (i + 1540) * 2, CC.ScreenW / 2, CC.ScreenH / 2, 2, 192)
    ShowScreen()
    if i == 15 then
      lib.Delay(10)
    else
      lib.Delay(1)
    end
    lib.LoadSur(ssid, CC.ScreenW / 2 - 100, 0)
    end
    for i = 1, 15 do
    NewDrawString(1200, 950, FLHSYL[6], C_ORANGE, 30 + i)
    lib.PicLoadCache(10, (i + 1540) * 2, CC.ScreenW / 2, CC.ScreenH / 2, 2, 192)
    ShowScreen()
    if i == 15 then
      lib.Delay(10)
    else
      lib.Delay(1)
    end
    lib.LoadSur(ssid, CC.ScreenW / 2 - 100, 0)
    end
    for i = 1610, 1618 do
    lib.PicLoadCache(10, i * 2, CC.ScreenW / 2, CC.ScreenH / 2, 2, 192)
    ShowScreen()
    if i == 1618 then
      lib.Delay(500)
    else
      lib.Delay(1)
    end
    lib.LoadSur(ssid, CC.ScreenW / 2 - 100, 0)
    end
    lib.LoadSur(ssid, CC.ScreenW / 2 - 100, 0)
    lib.FreeSur(ssid)
    for i = 1, 40 do
    NewDrawString(-1, -1, FLHSYL[7], C_RED, 25 + i)
    ShowScreen()
    if i == 40 then
      lib.Delay(1000)
    else
      lib.Delay(1)
    end
    end
    lib.FillColor(0, 0, CC.ScreenW, CC.ScreenH, C_RED)
    ShowScreen()
    lib.Delay(100)
end--清除(x1,y1)-(x2,y2)矩形内的文字等
--如果没有参数，则清除整个屏幕表面
--注意该函数并不直接刷新显示屏幕
function Cls(x1, y1, x2, y2)
    if x1 == nil then
       x1 = 0
       y1 = 0
       x2 = 0
       y2 = 0
    end
       lib.SetClip(x1, y1, x2, y2)
    if JY.Status == GAME_START then
       lib.FillColor(0, 0, 0, 0, 0)
       lib.LoadPicture(CC.FirstFile, -1, -1)
    elseif JY.Status == GAME_START2 then
       lib.FillColor(0, 0, 0, 0, 0)
    elseif JY.Status == GAME_MMAP then
       lib.DrawMMap(JY.Base["人X"], JY.Base["人Y"], GetMyPic())
    elseif JY.Status == GAME_SMAP then
       DrawSMap()
    elseif JY.Status == GAME_WMAP then
       WarDrawMap(0)
    elseif JY.Status == GAME_DEAD then
      lib.FillColor(0, 0, 0, 0, 0)
      lib.LoadPicture(CC.DeadFile, -1, -1)
    elseif JY.Status == GAME_YC then
      lib.FillColor(0, 0, 0, 0, 0)
      lib.LoadPicture(CONFIG.PicturePath .. YC.BG ..".png", -1, -1)
    elseif JY.Status == GAME_PET then
      lib.FillColor(0, 0, 0, 0, 0)
      lib.LoadPicture(CONFIG.PicturePath.."p"..JY.Base["宠物"]..".png", -1, -1)  
    elseif JY.Status == GAME_MATCH then
      lib.FillColor(0, 0, 0, 0, 0)
      lib.LoadPicture(CONFIG.PicturePath.."scroll.png", -1, -1)  
	  drawmatch(CC.Match)
    end
    lib.SetClip(0, 0, 0, 0)
end--清除贴图文字
function ClsN(x1, y1, x2, y2)
    if x1 == nil then
       x1 = 0
       y1 = 0
       x2 = 0
       y2 = 0
    end
    lib.SetClip(x1, y1, x2, y2)
    lib.FillColor(0, 0, 0, 0, 0)
    lib.SetClip(0, 0, 0, 0)
end

CSPSX = {
{33, 33, 39, 33, 34, 33, 80, 80, 33, 33, 133, 33, 32, 32, 43, 45, 44, 44, 48, 40, 43, 42, 42, 43, 33, 41, 38, 40, 33, 33, 54, 54, 56, 56, 60, 55, 58, 56, 57, 55, 63, 60, 58, 59, 33, 83, 33, 33, 33, 107, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 36, 36, 36, 36, 0}, 
{34, 34, 37, 33, 53, 16783, 283, 283, 33, 33, 129, 33, 32, 32, 33, 44, 33, 44, 33, 33, 42, 33, 42, 33, 33, 37, 33, 37, 33, 34, 175, 175, 79, 106, 86, 33, 33, 33, 33, 49, 47, 74, 38, 102, 38, 93, 33, 33, 33, 108, 32, 33, 100, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 235, 32, 32, 32, 34, 33, 33, 33, 1}, 
{35, 35, 34, 34, 35, 83, 59, 59, 33, 33, 125, 33, 32, 32, 41, 43, 33, 33, 33, 39, 40, 33, 33, 33, 33, 36, 33, 33, 33, 33, 49, 49, 55, 64, 53, 87, 119, 117, 109, 54, 33, 33, 33, 38, 33, 73, 63, 33, 33, 93, 32, 33, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 226, 34, 37, 43, 34, 38, 38, 38, 2}, 
{36, 36, 38, 33, 57, 28183, 733, 733, 33, 33, 133, 33, 32, 32, 33, 33, 46, 33, 33, 33, 33, 44, 33, 33, 33, 33, 40, 33, 33, 34, 3033, 3033, 163, 33, 133, 38, 38, 38, 38, 88, 118, 88, 38, 73, 38, 123, 33, 33, 33, 83, 32, 33, 77, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 37, 45, 32, 35, 43, 43, 33, 3}, 
{37, 37, 41, 33, 34, 33, 83, 83, 33, 33, 133, 33, 32, 32, 33, 41, 33, 41, 33, 33, 40, 33, 40, 33, 33, 38, 33, 38, 33, 34, 133, 133, 68, 53, 68, 74, 78, 63, 38, 38, 38, 73, 38, 43, 33, 53, 33, 33, 33, 87, 32, 33, 100, 33, 33, 33, 33, 33, 33, 33, 33, 33, 83, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 36, 42, 223, 35, 35, 43, 34, 4}, 
{38, 38, 38, 33, 64, 56533, 1032, 1032, 33, 33, 133, 33, 32, 32, 33, 48, 42, 33, 33, 33, 46, 40, 33, 33, 33, 44, 37, 33, 33, 34, 5033, 5033, 333, 153, 333, 43, 43, 48, 33, 131, 122, 83, 33, 53, 33, 128, 33, 33, 33, 93, 32, 33, 79, 49, 132, 33, 33, 33, 33, 33, 33, 33, 933, 933, 1032, 33, 33, 33, 33, 33, 33, 33, 39, 34, 45, 43, 35, 35, 38, 35, 5}, 
{39, 39, 37, 34, 53, 16783, 833, 833, 33, 33, 133, 33, 32, 32, 33, 33, 46, 33, 33, 33, 33, 44, 33, 33, 33, 33, 42, 33, 33, 33, 4033, 4033, 183, 123, 163, 43, 33, 33, 33, 33, 103, 33, 33, 73, 33, 93, 33, 33, 33, 83, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 41, 34, 36, 32, 34, 36, 36, 33, 6}, 
{40, 40, 40, 33, 49, 9283, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 45, 33, 33, 33, 33, 43, 33, 33, 33, 33, 41, 33, 33, 33, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 70, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 36, 33, 45, 42, 38, 38, 43, 35, 7}, 
{41, 41, 39, 33, 48, 7783, 533, 533, 33, 33, 123, 33, 32, 32, 33, 42, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 1533, 1533, 133, 108, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 56, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 36, 33, 45, 42, 34, 35, 43, 35, 8}, 
{42, 42, 37, 33, 58, 20033, 833, 833, 33, 33, 124, 33, 32, 32, 47, 43, 33, 33, 33, 44, 41, 33, 33, 33, 33, 39, 33, 33, 33, 34, 3033, 3033, 83, 103, 163, 93, 45, 93, 33, 103, 33, 33, 33, 73, 33, 93, 33, 33, 33, 103, 32, 33, 139, 40, 130, 33, 33, 33, 33, 33, 33, 33, 533, 933, 533, 33, 33, 33, 33, 33, 33, 33, 116, 32, 32, 32, 34, 33, 33, 33, 9}, 
{43, 43, 40, 33, 52, 14383, 633, 633, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 2033, 2033, 153, 113, 133, 33, 33, 33, 33, 108, 33, 33, 33, 63, 33, 83, 33, 33, 33, 83, 32, 33, 46, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 36, 33, 42, 32, 39, 39, 43, 33, 10}, 
{44, 44, 39, 33, 49, 9283, 341, 341, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 41, 33, 33, 33, 33, 39, 33, 33, 33, 383, 383, 108, 99, 108, 33, 33, 33, 33, 33, 108, 33, 33, 63, 33, 83, 33, 33, 33, 93, 32, 33, 71, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 40, 55, 48, 32, 39, 39, 43, 33, 11}, 
{45, 45, 38, 33, 50, 10883, 308, 308, 33, 33, 123, 33, 32, 32, 33, 42, 33, 33, 33, 33, 42, 33, 33, 33, 33, 39, 33, 33, 33, 34, 433, 433, 113, 93, 113, 33, 33, 33, 33, 93, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 37, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 39, 55, 47, 32, 39, 39, 43, 33, 12}, 
{46, 46, 38, 33, 56, 24733, 633, 633, 33, 33, 123, 33, 32, 32, 33, 42, 33, 33, 42, 33, 41, 33, 33, 40, 33, 37, 33, 33, 38, 34, 2033, 2033, 153, 113, 133, 33, 33, 33, 33, 93, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 125, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 38, 32, 32, 39, 39, 39, 43, 13}, 
{47, 47, 37, 33, 48, 7783, 233, 233, 33, 33, 123, 33, 32, 32, 33, 45, 33, 33, 33, 33, 43, 33, 33, 33, 33, 41, 33, 33, 33, 33, 363, 363, 110, 123, 103, 33, 33, 33, 33, 83, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 37, 55, 45, 32, 39, 39, 43, 33, 14}, 
{48, 48, 38, 33, 47, 6383, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 47, 33, 33, 33, 33, 45, 33, 33, 33, 33, 43, 33, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 103, 43, 83, 33, 33, 33, 93, 32, 33, 108, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 42, 37, 45, 38, 39, 39, 38, 15}, 
{49, 49, 37, 33, 38, 533, 113, 113, 33, 33, 125, 33, 32, 32, 46, 40, 33, 33, 33, 43, 37, 33, 33, 33, 33, 35, 33, 33, 33, 34, 60, 60, 61, 70, 54, 114, 33, 95, 67, 54, 33, 33, 33, 38, 43, 73, 33, 33, 33, 71, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 222, 32, 32, 32, 34, 33, 33, 33, 16}, 
{50, 50, 37, 34, 37, 333, 101, 101, 33, 33, 125, 33, 32, 32, 43, 40, 33, 33, 33, 40, 40, 33, 33, 33, 33, 35, 33, 33, 33, 33, 51, 51, 52, 66, 59, 55, 115, 110, 116, 54, 33, 33, 33, 33, 43, 58, 33, 33, 33, 64, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 225, 32, 32, 32, 34, 33, 33, 33, 17}, 
{51, 51, 42, 33, 56, 24733, 833, 833, 33, 33, 123, 33, 32, 32, 33, 45, 33, 33, 33, 33, 43, 33, 33, 33, 33, 41, 33, 33, 33, 33, 4033, 4033, 233, 153, 233, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 52, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 42, 35, 39, 46, 38, 38, 38, 38, 18}, 
{52, 52, 42, 33, 49, 9283, 633, 633, 33, 33, 123, 33, 32, 32, 33, 33, 47, 33, 33, 33, 33, 44, 33, 33, 33, 33, 36, 33, 33, 34, 2033, 2033, 153, 113, 133, 33, 33, 33, 33, 43, 103, 43, 43, 83, 43, 43, 33, 33, 33, 103, 32, 33, 67, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 38, 34, 45, 32, 43, 38, 38, 38, 19}, 
{53, 53, 40, 33, 47, 6383, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 63, 43, 99, 43, 43, 101, 43, 73, 33, 33, 33, 78, 32, 33, 65, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 37, 45, 44, 37, 40, 43, 43, 20}, 
{54, 54, 37, 34, 46, 5083, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 47, 33, 33, 33, 33, 43, 33, 33, 33, 33, 36, 33, 33, 33, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 94, 43, 43, 65, 43, 110, 33, 33, 33, 76, 32, 33, 63, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 41, 45, 43, 40, 35, 44, 43, 36, 21}, 
{55, 55, 41, 33, 55, 21433, 633, 633, 33, 33, 123, 33, 32, 32, 33, 33, 49, 33, 33, 33, 33, 43, 33, 33, 33, 33, 40, 33, 33, 33, 2033, 2033, 153, 113, 133, 33, 33, 33, 33, 107, 101, 43, 43, 87, 43, 48, 33, 33, 33, 113, 32, 33, 66, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 41, 34, 37, 46, 35, 36, 36, 43, 22}, 
{56, 56, 39, 33, 47, 6383, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 45, 33, 33, 33, 33, 42, 33, 33, 33, 33, 34, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 97, 43, 43, 76, 43, 106, 33, 33, 33, 93, 32, 33, 64, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 36, 33, 45, 42, 38, 38, 43, 43, 23}, 
{57, 57, 40, 33, 43, 2283, 433, 433, 33, 33, 123, 33, 32, 32, 33, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 33, 1033, 1033, 113, 101, 113, 33, 33, 33, 33, 43, 91, 43, 43, 63, 43, 53, 33, 33, 33, 93, 32, 33, 60, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 44, 36, 34, 65, 37, 37, 34, 43, 24}, 
{58, 58, 40, 34, 41, 1433, 233, 233, 33, 33, 124, 33, 32, 32, 44, 44, 33, 33, 41, 40, 40, 33, 33, 39, 33, 35, 33, 33, 35, 33, 533, 533, 103, 93, 98, 33, 108, 95, 116, 50, 41, 36, 111, 86, 43, 73, 113, 33, 33, 105, 32, 33, 102, 111, 33, 33, 33, 33, 33, 33, 33, 33, 1032, 633, 33, 33, 33, 33, 33, 33, 33, 33, 206, 58, 42, 68, 34, 34, 38, 38, 25}, 
{59, 59, 42, 33, 59, 35533, 933, 933, 33, 33, 123, 33, 32, 32, 33, 42, 33, 33, 41, 33, 37, 33, 33, 39, 33, 36, 33, 33, 33, 33, 4033, 4033, 233, 153, 233, 33, 33, 33, 83, 117, 43, 43, 43, 43, 43, 58, 33, 33, 33, 113, 32, 33, 54, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 35, 39, 40, 44, 35, 35, 36, 38, 26}, 
{60, 60, 42, 34, 69, 56533, 1032, 1032, 33, 33, 123, 33, 32, 32, 33, 45, 33, 33, 33, 33, 41, 33, 33, 33, 33, 39, 33, 33, 33, 33, 5033, 5033, 233, 233, 283, 33, 33, 33, 33, 132, 43, 43, 43, 43, 43, 73, 33, 34, 33, 123, 32, 33, 138, 33, 33, 33, 33, 33, 33, 33, 33, 33, 1032, 33, 33, 33, 33, 33, 33, 33, 33, 33, 35, 39, 41, 44, 35, 36, 35, 38, 27}, 
{61, 61, 38, 33, 39, 783, 143, 143, 33, 33, 125, 33, 32, 32, 49, 46, 33, 33, 33, 45, 40, 33, 33, 33, 33, 38, 33, 33, 33, 34, 73, 73, 73, 73, 73, 105, 33, 87, 63, 58, 33, 33, 33, 33, 43, 67, 33, 33, 33, 63, 32, 33, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 220, 33, 36, 45, 34, 43, 43, 43, 28}, 
{62, 62, 38, 33, 46, 5083, 365, 365, 33, 33, 124, 33, 32, 32, 33, 47, 33, 47, 33, 33, 41, 33, 41, 33, 33, 36, 33, 36, 33, 33, 733, 733, 99, 111, 98, 33, 33, 33, 33, 45, 49, 90, 41, 94, 43, 46, 33, 33, 33, 101, 32, 33, 88, 33, 33, 33, 33, 33, 33, 33, 33, 33, 233, 33, 33, 33, 33, 33, 33, 33, 33, 33, 194, 32, 32, 32, 34, 33, 33, 33, 29}, 
{63, 88, 42, 33, 34, 33, 83, 83, 33, 33, 125, 33, 32, 32, 33, 47, 33, 47, 33, 33, 44, 33, 44, 33, 33, 42, 33, 42, 33, 34, 63, 63, 63, 53, 53, 33, 33, 33, 33, 53, 53, 53, 53, 43, 43, 83, 33, 33, 33, 63, 32, 33, 86, 33, 33, 33, 33, 33, 33, 33, 33, 33, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 30}, 
{64, 64, 40, 33, 45, 3883, 433, 433, 33, 33, 123, 33, 32, 32, 33, 33, 44, 33, 33, 33, 33, 40, 33, 33, 33, 33, 36, 33, 33, 34, 1033, 1033, 113, 95, 113, 33, 33, 33, 33, 43, 89, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 71, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 36, 46, 33, 32, 38, 43, 38, 33, 31}, 
{65, 65, 39, 33, 52, 14383, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 44, 33, 33, 33, 33, 40, 33, 33, 33, 33, 38, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 100, 43, 43, 83, 33, 33, 33, 93, 32, 33, 104, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 36, 33, 42, 32, 38, 38, 43, 33, 32}, 
{66, 66, 41, 33, 53, 16283, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 48, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 34, 1533, 1533, 143, 100, 133, 33, 33, 33, 33, 43, 43, 43, 106, 43, 43, 83, 33, 33, 33, 93, 32, 33, 105, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 36, 34, 36, 32, 37, 36, 43, 33, 33}, 
{67, 67, 39, 33, 56, 24733, 633, 633, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 46, 33, 33, 33, 33, 41, 33, 33, 33, 33, 39, 34, 2033, 2033, 153, 103, 133, 33, 33, 33, 33, 43, 43, 43, 114, 43, 43, 83, 33, 33, 33, 93, 32, 33, 106, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 36, 33, 42, 32, 36, 36, 43, 33, 34}, 
{68, 68, 37, 33, 40, 1083, 237, 237, 33, 33, 126, 33, 32, 32, 33, 49, 49, 33, 33, 33, 44, 44, 33, 33, 33, 41, 41, 33, 33, 34, 233, 233, 86, 83, 93, 33, 33, 33, 33, 51, 86, 40, 35, 56, 43, 99, 33, 33, 33, 113, 32, 33, 67, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 35}, 
{69, 69, 41, 35, 53, 16783, 83, 83, 33, 33, 124, 33, 32, 32, 33, 46, 46, 33, 33, 33, 40, 40, 33, 33, 33, 37, 37, 33, 33, 33, 58, 58, 54, 76, 93, 33, 33, 33, 33, 45, 69, 39, 36, 54, 43, 54, 33, 33, 33, 97, 32, 33, 60, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 36}, 
{70, 70, 36, 33, 43, 2283, 533, 533, 33, 33, 127, 33, 32, 32, 33, 43, 33, 43, 33, 33, 37, 33, 37, 33, 33, 34, 33, 34, 33, 33, 933, 933, 83, 83, 133, 33, 33, 33, 33, 43, 52, 77, 33, 47, 43, 83, 33, 33, 33, 56, 32, 33, 127, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 92, 32, 32, 32, 34, 33, 33, 33, 37}, 
{71, 71, 37, 33, 58, 32033, 833, 833, 33, 33, 127, 33, 32, 32, 33, 53, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 35, 3033, 3033, 83, 76, 133, 33, 33, 33, 33, 67, 33, 33, 33, 38, 43, 83, 33, 33, 33, 55, 32, 33, 129, 33, 33, 33, 33, 33, 33, 33, 33, 33, 733, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 38}, 
{72, 72, 42, 33, 52, 14383, 933, 933, 33, 33, 123, 33, 32, 32, 33, 42, 33, 33, 33, 33, 37, 33, 33, 33, 33, 36, 33, 33, 33, 34, 4033, 4033, 193, 123, 183, 33, 33, 33, 93, 123, 123, 123, 123, 123, 43, 83, 33, 33, 33, 93, 32, 33, 136, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 35, 38, 41, 44, 35, 35, 35, 35, 39}, 
{73, 73, 42, 33, 52, 14383, 933, 933, 33, 33, 123, 33, 32, 32, 33, 42, 33, 33, 33, 33, 42, 33, 33, 33, 33, 36, 33, 33, 33, 34, 4033, 4033, 193, 123, 173, 33, 33, 33, 93, 123, 123, 123, 123, 123, 43, 83, 33, 33, 33, 93, 32, 33, 136, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 35, 39, 44, 41, 35, 35, 35, 35, 40}, 
{74, 74, 40, 33, 48, 7783, 533, 533, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 37, 33, 33, 33, 33, 36, 33, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 103, 103, 103, 103, 103, 43, 83, 33, 33, 33, 93, 32, 33, 136, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 37, 40, 43, 35, 35, 35, 35, 41}, 
{75, 75, 40, 33, 48, 7783, 533, 533, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 37, 33, 33, 33, 33, 36, 33, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 103, 103, 103, 103, 103, 43, 83, 33, 33, 33, 93, 32, 33, 136, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 38, 43, 45, 36, 35, 38, 38, 42}, 
{76, 76, 39, 33, 42, 1833, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 45, 33, 33, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 63, 51, 104, 43, 43, 67, 43, 83, 33, 33, 33, 93, 32, 33, 68, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 40, 37, 45, 42, 38, 37, 43, 35, 43}, 
{77, 77, 42, 33, 46, 5083, 533, 533, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 44, 33, 39, 33, 33, 39, 33, 37, 33, 33, 37, 34, 833, 833, 93, 81, 133, 33, 33, 33, 33, 48, 45, 44, 99, 43, 43, 78, 33, 33, 33, 62, 32, 33, 108, 33, 33, 33, 33, 33, 33, 33, 33, 32, 833, 33, 33, 33, 33, 33, 33, 33, 33, 33, 211, 85, 94, 35, 34, 34, 34, 35, 44}, 
{78, 78, 38, 33, 38, 533, 128, 128, 33, 33, 124, 33, 32, 32, 43, 43, 33, 33, 33, 42, 39, 33, 33, 33, 33, 37, 33, 33, 33, 34, 68, 68, 68, 68, 68, 109, 33, 89, 33, 64, 41, 39, 33, 45, 43, 83, 33, 33, 33, 93, 32, 33, 34, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 221, 35, 39, 41, 34, 35, 35, 35, 45}, 
{79, 79, 42, 33, 57, 28183, 701, 701, 33, 33, 123, 33, 32, 32, 33, 46, 33, 33, 42, 33, 41, 33, 33, 39, 33, 38, 33, 33, 33, 33, 3033, 3033, 163, 133, 133, 33, 33, 33, 133, 110, 47, 48, 52, 76, 43, 49, 133, 33, 33, 93, 32, 33, 54, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 37, 44, 40, 43, 43, 43, 36, 46}, 
{80, 80, 40, 34, 38, 533, 158, 158, 33, 33, 125, 33, 32, 32, 33, 44, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 33, 33, 33, 33, 333, 333, 75, 103, 67, 33, 88, 33, 83, 77, 33, 33, 33, 64, 43, 65, 126, 33, 33, 116, 32, 33, 38, 120, 33, 33, 33, 33, 33, 33, 33, 33, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 99, 32, 32, 32, 34, 33, 33, 33, 47}, 
{81, 81, 42, 33, 53, 16783, 633, 633, 33, 33, 125, 33, 32, 32, 33, 50, 33, 33, 33, 33, 44, 33, 33, 33, 33, 42, 33, 33, 33, 35, 2033, 2033, 133, 81, 110, 33, 33, 33, 103, 75, 44, 48, 39, 50, 43, 71, 127, 33, 33, 94, 32, 33, 54, 33, 33, 33, 33, 33, 33, 33, 33, 33, 833, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 48}, 
{82, 82, 36, 33, 35, 83, 71, 71, 33, 33, 124, 33, 32, 32, 33, 46, 33, 33, 33, 33, 40, 33, 33, 33, 33, 38, 33, 33, 33, 34, 54, 54, 47, 63, 83, 33, 33, 33, 33, 56, 41, 40, 36, 39, 43, 124, 33, 33, 33, 78, 32, 33, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 133, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 49}, 
{83, 83, 38, 33, 61, 43483, 933, 933, 33, 33, 123, 33, 32, 32, 33, 47, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 34, 4033, 4033, 233, 123, 183, 33, 33, 33, 113, 131, 106, 102, 68, 77, 43, 123, 33, 33, 33, 116, 32, 33, 59, 33, 33, 33, 33, 33, 33, 33, 33, 33, 1032, 33, 33, 33, 33, 33, 33, 33, 33, 33, 35, 39, 43, 46, 36, 36, 34, 43, 50}, 
{84, 84, 41, 33, 48, 7783, 413, 413, 33, 33, 125, 33, 32, 32, 33, 44, 44, 33, 33, 33, 39, 39, 33, 33, 33, 37, 37, 33, 33, 33, 933, 933, 110, 93, 124, 33, 33, 33, 33, 52, 124, 50, 47, 85, 43, 54, 33, 33, 33, 117, 32, 33, 76, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 151, 32, 32, 32, 34, 33, 33, 33, 51}, 
{85, 85, 39, 33, 49, 9283, 341, 341, 33, 33, 123, 33, 32, 32, 33, 43, 33, 33, 43, 33, 37, 33, 33, 37, 33, 33, 33, 33, 33, 34, 933, 933, 108, 93, 105, 33, 33, 33, 33, 43, 43, 43, 87, 87, 43, 43, 33, 33, 33, 103, 32, 33, 103, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 217, 32, 32, 32, 34, 33, 33, 33, 52}, 
{86, 86, 39, 33, 53, 16783, 433, 433, 33, 33, 123, 33, 32, 32, 33, 47, 47, 33, 33, 33, 41, 45, 33, 33, 33, 39, 39, 33, 33, 33, 4033, 4033, 183, 183, 73, 33, 33, 33, 133, 56, 42, 42, 40, 37, 43, 83, 33, 33, 33, 85, 32, 33, 82, 118, 33, 33, 33, 33, 33, 33, 33, 33, 733, 633, 33, 33, 33, 33, 33, 33, 33, 33, 146, 97, 32, 32, 34, 34, 33, 33, 53}, 
{87, 87, 36, 33, 53, 16783, 533, 533, 33, 33, 124, 33, 32, 32, 33, 42, 44, 33, 33, 33, 37, 40, 33, 33, 33, 35, 37, 33, 33, 33, 1533, 1533, 106, 133, 107, 33, 33, 33, 33, 105, 114, 48, 45, 110, 43, 119, 33, 33, 33, 111, 32, 33, 123, 73, 33, 33, 33, 33, 33, 33, 33, 33, 933, 933, 33, 33, 33, 33, 33, 33, 33, 33, 154, 63, 73, 32, 34, 43, 34, 33, 54}, 
{88, 88, 39, 33, 53, 16783, 575, 575, 33, 33, 124, 33, 32, 32, 33, 47, 33, 47, 33, 33, 44, 33, 44, 33, 33, 42, 33, 42, 33, 34, 4033, 4033, 153, 73, 73, 33, 33, 33, 33, 133, 43, 58, 45, 64, 43, 132, 33, 34, 33, 68, 32, 33, 59, 48, 33, 33, 33, 33, 33, 33, 33, 33, 733, 733, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 55}, 
{89, 89, 40, 34, 53, 16783, 536, 536, 33, 33, 124, 33, 32, 32, 33, 42, 42, 42, 42, 33, 41, 41, 41, 41, 33, 39, 39, 39, 39, 33, 1533, 1533, 115, 118, 103, 33, 33, 33, 33, 100, 73, 68, 133, 116, 43, 83, 33, 33, 33, 123, 32, 33, 113, 45, 33, 33, 33, 33, 33, 33, 33, 33, 733, 433, 33, 33, 33, 33, 33, 33, 33, 33, 53, 52, 91, 32, 35, 35, 34, 33, 56}, 
{90, 90, 41, 33, 58, 31783, 933, 933, 33, 33, 123, 33, 32, 32, 33, 46, 33, 33, 33, 33, 40, 33, 33, 33, 33, 38, 33, 33, 33, 33, 4033, 4033, 233, 163, 233, 33, 33, 33, 93, 126, 131, 115, 110, 127, 43, 68, 33, 33, 33, 120, 32, 33, 51, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 43, 38, 40, 46, 43, 43, 43, 43, 57}, 
{91, 91, 38, 33, 53, 16783, 533, 533, 33, 33, 124, 33, 32, 32, 33, 46, 45, 33, 33, 33, 39, 38, 33, 33, 33, 37, 36, 33, 33, 33, 3033, 3033, 153, 100, 93, 33, 33, 33, 33, 133, 133, 45, 41, 79, 43, 83, 33, 33, 33, 117, 32, 33, 78, 58, 128, 33, 33, 33, 33, 33, 33, 33, 733, 633, 35, 33, 33, 33, 33, 33, 33, 33, 120, 32, 32, 32, 34, 33, 33, 33, 58}, 
{92, 92, 39, 34, 53, 16783, 533, 533, 33, 33, 124, 33, 32, 32, 33, 42, 42, 33, 33, 33, 37, 37, 33, 33, 33, 34, 34, 33, 33, 33, 1533, 1533, 108, 153, 98, 33, 33, 33, 63, 49, 123, 46, 45, 99, 43, 83, 33, 34, 33, 83, 32, 33, 75, 33, 33, 33, 33, 33, 33, 33, 33, 33, 733, 33, 33, 33, 33, 33, 33, 33, 33, 33, 152, 66, 40, 32, 34, 43, 38, 33, 59}, 
{93, 93, 41, 33, 62, 47683, 933, 933, 33, 33, 123, 33, 32, 32, 33, 51, 33, 33, 33, 33, 45, 33, 33, 33, 33, 43, 33, 33, 33, 33, 4033, 4033, 253, 193, 213, 33, 52, 33, 122, 129, 125, 124, 131, 87, 43, 47, 113, 33, 33, 93, 32, 33, 128, 137, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 44, 37, 32, 38, 36, 53, 33, 60}, 
{94, 94, 41, 33, 45, 3883, 341, 341, 33, 33, 123, 33, 32, 32, 33, 45, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 33, 33, 33, 33, 733, 733, 97, 91, 85, 33, 45, 33, 93, 96, 48, 46, 45, 59, 43, 54, 33, 33, 33, 98, 32, 33, 42, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 37, 32, 32, 38, 35, 33, 33, 61}, 
{95, 95, 42, 33, 58, 31783, 933, 933, 33, 33, 123, 33, 32, 32, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 33, 33, 33, 34, 34, 4033, 4033, 233, 133, 233, 33, 33, 33, 93, 120, 111, 101, 130, 57, 43, 56, 33, 33, 33, 93, 32, 33, 136, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 42, 35, 37, 32, 38, 36, 36, 33, 62}, 
{96, 96, 39, 34, 39, 783, 133, 133, 33, 33, 124, 33, 32, 32, 33, 47, 47, 33, 33, 33, 37, 37, 33, 33, 33, 34, 34, 33, 33, 33, 433, 433, 93, 79, 93, 33, 33, 33, 33, 51, 85, 45, 44, 67, 43, 103, 33, 33, 33, 98, 32, 33, 71, 33, 33, 33, 33, 33, 33, 33, 33, 33, 133, 33, 33, 33, 33, 33, 33, 33, 33, 33, 156, 32, 32, 32, 34, 33, 33, 33, 63}, 
{97, 97, 42, 33, 61, 43483, 933, 933, 33, 33, 123, 33, 32, 32, 33, 45, 33, 33, 33, 33, 40, 33, 33, 33, 33, 36, 33, 33, 33, 34, 4033, 4033, 193, 133, 183, 33, 33, 33, 83, 126, 106, 81, 56, 75, 43, 83, 33, 34, 33, 67, 32, 33, 48, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 46, 33, 32, 32, 36, 33, 33, 33, 64}, 
{98, 98, 41, 33, 59, 35533, 933, 933, 33, 33, 123, 33, 32, 32, 33, 46, 33, 33, 33, 33, 41, 33, 33, 33, 33, 39, 33, 33, 33, 34, 4033, 4033, 183, 123, 233, 33, 33, 33, 93, 126, 108, 99, 89, 88, 43, 120, 33, 33, 33, 93, 32, 33, 50, 133, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 37, 46, 34, 32, 36, 53, 39, 33, 65}, 
{99, 99, 41, 34, 41, 1433, 245, 245, 33, 33, 124, 33, 32, 32, 33, 43, 33, 33, 33, 33, 43, 33, 33, 33, 33, 35, 33, 33, 33, 33, 783, 783, 79, 78, 87, 43, 43, 43, 43, 73, 44, 46, 33, 63, 43, 83, 33, 33, 33, 123, 32, 33, 130, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 66}, 
{100, 100, 41, 33, 58, 31783, 653, 653, 33, 33, 123, 33, 32, 32, 33, 48, 33, 33, 33, 33, 41, 33, 33, 33, 33, 39, 33, 33, 33, 34, 2033, 2033, 183, 153, 163, 33, 33, 33, 83, 117, 50, 45, 48, 67, 43, 59, 33, 33, 33, 93, 32, 33, 46, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 36, 37, 34, 45, 44, 39, 36, 43, 67}, 
{101, 101, 38, 33, 54, 18283, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 44, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 33, 33, 34, 1533, 1533, 153, 96, 133, 33, 33, 33, 63, 100, 111, 63, 73, 73, 43, 122, 33, 33, 33, 93, 32, 33, 72, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 36, 40, 32, 38, 38, 38, 33, 68}, 
{102, 102, 40, 33, 58, 31783, 933, 933, 33, 33, 123, 33, 32, 32, 33, 47, 33, 33, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 34, 4033, 4033, 193, 123, 233, 33, 33, 33, 93, 132, 111, 110, 120, 109, 43, 103, 33, 33, 33, 93, 32, 33, 59, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 36, 34, 53, 46, 38, 38, 35, 38, 69}, 
{103, 103, 41, 33, 54, 18283, 833, 833, 33, 33, 123, 33, 32, 32, 33, 47, 33, 33, 33, 33, 40, 33, 33, 33, 33, 39, 33, 33, 33, 34, 4033, 4033, 183, 123, 233, 33, 33, 33, 83, 107, 103, 103, 103, 83, 43, 83, 33, 33, 33, 93, 32, 33, 55, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 40, 37, 45, 37, 37, 37, 37, 70}, 
{104, 104, 42, 33, 58, 31783, 833, 833, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 46, 33, 33, 33, 33, 43, 33, 33, 33, 33, 41, 33, 4033, 4033, 163, 119, 163, 33, 33, 33, 93, 110, 110, 110, 110, 120, 43, 45, 33, 33, 33, 93, 32, 33, 119, 33, 33, 33, 33, 33, 33, 33, 33, 33, 733, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 42, 39, 68, 35, 35, 35, 35, 71}, 
{105, 105, 37, 33, 43, 2283, 233, 233, 33, 33, 124, 33, 32, 32, 33, 45, 45, 33, 33, 33, 43, 43, 33, 33, 33, 33, 33, 33, 33, 33, 633, 633, 93, 73, 83, 33, 33, 33, 33, 33, 73, 33, 33, 33, 33, 83, 33, 33, 33, 93, 32, 33, 61, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 72}, 
{106, 106, 40, 34, 48, 7783, 533, 533, 33, 33, 125, 33, 32, 32, 33, 46, 33, 33, 46, 33, 43, 33, 33, 43, 33, 36, 33, 33, 36, 33, 1533, 1533, 93, 103, 103, 33, 33, 33, 63, 33, 33, 33, 93, 83, 43, 83, 33, 33, 33, 111, 32, 33, 106, 121, 33, 33, 33, 33, 33, 33, 33, 33, 1032, 533, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 73}, 
{107, 107, 42, 34, 41, 1433, 203, 203, 33, 33, 124, 33, 32, 32, 33, 47, 47, 33, 33, 33, 43, 43, 33, 33, 33, 33, 33, 33, 33, 33, 533, 533, 83, 73, 83, 33, 33, 33, 33, 33, 73, 33, 33, 33, 43, 83, 33, 33, 33, 106, 32, 33, 62, 33, 33, 33, 33, 33, 33, 33, 33, 33, 733, 33, 33, 33, 33, 33, 33, 33, 33, 33, 165, 32, 32, 32, 34, 33, 33, 33, 74}, 
{108, 108, 39, 33, 51, 12583, 533, 533, 33, 33, 133, 33, 32, 32, 33, 44, 33, 33, 33, 33, 44, 33, 33, 33, 33, 33, 33, 33, 33, 34, 1033, 1033, 113, 93, 83, 33, 33, 33, 33, 93, 33, 33, 33, 33, 33, 83, 33, 33, 33, 109, 32, 33, 43, 33, 33, 33, 33, 33, 33, 33, 33, 33, 833, 33, 33, 33, 33, 33, 33, 33, 33, 33, 136, 32, 32, 32, 34, 33, 33, 33, 75}, 
{109, 109, 36, 34, 63, 65568, 43, 43, 33, 33, 125, 33, 32, 32, 33, 43, 33, 33, 33, 33, 40, 33, 33, 33, 33, 38, 33, 33, 33, 33, 34, 34, 34, 53, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 133, 93, 33, 33, 33, 123, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 76}, 
{110, 110, 39, 34, 43, 2283, 233, 233, 33, 33, 125, 33, 32, 32, 33, 42, 33, 42, 33, 33, 42, 33, 42, 33, 33, 37, 33, 37, 33, 33, 633, 633, 73, 63, 93, 33, 33, 33, 33, 33, 33, 73, 33, 33, 43, 83, 33, 33, 33, 100, 32, 33, 87, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 241, 32, 32, 32, 34, 33, 33, 33, 77}, 
{111, 111, 39, 34, 48, 7783, 333, 333, 33, 33, 123, 33, 32, 32, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 33, 1533, 1533, 123, 53, 73, 33, 33, 33, 83, 103, 33, 33, 33, 33, 33, 83, 73, 33, 33, 103, 32, 33, 44, 33, 33, 33, 33, 33, 33, 33, 33, 33, 733, 33, 33, 33, 33, 33, 33, 33, 33, 33, 135, 32, 32, 32, 34, 33, 33, 33, 78}, 
{112, 112, 39, 34, 42, 43, 80, 80, 33, 33, 126, 33, 32, 32, 33, 33, 45, 33, 33, 33, 37, 37, 33, 33, 33, 34, 34, 33, 33, 33, 233, 233, 53, 93, 93, 33, 33, 33, 33, 33, 103, 33, 33, 33, 43, 83, 33, 33, 33, 123, 32, 33, 67, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 79}, 
{113, 113, 38, 33, 48, 7833, 733, 733, 33, 33, 123, 33, 32, 32, 33, 42, 42, 33, 33, 33, 42, 42, 33, 33, 33, 33, 33, 33, 33, 34, 1533, 1533, 133, 118, 133, 33, 33, 33, 33, 33, 93, 33, 43, 43, 43, 83, 33, 33, 33, 108, 32, 33, 69, 33, 33, 33, 33, 33, 33, 33, 33, 33, 833, 33, 33, 33, 33, 33, 33, 33, 33, 33, 74, 158, 32, 32, 34, 34, 33, 33, 80}, 
{114, 114, 37, 34, 38, 533, 197, 197, 33, 33, 125, 33, 32, 32, 33, 43, 33, 33, 33, 33, 42, 33, 33, 33, 33, 36, 33, 33, 33, 35, 333, 333, 78, 73, 78, 33, 33, 33, 33, 66, 43, 43, 43, 43, 43, 43, 33, 33, 33, 110, 32, 33, 50, 33, 33, 33, 33, 33, 33, 33, 33, 33, 233, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 81}, 
{115, 115, 39, 33, 41, 1433, 197, 197, 33, 33, 125, 33, 32, 32, 33, 42, 42, 33, 33, 33, 42, 42, 33, 33, 33, 36, 36, 33, 33, 35, 423, 423, 78, 78, 88, 33, 33, 33, 33, 73, 63, 43, 43, 43, 43, 43, 33, 33, 33, 112, 32, 33, 40, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 139, 32, 32, 32, 34, 33, 33, 33, 82}, 
{116, 116, 39, 34, 42, 1833, 283, 283, 33, 33, 124, 33, 32, 32, 33, 45, 33, 33, 33, 33, 42, 33, 33, 33, 33, 36, 33, 33, 33, 33, 533, 533, 93, 93, 98, 33, 93, 83, 83, 83, 33, 43, 43, 43, 43, 43, 123, 33, 33, 103, 32, 33, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 83}, 
{117, 117, 38, 33, 48, 7783, 633, 633, 33, 33, 123, 33, 32, 32, 33, 53, 33, 33, 33, 33, 42, 33, 33, 33, 33, 36, 33, 33, 33, 34, 1533, 1533, 93, 93, 133, 33, 33, 33, 63, 53, 43, 43, 93, 43, 43, 43, 33, 33, 33, 114, 32, 33, 136, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 114, 34, 32, 32, 34, 36, 33, 33, 84}, 
{118, 118, 39, 33, 53, 16783, 533, 533, 33, 33, 123, 33, 32, 32, 33, 65, 33, 33, 33, 33, 53, 33, 33, 33, 33, 39, 33, 33, 33, 33, 1533, 1533, 113, 93, 93, 110, 103, 93, 103, 103, 43, 43, 43, 43, 43, 43, 33, 33, 33, 93, 32, 33, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 224, 32, 32, 32, 34, 33, 33, 33, 85}, 
{119, 119, 45, 34, 39, 783, 161, 161, 33, 33, 124, 33, 32, 32, 33, 46, 46, 33, 33, 33, 42, 42, 33, 33, 33, 36, 36, 33, 33, 33, 303, 303, 75, 78, 63, 33, 33, 33, 33, 43, 63, 43, 43, 43, 43, 43, 33, 33, 33, 99, 32, 33, 63, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 86}, 
{120, 120, 39, 34, 53, 16783, 533, 533, 33, 33, 123, 33, 32, 32, 33, 49, 33, 33, 49, 33, 42, 33, 33, 42, 33, 36, 33, 33, 36, 33, 1533, 1533, 103, 103, 93, 33, 33, 33, 33, 43, 43, 43, 103, 43, 43, 43, 33, 33, 33, 108, 32, 33, 111, 33, 33, 33, 33, 33, 33, 33, 33, 33, 733, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 87}, 
{121, 121, 37, 33, 41, 1433, 197, 197, 33, 33, 124, 33, 32, 32, 33, 52, 33, 33, 33, 33, 48, 33, 33, 33, 33, 36, 33, 33, 33, 35, 633, 633, 73, 78, 78, 33, 33, 33, 33, 65, 43, 43, 43, 43, 43, 43, 33, 33, 33, 103, 32, 33, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 254, 55, 56, 32, 34, 34, 34, 33, 88}, 
{122, 122, 38, 33, 41, 1433, 576, 576, 33, 33, 124, 33, 32, 32, 33, 53, 33, 53, 33, 33, 42, 33, 42, 33, 33, 36, 33, 36, 33, 35, 183, 183, 88, 78, 88, 33, 33, 33, 33, 43, 43, 83, 43, 43, 43, 43, 33, 33, 33, 103, 32, 33, 89, 33, 33, 33, 33, 33, 33, 33, 33, 33, 233, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 89}, 
{123, 123, 39, 34, 38, 533, 233, 233, 33, 33, 123, 33, 32, 32, 33, 48, 33, 33, 33, 33, 42, 33, 33, 33, 33, 36, 33, 33, 33, 33, 228, 228, 63, 93, 73, 33, 33, 33, 93, 63, 43, 43, 43, 43, 43, 43, 83, 33, 33, 107, 32, 33, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 198, 32, 32, 32, 34, 33, 33, 33, 90}, 
{124, 124, 40, 34, 34, 33, 133, 133, 33, 33, 123, 33, 32, 32, 33, 40, 40, 33, 33, 33, 40, 40, 33, 33, 33, 37, 37, 33, 33, 34, 383, 383, 71, 66, 68, 33, 33, 33, 33, 43, 68, 43, 43, 43, 43, 43, 33, 33, 33, 101, 32, 33, 61, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 166, 32, 32, 32, 34, 33, 33, 33, 91}, 
{125, 125, 40, 34, 35, 83, 193, 193, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 483, 483, 83, 78, 73, 33, 33, 33, 33, 43, 67, 43, 43, 43, 43, 43, 33, 33, 33, 104, 32, 33, 69, 33, 33, 33, 33, 33, 33, 33, 33, 33, 233, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 92}, 
{126, 126, 40, 33, 35, 83, 95, 95, 33, 33, 123, 33, 32, 32, 33, 33, 44, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 63, 63, 58, 63, 58, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 72, 33, 33, 33, 33, 33, 33, 33, 33, 33, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 93}, 
{127, 127, 40, 33, 36, 183, 333, 333, 33, 33, 123, 33, 32, 32, 33, 33, 33, 44, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 34, 133, 933, 108, 88, 108, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 85, 33, 33, 33, 33, 33, 33, 33, 33, 33, 1032, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 36, 33, 33, 33, 94}, 
{128, 128, 40, 33, 37, 333, 333, 333, 33, 33, 123, 33, 32, 32, 33, 33, 44, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 113, 933, 108, 88, 108, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 71, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 35, 33, 33, 33, 95}, 
{129, 129, 40, 33, 39, 783, 333, 333, 33, 33, 123, 33, 32, 32, 33, 33, 44, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 83, 933, 108, 88, 108, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 70, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 35, 33, 33, 33, 96}, 
{130, 130, 40, 33, 38, 533, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 33, 44, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 34, 533, 1533, 133, 83, 153, 33, 33, 33, 93, 43, 43, 43, 43, 43, 43, 43, 103, 33, 33, 43, 32, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 1032, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 38, 32, 32, 35, 38, 33, 33, 97}, 
{131, 131, 40, 33, 40, 1083, 633, 633, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 33, 34, 2033, 2033, 153, 113, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 50, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 38, 43, 45, 35, 35, 35, 36, 98}, 
{132, 132, 40, 33, 41, 1433, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 44, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 66, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 39, 40, 32, 35, 35, 36, 33, 99}, 
{133, 133, 40, 33, 41, 1433, 433, 433, 33, 33, 123, 33, 32, 32, 33, 44, 44, 33, 33, 33, 40, 40, 33, 33, 33, 37, 37, 33, 33, 34, 833, 833, 83, 153, 83, 33, 33, 33, 103, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 42, 33, 36, 32, 36, 36, 36, 33, 100}, 
{134, 134, 36, 33, 34, 33, 62, 62, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 40, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 34, 63, 63, 48, 63, 53, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 133, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 101}, 
{135, 135, 37, 33, 34, 33, 65, 65, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 40, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 34, 63, 63, 53, 63, 53, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 133, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 102}, 
{136, 136, 39, 33, 35, 83, 833, 833, 33, 33, 123, 33, 32, 32, 33, 33, 33, 40, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 33, 34, 4033, 4033, 183, 123, 163, 33, 33, 33, 83, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 99, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 35, 41, 37, 32, 35, 35, 36, 33, 103}, 
{137, 137, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 40, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 34, 68, 68, 58, 63, 63, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 233, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 104}, 
{138, 138, 39, 33, 37, 333, 125, 125, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 40, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 34, 78, 78, 63, 68, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 233, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 105}, 
{139, 139, 38, 33, 37, 333, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 33, 42, 33, 33, 33, 33, 37, 33, 33, 33, 33, 36, 33, 34, 1033, 1033, 93, 103, 113, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 92, 33, 33, 33, 33, 33, 33, 33, 33, 33, 1032, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 106}, 
{140, 140, 39, 33, 39, 783, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 33, 40, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 93, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 36, 33, 41, 32, 35, 35, 34, 33, 107}, 
{141, 141, 40, 33, 40, 1083, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 40, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 93, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 37, 32, 32, 35, 35, 33, 33, 108}, 
{142, 142, 39, 33, 41, 1433, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 40, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 33, 33, 33, 1533, 1533, 133, 103, 133, 33, 33, 33, 63, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 67, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 37, 32, 32, 36, 35, 33, 33, 109}, 
{143, 143, 41, 33, 42, 1833, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 40, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 109, 33, 33, 33, 33, 33, 33, 33, 33, 33, 833, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 110}, 
{144, 173, 42, 33, 44, 2783, 533, 533, 33, 33, 123, 33, 32, 32, 33, 45, 33, 33, 33, 33, 38, 33, 33, 33, 33, 37, 33, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 110, 33, 33, 33, 33, 33, 33, 33, 33, 33, 733, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 111}, 
{145, 145, 42, 33, 44, 2783, 350, 350, 33, 33, 123, 33, 32, 32, 33, 45, 33, 33, 33, 33, 38, 33, 33, 33, 33, 37, 33, 33, 33, 34, 83, 83, 88, 53, 113, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 112, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 112}, 
{146, 146, 42, 33, 45, 3883, 377, 377, 33, 33, 123, 33, 32, 32, 33, 45, 33, 33, 33, 33, 38, 33, 33, 33, 33, 37, 33, 33, 33, 34, 83, 83, 103, 53, 113, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 112, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 113}, 
{147, 147, 41, 33, 44, 2783, 1032, 1032, 33, 33, 123, 33, 32, 32, 33, 45, 33, 33, 33, 33, 38, 33, 33, 33, 33, 37, 33, 33, 33, 34, 10032, 10032, 533, 233, 533, 33, 33, 33, 113, 43, 43, 43, 43, 43, 133, 43, 33, 33, 33, 43, 32, 33, 141, 33, 33, 33, 33, 33, 33, 33, 33, 33, 1032, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 114}, 
{148, 148, 42, 33, 46, 5083, 404, 404, 33, 33, 125, 33, 32, 32, 33, 33, 40, 33, 33, 33, 33, 38, 33, 33, 33, 37, 33, 33, 33, 34, 83, 83, 108, 63, 113, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 77, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 115}, 
{149, 149, 42, 33, 45, 3883, 377, 377, 33, 33, 123, 33, 32, 32, 33, 33, 33, 40, 33, 33, 33, 33, 38, 33, 33, 37, 33, 33, 33, 34, 93, 93, 93, 53, 113, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 95, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 116}, 
{150, 150, 42, 33, 46, 5083, 404, 404, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 38, 33, 33, 33, 37, 33, 33, 33, 34, 103, 103, 103, 53, 113, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 72, 33, 33, 33, 33, 33, 33, 33, 33, 33, 733, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 117}, 
{151, 151, 42, 33, 46, 5083, 933, 933, 33, 33, 123, 33, 32, 32, 33, 42, 33, 33, 33, 33, 38, 33, 33, 33, 33, 37, 33, 33, 33, 34, 4033, 4033, 183, 123, 183, 33, 33, 33, 63, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 47, 131, 33, 33, 33, 33, 33, 33, 33, 33, 1032, 1032, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 118}, 
{152, 152, 42, 33, 47, 6383, 431, 431, 33, 33, 125, 33, 32, 32, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 37, 33, 33, 33, 34, 1032, 1032, 113, 93, 123, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 50, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 40, 32, 32, 32, 38, 33, 33, 33, 119}, 
{153, 153, 42, 33, 48, 7783, 458, 458, 33, 33, 123, 33, 32, 32, 33, 45, 33, 33, 33, 33, 38, 33, 33, 33, 33, 37, 33, 33, 33, 34, 1033, 1033, 123, 103, 123, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 50, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 120}, 
{154, 154, 38, 33, 36, 183, 498, 498, 33, 33, 123, 33, 32, 32, 33, 41, 33, 33, 33, 33, 39, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1032, 1032, 123, 83, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 50, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 40, 32, 32, 32, 36, 33, 33, 33, 121}, 
{155, 155, 38, 33, 36, 183, 498, 498, 33, 33, 123, 33, 32, 32, 33, 41, 33, 33, 33, 33, 39, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1032, 1032, 113, 83, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 114, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 40, 32, 32, 32, 36, 33, 33, 33, 122}, 
{156, 156, 38, 33, 37, 333, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 44, 33, 33, 33, 33, 44, 33, 33, 33, 33, 44, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 72, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 123}, 
{157, 157, 38, 33, 37, 333, 533, 533, 33, 33, 123, 33, 32, 32, 33, 41, 33, 33, 33, 33, 39, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 72, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 38, 32, 32, 36, 36, 33, 33, 124}, 
{158, 158, 38, 33, 38, 533, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 44, 33, 33, 33, 33, 44, 33, 33, 33, 33, 38, 33, 33, 34, 1533, 1533, 133, 123, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 72, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 37, 32, 32, 36, 36, 33, 33, 125}, 
{159, 159, 38, 33, 39, 783, 533, 533, 33, 33, 123, 33, 32, 32, 33, 41, 33, 33, 33, 33, 39, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 72, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 38, 32, 32, 38, 36, 33, 33, 126}, 
{160, 160, 39, 33, 40, 1083, 433, 433, 33, 33, 123, 33, 32, 32, 33, 33, 44, 33, 33, 33, 33, 44, 33, 33, 33, 33, 44, 33, 33, 34, 1033, 1033, 123, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 72, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 36, 32, 32, 38, 38, 33, 33, 127}, 
{161, 161, 39, 33, 41, 1433, 433, 433, 33, 33, 123, 33, 32, 32, 33, 33, 44, 33, 33, 33, 33, 44, 33, 33, 33, 33, 44, 33, 33, 34, 1033, 1033, 123, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 72, 33, 33, 33, 33, 33, 33, 33, 33, 33, 1032, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 36, 32, 32, 38, 38, 33, 33, 128}, 
{162, 162, 39, 33, 42, 1833, 1032, 1032, 33, 33, 123, 33, 32, 32, 33, 48, 33, 33, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 34, 5033, 5033, 283, 133, 333, 33, 33, 33, 93, 43, 43, 43, 43, 43, 43, 43, 33, 33, 33, 43, 32, 33, 133, 50, 33, 33, 33, 33, 33, 33, 33, 33, 1032, 1032, 33, 33, 33, 33, 33, 33, 33, 33, 40, 32, 32, 32, 36, 33, 33, 33, 129}, 
{163, 163, 42, 33, 42, 1833, 383, 383, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 46, 33, 33, 33, 33, 43, 33, 33, 33, 33, 38, 34, 733, 733, 133, 53, 113, 33, 33, 33, 63, 43, 43, 43, 43, 121, 43, 43, 33, 33, 33, 43, 32, 33, 110, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 68, 34, 37, 32, 43, 36, 35, 33, 130}, 
{164, 164, 40, 33, 39, 783, 333, 333, 33, 33, 123, 33, 32, 32, 33, 33, 44, 33, 33, 33, 33, 40, 33, 33, 33, 33, 36, 33, 33, 34, 833, 833, 103, 83, 103, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 113, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 40, 32, 32, 32, 36, 33, 33, 33, 131}, 
{165, 165, 40, 33, 39, 783, 333, 333, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 44, 33, 33, 33, 33, 40, 33, 33, 33, 33, 36, 34, 833, 833, 103, 89, 103, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 113, 33, 33, 33, 93, 32, 33, 111, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 36, 33, 32, 32, 34, 36, 33, 33, 132}, 
{166, 166, 40, 33, 42, 1833, 333, 333, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 43, 33, 33, 33, 33, 43, 33, 33, 33, 33, 36, 34, 833, 833, 103, 93, 103, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 113, 33, 33, 33, 93, 32, 33, 105, 33, 33, 33, 33, 33, 33, 33, 33, 33, 833, 33, 33, 33, 33, 33, 33, 33, 33, 33, 39, 33, 32, 32, 34, 36, 33, 33, 133}, 
{167, 167, 40, 33, 42, 1833, 333, 333, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 40, 33, 33, 33, 33, 36, 33, 33, 33, 33, 40, 34, 733, 733, 98, 78, 98, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 113, 33, 33, 33, 93, 32, 33, 109, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 32, 32, 32, 36, 33, 33, 33, 134}, 
{168, 168, 40, 33, 38, 533, 333, 333, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 40, 33, 33, 33, 33, 36, 33, 33, 34, 733, 733, 103, 78, 103, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 113, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 41, 32, 32, 32, 34, 33, 33, 33, 135}, 
{169, 169, 40, 33, 38, 533, 333, 333, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 36, 33, 33, 34, 733, 733, 98, 77, 98, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 113, 33, 33, 33, 93, 32, 33, 62, 33, 33, 33, 33, 33, 33, 33, 33, 33, 603, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 38, 33, 33, 33, 136}, 
{170, 170, 40, 33, 40, 1083, 333, 333, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 40, 33, 33, 33, 33, 36, 33, 33, 34, 763, 763, 111, 99, 95, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 113, 33, 33, 33, 93, 32, 33, 60, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 38, 33, 33, 33, 137}, 
{171, 171, 40, 33, 40, 1083, 433, 433, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 36, 34, 833, 833, 103, 99, 103, 33, 33, 33, 63, 43, 43, 43, 43, 103, 43, 113, 33, 33, 33, 93, 32, 33, 111, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 40, 68, 32, 32, 36, 43, 33, 33, 138}, 
{172, 172, 40, 33, 41, 1433, 221, 221, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 40, 33, 33, 33, 33, 36, 33, 33, 34, 533, 533, 88, 68, 88, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 113, 33, 33, 33, 93, 32, 33, 61, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 38, 33, 33, 33, 139}, 
{173, 173, 40, 33, 42, 1833, 242, 242, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 40, 33, 33, 33, 33, 36, 33, 33, 34, 132, 132, 98, 91, 95, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 113, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 733, 33, 33, 33, 33, 33, 33, 33, 33, 33, 39, 32, 32, 32, 34, 33, 33, 33, 140}, 
{174, 174, 39, 33, 34, 33, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 533, 533, 133, 103, 93, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 113, 33, 33, 33, 93, 32, 33, 67, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 33, 32, 32, 34, 36, 33, 33, 141}, 
{175, 175, 39, 33, 35, 83, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 113, 33, 33, 33, 93, 32, 33, 67, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 37, 32, 32, 35, 35, 33, 33, 142}, 
{176, 176, 39, 33, 36, 183, 333, 333, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 41, 33, 33, 33, 33, 36, 34, 833, 833, 103, 83, 93, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 113, 33, 33, 33, 93, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 833, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 36, 33, 33, 33, 143}, 
{177, 177, 39, 33, 36, 183, 333, 333, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 40, 33, 33, 33, 33, 36, 34, 833, 833, 103, 103, 73, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 113, 33, 33, 33, 93, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 833, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 36, 33, 33, 33, 144}, 
{178, 178, 39, 33, 37, 333, 333, 333, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 41, 33, 33, 33, 33, 36, 34, 833, 833, 103, 77, 75, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 113, 33, 33, 33, 93, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 833, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 36, 33, 33, 33, 145}, 
{179, 179, 39, 33, 38, 533, 333, 333, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 40, 33, 33, 33, 33, 40, 34, 833, 833, 103, 73, 75, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 113, 33, 33, 33, 93, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 833, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 36, 33, 33, 33, 146}, 
{180, 180, 39, 33, 39, 783, 361, 361, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 40, 33, 33, 33, 33, 36, 34, 733, 733, 103, 67, 75, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 113, 33, 33, 33, 93, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 35, 33, 33, 33, 147}, 
{181, 181, 39, 33, 40, 1083, 379, 379, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 40, 33, 33, 33, 33, 40, 34, 653, 653, 103, 70, 65, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 113, 33, 33, 33, 93, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 35, 33, 33, 33, 148}, 
{182, 182, 39, 33, 41, 1433, 197, 197, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 95, 95, 85, 77, 85, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 113, 33, 33, 33, 93, 32, 33, 73, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 35, 33, 33, 33, 149}, 
{183, 183, 39, 33, 41, 1433, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 113, 33, 33, 33, 93, 32, 33, 70, 33, 33, 33, 33, 33, 33, 33, 33, 33, 733, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 38, 32, 32, 35, 35, 33, 33, 150}, 
{184, 184, 40, 33, 34, 33, 74, 74, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 41, 33, 33, 33, 33, 37, 33, 33, 33, 34, 65, 65, 55, 57, 55, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 123, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 37, 32, 32, 32, 34, 33, 33, 33, 151}, 
{185, 185, 40, 33, 35, 83, 633, 633, 33, 33, 123, 33, 32, 32, 33, 33, 44, 33, 33, 33, 33, 41, 33, 33, 33, 33, 37, 33, 33, 34, 2233, 2233, 155, 57, 93, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 71, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 37, 33, 32, 32, 34, 36, 33, 33, 152}, 
{186, 186, 40, 33, 36, 183, 533, 533, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 41, 33, 33, 33, 33, 37, 33, 33, 33, 34, 1533, 1533, 133, 113, 133, 33, 33, 33, 33, 43, 43, 43, 43, 183, 43, 83, 33, 33, 33, 93, 32, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 37, 68, 63, 33, 36, 63, 63, 38, 153}, 
{187, 187, 40, 33, 37, 333, 333, 333, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 41, 33, 33, 33, 33, 37, 33, 34, 833, 833, 83, 83, 103, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 87, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 37, 33, 32, 32, 38, 36, 33, 33, 154}, 
{188, 188, 40, 33, 38, 533, 333, 333, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 41, 33, 33, 41, 33, 37, 33, 33, 37, 34, 833, 833, 93, 83, 93, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 37, 33, 32, 32, 34, 36, 33, 33, 155}, 
{189, 189, 40, 33, 39, 783, 333, 333, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 45, 33, 33, 33, 33, 41, 33, 33, 33, 33, 37, 34, 833, 833, 93, 77, 93, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 37, 33, 32, 32, 34, 36, 33, 33, 156}, 
{190, 190, 40, 33, 40, 1083, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 46, 33, 41, 33, 33, 41, 33, 37, 33, 33, 37, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 37, 34, 32, 32, 38, 38, 33, 33, 157}, 
{191, 191, 40, 33, 41, 1433, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 42, 33, 33, 33, 33, 37, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 111, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 37, 34, 32, 32, 38, 38, 33, 33, 158}, 
{192, 192, 40, 33, 41, 1433, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 43, 33, 33, 33, 33, 41, 33, 33, 33, 33, 37, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 119, 33, 33, 33, 33, 33, 33, 33, 33, 33, 733, 33, 33, 33, 33, 33, 33, 33, 33, 33, 37, 34, 32, 32, 38, 38, 33, 33, 159}, 
{193, 193, 40, 33, 39, 783, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 41, 33, 37, 33, 33, 37, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 116, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 37, 34, 32, 32, 38, 38, 33, 33, 160}, 
{194, 194, 38, 33, 36, 183, 533, 533, 33, 33, 123, 33, 32, 32, 33, 41, 33, 33, 33, 33, 39, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 73, 43, 43, 43, 43, 133, 43, 83, 93, 33, 33, 93, 32, 33, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 38, 40, 67, 32, 38, 36, 43, 33, 161}, 
{195, 195, 38, 33, 36, 183, 633, 633, 33, 33, 123, 33, 32, 32, 33, 42, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 34, 2033, 2033, 133, 113, 133, 33, 33, 33, 73, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 38, 35, 32, 32, 36, 35, 33, 33, 162}, 
{196, 196, 38, 33, 37, 333, 633, 633, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 34, 2033, 2033, 153, 113, 133, 33, 33, 33, 73, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 1032, 33, 33, 33, 33, 33, 33, 33, 33, 33, 38, 35, 32, 32, 38, 35, 33, 33, 163}, 
{197, 197, 38, 33, 36, 183, 98, 98, 33, 33, 123, 33, 32, 32, 33, 33, 45, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 34, 65, 65, 61, 67, 55, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 70, 33, 33, 33, 33, 33, 33, 33, 33, 33, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 38, 32, 32, 32, 34, 33, 33, 33, 164}, 
{198, 198, 38, 33, 37, 333, 333, 333, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 44, 33, 33, 33, 33, 44, 33, 33, 33, 34, 733, 733, 98, 78, 98, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 50, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 38, 33, 32, 32, 38, 38, 33, 33, 165}, 
{199, 199, 38, 33, 38, 533, 533, 533, 33, 33, 123, 33, 32, 32, 33, 43, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 70, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 37, 34, 32, 32, 38, 36, 33, 33, 166}, 
{200, 200, 38, 33, 38, 533, 533, 533, 33, 33, 123, 33, 32, 32, 33, 42, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1033, 1033, 113, 93, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 56, 33, 33, 33, 33, 33, 33, 33, 33, 33, 733, 33, 33, 33, 33, 33, 33, 33, 33, 33, 36, 33, 32, 32, 34, 38, 33, 33, 167}, 
{201, 201, 38, 33, 39, 783, 533, 533, 33, 33, 123, 33, 32, 32, 33, 42, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1033, 1033, 113, 93, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 56, 33, 33, 33, 33, 33, 33, 33, 33, 33, 733, 33, 33, 33, 33, 33, 33, 33, 33, 33, 36, 34, 32, 32, 34, 36, 33, 33, 168}, 
{202, 202, 38, 33, 40, 1083, 733, 733, 33, 33, 123, 33, 32, 32, 33, 47, 33, 33, 33, 33, 47, 33, 33, 33, 33, 47, 33, 33, 33, 34, 3033, 3033, 163, 118, 133, 33, 33, 33, 53, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 55, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 38, 32, 32, 32, 34, 33, 33, 33, 169}, 
{203, 203, 38, 33, 41, 1433, 733, 733, 33, 33, 123, 33, 32, 32, 33, 47, 33, 33, 33, 33, 47, 33, 33, 33, 33, 38, 33, 33, 33, 34, 2033, 2033, 153, 93, 133, 33, 33, 33, 63, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 53, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 38, 32, 32, 32, 34, 33, 33, 33, 170}, 
{204, 204, 36, 33, 34, 33, 62, 62, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 55, 55, 45, 63, 45, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 69, 33, 33, 33, 33, 33, 33, 33, 33, 33, 833, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 171}, 
{205, 205, 36, 33, 35, 83, 433, 433, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 1033, 1033, 113, 93, 113, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 69, 33, 33, 33, 33, 33, 33, 33, 33, 33, 833, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 32, 32, 32, 35, 33, 33, 33, 172}, 
{206, 206, 37, 33, 36, 183, 533, 533, 33, 33, 123, 33, 32, 32, 33, 40, 33, 33, 33, 33, 40, 33, 33, 33, 33, 40, 33, 33, 33, 34, 1533, 1533, 133, 93, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 126, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 173}, 
{207, 207, 37, 33, 37, 333, 533, 533, 33, 33, 123, 33, 32, 32, 33, 40, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 33, 34, 1533, 1533, 133, 113, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 126, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 174}, 
{208, 208, 37, 33, 38, 533, 533, 533, 33, 33, 123, 33, 32, 32, 33, 40, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 126, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 175}, 
{209, 209, 38, 33, 39, 783, 233, 233, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 47, 33, 33, 33, 33, 43, 33, 33, 33, 33, 37, 34, 633, 633, 93, 77, 93, 33, 113, 33, 113, 43, 43, 43, 43, 43, 43, 83, 133, 33, 33, 93, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 176}, 
{210, 210, 38, 33, 39, 783, 233, 233, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 633, 633, 93, 77, 93, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 61, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 38, 33, 33, 33, 177}, 
{211, 211, 38, 33, 40, 1083, 233, 233, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 633, 633, 71, 77, 65, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 61, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 178}, 
{212, 212, 38, 33, 41, 1433, 233, 233, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 533, 533, 93, 77, 83, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 61, 33, 33, 33, 33, 33, 33, 33, 33, 33, 733, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 179}, 
{213, 213, 38, 33, 40, 1083, 233, 233, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 633, 633, 93, 77, 85, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 70, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 180}, 
{214, 214, 38, 33, 34, 33, 233, 233, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 633, 633, 93, 88, 88, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 70, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 32, 32, 32, 34, 33, 33, 33, 181}, 
{215, 215, 38, 33, 34, 33, 333, 333, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 33, 34, 733, 733, 98, 78, 98, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 40, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 32, 32, 32, 34, 33, 33, 33, 182}, 
{216, 216, 38, 33, 36, 183, 333, 333, 33, 33, 123, 33, 32, 32, 33, 33, 45, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 733, 733, 98, 123, 98, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 67, 33, 33, 33, 33, 33, 33, 33, 33, 33, 733, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 32, 32, 32, 34, 33, 33, 33, 183}, 
{217, 217, 38, 33, 35, 83, 733, 733, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 3033, 3033, 163, 118, 153, 33, 33, 33, 73, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 77, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 41, 32, 32, 32, 36, 33, 33, 33, 184}, 
{218, 218, 38, 33, 37, 333, 833, 833, 33, 33, 123, 33, 32, 32, 33, 48, 42, 33, 33, 33, 43, 40, 33, 33, 33, 37, 37, 33, 33, 34, 3033, 3033, 163, 113, 163, 33, 33, 33, 73, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 77, 46, 33, 33, 33, 33, 33, 33, 33, 33, 933, 933, 33, 33, 33, 33, 33, 33, 33, 33, 35, 32, 32, 32, 36, 33, 33, 33, 185}, 
{219, 219, 38, 33, 37, 333, 533, 533, 33, 33, 123, 33, 32, 32, 33, 49, 33, 33, 33, 33, 43, 33, 33, 33, 33, 37, 33, 33, 33, 34, 1533, 1533, 133, 113, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 46, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 35, 32, 32, 32, 35, 33, 33, 33, 186}, 
{220, 220, 38, 33, 38, 533, 433, 433, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 37, 33, 33, 34, 1033, 1033, 123, 77, 123, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 46, 33, 33, 33, 33, 33, 33, 33, 33, 33, 833, 33, 33, 33, 33, 33, 33, 33, 33, 33, 37, 34, 32, 32, 35, 35, 33, 33, 187}, 
{221, 221, 38, 33, 38, 533, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 37, 35, 32, 32, 36, 35, 33, 33, 188}, 
{222, 222, 38, 33, 39, 783, 733, 733, 33, 33, 123, 33, 32, 32, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 33, 34, 3033, 3033, 163, 118, 163, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 123, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 41, 40, 32, 32, 34, 36, 33, 33, 189}, 
{223, 244, 38, 33, 40, 1083, 283, 283, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 33, 34, 1033, 1033, 75, 77, 93, 33, 33, 33, 133, 43, 43, 43, 43, 43, 43, 83, 133, 33, 33, 93, 32, 33, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 34, 33, 33, 33, 190}, 
{224, 231, 40, 33, 36, 183, 83, 83, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 75, 75, 63, 53, 55, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 66, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 36, 32, 32, 32, 35, 33, 33, 33, 191}, 
{225, 231, 40, 33, 37, 333, 83, 83, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 233, 233, 73, 53, 73, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 66, 33, 33, 33, 33, 33, 33, 33, 33, 33, 133, 33, 33, 33, 33, 33, 33, 33, 33, 33, 36, 32, 32, 32, 35, 33, 33, 33, 192}, 
{226, 231, 40, 33, 37, 333, 137, 137, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 333, 333, 78, 58, 78, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 66, 33, 33, 33, 33, 33, 33, 33, 33, 33, 233, 33, 33, 33, 33, 33, 33, 33, 33, 33, 36, 33, 32, 32, 35, 35, 33, 33, 193}, 
{227, 231, 40, 33, 38, 533, 158, 158, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 433, 433, 83, 67, 83, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 66, 33, 33, 33, 33, 33, 33, 33, 33, 33, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 36, 33, 32, 32, 35, 35, 33, 33, 194}, 
{228, 231, 40, 33, 39, 783, 233, 233, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 533, 533, 88, 68, 88, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 66, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 36, 33, 32, 32, 35, 35, 33, 33, 195}, 
{229, 231, 40, 33, 40, 1083, 233, 233, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 653, 653, 93, 77, 93, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 66, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 36, 33, 32, 32, 35, 35, 33, 33, 196}, 
{230, 231, 40, 33, 41, 1433, 333, 333, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 733, 733, 98, 77, 98, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 66, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 36, 33, 32, 32, 35, 35, 33, 33, 197}, 
{231, 231, 40, 33, 41, 1433, 83, 83, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 125, 125, 82, 77, 75, 113, 83, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 66, 33, 33, 33, 33, 33, 33, 33, 33, 33, 133, 33, 33, 33, 33, 33, 33, 33, 33, 33, 36, 32, 32, 32, 35, 33, 33, 33, 198}, 
{232, 231, 41, 33, 42, 1833, 433, 433, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 1033, 1033, 113, 93, 113, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 66, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 36, 34, 32, 32, 35, 35, 33, 33, 199}, 
{233, 231, 41, 33, 42, 1833, 383, 383, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 1023, 1023, 108, 88, 108, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 66, 33, 33, 33, 33, 33, 33, 33, 33, 33, 833, 33, 33, 33, 33, 33, 33, 33, 33, 33, 36, 34, 32, 32, 35, 35, 33, 33, 200}, 
{234, 232, 39, 33, 34, 33, 71, 71, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 39, 33, 33, 33, 33, 34, 33, 33, 34, 133, 133, 63, 53, 63, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 64, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 201}, 
{235, 232, 39, 33, 35, 83, 89, 89, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 39, 33, 33, 33, 33, 34, 33, 33, 34, 233, 233, 58, 61, 48, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 64, 33, 33, 33, 33, 33, 33, 33, 33, 33, 133, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 202}, 
{236, 232, 39, 33, 36, 183, 133, 133, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 39, 33, 33, 33, 33, 34, 33, 33, 34, 363, 363, 61, 61, 53, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 64, 33, 33, 33, 33, 33, 33, 33, 33, 33, 233, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 203}, 
{237, 232, 39, 33, 36, 183, 133, 133, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 39, 33, 33, 33, 33, 34, 33, 33, 34, 433, 433, 83, 63, 83, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 64, 33, 33, 33, 33, 33, 33, 33, 33, 33, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 204}, 
{238, 232, 39, 33, 37, 333, 225, 225, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 39, 33, 33, 33, 33, 34, 33, 33, 34, 463, 463, 83, 63, 83, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 64, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 205}, 
{239, 232, 39, 33, 37, 333, 225, 225, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 39, 33, 33, 33, 33, 34, 33, 33, 34, 533, 533, 88, 88, 88, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 64, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 206}, 
{240, 232, 39, 33, 38, 533, 333, 333, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 39, 33, 33, 33, 33, 34, 33, 33, 34, 563, 563, 93, 71, 93, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 64, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 207}, 
{241, 232, 39, 33, 39, 783, 161, 161, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 39, 33, 33, 33, 33, 34, 33, 33, 34, 693, 693, 72, 73, 63, 113, 73, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 64, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 208}, 
{242, 232, 39, 33, 40, 1083, 379, 379, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 39, 33, 33, 33, 33, 34, 33, 33, 34, 763, 763, 93, 93, 93, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 64, 33, 33, 33, 33, 33, 33, 33, 33, 33, 833, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 209}, 
{243, 232, 39, 33, 41, 1433, 397, 397, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 39, 33, 33, 33, 33, 34, 33, 33, 34, 863, 863, 103, 88, 103, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 64, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 210}, 
{244, 233, 37, 33, 34, 33, 65, 65, 33, 33, 123, 33, 32, 32, 33, 33, 44, 33, 33, 33, 33, 42, 33, 33, 33, 33, 38, 33, 33, 34, 56, 56, 57, 63, 45, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 60, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 211}, 
{245, 233, 37, 33, 34, 33, 65, 65, 33, 33, 123, 33, 32, 32, 33, 33, 44, 33, 33, 33, 33, 42, 33, 33, 33, 33, 38, 33, 33, 34, 133, 133, 57, 63, 49, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 60, 33, 33, 33, 33, 33, 33, 33, 33, 33, 133, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 212}, 
{246, 233, 37, 33, 35, 83, 77, 77, 33, 33, 123, 33, 32, 32, 33, 33, 44, 33, 33, 33, 33, 42, 33, 33, 33, 33, 38, 33, 33, 34, 353, 353, 61, 68, 50, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 60, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 213}, 
{247, 233, 37, 33, 37, 333, 101, 101, 33, 33, 123, 33, 32, 32, 33, 33, 44, 33, 33, 33, 33, 42, 33, 33, 33, 33, 38, 33, 33, 34, 463, 463, 71, 68, 69, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 60, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 214}, 
{248, 233, 37, 33, 37, 333, 101, 101, 33, 33, 123, 33, 32, 32, 33, 33, 44, 33, 33, 33, 33, 42, 33, 33, 33, 33, 38, 33, 33, 34, 463, 463, 67, 68, 59, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 60, 33, 33, 33, 33, 33, 33, 33, 33, 33, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 215}, 
{249, 233, 37, 33, 36, 183, 89, 89, 33, 33, 123, 33, 32, 32, 33, 33, 44, 33, 33, 33, 33, 42, 33, 33, 33, 33, 38, 33, 33, 34, 393, 393, 63, 68, 53, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 60, 33, 33, 33, 33, 33, 33, 33, 33, 33, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 216}, 
{250, 233, 37, 33, 37, 333, 101, 101, 33, 33, 123, 33, 32, 32, 33, 33, 44, 33, 33, 33, 33, 42, 33, 33, 33, 33, 38, 33, 33, 34, 563, 563, 67, 68, 59, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 60, 33, 33, 33, 33, 33, 33, 33, 33, 33, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 217}, 
{251, 233, 37, 33, 37, 333, 101, 101, 33, 33, 123, 33, 32, 32, 33, 33, 44, 33, 33, 33, 33, 42, 33, 33, 33, 33, 38, 33, 33, 34, 563, 563, 67, 68, 59, 113, 33, 63, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 60, 33, 33, 33, 33, 33, 33, 33, 33, 33, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 218}, 
{252, 233, 37, 33, 37, 333, 401, 401, 33, 33, 123, 33, 32, 32, 33, 33, 44, 33, 33, 33, 33, 42, 33, 33, 33, 33, 38, 33, 33, 34, 563, 563, 93, 93, 93, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 60, 33, 33, 33, 33, 33, 33, 33, 33, 33, 833, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 219}, 
{253, 233, 37, 33, 37, 333, 401, 401, 33, 33, 123, 33, 32, 32, 33, 33, 44, 33, 33, 33, 33, 42, 33, 33, 33, 33, 38, 33, 33, 34, 563, 563, 93, 93, 93, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 60, 33, 33, 33, 33, 33, 33, 33, 33, 33, 1032, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 220}, 
{254, 234, 37, 33, 34, 33, 65, 65, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 41, 33, 33, 33, 33, 35, 33, 133, 133, 59, 68, 49, 33, 79, 65, 58, 43, 43, 43, 43, 43, 43, 83, 65, 33, 33, 93, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 233, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 221}, 
{255, 234, 37, 33, 34, 33, 83, 83, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 41, 33, 33, 33, 33, 35, 33, 133, 133, 73, 68, 73, 33, 79, 65, 58, 43, 43, 43, 43, 43, 43, 83, 65, 33, 33, 93, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 233, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 222}, 
{256, 234, 37, 33, 35, 83, 77, 77, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 41, 33, 33, 33, 33, 35, 33, 56, 56, 59, 68, 49, 33, 89, 85, 78, 43, 43, 43, 43, 43, 43, 83, 85, 33, 33, 93, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 223}, 
{257, 234, 37, 33, 36, 183, 89, 89, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 41, 33, 33, 33, 33, 35, 33, 66, 66, 58, 68, 52, 33, 89, 85, 78, 43, 43, 43, 43, 43, 43, 83, 85, 33, 33, 93, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 224}, 
{258, 234, 37, 33, 37, 333, 101, 101, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 41, 33, 33, 33, 33, 35, 33, 70, 70, 62, 68, 59, 33, 89, 85, 78, 43, 43, 43, 43, 43, 43, 83, 85, 33, 33, 93, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 225}, 
{259, 234, 37, 33, 37, 333, 101, 101, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 41, 33, 33, 33, 33, 35, 33, 70, 70, 62, 68, 59, 33, 89, 85, 78, 43, 43, 43, 43, 43, 43, 83, 85, 33, 33, 93, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 226}, 
{260, 234, 37, 33, 37, 333, 101, 101, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 41, 33, 33, 33, 33, 35, 33, 70, 70, 62, 68, 59, 33, 89, 85, 78, 43, 43, 43, 43, 43, 43, 83, 85, 33, 33, 93, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 227}, 
{261, 234, 37, 33, 38, 533, 113, 113, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 41, 33, 33, 33, 33, 35, 33, 80, 80, 66, 78, 66, 33, 89, 85, 78, 43, 43, 43, 43, 43, 43, 83, 85, 33, 33, 93, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 228}, 
{262, 234, 37, 33, 38, 533, 113, 113, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 41, 33, 33, 33, 33, 35, 33, 80, 80, 66, 78, 66, 33, 89, 85, 78, 43, 43, 43, 43, 43, 43, 83, 85, 33, 33, 93, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 229}, 
{263, 234, 37, 33, 38, 533, 113, 113, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 41, 33, 33, 33, 33, 35, 33, 80, 80, 68, 78, 68, 33, 89, 85, 78, 43, 43, 43, 43, 43, 43, 83, 85, 33, 33, 93, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 230}, 
{264, 235, 41, 33, 37, 333, 149, 149, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 43, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 33, 63, 63, 58, 73, 43, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 104, 33, 33, 33, 33, 33, 33, 33, 33, 33, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 231}, 
{265, 235, 41, 33, 37, 333, 149, 149, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 43, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 33, 63, 63, 58, 73, 43, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 104, 33, 33, 33, 33, 33, 33, 33, 33, 33, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 232}, 
{266, 235, 41, 33, 38, 533, 173, 173, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 43, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 33, 68, 68, 61, 73, 53, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 104, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 233}, 
{267, 235, 41, 33, 38, 533, 173, 173, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 43, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 33, 68, 68, 61, 73, 53, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 104, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 234}, 
{268, 235, 41, 33, 39, 783, 197, 197, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 43, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 33, 73, 73, 63, 78, 63, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 104, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 235}, 
{269, 235, 41, 33, 39, 783, 197, 197, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 43, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 33, 73, 73, 68, 78, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 104, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 236}, 
{270, 235, 41, 33, 40, 1083, 221, 221, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 43, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 33, 83, 83, 71, 78, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 104, 33, 33, 33, 33, 33, 33, 33, 33, 33, 733, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 237}, 
{271, 235, 41, 33, 41, 1433, 245, 245, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 43, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 33, 83, 83, 73, 78, 78, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 104, 33, 33, 33, 33, 33, 33, 33, 33, 33, 833, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 238}, 
{272, 235, 41, 33, 41, 1433, 245, 245, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 43, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 33, 93, 93, 78, 78, 73, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 104, 33, 33, 33, 33, 33, 33, 33, 33, 33, 833, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 239}, 
{273, 235, 41, 33, 42, 1833, 269, 269, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 43, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 33, 93, 93, 81, 78, 78, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 104, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 240}, 
{274, 237, 35, 33, 34, 33, 59, 59, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 34, 33, 33, 33, 53, 53, 43, 58, 43, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 68, 33, 33, 33, 33, 33, 33, 33, 33, 33, 233, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 241}, 
{275, 237, 36, 33, 35, 83, 71, 71, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 34, 33, 33, 33, 73, 73, 53, 63, 48, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 68, 33, 33, 33, 33, 33, 33, 33, 33, 33, 233, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 242}, 
{276, 237, 36, 33, 35, 83, 71, 71, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 34, 33, 33, 33, 83, 83, 53, 63, 53, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 68, 33, 33, 33, 33, 33, 33, 33, 33, 33, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 243}, 
{277, 237, 36, 33, 36, 183, 80, 80, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 34, 33, 33, 33, 83, 83, 58, 68, 53, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 68, 33, 33, 33, 33, 33, 33, 33, 33, 33, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 244}, 
{278, 237, 37, 33, 37, 333, 101, 101, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 34, 33, 33, 33, 93, 93, 63, 73, 63, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 68, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 245}, 
{279, 237, 38, 33, 37, 333, 113, 113, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 34, 33, 33, 33, 93, 93, 63, 73, 73, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 68, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 246}, 
{280, 237, 38, 33, 39, 783, 143, 143, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 34, 33, 33, 33, 103, 103, 68, 78, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 68, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 247}, 
{281, 237, 38, 33, 39, 783, 143, 143, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 34, 33, 33, 33, 103, 103, 68, 78, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 68, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 248}, 
{282, 237, 38, 33, 40, 1083, 158, 158, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 34, 33, 33, 33, 103, 103, 68, 78, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 68, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 249}, 
{283, 237, 38, 33, 41, 1433, 173, 173, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 34, 33, 33, 33, 103, 103, 73, 83, 73, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 68, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 250}, 
{284, 238, 40, 33, 35, 83, 95, 95, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 34, 34, 73, 73, 53, 68, 53, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 103, 33, 33, 33, 33, 33, 33, 33, 33, 33, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 251}, 
{285, 238, 40, 33, 35, 83, 95, 95, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 34, 34, 73, 73, 53, 68, 53, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 103, 33, 33, 33, 33, 33, 33, 33, 33, 33, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 252}, 
{286, 238, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 34, 34, 73, 73, 58, 73, 58, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 103, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 253}, 
{287, 238, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 34, 34, 83, 83, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 103, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 254}, 
{288, 238, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 34, 34, 93, 93, 68, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 103, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 255}, 
{289, 238, 40, 33, 39, 783, 179, 179, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 34, 34, 93, 93, 73, 78, 73, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 103, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 256}, 
{290, 238, 40, 33, 40, 1083, 200, 200, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 34, 34, 103, 103, 73, 78, 73, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 103, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 257}, 
{291, 238, 40, 33, 40, 1083, 200, 200, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 34, 34, 103, 103, 73, 78, 73, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 103, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 258}, 
{292, 238, 40, 33, 41, 1433, 221, 221, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 34, 34, 103, 103, 78, 83, 78, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 103, 33, 33, 33, 33, 33, 33, 33, 33, 33, 733, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 259}, 
{293, 238, 40, 33, 42, 1833, 242, 242, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 34, 34, 132, 132, 81, 78, 83, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 103, 33, 33, 33, 33, 33, 33, 33, 33, 33, 833, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 260}, 
{294, 239, 38, 33, 34, 33, 68, 68, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 34, 34, 63, 63, 53, 68, 43, 33, 53, 33, 33, 43, 43, 43, 43, 43, 43, 83, 53, 33, 33, 93, 32, 33, 105, 33, 33, 33, 33, 33, 33, 33, 33, 33, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 261}, 
{295, 239, 38, 33, 34, 33, 68, 68, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 34, 34, 63, 63, 53, 68, 43, 33, 53, 33, 33, 43, 43, 43, 43, 43, 43, 83, 53, 33, 33, 93, 32, 33, 105, 33, 33, 33, 33, 33, 33, 33, 33, 33, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 262}, 
{296, 239, 38, 33, 35, 83, 83, 83, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 34, 34, 63, 63, 58, 73, 43, 33, 63, 33, 33, 43, 43, 43, 43, 43, 43, 83, 63, 33, 33, 93, 32, 33, 105, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 263}, 
{297, 239, 38, 33, 35, 83, 83, 83, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 34, 34, 73, 73, 58, 73, 43, 33, 63, 33, 33, 43, 43, 43, 43, 43, 43, 83, 63, 33, 33, 93, 32, 33, 105, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 264}, 
{298, 239, 38, 33, 36, 183, 98, 98, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 34, 34, 73, 73, 68, 73, 48, 33, 63, 33, 33, 43, 43, 43, 43, 43, 43, 83, 63, 33, 33, 93, 32, 33, 105, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 265}, 
{299, 239, 38, 33, 36, 183, 98, 98, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 34, 34, 83, 83, 63, 68, 53, 33, 73, 33, 33, 43, 43, 43, 43, 43, 43, 83, 73, 33, 33, 93, 32, 33, 105, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 266}, 
{300, 239, 38, 33, 36, 183, 98, 98, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 34, 34, 83, 83, 63, 78, 53, 33, 73, 33, 33, 43, 43, 43, 43, 43, 43, 83, 73, 33, 33, 93, 32, 33, 105, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 267}, 
{301, 239, 38, 33, 38, 533, 128, 128, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 34, 34, 83, 83, 68, 78, 63, 33, 73, 33, 33, 43, 43, 43, 43, 43, 43, 83, 73, 33, 33, 93, 32, 33, 105, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 268}, 
{302, 239, 38, 33, 39, 783, 143, 143, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 34, 34, 93, 93, 68, 78, 63, 33, 83, 33, 33, 43, 43, 43, 43, 43, 43, 83, 83, 33, 33, 93, 32, 33, 105, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 269}, 
{303, 239, 38, 33, 39, 783, 143, 143, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 34, 34, 93, 93, 68, 73, 63, 33, 83, 33, 33, 43, 43, 43, 43, 43, 43, 83, 83, 33, 33, 93, 32, 33, 105, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 270}, 
{304, 240, 41, 33, 36, 183, 125, 125, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 34, 73, 73, 63, 78, 63, 33, 53, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 103, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 271}, 
{305, 240, 41, 33, 36, 183, 125, 125, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 34, 73, 73, 63, 78, 63, 33, 53, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 103, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 272}, 
{306, 240, 41, 33, 37, 333, 149, 149, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 34, 83, 83, 68, 78, 73, 33, 53, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 103, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 273}, 
{307, 240, 41, 33, 37, 333, 149, 149, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 34, 83, 83, 68, 78, 73, 33, 53, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 103, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 274}, 
{308, 240, 41, 33, 38, 533, 173, 173, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 34, 633, 633, 93, 73, 93, 33, 53, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 103, 33, 33, 33, 33, 33, 33, 33, 33, 33, 733, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 275}, 
{309, 240, 41, 33, 38, 533, 173, 173, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 34, 633, 633, 103, 103, 103, 33, 53, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 103, 33, 33, 33, 33, 33, 33, 33, 33, 33, 733, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 276}, 
{310, 240, 41, 33, 39, 783, 397, 397, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 34, 733, 733, 103, 103, 103, 33, 53, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 103, 33, 33, 33, 33, 33, 33, 33, 33, 33, 833, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 277}, 
{311, 240, 41, 33, 39, 783, 197, 197, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 34, 103, 103, 78, 78, 78, 133, 53, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 104, 33, 33, 33, 33, 33, 33, 33, 33, 33, 833, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 278}, 
{312, 240, 41, 33, 40, 1083, 221, 221, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 34, 833, 833, 103, 73, 103, 33, 53, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 104, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 279}, 
{313, 240, 41, 33, 41, 1433, 245, 245, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 39, 33, 33, 33, 33, 37, 34, 933, 933, 93, 83, 93, 33, 53, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 104, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 280}, 
{314, 241, 38, 33, 35, 83, 83, 83, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 40, 33, 33, 33, 33, 34, 33, 34, 83, 83, 58, 63, 58, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 133, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 281}, 
{315, 241, 38, 33, 35, 83, 83, 83, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 40, 33, 33, 33, 33, 34, 33, 34, 83, 83, 58, 63, 58, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 133, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 282}, 
{316, 241, 38, 33, 36, 183, 98, 98, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 40, 33, 33, 33, 33, 34, 33, 34, 83, 83, 63, 63, 63, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 233, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 283}, 
{317, 241, 38, 33, 36, 183, 98, 98, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 40, 33, 33, 33, 33, 34, 33, 34, 83, 83, 63, 63, 63, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 233, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 284}, 
{318, 241, 38, 33, 37, 333, 113, 113, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 40, 33, 33, 33, 33, 34, 33, 34, 93, 93, 68, 68, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 285}, 
{319, 241, 39, 33, 38, 533, 143, 143, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 40, 33, 33, 33, 33, 34, 33, 34, 93, 93, 73, 73, 73, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 286}, 
{320, 241, 40, 33, 39, 783, 179, 179, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 40, 33, 33, 33, 33, 34, 33, 34, 93, 93, 73, 73, 73, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 287}, 
{321, 241, 40, 33, 40, 1083, 200, 200, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 40, 33, 33, 33, 33, 34, 33, 34, 103, 103, 78, 73, 78, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 288}, 
{322, 241, 40, 33, 41, 1433, 221, 221, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 40, 33, 33, 33, 33, 34, 33, 34, 103, 103, 78, 73, 78, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 289}, 
{323, 241, 40, 33, 42, 1833, 242, 242, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 40, 33, 33, 33, 33, 34, 33, 34, 833, 833, 83, 73, 103, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 290}, 
{324, 242, 38, 33, 36, 183, 133, 133, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 133, 133, 83, 53, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 72, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 291}, 
{325, 242, 38, 33, 37, 333, 113, 113, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 103, 103, 68, 73, 73, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 72, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 292}, 
{326, 242, 38, 33, 37, 333, 113, 113, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 113, 113, 73, 73, 83, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 72, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 293}, 
{327, 242, 38, 33, 37, 333, 113, 113, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 113, 113, 78, 78, 88, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 72, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 294}, 
{328, 242, 38, 33, 38, 533, 128, 128, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 933, 933, 73, 78, 88, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 72, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 295}, 
{329, 242, 38, 33, 38, 533, 128, 128, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 933, 933, 78, 78, 88, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 72, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 296}, 
{330, 242, 38, 33, 39, 783, 143, 143, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 123, 123, 83, 78, 88, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 72, 33, 33, 33, 33, 33, 33, 33, 33, 33, 733, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 297}, 
{331, 242, 38, 33, 40, 1083, 158, 158, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 123, 123, 83, 83, 88, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 72, 33, 33, 33, 33, 33, 33, 33, 33, 33, 833, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 298}, 
{332, 242, 38, 33, 41, 1433, 173, 173, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 933, 933, 83, 73, 88, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 72, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 299}, 
{333, 242, 38, 33, 41, 1433, 173, 173, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 37, 33, 33, 34, 1023, 1023, 88, 73, 88, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 72, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 300}, 
{334, 227, 40, 33, 35, 83, 95, 95, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 63, 63, 58, 68, 58, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 301}, 
{335, 227, 40, 33, 35, 83, 95, 95, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 63, 63, 58, 68, 58, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 302}, 
{336, 227, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 303}, 
{337, 227, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 304}, 
{338, 227, 40, 33, 37, 333, 137, 137, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 305}, 
{339, 227, 40, 33, 38, 533, 158, 158, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 83, 83, 68, 78, 73, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 306}, 
{340, 227, 40, 33, 39, 783, 179, 179, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 83, 83, 73, 78, 73, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 307}, 
{341, 227, 40, 33, 39, 783, 179, 179, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 83, 83, 73, 78, 83, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 308}, 
{342, 227, 40, 33, 40, 1083, 200, 200, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 93, 93, 78, 78, 83, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 309}, 
{343, 227, 40, 33, 41, 1433, 221, 221, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 93, 93, 83, 78, 83, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 733, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 310}, 
{344, 247, 39, 33, 43, 2283, 233, 233, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 38, 34, 1033, 1033, 103, 63, 123, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 108, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 311}, 
{345, 247, 39, 33, 43, 2283, 233, 233, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 38, 34, 1033, 1033, 103, 63, 123, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 108, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 312}, 
{346, 247, 39, 33, 43, 2283, 233, 233, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 38, 34, 1033, 1033, 103, 63, 123, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 108, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 313}, 
{347, 247, 39, 33, 43, 2283, 233, 233, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 38, 34, 1033, 1033, 103, 63, 123, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 108, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 314}, 
{348, 247, 39, 33, 43, 2283, 233, 233, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 38, 34, 1033, 1033, 103, 63, 123, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 108, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 315}, 
{349, 247, 39, 33, 43, 2283, 233, 233, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 38, 34, 1033, 1033, 103, 63, 123, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 108, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 316}, 
{350, 247, 39, 33, 43, 2283, 233, 233, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 38, 34, 1033, 1033, 103, 63, 123, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 108, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 317}, 
{351, 247, 39, 33, 43, 2283, 233, 233, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 38, 34, 1033, 1033, 103, 63, 123, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 108, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 318}, 
{352, 247, 39, 33, 43, 2283, 233, 233, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 40, 33, 33, 33, 33, 38, 34, 1033, 1033, 103, 63, 123, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 108, 33, 33, 33, 33, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 319}, 
{63, 223, 42, 33, 68, 56533, 998, 998, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 43, 33, 33, 33, 33, 33, 33, 33, 34, 1032, 1032, 130, 115, 125, 33, 33, 33, 33, 43, 132, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 69, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 320}, 
{85, 223, 39, 33, 49, 9283, 341, 341, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 43, 33, 33, 33, 33, 33, 33, 33, 34, 623, 623, 108, 93, 105, 33, 33, 33, 33, 108, 89, 76, 67, 87, 43, 110, 33, 33, 33, 93, 32, 33, 69, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 321}, 
{99, 223, 41, 34, 41, 1433, 245, 245, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 43, 33, 33, 33, 33, 33, 33, 33, 33, 113, 113, 79, 93, 97, 33, 33, 33, 33, 73, 73, 73, 73, 63, 43, 83, 33, 33, 33, 93, 32, 33, 69, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 322}, 
{105, 223, 42, 33, 63, 52033, 863, 863, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 43, 33, 33, 33, 33, 33, 33, 33, 34, 323, 323, 123, 123, 123, 33, 33, 33, 33, 123, 123, 123, 123, 123, 123, 83, 33, 33, 33, 93, 32, 33, 69, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 323}, 
{106, 223, 38, 33, 43, 2283, 203, 203, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 43, 33, 33, 33, 33, 33, 33, 33, 34, 183, 183, 83, 83, 83, 33, 33, 33, 33, 83, 83, 83, 83, 83, 43, 83, 33, 33, 33, 93, 32, 33, 69, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 324}, 
{107, 223, 38, 33, 43, 2283, 203, 203, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 43, 33, 33, 33, 33, 33, 33, 33, 34, 183, 183, 83, 83, 83, 33, 33, 33, 33, 83, 83, 83, 83, 83, 43, 83, 33, 33, 33, 93, 32, 33, 69, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 325}, 
{108, 223, 38, 33, 43, 2283, 203, 203, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 43, 33, 33, 33, 33, 33, 33, 33, 34, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 83, 33, 33, 33, 83, 32, 33, 69, 33, 33, 33, 33, 33, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 326}, 
{63, 223, 42, 33, 68, 56533, 998, 998, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 43, 33, 33, 33, 33, 33, 33, 33, 34, 1032, 1032, 130, 115, 125, 33, 33, 33, 33, 43, 132, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 69, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 327}, 
{63, 223, 42, 33, 68, 56533, 998, 998, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 43, 33, 33, 33, 33, 33, 33, 33, 34, 1032, 1032, 130, 115, 125, 33, 33, 33, 33, 43, 132, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 69, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 328}, 
{63, 223, 42, 33, 68, 56533, 998, 998, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 43, 33, 33, 33, 33, 33, 33, 33, 34, 1032, 1032, 130, 115, 125, 33, 33, 33, 33, 43, 132, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 69, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 329}, 
{337, 224, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 330}, 
{337, 224, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 331}, 
{337, 224, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 332}, 
{337, 224, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 333}, 
{337, 224, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 334}, 
{337, 224, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 335}, 
{337, 224, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 336}, 
{337, 224, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 337}, 
{337, 224, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 338}, 
{337, 224, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 339}, 
{337, 225, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 70, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 340}, 
{337, 225, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 70, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 341}, 
{337, 225, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 70, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 342}, 
{337, 225, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 70, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 343}, 
{337, 225, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 70, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 344}, 
{337, 225, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 70, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 345}, 
{337, 225, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 70, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 346}, 
{337, 225, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 70, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 347}, 
{337, 225, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 70, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 348}, 
{337, 225, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 70, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 349}, 
{337, 226, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 350}, 
{337, 226, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 351}, 
{337, 226, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 352}, 
{337, 226, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 353}, 
{337, 226, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 354}, 
{337, 226, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 355}, 
{337, 226, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 356}, 
{337, 226, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 357}, 
{337, 226, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 73, 73, 63, 73, 93, 83, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 358}, 
{337, 226, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 33, 33, 33, 33, 34, 1433, 1433, 93, 73, 93, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 56, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 359}, 
{337, 228, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 360}, 
{337, 228, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 361}, 
{337, 228, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 362}, 
{337, 228, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 363}, 
{337, 228, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 364}, 
{337, 228, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 365}, 
{337, 228, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 49, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 366}, 
{337, 228, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 45, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 67, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 367}, 
{337, 228, 40, 33, 36, 183, 316, 316, 33, 33, 123, 33, 32, 32, 33, 33, 45, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 34, 1433, 1433, 113, 73, 93, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 67, 33, 33, 33, 33, 33, 33, 33, 33, 33, 833, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 368}, 
{337, 228, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 45, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 67, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 369}, 
{337, 229, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 64, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 370}, 
{337, 229, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 65, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 371}, 
{337, 229, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 65, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 372}, 
{337, 229, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 65, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 373}, 
{337, 229, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 65, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 374}, 
{337, 229, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 65, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 375}, 
{337, 229, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 38, 33, 33, 33, 33, 33, 33, 33, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 65, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 376}, 
{337, 229, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 38, 33, 33, 33, 33, 33, 33, 33, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 65, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 377}, 
{337, 229, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 34, 73, 73, 63, 73, 68, 113, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 65, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 378}, 
{337, 229, 40, 33, 36, 183, 316, 316, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 34, 1433, 1433, 63, 103, 113, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 65, 33, 33, 33, 33, 33, 33, 33, 33, 33, 833, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 379}, 
{337, 230, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 63, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 380}, 
{337, 230, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 63, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 381}, 
{337, 230, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 63, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 382}, 
{337, 230, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 63, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 383}, 
{337, 230, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 63, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 384}, 
{337, 230, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 63, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 385}, 
{337, 230, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 63, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 386}, 
{337, 230, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 34, 73, 73, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 63, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 387}, 
{337, 230, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 34, 73, 73, 63, 73, 113, 113, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 63, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 388}, 
{337, 230, 40, 33, 36, 183, 316, 316, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 34, 1433, 1433, 83, 73, 113, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 63, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 389}, 
{337, 236, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 433, 433, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 390}, 
{337, 236, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 433, 433, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 391}, 
{337, 236, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 433, 433, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 392}, 
{337, 236, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 433, 433, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 393}, 
{337, 236, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 433, 433, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 394}, 
{337, 236, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 433, 433, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 395}, 
{337, 236, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 433, 433, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 396}, 
{337, 236, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 433, 433, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 397}, 
{337, 236, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 433, 433, 63, 73, 113, 113, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 398}, 
{337, 236, 40, 33, 36, 183, 316, 316, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 1433, 1433, 93, 73, 93, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 833, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 399}, 
{337, 243, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 45, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 73, 73, 73, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 400}, 
{337, 243, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 45, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 433, 433, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 46, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 401}, 
{337, 243, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 45, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 433, 433, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 46, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 402}, 
{337, 243, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 45, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 433, 433, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 46, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 403}, 
{337, 243, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 45, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 433, 433, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 46, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 404}, 
{337, 243, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 45, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 433, 433, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 46, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 405}, 
{337, 243, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 45, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 433, 433, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 46, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 406}, 
{337, 243, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 45, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 433, 433, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 46, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 407}, 
{337, 243, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 45, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 433, 433, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 46, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 408}, 
{337, 243, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 45, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 433, 433, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 46, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 409}, 
{337, 245, 40, 33, 36, 183, 416, 416, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 573, 573, 63, 73, 113, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 113, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 410}, 
{337, 245, 40, 33, 36, 183, 616, 616, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 573, 573, 63, 73, 113, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 113, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 411}, 
{337, 245, 40, 33, 36, 183, 316, 316, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 573, 573, 63, 73, 113, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 113, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 412}, 
{337, 245, 40, 33, 36, 183, 416, 416, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 573, 573, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 113, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 413}, 
{337, 245, 40, 33, 36, 183, 416, 416, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 573, 573, 63, 73, 113, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 113, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 414}, 
{337, 245, 40, 33, 36, 183, 416, 416, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 573, 573, 63, 73, 113, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 113, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 415}, 
{337, 245, 40, 33, 36, 183, 416, 416, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 573, 573, 63, 73, 113, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 113, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 416}, 
{337, 245, 40, 33, 36, 183, 416, 416, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 573, 573, 63, 73, 113, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 113, 33, 33, 93, 32, 33, 107, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 417}, 
{337, 245, 40, 33, 36, 183, 416, 416, 33, 33, 123, 33, 32, 32, 33, 41, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 34, 573, 573, 63, 73, 113, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 113, 33, 33, 93, 32, 33, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 418}, 
{337, 245, 40, 33, 36, 183, 533, 533, 33, 33, 123, 33, 32, 32, 33, 41, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1033, 1033, 93, 73, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 142, 33, 33, 33, 33, 33, 33, 33, 33, 33, 733, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 419}, 
{337, 246, 40, 33, 36, 183, 616, 616, 33, 33, 123, 33, 32, 32, 33, 45, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1173, 1173, 113, 73, 168, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 42, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 420}, 
{337, 246, 40, 33, 36, 183, 616, 616, 33, 33, 123, 33, 32, 32, 33, 45, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1173, 1173, 113, 73, 168, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 42, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 421}, 
{337, 246, 40, 33, 36, 183, 416, 616, 33, 33, 123, 33, 32, 32, 33, 45, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1173, 1173, 113, 73, 168, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 42, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 422}, 
{337, 246, 40, 33, 36, 183, 616, 616, 33, 33, 123, 33, 32, 32, 33, 45, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1173, 1173, 113, 73, 168, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 42, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 423}, 
{337, 246, 40, 33, 36, 183, 616, 616, 33, 33, 123, 33, 32, 32, 33, 45, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1173, 1173, 113, 73, 168, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 42, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 424}, 
{337, 246, 40, 33, 36, 183, 616, 616, 33, 33, 123, 33, 32, 32, 33, 45, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1173, 1173, 113, 73, 168, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 42, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 425}, 
{337, 246, 40, 33, 36, 183, 616, 616, 33, 33, 123, 33, 32, 32, 33, 45, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1173, 1173, 113, 73, 168, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 42, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 426}, 
{337, 246, 40, 33, 36, 183, 616, 616, 33, 33, 123, 33, 32, 32, 33, 45, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1173, 1173, 113, 73, 168, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 42, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 427}, 
{337, 246, 40, 33, 36, 183, 616, 616, 33, 33, 123, 33, 32, 32, 33, 45, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1173, 1173, 113, 73, 168, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 42, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 428}, 
{337, 246, 40, 33, 36, 183, 616, 616, 33, 33, 123, 33, 32, 32, 33, 45, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1173, 1173, 113, 73, 168, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 42, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 429}, 
{337, 248, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 433, 433, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 133, 33, 33, 93, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 430}, 
{337, 248, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 433, 433, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 133, 33, 33, 93, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 431}, 
{337, 248, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 433, 433, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 133, 33, 33, 93, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 432}, 
{337, 248, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 433, 433, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 133, 33, 33, 93, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 433}, 
{337, 248, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 433, 433, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 133, 33, 33, 93, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 434}, 
{337, 248, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 433, 433, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 133, 33, 33, 93, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 435}, 
{337, 248, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 433, 433, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 133, 33, 33, 93, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 436}, 
{337, 248, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 433, 433, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 133, 33, 33, 93, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 437}, 
{337, 248, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 433, 433, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 133, 33, 33, 93, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 438}, 
{337, 248, 40, 33, 36, 183, 116, 116, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 37, 33, 33, 33, 33, 38, 34, 433, 433, 63, 73, 68, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 133, 33, 33, 93, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 439}, 
{337, 249, 40, 33, 36, 183, 316, 316, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 44, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 34, 1433, 1433, 93, 73, 93, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 133, 33, 33, 93, 32, 33, 102, 33, 33, 33, 33, 33, 33, 33, 33, 33, 1032, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 440}, 
{323, 241, 40, 33, 42, 1833, 242, 242, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 40, 33, 33, 33, 33, 34, 33, 34, 113, 113, 83, 73, 83, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 92, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 441}, 
{323, 241, 40, 33, 42, 1833, 242, 242, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 40, 33, 33, 33, 33, 34, 33, 34, 113, 113, 83, 73, 83, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 92, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 442}, 
{323, 241, 40, 33, 42, 1833, 242, 242, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 40, 33, 33, 33, 33, 34, 33, 34, 113, 113, 83, 73, 83, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 92, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 443}, 
{323, 241, 40, 33, 42, 1833, 242, 242, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 40, 33, 33, 33, 33, 34, 33, 34, 113, 113, 83, 73, 83, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 92, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 444}, 
{323, 241, 40, 33, 42, 1833, 83, 83, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 40, 33, 33, 33, 33, 34, 33, 34, 73, 73, 63, 61, 63, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 84, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 445}, 
{323, 241, 40, 33, 42, 1833, 83, 83, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 40, 33, 33, 33, 33, 34, 33, 34, 73, 73, 63, 59, 63, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 84, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 446}, 
{323, 241, 40, 33, 42, 1833, 242, 242, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 40, 33, 33, 33, 33, 34, 33, 34, 833, 833, 103, 73, 103, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 447}, 
{323, 241, 40, 33, 42, 1833, 242, 242, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 40, 33, 33, 33, 33, 34, 33, 34, 833, 833, 103, 73, 103, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 448}, 
{323, 241, 40, 33, 42, 1833, 242, 242, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 40, 33, 33, 33, 33, 34, 33, 34, 833, 833, 113, 73, 113, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 449}, 
{323, 241, 40, 33, 42, 1833, 242, 242, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 40, 33, 33, 33, 33, 34, 33, 34, 833, 833, 113, 73, 113, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 96, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 450}, 
{337, 224, 40, 33, 36, 183, 316, 316, 33, 33, 123, 33, 32, 32, 33, 33, 42, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 34, 433, 433, 93, 93, 93, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 63, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 451}, 
{337, 236, 40, 33, 36, 183, 316, 316, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 41, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 34, 433, 433, 113, 73, 93, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 104, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 452}, 
{337, 228, 40, 33, 36, 183, 416, 416, 33, 33, 123, 33, 32, 32, 33, 33, 45, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 34, 433, 433, 103, 73, 103, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 65, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 453}, 
{337, 225, 40, 33, 36, 183, 416, 416, 33, 33, 123, 33, 32, 32, 33, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 34, 433, 433, 103, 93, 103, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 65, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 454}, 
{238, 232, 39, 33, 37, 333, 125, 125, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 39, 33, 33, 33, 33, 34, 33, 33, 34, 463, 463, 61, 63, 58, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 68, 33, 33, 33, 33, 33, 33, 33, 33, 33, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 455}, 
{238, 232, 39, 33, 37, 333, 125, 125, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 39, 33, 33, 33, 33, 34, 33, 33, 34, 463, 463, 61, 63, 58, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 68, 33, 33, 33, 33, 33, 33, 33, 33, 33, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 456}, 
{238, 232, 39, 33, 37, 333, 125, 125, 33, 33, 123, 33, 32, 32, 33, 33, 41, 33, 33, 33, 33, 39, 33, 33, 33, 33, 34, 33, 33, 34, 463, 463, 61, 63, 58, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 68, 33, 33, 33, 33, 33, 33, 33, 33, 33, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 457}, 
{313, 240, 41, 33, 41, 1433, 633, 633, 33, 33, 123, 33, 32, 32, 33, 42, 33, 33, 42, 33, 39, 33, 33, 39, 33, 37, 33, 33, 37, 34, 3033, 3033, 133, 113, 133, 33, 53, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 59, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 37, 34, 32, 32, 36, 36, 33, 33, 458}, 
{313, 240, 41, 33, 41, 1433, 645, 645, 33, 33, 123, 33, 32, 32, 33, 42, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1933, 1933, 133, 123, 133, 33, 53, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 59, 33, 33, 33, 33, 33, 33, 33, 33, 33, 833, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 37, 32, 32, 35, 35, 33, 33, 459}, 
{323, 241, 40, 33, 42, 1833, 242, 242, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 40, 33, 33, 33, 33, 34, 33, 34, 833, 833, 83, 73, 83, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 92, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 460}, 
{337, 243, 40, 33, 36, 183, 333, 333, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 833, 833, 103, 83, 103, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 46, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 461}, 
{337, 243, 40, 33, 36, 183, 333, 333, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 833, 833, 103, 83, 103, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 46, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 462}, 
{337, 243, 40, 33, 36, 183, 333, 333, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 833, 833, 103, 83, 103, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 46, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 463}, 
{337, 243, 40, 33, 36, 183, 333, 333, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 33, 33, 33, 46, 33, 33, 33, 33, 38, 34, 833, 833, 103, 83, 103, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 46, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 464}, 
{337, 243, 40, 33, 36, 183, 333, 333, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 833, 833, 103, 83, 103, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 46, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 465}, 
{337, 243, 40, 33, 36, 183, 333, 333, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 833, 833, 103, 83, 103, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 46, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 466}, 
{337, 243, 40, 33, 36, 183, 333, 333, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 833, 833, 103, 83, 103, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 46, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 467}, 
{337, 243, 40, 33, 36, 183, 333, 333, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 833, 833, 103, 83, 103, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 46, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 468}, 
{337, 243, 40, 33, 36, 183, 333, 416, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 34, 833, 833, 103, 83, 103, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 46, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 469}, 
{337, 243, 40, 33, 36, 183, 416, 416, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 833, 833, 103, 83, 103, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 46, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 470}, 
{337, 243, 40, 33, 36, 183, 416, 416, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 833, 833, 103, 83, 103, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 46, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 471}, 
{337, 243, 40, 33, 36, 183, 333, 333, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 833, 833, 103, 83, 103, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 46, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 472}, 
{337, 243, 40, 33, 36, 183, 333, 333, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 833, 833, 103, 83, 103, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 46, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 473}, 
{337, 243, 40, 33, 36, 183, 333, 333, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 833, 833, 103, 73, 103, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 46, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 474}, 
{337, 243, 40, 33, 36, 183, 333, 333, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 833, 833, 103, 73, 103, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 46, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 475}, 
{337, 243, 40, 33, 36, 183, 333, 333, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 833, 833, 93, 73, 103, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 46, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 476}, 
{337, 243, 40, 33, 36, 183, 416, 416, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 833, 833, 103, 73, 103, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 46, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 477}, 
{337, 243, 40, 33, 36, 183, 416, 416, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 833, 833, 103, 73, 103, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 46, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 478}, 
{337, 243, 40, 33, 36, 183, 533, 533, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1033, 1033, 133, 73, 233, 33, 33, 33, 133, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 55, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 479}, 
{337, 243, 40, 33, 36, 183, 533, 533, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1033, 1033, 133, 73, 233, 33, 33, 33, 133, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 55, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 480}, 
{337, 243, 40, 33, 36, 183, 533, 533, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1033, 1033, 133, 73, 233, 33, 33, 33, 133, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 55, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 481}, 
{337, 243, 40, 33, 36, 183, 533, 533, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1033, 1033, 133, 73, 233, 33, 33, 33, 133, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 55, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 482}, 
{337, 243, 40, 33, 36, 183, 533, 533, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1033, 1033, 133, 73, 233, 33, 33, 33, 133, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 55, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 483}, 
{337, 243, 40, 33, 36, 183, 533, 533, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1033, 1033, 133, 73, 233, 33, 33, 33, 133, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 55, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 484}, 
{337, 243, 40, 33, 36, 183, 533, 533, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1033, 1033, 133, 73, 233, 33, 33, 33, 133, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 55, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 485}, 
{337, 243, 40, 33, 36, 183, 533, 533, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1033, 1033, 133, 73, 233, 33, 33, 33, 133, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 55, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 486}, 
{337, 243, 40, 33, 36, 183, 533, 533, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1033, 1033, 133, 73, 233, 33, 33, 33, 133, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 55, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 487}, 
{337, 243, 40, 33, 36, 183, 533, 533, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1033, 1033, 133, 73, 233, 33, 33, 33, 133, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 55, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 488}, 
{337, 243, 40, 33, 36, 183, 533, 533, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1033, 1033, 133, 73, 233, 33, 33, 33, 133, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 55, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 489}, 
{337, 243, 40, 33, 36, 183, 533, 533, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 44, 33, 33, 33, 34, 1033, 1033, 133, 73, 233, 33, 33, 33, 133, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 55, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 490}, 
{337, 243, 40, 33, 36, 183, 533, 533, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1033, 1033, 133, 73, 233, 33, 33, 33, 133, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 55, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 491}, 
{337, 243, 40, 33, 36, 183, 533, 533, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1033, 1033, 133, 73, 233, 33, 33, 33, 133, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 55, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 492}, 
{337, 243, 40, 33, 36, 183, 533, 533, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1033, 1033, 133, 73, 233, 33, 33, 33, 133, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 55, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 493}, 
{337, 243, 40, 33, 36, 183, 533, 533, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1033, 1033, 133, 73, 233, 33, 33, 33, 133, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 55, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 494}, 
{337, 243, 40, 33, 36, 183, 533, 533, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1033, 1033, 133, 73, 233, 33, 33, 33, 133, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 55, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 495}, 
{337, 243, 40, 33, 36, 183, 533, 533, 33, 33, 123, 33, 32, 32, 33, 44, 33, 33, 33, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 34, 1033, 1033, 133, 73, 233, 33, 33, 33, 133, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 55, 33, 33, 33, 33, 33, 33, 33, 33, 33, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 496}, 
{323, 126, 40, 33, 42, 1833, 433, 433, 33, 33, 123, 33, 32, 32, 33, 43, 33, 33, 33, 33, 43, 33, 33, 33, 33, 36, 33, 33, 33, 34, 1033, 1033, 113, 153, 103, 33, 33, 33, 33, 43, 43, 43, 43, 133, 43, 83, 33, 33, 33, 93, 32, 33, 44, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 68, 32, 32, 32, 53, 33, 33, 33, 497}, 
{323, 126, 40, 33, 42, 1833, 433, 433, 33, 33, 123, 33, 32, 32, 33, 43, 33, 33, 33, 33, 43, 33, 33, 33, 33, 36, 33, 33, 33, 34, 1033, 1033, 113, 153, 103, 33, 33, 33, 33, 43, 43, 43, 43, 133, 43, 83, 33, 33, 33, 93, 32, 33, 44, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 68, 32, 32, 32, 53, 33, 33, 33, 498}, 
{323, 126, 40, 33, 42, 1833, 433, 433, 33, 33, 123, 33, 32, 32, 33, 43, 33, 33, 33, 33, 43, 33, 33, 33, 33, 36, 33, 33, 33, 34, 1033, 1033, 113, 153, 103, 33, 33, 33, 33, 43, 43, 43, 43, 133, 43, 83, 33, 33, 33, 93, 32, 33, 44, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 68, 32, 32, 32, 53, 33, 33, 33, 499}, 
{323, 126, 40, 33, 42, 1833, 433, 433, 33, 33, 123, 33, 32, 32, 33, 43, 33, 33, 33, 33, 43, 33, 33, 33, 33, 36, 33, 33, 33, 34, 1033, 1033, 113, 153, 103, 33, 33, 33, 33, 43, 43, 43, 43, 133, 43, 83, 33, 33, 33, 93, 32, 33, 44, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 68, 32, 32, 32, 53, 33, 33, 33, 500}, 
{323, 126, 40, 33, 42, 1833, 433, 433, 33, 33, 123, 33, 32, 32, 33, 43, 33, 33, 33, 33, 43, 33, 33, 33, 33, 36, 33, 33, 33, 34, 1033, 1033, 113, 153, 103, 33, 33, 33, 33, 43, 43, 43, 43, 133, 43, 83, 33, 33, 33, 93, 32, 33, 44, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 68, 32, 32, 32, 53, 33, 33, 33, 501}, 
{323, 126, 40, 33, 42, 1833, 433, 433, 33, 33, 123, 33, 32, 32, 33, 43, 33, 33, 33, 33, 43, 33, 33, 33, 33, 36, 33, 33, 33, 34, 1033, 1033, 113, 153, 103, 33, 33, 33, 33, 43, 43, 43, 43, 133, 43, 83, 33, 33, 33, 93, 32, 33, 44, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 68, 32, 32, 32, 53, 33, 33, 33, 502}, 
{323, 126, 40, 33, 42, 1833, 433, 433, 33, 33, 123, 33, 32, 32, 33, 43, 33, 33, 33, 33, 43, 33, 33, 33, 33, 36, 33, 33, 33, 34, 1033, 1033, 113, 153, 103, 33, 33, 33, 33, 43, 43, 43, 43, 133, 43, 83, 33, 33, 33, 93, 32, 33, 44, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 68, 32, 32, 32, 53, 33, 33, 33, 503}, 
{323, 126, 40, 33, 42, 1833, 433, 433, 33, 33, 123, 33, 32, 32, 33, 43, 33, 33, 33, 33, 43, 33, 33, 33, 33, 36, 33, 33, 33, 34, 1033, 1033, 113, 153, 103, 33, 33, 33, 33, 43, 43, 43, 43, 133, 43, 83, 33, 33, 33, 93, 32, 33, 44, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 68, 32, 32, 32, 53, 33, 33, 33, 504}, 
{323, 126, 40, 33, 42, 1833, 433, 433, 33, 33, 123, 33, 32, 32, 33, 43, 33, 33, 33, 33, 43, 33, 33, 33, 33, 36, 33, 33, 33, 34, 1033, 1033, 113, 153, 103, 33, 33, 33, 33, 43, 43, 43, 43, 133, 43, 83, 33, 33, 33, 93, 32, 33, 44, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 68, 32, 32, 32, 53, 33, 33, 33, 505}, 
{323, 126, 40, 33, 42, 1833, 433, 433, 33, 33, 123, 33, 32, 32, 33, 43, 33, 33, 33, 33, 43, 33, 33, 33, 33, 36, 33, 33, 33, 34, 1033, 1033, 113, 153, 103, 33, 33, 33, 33, 43, 43, 43, 43, 133, 43, 83, 33, 33, 33, 93, 32, 33, 44, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 68, 32, 32, 32, 53, 33, 33, 33, 506}, 
{323, 126, 40, 33, 42, 1833, 433, 433, 33, 33, 123, 33, 32, 32, 33, 43, 33, 33, 33, 33, 43, 33, 33, 33, 33, 36, 33, 33, 33, 34, 1033, 1033, 113, 153, 103, 33, 33, 33, 33, 43, 43, 43, 43, 133, 43, 83, 33, 33, 33, 93, 32, 33, 44, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 68, 32, 32, 32, 53, 33, 33, 33, 507}, 
{323, 126, 40, 33, 42, 1833, 433, 433, 33, 33, 123, 33, 32, 32, 33, 43, 33, 33, 33, 33, 43, 33, 33, 33, 33, 36, 33, 33, 33, 34, 1033, 1033, 113, 153, 103, 33, 33, 33, 33, 43, 43, 43, 43, 133, 43, 83, 33, 33, 33, 93, 32, 33, 44, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 68, 32, 32, 32, 53, 33, 33, 33, 508}, 
{323, 126, 40, 33, 42, 1833, 433, 433, 33, 33, 123, 33, 32, 32, 33, 43, 33, 33, 33, 33, 43, 33, 33, 33, 33, 36, 33, 33, 33, 34, 1033, 1033, 113, 153, 103, 33, 33, 33, 33, 43, 43, 43, 43, 133, 43, 83, 33, 33, 33, 93, 32, 33, 44, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 68, 32, 32, 32, 53, 33, 33, 33, 509}, 
{323, 126, 40, 33, 42, 1833, 433, 433, 33, 33, 123, 33, 32, 32, 33, 43, 33, 33, 33, 33, 43, 33, 33, 33, 33, 36, 33, 33, 33, 34, 1033, 1033, 113, 153, 103, 33, 33, 33, 33, 43, 43, 43, 43, 133, 43, 83, 33, 33, 33, 93, 32, 33, 44, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 68, 32, 32, 32, 53, 33, 33, 33, 510}, 
{323, 126, 40, 33, 42, 1833, 433, 433, 33, 33, 123, 33, 32, 32, 33, 43, 33, 33, 33, 33, 43, 33, 33, 33, 33, 36, 33, 33, 33, 34, 1033, 1033, 113, 153, 103, 33, 33, 33, 33, 43, 43, 43, 43, 133, 43, 83, 33, 33, 33, 93, 32, 33, 44, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 68, 32, 32, 32, 53, 33, 33, 33, 511}, 
{323, 126, 40, 33, 42, 1833, 433, 433, 33, 33, 123, 33, 32, 32, 33, 43, 33, 33, 33, 33, 43, 33, 33, 33, 33, 36, 33, 33, 33, 34, 1033, 1033, 113, 153, 103, 33, 33, 33, 33, 43, 43, 43, 43, 133, 43, 83, 33, 33, 33, 93, 32, 33, 44, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 68, 32, 32, 32, 53, 33, 33, 33, 512}, 
{323, 126, 40, 33, 42, 1833, 433, 433, 33, 33, 123, 33, 32, 32, 33, 43, 33, 33, 33, 33, 43, 33, 33, 33, 33, 36, 33, 33, 33, 34, 1033, 1033, 113, 153, 103, 33, 33, 33, 33, 43, 43, 43, 43, 133, 43, 83, 33, 33, 33, 93, 32, 33, 44, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 68, 32, 32, 32, 53, 33, 33, 33, 513}, 
{323, 126, 40, 33, 42, 1833, 433, 433, 33, 33, 123, 33, 32, 32, 33, 43, 33, 33, 33, 33, 43, 33, 33, 33, 33, 36, 33, 33, 33, 34, 1033, 1033, 113, 153, 103, 33, 33, 33, 33, 43, 43, 43, 43, 133, 43, 83, 33, 33, 33, 93, 32, 33, 44, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 68, 32, 32, 32, 53, 33, 33, 33, 514}, 
{323, 126, 40, 33, 42, 1833, 433, 433, 33, 33, 123, 33, 32, 32, 33, 43, 33, 33, 33, 33, 43, 33, 33, 33, 33, 36, 33, 33, 33, 34, 1033, 1033, 113, 153, 103, 33, 33, 33, 33, 43, 43, 43, 43, 133, 43, 83, 33, 33, 33, 93, 32, 33, 44, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 68, 32, 32, 32, 53, 33, 33, 33, 515}, 
{323, 250, 40, 33, 42, 1833, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 145, 33, 33, 33, 33, 33, 33, 33, 33, 33, 1032, 33, 33, 33, 33, 33, 33, 33, 33, 33, 41, 32, 32, 32, 38, 33, 33, 33, 516}, 
{323, 250, 40, 33, 42, 1833, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 41, 32, 32, 32, 38, 33, 33, 33, 517}, 
{323, 250, 40, 33, 42, 1833, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 41, 32, 32, 32, 36, 33, 33, 33, 518}, 
{323, 250, 40, 33, 42, 1833, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 41, 32, 32, 32, 36, 33, 33, 33, 519}, 
{323, 250, 40, 33, 42, 1833, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 520}, 
{323, 250, 40, 33, 42, 1833, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 521}, 
{323, 250, 40, 33, 42, 1833, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 522}, 
{323, 250, 40, 33, 42, 1833, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 523}, 
{323, 250, 40, 33, 42, 1833, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 524}, 
{323, 250, 40, 33, 42, 1833, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 525}, 
{323, 250, 40, 33, 42, 1833, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 526}, 
{323, 250, 40, 33, 42, 1833, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 527}, 
{323, 250, 40, 33, 42, 1833, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 528}, 
{323, 250, 40, 33, 42, 1833, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 529}, 
{323, 250, 40, 33, 42, 1833, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 530}, 
{323, 250, 40, 33, 42, 1833, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 531}, 
{323, 250, 40, 33, 42, 1833, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 532}, 
{323, 250, 40, 33, 42, 1833, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 533}, 
{323, 250, 40, 33, 42, 1833, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 534}, 
{323, 250, 40, 33, 42, 1833, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 535}, 
{323, 250, 40, 33, 42, 1833, 533, 533, 33, 33, 123, 33, 32, 32, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 34, 1533, 1533, 133, 103, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 74, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 536}, 
{323, 252, 40, 33, 42, 1833, 633, 633, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 34, 2033, 2033, 153, 113, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 95, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 537}, 
{323, 252, 40, 33, 42, 1833, 633, 633, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 34, 2033, 2033, 153, 113, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 95, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 538}, 
{323, 252, 40, 33, 42, 1833, 633, 633, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 34, 2033, 2033, 153, 113, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 95, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 539}, 
{323, 252, 40, 33, 42, 1833, 633, 633, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 34, 2033, 2033, 153, 113, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 95, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 540}, 
{323, 252, 40, 33, 42, 1833, 633, 633, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 34, 2033, 2033, 153, 113, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 541}, 
{323, 252, 40, 33, 42, 1833, 633, 633, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 34, 2033, 2033, 153, 113, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 95, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 542}, 
{323, 252, 40, 33, 42, 1833, 633, 633, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 34, 2033, 2033, 153, 113, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 95, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 543}, 
{323, 252, 40, 33, 42, 1833, 633, 633, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 34, 2033, 2033, 153, 113, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 95, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 544}, 
{323, 252, 40, 33, 42, 1833, 633, 633, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 34, 2033, 2033, 153, 113, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 95, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 545}, 
{323, 252, 40, 33, 42, 1833, 633, 633, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 34, 2033, 2033, 153, 113, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 95, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 546}, 
{323, 252, 40, 33, 42, 1833, 633, 633, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 34, 2033, 2033, 153, 113, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 95, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 547}, 
{323, 252, 40, 33, 42, 1833, 633, 633, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 34, 2033, 2033, 153, 113, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 95, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 548}, 
{323, 252, 40, 33, 42, 1833, 633, 633, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 34, 2033, 2033, 153, 113, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 95, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 549}, 
{323, 252, 40, 33, 42, 1833, 633, 633, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 34, 2033, 2033, 153, 113, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 95, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 550}, 
{323, 252, 40, 33, 42, 1833, 633, 633, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 34, 2033, 2033, 153, 113, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 95, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 551}, 
{323, 252, 40, 33, 42, 1833, 633, 633, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 34, 2033, 2033, 153, 113, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 95, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 552}, 
{323, 252, 40, 33, 42, 1833, 633, 633, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 34, 2033, 2033, 153, 113, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 95, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 553}, 
{323, 252, 40, 33, 42, 1833, 633, 633, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 34, 2033, 2033, 153, 113, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 95, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 554}, 
{323, 252, 40, 33, 42, 1833, 633, 633, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 34, 2033, 2033, 153, 113, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 95, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 555}, 
{323, 252, 40, 33, 42, 1833, 633, 633, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 34, 2033, 2033, 153, 113, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 95, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 556}, 
{323, 252, 40, 33, 42, 1833, 633, 633, 33, 33, 123, 33, 32, 32, 33, 33, 33, 43, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 34, 2033, 2033, 153, 113, 133, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 95, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 557}, 
{323, 251, 40, 33, 42, 1833, 733, 733, 33, 33, 123, 33, 32, 32, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 33, 34, 3033, 3033, 183, 133, 153, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 51, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 558}, 
{323, 251, 40, 33, 42, 1833, 733, 733, 33, 33, 123, 33, 32, 32, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 33, 34, 3033, 3033, 183, 133, 153, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 51, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 559}, 
{323, 251, 40, 33, 42, 1833, 733, 733, 33, 33, 123, 33, 32, 32, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 33, 34, 3033, 3033, 183, 133, 153, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 51, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 560}, 
{323, 251, 40, 33, 42, 1833, 733, 733, 33, 33, 123, 33, 32, 32, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 33, 34, 3033, 3033, 183, 133, 153, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 51, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 561}, 
{323, 251, 40, 33, 42, 1833, 733, 733, 33, 33, 123, 33, 32, 32, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 33, 34, 3033, 3033, 183, 133, 153, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 51, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 562}, 
{323, 251, 40, 33, 42, 1833, 733, 733, 33, 33, 123, 33, 32, 32, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 33, 34, 3033, 3033, 183, 133, 153, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 51, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 563}, 
{323, 251, 40, 33, 42, 1833, 733, 733, 33, 33, 123, 33, 32, 32, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 33, 34, 3033, 3033, 183, 133, 153, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 51, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 564}, 
{323, 251, 40, 33, 42, 1833, 733, 733, 33, 33, 123, 33, 32, 32, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 33, 34, 3033, 3033, 183, 133, 153, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 51, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 565}, 
{323, 251, 40, 33, 42, 1833, 733, 733, 33, 33, 123, 33, 32, 32, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 33, 34, 3033, 3033, 183, 133, 153, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 51, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 566}, 
{323, 251, 40, 33, 42, 1833, 733, 733, 33, 33, 123, 33, 32, 32, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 33, 34, 3033, 3033, 183, 133, 153, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 51, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 567}, 
{323, 251, 40, 33, 42, 1833, 733, 733, 33, 33, 123, 33, 32, 32, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 33, 34, 3033, 3033, 183, 133, 153, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 51, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 568}, 
{323, 251, 40, 33, 42, 1833, 733, 733, 33, 33, 123, 33, 32, 32, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 33, 34, 3033, 3033, 183, 133, 153, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 51, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 569}, 
{323, 251, 40, 33, 42, 1833, 733, 733, 33, 33, 123, 33, 32, 32, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 33, 34, 3033, 3033, 183, 133, 153, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 51, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 570}, 
{323, 251, 40, 33, 42, 1833, 733, 733, 33, 33, 123, 33, 32, 32, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 33, 34, 3033, 3033, 183, 133, 153, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 51, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 571}, 
{323, 251, 40, 33, 42, 1833, 733, 733, 33, 33, 123, 33, 32, 32, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 33, 34, 3033, 3033, 183, 133, 153, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 51, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 572}, 
{323, 251, 40, 33, 42, 1833, 733, 733, 33, 33, 123, 33, 32, 32, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 33, 34, 3033, 3033, 183, 133, 153, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 51, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 573}, 
{323, 251, 40, 33, 42, 1833, 733, 733, 33, 33, 123, 33, 32, 32, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 33, 34, 3033, 3033, 183, 133, 153, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 51, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 574}, 
{323, 251, 40, 33, 42, 1833, 733, 733, 33, 33, 123, 33, 32, 32, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 33, 34, 3033, 3033, 183, 133, 153, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 51, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 575}, 
{323, 251, 40, 33, 42, 1833, 733, 733, 33, 33, 123, 33, 32, 32, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 33, 34, 3033, 3033, 183, 133, 153, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 51, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 576}, 
{323, 251, 40, 33, 42, 1833, 133, 133, 33, 33, 123, 33, 32, 32, 33, 38, 33, 33, 33, 33, 38, 33, 33, 33, 33, 36, 33, 33, 33, 34, 3033, 3033, 63, 83, 63, 33, 33, 33, 33, 43, 43, 43, 43, 43, 133, 83, 33, 33, 33, 93, 32, 33, 51, 33, 33, 33, 33, 33, 33, 33, 33, 33, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 577}, 
{254, 234, 37, 33, 34, 33, 233, 233, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 41, 33, 33, 33, 33, 35, 33, 833, 833, 83, 83, 83, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 111, 33, 33, 33, 33, 33, 33, 33, 33, 33, 233, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 578}, 
{254, 234, 37, 33, 34, 33, 233, 233, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 41, 33, 33, 33, 33, 35, 33, 833, 833, 83, 83, 83, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 111, 33, 33, 33, 33, 33, 33, 33, 33, 33, 233, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 579}, 
{254, 234, 37, 33, 34, 33, 233, 233, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 41, 33, 33, 33, 33, 35, 33, 833, 833, 83, 83, 83, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 111, 33, 33, 33, 33, 33, 33, 33, 33, 33, 233, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 580}, 
{254, 234, 37, 33, 34, 33, 233, 233, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 41, 33, 33, 33, 33, 35, 33, 833, 833, 83, 83, 83, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 111, 33, 33, 33, 33, 33, 33, 33, 33, 33, 233, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 581}, 
{254, 234, 37, 33, 34, 33, 233, 233, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 41, 33, 33, 33, 33, 35, 33, 833, 833, 83, 83, 83, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 111, 33, 33, 33, 33, 33, 33, 33, 33, 33, 233, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 582}, 
{254, 234, 37, 33, 34, 33, 233, 233, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 41, 33, 33, 33, 33, 35, 33, 833, 833, 83, 83, 83, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 111, 33, 33, 33, 33, 33, 33, 33, 33, 33, 233, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 583}, 
{254, 234, 37, 33, 34, 33, 233, 233, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 41, 33, 33, 33, 33, 35, 33, 833, 833, 83, 83, 83, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 111, 33, 33, 33, 33, 33, 33, 33, 33, 33, 233, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 584}, 
{254, 234, 37, 33, 34, 33, 233, 233, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 41, 33, 33, 33, 33, 35, 33, 833, 833, 83, 83, 83, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 111, 33, 33, 33, 33, 33, 33, 33, 33, 33, 233, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 585}, 
{254, 234, 37, 33, 34, 33, 233, 233, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 41, 33, 33, 33, 33, 35, 33, 833, 833, 83, 83, 83, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 111, 33, 33, 33, 33, 33, 33, 33, 33, 33, 233, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 586}, 
{254, 234, 37, 33, 34, 33, 233, 233, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 41, 33, 33, 33, 33, 35, 33, 833, 833, 83, 83, 83, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 111, 33, 33, 33, 33, 33, 33, 33, 33, 33, 233, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 587}, 
{254, 234, 37, 33, 34, 33, 233, 233, 33, 33, 123, 33, 32, 32, 33, 33, 33, 33, 42, 33, 33, 33, 33, 41, 33, 33, 33, 33, 35, 33, 833, 833, 83, 83, 83, 33, 33, 33, 33, 43, 43, 43, 43, 43, 43, 83, 33, 33, 33, 93, 32, 33, 111, 33, 33, 33, 33, 33, 33, 33, 33, 33, 233, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 33, 33, 33, 33, 588}}
CSWPSX = {
{33, 32, 32, 32, 32, 34, 36, 113, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 0}, 
{34, 32, 32, 32, 32, 34, 36, 233, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 1}, 
{35, 32, 32, 32, 32, 34, 36, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 2}, 
{36, 32, 32, 32, 32, 34, 36, 33, 33, 33, 33, 33, 133, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 3}, 
{37, 32, 32, 32, 32, 34, 36, 33, 33, 33, 33, 33, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 4}, 
{38, 32, 32, 32, 32, 34, 36, 33, 33, 33, 33, 33, 633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 5}, 
{39, 32, 32, 32, 32, 34, 36, 33, 33, 33, 33, 33, 1033, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 6}, 
{40, 32, 32, 32, 32, 34, 36, 233, 33, 33, 33, 33, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 7}, 
{41, 32, 32, 32, 32, 34, 36, 533, 33, -17, 83, 33, 1033, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 8}, 
{42, 32, 32, 32, 32, 34, 36, 33, 33, 13, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 9}, 
{43, 32, 32, 32, 32, 34, 36, 33, 33, -17, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 10}, 
{44, 32, 32, 32, 32, 34, 36, 33, 33, -47, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 11}, 
{45, 32, 32, 32, 32, 34, 36, 33, 33, 33, 73, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 12}, 
{46, 32, 32, 32, 32, 34, 36, 33, 33, 33, 113, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 13}, 
{47, 32, 32, 32, 32, 34, 36, 33, 103, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 14}, 
{48, 32, 32, 32, 32, 34, 36, 33, 33, 33, 33, 33, 33, 233, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 15}, 
{49, 32, 32, 32, 32, 34, 36, 33, 83, 33, 33, 33, 33, 133, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 16}, 
{50, 32, 32, 32, 32, 34, 36, 33, 93, 33, 33, 33, 33, 183, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 17}, 
{51, 32, 32, 32, 32, 34, 36, 33, 43, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 18}, 
{52, 32, 32, 32, 32, 34, 36, 33, 63, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 19}, 
{53, 32, 32, 32, 32, 34, 36, 33, 83, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 20}, 
{54, 32, 32, 32, 32, 34, 36, 33, 83, 33, 33, 33, 33, 183, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 21}, 
{55, 32, 32, 32, 32, 34, 36, 33, 33, 33, 33, 33, 33, 83, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 22}, 
{56, 32, 32, 32, 32, 34, 36, 33, 33, 33, 33, 33, 33, 133, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 23}, 
{57, 32, 32, 32, 32, 34, 36, 33, 33, 33, 33, 33, 33, 183, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 24}, 
{58, 32, 32, 32, 32, 34, 36, 33, 33, 33, 33, 33, 33, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 25}, 
{59, 32, 32, 32, 32, 34, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 133, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 26}, 
{60, 32, 32, 32, 32, 34, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 133, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 27}, 
{61, 32, 56, 32, 32, 34, 37, 3, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 53, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 28}, 
{62, 32, 56, 32, 32, 34, 37, -17, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 63, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 29}, 
{63, 32, 36, 32, 32, 34, 37, -47, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 73, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 30}, 
{64, 32, 37, 32, 32, 34, 37, -67, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 83, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 31}, 
{65, 32, 63, 32, 32, 34, 37, -7, 33, 73, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 63, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 32}, 
{66, 32, 63, 32, 32, 34, 37, -27, 33, 93, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 68, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 33}, 
{67, 32, 63, 32, 32, 34, 37, -37, 33, 103, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 73, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 34}, 
{68, 32, 63, 32, 32, 34, 37, -47, 33, 113, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 83, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 35}, 
{69, 32, 32, 32, 33, 34, 34, 33, 33, 33, 33, 32, 33, 33, 63, 18, 63, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 1033, 33, 33, 33, 33, 33, 33, 133, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 33, 36}, 
{70, 32, 32, 32, 33, 34, 34, 33, 33, 33, 33, 32, 33, 33, 83, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 533, 33, 33, 33, 33, 33, 33, 133, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 33, 37}, 
{71, 32, 32, 32, 33, 34, 34, 33, 33, 33, 33, 32, 33, 33, 43, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 53, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 33, 38}, 
{72, 32, 32, 32, 33, 34, 34, 33, 33, 33, 33, 32, 33, 33, 58, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 83, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 33, 39}, 
{73, 32, 32, 32, 33, 34, 34, 33, 33, 33, 33, 32, 33, 33, 53, 43, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 83, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 33, 40}, 
{74, 32, 32, 32, 33, 34, 34, 33, 33, 33, 33, 33, 33, 33, 63, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 93, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 33, 41}, 
{75, 32, 32, 32, 33, 34, 34, 33, 33, 33, 33, 32, 33, 33, 48, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 63, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 33, 42}, 
{76, 32, 32, 32, 33, 34, 34, 33, 33, 33, 33, 33, 33, 33, 83, 18, 53, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 1033, 33, 33, 33, 33, 33, 33, 33, 133, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 33, 43}, 
{77, 32, 32, 32, 33, 34, 34, 33, 33, 33, 33, 32, 33, 33, 63, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 38, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 93, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 33, 44}, 
{78, 32, 32, 32, 33, 34, 34, 33, 33, 33, 33, 32, 33, 33, 58, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 83, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 33, 45}, 
{79, 32, 32, 32, 33, 34, 34, 33, 33, 33, 33, 32, 33, 33, 53, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 73, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 33, 46}, 
{80, 32, 32, 32, 33, 34, 34, 33, 33, 33, 33, 32, 33, 33, 48, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 63, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 33, 47}, 
{81, 32, 32, 32, 33, 34, 34, 33, 33, 33, 33, 32, 33, 33, 43, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 53, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 33, 48}, 
{82, 32, 32, 32, 33, 34, 34, 33, 33, 33, 33, 32, 33, 33, 73, 43, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 103, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 33, 49}, 
{83, 32, 32, 32, 33, 34, 34, 33, 33, 33, 33, 32, 33, 33, 63, 23, 53, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 93, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 33, 50}, 
{84, 32, 32, 32, 33, 34, 34, 33, 33, 33, 33, 32, 33, 33, 58, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 83, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 33, 51}, 
{85, 32, 32, 32, 33, 34, 34, 33, 33, 33, 33, 32, 33, 33, 53, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 73, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 33, 52}, 
{86, 32, 32, 32, 33, 34, 34, 33, 33, 33, 33, 32, 33, 33, 48, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 63, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 33, 53}, 
{87, 32, 32, 32, 33, 34, 34, 33, 33, 33, 33, 32, 33, 33, 43, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 53, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 33, 54}, 
{88, 32, 32, 32, 33, 34, 34, 33, 33, 33, 33, 32, 33, 33, 103, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 153, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 33, 55}, 
{89, 32, 32, 32, 33, 34, 34, 33, 33, 33, 33, 32, 33, 33, 103, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 153, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 33, 56}, 
{90, 32, 32, 32, 33, 34, 34, 33, 33, 33, 33, 32, 33, 33, 103, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 153, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 33, 57}, 
{91, 32, 32, 32, 34, 34, 34, 33, 33, 33, 33, 32, 33, 33, 43, 33, 83, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 34, 58}, 
{92, 32, 32, 32, 34, 34, 34, 33, 33, 33, 33, 32, 33, 33, 33, 33, 73, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 34, 59}, 
{93, 32, 32, 32, 34, 34, 34, 33, 33, 33, 33, 32, 33, 33, 33, 33, 68, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 34, 60}, 
{94, 32, 32, 32, 34, 34, 34, 33, 33, 33, 33, 32, 33, 33, 33, 33, 63, 33, 33, 33, 33, 40, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 34, 61}, 
{95, 32, 32, 32, 34, 34, 34, 33, 33, 33, 33, 32, 33, 33, 33, 33, 53, 33, 33, 33, 33, 41, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 34, 62}, 
{96, 32, 32, 32, 34, 34, 34, 33, 33, 33, 33, 32, 33, 33, 33, 33, 43, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 34, 63}, 
{97, 118, 32, 32, 32, 34, 35, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 83, 333, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 118, 32, 32, 64}, 
{98, 121, 32, 32, 32, 34, 35, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 233, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 121, 32, 32, 65}, 
{99, 120, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 283, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 120, 32, 32, 66}, 
{100, 122, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 43, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 163, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 122, 32, 32, 67}, 
{101, 123, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 43, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 333, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 163, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 123, 32, 32, 68}, 
{102, 125, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 43, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 433, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 183, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 125, 32, 32, 69}, 
{103, 126, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 43, 33, 34, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 483, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 83, 193, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 126, 32, 32, 70}, 
{104, 127, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 53, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 533, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 203, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 127, 32, 32, 71}, 
{105, 129, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 53, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 34, 583, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 213, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 129, 32, 32, 72}, 
{106, 128, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 53, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 733, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 83, 223, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 128, 32, 32, 73}, 
{107, 130, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 53, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 783, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 83, 283, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 130, 32, 32, 74}, 
{108, 131, 32, 32, 32, 34, 35, 33, 33, 33, 33, 35, 33, 53, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 933, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 243, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 131, 32, 32, 75}, 
{109, 132, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 53, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 34, 983, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 243, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 132, 32, 32, 76}, 
{110, 133, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 53, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 1133, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 263, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 133, 32, 32, 77}, 
{111, 81, 32, 32, 32, 34, 35, 33, 33, 33, 33, 33, 33, 33, 33, 36, 33, 33, 33, 33, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 53, 33, 33, 33, 33, 233, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 81, 32, 32, 78}, 
{112, 134, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 53, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 1183, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 103, 263, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 134, 32, 32, 79}, 
{113, 135, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 63, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 3, 103, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 135, 32, 32, 80}, 
{114, 136, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 63, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 34, 1383, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 283, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 136, 32, 32, 81}, 
{115, 137, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 63, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 1633, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 113, 283, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 137, 32, 32, 82}, 
{116, 139, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 73, 34, 33, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 34, 2033, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 333, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 139, 32, 32, 83}, 
{117, 140, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 73, 36, 33, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 2033, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 333, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 140, 32, 32, 84}, 
{118, 141, 32, 32, 32, 34, 35, 33, 33, 33, 33, 35, 33, 83, 35, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 2033, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 333, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 141, 32, 32, 85}, 
{119, 59, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 37, 33, 33, 33, 33, 33, 33, 37, 33, 33, 33, 33, 33, 33, 33, 33, 32, 34, 33, 33, 33, 33, 33, 33, 153, 33, 33, 33, 33, 33, 313, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 59, 32, 32, 86}, 
{120, 58, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 35, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 133, 33, 33, 33, 33, 33, 273, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 58, 32, 32, 87}, 
{121, 57, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 35, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 36, 33, 33, 33, 33, 32, 34, 33, 33, 33, 33, 33, 33, 133, 33, 33, 33, 33, 33, 253, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 57, 32, 32, 88}, 
{122, 56, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 35, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 133, 33, 33, 33, 33, 33, 253, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 56, 32, 32, 89}, 
{123, 55, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 35, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 32, 34, 33, 33, 33, 33, 33, 33, 133, 33, 33, 33, 33, 33, 233, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 55, 32, 32, 90}, 
{124, 54, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 133, 33, 33, 33, 33, 33, 233, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 54, 32, 32, 91}, 
{125, 53, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 32, 34, 33, 33, 33, 33, 33, 33, 123, 33, 33, 33, 33, 33, 213, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 53, 32, 32, 92}, 
{126, 138, 32, 32, 32, 34, 35, 33, 33, 33, 33, 33, 33, 63, 34, 38, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 283, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 138, 32, 32, 93}, 
{127, 52, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 123, 33, 33, 33, 33, 33, 213, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 52, 32, 32, 94}, 
{128, 51, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 113, 33, 33, 33, 33, 33, 193, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 51, 32, 32, 95}, 
{129, 50, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 32, 34, 33, 33, 33, 33, 33, 33, 113, 33, 33, 33, 33, 33, 193, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 50, 32, 32, 96}, 
{130, 49, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 103, 33, 33, 33, 33, 33, 173, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 49, 32, 32, 97}, 
{131, 48, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 103, 33, 33, 33, 33, 33, 173, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 48, 32, 32, 98}, 
{132, 47, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 103, 33, 33, 33, 33, 33, 173, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 47, 32, 32, 99}, 
{133, 46, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 32, 34, 33, 33, 33, 33, 33, 33, 93, 33, 33, 33, 33, 33, 153, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 46, 32, 32, 100}, 
{134, 45, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 35, 34, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 93, 33, 33, 33, 33, 103, 153, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 45, 32, 32, 101}, 
{135, 44, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 93, 33, 33, 33, 33, 33, 153, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 44, 32, 32, 102}, 
{136, 43, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 83, 33, 33, 33, 33, 33, 133, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 43, 32, 32, 103}, 
{137, 42, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 83, 33, 33, 33, 33, 33, 133, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 42, 32, 32, 104}, 
{138, 41, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 83, 33, 33, 33, 33, 33, 133, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 41, 32, 32, 105}, 
{139, 40, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 34, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 68, 33, 33, 33, 33, 33, 103, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 40, 32, 32, 106}, 
{140, 39, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 34, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 53, 33, 33, 33, 33, 33, 113, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 39, 32, 32, 107}, 
{141, 38, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 73, 33, 33, 33, 33, 33, 113, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 38, 32, 32, 108}, 
{142, 37, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 32, 34, 33, 33, 33, 33, 33, 33, 98, 33, 33, 33, 33, 33, 163, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 37, 32, 32, 109}, 
{143, 36, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 34, 32, 33, 33, 33, 33, 33, 33, 33, 63, 33, 33, 33, 33, 33, 93, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 36, 32, 32, 110}, 
{144, 35, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 34, 33, 33, 33, 33, 33, 35, 33, 33, 33, 34, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 73, 33, 33, 33, 33, 33, 73, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 35, 32, 32, 111}, 
{145, 34, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 53, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 34, 32, 32, 112}, 
{146, 82, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 6033, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 313, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 82, 32, 32, 113}, 
{147, 80, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 68, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 253, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 80, 32, 32, 114}, 
{148, 79, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 35, 33, 34, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 133, 33, 33, 33, 33, 253, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 79, 32, 32, 115}, 
{149, 78, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 133, 33, 33, 33, 33, 233, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 78, 32, 32, 116}, 
{150, 77, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 133, 33, 33, 33, 33, 233, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 77, 32, 32, 117}, 
{151, 76, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 34, 34, 34, 34, 33, 33, 33, 33, 33, 32, 35, 2033, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 113, 213, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 76, 32, 32, 118}, 
{152, 75, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 34, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 123, 33, 33, 33, 33, 213, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 75, 32, 32, 119}, 
{153, 74, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 113, 33, 33, 33, 33, 193, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 74, 32, 32, 120}, 
{154, 73, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 113, 33, 33, 33, 33, 193, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 73, 32, 32, 121}, 
{155, 72, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 103, 33, 33, 33, 33, 173, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 72, 32, 32, 122}, 
{156, 71, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 34, 35, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 103, 33, 33, 33, 33, 173, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 71, 32, 32, 123}, 
{157, 70, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 93, 33, 33, 33, 33, 153, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 70, 32, 32, 124}, 
{158, 69, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 93, 33, 33, 33, 33, 153, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 69, 32, 32, 125}, 
{159, 68, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 63, 33, 33, 33, 33, 93, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 68, 32, 32, 126}, 
{160, 67, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 73, 33, 33, 33, 33, 113, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 67, 32, 32, 127}, 
{161, 66, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 83, 33, 33, 33, 33, 133, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 66, 32, 32, 128}, 
{162, 65, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 34, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 83, 33, 33, 33, 33, 133, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 65, 32, 32, 129}, 
{163, 64, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 83, 33, 33, 33, 33, 133, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 64, 32, 32, 130}, 
{164, 63, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 34, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 73, 33, 33, 33, 33, 113, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 63, 32, 32, 131}, 
{165, 62, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 34, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 63, 33, 33, 33, 33, 93, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 62, 32, 32, 132}, 
{166, 61, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 53, 33, 33, 33, 33, 73, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 61, 32, 32, 133}, 
{167, 60, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 53, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 60, 32, 32, 134}, 
{168, 99, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 35, 33, 34, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 133, 33, 33, 33, 223, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 99, 32, 32, 135}, 
{169, 100, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 35, 33, 34, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 133, 33, 33, 33, 223, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 100, 32, 32, 136}, 
{170, 98, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 34, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 123, 33, 33, 33, 203, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 98, 32, 32, 137}, 
{171, 97, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 34, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 123, 33, 33, 33, 203, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 97, 32, 32, 138}, 
{172, 96, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 34, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 63, 33, 33, 33, 183, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 96, 32, 32, 139}, 
{173, 95, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 34, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 113, 33, 33, 33, 183, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 95, 32, 32, 140}, 
{174, 94, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 34, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 103, 33, 33, 33, 163, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 94, 32, 32, 141}, 
{175, 93, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 34, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 103, 33, 33, 33, 163, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 93, 32, 32, 142}, 
{176, 92, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 34, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 93, 33, 33, 33, 143, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 92, 32, 32, 143}, 
{177, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 144}, 
{178, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 145}, 
{179, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 146}, 
{180, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 147}, 
{181, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 148}, 
{182, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 149}, 
{183, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 150}, 
{184, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 151}, 
{185, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 152}, 
{186, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 153}, 
{187, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 154}, 
{188, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 155}, 
{189, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 156}, 
{190, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 157}, 
{191, 91, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 83, 33, 33, 33, 123, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 91, 32, 32, 158}, 
{192, 89, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 73, 33, 33, 33, 103, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 89, 32, 32, 159}, 
{193, 90, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 73, 33, 33, 33, 103, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 90, 32, 32, 160}, 
{194, 88, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 34, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 83, 33, 33, 33, 123, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 88, 32, 32, 161}, 
{195, 87, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 93, 33, 33, 33, 143, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 87, 32, 32, 162}, 
{196, 86, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 63, 33, 33, 33, 83, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 86, 32, 32, 163}, 
{197, 85, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 34, 34, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 63, 33, 33, 33, 83, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 85, 32, 32, 164}, 
{198, 84, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 53, 33, 33, 33, 63, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 84, 32, 32, 165}, 
{199, 83, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 53, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 83, 32, 32, 166}, 
{200, 113, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 35, 34, 33, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 133, 33, 33, 233, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 113, 32, 32, 167}, 
{201, 119, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 35, 34, 33, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 133, 33, 33, 233, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 119, 32, 32, 168}, 
{202, 117, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 34, 33, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 123, 33, 33, 213, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 117, 32, 32, 169}, 
{203, 116, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 34, 33, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 123, 33, 33, 213, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 116, 32, 32, 170}, 
{204, 115, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 34, 33, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 113, 33, 33, 193, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 115, 32, 32, 171}, 
{205, 114, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 34, 33, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 113, 33, 33, 193, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 114, 32, 32, 172}, 
{206, 111, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 34, 33, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 103, 33, 33, 173, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 111, 32, 32, 173}, 
{207, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 174}, 
{208, 112, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 34, 33, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 103, 33, 33, 173, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 112, 32, 32, 175}, 
{209, 110, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 34, 33, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 73, 33, 33, 113, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 110, 32, 32, 176}, 
{210, 109, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 34, 33, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 63, 33, 33, 93, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 109, 32, 32, 177}, 
{211, 108, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 34, 33, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 83, 33, 33, 133, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 108, 32, 32, 178}, 
{212, 107, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 34, 33, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 83, 33, 33, 133, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 107, 32, 32, 179}, 
{213, 106, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 34, 33, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 73, 33, 33, 113, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 106, 32, 32, 180}, 
{214, 105, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 34, 33, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 88, 33, 33, 143, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 105, 32, 32, 181}, 
{215, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 182}, 
{216, 104, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 83, 33, 33, 133, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 104, 32, 32, 183}, 
{217, 103, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 34, 34, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 63, 33, 33, 93, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 103, 32, 32, 184}, 
{218, 102, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 53, 33, 33, 73, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 102, 32, 32, 185}, 
{219, 101, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 35, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 53, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 101, 32, 32, 186}, 
{220, 32, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 35, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 108, 33, 33, 33, 33, 33, 33, 33, 133, 83, 242, 39, 32, 32, 32, 32, 48, 33, 33, 33, 33, 32, 32, 32, 187}, 
{221, 32, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 35, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 103, 33, 33, 33, 33, 33, 33, 33, 133, 83, 242, 38, 40, 32, 32, 32, 45, 46, 33, 33, 33, 32, 32, 32, 188}, 
{222, 32, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 35, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 93, 33, 33, 33, 33, 33, 33, 33, 133, 83, 242, 35, 32, 32, 32, 32, 48, 33, 33, 33, 33, 32, 32, 32, 189}, 
{223, 32, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 35, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 73, 33, 33, 33, 33, 33, 33, 33, 83, 58, 32, 33, 36, 32, 32, 32, 35, 36, 33, 33, 33, 32, 32, 32, 190}, 
{224, 32, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 35, 33, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 83, 33, 33, 33, 33, 33, 33, 33, 113, 63, 242, 34, 37, 32, 32, 32, 41, 41, 33, 33, 33, 32, 32, 32, 191}, 
{225, 32, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 38, 38, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 53, 33, 33, 33, 33, 33, 33, 33, 33, 133, 83, 242, 42, 43, 44, 32, 32, 38, 41, 45, 33, 33, 32, 32, 32, 192}, 
{226, 32, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 38, 38, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 53, 33, 33, 33, 33, 33, 33, 33, 33, 133, 83, 242, 42, 43, 44, 32, 32, 38, 41, 45, 33, 33, 32, 32, 32, 193}, 
{227, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 194}, 
{228, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 195}, 
{229, 32, 32, 32, 32, 34, 33, 33, 33, 33, 123, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 196}, 
{230, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 197}, 
{231, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 198}, 
{232, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 199}, 
{233, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 200}, 
{234, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 201}, 
{235, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 202}, 
{236, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 203}, 
{237, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 204}, 
{238, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 205}, 
{239, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 206}, 
{240, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 207}, 
{241, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 208}, 
{242, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 209}, 
{243, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 210}, 
{244, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 211}, 
{245, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 212}, 
{246, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 213}, 
{247, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 214}, 
{248, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 215}, 
{249, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 216}, 
{250, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 217}, 
{251, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 218}, 
{252, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 219}, 
{253, 32, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 133, 83, 243, 51, 52, 53, 54, 32, 38, 43, 48, 58, 33, 32, 32, 32, 220}, 
{254, 32, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 133, 83, 243, 55, 56, 57, 58, 32, 38, 43, 48, 58, 33, 32, 32, 32, 221}, 
{255, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 222}, 
{256, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 223}, 
{257, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 224}, 
{258, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 225}, 
{259, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 226}, 
{260, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 227}, 
{261, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 228}, 
{262, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 229}, 
{263, 32, 32, 32, 34, 34, 34, 33, 33, 33, 33, 32, 33, 33, 33, 53, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 34, 230}, 
{264, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 32, 33, 33, 33, 53, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 231}, 
{265, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 232}, 
{266, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 32, 33, 33, 33, 53, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 233}, 
{267, 32, 32, 32, 32, 34, 33, 33, 33, 33, 33, 32, 33, 33, 33, 53, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 234}, 
{268, 32, 32, 32, 32, 34, 35, 33, 33, 33, 33, 32, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 33, 32, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 3, 533, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 32, 235}, 
{269, 32, 32, 32, 33, 34, 34, 33, 33, 33, 33, 32, 33, 33, 83, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 32, 35, 533, 33, 33, 33, 33, 33, 33, 133, 33, 33, 33, 33, 33, 33, 32, 32, 32, 32, 32, 32, 33, 33, 33, 33, 33, 32, 32, 33, 236}}
CSCJSX = {
{33, 32, 34, 33, 33, 33, 33}, 
{34, 32, 34, 33, 33, 33, 33}, 
{35, 32, 35, 33, 33, 33, 33}, 
{36, 32, 34, 33, 33, 33, 33}, 
{37, 32, 34, 33, 33, 33, 33}, 
{38, 32, 34, 33, 33, 33, 33}, 
{39, 32, 34, 33, 33, 33, 33}, 
{40, 32, 34, 33, 33, 33, 33}, 
{41, 32, 34, 33, 33, 33, 33}, 
{42, 32, 34, 33, 33, 33, 33}, 
{43, 32, 34, 33, 33, 33, 33}, 
{44, 46, 34, 46, 45, 46, 45}, 
{45, 32, 34, 33, 33, 33, 33}, 
{46, 32, 34, 33, 33, 33, 33}, 
{47, 48, 34, 82, 48, 33, 33}, 
{48, 47, 34, 52, 54, 53, 54}, 
{49, 32, 34, 33, 33, 33, 33}, 
{50, 32, 34, 33, 33, 33, 33}, 
{51, 32, 34, 33, 33, 33, 33}, 
{52, 32, 33, 33, 33, 33, 33}, 
{53, 32, 34, 33, 33, 33, 33}, 
{54, 32, 34, 33, 33, 33, 33}, 
{55, 32, 34, 33, 33, 33, 33}, 
{56, 32, 34, 33, 33, 33, 33}, 
{57, 32, 34, 33, 33, 33, 33}, 
{58, 32, 34, 33, 33, 33, 33}, 
{59, 32, 34, 33, 33, 33, 33}, 
{60, 32, 34, 33, 33, 33, 33}, 
{61, 126, 33, 90, 52, 90, 52}, 
{62, 32, 34, 33, 33, 33, 33}, 
{63, 32, 34, 33, 33, 33, 33}, 
{64, 32, 34, 33, 33, 33, 33}, 
{65, 32, 34, 33, 33, 33, 33}, 
{66, 32, 34, 33, 33, 33, 33}, 
{67, 32, 34, 33, 33, 33, 33}, 
{68, 32, 34, 33, 33, 33, 33}, 
{69, 32, 33, 33, 33, 33, 33}, 
{70, 32, 34, 33, 33, 33, 33}, 
{71, 32, 34, 33, 33, 33, 33}, 
{72, 32, 34, 33, 33, 33, 33}, 
{73, 32, 34, 33, 33, 33, 33}, 
{74, 32, 34, 33, 33, 33, 33}, 
{75, 132, 34, 85, 62, 84, 62}, 
{76, 32, 34, 33, 33, 33, 33}, 
{77, 32, 34, 33, 33, 33, 33}, 
{78, 32, 34, 33, 33, 33, 33}, 
{79, 32, 34, 33, 33, 33, 33}, 
{80, 32, 34, 33, 33, 33, 33}, 
{81, 32, 34, 33, 33, 33, 33}, 
{82, 32, 34, 33, 33, 33, 33}, 
{83, 32, 34, 33, 33, 33, 33}, 
{84, 32, 34, 33, 33, 33, 33}, 
{85, 32, 34, 33, 33, 33, 33}, 
{86, 32, 34, 33, 33, 33, 33}, 
{87, 32, 34, 33, 33, 33, 33}, 
{88, 115, 34, 46, 55, 47, 55}, 
{89, 32, 34, 33, 33, 33, 33}, 
{90, 114, 34, 41, 62, 42, 62}, 
{91, 32, 34, 33, 33, 33, 33}, 
{92, 32, 34, 33, 33, 33, 33}, 
{93, 32, 34, 33, 33, 33, 33}, 
{94, 32, 34, 33, 33, 33, 33}, 
{95, 32, 34, 33, 33, 33, 33}, 
{96, 32, 34, 33, 33, 33, 33}, 
{97, 32, 34, 33, 33, 33, 33}, 
{98, 32, 34, 33, 33, 33, 33}, 
{99, 32, 34, 33, 33, 33, 33}, 
{100, 32, 34, 81, 53, 80, 53}, 
{101, 32, 34, 33, 33, 33, 33}, 
{102, 32, 34, 33, 33, 33, 33}, 
{103, 32, 33, 33, 33, 33, 33}, 
{104, 32, 34, 33, 33, 33, 33}, 
{105, 32, 34, 33, 33, 33, 33}, 
{106, 32, 34, 33, 33, 33, 33}, 
{107, 32, 34, 33, 33, 33, 33}, 
{108, 32, 34, 33, 33, 33, 33}, 
{109, 32, 34, 74, 57, 74, 58}, 
{110, 32, 34, 33, 33, 33, 33}, 
{111, 32, 34, 33, 33, 33, 33}, 
{112, 32, 34, 33, 33, 33, 33}, 
{113, 32, 34, 33, 33, 33, 33}, 
{114, 90, 33, 87, 69, 84, 69}, 
{115, 88, 33, 82, 59, 33, 33}, 
{116, 128, 33, 80, 82, 33, 33}, 
{38, 32, 34, 33, 33, 33, 33}, 
{38, 32, 34, 33, 33, 33, 33}, 
{48, 121, 34, 52, 54, 53, 54}, 
{48, 122, 34, 52, 54, 53, 54}, 
{47, 119, 34, 82, 48, 33, 33}, 
{47, 120, 34, 82, 48, 33, 33}, 
{100, 32, 34, 81, 53, 80, 53}, 
{100, 32, 34, 81, 53, 80, 53}, 
{33, 32, 34, 33, 33, 33, 33}, 
{61, 61, 33, 45, 63, 46, 63}, 
{92, 32, 34, 33, 33, 33, 33}, 
{92, 116, 34, 45, 81, 45, 82}, 
{70, 32, 34, 33, 33, 33, 33}, 
{110, 32, 34, 33, 33, 33, 33}, 
{54, 32, 34, 33, 33, 33, 33}, 
{99, 75, 34, 47, 69, 48, 69}, 
{99, 32, 34, 33, 33, 33, 33}, 
{99, 32, 33, 33, 33, 33, 33}, 
{99, 32, 34, 33, 33, 33, 33}, 
{95, 32, 33, 33, 33, 33, 33}, 
{111, 32, 34, 33, 33, 33, 33}, 
{95, 32, 33, 33, 33, 33, 33}}
CSWGSX = {
{33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 33, 33, 34, 33, 33, 34, 33, 33, 0}, 
{43, 53, 63, 73, 83, 93, 103, 113, 123, 133, 34, 34, 34, 34, 34, 35, 35, 35, 35, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 34, 33, 33, 34, 33, 133, 36, 33, 33, 1}, 
{73, 113, 153, 193, 233, 273, 313, 353, 393, 433, 34, 35, 35, 35, 36, 36, 36, 37, 37, 37, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 35, 34, 34, 34, 38, 33, 433, 37, 33, 33, 2}, 
{63, 93, 123, 153, 183, 213, 243, 273, 303, 333, 34, 35, 35, 35, 36, 36, 36, 37, 37, 37, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 36, 34, 33, 33, 36, 43, 333, 37, 33, 33, 3}, 
{93, 153, 213, 273, 333, 393, 453, 513, 573, 683, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 37, 34, 33, 33, 34, 33, 683, 34, 33, 33, 4}, 
{73, 113, 153, 193, 233, 273, 313, 353, 393, 433, 34, 35, 35, 36, 36, 37, 37, 37, 38, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 38, 34, 33, 33, 38, 43, 433, 38, 33, 33, 5}, 
{53, 73, 93, 113, 133, 153, 173, 193, 213, 233, 34, 34, 34, 35, 35, 35, 35, 36, 36, 36, 33, 33, 33, 34, 34, 34, 35, 35, 35, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 39, 34, 33, 36, 35, 33, 233, 36, 36, 33, 6}, 
{63, 103, 139, 173, 213, 243, 283, 313, 333, 383, 34, 34, 34, 35, 35, 35, 36, 36, 36, 37, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 40, 34, 33, 33, 36, 33, 383, 37, 33, 33, 7}, 
{83, 133, 183, 233, 283, 333, 383, 433, 483, 533, 34, 34, 34, 35, 35, 35, 36, 36, 36, 37, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 41, 34, 33, 33, 43, 33, 533, 37, 33, 33, 8}, 
{83, 133, 183, 233, 283, 333, 383, 433, 483, 533, 34, 34, 34, 35, 35, 35, 36, 36, 36, 37, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 42, 34, 33, 33, 43, 43, 533, 37, 33, 33, 9}, 
{83, 133, 183, 233, 283, 333, 383, 433, 483, 533, 34, 34, 34, 35, 35, 35, 36, 36, 36, 37, 33, 33, 34, 34, 34, 35, 35, 35, 35, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 43, 34, 33, 36, 43, 33, 533, 37, 36, 33, 10}, 
{93, 153, 213, 273, 333, 393, 453, 513, 573, 633, 34, 34, 35, 35, 36, 36, 37, 37, 38, 39, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 44, 34, 33, 33, 48, 48, 633, 39, 33, 33, 11}, 
{93, 153, 213, 273, 333, 393, 453, 513, 573, 633, 34, 35, 36, 36, 37, 37, 38, 38, 39, 39, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 45, 34, 33, 35, 48, 33, 633, 39, 33, 33, 12}, 
{93, 153, 213, 273, 333, 393, 453, 513, 573, 633, 34, 34, 35, 35, 36, 36, 37, 37, 38, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 46, 34, 33, 33, 48, 33, 633, 38, 33, 33, 13}, 
{103, 173, 243, 313, 383, 453, 523, 593, 663, 733, 34, 34, 35, 35, 35, 36, 36, 37, 37, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 47, 34, 33, 34, 53, 33, 733, 38, 33, 33, 14}, 
{103, 173, 243, 313, 383, 453, 523, 593, 663, 733, 34, 34, 34, 35, 35, 35, 36, 36, 36, 37, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 48, 34, 33, 33, 53, 33, 733, 37, 33, 33, 15}, 
{103, 173, 243, 313, 383, 453, 523, 593, 663, 733, 34, 34, 35, 35, 36, 36, 37, 37, 38, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 49, 34, 33, 35, 43, 33, 733, 38, 33, 33, 16}, 
{113, 193, 273, 353, 433, 513, 593, 673, 753, 833, 35, 35, 36, 36, 37, 37, 38, 38, 39, 40, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 50, 34, 33, 34, 68, 33, 833, 40, 33, 33, 17}, 
{113, 193, 273, 353, 433, 513, 593, 673, 753, 833, 35, 36, 36, 37, 37, 38, 38, 39, 39, 39, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 51, 34, 33, 33, 63, 33, 833, 39, 33, 33, 18}, 
{123, 213, 303, 353, 483, 573, 663, 753, 843, 933, 35, 35, 35, 36, 36, 36, 37, 37, 37, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 52, 34, 33, 34, 78, 73, 933, 38, 33, 33, 19}, 
{123, 213, 303, 393, 483, 573, 663, 753, 833, 933, 34, 34, 34, 35, 35, 35, 36, 36, 36, 37, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 53, 34, 33, 33, 63, 33, 933, 37, 33, 33, 20}, 
{133, 233, 333, 433, 533, 633, 733, 833, 933, 1033, 34, 34, 35, 35, 36, 36, 37, 37, 37, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 54, 34, 33, 33, 83, 63, 1033, 38, 33, 33, 21}, 
{133, 233, 333, 433, 533, 633, 733, 833, 933, 1033, 34, 34, 35, 35, 36, 36, 37, 37, 38, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 55, 34, 33, 33, 83, 33, 1033, 38, 33, 33, 22}, 
{143, 253, 363, 473, 583, 693, 803, 913, 1023, 1133, 34, 34, 34, 35, 35, 35, 36, 36, 36, 37, 34, 34, 34, 34, 34, 34, 34, 35, 35, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 56, 34, 33, 36, 133, 33, 1133, 37, 35, 33, 23}, 
{143, 253, 363, 473, 588, 693, 803, 913, 1023, 1133, 34, 34, 34, 35, 35, 35, 36, 36, 36, 37, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 57, 34, 33, 33, 93, 33, 1133, 37, 33, 33, 24}, 
{153, 266, 377, 488, 599, 710, 811, 922, 1032, 1183, 35, 35, 35, 36, 36, 36, 37, 37, 37, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 58, 34, 33, 33, 103, 33, 1183, 38, 33, 33, 25}, 
{133, 233, 333, 433, 533, 633, 733, 833, 933, 1433, 35, 35, 35, 36, 36, 36, 37, 37, 37, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 59, 34, 33, 33, 103, 33, 1433, 38, 33, 33, 26}, 
{53, 63, 73, 83, 93, 103, 113, 123, 133, 133, 35, 35, 36, 36, 37, 37, 38, 38, 39, 40, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 60, 35, 33, 34, 34, 33, 133, 40, 33, 33, 27}, 
{55, 77, 99, 121, 143, 155, 177, 199, 221, 253, 35, 35, 36, 36, 37, 37, 38, 38, 39, 39, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 61, 35, 33, 34, 34, 33, 253, 39, 33, 33, 28}, 
{63, 93, 123, 153, 183, 213, 243, 273, 303, 333, 37, 37, 37, 38, 38, 38, 39, 39, 39, 40, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 62, 35, 33, 34, 35, 33, 333, 40, 33, 33, 29}, 
{63, 103, 153, 193, 233, 273, 313, 353, 393, 433, 35, 35, 36, 36, 36, 37, 37, 37, 38, 38, 33, 33, 33, 34, 34, 34, 35, 35, 35, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 63, 35, 33, 36, 38, 33, 433, 38, 36, 33, 30}, 
{77, 121, 155, 199, 255, 333, 383, 433, 483, 533, 35, 35, 36, 36, 37, 37, 38, 38, 39, 40, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 64, 35, 33, 35, 38, 33, 533, 40, 33, 33, 31}, 
{77, 121, 155, 199, 255, 333, 383, 433, 483, 533, 35, 35, 36, 36, 37, 37, 37, 38, 38, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 65, 35, 33, 34, 38, 33, 533, 38, 33, 33, 32}, 
{88, 144, 188, 244, 288, 344, 388, 444, 488, 583, 35, 35, 36, 36, 37, 37, 37, 38, 38, 39, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 66, 35, 33, 34, 43, 33, 583, 39, 33, 33, 33}, 
{88, 113, 153, 193, 233, 273, 313, 353, 393, 433, 35, 35, 36, 36, 37, 37, 38, 38, 39, 39, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 67, 35, 33, 34, 43, 33, 433, 39, 33, 33, 34}, 
{83, 93, 123, 153, 183, 213, 243, 273, 303, 333, 34, 35, 36, 37, 38, 39, 40, 40, 40, 40, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 68, 35, 33, 35, 43, 33, 333, 40, 33, 33, 35}, 
{99, 155, 221, 277, 333, 399, 455, 521, 577, 633, 35, 35, 36, 36, 37, 37, 38, 38, 39, 40, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 69, 35, 33, 34, 48, 33, 633, 40, 33, 33, 36}, 
{99, 155, 213, 273, 333, 393, 453, 513, 573, 633, 34, 35, 35, 36, 36, 36, 37, 37, 37, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 70, 35, 33, 35, 48, 33, 633, 38, 33, 33, 37}, 
{110, 177, 244, 321, 388, 455, 532, 599, 666, 733, 35, 35, 36, 36, 37, 37, 37, 38, 38, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 71, 35, 33, 34, 53, 33, 733, 38, 33, 33, 38}, 
{103, 173, 243, 313, 383, 453, 523, 593, 663, 733, 35, 35, 36, 36, 37, 37, 38, 38, 39, 40, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 72, 35, 33, 34, 53, 33, 733, 40, 33, 33, 39}, 
{113, 199, 273, 345, 433, 521, 600, 678, 755, 833, 34, 35, 35, 36, 36, 37, 37, 38, 38, 39, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 73, 35, 33, 35, 63, 33, 833, 39, 33, 33, 40}, 
{113, 193, 273, 355, 477, 521, 588, 699, 755, 833, 36, 36, 36, 36, 36, 36, 37, 38, 39, 40, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 74, 35, 33, 34, 63, 33, 833, 40, 33, 33, 41}, 
{123, 213, 303, 399, 477, 588, 655, 755, 844, 933, 34, 34, 34, 34, 35, 35, 36, 36, 37, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 75, 35, 33, 34, 73, 33, 933, 38, 33, 33, 42}, 
{93, 183, 283, 383, 483, 583, 683, 783, 883, 983, 35, 35, 36, 36, 37, 37, 38, 38, 38, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 76, 35, 33, 34, 83, 33, 983, 38, 33, 33, 43}, 
{133, 233, 333, 433, 533, 633, 733, 833, 933, 1033, 35, 36, 37, 37, 37, 38, 38, 38, 39, 39, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 77, 35, 33, 34, 83, 33, 1033, 39, 33, 33, 44}, 
{133, 233, 333, 433, 533, 633, 733, 833, 933, 1033, 34, 35, 35, 35, 36, 36, 36, 37, 37, 37, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 78, 35, 33, 35, 93, 33, 1033, 37, 33, 33, 45}, 
{144, 255, 366, 477, 588, 699, 810, 921, 1032, 1133, 35, 35, 35, 36, 36, 36, 37, 37, 37, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 79, 35, 33, 35, 73, 33, 1133, 38, 33, 33, 46}, 
{143, 255, 366, 477, 588, 699, 810, 921, 1032, 1144, 37, 37, 37, 37, 37, 37, 37, 38, 39, 40, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 80, 35, 33, 35, 38, 33, 1144, 40, 33, 33, 47}, 
{155, 266, 388, 521, 633, 753, 877, 999, 1121, 1233, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 81, 35, 33, 33, 43, 33, 1233, 34, 33, 33, 48}, 
{153, 277, 399, 521, 633, 755, 877, 999, 1121, 1433, 39, 39, 39, 39, 39, 39, 39, 39, 40, 42, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 82, 35, 33, 34, 133, 33, 1433, 42, 33, 33, 49}, 
{43, 53, 63, 73, 83, 93, 103, 113, 123, 133, 35, 35, 36, 36, 37, 37, 38, 38, 39, 39, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 83, 36, 33, 35, 34, 33, 133, 39, 33, 33, 50}, 
{53, 73, 93, 113, 133, 153, 173, 193, 213, 283, 35, 35, 36, 36, 36, 37, 37, 37, 38, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 84, 36, 33, 34, 34, 33, 283, 38, 33, 33, 51}, 
{58, 93, 123, 153, 183, 213, 244, 277, 303, 333, 34, 35, 35, 36, 36, 36, 37, 37, 37, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 85, 36, 33, 35, 35, 33, 333, 38, 33, 33, 52}, 
{63, 93, 123, 153, 188, 213, 243, 273, 303, 333, 35, 35, 35, 36, 36, 36, 37, 38, 39, 40, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 86, 36, 33, 34, 35, 33, 333, 40, 33, 33, 53}, 
{73, 113, 213, 273, 333, 393, 453, 513, 573, 633, 35, 35, 36, 36, 37, 37, 37, 38, 38, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 87, 36, 33, 35, 36, 33, 633, 38, 33, 33, 54}, 
{73, 113, 153, 233, 283, 333, 383, 433, 483, 533, 35, 35, 35, 36, 36, 36, 37, 37, 38, 39, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 88, 36, 33, 33, 36, 33, 533, 39, 33, 33, 55}, 
{83, 133, 153, 193, 233, 273, 313, 333, 383, 433, 34, 34, 35, 35, 35, 35, 35, 35, 35, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 89, 36, 33, 35, 38, 33, 433, 38, 33, 33, 56}, 
{83, 133, 183, 183, 283, 283, 383, 383, 433, 433, 36, 36, 36, 36, 36, 38, 38, 38, 38, 40, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 90, 36, 33, 34, 38, 33, 433, 40, 33, 33, 57}, 
{93, 133, 213, 273, 283, 333, 383, 433, 483, 533, 34, 34, 34, 34, 35, 35, 35, 36, 36, 37, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 91, 36, 33, 34, 43, 33, 533, 37, 33, 33, 58}, 
{83, 133, 183, 233, 283, 333, 383, 433, 483, 633, 35, 35, 36, 36, 36, 37, 37, 37, 38, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 92, 36, 33, 35, 43, 33, 633, 38, 33, 33, 59}, 
{103, 173, 243, 313, 388, 455, 532, 599, 666, 733, 35, 36, 35, 37, 36, 38, 37, 39, 38, 40, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 93, 36, 33, 35, 48, 33, 733, 40, 33, 33, 60}, 
{83, 173, 244, 321, 388, 455, 523, 599, 666, 733, 36, 36, 36, 38, 38, 38, 40, 40, 40, 40, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 94, 36, 33, 34, 48, 33, 733, 40, 33, 33, 61}, 
{113, 113, 273, 273, 433, 433, 593, 593, 633, 833, 38, 38, 38, 38, 38, 38, 38, 38, 38, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 95, 36, 33, 35, 53, 33, 833, 38, 33, 33, 62}, 
{53, 133, 233, 333, 433, 513, 583, 677, 755, 833, 34, 35, 36, 37, 38, 38, 38, 38, 38, 39, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 96, 36, 33, 34, 53, 33, 833, 39, 33, 33, 63}, 
{63, 133, 233, 333, 433, 533, 633, 733, 833, 933, 34, 34, 35, 35, 35, 36, 36, 37, 37, 37, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 97, 36, 33, 35, 58, 33, 933, 37, 33, 33, 64}, 
{63, 213, 303, 393, 483, 573, 663, 753, 843, 933, 36, 36, 36, 36, 37, 37, 37, 37, 38, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 98, 36, 33, 34, 58, 33, 933, 38, 33, 33, 65}, 
{133, 233, 333, 433, 533, 633, 733, 833, 933, 1033, 35, 35, 36, 36, 37, 37, 38, 38, 39, 40, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 99, 36, 33, 34, 73, 33, 1033, 40, 33, 33, 66}, 
{133, 233, 333, 433, 533, 633, 733, 833, 933, 1033, 35, 35, 36, 36, 36, 37, 37, 37, 37, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 100, 36, 33, 35, 63, 33, 1033, 38, 33, 33, 67}, 
{53, 53, 73, 103, 133, 153, 173, 193, 213, 283, 35, 35, 36, 36, 37, 37, 38, 38, 39, 40, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 101, 37, 33, 34, 34, 33, 283, 40, 33, 33, 68}, 
{38, 43, 48, 53, 113, 153, 173, 193, 213, 233, 35, 35, 36, 36, 36, 36, 37, 37, 37, 37, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 102, 37, 33, 33, 35, 43, 233, 37, 33, 33, 69}, 
{63, 93, 123, 153, 183, 213, 243, 273, 303, 333, 35, 35, 36, 36, 37, 37, 37, 37, 38, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 103, 37, 33, 34, 35, 33, 333, 38, 33, 33, 70}, 
{63, 93, 123, 153, 283, 333, 383, 433, 483, 533, 35, 35, 35, 35, 36, 36, 36, 36, 37, 37, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 104, 37, 33, 33, 35, 33, 533, 37, 33, 33, 71}, 
{73, 113, 153, 193, 233, 273, 313, 353, 483, 583, 35, 35, 35, 36, 36, 36, 36, 37, 37, 37, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 105, 37, 33, 34, 37, 33, 583, 37, 33, 33, 72}, 
{73, 113, 153, 193, 233, 273, 313, 353, 393, 433, 34, 34, 35, 35, 35, 36, 36, 36, 36, 37, 33, 33, 34, 34, 34, 35, 35, 35, 35, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 106, 37, 33, 36, 37, 33, 433, 37, 36, 33, 73}, 
{83, 133, 183, 233, 283, 333, 383, 433, 483, 633, 34, 34, 34, 35, 35, 35, 36, 36, 36, 37, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 107, 37, 33, 33, 38, 53, 633, 37, 33, 33, 74}, 
{83, 133, 183, 233, 283, 333, 383, 433, 483, 633, 35, 35, 35, 35, 36, 36, 36, 36, 37, 37, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 108, 37, 33, 34, 33, 33, 633, 37, 33, 33, 75}, 
{93, 153, 153, 153, 183, 213, 243, 273, 303, 333, 34, 34, 35, 35, 35, 36, 36, 36, 37, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 109, 37, 33, 34, 39, 33, 333, 38, 33, 33, 76}, 
{93, 113, 153, 193, 233, 273, 313, 353, 393, 433, 35, 35, 35, 35, 35, 36, 36, 36, 36, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 110, 37, 33, 35, 39, 33, 433, 38, 33, 33, 77}, 
{103, 173, 243, 313, 383, 453, 523, 593, 663, 733, 35, 35, 35, 35, 35, 36, 36, 36, 36, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 111, 37, 33, 34, 40, 33, 733, 36, 33, 33, 78}, 
{103, 173, 244, 313, 388, 453, 523, 593, 663, 733, 35, 35, 35, 35, 35, 36, 36, 36, 36, 36, 34, 34, 34, 34, 34, 35, 35, 35, 35, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 112, 37, 33, 36, 40, 33, 733, 36, 35, 33, 79}, 
{133, 233, 333, 433, 533, 633, 733, 833, 933, 1033, 35, 35, 36, 36, 37, 37, 38, 38, 39, 40, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 113, 37, 33, 35, 43, 33, 1033, 40, 33, 33, 80}, 
{113, 193, 273, 353, 433, 513, 593, 673, 753, 853, 35, 35, 35, 35, 36, 36, 36, 36, 37, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 114, 37, 33, 34, 41, 33, 853, 38, 33, 33, 81}, 
{113, 193, 273, 353, 477, 521, 588, 699, 755, 833, 34, 34, 34, 34, 34, 34, 34, 34, 35, 35, 34, 34, 34, 34, 35, 35, 35, 35, 35, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 115, 37, 33, 36, 41, 33, 833, 35, 36, 33, 82}, 
{123, 213, 303, 393, 483, 573, 663, 753, 843, 933, 36, 36, 36, 36, 36, 37, 37, 37, 37, 37, 33, 34, 34, 34, 34, 35, 35, 35, 35, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 116, 37, 33, 36, 83, 33, 933, 37, 35, 33, 83}, 
{123, 213, 303, 393, 483, 573, 663, 753, 843, 933, 34, 34, 35, 35, 36, 36, 37, 37, 37, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 117, 37, 33, 33, 42, 33, 933, 38, 33, 33, 84}, 
{33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 43, 53, 63, 73, 83, 93, 103, 113, 123, 133, 83, 133, 183, 233, 283, 333, 383, 433, 483, 533, 118, 37, 34, 36, 33, 33, 33, 34, 33, 123, 85}, 
{133, 233, 333, 433, 533, 633, 733, 833, 933, 1033, 34, 34, 35, 35, 36, 36, 37, 37, 38, 39, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 119, 37, 33, 34, 63, 33, 1033, 39, 33, 33, 86}, 
{33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 73, 113, 153, 193, 233, 273, 313, 353, 393, 433, 120, 37, 34, 36, 33, 73, 33, 34, 33, 33, 87}, 
{33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 34, 34, 34, 34, 34, 34, 34, 34, 34, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 40, 47, 54, 61, 68, 75, 82, 89, 96, 108, 73, 113, 153, 193, 233, 273, 313, 353, 293, 433, 121, 37, 34, 36, 33, 33, 33, 34, 33, 96, 88}, 
{83, 133, 183, 233, 283, 333, 383, 433, 483, 533, 34, 35, 35, 35, 36, 36, 36, 37, 37, 37, 33, 33, 34, 34, 34, 34, 34, 34, 34, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 122, 34, 33, 36, 53, 33, 533, 37, 35, 33, 89}, 
{83, 133, 183, 233, 283, 333, 383, 433, 483, 533, 35, 35, 35, 35, 35, 36, 36, 36, 36, 37, 33, 34, 34, 34, 34, 34, 34, 34, 35, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 123, 34, 33, 36, 53, 33, 533, 37, 35, 33, 90}, 
{93, 153, 183, 273, 333, 393, 453, 513, 573, 633, 34, 35, 35, 35, 35, 36, 36, 36, 36, 37, 34, 34, 34, 35, 35, 35, 35, 36, 36, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 124, 34, 33, 36, 63, 33, 633, 37, 36, 33, 91}, 
{93, 153, 213, 273, 333, 393, 453, 513, 573, 683, 34, 34, 34, 35, 35, 35, 36, 36, 36, 37, 33, 33, 33, 34, 34, 34, 35, 35, 35, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 125, 34, 33, 36, 63, 33, 683, 37, 36, 33, 92}, 
{103, 173, 243, 313, 383, 453, 523, 593, 663, 733, 35, 35, 35, 36, 36, 36, 37, 37, 37, 38, 33, 33, 34, 34, 34, 35, 35, 35, 35, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 126, 34, 33, 36, 73, 33, 733, 38, 36, 33, 93}, 
{103, 173, 243, 313, 383, 453, 523, 593, 663, 783, 35, 35, 35, 36, 36, 36, 37, 37, 37, 38, 33, 33, 34, 34, 34, 35, 35, 35, 35, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 127, 34, 33, 36, 78, 33, 783, 38, 36, 33, 94}, 
{113, 193, 273, 353, 433, 513, 593, 673, 753, 833, 34, 34, 34, 34, 35, 35, 35, 35, 36, 36, 33, 33, 34, 34, 34, 34, 35, 35, 35, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 128, 34, 33, 36, 83, 83, 833, 36, 35, 33, 95}, 
{113, 193, 273, 353, 433, 513, 593, 673, 753, 833, 35, 35, 35, 36, 36, 36, 37, 37, 37, 38, 33, 33, 34, 34, 34, 35, 35, 35, 35, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 129, 34, 33, 36, 83, 33, 833, 38, 35, 33, 96}, 
{113, 193, 273, 353, 433, 513, 593, 673, 753, 883, 35, 35, 35, 36, 36, 36, 37, 37, 37, 38, 33, 33, 34, 34, 34, 35, 35, 35, 35, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 130, 34, 33, 36, 88, 33, 883, 38, 36, 33, 97}, 
{123, 213, 303, 393, 483, 573, 663, 753, 843, 933, 34, 34, 35, 35, 36, 36, 36, 37, 37, 37, 33, 33, 34, 34, 34, 35, 35, 35, 35, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 131, 34, 33, 36, 93, 33, 933, 37, 36, 33, 98}, 
{123, 213, 303, 393, 483, 573, 663, 753, 843, 933, 34, 34, 35, 35, 36, 36, 36, 37, 37, 38, 33, 33, 34, 34, 34, 35, 35, 35, 35, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 132, 34, 33, 36, 93, 33, 933, 38, 36, 33, 99}, 
{133, 233, 333, 433, 533, 633, 733, 833, 933, 1033, 34, 34, 35, 35, 36, 36, 36, 37, 37, 38, 33, 33, 34, 34, 34, 35, 35, 35, 36, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 133, 34, 33, 36, 103, 33, 1033, 38, 36, 33, 100}, 
{133, 233, 333, 433, 533, 633, 733, 833, 933, 1033, 34, 34, 35, 35, 36, 36, 36, 37, 37, 38, 33, 33, 34, 34, 34, 35, 35, 35, 36, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 134, 34, 33, 36, 103, 33, 1033, 38, 36, 33, 101}, 
{133, 233, 333, 433, 533, 633, 733, 833, 933, 1033, 34, 34, 35, 35, 36, 36, 36, 37, 37, 38, 33, 33, 34, 34, 34, 35, 35, 35, 36, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 135, 34, 33, 36, 103, 33, 1033, 38, 36, 33, 102}, 
{143, 253, 363, 473, 583, 693, 803, 913, 1023, 1133, 34, 34, 35, 35, 36, 36, 36, 37, 37, 38, 33, 33, 34, 34, 34, 35, 35, 35, 35, 35, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 136, 34, 33, 36, 113, 33, 1133, 38, 35, 33, 103}, 
{143, 253, 363, 473, 583, 693, 803, 913, 1023, 1133, 34, 34, 35, 35, 36, 36, 36, 37, 37, 38, 33, 33, 34, 34, 34, 35, 35, 35, 36, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 137, 34, 33, 36, 113, 33, 1133, 38, 36, 33, 104}, 
{143, 253, 363, 473, 583, 693, 803, 913, 1023, 1133, 34, 34, 35, 35, 36, 36, 36, 37, 37, 38, 33, 33, 34, 34, 34, 35, 35, 35, 36, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 138, 34, 33, 36, 53, 33, 1133, 38, 36, 33, 105}, 
{153, 273, 393, 513, 633, 753, 873, 993, 1113, 1233, 34, 34, 35, 35, 36, 36, 36, 37, 37, 38, 33, 33, 34, 34, 34, 35, 35, 35, 36, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 139, 34, 33, 36, 123, 33, 1233, 38, 36, 33, 106}, 
{153, 273, 393, 513, 633, 753, 873, 993, 1113, 1233, 34, 34, 35, 35, 36, 36, 36, 37, 37, 38, 33, 33, 34, 34, 34, 35, 35, 35, 36, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 140, 34, 33, 36, 123, 33, 1233, 38, 36, 33, 107}, 
{153, 273, 393, 513, 633, 753, 873, 993, 1113, 1233, 34, 34, 35, 35, 36, 36, 36, 37, 37, 38, 33, 33, 34, 34, 34, 35, 35, 35, 36, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 141, 34, 33, 36, 123, 33, 1233, 38, 36, 33, 108}, 
{43, 63, 83, 103, 123, 143, 163, 183, 203, 1633, 34, 34, 34, 34, 34, 35, 35, 35, 35, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 34, 34, 33, 33, 34, 33, 1633, 38, 33, 33, 109}, 
{53, 73, 93, 113, 133, 153, 173, 193, 213, 1533, 35, 35, 36, 36, 37, 37, 38, 38, 39, 40, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 60, 35, 33, 34, 34, 33, 1533, 40, 33, 33, 110}, 
{53, 73, 93, 113, 133, 153, 173, 193, 213, 1533, 35, 35, 36, 36, 37, 37, 38, 38, 39, 39, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 83, 36, 33, 35, 34, 33, 1533, 39, 33, 33, 111}, 
{53, 53, 73, 103, 133, 153, 173, 193, 213, 1433, 35, 35, 36, 36, 37, 37, 38, 38, 38, 38, 33, 33, 33, 33, 33, 33, 33, 33, 33, 36, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 101, 37, 33, 36, 34, 33, 1433, 38, 36, 33, 112}, 
{43, 63, 83, 103, 123, 143, 163, 183, 203, 233, 34, 34, 34, 34, 34, 35, 35, 35, 39, 40, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 33, 146, 34, 33, 33, 34, 83, 233, 40, 33, 33, 113}}
CSSDSX = {
{71, 45, 61, 47, 101, 34, 1033, 1033, 34, 34, 433, 133, 113, 533, 6033, 71, 45, 61, 47, 101, 0}, 
{81, 33, 62, 48, 123, 34, 1033, 1033, 34, 34, 433, 133, 133, 533, 4033, 81, 33, 62, 48, 123, 1}, 
{87, 36, 65, 49, 192, 34, 1033, 1033, 34, 34, 433, 133, 133, 633, 2233, 87, 36, 65, 49, 192, 2}, 
{96, 40, 66, 50, 208, 34, 1033, 1033, 34, 34, 433, 233, 153, 633, 3133, 96, 40, 66, 50, 208, 3}, 
{60, 42, 67, 55, 102, 34, 1033, 1033, 35, 34, 2033, 83, 163, 433, 8033, 60, 42, 67, 55, 102, 4}}
DFCZR = {
{36, 34, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{37, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{37, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{423, 425, 427, 432, 105, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{36, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{453, 454, 455, 456, 457, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{462, 461, 460, 459, 458, 457, 456, 455, 454, 453, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{130, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{334, 335, 336, 337, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{40, 199, 373, 375, 377, 379, 381, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{51, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{140, 141, 142, 396, 398, 393, 394, 402, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{200, 201, 41, 389, 390, 391, 385, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{51, 323, 322, 320, 319, 318, 251, 271, 270, 269, 268, 432, 431, 430, 429, 480, 281, 253, 267, 317}, 
{206, 207, 208, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{43, 44, 48, 45, 46, 47, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{70, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{41, 201, 200, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 32, 32, 32, 32, 32, 32, 32}, 
{40, 124, 125, 126, 127, 128, 129, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{40, 199, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 32, 32, 32, 32, 32, 32, 32, 32}, 
{39, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{363, 364, 365, 366, 367, 368, 369, 370, 371, 372, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{38, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{413, 414, 415, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{54, 413, 414, 415, 416, 417, 418, 419, 420, 421, 422, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{234, 235, 236, 237, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{56, 242, 235, 236, 237, 238, 243, 240, 241, 239, 234, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{403, 404, 405, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{53, 412, 410, 409, 408, 407, 406, 405, 404, 411, 403, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{224, 225, 226, 227, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{56, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{54, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{53, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{55, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{69, 232, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{54, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{53, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{55, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{55, 228, 225, 229, 227, 224, 226, 230, 231, 232, 233, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{54, 222, 223, 216, 217, 218, 219, 220, 221, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{56, 234, 235, 236, 242, 243, 239, 240, 241, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{53, 204, 205, 212, 207, 208, 209, 210, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{127, 128, 129, 85, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{64, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{65, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{66, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{67, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{64, 65, 66, 67, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{247, 248, 249, 250, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{244, 245, 246, 247, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{57, 244, 246, 247, 248, 249, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{57, 247, 245, 249, 251, 253, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{194, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{57, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{60, 64, 65, 66, 67, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 32, 32, 32, 32, 32}, 
{59, 64, 65, 66, 67, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 32, 32, 32, 32, 32}, 
{52, 402, 401, 400, 53, 412, 411, 410, 54, 422, 421, 420, 55, 233, 232, 231, 56, 243, 242, 241}, 
{60, 64, 65, 66, 67, 264, 265, 266, 267, 268, 269, 270, 271, 272, 273, 32, 32, 32, 32, 32}, 
{274, 275, 276, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{76, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{76, 274, 275, 276, 277, 278, 279, 280, 281, 282, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{463, 464, 465, 466, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{465, 466, 467, 468, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{466, 467, 468, 469, 470, 471, 472, 465, 464, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{467, 468, 469, 470, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{472, 471, 470, 469, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{452, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{97, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{98, 88, 89, 152, 153, 154, 155, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{94, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{314, 315, 316, 317, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{100, 314, 315, 316, 317, 318, 319, 320, 321, 322, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{100, 314, 315, 316, 317, 318, 319, 320, 321, 322, 323, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{101, 161, 156, 160, 157, 158, 159, 333, 332, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{95, 190, 191, 192, 193, 117, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{91, 92, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{88, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{94, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{223, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{433, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{103, 202, 203, 32, 147, 442, 441, 440, 439, 438, 437, 436, 435, 434, 433, 32, 32, 32, 32, 32}, 
{84, 81, 136, 131, 132, 133, 77, 304, 309, 307, 305, 310, 311, 312, 306, 308, 32, 32, 32, 32}, 
{304, 305, 306, 307, 308, 309, 310, 311, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{83, 102, 492, 491, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{304, 305, 306, 307, 308, 309, 310, 311, 312, 313, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{84, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{79, 294, 295, 296, 297, 298, 299, 300, 301, 302, 303, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{294, 295, 296, 297, 298, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{81, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{344, 345, 346, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{344, 345, 346, 347, 348, 349, 350, 77, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{284, 285, 392, 287, 171, 224, 275, 255, 245, 295, 316, 374, 32, 32, 32, 32, 32, 32, 32, 32}, 
{170, 314, 318, 315, 323, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{231, 251, 260, 271, 283, 239, 244, 250, 319, 320, 321, 322, 289, 301, 311, 343, 32, 32, 32, 32}, 
{423, 424, 425, 426, 427, 428, 429, 430, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{423, 424, 425, 426, 427, 428, 429, 430, 431, 432, 104, 120, 32, 32, 32, 32, 32, 32, 32, 32}, 
{254, 255, 256, 257, 258, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{257, 258, 259, 260, 261, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{259, 260, 261, 262, 263, 258, 257, 58, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{284, 285, 286, 287, 288, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 136, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{87, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{76, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{131, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{183, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{195, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{100, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{52, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{222, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{104, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{103, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{136, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{59, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{102, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{95, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{93, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{97, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{162, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{38, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{90, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{46, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{88, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{95, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{100, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{103, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{104, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{59, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{90, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{530, 531, 532, 533, 534, 536, 537, 538, 541, 542, 543, 544, 545, 546, 547, 586, 32, 32, 32, 32}, 
{551, 569, 568, 567, 566, 565, 564, 563, 562, 561, 560, 559, 558, 557, 556, 555, 554, 553, 549, 550}, 
{590, 589, 588, 587, 570, 585, 584, 583, 582, 581, 580, 579, 578, 577, 576, 575, 574, 572, 571, 573}, 
{610, 609, 608, 607, 606, 605, 604, 603, 602, 601, 600, 599, 598, 597, 596, 595, 594, 593, 592, 591}, 
{110, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{104, 100, 95, 93, 136, 59, 55, 52, 190, 191, 192, 195, 196, 183, 131, 32, 32, 32, 32, 32}, 
{162, 38, 83, 222, 90, 97, 101, 102, 103, 156, 157, 158, 159, 202, 203, 32, 32, 32, 32, 32}, 
{97, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{172, 183, 119, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{222, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{108, 32, 32, 187, 188, 189, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{108, 186, 185, 187, 188, 189, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{185, 187, 107, 186, 108, 188, 189, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{32, 479, 478, 474, 476, 475, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{113, 483, 482, 481, 480, 479, 478, 477, 476, 475, 474, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{113, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{108, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{114, 198, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{40, 199, 373, 375, 377, 379, 381, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{140, 141, 142, 396, 398, 393, 394, 402, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{200, 201, 41, 389, 390, 391, 385, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{203, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{39, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{473, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{41, 201, 200, 383, 384, 385, 386, 387, 388, 389, 390, 391, 392, 32, 32, 32, 32, 32, 32, 32}, 
{41, 201, 200, 142, 140, 141, 393, 394, 395, 389, 390, 391, 392, 396, 397, 398, 399, 400, 401, 402}, 
{41, 201, 200, 142, 140, 141, 39, 372, 371, 389, 390, 391, 388, 370, 369, 368, 399, 400, 401, 398}, 
{40, 199, 373, 374, 375, 376, 377, 378, 379, 380, 381, 382, 32, 32, 32, 32, 32, 32, 32, 32}, 
{48, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{209, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{213, 214, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{216, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{216, 214, 215, 213, 211, 210, 212, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{217, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{259, 260, 261, 262, 263, 258, 257, 116, 256, 255, 254, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{259, 260, 261, 262, 263, 258, 257, 254, 256, 255, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{116, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{218, 219, 220, 221, 215, 216, 87, 124, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{490, 489, 488, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{487, 486, 485, 484, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{195, 196, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{74, 75, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{72, 73, 74, 75, 71, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{93, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{93, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{93, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{93, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{100, 93, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{93, 100, 449, 443, 451, 444, 450, 445, 446, 447, 448, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{162, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{94, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{152, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{153, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{154, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{155, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{101, 161, 156, 160, 157, 158, 159, 333, 332, 97, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{101, 161, 156, 160, 157, 158, 159, 333, 332, 102, 97, 90, 32, 32, 32, 32, 32, 32, 32, 32}, 
{101, 161, 156, 160, 157, 158, 159, 333, 332, 102, 97, 90, 162, 32, 32, 32, 32, 32, 32, 32}, 
{101, 161, 156, 160, 157, 158, 159, 333, 332, 97, 102, 98, 90, 32, 32, 32, 32, 32, 32, 32}, 
{101, 161, 156, 160, 157, 158, 159, 333, 332, 324, 325, 326, 327, 328, 329, 330, 331, 32, 32, 32}, 
{102, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{163, 164, 165, 166, 32, 168, 167, 169, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{423, 425, 427, 432, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{131, 132, 77, 133, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{143, 144, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{143, 144, 78, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{143, 144, 78, 304, 313, 311, 309, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{143, 144, 78, 304, 313, 311, 309, 441, 437, 435, 442, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{143, 144, 78, 304, 313, 311, 309, 441, 437, 435, 442, 242, 232, 380, 361, 399, 421, 385, 330, 407}, 
{32, 81, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{84, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{84, 81, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{84, 81, 136, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{117, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{151, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{244, 245, 246, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{68, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{174, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{176, 177, 178, 179, 180, 181, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{174, 175, 224, 225, 226, 227, 228, 229, 230, 231, 232, 233, 32, 32, 32, 32, 32, 32, 32, 32}, 
{493, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{139, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{239, 240, 273, 269, 232, 228, 250, 253, 271, 269, 268, 367, 410, 411, 420, 418, 265, 368, 264, 403}, 
{59, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{494, 495, 496, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{494, 495, 496, 497, 498, 499, 500, 501, 502, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{494, 495, 496, 497, 498, 499, 500, 501, 502, 503, 504, 505, 506, 507, 508, 509, 510, 511, 32, 32}, 
{512, 513, 514, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{512, 513, 514, 515, 516, 517, 518, 519, 520, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{512, 513, 514, 515, 516, 517, 518, 519, 520, 521, 522, 523, 524, 525, 526, 527, 528, 529, 32, 32}, 
{52, 53, 54, 55, 56, 103, 202, 203, 442, 433, 441, 434, 435, 436, 437, 438, 439, 440, 32, 32}, 
{244, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{324, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{324, 161, 325, 160, 326, 327, 328, 333, 332, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{383, 384, 385, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{32, 203, 32, 32, 32, 32, 441, 32, 439, 32, 437, 436, 435, 434, 433, 32, 32, 32, 32, 32}, 
{621, 620, 619, 618, 617, 616, 614, 615, 613, 612, 611, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{205, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{478, 479, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32, 32}}
DFCZRX = {
{61, 61, 54, 54, 52, 51, 49, 49, 55, 55, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{56, 57, 57, 54, 54, 54, 54, 54, 57, 57, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64}, 
{56, 57, 57, 54, 54, 54, 54, 54, 57, 57, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64}, 
{61, 61, 63, 59, 55, 61, 57, 61, 57, 59, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{58, 59, 61, 57, 57, 61, 57, 61, 57, 59, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{55, 59, 55, 59, 61, 51, 51, 56, 57, 57, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{64, 59, 61, 56, 66, 57, 60, 66, 63, 61, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{60, 51, 54, 54, 52, 51, 49, 49, 55, 55, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{57, 59, 68, 65, 56, 51, 51, 51, 51, 51, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{58, 58, 58, 58, 58, 58, 58, 51, 51, 51, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{62, 55, 55, 55, 56, 51, 51, 51, 51, 51, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{58, 58, 58, 58, 58, 58, 58, 58, 54, 51, 55, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{60, 60, 60, 60, 60, 60, 58, 56, 58, 56, 58, 56, 58, 56, 58, 56, 58, 56, 63, 63}, 
{61, 60, 58, 63, 60, 57, 62, 56, 58, 63, 62, 64, 65, 66, 56, 55, 54, 64, 65, 67}, 
{55, 60, 58, 58, 57, 57, 60, 55, 55, 60, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{56, 56, 69, 69, 67, 56, 58, 56, 58, 56, 58, 56, 58, 56, 58, 56, 58, 56, 63, 63}, 
{50, 51, 55, 51, 50, 51, 54, 51, 54, 51, 55, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{47, 49, 49, 58, 57, 52, 60, 52, 57, 60, 54, 54, 58, 32, 32, 32, 32, 32, 32, 32}, 
{55, 55, 68, 61, 68, 59, 61, 51, 54, 51, 55, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{57, 59, 69, 61, 66, 66, 60, 67, 60, 67, 69, 61, 32, 32, 32, 32, 32, 32, 32, 32}, 
{62, 62, 62, 62, 62, 60, 60, 60, 60, 60, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{62, 62, 62, 62, 62, 60, 60, 60, 60, 60, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{50, 62, 62, 62, 62, 60, 60, 60, 60, 60, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{62, 60, 65, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{63, 66, 63, 58, 58, 60, 67, 59, 68, 68, 62, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{60, 63, 60, 63, 61, 58, 56, 56, 58, 63, 60, 55, 64, 60, 58, 60, 32, 32, 32, 32}, 
{51, 59, 56, 54, 53, 52, 56, 52, 54, 56, 56, 55, 64, 60, 58, 60, 32, 32, 32, 32}, 
{64, 60, 62, 51, 55, 51, 54, 51, 54, 51, 55, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{61, 62, 63, 65, 61, 58, 54, 70, 54, 70, 62, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{84, 81, 82, 82, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{46, 52, 46, 50, 52, 48, 48, 57, 57, 50, 46, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{58, 57, 60, 61, 61, 58, 56, 56, 58, 63, 60, 55, 64, 60, 58, 60, 32, 32, 32, 32}, 
{55, 51, 55, 51, 55, 51, 54, 51, 54, 51, 55, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{54, 59, 64, 59, 55, 51, 54, 51, 54, 51, 55, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{48, 65, 61, 61, 57, 61, 57, 61, 57, 59, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{72, 65, 61, 61, 57, 61, 57, 61, 57, 59, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{47, 65, 61, 61, 57, 61, 57, 61, 57, 59, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{71, 65, 61, 61, 57, 61, 57, 61, 57, 59, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{46, 54, 50, 50, 57, 61, 57, 61, 57, 59, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{55, 51, 55, 51, 55, 51, 54, 51, 54, 51, 55, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{62, 59, 65, 62, 49, 48, 48, 52, 53, 52, 46, 46, 59, 53, 57, 63, 63, 63, 63, 63}, 
{61, 65, 62, 58, 61, 60, 48, 52, 53, 52, 46, 46, 59, 53, 57, 63, 63, 63, 63, 63}, 
{61, 61, 63, 60, 62, 59, 48, 52, 53, 52, 46, 46, 59, 53, 57, 63, 63, 63, 63, 63}, 
{64, 59, 61, 57, 57, 61, 57, 61, 57, 59, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{52, 51, 55, 51, 55, 51, 54, 51, 54, 51, 55, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{46, 48, 48, 48, 48, 50, 50, 50, 50, 50, 50, 52, 52, 52, 52, 52, 54, 54, 54, 54}, 
{46, 48, 48, 48, 48, 50, 50, 50, 50, 50, 50, 52, 52, 52, 52, 52, 54, 54, 54, 54}, 
{62, 63, 64, 65, 65, 66, 67, 68, 65, 66, 67, 68, 69, 70, 71, 72, 69, 70, 71, 72}, 
{46, 48, 48, 48, 48, 50, 50, 50, 50, 50, 50, 52, 52, 52, 52, 52, 54, 54, 54, 54}, 
{56, 53, 57, 54, 52, 51, 49, 49, 55, 55, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{60, 51, 54, 54, 52, 51, 49, 49, 55, 55, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{60, 58, 60, 62, 56, 58, 57, 62, 60, 60, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{78, 80, 80, 78, 48, 53, 61, 64, 67, 65, 65, 53, 53, 52, 52, 50, 48, 48, 63, 63}, 
{62, 61, 61, 63, 48, 53, 61, 64, 67, 65, 65, 53, 53, 52, 52, 50, 48, 48, 63, 63}, 
{48, 50, 51, 48, 48, 53, 54, 50, 51, 65, 65, 53, 53, 52, 52, 50, 48, 48, 63, 63}, 
{46, 47, 47, 48, 48, 53, 61, 64, 67, 65, 65, 53, 53, 52, 52, 50, 48, 48, 63, 63}, 
{63, 63, 64, 64, 48, 53, 61, 64, 67, 65, 65, 53, 53, 52, 52, 50, 48, 48, 63, 63}, 
{57, 50, 50, 48, 48, 53, 61, 64, 67, 65, 65, 53, 53, 52, 52, 50, 48, 48, 63, 63}, 
{60, 59, 61, 57, 57, 61, 57, 61, 57, 59, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{53, 53, 53, 51, 51, 50, 50, 54, 57, 57, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64}, 
{66, 51, 55, 51, 55, 51, 54, 51, 54, 51, 55, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{59, 63, 62, 61, 57, 57, 60, 55, 55, 60, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{55, 60, 58, 58, 57, 57, 60, 55, 55, 60, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{55, 60, 58, 58, 57, 57, 60, 55, 55, 60, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{62, 67, 66, 66, 64, 64, 67, 62, 62, 60, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{62, 63, 66, 67, 66, 63, 60, 55, 55, 60, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{64, 64, 58, 58, 57, 57, 60, 55, 55, 60, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{57, 56, 61, 57, 57, 61, 57, 61, 57, 59, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{57, 56, 61, 57, 57, 61, 57, 61, 57, 59, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{77, 50, 50, 48, 48, 53, 61, 64, 67, 65, 65, 53, 53, 52, 52, 50, 48, 48, 63, 63}, 
{58, 54, 53, 57, 56, 58, 56, 52, 54, 58, 61, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{64, 64, 66, 57, 69, 65, 62, 71, 66, 63, 65, 69, 69, 70, 67, 63, 63, 63, 63, 63}, 
{74, 74, 74, 76, 75, 78, 78, 75, 76, 80, 82, 81, 80, 84, 84, 82, 63, 63, 63, 63}, 
{45, 48, 51, 54, 54, 54, 50, 50, 46, 46, 46, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{55, 57, 59, 57, 54, 54, 50, 50, 46, 46, 46, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{45, 48, 51, 54, 54, 54, 50, 50, 46, 46, 46, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{45, 48, 51, 54, 54, 54, 50, 50, 46, 46, 46, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{69, 76, 74, 73, 71, 70, 74, 70, 68, 75, 72, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{60, 59, 60, 60, 59, 54, 50, 50, 46, 46, 46, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{45, 48, 51, 54, 54, 54, 50, 50, 46, 46, 46, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{67, 65, 65, 67, 67, 62, 62, 59, 57, 59, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{67, 65, 65, 67, 67, 62, 62, 59, 57, 59, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{61, 62, 67, 67, 66, 63, 62, 60, 65, 66, 64, 61, 63, 63, 63, 63, 63, 63, 63, 63}, 
{60, 62, 64, 62, 64, 54, 50, 50, 46, 46, 46, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{45, 48, 51, 54, 54, 54, 50, 50, 46, 46, 46, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{60, 58, 60, 58, 60, 58, 60, 58, 54, 51, 55, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{59, 61, 58, 58, 60, 59, 62, 64, 62, 64, 62, 60, 32, 32, 32, 32, 32, 32, 32, 32}, 
{57, 57, 57, 56, 56, 54, 54, 54, 57, 57, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64}, 
{57, 57, 57, 56, 56, 54, 54, 54, 57, 57, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64}, 
{57, 57, 57, 56, 56, 56, 56, 59, 57, 57, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64}, 
{55, 51, 55, 51, 55, 51, 54, 51, 54, 51, 55, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{55, 51, 55, 51, 55, 51, 54, 51, 54, 51, 55, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{57, 57, 57, 54, 54, 54, 54, 54, 57, 57, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{62, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 53, 63, 63, 63}, 
{55, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{73, 60, 58, 58, 57, 57, 60, 55, 55, 60, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{61, 61, 61, 61, 61, 61, 61, 65, 65, 65, 65, 65, 65, 65, 63, 63, 63, 63, 63, 63}, 
{61, 61, 61, 61, 61, 61, 61, 65, 65, 65, 65, 65, 65, 65, 63, 63, 63, 63, 63, 63}, 
{59, 59, 61, 57, 57, 61, 57, 61, 57, 59, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{60, 60, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{55, 62, 60, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{57, 57, 57, 57, 57, 57, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{56, 60, 56, 59, 60, 59, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{57, 55, 55, 57, 57, 55, 55, 64, 67, 65, 65, 53, 53, 52, 52, 50, 48, 48, 63, 63}, 
{57, 57, 57, 57, 57, 57, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{61, 58, 58, 56, 59, 56, 57, 56, 60, 59, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{57, 55, 55, 57, 57, 55, 55, 64, 67, 65, 65, 53, 53, 52, 52, 50, 48, 48, 63, 63}, 
{57, 55, 55, 57, 57, 55, 55, 64, 67, 65, 65, 53, 53, 52, 52, 50, 48, 48, 63, 63}, 
{74, 75, 58, 58, 57, 57, 60, 55, 55, 60, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{58, 58, 58, 58, 58, 58, 58, 51, 51, 51, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{58, 58, 58, 58, 58, 58, 58, 58, 54, 51, 55, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{60, 60, 60, 60, 60, 60, 58, 56, 58, 56, 58, 56, 58, 56, 58, 56, 58, 56, 63, 63}, 
{60, 60, 60, 60, 60, 60, 58, 56, 58, 56, 58, 56, 58, 56, 58, 56, 58, 56, 63, 63}, 
{60, 60, 60, 60, 60, 60, 58, 56, 58, 56, 58, 56, 58, 56, 58, 56, 58, 56, 63, 63}, 
{61, 60, 60, 60, 60, 60, 58, 56, 58, 56, 58, 56, 58, 56, 58, 56, 58, 56, 63, 63}, 
{57, 49, 53, 49, 55, 51, 55, 51, 53, 48, 57, 53, 51, 32, 32, 32, 32, 32, 32, 32}, 
{51, 49, 53, 49, 57, 51, 57, 54, 56, 54, 53, 48, 51, 52, 50, 51, 59, 59, 57, 57}, 
{52, 61, 57, 54, 57, 54, 57, 59, 57, 59, 52, 52, 61, 63, 58, 56, 63, 63, 63, 63}, 
{66, 60, 63, 60, 63, 63, 61, 59, 61, 59, 63, 66, 32, 32, 32, 32, 32, 32, 32, 32}, 
{56, 60, 58, 58, 57, 57, 60, 55, 55, 60, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{49, 60, 58, 58, 57, 57, 60, 55, 55, 60, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{63, 63, 58, 58, 57, 57, 60, 55, 55, 60, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{63, 54, 58, 58, 57, 57, 60, 55, 55, 60, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{62, 66, 64, 62, 63, 65, 67, 55, 55, 60, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{53, 54, 58, 58, 57, 57, 60, 55, 55, 60, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{57, 57, 57, 56, 56, 56, 56, 58, 58, 59, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64}, 
{57, 57, 57, 56, 56, 56, 58, 56, 58, 59, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64}, 
{57, 57, 57, 54, 54, 54, 54, 54, 57, 57, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64}, 
{56, 56, 59, 58, 57, 59, 56, 59, 55, 60, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{83, 84, 84, 54, 54, 54, 54, 83, 57, 57, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64}, 
{57, 57, 57, 54, 54, 54, 54, 54, 57, 57, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64}, 
{57, 57, 57, 54, 54, 54, 54, 54, 57, 57, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64}, 
{47, 54, 62, 62, 62, 60, 60, 60, 60, 60, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{60, 68, 62, 65, 67, 53, 61, 64, 67, 65, 65, 53, 53, 52, 52, 50, 48, 48, 63, 63}, 
{47, 62, 62, 62, 62, 60, 60, 60, 60, 60, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{67, 59, 54, 54, 52, 51, 49, 49, 55, 55, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{65, 59, 54, 54, 52, 51, 49, 49, 55, 55, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{65, 59, 54, 54, 52, 51, 49, 49, 55, 55, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{50, 50, 57, 54, 54, 54, 54, 54, 57, 57, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64}, 
{73, 76, 75, 75, 74, 74, 76, 73, 73, 76, 75, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{69, 60, 58, 58, 57, 57, 60, 55, 55, 60, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{66, 59, 54, 54, 52, 51, 49, 49, 55, 55, 63, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{69, 57, 57, 54, 54, 54, 54, 54, 57, 57, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64}, 
{69, 57, 57, 54, 54, 54, 54, 54, 57, 57, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64}, 
{67, 57, 57, 54, 54, 54, 54, 54, 57, 57, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64}, 
{62, 57, 57, 54, 54, 54, 54, 54, 57, 57, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64}, 
{72, 77, 75, 75, 74, 74, 77, 72, 72, 77, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{75, 77, 72, 75, 74, 74, 77, 72, 72, 69, 71, 77, 63, 63, 63, 63, 63, 63, 63, 63}, 
{72, 77, 75, 75, 74, 74, 77, 72, 72, 77, 75, 71, 78, 63, 63, 63, 63, 63, 63, 63}, 
{72, 77, 75, 75, 74, 74, 77, 72, 72, 77, 75, 72, 77, 63, 63, 63, 63, 63, 63, 63}, 
{76, 73, 73, 72, 74, 73, 77, 74, 72, 77, 73, 75, 75, 77, 75, 77, 75, 63, 63, 63}, 
{57, 57, 57, 54, 54, 54, 54, 54, 57, 57, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64}, 
{50, 47, 50, 47, 55, 47, 47, 47, 54, 51, 55, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{72, 76, 75, 75, 57, 61, 57, 61, 57, 59, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{72, 76, 75, 75, 57, 61, 57, 61, 57, 59, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{62, 62, 55, 51, 55, 51, 54, 51, 54, 51, 55, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{62, 62, 61, 51, 55, 51, 54, 51, 54, 51, 55, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{62, 62, 61, 64, 66, 68, 70, 51, 54, 51, 55, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{62, 62, 61, 64, 66, 68, 70, 65, 67, 69, 71, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{62, 62, 61, 64, 66, 68, 70, 65, 67, 69, 71, 68, 70, 68, 68, 68, 70, 70, 70, 68}, 
{53, 74, 53, 57, 56, 58, 56, 52, 54, 58, 61, 63, 63, 63, 63, 64, 63, 63, 63, 63}, 
{74, 54, 53, 57, 56, 58, 56, 52, 54, 58, 61, 63, 63, 63, 63, 64, 63, 63, 63, 63}, 
{74, 74, 53, 57, 56, 58, 56, 52, 54, 58, 61, 63, 63, 63, 63, 64, 63, 63, 63, 63}, 
{74, 74, 73, 57, 56, 58, 56, 52, 54, 58, 61, 63, 63, 63, 63, 64, 63, 63, 63, 63}, 
{58, 48, 51, 54, 54, 54, 50, 50, 46, 46, 46, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{72, 48, 51, 54, 54, 54, 50, 50, 46, 46, 46, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{52, 55, 57, 51, 55, 51, 54, 51, 54, 51, 55, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{45, 48, 51, 54, 54, 54, 50, 50, 46, 46, 46, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{55, 62, 62, 62, 62, 60, 60, 60, 60, 60, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{45, 48, 51, 54, 54, 54, 50, 50, 46, 46, 46, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{59, 59, 61, 57, 57, 61, 57, 61, 57, 59, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{64, 62, 55, 51, 55, 51, 54, 51, 54, 51, 55, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{55, 62, 55, 51, 55, 51, 54, 51, 54, 51, 55, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{55, 55, 55, 55, 55, 55, 55, 58, 60, 58, 60, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{54, 62, 55, 51, 55, 51, 54, 51, 54, 51, 55, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{67, 67, 67, 57, 56, 58, 56, 52, 54, 58, 61, 63, 63, 63, 63, 64, 63, 63, 63, 63}, 
{67, 67, 67, 65, 65, 65, 63, 63, 63, 61, 61, 61, 59, 59, 59, 57, 57, 57, 63, 63}, 
{67, 67, 67, 65, 65, 65, 63, 63, 63, 61, 61, 61, 59, 59, 59, 57, 57, 57, 63, 63}, 
{67, 67, 67, 57, 56, 58, 56, 52, 54, 58, 61, 63, 63, 63, 63, 64, 63, 63, 63, 63}, 
{67, 67, 67, 65, 65, 65, 63, 63, 63, 61, 61, 61, 59, 59, 59, 57, 57, 57, 63, 63}, 
{67, 67, 67, 65, 65, 65, 63, 63, 63, 61, 61, 61, 59, 59, 59, 57, 57, 57, 63, 63}, 
{59, 61, 61, 60, 59, 57, 57, 56, 67, 64, 66, 65, 65, 63, 63, 67, 64, 66, 63, 63}, 
{51, 57, 51, 52, 49, 48, 48, 52, 53, 52, 46, 46, 59, 53, 57, 63, 63, 63, 63, 63}, 
{67, 60, 58, 58, 57, 57, 60, 55, 55, 60, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{49, 49, 45, 48, 48, 45, 45, 48, 49, 60, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{81, 81, 79, 60, 60, 60, 57, 57, 57, 57, 57, 55, 55, 55, 55, 63, 63, 63, 63, 63}, 
{53, 59, 53, 57, 56, 58, 61, 52, 57, 58, 59, 61, 61, 61, 59, 63, 63, 63, 63, 63}, 
{45, 49, 49, 49, 54, 52, 52, 54, 57, 56, 57, 63, 63, 63, 63, 63, 63, 63, 63, 63}, 
{50, 57, 57, 54, 54, 54, 54, 54, 57, 57, 64, 64, 64, 64, 64, 64, 64, 64, 64, 64}, 
{55, 56, 57, 60, 59, 51, 51, 56, 57, 57, 58, 63, 63, 63, 63, 63, 63, 63, 63, 63}}
DFCZRY = {
{60, 56, 52, 60, 59, 53, 55, 58, 58, 54, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{54, 55, 59, 57, 55, 59, 53, 61, 53, 61, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{54, 55, 59, 57, 55, 59, 53, 61, 53, 61, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{59, 55, 57, 57, 57, 54, 54, 59, 59, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{57, 54, 57, 57, 59, 54, 54, 59, 59, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{68, 68, 72, 72, 70, 51, 54, 57, 66, 69, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{53, 58, 55, 55, 56, 57, 50, 53, 51, 57, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{59, 56, 52, 60, 59, 53, 55, 58, 58, 54, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{63, 70, 63, 70, 71, 72, 68, 64, 57, 53, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{69, 71, 76, 73, 67, 65, 63, 64, 57, 53, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{60, 57, 53, 56, 71, 72, 68, 64, 57, 53, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{77, 75, 73, 71, 69, 67, 65, 63, 54, 54, 67, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{68, 71, 74, 65, 77, 62, 68, 68, 71, 71, 74, 74, 65, 65, 77, 77, 62, 62, 72, 73}, 
{60, 56, 57, 52, 52, 55, 57, 56, 52, 55, 53, 58, 57, 56, 58, 57, 56, 53, 54, 55}, 
{60, 60, 57, 63, 63, 57, 59, 59, 61, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{62, 77, 62, 77, 70, 70, 68, 68, 71, 71, 74, 74, 65, 65, 77, 77, 62, 62, 72, 73}, 
{62, 69, 66, 66, 63, 63, 57, 57, 54, 54, 67, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{61, 59, 63, 60, 57, 64, 58, 58, 65, 64, 62, 60, 62, 32, 32, 32, 32, 32, 32, 32}, 
{61, 60, 60, 57, 61, 61, 65, 57, 54, 54, 67, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{60, 61, 60, 65, 59, 63, 58, 60, 64, 62, 61, 57, 32, 32, 32, 32, 32, 32, 32, 32}, 
{60, 62, 64, 58, 56, 60, 62, 64, 58, 56, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{60, 62, 64, 58, 56, 60, 62, 64, 58, 56, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{61, 62, 64, 58, 56, 60, 62, 64, 58, 56, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{73, 75, 75, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{50, 51, 59, 58, 55, 51, 53, 53, 55, 58, 59, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{62, 63, 60, 59, 55, 56, 57, 53, 52, 52, 50, 60, 55, 64, 66, 62, 32, 32, 32, 32}, 
{61, 61, 66, 59, 61, 64, 57, 59, 64, 60, 63, 60, 55, 64, 66, 62, 32, 32, 32, 32}, 
{81, 81, 81, 66, 63, 63, 57, 57, 54, 54, 67, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{47, 55, 61, 51, 61, 51, 57, 59, 55, 57, 64, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{62, 62, 64, 60, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{67, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{67, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{67, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{67, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{67, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{67, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{67, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{67, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{60, 58, 62, 58, 62, 62, 58, 60, 61, 62, 58, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{67, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{60, 63, 59, 57, 55, 56, 57, 53, 52, 52, 50, 60, 55, 64, 66, 62, 32, 32, 32, 32}, 
{69, 69, 66, 66, 63, 63, 57, 57, 54, 54, 67, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{57, 60, 57, 54, 63, 63, 57, 57, 54, 54, 67, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{75, 57, 60, 54, 59, 54, 54, 59, 59, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{75, 57, 60, 54, 59, 54, 54, 59, 59, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{69, 57, 60, 54, 59, 54, 54, 59, 59, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{68, 57, 60, 54, 59, 54, 54, 59, 59, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{59, 58, 62, 55, 59, 54, 54, 59, 59, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{69, 69, 66, 66, 63, 63, 57, 57, 54, 54, 67, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{57, 59, 59, 60, 61, 62, 58, 58, 56, 53, 53, 71, 63, 60, 61, 69, 70, 71, 72, 73}, 
{48, 51, 51, 51, 53, 51, 58, 58, 56, 53, 53, 71, 63, 60, 61, 69, 70, 71, 72, 73}, 
{48, 47, 47, 47, 47, 47, 58, 58, 56, 53, 53, 71, 63, 60, 61, 69, 70, 71, 72, 73}, 
{69, 54, 57, 57, 59, 54, 54, 59, 59, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{63, 69, 66, 66, 63, 63, 57, 57, 54, 54, 67, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{60, 57, 59, 61, 63, 56, 58, 60, 62, 64, 66, 57, 59, 61, 63, 65, 57, 59, 61, 63}, 
{60, 57, 59, 61, 63, 56, 58, 60, 62, 64, 66, 57, 59, 61, 63, 65, 57, 59, 61, 63}, 
{62, 62, 62, 62, 60, 60, 60, 60, 64, 64, 64, 64, 59, 59, 59, 59, 65, 65, 65, 65}, 
{60, 57, 59, 61, 63, 56, 58, 60, 62, 64, 66, 57, 59, 61, 63, 65, 57, 59, 61, 63}, 
{67, 65, 63, 60, 59, 53, 55, 58, 58, 54, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{50, 56, 52, 60, 59, 53, 55, 58, 58, 54, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{54, 54, 50, 55, 55, 51, 56, 51, 56, 52, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{67, 67, 65, 65, 73, 62, 71, 71, 71, 75, 67, 59, 56, 52, 49, 51, 52, 49, 72, 73}, 
{61, 64, 63, 61, 73, 62, 71, 71, 71, 75, 67, 59, 56, 52, 49, 51, 52, 49, 72, 73}, 
{63, 61, 60, 64, 62, 58, 58, 65, 65, 75, 67, 59, 56, 52, 49, 51, 52, 49, 72, 73}, 
{71, 72, 70, 71, 73, 62, 71, 71, 71, 75, 67, 59, 56, 52, 49, 51, 52, 49, 72, 73}, 
{54, 52, 53, 51, 73, 62, 71, 71, 71, 75, 67, 59, 56, 52, 49, 51, 52, 49, 72, 73}, 
{68, 70, 68, 64, 73, 62, 71, 71, 71, 75, 67, 59, 56, 52, 49, 51, 52, 49, 72, 73}, 
{62, 54, 57, 57, 59, 54, 54, 59, 59, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{67, 63, 71, 68, 66, 70, 64, 61, 53, 61, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{56, 69, 66, 66, 63, 63, 57, 57, 54, 54, 67, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{84, 85, 82, 87, 63, 57, 59, 59, 61, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{60, 60, 57, 63, 63, 57, 59, 59, 61, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{60, 60, 57, 63, 63, 57, 59, 59, 61, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{77, 79, 75, 81, 80, 75, 77, 75, 79, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{78, 81, 76, 78, 81, 76, 59, 59, 61, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{78, 77, 57, 63, 63, 57, 59, 59, 61, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{58, 61, 57, 57, 59, 54, 54, 59, 59, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{58, 61, 57, 57, 59, 54, 54, 59, 59, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{62, 70, 68, 64, 73, 62, 71, 71, 71, 75, 67, 59, 56, 52, 49, 51, 52, 49, 72, 73}, 
{61, 53, 56, 56, 59, 63, 65, 65, 69, 69, 69, 69, 66, 67, 68, 69, 70, 71, 72, 73}, 
{77, 67, 68, 56, 66, 70, 71, 79, 79, 74, 73, 76, 70, 69, 76, 69, 70, 71, 72, 73}, 
{77, 73, 75, 69, 71, 68, 82, 79, 81, 67, 67, 75, 83, 67, 83, 83, 70, 71, 72, 73}, 
{62, 62, 62, 62, 67, 57, 58, 66, 67, 57, 67, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{62, 66, 62, 59, 67, 57, 58, 66, 67, 57, 67, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{62, 62, 62, 62, 67, 57, 58, 66, 67, 57, 67, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{62, 62, 62, 62, 67, 57, 58, 66, 67, 57, 67, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{64, 62, 60, 65, 65, 60, 67, 67, 62, 64, 59, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{64, 61, 62, 60, 63, 57, 58, 66, 67, 57, 67, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{62, 62, 62, 62, 67, 57, 58, 66, 67, 57, 67, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{63, 61, 65, 67, 59, 59, 67, 63, 59, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{63, 61, 65, 67, 59, 59, 67, 63, 59, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{59, 58, 64, 58, 58, 56, 60, 62, 61, 57, 64, 63, 66, 67, 68, 69, 70, 71, 72, 73}, 
{57, 56, 54, 59, 61, 57, 58, 66, 67, 57, 67, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{62, 62, 62, 62, 67, 57, 58, 66, 67, 57, 67, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{63, 63, 61, 61, 59, 59, 57, 57, 54, 54, 67, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{47, 45, 53, 51, 49, 50, 53, 46, 47, 53, 50, 52, 32, 32, 32, 32, 32, 32, 32, 32}, 
{57, 55, 59, 58, 56, 59, 53, 61, 53, 61, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{57, 55, 59, 58, 56, 59, 53, 61, 53, 61, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{57, 55, 59, 58, 56, 60, 54, 57, 53, 61, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{69, 69, 66, 66, 63, 63, 57, 57, 54, 54, 67, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{69, 69, 66, 66, 63, 63, 57, 57, 54, 54, 67, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{57, 55, 59, 57, 55, 59, 53, 61, 53, 61, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{64, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{64, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{64, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{64, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{64, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{64, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{64, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{64, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{64, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{64, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{64, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{64, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{64, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{64, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{64, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{64, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{64, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{64, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{64, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{64, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{64, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{64, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{64, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{64, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{64, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{64, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{64, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{64, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{64, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{68, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 69, 64, 60, 57, 69, 70, 71, 72, 73}, 
{55, 60, 57, 63, 63, 57, 59, 59, 61, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{59, 57, 61, 63, 65, 67, 69, 69, 67, 65, 63, 61, 59, 57, 69, 69, 70, 71, 72, 73}, 
{59, 61, 57, 63, 65, 67, 69, 57, 59, 61, 63, 65, 67, 69, 69, 69, 70, 71, 72, 73}, 
{62, 54, 57, 57, 59, 54, 54, 59, 59, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{57, 56, 58, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{68, 59, 69, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{54, 52, 54, 56, 58, 60, 62, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{62, 64, 61, 59, 59, 64, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{59, 59, 57, 55, 57, 61, 60, 71, 71, 75, 67, 59, 56, 52, 49, 51, 52, 49, 72, 73}, 
{50, 52, 54, 56, 58, 60, 62, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{62, 57, 65, 61, 59, 65, 59, 63, 65, 67, 67, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{59, 59, 57, 55, 57, 61, 60, 71, 71, 75, 67, 59, 56, 52, 49, 51, 52, 49, 72, 73}, 
{59, 59, 57, 55, 57, 61, 60, 71, 71, 75, 67, 59, 56, 52, 49, 51, 52, 49, 72, 73}, 
{48, 48, 57, 63, 63, 57, 59, 59, 61, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{69, 71, 76, 73, 67, 65, 63, 64, 57, 53, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{77, 75, 73, 71, 69, 67, 65, 63, 54, 54, 67, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{68, 71, 74, 65, 77, 62, 68, 68, 71, 71, 74, 74, 65, 65, 77, 77, 62, 62, 72, 73}, 
{68, 71, 74, 65, 77, 62, 68, 68, 71, 71, 74, 74, 65, 65, 77, 77, 62, 62, 72, 73}, 
{68, 71, 74, 65, 77, 62, 68, 68, 71, 71, 74, 74, 65, 65, 77, 77, 62, 62, 72, 73}, 
{52, 71, 74, 65, 77, 62, 68, 68, 71, 71, 74, 74, 65, 65, 77, 77, 62, 62, 72, 73}, 
{58, 59, 63, 63, 62, 64, 60, 58, 59, 61, 64, 61, 61, 32, 32, 32, 32, 32, 32, 32}, 
{65, 62, 58, 60, 63, 63, 59, 62, 61, 60, 64, 61, 59, 61, 61, 57, 56, 66, 57, 65}, 
{59, 64, 66, 62, 63, 60, 59, 65, 56, 57, 61, 63, 58, 61, 61, 61, 59, 66, 63, 56}, 
{62, 62, 60, 60, 64, 58, 65, 64, 57, 58, 62, 60, 32, 32, 32, 32, 32, 32, 32, 32}, 
{66, 60, 57, 63, 63, 57, 59, 59, 61, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{59, 60, 57, 63, 63, 57, 59, 59, 61, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{65, 68, 57, 63, 63, 57, 59, 59, 61, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{65, 58, 57, 63, 63, 57, 59, 59, 61, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{61, 61, 60, 65, 67, 67, 67, 59, 61, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{58, 58, 57, 63, 63, 57, 59, 59, 61, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{57, 55, 59, 58, 56, 60, 54, 58, 56, 57, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{57, 55, 59, 58, 56, 60, 58, 54, 56, 57, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{57, 55, 59, 57, 55, 59, 53, 61, 53, 61, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{61, 60, 62, 63, 63, 60, 62, 61, 61, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{50, 52, 48, 57, 55, 59, 53, 52, 53, 61, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{57, 55, 59, 57, 55, 59, 53, 61, 53, 61, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{57, 55, 59, 57, 55, 59, 53, 61, 53, 61, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{47, 47, 64, 58, 56, 60, 62, 64, 58, 56, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{72, 74, 69, 68, 71, 62, 71, 71, 71, 75, 67, 59, 56, 52, 49, 51, 52, 49, 72, 73}, 
{67, 62, 64, 58, 56, 60, 62, 64, 58, 56, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{53, 54, 52, 60, 59, 53, 55, 58, 58, 54, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{55, 54, 52, 60, 59, 53, 55, 58, 58, 54, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{55, 54, 52, 60, 59, 53, 55, 58, 58, 54, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{68, 66, 59, 57, 55, 59, 53, 61, 53, 61, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{60, 59, 58, 62, 62, 58, 60, 59, 61, 61, 56, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{67, 60, 57, 63, 63, 57, 59, 59, 61, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{56, 54, 52, 60, 59, 53, 55, 58, 58, 54, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{69, 55, 59, 57, 55, 59, 53, 61, 53, 61, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{56, 55, 59, 57, 55, 59, 53, 61, 53, 61, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{60, 55, 59, 57, 55, 59, 53, 61, 53, 61, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{67, 55, 59, 57, 55, 59, 53, 61, 53, 61, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{60, 60, 57, 63, 63, 57, 58, 58, 62, 62, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{56, 60, 60, 64, 64, 56, 58, 58, 62, 63, 54, 62, 66, 67, 68, 69, 70, 71, 72, 73}, 
{60, 61, 57, 63, 63, 57, 59, 59, 61, 60, 55, 63, 63, 67, 68, 69, 70, 71, 72, 73}, 
{60, 60, 57, 63, 63, 57, 58, 58, 61, 61, 55, 63, 63, 67, 68, 69, 70, 71, 72, 73}, 
{56, 63, 61, 60, 64, 59, 63, 56, 62, 61, 57, 63, 61, 59, 59, 57, 57, 71, 72, 73}, 
{65, 55, 59, 57, 55, 59, 53, 61, 53, 61, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{67, 69, 59, 66, 63, 63, 57, 60, 54, 54, 67, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{68, 68, 72, 66, 59, 54, 54, 59, 59, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{68, 68, 72, 66, 59, 54, 54, 59, 59, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{60, 63, 66, 66, 63, 63, 57, 57, 54, 54, 67, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{60, 63, 66, 66, 63, 63, 57, 57, 54, 54, 67, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{60, 63, 66, 57, 57, 57, 57, 57, 54, 54, 67, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{60, 63, 66, 57, 57, 57, 57, 66, 66, 66, 66, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{60, 63, 66, 57, 57, 57, 57, 66, 66, 66, 66, 59, 59, 61, 63, 65, 61, 63, 65, 60}, 
{61, 73, 56, 56, 59, 63, 65, 65, 69, 69, 69, 69, 66, 67, 68, 69, 70, 71, 72, 73}, 
{72, 53, 56, 56, 59, 63, 65, 65, 69, 69, 69, 69, 66, 67, 68, 69, 70, 71, 72, 73}, 
{74, 69, 56, 56, 59, 63, 65, 65, 69, 69, 69, 69, 66, 67, 68, 69, 70, 71, 72, 73}, 
{77, 69, 73, 56, 59, 63, 65, 65, 69, 69, 69, 69, 66, 67, 68, 69, 70, 71, 72, 73}, 
{64, 62, 62, 62, 67, 57, 58, 66, 67, 57, 67, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{79, 62, 62, 62, 67, 57, 58, 66, 67, 57, 67, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{53, 54, 52, 66, 63, 63, 57, 57, 54, 54, 67, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{62, 62, 62, 62, 67, 57, 58, 66, 67, 57, 67, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{62, 62, 64, 58, 56, 60, 62, 64, 58, 56, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{62, 62, 62, 62, 67, 57, 58, 66, 67, 57, 67, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{59, 54, 57, 57, 59, 54, 54, 59, 60, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{56, 63, 66, 66, 63, 63, 57, 57, 54, 54, 67, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{48, 63, 66, 66, 63, 63, 57, 57, 54, 54, 67, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{63, 61, 59, 62, 67, 57, 65, 57, 57, 67, 67, 58, 59, 60, 61, 62, 63, 64, 65, 66}, 
{53, 63, 66, 66, 63, 63, 57, 57, 54, 54, 67, 32, 32, 32, 32, 32, 32, 32, 32, 32}, 
{62, 60, 58, 56, 59, 63, 65, 65, 69, 69, 69, 69, 66, 67, 68, 69, 70, 71, 72, 73}, 
{62, 60, 58, 62, 60, 58, 62, 60, 58, 62, 60, 58, 62, 60, 58, 62, 60, 58, 72, 73}, 
{62, 60, 58, 62, 60, 58, 62, 60, 58, 62, 60, 58, 62, 60, 58, 62, 60, 58, 72, 73}, 
{62, 60, 58, 56, 59, 63, 65, 65, 69, 69, 69, 69, 66, 67, 68, 69, 70, 71, 72, 73}, 
{62, 60, 58, 62, 60, 58, 62, 60, 58, 62, 60, 58, 62, 60, 58, 62, 60, 58, 72, 73}, 
{62, 60, 58, 62, 60, 58, 62, 60, 58, 62, 60, 58, 62, 60, 58, 62, 60, 58, 72, 73}, 
{66, 59, 67, 63, 60, 61, 65, 63, 60, 58, 58, 60, 67, 60, 67, 67, 69, 69, 72, 73}, 
{52, 64, 64, 62, 61, 62, 58, 58, 56, 53, 53, 71, 63, 60, 61, 69, 70, 71, 72, 73}, 
{68, 60, 57, 63, 63, 57, 59, 59, 61, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{70, 71, 72, 71, 72, 70, 71, 70, 72, 61, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{62, 60, 61, 65, 61, 57, 56, 59, 63, 67, 70, 68, 64, 60, 57, 69, 70, 71, 72, 73}, 
{61, 55, 56, 56, 59, 63, 55, 65, 52, 69, 57, 57, 53, 54, 53, 69, 70, 71, 72, 73}, 
{57, 62, 57, 52, 63, 60, 55, 51, 60, 57, 54, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{78, 55, 59, 57, 55, 59, 53, 61, 53, 61, 64, 65, 66, 67, 68, 69, 70, 71, 72, 73}, 
{68, 69, 72, 73, 63, 51, 54, 57, 66, 69, 52, 65, 66, 67, 68, 69, 70, 71, 72, 73}}
ZDCZR = {
{33, 37, 105, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{68, 32, 32, 32, 32, 32}, 
{68, 32, 32, 32, 32, 32}, 
{68, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{69, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{33, 62, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{33, 43, 46, 32, 32, 32}, 
{33, 43, 46, 32, 32, 32}, 
{33, 43, 46, 32, 32, 32}, 
{33, 43, 46, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 97, 32, 32, 32, 32}, 
{33, 97, 90, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{33, 94, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{33, 83, 32, 32, 32, 32}, 
{33, 83, 32, 32, 32, 32}, 
{33, 83, 32, 32, 32, 32}, 
{33, 83, 32, 32, 32, 32}, 
{33, 83, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 83, 32, 32, 32, 32}, 
{33, 83, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{33, 68, 69, 112, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{68, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{33, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}, 
{32, 32, 32, 32, 32, 32}}
MYCZRX = {
{61, 66, 66, 64, 64, 66}, 
{52, 52, 51, 53, 53, 53}, 
{52, 51, 53, 53, 53, 52}, 
{61, 65, 65, 67, 68, 67}, 
{62, 70, 70, 70, 70, 70}, 
{55, 55, 56, 56, 56, 55}, 
{59, 63, 62, 60, 61, 61}, 
{58, 60, 58, 60, 62, 62}, 
{61, 62, 64, 61, 64, 63}, 
{63, 65, 65, 65, 65, 65}, 
{63, 64, 61, 62, 60, 62}, 
{63, 65, 65, 65, 65, 65}, 
{66, 66, 66, 66, 66, 66}, 
{60, 59, 61, 58, 61, 58}, 
{58, 57, 58, 57, 58, 57}, 
{66, 66, 66, 66, 66, 66}, 
{51, 49, 49, 52, 52, 53}, 
{63, 65, 65, 66, 66, 67}, 
{61, 63, 63, 63, 65, 63}, 
{61, 62, 63, 62, 63, 64}, 
{66, 67, 67, 68, 68, 68}, 
{66, 67, 67, 68, 68, 68}, 
{56, 67, 67, 68, 68, 68}, 
{62, 63, 62, 62, 63, 63}, 
{63, 63, 65, 60, 66, 61}, 
{61, 63, 64, 64, 65, 67}, 
{53, 55, 51, 57, 56, 55}, 
{60, 60, 62, 62, 64, 64}, 
{62, 59, 62, 60, 64, 63}, 
{86, 85, 86, 85, 87, 85}, 
{68, 68, 68, 68, 68, 68}, 
{68, 68, 68, 68, 68, 68}, 
{68, 68, 68, 68, 68, 68}, 
{68, 68, 68, 68, 68, 68}, 
{68, 68, 68, 68, 68, 68}, 
{68, 68, 68, 68, 68, 68}, 
{68, 68, 68, 68, 68, 68}, 
{68, 68, 68, 68, 68, 68}, 
{55, 55, 53, 54, 54, 53}, 
{68, 68, 68, 68, 68, 68}, 
{63, 66, 65, 67, 69, 69}, 
{62, 64, 66, 65, 67, 68}, 
{57, 57, 61, 59, 61, 59}, 
{52, 52, 53, 53, 54, 53}, 
{76, 61, 63, 79, 79, 79}, 
{51, 61, 63, 63, 59, 59}, 
{75, 61, 63, 63, 59, 59}, 
{48, 49, 51, 50, 50, 48}, 
{55, 57, 57, 57, 55, 55}, 
{63, 65, 60, 64, 60, 62}, 
{60, 64, 58, 62, 60, 62}, 
{61, 63, 60, 62, 64, 62}, 
{59, 61, 58, 59, 60, 58}, 
{48, 48, 47, 49, 48, 48}, 
{57, 57, 57, 57, 57, 57}, 
{57, 57, 57, 57, 57, 57}, 
{70, 71, 72, 73, 74, 75}, 
{57, 57, 57, 57, 57, 57}, 
{59, 59, 61, 61, 61, 59}, 
{61, 64, 62, 65, 63, 66}, 
{65, 65, 67, 67, 66, 66}, 
{85, 85, 85, 83, 83, 83}, 
{65, 64, 66, 64, 65, 66}, 
{53, 52, 53, 54, 55, 54}, 
{48, 50, 50, 48, 49, 49}, 
{66, 66, 66, 67, 67, 67}, 
{60, 59, 58, 58, 59, 60}, 
{62, 63, 63, 64, 64, 65}, 
{55, 55, 55, 56, 57, 57}, 
{67, 68, 67, 67, 68, 68}, 
{60, 60, 62, 61, 62, 61}, 
{58, 57, 58, 57, 58, 57}, 
{58, 57, 58, 57, 58, 57}, 
{65, 64, 65, 64, 65, 64}, 
{65, 64, 65, 64, 65, 64}, 
{62, 62, 64, 64, 66, 66}, 
{62, 61, 63, 60, 64, 65}, 
{61, 63, 62, 60, 64, 65}, 
{80, 81, 81, 78, 79, 79}, 
{60, 65, 65, 65, 65, 65}, 
{72, 70, 72, 69, 72, 70}, 
{86, 86, 86, 86, 86, 86}, 
{67, 62, 67, 67, 64, 64}, 
{56, 57, 56, 57, 56, 57}, 
{67, 62, 67, 67, 64, 64}, 
{67, 62, 67, 67, 64, 64}, 
{73, 71, 73, 71, 73, 71}, 
{64, 62, 63, 63, 64, 64}, 
{67, 62, 67, 67, 64, 64}, 
{69, 69, 69, 65, 63, 63}, 
{69, 69, 69, 65, 63, 63}, 
{67, 62, 66, 67, 64, 64}, 
{68, 67, 68, 67, 66, 66}, 
{67, 62, 67, 67, 64, 64}, 
{63, 64, 65, 65, 65, 65}, 
{65, 65, 64, 65, 65, 65}, 
{63, 63, 63, 66, 66, 66}, 
{63, 63, 63, 66, 66, 66}, 
{63, 63, 63, 66, 66, 66}, 
{62, 64, 66, 65, 67, 68}, 
{62, 64, 66, 65, 67, 68}, 
{63, 63, 63, 66, 66, 66}, 
{67, 68, 68, 68, 68, 68}, 
{67, 68, 68, 68, 68, 68}, 
{67, 68, 68, 68, 68, 68}, 
{67, 68, 68, 68, 68, 68}, 
{67, 68, 68, 68, 68, 68}, 
{67, 68, 68, 68, 68, 68}, 
{67, 68, 68, 68, 68, 68}, 
{67, 68, 68, 68, 68, 68}, 
{67, 68, 68, 68, 68, 68}, 
{67, 68, 68, 68, 68, 68}, 
{67, 68, 68, 68, 68, 68}, 
{67, 68, 68, 68, 68, 68}, 
{67, 68, 68, 68, 68, 68}, 
{67, 68, 68, 68, 68, 68}, 
{67, 68, 68, 68, 68, 68}, 
{67, 68, 68, 68, 68, 68}, 
{67, 68, 68, 68, 68, 68}, 
{67, 68, 68, 68, 68, 68}, 
{67, 68, 68, 68, 68, 68}, 
{67, 68, 68, 68, 68, 68}, 
{67, 68, 68, 68, 68, 68}, 
{67, 68, 68, 68, 68, 68}, 
{67, 68, 68, 68, 68, 68}, 
{67, 68, 68, 68, 68, 68}, 
{67, 68, 68, 68, 68, 68}, 
{67, 68, 68, 68, 68, 68}, 
{67, 68, 68, 68, 68, 68}, 
{67, 68, 68, 68, 68, 68}, 
{67, 68, 68, 68, 68, 68}, 
{67, 68, 68, 68, 68, 68}, 
{75, 76, 76, 75, 75, 76}, 
{63, 63, 63, 63, 63, 63}, 
{63, 63, 63, 63, 63, 63}, 
{62, 64, 64, 65, 64, 66}, 
{62, 63, 63, 64, 64, 65}, 
{58, 58, 58, 59, 59, 59}, 
{61, 61, 61, 62, 62, 62}, 
{59, 60, 59, 60, 58, 58}, 
{63, 64, 65, 66, 62, 61}, 
{61, 61, 61, 61, 61, 61}, 
{59, 59, 58, 58, 59, 58}, 
{63, 64, 65, 66, 62, 61}, 
{63, 64, 65, 66, 62, 61}, 
{77, 78, 78, 77, 78, 77}, 
{63, 65, 65, 65, 65, 65}, 
{63, 65, 65, 65, 65, 65}, 
{66, 66, 66, 66, 66, 66}, 
{66, 66, 66, 66, 66, 66}, 
{66, 66, 66, 66, 66, 66}, 
{62, 64, 66, 63, 65, 67}, 
{62, 60, 64, 60, 64, 66}, 
{63, 62, 64, 62, 64, 65}, 
{60, 60, 60, 59, 59, 59}, 
{64, 68, 66, 65, 67, 64}, 
{53, 54, 53, 54, 52, 54}, 
{53, 51, 52, 52, 51, 53}, 
{67, 67, 67, 66, 66, 66}, 
{67, 67, 67, 66, 66, 66}, 
{65, 64, 65, 65, 64, 64}, 
{58, 58, 58, 57, 57, 57}, 
{63, 63, 63, 64, 64, 64}, 
{63, 63, 63, 64, 64, 64}, 
{63, 63, 63, 64, 64, 64}, 
{58, 58, 58, 57, 57, 57}, 
{89, 87, 87, 89, 87, 89}, 
{63, 63, 63, 66, 66, 66}, 
{63, 63, 63, 66, 66, 66}, 
{51, 52, 49, 49, 52, 51}, 
{65, 65, 65, 64, 64, 64}, 
{49, 49, 50, 50, 51, 51}, 
{67, 68, 67, 67, 68, 68}, 
{67, 67, 68, 67, 68, 68}, 
{67, 68, 68, 67, 68, 67}, 
{54, 53, 52, 53, 54, 52}, 
{74, 75, 74, 75, 75, 74}, 
{76, 73, 74, 72, 74, 73}, 
{68, 65, 65, 64, 64, 64}, 
{69, 69, 69, 69, 69, 69}, 
{69, 69, 69, 69, 69, 69}, 
{67, 67, 66, 66, 67, 67}, 
{63, 63, 63, 66, 65, 64}, 
{75, 74, 75, 74, 75, 74}, 
{74, 75, 75, 74, 74, 75}, 
{75, 74, 74, 75, 74, 75}, 
{75, 74, 75, 74, 75, 74}, 
{76, 74, 76, 74, 76, 74}, 
{63, 63, 63, 66, 66, 66}, 
{53, 55, 54, 54, 57, 57}, 
{74, 79, 79, 79, 79, 79}, 
{74, 79, 79, 79, 79, 79}, 
{64, 64, 66, 65, 67, 68}, 
{64, 64, 66, 65, 67, 68}, 
{64, 64, 66, 65, 67, 68}, 
{64, 64, 66, 65, 67, 68}, 
{64, 64, 66, 65, 67, 68}, 
{81, 77, 78, 77, 81, 82}, 
{82, 82, 82, 82, 85, 85}, 
{83, 83, 81, 81, 81, 81}, 
{84, 84, 84, 81, 81, 79}, 
{67, 62, 67, 65, 65, 64}, 
{76, 74, 75, 75, 73, 73}, 
{55, 51, 52, 51, 51, 53}, 
{67, 62, 67, 67, 64, 64}, 
{57, 58, 58, 58, 60, 59}, 
{67, 62, 67, 67, 64, 64}, 
{59, 65, 65, 64, 64, 64}, 
{62, 61, 62, 64, 62, 63}, 
{55, 55, 54, 54, 56, 56}, 
{60, 58, 60, 60, 62, 62}, 
{55, 52, 55, 56, 53, 54}, 
{70, 65, 65, 65, 65, 65}, 
{70, 65, 65, 65, 65, 65}, 
{70, 65, 65, 65, 65, 65}, 
{70, 65, 65, 65, 65, 65}, 
{70, 65, 65, 65, 65, 65}, 
{70, 65, 65, 65, 65, 65}, 
{64, 62, 62, 64, 66, 66}, 
{54, 54, 55, 54, 55, 55}, 
{72, 71, 72, 71, 72, 71}, 
{47, 46, 46, 47, 47, 46}, 
{85, 84, 86, 87, 86, 87}, 
{57, 57, 56, 56, 56, 56}, 
{62, 65, 65, 68, 68, 68}, 
{54, 54, 54, 57, 56, 56}, 
{59, 60, 61, 58, 59, 59}}
MYCZRY = {
{58, 56, 60, 59, 57, 58}, 
{55, 53, 54, 54, 52, 56}, 
{55, 54, 56, 52, 54, 53}, 
{57, 54, 60, 59, 57, 55}, 
{57, 56, 59, 58, 57, 55}, 
{70, 71, 70, 71, 69, 69}, 
{55, 55, 55, 55, 53, 54}, 
{57, 57, 59, 61, 59, 57}, 
{64, 65, 64, 62, 62, 65}, 
{70, 74, 72, 70, 68, 66}, 
{57, 56, 57, 58, 56, 55}, 
{70, 74, 72, 70, 68, 66}, 
{68, 71, 74, 65, 77, 62}, 
{55, 55, 55, 54, 53, 53}, 
{60, 60, 61, 61, 58, 58}, 
{68, 71, 74, 65, 77, 62}, 
{62, 64, 60, 60, 64, 62}, 
{61, 62, 60, 64, 58, 61}, 
{61, 62, 64, 60, 61, 58}, 
{61, 63, 63, 59, 59, 61}, 
{60, 58, 63, 60, 62, 57}, 
{60, 58, 63, 60, 62, 57}, 
{61, 58, 63, 60, 62, 57}, 
{78, 78, 77, 79, 79, 77}, 
{56, 57, 54, 57, 57, 54}, 
{61, 61, 60, 62, 61, 61}, 
{62, 59, 64, 61, 64, 62}, 
{83, 85, 85, 83, 85, 83}, 
{53, 56, 58, 50, 56, 50}, 
{63, 62, 61, 64, 62, 60}, 
{65, 61, 59, 67, 69, 57}, 
{65, 61, 59, 67, 69, 57}, 
{65, 61, 59, 67, 69, 57}, 
{65, 61, 59, 67, 69, 57}, 
{65, 61, 59, 67, 69, 57}, 
{65, 61, 59, 67, 69, 57}, 
{65, 61, 59, 67, 69, 57}, 
{65, 61, 59, 67, 69, 57}, 
{61, 60, 62, 62, 59, 59}, 
{65, 61, 59, 67, 69, 57}, 
{62, 61, 66, 64, 61, 68}, 
{53, 56, 59, 53, 56, 53}, 
{58, 56, 58, 56, 56, 58}, 
{75, 73, 73, 75, 74, 74}, 
{75, 58, 58, 77, 78, 74}, 
{69, 58, 58, 56, 56, 58}, 
{68, 58, 58, 56, 56, 58}, 
{59, 60, 58, 59, 57, 57}, 
{77, 79, 81, 77, 81, 79}, 
{63, 65, 66, 67, 63, 65}, 
{56, 56, 56, 56, 54, 54}, 
{56, 56, 55, 57, 55, 54}, 
{74, 74, 73, 72, 73, 71}, 
{62, 63, 64, 64, 66, 65}, 
{60, 62, 58, 64, 56, 66}, 
{59, 61, 63, 57, 65, 66}, 
{62, 62, 62, 62, 62, 62}, 
{59, 61, 63, 57, 65, 66}, 
{69, 67, 68, 70, 66, 65}, 
{55, 56, 56, 55, 55, 56}, 
{53, 56, 53, 56, 55, 54}, 
{66, 65, 67, 66, 65, 67}, 
{63, 63, 64, 64, 64, 63}, 
{64, 63, 62, 64, 63, 62}, 
{77, 77, 76, 76, 77, 76}, 
{49, 50, 51, 49, 50, 48}, 
{72, 72, 73, 72, 71, 73}, 
{62, 60, 64, 58, 66, 62}, 
{67, 66, 68, 67, 66, 68}, 
{54, 55, 58, 53, 57, 53}, 
{85, 84, 85, 85, 84, 84}, 
{60, 60, 61, 61, 58, 58}, 
{60, 60, 61, 61, 58, 58}, 
{78, 78, 83, 83, 77, 77}, 
{79, 79, 80, 80, 78, 78}, 
{78, 77, 75, 80, 78, 77}, 
{58, 58, 58, 58, 58, 58}, 
{58, 58, 58, 58, 58, 58}, 
{63, 62, 64, 63, 62, 64}, 
{61, 64, 61, 58, 55, 52}, 
{76, 74, 73, 73, 70, 72}, 
{70, 78, 76, 74, 72, 80}, 
{62, 62, 65, 59, 58, 66}, 
{62, 62, 63, 63, 61, 61}, 
{62, 62, 65, 59, 58, 66}, 
{62, 62, 65, 59, 58, 66}, 
{62, 62, 63, 63, 61, 61}, 
{62, 62, 64, 60, 58, 66}, 
{62, 62, 65, 59, 58, 66}, 
{63, 59, 67, 63, 65, 61}, 
{63, 59, 67, 63, 65, 61}, 
{62, 62, 63, 59, 58, 63}, 
{58, 57, 56, 59, 58, 56}, 
{62, 62, 65, 59, 58, 66}, 
{59, 59, 60, 58, 61, 57}, 
{48, 51, 49, 47, 49, 50}, 
{57, 55, 59, 57, 55, 59}, 
{57, 55, 59, 57, 55, 59}, 
{57, 55, 59, 57, 55, 59}, 
{53, 56, 59, 53, 56, 53}, 
{53, 56, 59, 53, 56, 53}, 
{57, 55, 59, 57, 55, 59}, 
{61, 61, 59, 67, 69, 57}, 
{61, 61, 59, 67, 69, 57}, 
{61, 61, 59, 67, 69, 57}, 
{61, 61, 59, 67, 69, 57}, 
{61, 61, 59, 67, 69, 57}, 
{61, 61, 59, 67, 69, 57}, 
{61, 61, 59, 67, 69, 57}, 
{61, 61, 59, 67, 69, 57}, 
{61, 61, 59, 67, 69, 57}, 
{61, 61, 59, 67, 69, 57}, 
{61, 61, 59, 67, 69, 57}, 
{61, 61, 59, 67, 69, 57}, 
{61, 61, 59, 67, 69, 57}, 
{61, 61, 59, 67, 69, 57}, 
{61, 61, 59, 67, 69, 57}, 
{61, 61, 59, 67, 69, 57}, 
{61, 61, 59, 67, 69, 57}, 
{61, 61, 59, 67, 69, 57}, 
{61, 61, 59, 67, 69, 57}, 
{61, 61, 59, 67, 69, 57}, 
{61, 61, 59, 67, 69, 57}, 
{61, 61, 59, 67, 69, 57}, 
{61, 61, 59, 67, 69, 57}, 
{61, 61, 59, 67, 69, 57}, 
{61, 61, 59, 67, 69, 57}, 
{61, 61, 59, 67, 69, 57}, 
{61, 61, 59, 67, 69, 57}, 
{61, 61, 59, 67, 69, 57}, 
{61, 61, 59, 67, 69, 57}, 
{61, 61, 59, 67, 69, 57}, 
{53, 53, 51, 51, 55, 55}, 
{63, 65, 67, 61, 59, 57}, 
{63, 65, 67, 57, 61, 59}, 
{62, 64, 60, 62, 62, 62}, 
{57, 58, 56, 56, 58, 57}, 
{68, 69, 67, 69, 67, 68}, 
{54, 56, 58, 55, 57, 59}, 
{62, 62, 61, 61, 62, 61}, 
{60, 60, 60, 60, 60, 60}, 
{54, 56, 58, 55, 57, 59}, 
{62, 61, 62, 63, 63, 61}, 
{60, 60, 60, 60, 60, 60}, 
{60, 60, 60, 60, 60, 60}, 
{50, 51, 45, 46, 48, 48}, 
{70, 74, 72, 70, 68, 66}, 
{70, 74, 72, 70, 68, 66}, 
{68, 71, 74, 65, 77, 62}, 
{68, 71, 74, 65, 77, 62}, 
{68, 71, 74, 65, 77, 62}, 
{51, 51, 51, 51, 51, 51}, 
{61, 63, 62, 59, 60, 61}, 
{61, 63, 63, 59, 59, 61}, 
{62, 61, 60, 62, 61, 60}, 
{61, 60, 59, 63, 62, 58}, 
{66, 67, 65, 66, 66, 65}, 
{58, 60, 58, 59, 59, 59}, 
{67, 66, 68, 67, 66, 68}, 
{66, 65, 67, 66, 67, 65}, 
{65, 65, 63, 64, 64, 63}, 
{57, 56, 58, 57, 56, 58}, 
{57, 55, 59, 57, 55, 59}, 
{57, 55, 59, 57, 55, 59}, 
{57, 55, 59, 57, 55, 59}, 
{60, 61, 62, 60, 61, 62}, 
{48, 51, 49, 49, 48, 51}, 
{57, 55, 59, 57, 55, 59}, 
{57, 55, 59, 57, 55, 59}, 
{46, 46, 48, 46, 48, 48}, 
{76, 70, 73, 73, 70, 76}, 
{66, 67, 66, 67, 66, 67}, 
{56, 55, 55, 57, 57, 56}, 
{55, 53, 56, 57, 58, 54}, 
{53, 54, 58, 57, 56, 55}, 
{65, 65, 67, 70, 70, 68}, 
{60, 60, 61, 61, 59, 59}, 
{68, 68, 70, 69, 67, 66}, 
{56, 54, 62, 59, 57, 55}, 
{71, 70, 72, 74, 75, 73}, 
{62, 57, 61, 58, 59, 60}, 
{58, 57, 58, 57, 56, 59}, 
{65, 64, 66, 64, 64, 64}, 
{60, 60, 62, 62, 58, 58}, 
{60, 60, 62, 62, 58, 58}, 
{61, 61, 60, 60, 59, 59}, 
{60, 60, 61, 61, 58, 58}, 
{60, 60, 62, 62, 58, 58}, 
{65, 63, 67, 65, 63, 67}, 
{63, 68, 61, 66, 62, 66}, 
{68, 71, 70, 69, 68, 67}, 
{68, 71, 70, 69, 68, 67}, 
{60, 63, 59, 53, 56, 53}, 
{60, 63, 59, 53, 56, 53}, 
{60, 63, 59, 53, 56, 53}, 
{60, 63, 59, 53, 56, 53}, 
{60, 63, 59, 53, 56, 53}, 
{70, 67, 80, 76, 77, 73}, 
{76, 73, 69, 66, 72, 68}, 
{73, 71, 75, 73, 71, 69}, 
{78, 71, 74, 76, 72, 74}, 
{62, 62, 65, 64, 62, 66}, 
{79, 79, 82, 77, 75, 83}, 
{59, 50, 49, 51, 49, 49}, 
{62, 62, 65, 59, 58, 66}, 
{62, 62, 63, 61, 62, 62}, 
{62, 62, 65, 59, 58, 66}, 
{57, 54, 62, 59, 57, 55}, 
{55, 55, 54, 53, 53, 53}, 
{52, 53, 52, 51, 51, 52}, 
{63, 63, 65, 59, 62, 64}, 
{59, 60, 57, 56, 59, 58}, 
{60, 64, 61, 58, 55, 52}, 
{60, 64, 61, 58, 55, 52}, 
{60, 64, 61, 58, 55, 52}, 
{60, 64, 61, 58, 55, 52}, 
{60, 64, 61, 58, 55, 52}, 
{60, 64, 61, 58, 55, 52}, 
{66, 65, 62, 61, 61, 66}, 
{54, 50, 51, 52, 53, 55}, 
{69, 68, 68, 69, 67, 67}, 
{71, 72, 71, 70, 72, 70}, 
{61, 61, 62, 60, 60, 62}, 
{54, 53, 54, 53, 52, 51}, 
{57, 60, 54, 63, 57, 51}, 
{78, 76, 80, 78, 77, 79}, 
{68, 68, 68, 68, 67, 69}}--显示当前人物的特效动画

function CurIDTXDH(id, DH1, DH2, str,strColor)
	if strColor == nil then
		strColor = C_GOLD
	end
    local x0, y0 = WAR.Person[id]["坐标X"], WAR.Person[id]["坐标Y"]
    local hb = GetS(JY.SubScene, x0, y0, 4)
    if CONFIG.Zoom == 1 then
       hb = hb * 2
    end
    local MAX = 1
    if DH2 < DH1 then
       MAX = -1
    end
    local ssid = lib.SaveSur(0, 0, CC.ScreenW, CC.ScreenH)
    for ii = DH1, DH2, MAX do
    --lib.PicLoadCache(3, ii * 2, CC.ScreenW / 2, CC.ScreenH / 2 - hb, 2, 192)
	lib.PicLoadCache(3, ii * 2, CC.ScreenW / 2, CC.ScreenH / 2 - hb, 0)
    if str ~= nil then
      NewDrawString(-1, -1, str, strColor, 30)
    end
    ShowScreen()
    lib.Delay(10)
    lib.LoadSur(ssid, 0, 0)
    end
    lib.FreeSur(ssid)
    Cls()
end
    --CXDYWPSX 
CXDYWPSX = function()

end--CY108
    CY108 = {"天魁星", "天罡星", "天机星", "天闲星", "天勇星", "天雄星", "天猛星", "天威星", "天英星", "天贵星", "天富星", "天满星", "天孤星", "天伤星", "天立星", "天捷星", "天暗星", "天佑星", "天空星", "天速星", "天异星", "天杀星", "天微星", "天究星", "天退星", "天寿星", "天剑星", "天平星", "天罪星", "天损星", "天败星", "天牢星", "天慧星", "天暴星", "天哭星", "天巧星", "地魁星", "地煞星", "地勇星", "地杰星", "地雄星", "地威星", "地英星", "地奇星", "地猛星", "地文星", "地正星", "地阔星", "地阖星", "地强星", "地暗星", "地轴星", "地会星", "地佐星", "地佑星", "地灵星", "地兽星", "地微星", "地慧星", "地暴星", "地然星", "地猖星", "地狂星", "地飞星", "地走星", "地巧星", "地明星", "地进星", "地退星", "地满星", "地遂星", "地周星", "地隐星", "地异星", "地理星", "地俊星", "地乐星", "地捷星", "地速星", "地镇星", "地稽星", "地魔星", "地妖星", "地幽星", "地伏星", "地空星", "地僻星", "地全星", "地孤星", "地角星", "地短星", "地藏星", "地囚星", "地平星", "地损星", "地奴星", "地察星", "地恶星", "地丑星", "地数星", "地阴星", "地刑星", "地壮星", "地劣星", "地健星", "地耗星", "地贼星", "地狗星"}
    SN = {}
    for a = 1, 100000 do
      local b = "" .. a
          SN[b] = a
end--缺省物品使用函数，实现原始游戏效果
     --id 物品id
function DefaultUseThing(id)
    if JY.Thing[id]["类型"] == 0 then
       return UseThing_Type0(id)
    elseif JY.Thing[id]["类型"] == 1 then
       return UseThing_Type1(id)
    elseif JY.Thing[id]["类型"] == 2 then
       return UseThing_Type2(id)
    elseif JY.Thing[id]["类型"] == 3 then
       return UseThing_Type3(id)
    elseif JY.Thing[id]["类型"] == 4 then
       return UseThing_Type4(id)
    end
end--处理时间字符串，显示时间专用
function demostr(t)
    local tt = t - CC.Timer.stime
    tt = math.modf(tt / 30) % (CC.ScreenW + CC.Timer.len * CC.Fontsmall)
    if runword(CC.Timer.str, C_WHITE, CC.Fontsmall, 1, tt) == 1 and Rnd(2) == 1 then
         CC.Timer.status = 0
         CC.Timer.stime = t
    end
end

function runword(str, color, size, place, offset)
    offset = CC.ScreenW - offset
    local y1, y2 = nil, nil
    if place == 0 then
       y1 = 0
       y2 = size
    elseif place == 1 then
       y1 = CC.ScreenH - size
       y2 = CC.ScreenH
    end
    lib.Background(0, y1, CC.ScreenW, y2, 128)
    if (CC.Timer.len - 1) * size < -(offset) then
       return 1
    end
    DrawString(offset, y1, str, color, size)
    return 0
end--火凤燎原
function DHZFXS(s)
    for i = 1, 20 do
    NewDrawString(-1, -1, s, C_GOLD, 20 + i)
    ShowScreen()
    if i == 20 then
		Cls()
      lib.Delay(100)
    else
      lib.Delay(1)
    end
    end
end--绘制一个带背景的白色方框，四角凹进
function DrawBox(x1, y1, x2, y2, color)
    local s = 4
    lib.Background(x1 + 4, y1, x2 - 4, y1 + s, 128)
    lib.Background(x1 + 1, y1 + 1, x1 + s, y1 + s, 128)
    lib.Background(x2 - s, y1 + 1, x2 - 1, y1 + s, 128)
    lib.Background(x1, y1 + 4, x2, y2 - 4, 128)
    lib.Background(x1 + 1, y2 - s, x1 + s, y2 - 1, 128)
    lib.Background(x2 - s, y2 - s + 1, x2 - 1, y2, 128)
    lib.Background(x1 + 4, y2 - s, x2 - 4, y2, 128)
    local r, g, b = GetRGB(color)
    DrawBox_1(x1 + 1, y1 + 1, x2, y2, RGB(math.modf(r / 2), math.modf(g / 2), math.modf(b / 2)))
    DrawBox_1(x1, y1, x2 - 1, y2 - 1, color)
end

--绘制一个带背景的白色方框，四角凹进
function DrawBox_1(x1, y1, x2, y2, color)
    local s = 4
    lib.DrawRect(x1 + s, y1, x2 - s, y1, color)
    lib.DrawRect(x1 + s, y2, x2 - s, y2, color)
    lib.DrawRect(x1, y1 + s, x1, y2 - s, color)
    lib.DrawRect(x2, y1 + s, x2, y2 - s, color)
    lib.DrawRect(x1 + 2, y1 + 1, x1 + s - 1, y1 + 1, color)
    lib.DrawRect(x1 + 1, y1 + 2, x1 + 1, y1 + s - 1, color)
    lib.DrawRect(x2 - s + 1, y1 + 1, x2 - 2, y1 + 1, color)
    lib.DrawRect(x2 - 1, y1 + 2, x2 - 1, y1 + s - 1, color)
    lib.DrawRect(x1 + 2, y2 - 1, x1 + s - 1, y2 - 1, color)
    lib.DrawRect(x1 + 1, y2 - s + 1, x1 + 1, y2 - 2, color)
    lib.DrawRect(x2 - s + 1, y2 - 1, x2 - 2, y2 - 1, color)
    lib.DrawRect(x2 - 1, y2 - s + 1, x2 - 1, y2 - 2, color)
end--主地图中的迷你小地图
function DrawMMapMini()
	local t=lib.GetTime();
	if JY.Status==GAME_SMAP or JY.Status==GAME_MMAP then
		if CC.Timer.status==0  then
			--if t-CC.Timer.stime>900000 then
				CC.Timer.stime=t;
				CC.Timer.status=1;
				CC.Timer.str=CC.RUNSTR[math.random(#CC.RUNSTR)];
				CC.Timer.len=string.len(CC.Timer.str)/2+3;
			--end
		else
			CC.Timer.fun(t);
		end
	end
	local len=CC.MapSize
if CC.MapKind==2 then
	len=math.modf(len*1.5);
	for xx=-len,len do
		for yy=math.abs(xx)-len,len-math.abs(xx) do
			local dx,dy;
			local x=xx+JY.Base["人X"];
			local y=yy+JY.Base["人Y"];
			dx=CC.ScreenW-len*4+(xx-yy)*4;
			dy=len*2+(xx+yy)*2;
			if x==JY.Base["人X"] and y==JY.Base["人Y"] then
				lib.FillColor(dx,dy,dx+5,dy+5,C_RED)
			elseif x>=0 and y>=0 and x<=479 and y<=479 then
				if lib.GetMMap(x,y,1)~=0 then
					lib.Background(dx,dy,dx+4,dy+4,196)
				elseif lib.GetMMap(x,y,2)~=0 then
					lib.FillColor(dx,dy,dx+3,dy+3,RGB(0,128,0))
				elseif lib.GetMMap(x,y,3)~=0 then
					lib.FillColor(dx,dy,dx+3,dy+3,RGB(160,82,45))
				elseif CC.MMapBoat[lib.GetMMap(x,y,0)]==1 then
					lib.FillColor(dx,dy,dx+3,dy+3,RGB(65,105,225))
				end
			end
		end
	end
	local Sce={};
	for xx=-len,len do
		for yy=math.abs(xx)-len,len-math.abs(xx) do
			local dx,dy;
			local x=xx+JY.Base["人X"];
			local y=yy+JY.Base["人Y"];
			dx=CC.ScreenW-len*4+(xx-yy)*4;
			dy=len*2+(xx+yy)*2;
			if x>=0 and y>=0 and x<=479 and y<=479 then
				local sid=CanEnterScene(x,y);
				if sid>=0 and Sce[sid]==nil then
					Sce[sid]=true;
					local str=JY.Scene[sid]["名称"];
					lib.FillColor(dx,dy,dx+3,dy+3,C_ORANGE);
					lib.Background(dx-string.len(str)*4,dy+4,dx+string.len(str)*4,dy+20,128);
					DrawString(dx-string.len(str)*4,dy+4,str,C_WHITE,16);
				end
			end
		end
	end
elseif CC.MapKind==1 then
	for x=JY.Base["人X"]-len,JY.Base["人X"]+len do
		for y=JY.Base["人Y"]-len,JY.Base["人Y"]+len do
			local dx,dy;
			local xx=x-JY.Base["人X"];
			local yy=y-JY.Base["人Y"];
			dx=CC.ScreenW-len*8+(xx-yy)*4;
			dy=len*4+(xx+yy)*2;
			if x==JY.Base["人X"] and y==JY.Base["人Y"] then
				lib.FillColor(dx,dy,dx+5,dy+5,C_RED)
			elseif x>=0 and y>=0 and x<=479 and y<=479 then
				if lib.GetMMap(x,y,1)~=0 then
					lib.Background(dx,dy,dx+4,dy+4,196)
				elseif lib.GetMMap(x,y,2)~=0 then
					lib.FillColor(dx,dy,dx+3,dy+3,RGB(0,128,0))
				elseif lib.GetMMap(x,y,3)~=0 then
					lib.FillColor(dx,dy,dx+3,dy+3,RGB(160,82,45))
				elseif CC.MMapBoat[lib.GetMMap(x,y,0)]==1 then
					lib.FillColor(dx,dy,dx+3,dy+3,RGB(65,105,225))
				end
			end
		end
	end
	local Sce={};
	for x=JY.Base["人X"]-len,JY.Base["人X"]+len do
		for y=JY.Base["人Y"]-len,JY.Base["人Y"]+len do
			local dx,dy;
			local xx=x-JY.Base["人X"];
			local yy=y-JY.Base["人Y"];
			dx=CC.ScreenW-len*8+(xx-yy)*4;
			dy=len*4+(xx+yy)*2;
			if x>=0 and y>=0 and x<=479 and y<=479 then
				local sid=CanEnterScene(x,y);
				if sid>=0 and Sce[sid]==nil then
					Sce[sid]=true;
					local str=JY.Scene[sid]["名称"];
					lib.FillColor(dx,dy,dx+3,dy+3,C_ORANGE);
					lib.Background(dx-string.len(str)*4,dy+4,dx+string.len(str)*4,dy+20,128);
					DrawString(dx-string.len(str)*4,dy+4,str,C_WHITE,16);
				end
			end
		end
	end
end
end--绘画集气条上的名字
function drawname(x, y, name, size)
    x = x - math.modf(size / 2)
    local namelen = string.len(name) / 2
    local zi = {}
    for i = 1, namelen do
    zi[i] = string.sub(name, i * 2 - 1, i * 2)
    DrawString(x, y, zi[i], C_WHITE, size)
    y = y + size
    end
end

    --fastdraw = 0 or nil 全部重绘。用于事件中
     --1 考虑脏矩形 用于显示场景循环
function DrawSMap(fastdraw)
    if fastdraw == nil then
       fastdraw = 0
    end
    local x0 = JY.SubSceneX + JY.Base["人X1"]
    local y0 = JY.SubSceneY + JY.Base["人Y1"]
    local x = x0 - JY.Base["人X1"]
    local y = y0 - JY.Base["人Y1"]
    if fastdraw == 0 then
       lib.DrawSMap(JY.SubScene, JY.Base["人X1"], JY.Base["人Y1"], x, y, JY.MyPic)
    else
    if JY.oldSMapX >= 0 and JY.oldSMapY >= 0 and JY.oldSMapX + JY.oldSMapXoff == JY.Base["人X1"] + x and JY.oldSMapY + JY.oldSMapYoff == JY.Base["人Y1"] + y then
      local num_clip = 0
      local clip = {}
      for i = 0, JY.NumD_PicChange - 1 do
        local dx = JY.D_PicChange[i].x - JY.Base["人X1"] - x
        local dy = JY.D_PicChange[i].y - JY.Base["人Y1"] - y
        clip[num_clip] = Cal_PicClip(dx, dy, JY.D_PicChange[i].p1, 0, dx, dy, JY.D_PicChange[i].p2, 0)
        clip[num_clip].y1 = clip[num_clip].y1 - JY.D_PicChange[i].dy
        clip[num_clip].y2 = clip[num_clip].y2 - JY.D_PicChange[i].dy
        num_clip = num_clip + 1
      end
      if JY.oldSMapPic >= 0 and (JY.oldSMapX ~= JY.Base["人X1"] or JY.oldSMapY ~= JY.Base["人Y1"] or JY.oldSMapPic ~= JY.MyPic) then
        local dy1 = GetS(JY.SubScene, JY.Base["人X1"], JY.Base["人Y1"], 4)
        local dy2 = GetS(JY.SubScene, JY.oldSMapX, JY.oldSMapY, 4)
        local dy = math.max(dy1, dy2)
        clip[num_clip] = Cal_PicClip(-JY.oldSMapXoff, -JY.oldSMapYoff, JY.oldSMapPic, 0, -x, -y, JY.MyPic, 0)
        clip[num_clip].y1 = clip[num_clip].y1 - dy
        clip[num_clip].y2 = clip[num_clip].y2 - dy
        num_clip = num_clip + 1
      end
      local area = 0
      for i = 0, num_clip - 1 do
        clip[i] = ClipRect(clip[i])
        if clip[i] ~= nil then
          area = area + (clip[i].x2 - clip[i].x1) * (clip[i].y2 - clip[i].y1)
        end
      end
      if area < CC.ScreenW * CC.ScreenH / 2 and num_clip < 15 then
        for i = 0, num_clip - 1 do
          if clip[i] ~= nil then
            lib.SetClip(clip[i].x1, clip[i].y1, clip[i].x2, clip[i].y2)
            lib.DrawSMap(JY.SubScene, JY.Base["人X1"], JY.Base["人Y1"], x, y, JY.MyPic)
          end
        end
      end
    else
      lib.SetClip(0, 0, CC.ScreenW, CC.ScreenH)
      lib.DrawSMap(JY.SubScene, JY.Base["人X1"], JY.Base["人Y1"], x, y, JY.MyPic)
    end
    end
    JY.oldSMapX = JY.Base["人X1"]
    JY.oldSMapY = JY.Base["人Y1"]
    JY.oldSMapPic = JY.MyPic
    JY.oldSMapXoff = x
    JY.oldSMapYoff = y
    if CC.forg then
    local step = 10
    for i = 0, 639, step do
      for j = 0, 479, step do
        lib.Background(i, j, i + step, j + step, Bright[i][j])
      end
    end
    end
end
--子场景中迷你小地图
function DrawSMapMini()
	local t=lib.GetTime();
	if JY.Status==GAME_SMAP or JY.Status==GAME_MMAP then
		if CC.Timer.status==0  then
			if t-CC.Timer.stime>900000 then
				CC.Timer.stime=t;
				CC.Timer.status=1;
				CC.Timer.str=CC.RUNSTR[math.random(#CC.RUNSTR)];
				CC.Timer.len=string.len(CC.Timer.str)/2+3;
			end
		else
			CC.Timer.fun(t);
		end
	end
	local len=CC.MapSize;
	if CC.MapKind==2 then
		len=math.modf(len*1.5);
		for xx=-len,len do
			for yy=math.abs(xx)-len,len-math.abs(xx) do
				local dx,dy;
				local x=xx+JY.Base["人X1"];
				local y=yy+JY.Base["人Y1"];
				dx=CC.ScreenW-len*4+(xx-yy)*4;
				dy=len*2+(xx+yy)*2;
				if x==JY.Base["人X1"] and y==JY.Base["人Y1"] then
					lib.FillColor(dx,dy,dx+5,dy+5,C_RED)
				elseif x>=0 and y>=0 and x<=63 and y<=63 then
					if CC.MMapBoat[GetS(JY.SubScene,x,y,0)]==1 then
						lib.FillColor(dx,dy,dx+3,dy+3,RGB(65,105,225))
					elseif SceneCanPass(x,y) then
						--lib.Background(dx,dy,dx+4,dy+4,64)
						--lib.FillColor(dx,dy,dx+4,dy+4,C_GOLD)
					else
						--lib.DrawRect(dx,dy,dx+1,dy+1,C_RED)
					lib.FillColor(dx,dy,dx+3,dy+3,RGB(0,128,0))--C_ORANGE)
						--lib.Background(dx,dy,dx+4,dy+4,64)
					end
				end
			end
		end
	elseif CC.MapKind==1 then
		for x=JY.Base["人X1"]-len,JY.Base["人X1"]+len do
			for y=JY.Base["人Y1"]-len,JY.Base["人Y1"]+len do
				local dx,dy;
				local xx=x-JY.Base["人X1"];
				local yy=y-JY.Base["人Y1"];
				dx=CC.ScreenW-len*8+(xx-yy)*4;
				dy=len*4+(xx+yy)*2;
				if x==JY.Base["人X1"] and y==JY.Base["人Y1"] then
					lib.FillColor(dx,dy,dx+5,dy+5,C_RED)
				elseif x>=0 and y>=0 and x<=63 and y<=63 then
					if CC.MMapBoat[GetS(JY.SubScene,x,y,0)]==1 then
						lib.FillColor(dx,dy,dx+3,dy+3,RGB(65,105,225))
					elseif SceneCanPass(x,y) then
						--lib.Background(dx,dy,dx+4,dy+4,64)
						--lib.FillColor(dx,dy,dx+4,dy+4,C_GOLD)
					else
						--lib.DrawRect(dx,dy,dx+1,dy+1,C_RED)
						lib.FillColor(dx,dy,dx+3,dy+3,RGB(0,128,0))--C_ORANGE)
						--lib.Background(dx,dy,dx+4,dy+4,64)
					end
				end
			end
		end
	end
end

--显示带框的字符串
--(x,y) 坐标，如果都为-1,则在屏幕中间显示
function DrawStrBox(x,y,str,color,size)         --显示带框的字符串
    local ll=#str;
    local w=size*ll/2+2*CC.MenuBorderPixel;
	local h=size+2*CC.MenuBorderPixel;
	if x==-1 then
        x=(CC.ScreenW-size/2*ll-2*CC.MenuBorderPixel)/2;
	end
	if y==-1 then
        y=(CC.ScreenH-size-2*CC.MenuBorderPixel)/2;
	end

    DrawBox(x,y,x+w-1,y+h-1,C_WHITE);
    DrawString(x+CC.MenuBorderPixel,y+CC.MenuBorderPixel,str,color,size);
end

--显示字符串并等待击键，或等待3秒，字符串带框，显示在屏幕中间
function DrawStrBoxWaitKey(s, color, size)
    Cls()
    DrawStrBox(-1, -1, s, color, size)
    ShowScreen()
    local i = 1
	while ( i < 3000) do
		lib.Delay(1)
		if  lib.GetKey() ~= -1 then
			i = 3000
		else
			i = i + 1
		end
	end
end

--显示并询问Y/N，如果点击Y，则返回true, N则返回false
--(x,y) 坐标，如果都为-1,则在屏幕中间显示
--改为用菜单询问是否
function DrawStrBoxYesNo(x, y, str, color, size)
    lib.GetKey()
    local ll = #str
    local w = size * ll / 2 + 2 * CC.MenuBorderPixel
    local h = size + 2 * CC.MenuBorderPixel
    if x == -1 then
       x = (CC.ScreenW - size / 2 * ll - 2 * CC.MenuBorderPixel) / 2
    end
    if y == -1 then
       y = (CC.ScreenH - size - 2 * CC.MenuBorderPixel) / 2
    end
    DrawStrBox(x, y, str, color, size)
    local menu = {
    {"确定/是", nil, 1}, 
    {"取消/否", nil, 2}}
    local r = ShowMenu(menu, 2, 0, x + w - 4 * size - 2 * CC.MenuBorderPixel, y + h + CC.MenuBorderPixel, 0, 0, 1, 0, CC.DefaultFont, C_ORANGE, C_WHITE)
    if r == 1 then
       return true
    else
       return false
    end
end--显示阴影字符串
function DrawString(x, y, str, color, size)
  lib.DrawStr(x, y, str, color, size, CC.FontName, CC.SrcCharSet, CC.OSCharSet)
end

--显示阴影字符串
--如果x,y传-1，那么显示在屏幕中间
function NewDrawString(x, y, str, color, size)
    local ll = #str
    local w = size * ll / 2 + 2 * CC.MenuBorderPixel
    local h = size + 2 * CC.MenuBorderPixel
    if x == -1 then
       x = (CC.ScreenW - size / 2 * ll - 2 * CC.MenuBorderPixel) / 2
    else
       x = (x - size / 2 * ll - 2 * CC.MenuBorderPixel) / 2
    end
    if y == -1 then
       y = (CC.ScreenH - size - 2 * CC.MenuBorderPixel) / 2
    else
       y = (y - size - 2 * CC.MenuBorderPixel) / 2
    end
    lib.DrawStr(x, y, str, color, size, CC.FontName, CC.SrcCharSet, CC.OSCharSet)
end

---D*中的事件处理动画效果。
function DtoSMap()
   
   local sceneid = JY.SubScene
   JY.NumD_PicChange = 0
   JY.D_PicChange = {}
   if JY.D_Valid == nil then
      Cal_D_Valid()
   end
  
    for k = 0, JY.D_Valid_Num - 1 do
    local i = JY.D_Valid[k]
    local p1 = GetD(sceneid, i, 5)
    if p1 > 0 then
      local p2 = GetD(sceneid, i, 6)
      local p3 = GetD(sceneid, i, 7)
      
	    if p1 ~= p2 then
	      local old_p3 = p3
	      local delay = GetD(sceneid, i, 8)
	      if CC.SceneFlagPic[1] * 2 > p3 or p3 > CC.SceneFlagPic[2] * 2 or CC.ShowFlag ~= 0 then
	        if p3 <= p1 then
	        	if delay < JY.MyTick2 % 100 then
	          	p3 = p3 + 2
	        	end
	        elseif JY.MyTick2 % 4 == 0 then
	          p3 = p3 + 2
	        end
	      end
	      
	      if p2 < p3 then
	        p3 = p1
	      end
	      if old_p3 ~= p3 then
		      local x = GetD(sceneid, i, 9)
		      local y = GetD(sceneid, i, 10)
		      local dy = GetS(sceneid, x, y, 4)
		      JY.D_PicChange[JY.NumD_PicChange] = {x = x, y = y, dy = dy, p1 = old_p3 / 2, p2 = p3 / 2}
		      JY.NumD_PicChange = JY.NumD_PicChange + 1
		      SetD(sceneid, i, 7, p3)
		    end
    	end
	  end
    end
end
--事件调用主入口
--id，d*中的编号
--flag 1 空格触发，2，物品触发，3，路过触发
function EventExecute(id, flag) --需添加
    if flag == 1 and RWPD() ~= 0 then
	   return
    end
    JY.CurrentD = id
    if JY.SceneNewEventFunction[JY.SubScene] == nil then
       oldEventExecute(flag)
    else
       JY.SceneNewEventFunction[JY.SubScene](flag)
    end
    JY.CurrentD = -1
    JY.Darkness = 0
end--得到文件的长度

function filelength(filename)
    local inp = io.open(filename, "rb")
    local l = inp:seek("end")
    inp:close()
    return l
end
--新对话方式
--加入控制字符
--暂停，任意键后继续，ｐ
--控制颜色Ｒ=redＧ=goldＢ=blackＷ=whiteＯ=orange
--控制字符显示速度０,１,２,３,４,５,６,７,８,９
--控制字体ＡＳＤＦ
--控制换行Ｈ   分页Ｐ
--Ｎ代表自己ｎ代表主角
function say(s,pid,flag,name,htype)          --个人新对话
    local picw=130;       --最大头像图片宽高
	local pich=130;
	local talkxnum=18;         --对话一行字数
	local talkynum=3;          --对话行数
	local dx=2;
	local dy=2;
    local boxpicw=picw+10;
	local boxpich=pich+10;
	local boxtalkw=talkxnum*CC.DefaultFont+10;
	local boxtalkh=boxpich-27;
	pid=pid or 0
	if pid == 0 then
		pid = zj()
	end
	if flag==nil then
		if pid==0 then
			flag=1
		else
			flag=0
		end
	end
	name=name or JY.Person[pid]["姓名"]
    local talkBorder=(pich-talkynum*CC.DefaultFont)/(talkynum+1);

	--显示头像和对话的坐标
    local xy={ [0]={headx=dx,heady=dy,
	                talkx=dx+boxpicw+2,talky=dy+27,
					namex=dx+boxpicw+2,namey=dy,
					showhead=1},--左上
                   {headx=CC.ScreenW-1-dx-boxpicw,heady=CC.ScreenH-dy-boxpich,
				    talkx=CC.ScreenW-1-dx-boxpicw-boxtalkw-2,talky= CC.ScreenH-dy-boxpich+27,
					namex=CC.ScreenW-1-dx-boxpicw-96,namey=CC.ScreenH-dy-boxpich,
					showhead=1},--右下
                   {headx=dx,heady=dy,
				   talkx=dx+boxpicw-43,talky=dy+27,
					namex=dx+boxpicw+2,namey=dy,
				   showhead=0},--上中
                   {headx=CC.ScreenW-1-dx-boxpicw,heady=CC.ScreenH-dy-boxpich,
				   talkx=CC.ScreenW-1-dx-boxpicw-boxtalkw-2,talky= CC.ScreenH-dy-boxpich+27,
					namex=CC.ScreenW-1-dx-boxpicw-96,namey=CC.ScreenH-dy-boxpich,
					showhead=1},
                   {headx=CC.ScreenW-1-dx-boxpicw,heady=dy,
				    talkx=CC.ScreenW-1-dx-boxpicw-boxtalkw-2,talky=dy+27,
					namex=CC.ScreenW-1-dx-boxpicw-96,namey=dy,
					showhead=1},--右上
                   {headx=dx,heady=CC.ScreenH-dy-boxpich,
				   talkx=dx+boxpicw+2,talky=CC.ScreenH-dy-boxpich+27,
					namex=dx+boxpicw+2,namey=CC.ScreenH-dy-boxpich,
				   showhead=1}, --左下
			}

    if flag<0 or flag>5 then
        flag=0;
    end
	local headid = pid
    headid = gethead(headid,htype)
  
    if xy[flag].showhead == 0 then
       headid = -1
    end

    if CONFIG.KeyRepeat==0 then
	     lib.EnableKeyRepeat(0,CONFIG.KeyRepeatInterval);
	end
    lib.GetKey();
	
	local function readstr(str)
		local T1={"０","１","２","３","４","５","６","７","８","９"}
		local T2={{"Ｒ",C_RED},{"Ｇ",C_GOLD},{"Ｂ",C_BLACK},{"Ｗ",C_WHITE},{"Ｏ",C_ORANGE}}
		local T3={{"Ｈ",CC.FontNameSong},{"Ｓ",CC.FontNameHei},{"Ｆ",CC.FontName}}
		--美观起见，针对不同字体同一行显示，需要微调ｙ坐标，以及字号
		--以默认的字体为标准，启体需下移，细黑需上移
		for i=0,9 do
			if T1[i+1]==str then return 1,i*50 end
		end
		for i=1,5 do
			if T2[i][1]==str then return 2,T2[i][2] end
		end
		for i=1,3 do
			if T3[i][1]==str then return 3,T3[i][2] end
		end
		return 0
	end
	
	local function mydelay(t)
		if t<=0 then return end
		lib.ShowSurface(0)
		lib.Delay(t)
	end
	
	local page, cy, cx = 0, 0, 0
    local color, t, font = C_WHITE, 0, CC.FontName
    while string.len(s) > 1 do
    if page == 0 then
      Cls()
      if headid >= 0 then
        DrawBox(xy[flag].headx, xy[flag].heady, xy[flag].headx + boxpicw, xy[flag].heady + boxpich, C_WHITE)
        DrawBox(xy[flag].namex, xy[flag].namey, xy[flag].namex + 96, xy[flag].namey + 24, C_WHITE)
        MyDrawString(xy[flag].namex, xy[flag].namex + 96, xy[flag].namey + 1, name, C_ORANGE, 21)
        local w, h = lib.PicGetXY(1, headid * 2)
        local x = (picw - w) / 2
        local y = (pich - h) / 2
        lib.PicLoadCache(1, headid * 2, xy[flag].headx + 5 + x, xy[flag].heady + 5 + y, 1)
      end
      DrawBox(xy[flag].talkx, xy[flag].talky, xy[flag].talkx + boxtalkw, xy[flag].talky + boxtalkh, C_WHITE)
      page = 1
    end
		local str
		str=string.sub(s,1,1)
		if str=='*' then
			str='Ｈ'
			s=string.sub(s,2,-1)
		else
			str=string.sub(s,1,2)
			s=string.sub(s,3,-1)
		end
		--开始控制逻辑
		if str=="Ｈ" then
			cx=0
			cy=cy+1
			if cy==3 then
				cy=0
				page=0
			end
		elseif str=="Ｐ" then
			cx=0
			cy=0
			page=0
		elseif str=="ｐ" then
			ShowScreen();
			WaitKey();	
			lib.Delay(100)	
		elseif str=="Ｎ" then
			s=JY.Person[pid]["姓名"]..s
		elseif str=="ｎ" then
			s=JY.Person[0]["姓名"]..s
		else 
			local kz1,kz2=readstr(str)
			if kz1==1 then
				t=kz2
			elseif kz1==2 then
				color=kz2
			elseif kz1==3 then
				font=kz2
			else
				lib.DrawStr(xy[flag].talkx+CC.DefaultFont*cx+5,
							xy[flag].talky+(CC.DefaultFont+talkBorder)*cy+talkBorder-8,
							str,color,CC.DefaultFont,font,0,0)
				mydelay(t)
				cx=cx+1
				if cx==talkxnum then
					cx=0
					cy=cy+1
					if cy==talkynum then
						cy=0
						page=0
					end
				end
			end
		end
		--如果换页，则显示，等待按键
		if page==0 or string.len(s)<2 then
			ShowScreen();
			WaitKey();
			lib.Delay(100)
		end
		
	end

    if CONFIG.KeyRepeat==0 then
	     lib.EnableKeyRepeat(CONFIG.KeyRepeatDelay,CONFIG.KeyRepeatInterval);
	end
	Cls();
end

function say2(s, hid) --直接调用头像对话
	TalkEx(s, hid, 0)
end

function say3(s, hid, name)
	if name == nil then name = "" end
	say(s,hid,0,name) 	
end

--设置颜色RGB
function RGB(r, g, b)
    return r * 65536 + g * 256 + b
end
--游戏主循环
function Game_Cycle()
    lib.Debug("Start game cycle")
  
    --游戏移动速度
    local function getmaindelay()
    local speed = JY.Person[0]["轻功"]
    if JY.Person[0]["武器"] > 0 then
      speed = speed + JY.Thing[JY.Person[0]["武器"]]["加轻功"]
    end
    if JY.Person[0]["防具"] > 0 then
      speed = speed + JY.Thing[JY.Person[0]["防具"]]["加轻功"]
    end
	if JY.Person[0]["无用15"] > 0 then
      speed = speed + JY.Thing[JY.Person[0]["无用15"]]["加轻功"]
    end
    if speed>300 then
		return 40-(speed-300)/10
		elseif speed>150 then
			return 50-(speed-150)/15
		else
			return 65-speed/10
		end
    end
  
    while JY.Status ~= GAME_END do
    local tstart = lib.GetTime()
    
    JY.MyTick = JY.MyTick + 1			--20个节拍无击键，则主角变为站立状态
    JY.MyTick2 = JY.MyTick2 + 1		--20个节拍无击键，则主角变为站立状态
    if JY.MyTick == 20 then
      JY.MyCurrentPic = 0
      JY.MyTick = 0
    end
    if JY.MyTick2 == 1000 then
      JY.MYtick2 = 0
    end
    if JY.Status == GAME_FIRSTMMAP then  --首次显示主场景，重新调用主场景贴图，渐变显示。然后转到正常显示
      CleanMemory()
	  lib.PicInit()--
      lib.ShowSlow(50, 1)
      JY.MmapMusic = 16
      JY.Status = GAME_MMAP
      Init_MMap()
      lib.DrawMMap(JY.Base["人X"], JY.Base["人Y"], GetMyPic())
      lib.ShowSlow(50, 0)
    elseif JY.Status == GAME_MMAP then
        Game_MMap()
    elseif JY.Status == GAME_SMAP then
        Game_SMap()
    elseif JY.Status == GAME_YC then
		YC_Main()
	end
    collectgarbage("step", 0)
    local tend = lib.GetTime()
    local FrameTime = getmaindelay()
    lib.Delay(JY.XZSPD)
	update()
    end
end
--非首次进入主地图
function Game_MMap()
    if JY.MAPKJ == 0 then
    DrawString(CC.ScreenW/2 - math.modf(#CC.EVB119*25/4), CC.ScreenH - 25 - 10, CC.EVB119, C_GOLD, 25)
    JY.MAPKJ = 1
    ShowScreen()
    lib.Delay(500)
    WaitKey()
    Cls()
    ShowScreen()
    end
    local direct = -1
    local keypress = lib.GetKey()
    if keypress ~= -1 then
    JY.MyTick = 0
    if keypress == VK_ESCAPE then
      MMenu()
      if JY.Status == GAME_FIRSTMMAP then
        return 
      end
      JY.oldMMapX = -1
      JY.oldMMapY = -1
	  elseif keypress == VK_UP then
	    direct = 0
	  elseif keypress == VK_DOWN then
	    direct = 3
	  elseif keypress == VK_LEFT then
	    direct = 2
	  elseif keypress == VK_RIGHT then
	    direct = 1
	  elseif keypress == 9 then
	    return;
	  end
	  --test main map battle
	if keypress == VK_UP or keypress == VK_DOWN or keypress == VK_LEFT or keypress == VK_RIGHT then
			OEVENTLUA[30050]()
			OEVENTLUA[30011]()
			OEVENTLUA[30002]()
	end		  
	  if keypress > 1999999 then
	    local mx = math.modf((keypress - 2000000) / 1000)
	    local my = math.fmod(keypress - 2000000, 1000)
	    mx = mx - CC.ScreenW / 2
	    my = my - CC.ScreenH / 2
	    mx = (mx) / CC.XScale
	    my = (my) / CC.YScale
	    mx, my = (mx + my) / 2, (my - mx) / 2
	    if mx > 0 then
	      mx = mx + 0.99
	    else
	      mx = mx - 0.01
	    end
	    if my > 0 then
	      my = my + 0.99
	    else
	      mx = mx - 0.01
	    end
	    mx = math.modf(mx)
	    my = math.modf(my)
	    walkto(mx, my)
	  elseif keypress == 45 then
	    CC.MapSize = limitX(CC.MapSize - 1, 8, math.modf(math.min(CC.ScreenW / 32, CC.ScreenH / 16)))
	  elseif keypress == 61 then
	    CC.MapSize = limitX(CC.MapSize + 1, 8, math.modf(math.min(CC.ScreenW / 32, CC.ScreenH / 16)))
	  elseif keypress == 109 then
	    CC.MapKind = CC.MapKind + 1
	  end
	  if CC.MapKind > 2 then
	    CC.MapKind = 0
	  end
	  FKJGN(keypress)     --自定义快捷键
    end
    if JY.Status ~= GAME_MMAP then
       return 
    end
    if AutoMoveTab[0] ~= 0 then
    if direct == -1 then
      direct = AutoMoveTab[AutoMoveTab[0]]
      AutoMoveTab[AutoMoveTab[0]] = nil
      AutoMoveTab[0] = AutoMoveTab[0] - 1
    end
    else
      AutoMoveTab = {[0] = 0}
    end
  
    local x, y = nil, nil    
    local CanMove = function(nd, nnd)
    local nx, ny = JY.Base["人X"] + CC.DirectX[nd + 1], JY.Base["人Y"] + CC.DirectY[nd + 1]
    if nnd ~= nil then
      nx, ny = nx + CC.DirectX[nnd + 1], ny + CC.DirectY[nnd + 1]
    end
    if CC.hx == nil and ((lib.GetMMap(nx, ny, 3) == 0 and lib.GetMMap(nx, ny, 4) == 0) or CanEnterScene(nx, ny) ~= -1) then
      return true
    else
      return false
    end
    end
    if direct ~= -1 then
    AddMyCurrentPic()			--增加主角贴图编号，产生走路效果
    x = JY.Base["人X"] + CC.DirectX[direct + 1]
    y = JY.Base["人Y"] + CC.DirectY[direct + 1]
    JY.Base["人方向"] = direct
    else
    x = JY.Base["人X"]
    y = JY.Base["人Y"]
    end
  
    if direct ~= -1 then
	JY.TIMECOUNT = JY.TIMECOUNT + 1
	if JY.TIMECOUNT == 24 then
		JY.TIMECOUNT = 0
		addtime(1)
		if JY.TL <= 20 then
			say("走了这么久，需要休息一下了。")
			dark()
			instruct_12()
			addtime2(2)
			light()
		end
	end
    end
  
    if direct ~= -1 then
       JY.SubScene = CanEnterScene(x, y)		--判断是否进入子场景
    end
    if CC.hx ~= nil or lib.GetMMap(x, y, 3) == 0 and lib.GetMMap(x, y, 4) == 0 then
       JY.Base["人X"] = x
       JY.Base["人Y"] = y
    end
    JY.Base["人X"] = limitX(JY.Base["人X"], 10, CC.MWidth - 10)			--限制坐标不能超出范围
    JY.Base["人Y"] = limitX(JY.Base["人Y"], 10, CC.MHeight - 10)
    if CC.MMapBoat[lib.GetMMap(JY.Base["人X"], JY.Base["人Y"], 0)] == 1 then
       JY.Base["乘船"] = 1
    else
       JY.Base["乘船"] = 0
    end
    local pic = GetMyPic()


    if CONFIG.FastShowScreen==1 then  --设置快速显示，并且主角位置不变，则显示裁剪窗口
        if JY.oldMMapX==JY.Base["人X"] and JY.oldMMapY==JY.Base["人Y"] then
			if JY.oldMMapPic>=0 and JY.oldMMapPic ~= pic then        --主角贴图有变化，则刷新显示。
				local rr=ClipRect(Cal_PicClip(0,0,JY.oldMMapPic,0,0,0,pic,0));
				if rr~=nil then
					lib.SetClip(rr.x1,rr.y1,rr.x2,rr.y2);
					lib.DrawMMap(JY.Base["人X"],JY.Base["人Y"],pic);             --显示主地图
				end
			end
		else
			lib.SetClip(0,0,CC.ScreenW,CC.ScreenH);
			lib.DrawMMap(JY.Base["人X"],JY.Base["人Y"],pic);             --显示主地图
		end
	else  --全部显示
		lib.DrawMMap(JY.Base["人X"],JY.Base["人Y"],pic);             --显示主地图
	end
	
	
    if CC.ShowXY == 1 then
       DrawString(10, CC.ScreenH - 20, string.format("大地图 %d %d", JY.Base["人X"], JY.Base["人Y"]), C_GOLD, 16)
       DrawString(CC.ScreenW - 150, 8, os.date("%c"), C_GOLD, 16)
    end
    if JY.JB == 1 then
       JYZTB()     --显示简易信息
    end
    DrawMMapMini()
    ShowScreen(CONFIG.FastShowScreen)
    lib.SetClip(0, 0, 0, 0)
    JY.oldMMapX = JY.Base["人X"]
    JY.oldMMapY = JY.Base["人Y"]
    JY.oldMMapPic = pic
    if JY.SubScene >= 0 then
    CleanMemory()
    lib.UnloadMMap()
    lib.PicInit()
    JY.Status = GAME_SMAP
    JY.MmapMusic = -1
    JY.MyPic = GetMyPic()
    JY.Base["人X1"] = JY.Scene[JY.SubScene]["入口X"]
    JY.Base["人Y1"] = JY.Scene[JY.SubScene]["入口Y"]
    Init_SMap(1)
    end
end

--场景处理主函数
function Game_SMap()
    DrawSMap(CONFIG.FastShowScreen)
    DrawSMapMini()
    if CC.ShowXY == 1 then
       DrawString(10, CC.ScreenH - 20, string.format("%s %d %d", JY.Scene[JY.SubScene]["名称"], JY.Base["人X1"], JY.Base["人Y1"]), C_GOLD, 16)
       DrawString(CC.ScreenW - 150, 8, os.date("%c"), C_GOLD, 16)
    end
  
    if JY.JB == 1 then		--显示简易信息
       JYZTB()
    end
  
    if JY.WGLVXS == 1 then
       DrawString(10, CC.ScreenH - 25, JY.SubScene .. " " .. JY.Scene[JY.SubScene]["名称"], C_GOLD, 20)
    end
    ShowScreen(CONFIG.FastShowScreen)
    lib.SetClip(0, 0, 0, 0)
  
    local d_pass=GetS(JY.SubScene,JY.Base["人X1"],JY.Base["人Y1"],3);   --当前路过事件
    if d_pass>=0 then
    if d_pass ~=JY.OldDPass then     --避免重复触发
        EventExecute(d_pass,3);       --路过触发事件
        JY.OldDPass=d_pass;
		    JY.oldSMapX=-1;
		    JY.oldSMapY=-1;
				JY.D_Valid=nil;
		end
		if JY.Status~=GAME_SMAP then
			return ;
    else
       JY.OldDPass=-1;
    end
    end
    local isout=0;                --是否碰到出口
    if (JY.Scene[JY.SubScene]["出口X1"] ==JY.Base["人X1"] and JY.Scene[JY.SubScene]["出口Y1"] ==JY.Base["人Y1"]) or
       (JY.Scene[JY.SubScene]["出口X2"] ==JY.Base["人X1"] and JY.Scene[JY.SubScene]["出口Y2"] ==JY.Base["人Y1"]) or
       (JY.Scene[JY.SubScene]["出口X3"] ==JY.Base["人X1"] and JY.Scene[JY.SubScene]["出口Y3"] ==JY.Base["人Y1"]) then
       isout=1;
    end
  
	if isout == 1 then
		--if YC_Status() == 1 then --mark
			--YC_Exit()
		--else
			JY.Status = GAME_MMAP
			lib.PicInit()
			CleanMemory()
			if JY.MmapMusic < 0 then
				if CONFIG.MP3 == 1 then
					JY.MmapMusic = 39 + math.random(5)
				end
			else
				JY.MmapMusic = 25
			end
			Init_MMap()
			JY.SubScene = -1
			JY.oldSMapX = -1
			JY.oldSMapY = -1
			lib.DrawMMap(JY.Base["人X"], JY.Base["人Y"], GetMyPic())
			lib.GetKey()
			return 
		--end
	end
    if JY.Scene[JY.SubScene]["跳转场景"] >= 0 and JY.Base["人X1"] == JY.Scene[JY.SubScene]["跳转口X1"] and JY.Base["人Y1"] == JY.Scene[JY.SubScene]["跳转口Y1"] then
    local OldScene = JY.SubScene
    JY.SubScene = JY.Scene[JY.SubScene]["跳转场景"]
    lib.ShowSlow(50, 1)
    if JY.Scene[OldScene]["外景入口X1"] ~= 0 then
      JY.Base["人X1"] = JY.Scene[JY.SubScene]["入口X"]
      JY.Base["人Y1"] = JY.Scene[JY.SubScene]["入口Y"]
    else
      JY.Base["人X1"] = JY.Scene[JY.SubScene]["跳转口X2"]
      JY.Base["人Y1"] = JY.Scene[JY.SubScene]["跳转口Y2"]
    end
    Init_SMap(1)
    return 
    end
 
    local x, y = nil, nil
    local keypress = lib.GetKey()
    local direct = -1
    if keypress ~= -1 then
       JY.MyTick = 0
   
    --test randomized battle
	if keypress == VK_UP or keypress == VK_DOWN or keypress == VK_LEFT or keypress == VK_RIGHT then
	    if JY.Person[0]["觉醒"] > 0 and GetS(99,1,0,0) > 0 then 
		    if math.random(200) == 100 and JY.SubScene ~= 113 then
			SetS(99,1,0,0,(GetS(99,1,0,0)+1))
			local a = 0
			if tianshu() <= 12 then 
			   a = 130
			end
			if tianshu()> 12 and tianshu() <= 14 then 
			   a = 128
			end
		    say("什么人？？",0)
	            if WarMain(a) == false then
		           instruct_15(0);   
		           instruct_0();  
		           do return; end			
	            end
			say("他们抢天书想干嘛？",0)	
			if GetS(99,1,0,0) == 5 then 
			say("不行，这样没完没了不是办法，我得想个办法才行！",0)	
			   instruct_3(80,20,0,0,0,0,5046,0,0,0,-2,48,36)
			end
			end	
		end
		if GetS(106, 1, 0, 0) ~= 0 and GetS(106, 1, 1, 0) < 1 then
			SetS(106, 1, 1, 0, (GetS(106, 1, 1, 0) + 1))
				SetS(106, 63, 1, 0, 0)
	            SetS(106, 63, 2, 0, 46)
	            Cls()
	            say("小子，星宿派是你说来就来，说走就走的地方吗？！", 57)
	            JY.Person[46]["攻击力"] = JY.Person[46]["攻击力"] + 300
	            JY.Person[46]["轻功"] = JY.Person[46]["轻功"] + 300
	            JY.Person[46]["防御力"] = JY.Person[46]["防御力"] + 300
				JY.Person[46]["生命最大值"] = JY.Person[46]["生命最大值"] + 5000
				JY.Person[46]["生命"] = JY.Person[46]["生命"] + 5000
                JY.Person[46]["内力最大值"] = 10000
	            JY.Person[46]["内力"] = 10000				
				--JY.Person[46]["武功10"] = 181
				--JY.Person[46]["武功等级10"] = 999
                setJX(46)
	            if WarMain(288) == false then
		           instruct_15(0);   
		           instruct_0();  
		           do return; end			
	            end	
				JY.Person[46]["生命最大值"] = JY.Person[46]["生命最大值"] - 1000
				JY.Person[46]["生命"] = JY.Person[46]["生命"] - 5000
	            JY.Person[46]["攻击力"] = JY.Person[46]["攻击力"] - 300
	            JY.Person[46]["轻功"] = JY.Person[46]["轻功"] - 300
	            JY.Person[46]["防御力"] = JY.Person[46]["防御力"]- 300				
		end
		if GetS(106, 2, 0, 0) ~= 0 and GetS(106, 2, 1, 0) < 1 then
			SetS(106, 2, 1, 0, (GetS(106, 2, 1, 0) + 1))
				SetS(106, 63, 1, 0, 0)
	            SetS(106, 63, 2, 0, 50)
	            Cls()
	            say("虽然我丐帮是叫花子，但也不允许弟子做出叛帮之事！！", 50)
	            JY.Person[50]["攻击力"] = JY.Person[50]["攻击力"] + 300
	            JY.Person[50]["轻功"] = JY.Person[50]["轻功"] + 300
	            JY.Person[50]["防御力"] = JY.Person[50]["防御力"] + 300
				JY.Person[50]["生命最大值"] = JY.Person[46]["生命最大值"] + 5000
				JY.Person[50]["生命"] = JY.Person[50]["生命"] + 5000
                JY.Person[50]["内力最大值"] = 10000
	            JY.Person[50]["内力"] = 10000				
				--JY.Person[50]["武功10"] = 181
				--JY.Person[50]["武功等级10"] = 999
                setJX(50)
	            if WarMain(288) == false then
		           instruct_15(0);   
		           instruct_0();  
		           do return; end			
	            end	
				JY.Person[50]["生命最大值"] = JY.Person[50]["生命最大值"] - 5000
				JY.Person[50]["生命"] = JY.Person[50]["生命"] - 5000
	            JY.Person[50]["攻击力"] = JY.Person[50]["攻击力"] - 300
	            JY.Person[50]["轻功"] = JY.Person[50]["轻功"] - 300
	            JY.Person[50]["防御力"] = JY.Person[50]["防御力"]- 300	
		end	
		if GetS(106, 3, 0, 0) ~= 0 and GetS(106, 3, 1, 0) < 1 then
			SetS(106, 3, 1, 0, (GetS(106, 3, 1, 0) + 1))
				SetS(106, 63, 1, 0, 0)
	            SetS(106, 63, 2, 0, 601)
	            Cls()
	            say("古墓派虽是女子，但也不会任由欺负！！", 601)
	            JY.Person[601]["攻击力"] = JY.Person[601]["攻击力"] + 300
	            JY.Person[601]["轻功"] = JY.Person[601]["轻功"] + 300
	            JY.Person[601]["防御力"] = JY.Person[601]["防御力"] + 300
				JY.Person[601]["生命最大值"] = JY.Person[601]["生命最大值"] + 5000
				JY.Person[601]["生命"] = JY.Person[601]["生命最大值"] + 5000
                JY.Person[601]["内力最大值"] = 10000
	            JY.Person[601]["内力"] = 10000				
				--JY.Person[601]["武功10"] = 181
				--JY.Person[601]["武功等级10"] = 999
                setJX(601)
	            if WarMain(288) == false then
		           instruct_15(0);   
		           instruct_0();  
		           do return; end			
	            end	
				JY.Person[601]["生命最大值"] = JY.Person[601]["生命最大值"] - 5000
				JY.Person[601]["生命"] = JY.Person[601]["生命"] - 5000
	            JY.Person[601]["攻击力"] = JY.Person[601]["攻击力"] - 300
	            JY.Person[601]["轻功"] = JY.Person[601]["轻功"] - 300
	            JY.Person[601]["防御力"] = JY.Person[601]["防御力"]- 300	
		end	
		if GetS(106, 4, 0, 0) ~= 0 and GetS(106, 4, 1, 0) < 1 then
			SetS(106, 4, 1, 0, (GetS(106, 4, 1, 0) + 1))
				SetS(106, 63, 1, 0, 0)
	            SetS(106, 63, 2, 0, 5)
	            Cls()
	            say("小友何必呢？！", 5)
	            JY.Person[5]["攻击力"] = JY.Person[5]["攻击力"] + 300
	            JY.Person[5]["轻功"] = JY.Person[5]["轻功"] + 300
	            JY.Person[5]["防御力"] = JY.Person[5]["防御力"] + 300
				JY.Person[5]["生命最大值"] = JY.Person[5]["生命最大值"] + 5000
				JY.Person[5]["生命"] = JY.Person[5]["生命最大值"] + 5000
                JY.Person[5]["内力最大值"] = 10000
	            JY.Person[5]["内力"] = 10000				
				--JY.Person[5]["武功10"] = 181
				--JY.Person[5]["武功等级10"] = 999
                setJX(5)
	            if WarMain(288) == false then
		           instruct_15(0);   
		           instruct_0();  
		           do return; end			
	            end	
				JY.Person[5]["生命最大值"] = JY.Person[5]["生命最大值"] - 5000
				JY.Person[5]["生命"] = JY.Person[5]["生命"] - 5000
	            JY.Person[5]["攻击力"] = JY.Person[5]["攻击力"] - 300
	            JY.Person[5]["轻功"] = JY.Person[5]["轻功"] - 300
	            JY.Person[5]["防御力"] = JY.Person[5]["防御力"]- 300	
		end	
		if GetS(106, 5, 0, 0) ~= 0 and GetS(106, 5, 1, 0) < 1 then
			SetS(106, 5, 1, 0, (GetS(106, 5, 1, 0) + 1))
				SetS(106, 63, 1, 0, 0)
	            SetS(106, 63, 2, 0, 615)
	            Cls()
	            say("阿弥陀佛！！", 615)
	            JY.Person[615]["攻击力"] = JY.Person[615]["攻击力"] + 300
	            JY.Person[615]["轻功"] = JY.Person[615]["轻功"] + 300
	            JY.Person[615]["防御力"] = JY.Person[615]["防御力"] + 300
				JY.Person[615]["生命最大值"] = JY.Person[615]["生命最大值"] + 5000
				JY.Person[615]["生命"] = JY.Person[615]["生命最大值"] + 5000
                JY.Person[615]["内力最大值"] = 10000
	            JY.Person[615]["内力"] = 10000				
				--JY.Person[615]["武功10"] = 181
				--JY.Person[615]["武功等级10"] = 999
                setJX(615)
	            if WarMain(288) == false then
		           instruct_15(0);   
		           instruct_0();  
		           do return; end			
	            end	
				JY.Person[615]["生命最大值"] = JY.Person[615]["生命最大值"] - 5000
				JY.Person[615]["生命"] = JY.Person[615]["生命"] - 5000
	            JY.Person[615]["攻击力"] = JY.Person[615]["攻击力"] - 300
	            JY.Person[615]["轻功"] = JY.Person[615]["轻功"] - 300
	            JY.Person[615]["防御力"] = JY.Person[615]["防御力"]- 300	
		end	
		if GetS(106, 6, 0, 0) ~= 0 and GetS(106, 6, 1, 0) < 1 then
			SetS(106, 6, 1, 0, (GetS(106, 6, 1, 0) + 1))
				SetS(106, 63, 1, 0, 0)
	            SetS(106, 63, 2, 0, 62)
	            Cls()
	            say("不要小看我密宗！！", 62)
	            JY.Person[62]["攻击力"] = JY.Person[62]["攻击力"] + 300
	            JY.Person[62]["轻功"] = JY.Person[628]["轻功"] + 300
	            JY.Person[62]["防御力"] = JY.Person[62]["防御力"] + 300
				JY.Person[62]["生命最大值"] = JY.Person[62]["生命最大值"] + 5000
				JY.Person[62]["生命"] = JY.Person[62]["生命最大值"] + 5000
                JY.Person[62]["内力最大值"] = 10000
	            JY.Person[62]["内力"] = 10000				
				--JY.Person[62]["武功10"] = 181
				--JY.Person[62]["武功等级10"] = 999
                setJX(62)
	            if WarMain(288) == false then
		           instruct_15(0);   
		           instruct_0();  
		           do return; end			
	            end	
				JY.Person[62]["生命最大值"] = JY.Person[62]["生命最大值"] - 5000
				JY.Person[62]["生命"] = JY.Person[62]["生命"] - 5000
	            JY.Person[62]["攻击力"] = JY.Person[62]["攻击力"] - 300
	            JY.Person[62]["轻功"] = JY.Person[62]["轻功"] - 300
	            JY.Person[62]["防御力"] = JY.Person[62]["防御力"]- 300	
		end	
		if GetS(106, 7, 0, 0) ~= 0 and GetS(106, 7, 1, 0) < 1 then
			SetS(106, 7, 1, 0, (GetS(106, 7, 1, 0) + 1))
				SetS(106, 63, 1, 0, 0)
	            SetS(106, 63, 2, 0, 618)
	            Cls()
	            say("逍遥浮生不好吗？！", 618)
	            JY.Person[618]["攻击力"] = JY.Person[618]["攻击力"] + 300
	            JY.Person[618]["轻功"] = JY.Person[618]["轻功"] + 300
	            JY.Person[618]["防御力"] = JY.Person[618]["防御力"] + 300
				JY.Person[618]["生命最大值"] = JY.Person[618]["生命最大值"] + 5000
				JY.Person[618]["生命"] = JY.Person[618]["生命最大值"] + 5000
                JY.Person[618]["内力最大值"] = 10000
	            JY.Person[618]["内力"] = 10000				
				--JY.Person[618]["武功10"] = 181
				--JY.Person[618]["武功等级10"] = 999
                setJX(618)
	            if WarMain(288) == false then
		           instruct_15(0);   
		           instruct_0();  
		           do return; end			
	            end	
				JY.Person[618]["生命最大值"] = JY.Person[618]["生命最大值"] - 5000
				JY.Person[618]["生命"] = JY.Person[618]["生命"] - 5000
	            JY.Person[618]["攻击力"] = JY.Person[618]["攻击力"] - 300
	            JY.Person[618]["轻功"] = JY.Person[618]["轻功"] - 300
	            JY.Person[618]["防御力"] = JY.Person[618]["防御力"]- 300	
		end	
		if GetS(106, 8, 0, 0) ~= 0 and GetS(106, 8, 1, 0) < 1 then
			SetS(106, 8, 1, 0, (GetS(106, 8, 1, 0) + 1))
				SetS(106, 63, 1, 0, 0)
	            SetS(106, 63, 2, 0, 60)
	            Cls()
	            say("你当我白驼山庄是什么地方？！", 60)
	            JY.Person[60]["攻击力"] = JY.Person[60]["攻击力"] + 300
	            JY.Person[60]["轻功"] = JY.Person[60]["轻功"] + 300
	            JY.Person[60]["防御力"] = JY.Person[60]["防御力"] + 300
				JY.Person[60]["生命最大值"] = JY.Person[60]["生命最大值"] + 5000
				JY.Person[60]["生命"] = JY.Person[60]["生命最大值"] + 5000
                JY.Person[60]["内力最大值"] = 10000
	            JY.Person[60]["内力"] = 10000				
				--JY.Person[60]["武功10"] = 181
				--JY.Person[60]["武功等级10"] = 999
                setJX(60)
	            if WarMain(288) == false then
		           instruct_15(0);   
		           instruct_0();  
		           do return; end			
	            end	
				JY.Person[60]["生命最大值"] = JY.Person[60]["生命最大值"] - 5000
				JY.Person[60]["生命"] = JY.Person[60]["生命"] - 5000
	            JY.Person[60]["攻击力"] = JY.Person[60]["攻击力"] - 300
	            JY.Person[60]["轻功"] = JY.Person[60]["轻功"] - 300
	            JY.Person[60]["防御力"] = JY.Person[60]["防御力"]- 300	
		end	
		if GetS(106, 9, 0, 0) ~= 0 and GetS(106, 9, 1, 0) < 1 then
			SetS(106, 9, 1, 0, (GetS(106, 9, 1, 0) + 1))
				SetS(106, 63, 1, 0, 0)
	            SetS(106, 63, 2, 0, 93)
	            Cls()
				for i,v in pairs(CC.Person_S) do
					JY.Person[930][i] = JY.Person[93][i]
				end				
	            say("叛我唐门者死！", 93)
	            JY.Person[93]["攻击力"] = 999
	            JY.Person[93]["轻功"] = 999
	            JY.Person[93]["防御力"] = 999
				JY.Person[93]["生命最大值"] = 8000
				JY.Person[93]["生命"] = 8000
                JY.Person[93]["内力最大值"] = 10000
	            JY.Person[93]["内力"] = 10000
				JY.Person[93]["暗器技巧"] = 999
				JY.Person[93]["技能4"] = 108
				JY.Person[93]["技能5"] = 137
				JY.Person[93]["姓名"] = "唐方"
				JY.Person[93]["武功1"] = 177
				JY.Person[93]["武功2"] = 105
				JY.Person[93]["武功3"] = 191
				JY.Person[93]["武功4"] = 90
				JY.Person[93]["武功5"] = 102
				JY.Person[93]["武功6"] = 104
				JY.Person[93]["武功7"] = 107
				JY.Person[93]["武功8"] = 121
				JY.Person[93]["武功9"] = 124
				JY.Person[93]["武功10"] = 178
				JY.Person[93]["武功11"] = 181
				JY.Person[93]["武功12"] = 87
				for i = 1, 10 do
					JY.Person[93]["武功等级"..i] = 999
				end
				JY.Person[93]["声望"] = 105
                setJX(93)
	            if WarMain(288) == false then
		           instruct_15(0);   
		           instruct_0();  
		           do return; end			
	            end
				for i,v in pairs(CC.Person_S) do
					JY.Person[93][i] = JY.Person[930][i]
				end				
		end	
        if GetS(106, 11, 0, 0) ~= 0 and GetS(106, 11, 1, 0) < 1 and MPPD(zj()) ~= 11 then	--谢无悠
            	SetS(106, 11, 1, 0, (GetS(106, 11, 1, 0) + 1))
				SetS(106, 63, 1, 0, 0)
	            SetS(106, 63, 2, 0, 597)
	            Cls()	
	            say("忘了当初我说过的话了么，叛门杀无赦，做好准备了么？", 597)
	            JY.Person[597]["攻击力"] = 500
	            JY.Person[597]["轻功"] = 500
	            JY.Person[597]["防御力"] = 500
	            JY.Person[597]["生命最大值"] = 2999
	            JY.Person[597]["生命"] = 2999
                JY.Person[597]["内力最大值"] = 10000
	            JY.Person[597]["内力"] = 10000	
				JY.Person[597]["实战"] = 500
	            JY.Person[597]["声望"] = 180
				JY.Person[597]["外号"] = 105
				JY.Person[597]["资质"] = 100
				JY.Person[597]["武功1"] = 131
				JY.Person[597]["武功等级1"] = 999
				JY.Person[597]["武功2"] = 180
				JY.Person[597]["武功等级2"] = 999
				JY.Person[597]["武功3"] = 103
				JY.Person[597]["武功等级3"] = 999
				JY.Person[597]["武功4"] = 96
				JY.Person[597]["武功等级4"] = 999
				JY.Person[597]["武功5"] = 115
				JY.Person[597]["武功等级5"] = 999
				JY.Person[597]["武功6"] = 97
				JY.Person[597]["武功等级6"] = 999
				JY.Person[597]["武功7"] = 106
				JY.Person[597]["武功等级7"] = 999
				JY.Person[597]["武功8"] = 107
				JY.Person[597]["武功等级8"] = 999
				JY.Person[597]["武功9"] = 85
				JY.Person[597]["武功等级9"] = 999
				JY.Person[597]["武功10"] = 124
				JY.Person[597]["武功等级10"] = 999
				JY.Person[597]["武功11"] = 108
				JY.Person[597]["武功等级11"] = 999
				JY.Person[597]["武功12"] = 151
				JY.Person[597]["武功等级12"] = 999
                setJX(597)
				--instruct_21(92)
				--instruct_3(70,1,0,0,0,0,0,0,0,0,-2,-2,-2)
	            if WarMain(288) == false then
		           instruct_15(0);   
		           instruct_0();  
		           do return; end			
	            end			
	    end	
		if GetS(106, 10, 0, 0) ~= 0 and GetS(106, 10, 1, 0) < 1 then	
            	SetS(106, 10, 1, 0, (GetS(106, 10, 1, 0) + 1))
				SetS(106, 63, 1, 0, 0)
	            SetS(106, 63, 2, 0, 57)
	            Cls()
				say("啊！！我的腿！！！", 0)
	            say("小子，你敢背叛师门，可做好觉悟？！", 57)
	            JY.Person[57]["攻击力"] = JY.Person[57]["攻击力"] + 300
	            JY.Person[57]["轻功"] = JY.Person[57]["轻功"] + 300
	            JY.Person[57]["防御力"] = JY.Person[57]["防御力"] + 300
				JY.Person[57]["武功5"] = 107
				JY.Person[57]["武功等级5"] = 999
                JY.Person[57]["内力最大值"] = 10000
	            JY.Person[57]["内力"] = 10000				
                setJX(57)
	            if WarMain(288) == false then
		           instruct_15(0);   
		           instruct_0();  
		           do return; end			
	            end	
	            JY.Person[57]["攻击力"] = JY.Person[57]["攻击力"] - 300
	            JY.Person[57]["轻功"] = JY.Person[57]["轻功"] - 300
	            JY.Person[57]["防御力"] = JY.Person[57]["防御力"]- 300				
	    end	
		if GetS(106, 12, 0, 0) ~= 0 and GetS(106, 12, 1, 0) < 1 then
			SetS(106, 12, 1, 0, (GetS(106, 12, 1, 0) + 1))
				SetS(106, 63, 1, 0, 0)
	            SetS(106, 63, 2, 0, 27)
	            Cls()
	            say("叛教者---死！！", 27)
	            JY.Person[27]["攻击力"] = JY.Person[27]["攻击力"] + 300
	            JY.Person[27]["轻功"] = JY.Person[27]["轻功"] + 300
	            JY.Person[27]["防御力"] = JY.Person[27]["防御力"] + 300
				JY.Person[27]["生命最大值"] = JY.Person[27]["生命最大值"] + 5000
				JY.Person[27]["生命"] = JY.Person[27]["生命最大值"] + 5000
                JY.Person[27]["内力最大值"] = 10000
	            JY.Person[27]["内力"] = 10000				
				--JY.Person[27]["武功10"] = 181
				--JY.Person[27]["武功等级10"] = 999
                setJX(27)
	            if WarMain(288) == false then
		           instruct_15(0);   
		           instruct_0();  
		           do return; end			
	            end	
				JY.Person[27]["生命最大值"] = JY.Person[27]["生命最大值"] - 5000
				JY.Person[27]["生命"] = JY.Person[27]["生命"] - 5000
	            JY.Person[27]["攻击力"] = JY.Person[27]["攻击力"] - 300
	            JY.Person[27]["轻功"] = JY.Person[27]["轻功"] - 300
	            JY.Person[27]["防御力"] = JY.Person[27]["防御力"]- 300	
		end	
		if GetS(106, 13, 0, 0) ~= 0 and GetS(106, 13, 1, 0) < 1 then
			SetS(106, 13, 1, 0, (GetS(106, 13, 1, 0) + 1))
				SetS(106, 63, 1, 0, 0)
	            SetS(106, 63, 2, 0, 558)
	            Cls()
	            say("受死吧！！", 558)
	            JY.Person[558]["攻击力"] = JY.Person[558]["攻击力"] + 300
	            JY.Person[558]["轻功"] = JY.Person[558]["轻功"] + 300
	            JY.Person[558]["防御力"] = JY.Person[558]["防御力"] + 300
				JY.Person[558]["生命最大值"] = JY.Person[55]["生命最大值"] + 5000
				JY.Person[558]["生命"] = JY.Person[558]["生命最大值"] + 5000
                JY.Person[558]["内力最大值"] = 10000
	            JY.Person[558]["内力"] = 10000				
				--JY.Person[558]["武功10"] = 181
				--JY.Person[558]["武功等级10"] = 999
                setJX(558)
	            if WarMain(288) == false then
		           instruct_15(0);   
		           instruct_0();  
		           do return; end			
	            end	
				JY.Person[558]["生命最大值"] = JY.Person[558]["生命最大值"] - 5000
				JY.Person[558]["生命"] = JY.Person[558]["生命"] - 5000
	            JY.Person[558]["攻击力"] = JY.Person[558]["攻击力"] - 300
	            JY.Person[558]["轻功"] = JY.Person[558]["轻功"] - 300
	            JY.Person[558]["防御力"] = JY.Person[558]["防御力"]- 300	
		end	
		if GetS(106, 14, 0, 0) ~= 0 and GetS(106, 14, 1, 0) < 1 then
			SetS(106, 14, 1, 0, (GetS(106, 14, 1, 0) + 1))
				SetS(106, 63, 1, 0, 0)
	            SetS(106, 63, 2, 0, 19)
	            Cls()
	            say("小兄弟可惜啊！！！", 19)
	            JY.Person[19]["攻击力"] = JY.Person[19]["攻击力"] + 300
	            JY.Person[19]["轻功"] = JY.Person[19]["轻功"] + 300
	            JY.Person[19]["防御力"] = JY.Person[19]["防御力"] + 300
				JY.Person[19]["生命最大值"] = JY.Person[19]["生命最大值"] + 5000
				JY.Person[19]["生命"] = JY.Person[19]["生命最大值"] + 5000
                JY.Person[19]["内力最大值"] = 10000
	            JY.Person[19]["内力"] = 10000				
				--JY.Person[19]["武功10"] = 181
				--JY.Person[19]["武功等级10"] = 999
                setJX(19)
	            if WarMain(288) == false then
		           instruct_15(0);   
		           instruct_0();  
		           do return; end			
	            end	
				JY.Person[19]["生命最大值"] = JY.Person[19]["生命最大值"] - 5000
				JY.Person[19]["生命"] = JY.Person[19]["生命"] - 5000
	            JY.Person[19]["攻击力"] = JY.Person[19]["攻击力"] - 300
	            JY.Person[19]["轻功"] = JY.Person[19]["轻功"] - 300
	            JY.Person[19]["防御力"] = JY.Person[19]["防御力"]- 300	
		end	
		if GetS(106, 15, 0, 0) ~= 0 and GetS(106, 15, 1, 0) < 1 then
			SetS(106, 15, 1, 0, (GetS(106, 15, 1, 0) + 1))
				SetS(106, 63, 1, 0, 0)
	            SetS(106, 63, 2, 0, 602)
	            Cls()
	            say("唉！！", 602)
	            JY.Person[602]["攻击力"] = JY.Person[602]["攻击力"] + 300
	            JY.Person[602]["轻功"] = JY.Person[602]["轻功"] + 300
	            JY.Person[602]["防御力"] = JY.Person[602]["防御力"] + 300
				JY.Person[602]["生命最大值"] = JY.Person[602]["生命最大值"] + 5000
				JY.Person[602]["生命"] = JY.Person[602]["生命最大值"] + 5000
                JY.Person[602]["内力最大值"] = 10000
	            JY.Person[602]["内力"] = 10000				
				--JY.Person[602]["武功10"] = 181
				--JY.Person[602]["武功等级10"] = 999
                setJX(602)
	            if WarMain(288) == false then
		           instruct_15(0);   
		           instruct_0();  
		           do return; end			
	            end	
				JY.Person[602]["生命最大值"] = JY.Person[602]["生命最大值"] - 5000
				JY.Person[602]["生命"] = JY.Person[602]["生命"] - 5000
	            JY.Person[602]["攻击力"] = JY.Person[602]["攻击力"] - 300
	            JY.Person[602]["轻功"] = JY.Person[602]["轻功"] - 300
	            JY.Person[602]["防御力"] = JY.Person[602]["防御力"]- 300	
		end	
		if GetS(106, 16, 0, 0) ~= 0 and GetS(106, 16, 1, 0) < 1 then
			SetS(106, 16, 1, 0, (GetS(106, 16, 1, 0) + 1))
				SetS(106, 63, 1, 0, 0)
	            SetS(106, 63, 2, 0, 129)
	            Cls()
	            say("真是可惜！！", 129)
	            JY.Person[129]["攻击力"] = JY.Person[129]["攻击力"] + 300
	            JY.Person[129]["轻功"] = JY.Person[129]["轻功"] + 300
	            JY.Person[129]["防御力"] = JY.Person[129]["防御力"] + 300
				JY.Person[129]["生命最大值"] = JY.Person[129]["生命最大值"] + 5000
				JY.Person[129]["生命"] = JY.Person[129]["生命最大值"] + 5000
                JY.Person[129]["内力最大值"] = 10000
	            JY.Person[129]["内力"] = 10000				
				--JY.Person[129]["武功10"] = 181
				--JY.Person[129]["武功等级10"] = 999
                setJX(129)
	            if WarMain(288) == false then
		           instruct_15(0);   
		           instruct_0();  
		           do return; end			
	            end	
				JY.Person[129]["生命最大值"] = JY.Person[129]["生命最大值"] - 5000
				JY.Person[129]["生命"] = JY.Person[129]["生命"] - 5000
	            JY.Person[129]["攻击力"] = JY.Person[129]["攻击力"] - 300
	            JY.Person[129]["轻功"] = JY.Person[129]["轻功"] - 300
	            JY.Person[129]["防御力"] = JY.Person[129]["防御力"]- 300	
		end	
		if GetS(106, 17, 0, 0) ~= 0 and GetS(106, 17, 1, 0) < 1 then
			SetS(106, 17, 1, 0, (GetS(106, 17, 1, 0) + 1))
				SetS(106, 63, 1, 0, 0)
	            SetS(106, 63, 2, 0, 6)
	            Cls()
	            say("孽徒受死！", 6)
	            JY.Person[6]["攻击力"] = JY.Person[6]["攻击力"] + 300
	            JY.Person[6]["轻功"] = JY.Person[6]["轻功"] + 300
	            JY.Person[6]["防御力"] = JY.Person[6]["防御力"] + 300
				JY.Person[6]["生命最大值"] = JY.Person[6]["生命最大值"] + 5000
				JY.Person[6]["生命"] = JY.Person[6]["生命最大值"] + 5000
                JY.Person[6]["内力最大值"] = 10000
	            JY.Person[6]["内力"] = 10000				
				--JY.Person[5]["武功10"] = 181
				--JY.Person[5]["武功等级10"] = 999
                setJX(6)
	            if WarMain(288) == false then
		           instruct_15(0);   
		           instruct_0();  
		           do return; end			
	            end	
				JY.Person[6]["生命最大值"] = JY.Person[6]["生命最大值"] - 5000
				JY.Person[6]["生命"] = JY.Person[6]["生命"] - 5000
	            JY.Person[6]["攻击力"] = JY.Person[6]["攻击力"] - 300
	            JY.Person[6]["轻功"] = JY.Person[6]["轻功"] - 300
	            JY.Person[6]["防御力"] = JY.Person[6]["防御力"]- 300	
		end	
		if GetS(106, 18, 0, 0) ~= 0 and GetS(106, 18, 1, 0) < 1 then
			SetS(106, 18, 1, 0, (GetS(106, 18, 1, 0) + 1))
			SetS(106, 63, 1, 0, 0)
			SetS(106, 63, 2, 0, 603)
			Cls()
			say("少侠，我派可有亏待与你？？？", 603)
			JY.Person[603]["攻击力"] = JY.Person[603]["攻击力"] + 300
			JY.Person[603]["轻功"] = JY.Person[603]["轻功"] + 300
			JY.Person[603]["防御力"] = JY.Person[603]["防御力"] + 300
			JY.Person[603]["生命最大值"] = JY.Person[603]["生命最大值"] + 5000
			JY.Person[603]["生命"] = JY.Person[603]["生命最大值"] + 5000
			JY.Person[603]["内力最大值"] = 10000
			JY.Person[603]["内力"] = 10000				
			--JY.Person[603]["武功10"] = 181
			--JY.Person[603]["武功等级10"] = 999
			setJX(603)
			if WarMain(288) == false then
			   instruct_15(0);   
			   instruct_0();  
			   do return; end			
			end	
			JY.Person[603]["生命最大值"] = JY.Person[603]["生命最大值"] - 5000
			JY.Person[603]["生命"] = JY.Person[603]["生命"] - 5000
			JY.Person[603]["攻击力"] = JY.Person[603]["攻击力"] - 300
			JY.Person[603]["轻功"] = JY.Person[603]["轻功"] - 300
			JY.Person[603]["防御力"] = JY.Person[603]["防御力"]- 300	
		end
		if GetS(106, 19, 0, 0) ~= 0 and GetS(106, 19, 1, 0) < 1 then
			SetS(106, 19, 1, 0, (GetS(106, 19, 1, 0) + 1))
			SetS(106, 63, 1, 0, 0)
			SetS(106, 63, 2, 0, 166)
			Cls()
			say("特来清理门户！", 166)
			JY.Person[166]["攻击力"] = JY.Person[166]["攻击力"] + 300
			JY.Person[166]["轻功"] = JY.Person[166]["轻功"] + 300
			JY.Person[166]["防御力"] = JY.Person[166]["防御力"] + 300
			JY.Person[166]["生命最大值"] = JY.Person[166]["生命最大值"] + 5000
			JY.Person[166]["生命"] = JY.Person[166]["生命最大值"] + 5000
			JY.Person[166]["内力最大值"] = 10000
			JY.Person[166]["内力"] = 10000				
			--JY.Person[166]["武功10"] = 181
			--JY.Person[166]["武功等级10"] = 999
			setJX(166)
			if WarMain(288) == false then
			   instruct_15(0);   
			   instruct_0();  
			   do return; end			
			end	
			JY.Person[166]["生命最大值"] = JY.Person[166]["生命最大值"] - 5000
			JY.Person[166]["生命"] = JY.Person[166]["生命"] - 5000
			JY.Person[166]["攻击力"] = JY.Person[166]["攻击力"] - 300
			JY.Person[166]["轻功"] = JY.Person[166]["轻功"] - 300
			JY.Person[166]["防御力"] = JY.Person[166]["防御力"]- 300	
		end		
	end	
	
    if keypress == VK_ESCAPE then
      MMenu()
      JY.oldSMapX = -1
      JY.oldSMapY = -1
	  elseif keypress == VK_UP then
	    direct = 0
	  elseif keypress == VK_DOWN then
	    direct = 3
	  elseif keypress == VK_LEFT then
	    direct = 2
	  elseif keypress == VK_RIGHT then
	    direct = 1
	  elseif keypress == 9 then
	    do return end
	  end
	  if keypress == 45 then
	    CC.MapSize = limitX(CC.MapSize - 1, 8, math.modf(math.min(CC.ScreenW / 32, CC.ScreenH / 16)))
	  elseif keypress == 61 then
	    CC.MapSize = limitX(CC.MapSize + 1, 8, math.modf(math.min(CC.ScreenW / 32, CC.ScreenH / 16)))
	  elseif keypress == 109 then
	    CC.MapKind = CC.MapKind + 1
	    if CC.MapKind > 2 then
	      CC.MapKind = 0
	    end
	  elseif keypress > 1999999 then
	    local mx = math.modf((keypress - 2000000) / 1000)
	    local my = math.fmod(keypress - 2000000, 1000)

	    mx = mx - CC.ScreenW / 2
	    my = my - CC.ScreenH / 2
	    mx = (mx) / CC.XScale
	    my = (my) / CC.YScale
	    mx, my = (mx + my) / 2, (my - mx) / 2
	    
	    if mx > 0 then
	      mx = mx + 0.99
	    else
	      mx = mx - 0.01
	    end
	    if my > 0 then
	      my = my + 0.99
	    else
	      mx = mx - 0.01
	    end
	    mx = math.modf(mx)
	    my = math.modf(my)
	    
	    for i = 1, 20 do
	      if JY.Base["人X1"] + mx + i <= 63 then
	        if JY.Base["人Y1"] + my + i > 63 then
	          break;
	        end
	      	if math.abs(GetS(JY.SubScene, JY.Base["人X1"] + mx + i, JY.Base["人Y1"] + my + i, 4) - CC.YScale * i * 2) < 8 then
	        	mx = mx + i
	        	my = my + i
	      	end
	     end
	    end
	    if math.abs(mx) + math.abs(my) == 1 then
	      local d_num = GetS(JY.SubScene, JY.Base["人X1"] + (mx), JY.Base["人Y1"] + (my), 3)
	      if d_num >= 0 then
		      EventExecute(d_num, 1)
		      JY.oldSMapX = -1
		      JY.oldSMapY = -1
		      JY.D_Valid = nil
		    end
		    
	    end
	    walkto(mx, my)
	  elseif (keypress == VK_SPACE or keypress == VK_RETURN) and JY.Base["人方向"] >= 0 then
	    local d_num = GetS(JY.SubScene, JY.Base["人X1"] + CC.DirectX[JY.Base["人方向"] + 1], JY.Base["人Y1"] + CC.DirectY[JY.Base["人方向"] + 1], 3)
	  	if d_num >= 0 then
		    EventExecute(d_num, 1)
		    JY.oldSMapX = -1
		    JY.oldSMapY = -1
		    JY.D_Valid = nil
		  end
	  end
	  
	  if keypress == VK_RETURN then
	    keypress = VK_SPACE
	  end
	  
	  NEvent(keypress)
	  FKJGN(keypress)
    end
    if AutoMoveTab[0] ~= 0 then
    if direct == -1 then
      direct = AutoMoveTab[AutoMoveTab[0]]
      AutoMoveTab[AutoMoveTab[0]] = nil
      AutoMoveTab[0] = AutoMoveTab[0] - 1
    end
    else
    AutoMoveTab = {[0] = 0}
    end
    if JY.Status ~= GAME_SMAP then
       return 
    end
  
    if direct ~= -1 then
       AddMyCurrentPic()
       x = JY.Base["人X1"] + CC.DirectX[direct + 1]
       y = JY.Base["人Y1"] + CC.DirectY[direct + 1]
       JY.Base["人方向"] = direct
    else
       x = JY.Base["人X1"]
       y = JY.Base["人Y1"]
    end
    JY.MyPic = GetMyPic()
    DtoSMap()
  
    if direct ~= -1 and (SceneCanPass(x, y) == true) then
       JY.Base["人X1"] = x
       JY.Base["人Y1"] = y
    end
    JY.Base["人X1"] = limitX(JY.Base["人X1"], 1, CC.SWidth - 2)
    JY.Base["人Y1"] = limitX(JY.Base["人Y1"], 1, CC.SHeight - 2)
end
	--产生对话显示需要的字符串，即每隔n个中文字符加一个星号
function GenTalkString(str,n)              --产生对话显示需要的字符串
    local tmpstr="";
    for s in string.gmatch(str .. "*","(.-)%*") do           --去掉对话中的所有*. 字符串尾部加一个星号，避免无法匹配
        tmpstr=tmpstr .. s;
    end

    local newstr="";
    while #tmpstr>0 do
		local w=0;
		while w<#tmpstr do
		    local v=string.byte(tmpstr,w+1);          --当前字符的值
			if v>=128 then
			    w=w+2;
			else
			    w=w+1;
			end
			if w >= 2*n-1 then     --为了避免跨段中文字符
			    break;
			end
		end

        if w<#tmpstr then
		    if w==2*n-1 and string.byte(tmpstr,w+1)<128 then
				newstr=newstr .. string.sub(tmpstr,1,w+1) .. "*";
				tmpstr=string.sub(tmpstr,w+2,-1);
			else
				newstr=newstr .. string.sub(tmpstr,1,w)  .. "*";
				tmpstr=string.sub(tmpstr,w+1,-1);
			end
		else
		    newstr=newstr .. tmpstr;
			break;
		end
	end
    return newstr;
end

--十四本天书之后得到5000两
--修复自动洗四神技的BUG
function NEvent2(keypress)
    if JY.SubScene == 70 and GetD(70, 3, 0) == 0 and instruct_18(151) then
       instruct_3(70, 3, 1, 0, 0, 0, 0, 2610, 2610, 2610, 0, -2, -2)
    end
    if GetD(70, 3, 5) == 2610 and JY.SubScene == 70 and JY.Base[CC.EVB1] == 8 and JY.Base[CC.EVB2] == 41 and JY.Base[CC.EVB3] == 2 and keypress == VK_SPACE then
       say(CC.EVB4)
       instruct_2(174, 5000)
       SetS(10, 0, 17, 0, 1)
       SetD(83, 48, 4, 882)
	
       say(CC.EVB168)
       say(CC.EVB169)
    
       local swg = {109, 110, 111, 112}
    
        local title = "四神技选择";
		local str = string.format("一：%s*二：%s*三：%s*四、%s*放弃：不选择洗四神技*建议主角天罡选择放弃，否则无法出大招",JY.Wugong[109]["名称"],JY.Wugong[110]["名称"],JY.Wugong[111]["名称"],JY.Wugong[112]["名称"]);
		local btn = {"一","二","三","四","放弃"};
		local num = #btn;
		local r = JYMsgBox(title,str,btn,num);
    
    if r >=1 and r <=4 then
	    JY.Person[0]["武功1"] = swg[r]
	    JY.Person[0]["武功等级1"] = 900
	    QZXS(CC.EVB167 .. JY.Wugong[swg[r]]["名称"] .. "』")
	end
    instruct_3(70, 3, 1, 0, 0, 0, 0, 2612, 2612, 2612, 0, -2, -2)
  end
end

--从数据的结构中翻译数据
--data 二进制数组
--offset data中的偏移
--t_struct 数据的结构，在jyconst中有很多定义
--key  访问的key
function GetDataFromStruct(data, offset, t_struct, key)
    local t = t_struct[key]
    local r, high, low, tmp = nil, nil, nil, nil
    if t[2] == 0 then
    r = Byte.get16(data, t[1] + offset)
    if r < 0 then
      r = r + 65536
    end
    r = 65535 - (r)
    high = math.modf((r) / 256)
    low = math.fmod(r, 256)
    r = low * 256 + high
    if r > 32767 then
      r = r - 65536
    end
    elseif t[2] == 1 then
    r = Byte.getu16(data, t[1] + offset)
    r = 65535 - r
    high = math.modf((r) / 256)
    low = math.fmod(r, 256)
    r = low * 256 + high
    elseif t[2] == 2 then
    if CC.SrcCharSet == 0 then
      r = lib.CharSet(Byte.getstr(data, t[1] + offset, t[3]), 0)
    end
    else
    r = Byte.getstr(data, t[1] + offset, t[3])
    end

    if data == JY.Data_Base and type(CC.SBL_Base[t[1] + offset]) == "table" then
    for s = 10, 1, -1 do
      if CC.SBL_Base[t[1] + offset][s] ~= nil then
        tmp = CC.SBL_Base[t[1] + offset][s]
      end
    end
    end

    if data == JY.Data_Person and type(CC.SBL_Person[t[1] + offset]) == "table" then
    for s = HHH_GAME_SETTING["WG_COUNT_MAX"], 1, -1 do
      if CC.SBL_Person[t[1] + offset][s] ~= nil then
        tmp = CC.SBL_Person[t[1] + offset][s]
      end
    end
    end

    if data == JY.Data_Thing and type(CC.SBL_Thing[t[1] + offset]) == "table" then
    for s = 10, 1, -1 do
      if CC.SBL_Thing[t[1] + offset][s] ~= nil then
        tmp = CC.SBL_Thing[t[1] + offset][s]
      end
    end
    end

    if data == JY.Data_Scene and type(CC.SBL_Scene[t[1] + offset]) == "table" then
    for s = 10, 1, -1 do
      if CC.SBL_Scene[t[1] + offset][s] ~= nil then
        tmp = CC.SBL_Scene[t[1] + offset][s]
      end
    end
    end

    if data == JY.Data_Wugong and type(CC.SBL_Wugong[t[1] + offset]) == "table" then
    for s = 10, 1, -1 do
      if CC.SBL_Wugong[t[1] + offset][s] ~= nil then
        tmp = CC.SBL_Wugong[t[1] + offset][s]
      end
    end
    end

    if data == JY.Data_Shop and type(CC.SBL_Shop[t[1] + offset]) == "table" then
    for s = 10, 1, -1 do
      if CC.SBL_Shop[t[1] + offset][s] ~= nil then
        tmp = CC.SBL_Shop[t[1] + offset][s]
      end
    end
    end
    --又是认证
    --if tmp ~= nil and tmp ~= "◎○" .. r .. "★☆" then
    --  JY.Status = x
    --  ZBXS()
    --end
    return r
end--计算主角当前贴图
function GetMyPic()
    local n = nil
    if JY.Status==GAME_MMAP and JY.Base["乘船"]==1 then
		if JY.MyCurrentPic >=4 then
			JY.MyCurrentPic=0
		end
	else
		if JY.MyCurrentPic >6 then
			JY.MyCurrentPic=1
		end
	end
	
    if JY.Base["乘船"] == 0 then
	if JY.Person[0]["性别"] ~= 1 then
		n = CC.MyStartPic + JY.Base["人方向"] * 7 + JY.MyCurrentPic		
	else
		if JY.Status == GAME_MMAP then
			n = 2601 + JY.Base["人方向"] * 7 + JY.MyCurrentPic
		else
			n = 4655 + JY.Base["人方向"] * 7 + JY.MyCurrentPic
		end
	end
    else
    n = CC.BoatStartPic + JY.Base["人方向"] * 4 + JY.MyCurrentPic
    end
    return n
end---gets
function GetS(id, x, y, level)
    if x > 63 or y > 63 then
    lib.Debug(string.format("error:%d,%d,%d,%d", id, x, y, level))
    end
    return lib.GetS(id, x, y, level)
end

function SetS(id, x, y, level, v)
    lib.SetS(id, x, y, level, v)
end

function GetD(Sceneid, id, i)
    return lib.GetD(Sceneid, id, i)
end

function SetD(Sceneid, id, i, v)
    lib.SetD(Sceneid, id, i, v)
end--返回当前队友的数量
function GetTeamNum()
    local r = CC.TeamNum
    for i = 1, CC.TeamNum do
    if JY.Base["队伍" .. i] < 0 then
      r = i - 1
      break;
    end
    end
    return r
end--死亡函数
function hhinstruct_15()
    JY.Status = GAME_DEAD
    Cls()
    --DrawString(CC.GameOverX, CC.GameOverY, JY.Person[0]["姓名"], RGB(0, 0, 0), CC.DefaultFont)
    local x = CC.ScreenW - 9 * CC.DefaultFont
    --DrawString(x, 10, os.date("%Y-%m-%d %H:%M"), RGB(216, 20, 24), CC.DefaultFont)
    --DrawString(x, 10 + CC.DefaultFont + CC.RowPixel, "在地球的某处", RGB(216, 20, 24), CC.DefaultFont)
    --DrawString(x, 10 + (CC.DefaultFont + CC.RowPixel) * 2, "当地人口的失踪数", RGB(216, 20, 24), CC.DefaultFont)
    --DrawString(x, 10 + (CC.DefaultFont + CC.RowPixel) * 3, "又多了一笔。。。", RGB(216, 20, 24), CC.DefaultFont)
    local loadMenu = {
    {"载入进度一", nil, 1}, 
    {"载入进度二", nil, 1}, 
    {"载入进度三", nil, 1}, 
    {"回家睡觉去", nil, 1}}
    local y = CC.ScreenH - 4 * (CC.DefaultFont + CC.RowPixel) - 10
    local r = ShowMenu(loadMenu, 4, 0, x, y, 0, 0, 0, 0, CC.DefaultFont, C_ORANGE, C_WHITE)
    if r < 4 then
    CleanMemory()
	lib.PicInit()--
    SBLDATAL(r)       --重写的读取游戏进度函数
    if YC_Status() == 0 then
		YC_Exit()
    elseif JY.Base["无用"] ~= -1 then
      if JY.SubScene < 0 then
        CleanMemory()
        lib.UnloadMMap()
      end
      lib.PicInit()
      lib.ShowSlow(50, 1)
      JY.Status = GAME_SMAP
      JY.SubScene = JY.Base["无用"]
      JY.MmapMusic = -1
      JY.MyPic = GetMyPic()
      Init_SMap(1)
    else
      JY.SubScene = -1
      JY.Status = GAME_FIRSTMMAP
    end
    else
    JY.Status = GAME_END
    end
end--导入其他模块
function IncludeFile()
    dofile(CONFIG.ScriptPath .. "readkdef.hsk")
    dofile(CONFIG.ScriptPath .. "SAI.lua")
	dofile(CONFIG.ScriptPath .. "MyHelp.lua")
	dofile(CONFIG.ScriptPath .. "/move/move_by_category.lua")
end--初始化主地图
function Init_MMap()
    lib.PicInit()
    lib.LoadMMap(CC.MMapFile[1], CC.MMapFile[2], CC.MMapFile[3], CC.MMapFile[4], CC.MMapFile[5], CC.MWidth, CC.MHeight, JY.Base["人X"], JY.Base["人Y"])
    lib.PicLoadFile(CC.MMAPPicFile[1], CC.MMAPPicFile[2], 0)
    lib.PicLoadFile(CC.HeadPicFile[1], CC.HeadPicFile[2], 1)
    lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55, 110)
    if CC.LoadThingPic == 1 then
       lib.PicLoadFile(CC.WpPic[1], CC.WpPic[2], 2)
    end
    if CONFIG.Zoom == 1 then
	   lib.PicLoadFile(CC.HZPicFile[1], CC.HZPicFile[2], 9)
    else
	   lib.PicLoadFile(CC.HZPicFile[1], CC.HZPicFile[2], 9, 50)
    end
    lib.PicLoadFile(CC.GamePicFile[1], CC.GamePicFile[2], 8)
    JY.EnterSceneXY = nil
    JY.oldMMapX = -1
    JY.oldMMapY = -1
    JY.MAPKJ = 0
    PlayMIDI(JY.MmapMusic)
    AutoMoveTab = {[0] = 0}
end--初始化子场景
--showname  =1 显示场景名 0 不显示
function Init_SMap(showname) --需添加
    lib.PicInit()
    lib.PicLoadFile(CC.SMAPPicFile[1], CC.SMAPPicFile[2], 0)
    lib.PicLoadFile(CC.HeadPicFile[1], CC.HeadPicFile[2], 1)
    lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55, 110)
    if CC.LoadThingPic == 1 then
       lib.PicLoadFile(CC.WpPic[1], CC.WpPic[2], 2)
    end
    if CONFIG.Zoom == 1 then
	   lib.PicLoadFile(CC.HZPicFile[1], CC.HZPicFile[2], 9)
    else
	   lib.PicLoadFile(CC.HZPicFile[1], CC.HZPicFile[2], 9, 50)
    end
    lib.PicLoadFile(CC.GamePicFile[1], CC.GamePicFile[2], 8)
    lib.PicLoadFile(string.format(CC.FightPicFile[1], 0), string.format(CC.FightPicFile[2], 0), 3)
    local mm = math.random(6)
    if mm == 1 then
    JY.Scene[70]["进门音乐"] = 88
    elseif mm == 2 then
    JY.Scene[70]["进门音乐"] = 89
    elseif mm == 3 then
    JY.Scene[70]["进门音乐"] = 90
    elseif mm == 4 then
    JY.Scene[70]["进门音乐"] = 91
    elseif mm == 5 then
    JY.Scene[70]["进门音乐"] = 92
    else
    JY.Scene[70]["进门音乐"] = 93
    end
    JY.Scene[113]["进门音乐"] = 46
    PlayMIDI(JY.Scene[JY.SubScene]["进门音乐"])
    JY.oldSMapX = -1
    JY.oldSMapY = -1
    JY.SubSceneX = 0
    JY.SubSceneY = 0
    JY.OldDPass = -1
    JY.D_Valid = nil
    drawRW() 
    DrawSMap()
    lib.GetKey()
    if showname == 1 then
    DrawStrBox(-1, 10, JY.Scene[JY.SubScene]["名称"], C_WHITE, CC.DefaultFont)
    DrawString(CC.ScreenW/2 - math.modf(#CC.EVB118*25/4), CC.ScreenH - 25 - 10, CC.EVB118, C_GOLD, 25)
    ShowScreen()
    WaitKey()
    Cls()
    ShowScreen()
    end
    AutoMoveTab = {[0] = 0}
end--instruct

function instruct_test(s)
    DrawStrBoxWaitKey(s, C_ORANGE, 24)
end

function instruct_0()
    Cls()
end

function instruct_1(talkid, headid, flag, flag2)
    local s
    if flag2 ~= nil then
	   s = ReadTALK(talkid)
    else
	   s = ReadTalk(talkid)
    end
    if talkid > 4019 then
	   s = ReadTALK(talkid)
    end
    if s == nil then
       return 
    end
    TalkEx(s, headid, flag, "１２３４５６ｍａｒｋ")
    --say(s, headid, flag)
end

function GenTalkIdx()
end

function ReadTalk(talkid)
    local idxfile = CC.TalkIdxFile
    local grpfile = CC.TalkGrpFile
    local length = filelength(idxfile)
    if talkid < 0 and length / 4 <= talkid then
       return 
    end
    local data = (Byte.create(8))
    local id1, id2 = nil, nil
    if talkid == 0 then
    Byte.loadfile(data, idxfile, 0, 4)
    id1 = 0
    id2 = Byte.get32(data, 0)
    else
    Byte.loadfile(data, idxfile, (talkid - 1) * 4, 8)
    id1 = Byte.get32(data, 0)
    id2 = Byte.get32(data, 4)
    end
    local p = io.open(grpfile, "r")
    p:seek("set", id1)
    local talk = p:read("*line")
    p:close()
    return talk
end

function ReadTALK(id)
	local tidx=Byte.create(id*4+4)
	Byte.loadfile(tidx,CC.TDX,0,id*4+4)
	local idx1,idx2
	if id<1 then
		idx1=0
	else
		idx1=Byte.get32(tidx,(id-1)*4)
	end
	idx2=Byte.get32(tidx,id*4)
	local len=idx2-idx1
	local talk=Byte.create(len)
	Byte.loadfile(talk,CC.TRP,idx1,len)
	local str=''
	--str=Byte.getstr(talk,0,len)
	
	for i=0,len-2 do
		local byte=Byte.getu16(talk,i)
		byte=255-math.fmod(byte,256)
		--Byte.setu16(talk,i,byte)
		str=str..string.char(byte)
	end
	str=lib.CharSet(str,0)
	--str=lib.CharSet(Byte.getstr(talk,0,len),0)
	--lib.Debug(string.format('id=%d,idx1=%d,idx2=%d,len=%d,str=%s',id,idx1,idx2,len,str))
	return GenTalkString(str,12)
end

function instruct_11_new()
    Cls()
    return DrawStrBoxYesNo(-1, -1, "是否(Y/N)?", C_ORANGE, CC.DefaultFont)
end

function instruct_45_new(id, value)
    local add, str = AddPersonAttrib(id, "轻功", value)
end

function instruct_46_new(id, value)
    local add, str = AddPersonAttrib(id, "内力最大值", value)
    AddPersonAttrib(id, "内力", 0)
end

function instruct_47_new(id, value)
    local add, str = AddPersonAttrib(id, "攻击力", value)
end

function instruct_48_new(id, value)
    local add, str = AddPersonAttrib(id, "生命最大值", value)
   AddPersonAttrib(id, "生命", 0)
end

--得到物品
function instruct_2(thingid, num)
	if num == nil then num = 1 end
    if JY.Thing[thingid] == nil then
    return 
    end
    --[[武骧金星：喂养宠物的需要
    if (JY.Thing[thingid]["类型"] == 1 or JY.Thing[thingid]["类型"] == 2) and num > 0 then
	if hasthing(thingid) then
		return
	end
    end
    ]]
    if thingid >= 28 and thingid <= 35 then
	   thingid = thingid - 10 --math.random(0, 13) 武骧金星：改成食物和酒
    end  
    instruct_32(thingid, num)
    if num > 0 then
       DrawStrBoxWaitKey(string.format("得到物品:%s %d", JY.Thing[thingid]["名称"], num), C_ORANGE, CC.DefaultFont)
    else
       DrawStrBoxWaitKey(string.format("失去物品:%s %d", JY.Thing[thingid]["名称"], -num), C_ORANGE, CC.DefaultFont)
    end

    if (thingid == 335 or thingid == 336 or thingid == 337) and MPPD(0) == 9 and MPDJ(0) == 1 then
	   say("哇，你居然找到了"..JY.Thing[thingid]["名称"].."，快给我！", 589, 0, "唐萌浅")
	   say("……不要那么小气嘛，师姐会给你奖~~励~~哟。", 589, 0, "唐萌浅")
	   if yesno("要给她吗？") == false then
		  say("切，小气鬼。", 589, 0, "唐萌浅")
	   else
		  instruct_32(thingid, num * -1)
		  say("太好了，看你如此懂事，从今天起，你就是本小姐的专属跟班，以后我会罩着你的，哈哈哈。", 589, 0, "唐萌浅")
		  JoinMP(0, 9, 2)
		  if TMQ(92) then 
			 setJX(92) 
			 JY.Person[578]["攻击力"] = JY.Thing[thingid]["练出武功"]
		  end
		  setJX(93)
	   end	
    end

    if (thingid >= 144 and thingid <= 157) and JY.Thing[202][WZ7] >= 6 and (tianshu() == 2 or tianshu() == 4 or tianshu() == 6 or tianshu() == 8 or tianshu() == 10 or tianshu() == 12 or tianshu() == 14) then
    local a = 1
	local nglist = JY.nglist
	local nglist2 = JY.nglist2
	local qglist = JY.qglist	
  	local function rr(i)
	local aa = 0
	if JY.Thing[203][WZ6] > 0 then 
	   aa = JY.Thing[203][WZ6] 
	   if aa > 30 then 
	      aa = 30 
	   end	  
	end  
	if i ~= 578 then 
		AddPersonAttrib(i, "拳掌功夫", 10+aa*2)
		AddPersonAttrib(i, "御剑能力", 10+aa*2)
		AddPersonAttrib(i, "耍刀技巧", 10+aa*2)
		AddPersonAttrib(i, "特殊兵器", 10+aa*2)
		AddPersonAttrib(i, "暗器技巧", 10+aa*2)
		for j = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do			
			if JY.Person[i]["武功"..j] == 0 then
				local tmpwg = 0
				while PersonKF(i, tmpwg) do
					if math.random(10) == 1 and JY.Person[i]["声望"] > 0 then
						tmpwg = qglist[math.random(#qglist)]
					elseif math.random(30) == 1 then 
						tmpwg = nglist2[math.random(6, #nglist2)]	
					elseif math.random(20) == 1 then 
						tmpwg = nglist2[math.random(1, 5)]		
					else
						tmpwg = nglist[math.random(#nglist)]
					end
					if tmpwg == 121 and JY.Person[i]["性别"] ~= 1 then
						tmpwg = 119
					end
				end
				if tmpwg == 105 and xiaobin(i) then							
					JY.Person[i]["性别"] = 2
				end
				JY.Person[i]["武功"..j] = tmpwg
				JY.Person[i]["武功等级"..j] = 900	
				
				for ii = 0,JY.ThingNum - 1 do
					if JY.Thing[ii]["练出武功"] == tmpwg then
						local level = math.modf((JY.Person[i]["武功等级" ..j])/100) + 1
						if level > 10 then level = 10 end
						AddPersonAttrib(i, "生命最大值", JY.Thing[ii]["加生命最大值"]*3* level)
						AddPersonAttrib(i, "内力最大值", JY.Thing[ii]["加内力最大值"]*3* level)
						AddPersonAttrib(i, "攻击力", JY.Thing[ii]["加攻击力"]*3* level)
						AddPersonAttrib(i, "轻功", JY.Thing[ii]["加轻功"]*3* level)
						AddPersonAttrib(i, "防御力", JY.Thing[ii]["加防御力"]*3* level)	
						AddPersonAttrib(i, "医疗能力", JY.Thing[ii]["加医疗能力"]*3* level)
						AddPersonAttrib(i, "用毒能力", JY.Thing[ii]["加用毒能力"]*3* level)
						AddPersonAttrib(i, "解毒能力", JY.Thing[ii]["加解毒能力"]*3* level)
						AddPersonAttrib(i, "抗毒能力", JY.Thing[ii]["加抗毒能力"]*3* level)
						AddPersonAttrib(i, "拳掌功夫", JY.Thing[ii]["加拳掌功夫"]*3* level)
						AddPersonAttrib(i, "御剑能力", JY.Thing[ii]["加御剑能力"]*3* level)
						AddPersonAttrib(i, "耍刀技巧", JY.Thing[ii]["加耍刀技巧"]*3* level)
						AddPersonAttrib(i, "特殊兵器", JY.Thing[ii]["加特殊兵器"]*3* level)	
						AddPersonAttrib(i, "暗器技巧", JY.Thing[ii]["加暗器技巧"]*3* level)
						break
					end
				end
				JY.Person[i]["生命"] = JY.Person[i]["生命最大值"]
				JY.Person[i]["内力"] = JY.Person[i]["内力最大值"]
				if JY.Person[i]["声望"] == 0 and (JY.Thing[202][WZ7] >= 3 or not xiaobin(i)) then
					JY.Person[i]["声望"] = tmpwg
					if tmpwg == 106 then
						JY.Person[i]["内力性质"] = 1
					elseif tmpwg == 107 then
						JY.Person[i]["内力性质"] = 0							
					elseif tmpwg == 108 then
						JY.Person[i]["内力性质"] = 2
					end
				end
				--[[
				if math.random(30) == 1 and j ~= 10 then 
					JY.Person[i]["武功"..j + 1] = qglist[math.random(#qglist)]
					JY.Person[i]["武功等级"..j + 1] = 900
				end
				--]]
				break
			end
		end	
		for j = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
			if JY.Person[i]["武功"..j] > 0 then
				if JY.Person[i]["武功等级"..j] < 900 then --999 then 武骧金星：小兵的武功不会到极
					JY.Person[i]["武功等级"..j] = 900 --999
				end
				if JY.Person[i]["武功等级"..j] < 999 and (not xiaobin(i)) then
					JY.Person[i]["武功等级"..j] = 999
				end
			end
		end
	end
    end
	for a = 1, JY.PersonNum - 1 do --925 武骧金星：实际上有928个人
		if not duiyou(a) then
			rr(a)
		end	
	end	
    end
  
    if T12YMZ(0) and thingid == 186 and JY.SubScene == 19 then
	   say("天波杨府？那些官老爷居然有枪法传世，倒也有趣呀。")
	   say("…………………………（翻书中）")
	   say("（啥呀，这是哪门子烂枪法，糊弄小孩么？）")
	   say("（不过看这些牛鼻子一个个神情肃穆，好像这本枪谱很有来头的样子，还是别说出来好了^_^）")
    end
  
    if thingid == 88 and JY.SubScene == 28 then
	say("！！！")
	CC.DYRW = 0
	CC.DYRW2 = 615
	if WarMain(341) then 
	    for i = 1,HHH_GAME_SETTING["WG_COUNT_MAX"] do
	       if JY.Person[zj()]["武功"..i] == 151 and GetS(111, 0, 0, 0) == 0 then
	          say("阿弥陀佛，施主身怀我佛门金刚不坏神功，如此便是与我佛有缘，就让贫僧为施主指点一二",615) 
	          instruct_0();
			      if instruct_11(0,188) == true then
	                 QZXS("领悟金刚不坏神功奥妙！")
	                 instruct_0();
	                 say("多谢大师",0) 
	                 SetS(111, 0, 0, 0,151)
				  else
				     say("阿弥陀佛，施主却是有缘无分了",615) 
				  end
				  addthing(256) addthing(257) addthing(258) 
                  do return; end
           end
		end	
		addthing(256) addthing(257) addthing(258) 
	end
	say("？？？？？")
    end
    instruct_2_sub()
end

function instruct_2_sub()
    if JY.Person[0]["声望"] < 200 then
       return 
    end
    if instruct_18(189) == true then
       return 
    end
    local booknum = 0
    for i = 1, CC.BookNum do
    if instruct_18(CC.BookStart + i - 1) == true then
      booknum = booknum + 1
    end
    end
    if booknum == CC.BookNum then
       instruct_3(70, 11, -1, 1, 932, -1, -1, 7968, 7968, 7968, -2, -2, -2)
    end
end

function instruct_3(sceneid, id, v0, v1, v2, v3, v4, v5, v6, v7, v8, v9, v10)
    if sceneid == -2 then
       sceneid = JY.SubScene
    end
    if id == -2 then
       id = JY.CurrentD
    end
    if v0 ~= -2 then
       SetD(sceneid, id, 0, v0)
    end
    if v1 ~= -2 then
       SetD(sceneid, id, 1, v1)
    end
    if v2 ~= -2 then
       SetD(sceneid, id, 2, v2)
    end
    if v3 ~= -2 then
       SetD(sceneid, id, 3, v3)
    end
    if v4 ~= -2 then
       SetD(sceneid, id, 4, v4)
    end
    if v5 ~= -2 then
       SetD(sceneid, id, 5, v5)
    end
    if v6 ~= -2 then
       SetD(sceneid, id, 6, v6)
    end
    if v7 ~= -2 then
       SetD(sceneid, id, 7, v7)
    end
    if v8 ~= -2 then
       SetD(sceneid, id, 8, v8)
    end
    if v9 ~= -2 and v10 ~= -2 and v9 > 0 and v10 > 0 then
       SetS(sceneid, GetD(sceneid, id, 9), GetD(sceneid, id, 10), 3, -1)
       SetD(sceneid, id, 9, v9)
       SetD(sceneid, id, 10, v10)
       SetS(sceneid, GetD(sceneid, id, 9), GetD(sceneid, id, 10), 3, id)
    end
end


function instruct_4(thingid)
    if JY.CurrentThing == thingid then
       return true
    else
       return false
    end
end

function instruct_5()
    return DrawStrBoxYesNo(-1, -1, "是否与之过招(Y/N)?", C_ORANGE, CC.DefaultFont)
end

function instruct_6(warid, tmp, tmp, flag)
    return WarMain(warid, flag)
end

function instruct_7()
    instruct_test("指令7测试")
end

function instruct_8(musicid)
    JY.MmapMusic = musicid
end

function instruct_9()
    Cls()
    return DrawStrBoxYesNo(-1, -1, "是否要求加入(Y/N)?", C_ORANGE, CC.DefaultFont)
end

function instruct_10(personid)
    if JY.Person[personid] == nil then
       lib.Debug("instruct_10 error: person id not exist")
       return 
    end
    local add = 0
    if personid == cxzj() then
        AddPersonAttrib(zj(), "拳掌功夫", JY.Person[personid]["拳掌功夫"])
        AddPersonAttrib(zj(), "御剑能力", JY.Person[personid]["御剑能力"])
        AddPersonAttrib(zj(), "耍刀技巧", JY.Person[personid]["耍刀技巧"])
        AddPersonAttrib(zj(), "特殊兵器", JY.Person[personid]["特殊兵器"])
		AddPersonAttrib(zj(), "暗器技巧", JY.Person[personid]["暗器技巧"])
		for i = 1,HHH_GAME_SETTING["WG_COUNT_MAX"] do 
		if JY.Person[personid]["武功"..i] > 0 then
		   JY.Person[zj()]["武功等级"..i] = 0
		end
        end		
    else
    for i = 2, CC.TeamNum do
    --if GetS(106, 10, 0, 0) ~= 0 and MPPD(personid) == 10 then
	--   say("你居然是叛徒,哼！！",personid)
	--         break;
    --end
    if JY.Base["队伍" .. i] < 0 then
      JY.Base["队伍" .. i] = personid
      add = 1
      break;
    end
    end
    if add == 0 then
       lib.Debug("instruct_10 error: 加入队伍已满")
       return 
    end
    end

	if personid == 59 and JY.Person[personid]["携带物品1"] > 0 then
		instruct_2(328,1)
		if GetS(111, 0, 0, 0) == 0 then
			say("这个给你。",personid)
			if instruct_11(0,188) == true then
				QZXS("领悟玉女心经！")
				instruct_0();
				say("多谢龙姑娘",0) 
				SetS(111, 0, 0, 0,121)
				instruct_35(0,2,121,0)
			else
				say("那好。",personid) 
			end
		end
		if GetS(113, 0, 0, 0) == 0 then
			say("这个也给你。",personid)
			if instruct_11(0,188) == true then
				QZXS("领悟玉女素心剑法！")
				instruct_0();
				say("多谢龙姑娘",0) 
				SetS(113, 0, 0, 0,42)
				--instruct_35(0,2,42,0)
			else
				say("好吧。",personid) 
			end
		end		
	end

    if personid == 53 and JY.Person[personid]["携带物品1"] > 0 and GetS(113, 0, 0, 0) == 0 and JY.Person[0]["品德"] >= 90 then
        say("这是我段家的六脉神剑，少侠不妨也看一看。",personid)
		instruct_0();
		if instruct_11(0,188) == true then 
	        QZXS("领悟六脉精要！")
		    say("多谢段公子！",0)
	        instruct_0();
	        setLW1(49)
		else
		    say("也罢。",53) 
		end	
    end

    if personid == 55 and JY.Person[personid]["携带物品1"] > 0 and GetS(113, 0, 0, 0) == 0 then
        say("这是我跟随哲别师傅学习的草原神箭，少侠不妨也练习一下。",personid)
		instruct_0();
		if instruct_11(0,188) == true then 
	        QZXS("领悟白羽箭法！")
		    say("多谢郭兄弟！",0)
	        instruct_0();
	        setLW1(148)
		else
		    say("也罢。",55) 
		end	
    end
	
    if personid == 38 and JY.Person[personid]["携带物品1"] > 0 and GetS(111, 0, 0, 0) == 0 and PersonKF(0, 61) then
        say("少侠，这是婆婆教我的刀法，你也一同修习吧。",personid)
		if instruct_11(0,188) == true then 
	        QZXS("领悟金乌刀法！")
		    say("多谢石兄弟！",0)
	        instruct_0();
	        setLW1(61)
		else
		    say("好吧。",38) 
		end	
	end		
	
	if personid == 25 and JY.Person[personid]["携带物品1"] > 0 and GetS(113, 0, 0, 0) == 0 then
        say("你帮圣姑，我也应该帮你。可是我武功一般般...",personid)
		say("这样，这本我教秘传鞭法你拿去吧，对我来说这就像...鸡翅？鸡脖子？",personid)
		say("(是鸡肋吧...)",0)
		instruct_0();
		if instruct_11(0,188) == true then 
	        QZXS("领悟黄沙万里鞭！")
		    say("多谢凤凰姑娘了！",0)
			say("嘻嘻～",personid)
	        instruct_0();
	        setLW1(78)
		else
		    say("好吧...那我先去陪圣姑了...",personid) 
		end	
    end
	
	if personid == 636 and JY.Person[personid]["携带物品1"] > 0 and GetS(113, 0, 0, 0) == 0 and JY.Person[0]["武器"] == 305 and sixi(0,3) >= 300 then
        say("小女子再次拜谢少侠宽宏大量。",personid)
		say("没什么，这种恩恩怨怨的事儿本就难办",0)
		say("少侠说的是。(眼睛一瞟)少侠手上这把刀是？",personid)
		say("偶然在一个山洞里捡到的，我看还算锋利就拿着了。袁姑娘对此刀有兴趣？",0)
		say("是，少侠可否借我一观？",personid)
		say("当然可以",0)
		say("嗯...这个柄的设计方式...嘿！",personid)
		say("袁姑娘...咦？",0)
		say("哈哈，果然是我知道的那种机关。藏得这么隐秘，看来是好东西。",personid)
		say("若少侠不嫌弃，小女子就借花献佛，将此物给与少侠了",personid)
		instruct_0();
		if instruct_11(0,188) == true then 
	        QZXS("领悟八卦刀法！")
		    say("这竟是现今流传的八卦刀残篇的补全！多谢袁姑娘！",0)
			say("少侠客气了。",personid)
	        instruct_0();
	        setLW1(138)
		else
		    say("既然如此，我就之后寻个时机卖了此物，充作接下来的盘缠吧。",personid) 
		end	
    end
	
	if personid == 161 and JY.Person[personid]["携带物品1"] > 0 and GetS(113, 0, 0, 0) == 0 and sixi(0,5) >= 200 and JY.Person[0]["用毒能力"] >= 250 then
        say("......",personid)
		say("李道长还是心情抑郁么？",0)
		say("苦了这么些年，说是不再留恋，又岂是朝夕之间就可放下？",personid)
		say("没、没关系的，接下来李道长可跟著我，去找天书，就当好好散心了！",0)
		say("呵呵...(淡淡一笑)",personid)
		say("(她笑了，她笑了！)",0)
		say("无事献殷勤...说吧，你想做什么？",personid)
		say("我...我...(眼睛咕噜一传)，我想学李道长的武功！",0)
		say("嗯？也罢，我这条命也是靠你捡回来的。",personid)
		say("你暗器、毒道都不错，我教你冰魄银针吧",personid)
		instruct_0();
		if instruct_11(0,188) == true then 
	        QZXS("领悟冰魄银针！")
		    say("哈哈哈，我学会了，莫愁姐姐！",0)
			say("你...唤我什么？",personid)
			say("我...(鼓起勇气)我想唤你莫愁姐姐，可以么？",0)
			say("...随你吧。(偏过头，语气淡淡，耳根儿却已红了)",personid)
	        instruct_0();
	        setLW1(170)
		else
		    say("李道长，对不起...",0)
			say("也罢，看来这门武功与你无缘。那你想学别的么？",personid)
			say("我...(鼓起勇气)我想提别的请求！",0)
			say("说吧(他做甚这般激动？)",personid)
			say("我想唤你莫愁姐姐，可以么？",0)
			say("...随你吧。(偏过头，语气淡淡，耳根儿却已红了)",personid)
		end	
    end
	
	if personid == 11 and JY.Person[personid]["携带物品1"] > 0 and GetS(114,0,0,0) == 0 then
		say("嗯？这本轻功是？",0)
		say("啊那是本教秘传的轻功",personid)
		say("抄本放在总坛",personid)
		say("正本则一向由光明左右使保管。",personid)
		say("少侠对我有大恩，要想翻阅也无不可",personid)
		if DrawStrBoxYesNo(-1, -1, "要现在翻翻看吗？？", C_WHITE, 30) == true then
			SetS(106, 63, 1, 0, 0)
			SetS(106, 63, 2, 0, 558)
			if WarMain(288) == false then
				instruct_13()  --场景变亮
				say("刚刚那是什么！？",0)
				say("嗯？刚才并无何事发生",personid)
				say("无，无事就好。（幻觉？）",0)	
			else
				QZXS("领悟暗影迷踪！")
				instruct_0();
				SetS(114, 0, 0, 0, 194)
				say("熊熊圣火、焚我残躯...",558)
				say("前辈？前辈！",0)
				say("少侠在呼唤谁？这里没有什么前辈",personid)
				say("...没，没事，杨左使别在意",0)
			end
		end
	end	
    for i = 1, 4 do
    local id = JY.Person[personid]["携带物品" .. i]
    local n = JY.Person[personid]["携带物品数量" .. i]
    if n < 0 then
      n = 0
    end
    if id >= 0 and n > 0 then
      if personid ~= 929 then 
		instruct_2(id, n)
		end	
      JY.Person[personid]["携带物品" .. i] = -1
      JY.Person[personid]["携带物品数量" .. i] = 0
    end
    end
end

function instruct_11()
    Cls()
    return DrawStrBoxYesNo(-1, -1, "是否住宿(Y/N)?", C_ORANGE, CC.DefaultFont)
end

function instruct_12(flag)
    for i = 1, CC.TeamNum do
    local id = JY.Base["队伍" .. i]
    if id >= 0 then
      JY.Person[id]["受伤程度"] = 0
      if id == 0 and putong() == 8 then
		JY.Person[id]["中毒程度"] = 100 
	  else
		JY.Person[id]["中毒程度"] = 0 
	  end
      AddPersonAttrib(id, "体力", math.huge)
      AddPersonAttrib(id, "生命", math.huge)
      AddPersonAttrib(id, "内力", math.huge)
    end
    end
    --[[ 武骧金星：避免时间过得太快
    if JY.TL >= 75 and JY.TL < 100 then
	   addtime2(1)
    elseif JY.TL >= 50 then
	   addtime2(2)
    elseif JY.TL >= 25 then
	   addtime2(3)
    else
	   addtime2(4)
    end
    ]]
    JY.TL = 100
end

function instruct_13()
    Cls()
    JY.Darkness = 0
    lib.ShowSlow(25, 0)
    lib.GetKey()
end

function instruct_14()
    lib.ShowSlow(25, 1)
    JY.Darkness = 1
end

function instruct_15()
    JY.Status = GAME_DEAD
    Cls()
    --DrawString(CC.GameOverX, CC.GameOverY, JY.Person[0]["姓名"], RGB(0, 0, 0), CC.DefaultFont)
    local x = CC.ScreenW - 9 * CC.DefaultFont
    --DrawString(x, 10, os.date("%Y-%m-%d %H:%M"), RGB(216, 20, 24), CC.DefaultFont)
    --DrawString(x, 10 + CC.DefaultFont + CC.RowPixel, "在地球的某处", RGB(216, 20, 24), CC.DefaultFont)
    --DrawString(x, 10 + (CC.DefaultFont + CC.RowPixel) * 2, "当地人口的失踪数", RGB(216, 20, 24), CC.DefaultFont)
    --DrawString(x, 10 + (CC.DefaultFont + CC.RowPixel) * 3, "又多了一笔。。。", RGB(216, 20, 24), CC.DefaultFont)
    local loadMenu = {
    {"载入进度一", nil, 1}, 
    {"载入进度二", nil, 1}, 
    {"载入进度三", nil, 1}, 
    {"回家睡觉去", nil, 1}}
    local y = CC.ScreenH - 4 * (CC.DefaultFont + CC.RowPixel) - 10
    local r = ShowMenu(loadMenu, 4, 0, x, y, 0, 0, 0, 0, CC.DefaultFont, C_ORANGE, C_WHITE)
    if r < 4 then
    SBLDATAL(r)
    if YC_Status() == 0 then
		YC_Exit()
    elseif JY.Base["无用"] ~= -1 then
      JY.Status = GAME_SMAP
      JY.SubScene = JY.Base["无用"]
      JY.MmapMusic = -1
      JY.MyPic = GetMyPic()
      Init_SMap(1)
    else
      JY.SubScene = -1
      JY.Status = GAME_FIRSTMMAP
    end
    ShowScreen()
    --lib.LoadPicture("", 0, 0)
    lib.GetKey()
    Game_Cycle()
    else
    JY.Status = GAME_END
    end
end


function inteam(pid)
	if WAR.ZDDH == 20 and JY.SubScene == 25 and CC.fight == 1 then
		if CC.npc == 1 then
			return false
		else
			for a = 0, WAR.PersonNum - 1 do 
				local aa = WAR.Person[a]["人物编号"]
				if aa == pid then
					if WAR.Person[a]["我方"] then						
						return true
					else
						return false
					end
				end
			end
		end
	end
	if WAR.ZDDH == 342 then
		if duiyou(pid) and JY.Person[pid]["等级"] >= 30 then
			return true
		end
	end
	--if juexing() >= 1 and ZJ(pid) and zjtype() == 3 then	--武骧金星：这样会导致觉醒后畅想人物武功无法到极
	--	return false
	--end
    return instruct_16(pid)
end

function instruct_16(personid)
	--优化集气卡顿 通过key查找避免使用循环 start 20200427
	if JY.Status == GAME_WMAP and JY.MyTeamData ~= nil then
		if JY.MyTeamData[personid] == personid or personid == cxzj() then
			return true
		else
			return false
		end
	end
	--优化集气卡顿  通过key查找避免使用循环 end 20200427

    local r = false
    for i = 1, CC.TeamNum do
    if personid == JY.Base["队伍" .. i] then
      r = true
      break;
    end 
    end
	if personid == cxzj() then 
	 r = true
	end
    return r
end

function instruct_17(sceneid, level, x, y, v)
    if sceneid == -2 then
       sceneid = JY.SubScene
    end
    SetS(sceneid, x, y, level, v)
end

function instruct_18(thingid)
    for i = 1, CC.MyThingNum do
    if JY.Base["物品" .. i] == thingid then
      return true
    end
    end
    return false
end

function instruct_19(x, y)
    JY.Base["人X1"] = x
    JY.Base["人Y1"] = y
    JY.SubSceneX = 0
    JY.SubSceneY = 0
end

function instruct_20()
    if JY.Base["队伍" .. CC.TeamNum] >= 0 then
       return true
    end
    return false
end

function instruct_21(personid) --离队
    if JY.Person[personid] == nil then
       lib.Debug("instruct_21 error: personid not exist")
       return 
    end
    local j = 0
    for i = 1, CC.TeamNum do
    if personid == JY.Base["队伍" .. i] then
       j = i
    end
    end
    if j == 0 then
       return 
    end
    for i = j + 1, CC.TeamNum do
       JY.Base["队伍" .. i - 1] = JY.Base["队伍" .. i]
    end
    JY.Base["队伍" .. CC.TeamNum] = -1
    --武骧金星：修正由于百家穷衣和倚天照海带来的各种问题
    --if JY.Person[personid]["武器"] >= 0 then
    --  JY.Thing[JY.Person[personid]["武器"]]["使用人"] = -1
    --  JY.Person[personid]["武器"] = -1
    --end
    --if JY.Person[personid]["防具"] >= 0 then
    --  JY.Thing[JY.Person[personid]["防具"]]["使用人"] = -1
    --  JY.Person[personid]["防具"] = -1
    --end
    --if JY.Person[personid]["修炼物品"] >= 0 then
    --  JY.Thing[JY.Person[personid]["修炼物品"]]["使用人"] = -1
    --  JY.Person[personid]["修炼物品"] = -1
    --end
    --JY.Person[personid]["物品修炼点数"] = 0
    --clearHZ(personid)
end

function instruct_22()
    for i = 1, CC.TeamNum do
    if JY.Base["队伍" .. i] >= 0 then
      JY.Person[JY.Base["队伍" .. i]]["内力"] = 0
    end
    end
end

function instruct_23(personid, value)
    JY.Person[personid]["用毒能力"] = value
    AddPersonAttrib(personid, "用毒能力", 0)
end

function instruct_24()
    instruct_test("指令24测试")
end

function instruct_25(x1, y1, x2, y2)
    local sign = nil
    if y1 ~= y2 then
    if y2 < y1 then
      sign = -1
    else
      sign = 1
    end
    for i = y1 + sign, y2, sign do
      local t1 = lib.GetTime()
      JY.SubSceneY = JY.SubSceneY + sign
      DrawSMap()
      ShowScreen()
      local t2 = lib.GetTime()
      if t2 - t1 < CC.SceneMoveFrame then
        lib.Delay(CC.SceneMoveFrame - (t2 - t1))
      end
    end
    end
    if x1 ~= x2 then
    if x2 < x1 then
      sign = -1
    else
      sign = 1
    end
    for i = x1 + sign, x2, sign do
      local t1 = lib.GetTime()
      JY.SubSceneX = JY.SubSceneX + sign
      DrawSMap()
      ShowScreen()
      local t2 = lib.GetTime()
      if t2 - t1 < CC.SceneMoveFrame then
        lib.Delay(CC.SceneMoveFrame - (t2 - t1))
      end
    end
    end
end

function instruct_26(sceneid, id, v1, v2, v3)
    if sceneid == -2 then
       sceneid = JY.SubScene
    end
    local v = GetD(sceneid, id, 2)
    SetD(sceneid, id, 2, v + v1)
    v = GetD(sceneid, id, 3)
    SetD(sceneid, id, 3, v + v2)
    v = GetD(sceneid, id, 4)
    SetD(sceneid, id, 4, v + v3)
end

function instruct_27(id, startpic, endpic)
    local old1, old2, old3 = nil
    if id ~= -1 then
       old1 = GetD(JY.SubScene, id, 5)
       old2 = GetD(JY.SubScene, id, 6)
       old3 = GetD(JY.SubScene, id, 7)
    end
    for i = startpic, endpic, 2 do
    local t1 = lib.GetTime()
    if id == -1 then
      JY.MyPic = i / 2
    else
      SetD(JY.SubScene, id, 5, i)
      SetD(JY.SubScene, id, 6, i)
      SetD(JY.SubScene, id, 7, i)
    end
    DtoSMap()
    DrawSMap()
    ShowScreen()
    local t2 = lib.GetTime()
    if t2 - t1 < CC.AnimationFrame then
      lib.Delay(CC.AnimationFrame - (t2 - t1))
    end
    end
    if id ~= -1 then
       SetD(JY.SubScene, id, 5, old1)
       SetD(JY.SubScene, id, 6, old2)
       SetD(JY.SubScene, id, 7, old3)
    end
end

function instruct_28(personid, vmin, vmax)
    local v = JY.Person[personid]["品德"]
    if vmin <= v and v <= vmax then
       return true
    else
       return false
    end
end

function instruct_29(personid, vmin, vmax)
    local v = JY.Person[personid]["攻击力"]
    if vmin <= v and v <= vmax then
       return true
    else
       return false
    end
end

function instruct_30(x1, y1, x2, y2)
    if x1 < x2 then
    for i = x1 + 1, x2 do
      local t1 = lib.GetTime()
      instruct_30_sub1(1)
      local t2 = lib.GetTime()
      if t2 - t1 < CC.PersonMoveFrame then
        lib.Delay(CC.PersonMoveFrame - (t2 - t1))
      end
    end
    elseif x2 < x1 then
    for i = x2 + 1, x1 do
      local t1 = lib.GetTime()
      instruct_30_sub1(2)
      local t2 = lib.GetTime()
      if t2 - t1 < CC.PersonMoveFrame then
        lib.Delay(CC.PersonMoveFrame - (t2 - t1))
      end
    end
    end
    if y1 < y2 then
    for i = y1 + 1, y2 do
      local t1 = lib.GetTime()
      instruct_30_sub1(3)
      local t2 = lib.GetTime()
      if t2 - t1 < CC.PersonMoveFrame then
        lib.Delay(CC.PersonMoveFrame - (t2 - t1))
      end
    end
    elseif y2 < y1 then
    for i = y2 + 1, y1 do
      local t1 = lib.GetTime()
      instruct_30_sub1(0)
      local t2 = lib.GetTime()
      if t2 - t1 < CC.PersonMoveFrame then
        lib.Delay(CC.PersonMoveFrame - (t2 - t1))
      end
    end
    end
end

function instruct_30_sub1(direct)
    local x, y = nil, nil
    AddMyCurrentPic()
    x = JY.Base["人X1"] + CC.DirectX[direct + 1]
    y = JY.Base["人Y1"] + CC.DirectY[direct + 1]
    JY.Base["人方向"] = direct
    JY.MyPic = GetMyPic()
    DtoSMap()
    if SceneCanPass(x, y) == true then
       JY.Base["人X1"] = x
       JY.Base["人Y1"] = y
    end
    JY.Base["人X1"] = limitX(JY.Base["人X1"], 1, CC.SWidth - 2)
    JY.Base["人Y1"] = limitX(JY.Base["人Y1"], 1, CC.SHeight - 2)
    DrawSMap()
    ShowScreen()
    return 1
end

function instruct_30_sub(direct)
    local x, y = nil, nil
    local d_pass = GetS(JY.SubScene, JY.Base["人X1"], JY.Base["人Y1"], 3)

    if d_pass >= 0 and d_pass ~= JY.OldDPass then
       EventExecute(d_pass, 3)
       JY.OldDPass = d_pass
       JY.oldSMapX = -1
       JY.oldSMapY = -1
       JY.D_Valid = nil
    end

    JY.OldDPass = -1
    local isout = 0
    if (((JY.Scene[JY.SubScene]["出口X1"] == JY.Base["人X1"] and JY.Scene[JY.SubScene]["出口Y1"] == JY.Base["人Y1"]) or JY.Scene[JY.SubScene]["出口X2"] ~= JY.Base["人X1"] or JY.Scene[JY.SubScene]["出口Y2"] == JY.Base["人Y1"] or JY.Scene[JY.SubScene]["出口X3"] == JY.Base["人X1"] and JY.Scene[JY.SubScene]["出口Y3"] == JY.Base["人Y1"])) then
       isout = 1
    end
    if isout == 1 then
       JY.Status = GAME_MMAP
       CleanMemory()
	   lib.PicInit()--
       lib.ShowSlow(50, 1)
    if JY.MmapMusic < 0 then
      JY.MmapMusic = JY.Scene[JY.SubScene]["出门音乐"]
    end
    Init_MMap()
    JY.SubScene = -1
    JY.oldSMapX = -1
    JY.oldSMapY = -1
    lib.DrawMMap(JY.Base["人X"], JY.Base["人Y"], GetMyPic())
    lib.ShowSlow(50, 0)
    lib.GetKey()
    return 
    end
    if JY.Scene[JY.SubScene]["跳转场景"] >= 0 and JY.Base["人X1"] == JY.Scene[JY.SubScene]["跳转口X1"] and JY.Base["人Y1"] == JY.Scene[JY.SubScene]["跳转口Y1"] then
    JY.SubScene = JY.Scene[JY.SubScene]["跳转场景"]
    lib.ShowSlow(50, 1)
    if JY.Scene[JY.SubScene]["外景入口X1"] == 0 and JY.Scene[JY.SubScene]["外景入口Y1"] == 0 then
      JY.Base["人X1"] = JY.Scene[JY.SubScene]["入口X"]
      JY.Base["人Y1"] = JY.Scene[JY.SubScene]["入口Y"]
    else
      JY.Base["人X1"] = JY.Scene[JY.SubScene]["跳转口X2"]
      JY.Base["人Y1"] = JY.Scene[JY.SubScene]["跳转口Y2"]
    end
    Init_SMap(1)
    return 
    end
    AddMyCurrentPic()
    x = JY.Base["人X1"] + CC.DirectX[direct + 1]
    y = JY.Base["人Y1"] + CC.DirectY[direct + 1]
    JY.Base["人方向"] = direct
    JY.MyPic = GetMyPic()
    DtoSMap()
    if SceneCanPass(x, y) == true then
       JY.Base["人X1"] = x
       JY.Base["人Y1"] = y
    end
    JY.Base["人X1"] = limitX(JY.Base["人X1"], 1, CC.SWidth - 2)
    JY.Base["人Y1"] = limitX(JY.Base["人Y1"], 1, CC.SHeight - 2)
    DrawSMap()
    ShowScreen()
    return 1
end

function instruct_31(num)
    local r = false
    for i = 1, CC.MyThingNum do
    if JY.Base["物品" .. i] == CC.MoneyID and num <= JY.Base["物品数量" .. i] then
      r = true
    end
    end
    return r
end

function instruct_32(thingid, num)
    local p = 1
    if num == nil then num = 1 end
    --[[武骧金星：喂养宠物的需要
    if (JY.Thing[thingid]["类型"] == 1 or JY.Thing[thingid]["类型"] == 2) and num > 0 then
	if hasthing(thingid) then
		return
	end
    end
    ]]  
    if thingid >= 28 and thingid <= 35 then
	thingid = thingid - 10 --math.random(0, 13) 武骧金星：改成食物和酒
    end

    for i = 1, CC.MyThingNum do
    if JY.Base["物品" .. i] == thingid then     
	  if thingid == 174 and (JY.Base["物品数量" .. i] + num) > 32000 then		
		JY.Base["物品数量" .. i] = 32000
	  else
		JY.Base["物品数量" .. i] = JY.Base["物品数量" .. i] + num
	  end
      p = i
      break;
    elseif JY.Base["物品" .. i] == -1 then
      JY.Base["物品" .. i] = thingid    
	  if thingid == 174 and num > 32000 then
		JY.Base["物品数量" .. i] = 32000
	  else
		JY.Base["物品数量" .. i] = num
	  end	  
      p = i
      break;
    end
    end
    if thingid == 174 then
       JY.GOLD = limitX(JY.GOLD + num, 0, 32000)
    end
    if thingid == 155 and num == 1 then
       instruct_32(219, -1)
    end
  
    if thingid >= 144 and thingid <= 157 and num == 1 and T3XYK(zj()) then
	   AddPersonAttrib(zj(), "武学常识", 10)
    end
  
    if JY.Base["物品数量" .. p] <= 0 then
    for i = p + 1, CC.MyThingNum do
      JY.Base["物品" .. i - 1] = JY.Base["物品" .. i]
      JY.Base["物品数量" .. i - 1] = JY.Base["物品数量" .. i]
    end
    JY.Base["物品" .. CC.MyThingNum] = -1
    JY.Base["物品数量" .. CC.MyThingNum] = 0
    end
end

--人物学会武功
function instruct_33(personid, wugongid, flag)
    local add = 0
    for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
    if JY.Person[personid]["武功" .. i] == wugongid then
	       JY.Person[personid]["武功等级" .. i] = 0
		   add = 1
	break;
	end
    if JY.Person[personid]["武功" .. i] == 0 then
           JY.Person[personid]["武功" .. i] = wugongid
           JY.Person[personid]["武功等级" .. i] = 0
           add = 1  
      break;
    end
    end
    if add == 0 then
       JY.Person[personid]["武功10"] = wugongid
       JY.Person[personid]["武功等级10"] = 0
    end
    if flag == 0 then
       DrawStrBoxWaitKey(string.format("%s 学会武功 %s", JY.Person[personid]["姓名"], JY.Wugong[wugongid]["名称"]), C_ORANGE, CC.DefaultFont)
    end
end

function instruct_34(id, value)
    local add, str = AddPersonAttrib(id, "资质", value)
    DrawStrBoxWaitKey(JY.Person[id]["姓名"] .. str, C_ORANGE, CC.DefaultFont)
end


function instruct_35(personid, id, wugongid, wugonglevel)
	if personid == 0 then
		personid = zj()
	end
	local flag = 0
    if id >= 0 then
    for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
    if JY.Person[personid]["武功" .. i] == wugongid then
    JY.Person[personid]["武功等级" .. i] = wugonglevel 
	    if cxzj() == personid then 
		   if JY.Person[0]["武功" .. i] == wugongid then
		      JY.Person[0]["武功等级" .. i] = wugonglevel
		   else
		   JY.Person[0]["武功" .. id + 1] = wugongid
	       JY.Person[0]["武功等级" .. id + 1] = wugonglevel
		   end 
		end   
	flag = 1
	return
	end
	if JY.Person[personid]["武功" .. i] == 0 then
	JY.Person[personid]["武功" .. id + 1] = wugongid
	JY.Person[personid]["武功等级" .. id + 1] = wugonglevel 
	    if cxzj() == personid then 
		   if JY.Person[0]["武功" .. i] == wugongid then
		      JY.Person[0]["武功等级" .. i] = wugonglevel
		   else
		   JY.Person[0]["武功" .. id + 1] = wugongid
	       JY.Person[0]["武功等级" .. id + 1] = wugonglevel
		   end 
		end 
	flag = 1
	return
	end
	end
    end
    if flag == 0 then
	    for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
    	JY.Person[personid]["武功" .. id + 1] = wugongid
    	JY.Person[personid]["武功等级" .. id + 1] = wugonglevel
	    if cxzj() == personid then 
		   if JY.Person[0]["武功" .. i] == wugongid then
		      JY.Person[0]["武功等级" .. i] = wugonglevel
		   else
		   JY.Person[0]["武功" .. id + 1] = wugongid
	       JY.Person[0]["武功等级" .. id + 1] = wugonglevel
		   end 
		end 
		return
		end
  	end 
end

function instruct_36(sex)
    if JY.Person[0]["性别"] == sex then
       return true
    else
       return false
    end
end

function instruct_37(v)
    AddPersonAttrib(0, "品德", v)
end

function instruct_38(sceneid, level, oldpic, newpic)
    if sceneid == -2 then
       sceneid = JY.SubScene
    end
    for i = 0, CC.SWidth - 1 do
      for j = 1, CC.SHeight - 1 do
      if GetS(sceneid, i, j, level) == oldpic then
        SetS(sceneid, i, j, level, newpic)
      end
    end
    end
end

function instruct_39(sceneid)
    JY.Scene[sceneid]["进入条件"] = 0
end

function instruct_40(v)
    JY.Base["人方向"] = v
    JY.MyPic = GetMyPic()
end

function instruct_41(personid, thingid, num)
    local k = 0
    for i = 1, 4 do
    if JY.Person[personid]["携带物品" .. i] == thingid then
      JY.Person[personid]["携带物品数量" .. i] = JY.Person[personid]["携带物品数量" .. i] + num
      k = i
      break;
    end
    end
    if k > 0 and JY.Person[personid]["携带物品数量" .. k] <= 0 then
      JY.Person[personid]["携带物品" .. k] = -1
    end
    if k == 0 then
    for i = 1, 4 do
      if JY.Person[personid]["携带物品" .. i] == -1 then
        JY.Person[personid]["携带物品" .. i] = thingid
        JY.Person[personid]["携带物品数量" .. i] = num
        break;
      end
    end
    end
end

function instruct_42()
    local r = false
    for i = 1, CC.TeamNum do
    if JY.Base["队伍" .. i] >= 0 and JY.Person[JY.Base["队伍" .. i]]["性别"] == 1 then
      r = true
    end
    end
    return r
end

function instruct_43(thingid)
    return instruct_18(thingid)
end

function instruct_44(id1, startpic1, endpic1, id2, startpic2, endpic2)
    local old1 = GetD(JY.SubScene, id1, 5)
    local old2 = GetD(JY.SubScene, id1, 6)
    local old3 = GetD(JY.SubScene, id1, 7)
    local old4 = GetD(JY.SubScene, id2, 5)
    local old5 = GetD(JY.SubScene, id2, 6)
    local old6 = GetD(JY.SubScene, id2, 7)
    for i = startpic1, endpic1, 2 do
    local t1 = lib.GetTime()
    if id1 == -1 then
      JY.MyPic = i / 2
    else
      SetD(JY.SubScene, id1, 5, i)
      SetD(JY.SubScene, id1, 6, i)
      SetD(JY.SubScene, id1, 7, i)
    end
    if id2 == -1 then
      JY.MyPic = i / 2
    else
      SetD(JY.SubScene, id2, 5, i - startpic1 + startpic2)
      SetD(JY.SubScene, id2, 6, i - startpic1 + startpic2)
      SetD(JY.SubScene, id2, 7, i - startpic1 + startpic2)
    end
    DtoSMap()
    DrawSMap()
    ShowScreen()
    local t2 = lib.GetTime()
    if t2 - t1 < CC.AnimationFrame then
      lib.Delay(CC.AnimationFrame - (t2 - t1))
    end
    end
    SetD(JY.SubScene, id1, 5, old1)
    SetD(JY.SubScene, id1, 6, old2)
    SetD(JY.SubScene, id1, 7, old3)
    SetD(JY.SubScene, id2, 5, old4)
    SetD(JY.SubScene, id2, 6, old5)
    SetD(JY.SubScene, id2, 7, old6)
end

function instruct_45(id, value)
    local add, str = AddPersonAttrib(id, "轻功", value)
    DrawStrBoxWaitKey(JY.Person[id]["姓名"] .. str, C_ORANGE, CC.DefaultFont)
end

function instruct_46(id, value)
    local add, str = AddPersonAttrib(id, "内力最大值", value)
    AddPersonAttrib(id, "内力", 0)
    DrawStrBoxWaitKey(JY.Person[id]["姓名"] .. str, C_ORANGE, CC.DefaultFont)
end

function instruct_47(id, value)
    local add, str = AddPersonAttrib(id, "攻击力", value)
    DrawStrBoxWaitKey(JY.Person[id]["姓名"] .. str, C_ORANGE, CC.DefaultFont)
end

function instruct_48(id, value)
    local add, str = AddPersonAttrib(id, "生命最大值", value)
    AddPersonAttrib(id, "生命", 0)
    if instruct_16(id) == true then
       DrawStrBoxWaitKey(JY.Person[id]["姓名"] .. str, C_ORANGE, CC.DefaultFont)
    end
end

function instruct_49(personid, value)
    JY.Person[personid]["内力性质"] = value
end

function instruct_50(id1, id2, id3, id4, id5)
    local num = 0
    if instruct_18(id1) == true then
       num = num + 1
    end
    if instruct_18(id2) == true then
       num = num + 1
    end
    if instruct_18(id3) == true then
       num = num + 1
    end
    if instruct_18(id4) == true then
       num = num + 1
    end
    if instruct_18(id5) == true then
       num = num + 1
    end
    if num == 5 then
       return true
    else
       return false
    end
end

function instruct_51()
    instruct_1(2547 + Rnd(18), 114, 0)
end

function instruct_52()
    DrawStrBoxWaitKey(string.format("你现在的品德指数为: %d", JY.Person[0]["品德"]), C_ORANGE, CC.DefaultFont)
end

function instruct_53()
    DrawStrBoxWaitKey(string.format("你现在的声望指数为: %d", JY.Person[0]["声望"]), C_ORANGE, CC.DefaultFont)
end

function instruct_54()
    for i = 0, JY.SceneNum - 1 do
      JY.Scene[i]["进入条件"] = 0
    end
    JY.Scene[2]["进入条件"] = 2
    JY.Scene[38]["进入条件"] = 2
    JY.Scene[75]["进入条件"] = 1
    JY.Scene[80]["进入条件"] = 1
end

function instruct_55(id, num)
    if GetD(JY.SubScene, id, 2) == num then
       return true
    else
       return false
    end
end

function instruct_56(v)
    JY.Person[0]["声望"] = JY.Person[0]["声望"] + v
    instruct_2_sub()
end

function instruct_57()
    instruct_27(-1, 7664, 7674)
    for i = 0, 56, 2 do
    local t1 = lib.GetTime()
    if JY.MyPic < 3844 then
      JY.MyPic = (7676 + i) / 2
    end
    SetD(JY.SubScene, 2, 5, i + 7690)
    SetD(JY.SubScene, 2, 6, i + 7690)
    SetD(JY.SubScene, 2, 7, i + 7690)
    SetD(JY.SubScene, 3, 5, i + 7748)
    SetD(JY.SubScene, 3, 6, i + 7748)
    SetD(JY.SubScene, 3, 7, i + 7748)
    SetD(JY.SubScene, 4, 5, i + 7806)
    SetD(JY.SubScene, 4, 6, i + 7806)
    SetD(JY.SubScene, 4, 7, i + 7806)
    DtoSMap()
    DrawSMap()
    ShowScreen()
    local t2 = lib.GetTime()
    if t2 - t1 < CC.AnimationFrame then
      lib.Delay(CC.AnimationFrame - (t2 - t1))
    end
    end
end

function instruct_58()
    local group = 5
    local num1 = 6
    local num2 = 3
    local startwar = 102
    local flag = {}
    for i = 0, group - 1 do
    for j = 0, num1 - 1 do
      flag[j] = 0
    end
    for j = 1, num2 do
      local r = nil
      while 1 do
        r = Rnd(num1)
        if flag[r] == 0 then
          flag[r] = 1
          do break end
        end
      end
      local warnum = r + i * num1
      WarLoad(warnum + startwar)
      instruct_1(2854 + warnum, JY.Person[WAR.Data["敌人1"]]["头像代号"], 0)
      instruct_0()
      if WarMain(warnum + startwar, 0) == true then
        instruct_0()
        instruct_13()
        TalkEx("还有那位前辈肯赐教？", 0, 1)
        instruct_0()
      else
        instruct_15()
        return 
      end
    end
    if i < group - 1 then
      TalkEx("少侠已连战三场，*可先休息再战．", 70, 0)
      instruct_0()
      instruct_14()
      lib.Delay(300)
      if JY.Person[0]["受伤程度"] < 50 and JY.Person[0]["中毒程度"] <= 0 then
        JY.Person[0]["受伤程度"] = 0
        AddPersonAttrib(0, "体力", math.huge)
        AddPersonAttrib(0, "内力", math.huge)
        AddPersonAttrib(0, "生命", math.huge)
      end
      instruct_13()
      TalkEx("我已经休息够了，*有谁要再上？", 0, 1)
      instruct_0()
    end
    end
    TalkEx("接下来换谁？**．．．．*．．．．***没有人了吗？", 0, 1)
    instruct_0()
    TalkEx("如果还没有人要出来向这位*少侠挑战，那麽这武功天下*第一之名，武林盟主之位，*就由这位少侠夺得．***．．．．．．*．．．．．．*．．．．．．*好，恭喜少侠，这武林盟主*之位就由少侠获得，而这把*”武林神杖”也由你保管．", 70, 0)
    instruct_0()
    TalkEx("恭喜少侠！", 12, 0)
    instruct_0()
    TalkEx("小兄弟，恭喜你！", 64, 4)
    instruct_0()
    TalkEx("好，今年的武林大会到此已*圆满结束，希望明年各位武*林同道能再到我华山一游．", 19, 0)
    instruct_0()
    instruct_14()
    for i = 24, 72 do
    instruct_3(-2, i, 0, 0, -1, -1, -1, -1, -1, -1, -2, -2, -2)
    end
    instruct_0()
    instruct_13()
    TalkEx("历经千辛万苦，我终於打败*群雄，得到这武林盟主之位*及神杖．*但是”圣堂”在那呢？*为什麽没人告诉我，难道大*家都不知道．*这会儿又有的找了．", 0, 1)
    instruct_0()
    instruct_2(143, 1)
end

function instruct_59()
    for i = CC.TeamNum, 2, -1 do
    if JY.Base["队伍" .. i] >= 0 then
      instruct_21(JY.Base["队伍" .. i])
    end
    end
    for i,v in ipairs(CC.AllPersonExit) do
    instruct_3(v[1], v[2], 0, 0, -1, -1, -1, -1, -1, -1, 0, -2, -2)
    end
end

function instruct_60(sceneid, id, num)
    if sceneid == -2 then
       sceneid = JY.SubScene
    end
    if id == -2 then
       id = JY.CurrentD
    end
    if GetD(sceneid, id, 5) == num then
       return true
    else
       return false
    end
end

function checkpic(sceneid, id, num)
	return instruct_60(sceneid, id, num)
end

function addpic(sceneid, id, num)
	if sceneid == -2 then
		sceneid = JY.SubScene
	end
	if id == -2 then
		id = JY.CurrentD
	end
	SetD(sceneid, id, 5, num)
end

function instruct_61()
    for i = 11, 24 do
    if GetD(JY.SubScene, i, 5) ~= 4664 then
       return false
    end
    end
    return true
end

function instruct_62(id1, startnum1, endnum1, id2, startnum2, endnum2)
    JY.MyPic = -1
    instruct_44(id1, startnum1, endnum1, id2, startnum2, endnum2)
    ShowScreen()
    lib.Delay(2000)
    say(CC.s56, 280, 5, CC.s57)
    lib.LoadSMap(CC.S_Filename[0], CC.TempS_Filename, JY.SceneNum, CC.SWidth, CC.SHeight, CC.D_Filename[0], CC.DNum, 11)
    if GetS(100, 10, 10, 4) <= JY.Thing[202][WZ7] then
       SetS(100, 10, 10, 4, JY.Thing[202][WZ7] + 1)
    end
    if GetS(100, 10, 10, 4) > 3 then
       SetS(100, 10, 10, 4, 3)
    end
    SetS(100, 10, 10, 5, GZMYZM[GetS(100, 10, 10, 4)])
    lib.SaveSMap(CC.S_Filename[0], CC.D_Filename[0])
    PlayMIDI(60)
    Cls()
    lib.FillColor(0, 0, CC.ScreenW, CC.ScreenH, C_BLACK)
    ShowScreen()
    lib.Delay(1000)
    DrawStrBox(-1, -1, CC.EVB120, C_WHITE, 30)
    ShowScreen()
    WaitKey()
    ClsN()
    DrawStrBox(-1, -1, CC.EVB121, C_WHITE, 30)
    ShowScreen()
    WaitKey()
    JY.Status = xx
end

function instruct_63(personid, sex)
    JY.Person[personid]["性别"] = sex
end

function instruct_64() --商店
    local headid = 223
    local ts = 0
    local id = -1
    for i = 0, JY.ShopNum - 1 do
    if CC.ShopScene[i].sceneid == JY.SubScene then
      id = i
    end
    end
    if id < 0 then
       return 
    end
    TalkEx("这位小哥，看看有什麽需要*的，小店卖的东西价钱绝*对公道．", headid, 0, "商人")
    local menu = {}
    for i = 1, 5 do
    menu[i] = {}
    local thingid = JY.Shop[id]["物品" .. i]
    menu[i][1] = string.format("%-12s %5d", JY.Thing[thingid]["名称"], limitX(math.modf(JY.Thing[thingid]["价钱"] * 1.5), 0, 32000))
    menu[i][2] = nil
    if JY.Shop[id]["物品数量" .. i] > 0 then
      menu[i][3] = 1
    else
      menu[i][3] = 0
    end
    end
    for i = 1, 200 do
    if JY.Base["物品" .. i] > 143 and JY.Base["物品" .. i] < 158 then
      ts = ts + 1
    end
    end
    if ts < 5 and id == 0 then --混元改成5本书
       menu[5][3] = 0
    end
    if ts < 7 and id == 4 then --狮子吼改成7本书
       menu[5][3] = 0
    end
    local x1 = (CC.ScreenW - 9 * CC.DefaultFont - 2 * CC.MenuBorderPixel) / 2
    local y1 = (CC.ScreenH - 5 * CC.DefaultFont - 4 * CC.RowPixel - 2 * CC.MenuBorderPixel) / 2
    local r = ShowMenu(menu, 5, 0, x1, y1, 0, 0, 1, 1, CC.DefaultFont, C_ORANGE, C_WHITE)
    local itemJC = {}
    itemJC[0] = {8, 12, 28, 14, 68, 400, 100, 80, 500, 6000}
    itemJC[1] = {8, 0, 29, 15, 90, 400, 100, 100, 500, 1000}
    itemJC[2] = {8, 3, 32, 16, 159, 400, 100, 100, 600, 600}
    itemJC[3] = {63, 7, 33, 17, 175, 400, 200, 120, 600, 800}
    itemJC[4] = {27, 9, 34, 22, 69, 2000, 50, 130, 400, 8000}
    if r > 0 then
    --[[if JY.Shop[id]["物品" .. r] ~= itemJC[id][r] then
      xx = xx
    end
    if JY.Shop[id]["物品价格" .. r] ~= itemJC[id][r + 5] then
      xx = xx
    end]]
	local thingid = JY.Shop[id]["物品" .. r]
	local dj = 1
	if JY.Shop[id]["物品数量" .. r] > 1 then
		TalkEx("客官您要买多少？", headid, 0, "商人")
		local T = {}
		for a = 1, 1000 do
			local b = "" .. a
			T[b] = a
		end
		dj = -1
		while dj == -1 do
			local r = GetPinyin1(32, CC.ScreenH - CC.Fontbig * 6)
			if T[r] ~= nil and T[r] >= 1 and T[r] <= 999 then
				dj = T[r]
			else
				DrawStrBoxWaitKey("输入错误 范围1-999 请重新输入", C_WHITE, 30)
			end
		end	
	end
    if instruct_31(limitX(math.modf(JY.Thing[thingid]["价钱"] * 1.5 * dj), 0, 32000)) == false then
		TalkEx("非常抱歉，*你身上的钱似乎不够．", headid, 0, "商人")
    else
	    if JY.Shop[id]["物品数量" .. r] == 1 then JY.Shop[id]["物品数量" .. r] = JY.Shop[id]["物品数量" .. r] - 1 end
	    instruct_32(CC.MoneyID, -limitX(math.modf(JY.Thing[thingid]["价钱"] * 1.5 * dj), 0, 32000))
	    instruct_32(JY.Shop[id]["物品" .. r], dj)
	    TalkEx("大爷买了小店的东西，*保证绝不後悔．", headid, 0, "商人")
		if thingid==68 and GetS(111,0,0,0) == 0 then
			TalkEx("小店这里还有附带的注解就赠送与你了", headid, 0, "商人")
			if DrawStrBoxYesNo(-1, -1, "要不要呢？", C_WHITE, 30) == true then
				QZXS("领悟混元一气！")
				setLW(90)
			end
		end
    end
    end
    for i,v in ipairs(CC.ShopScene[id].d_leave) do
        instruct_3(-2, v, 0, -2, -1, -1, 939, -1, -1, -1, -2, -2, -2)
    end
end

function instruct_65()
    local id = -1
    for i = 0, JY.ShopNum - 1 do
    if CC.ShopScene[i].sceneid == JY.SubScene then
      id = i
    end
    end
    if id < 0 then
       return 
    end
    instruct_3(-2, CC.ShopScene[id].d_shop, 0, -2, -1, -1, -1, -1, -1, -1, -2, -2, -2)
    for i,v in ipairs(CC.ShopScene[id].d_leave) do
      instruct_3(-2, v, 0, -2, -1, -1, -1, -1, -1, -1, -2, -2, -2)
    end
    local newid = id + 1
    if newid >= 5 then
       newid = 0
    end
    instruct_3(CC.ShopScene[newid].sceneid, CC.ShopScene[newid].d_shop, 1, -2, 938, -1, -1, 8256, 8256, 8256, -2, -2, -2)
end

function instruct_66(id)
    PlayMIDI(id)
end

function instruct_67(id)
    PlayWavAtk(id)
end

--绘画动态集气条
function DrawTimeBar2()
    local x1, x2, y = CC.ScreenW * 5 / 8, CC.ScreenW * 15 / 16, CC.FontSmall * 5
    local draw = false
    local surid = lib.SaveSur(x1 - (10 + (x2 - x1) / 2), 0, x2 + 5 + 30, y * 2 + 18 + 25)
  
    while true do
  	draw = false
	  for i = 0, WAR.PersonNum - 1 do
	  	local pid = WAR.Person[i]["人物编号"];
	    if WAR.Person[i]["死亡"] == false then
	    	if WAR.Person[i].TimeAdd < 0 then
		      draw = true
		      WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd + 20
		      if WAR.Person[i].TimeAdd > 0 then
		      	WAR.Person[i].TimeAdd = 0;
		      end
		      if WAR.Person[i].Time > -500 then
		        WAR.Person[i].Time = WAR.Person[i].Time - 20
			  else
				  if wglw(pid,101) or (DT(pid,117) and PersonKF(pid,101)) then --唯我独尊--17-2-27
				     WAR.WWDZ[WAR.Person[i]["人物编号"]] = 1 
				  end	 
			      if (wglw2(pid,118) or DT(pid,60) or DT(pid,620) or DT(pid,617) or DT(pid,666)) and PersonKF(pid,118) then --瞬息千里领悟
				     local jl = 20
					 local aa = math.modf(JY.Person[pid]["受伤程度"] / 5)
					 jl = jl + aa
					 if jl > 100 then jl = 100 end
					 if WAR.Person[i].Time < - 200 and JLSD(10,jl,pid) then 
				        WAR.WWDZ[WAR.Person[i]["人物编号"]] = 1 
					 end
				  end
				  if PersonGT(pid, 100) then			--先天功主功体，当集气被杀到-500，内伤直接清0
			      	JY.Person[pid]["受伤程度"] = 0;
			      elseif JY.Person[pid]["受伤程度"] < 100 then
			        if inteam(pid) then
			        	AddPersonAttrib(pid, "受伤程度", Rnd(4) + 1)		--我方被减集气时受到的内伤
			        else
			        	AddPersonAttrib(pid, "受伤程度", Rnd(3) + 1)		--敌方内伤
			        end     
			      end
			   end
				  if wglw(pid,101) or (DT(pid,117) and PersonKF(pid,101)) then --唯我独尊--17-2-27
				     if WAR.Person[i].Time < - 250 then 
				        WAR.WWDZ[WAR.Person[i]["人物编号"]] = 1 
					 end
				  end
				  if wglw2(pid,118) or DT(pid,617) or DT(pid,666) then --瞬息千里领悟
				     local jl = 10
					 local aa = math.modf(JY.Person[pid]["受伤程度"] / 5)
					 jl = jl + aa
					 if jl > 100 then jl = 100 end
					 if WAR.Person[i].Time < - 200 and JLSD(0,jl,pid)then 
				        WAR.WWDZ[WAR.Person[i]["人物编号"]] = 1 
					 end
				  end
				  if DT(pid,48) and JX(pid,48) and WAR.ICE[pid] ~= nil and WAR.ICE[pid] >= 50 then --唯我独尊--17-2-27
				     if WAR.Person[i].Time < - 200 and JLSD(10,30,pid)then 
				        WAR.ICE[WAR.Person[i]["人物编号"]] = WAR.ICE[WAR.Person[i]["人物编号"]] - 50
						WAR.Person[i].Time = 0
					 end
				  end
                  if wglw(pid,184) and PersonGT(pid,184) or DT(pid,665) then --瑜伽密乘
				     if WAR.Person[i].Time < - 200 then 
				        WAR.YJSG[WAR.Person[i]["人物编号"]] = 1 
					 end
				  end			
				
                  if NF(pid) and juexing() > 2 then
					 if WAR.Person[i].Time < - 250 then
						WAR.FZZS[WAR.Person[i]["人物编号"]] = 1
					 end
				  end				
				
	if wglw(pid,178) or (DT(pid,69) and PersonKF(pid,178)) or T9ZY(pid) or DT(pid,602)then --九龙功
	   if WAR.Defup[pid] == 1 and WAR.Person[i].Time < 500 then
	      WAR.Person[i].Time = 500
	   elseif WAR.Person[i].Time < 250 then 
	      WAR.Person[i].Time = 250
	   end  
	end
            
			    if wglw(pid,182) or (DT(pid,5) and PersonGT(pid,182)) then 
	                if WAR.Defup[pid] == 1 and WAR.Person[i].Time < 400 then
	                    WAR.Person[i].Time = 400
	                elseif WAR.Person[i].Time < 200 then 
	                    WAR.Person[i].Time = 200
	                end  
	            end	          
			
			  --蓝烟清：增加被打中反加集气绘画
			  elseif WAR.Person[i].TimeAdd > 0 then
			  	draw = true
			  	WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd - 20
			  	WAR.Person[i].Time = WAR.Person[i].Time + 20
			  	if WAR.Person[i].Time > 995 then
			  		WAR.Person[i].Time = 995;
			  	end
			  end
		  end
	 	end
	 	
	 	if draw then
	    lib.LoadSur(surid, x1 - (10 + (x2 - x1) / 2), 0)
	    DrawTimeBar_sub(x1, x2, y, 1)
	    ShowScreen()
	    lib.Delay(8)
	  else
	  	break;
  	end
    end
	lib.Delay(100)
	lib.FreeSur(surid)
end

--绘制集气条
function DrawTimeBar()
	
    local x1, x2, y = CC.ScreenW * 5 / 8, CC.ScreenW * 15 / 16, CC.FontSmall * 5
    local xunhuan = true
    local surid = lib.SaveSur(x1 - (10 + (x2 - x1) / 2), 0, x2 + 10 + 20 + 30, y * 2 + 18 + 25)
    local xscal = limitX(WAR.Delay / 20, 1, 10)
    local delay = WAR.Delay / xscal
    local flag = 0;
    while xunhuan do
		lib.LoadSur(surid, x1 - (10 + (x2 - x1) / 2), 0)
		for i = 0, WAR.PersonNum - 1 do
			local jqid = WAR.Person[i]["人物编号"]
			if WAR.JTWW == 1 and not jtyl(jqid) then
			else
				if WAR.Person[i]["死亡"] == false then
					--以下是集气速度的处理
					if not jtyl(jqid) then 
						if WAR.YJZD[jqid] ~= nil then --以静制动
							WAR.YJZD[jqid] = WAR.YJZD[jqid] - 1
							if WAR.YJZD[jqid] <= 0 then
								WAR.YJZD[jqid] = nil
								WAR.YJZDPD[jqid] = 1
								WAR.Person[i].Time = 1005
							end			
						elseif WAR.SH[jqid] ~= nil then --锁喉
							WAR.SH[jqid] = WAR.SH[jqid] - 1	
							if WAR.SH[jqid] <= 0 then
								WAR.SH[jqid] = nil
							end
						elseif WAR.SH1[jqid] ~= nil then
							WAR.SH1[jqid] = WAR.SH1[jqid] - 1
							if JLSD(10,35,jqid) then
								WAR.Person[i].Time = WAR.Person[i].Time + 35
							end
							if WAR.SH1[jqid] <= 0 then
								WAR.SH1[jqid] = nil
							end			
						elseif WAR.HBZQ1[jqid] ~= nil then --1-10-寒冰真气
							WAR.HBZQ1[jqid] = WAR.HBZQ1[jqid] - 1
							if WAR.HBZQ1[jqid] <= 0 then
								WAR.HBZQ1[jqid] = nil
							end			
						elseif WAR.JG[jqid] ~= nil then --金刚不坏
							WAR.JG[jqid] = WAR.JG[jqid] - 1
							if WAR.JG[jqid] <= 0 then
								WAR.JG[jqid] = nil
							end	
						elseif WAR.YJMC[jqid] ~= nil then --瑜伽密乘
							WAR.YJMC[jqid] = WAR.YJMC[jqid] - 1
							if WAR.YJMC[jqid] <= 0 then
								WAR.YJMC[jqid] = nil
							end		
						elseif WAR.SZWH[jqid] ~= nil and not nospeeddelay(jqid) then
						elseif WAR.QJBMS[jqid] ~= nil and not nospeeddelay(jqid) then
						elseif WAR.FXDS[WAR.Person[i]["人物编号"]] ~= nil and WAR.FXDS[WAR.Person[i]["人物编号"]] > 0 then
							--封穴的处理
							WAR.FXDS[jqid] = WAR.FXDS[jqid] - 1
							if WAR.FXDS[jqid] > 50 then --17-2-12--
							   WAR.FXDS[jqid] = 50 
							end 
							if PersonKF(jqid, 108) then --易筋解穴
								WAR.FXDS[jqid] = WAR.FXDS[jqid] - 1
							end

							if PersonGT(jqid, 108) then --易筋主功体解穴加倍
								WAR.FXDS[jqid] = WAR.FXDS[jqid] - 1
							end

							if PersonGT(jqid, 107) then --九阴主功体时序解穴
								WAR.FXDS[jqid] = WAR.FXDS[jqid] - 1
							end
							--brolycjw: 九阳9时序解除封穴
							if PersonGT(jqid, 106) then
								if WAR.JYFX[jqid] == nil then
									WAR.JYFX[jqid] = 1;
								elseif WAR.JYFX[jqid] < 9 then
									WAR.JYFX[jqid] = WAR.JYFX[jqid] + 1;
								else
									WAR.JYFX[jqid] = nil;
									WAR.FXDS[jqid] = 0;
								end
							end
					
							--武当九阳功
							if PersonKF(jqid, 185) then
								if WAR.JYFX[jqid] == nil then
									WAR.JYFX[jqid] = 1;
								elseif WAR.JYFX[jqid] < 20 then
									WAR.JYFX[jqid] = WAR.JYFX[jqid] + 1;
								else
									WAR.JYFX[jqid] = nil;
									WAR.FXDS[jqid] = 0;
								end
								if PersonGT(jqid, 185) then
									if WAR.JYFX[jqid] == nil then
										WAR.JYFX[jqid] = 1;
									elseif WAR.JYFX[jqid] < 10 then
										WAR.JYFX[jqid] = WAR.JYFX[jqid] + 1;
									else
										WAR.JYFX[jqid] = nil;
										WAR.FXDS[jqid] = 0;
									end	
								end
							end			
					
							--金丝背心时序解穴2点
							if JY.Person[jqid]["防具"] == 60 then						
								WAR.FXDS[jqid] = WAR.FXDS[jqid] - 10
							end
							
							if WAR.LQZ[jqid] == 100 then
								WAR.FXDS[jqid] = WAR.FXDS[jqid] - 1
							end
							if hasTF(jqid, 134) or WAR.KHZJ[jqid] ~= nil or WAR.JYHT[jqid] ~= nil then--17-2-8
								WAR.FXDS[jqid] = 0
							end	
							if T2SQ(jqid) and juexing() > 1 then
								WAR.FXDS[jqid] = 0
							end
							if NF(jqid) and juexing() > 2 then
								WAR.FXDS[jqid] = 0
							end
							if jtyl(jqid) then --谢无悠
								WAR.FXDS[jqid] = 0
							end	
							if wglw(jqid,104) and DT(jqid,602) then
								WAR.FXDS[jqid] = 0
							end				
							if WAR.FXDS[jqid] < 1 then
								WAR.FXDS[jqid] = nil
							end
						elseif WAR.FXDS[WAR.Person[i]["人物编号"]] == nil or nospeeddelay(WAR.Person[i]["人物编号"]) then     	
							--以下是所有并不直接暴力使集气调停下来的情形
							if WAR.MENG[jqid] ~= nil then --回魂仙梦集气
								local aa = math.modf(WAR.Person[i].TimeAdd * 0.5) + 1
								local jq = math.random(aa)
								if wglw2(jqid,193) and PersonKF(jqid,193) then
									jq = math.modf(jq*math.random(3,5))
								end	
								WAR.Person[i].Time = WAR.Person[i].Time + jq          
								WAR.JQSDXS[WAR.Person[i]["人物编号"]] = jq 
							elseif WAR.XSZW[jqid] ~= nil then --谢无悠
								   WAR.XSZW[jqid] = WAR.XSZW[jqid] -1
									if WAR.XSZW[jqid] <= 0 then
									   WAR.XSZW[jqid] = nil
									end
									if jtyl(jqid) then 
									   WAR.XSZW[jqid] = nil
									end
								WAR.Person[i].Time = WAR.Person[i].Time + math.random(-WAR.Person[i].TimeAdd,WAR.Person[i].TimeAdd)--math.random(WAR.Person[i].Time - math.modf(WAR.Person[i].TimeAdd*2),WAR.Person[i].Time + WAR.Person[i].TimeAdd)
								if WAR.Person[i].Time <= -500 then 
								   WAR.Person[i].Time = -500
								end
								WAR.JQSDXS[WAR.Person[i]["人物编号"]] =  WAR.Person[i].TimeAdd
								if WAR.LQZ[jqid] == 100 then
									WAR.JQSDXS[WAR.Person[i]["人物编号"]] =  WAR.Person[i].TimeAdd*2
								end	
							elseif WAR.bhbm[4000 + jqid] ~= nil then --八荒
									WAR.bhbm[4000 + jqid] = WAR.bhbm[4000 + jqid] -1
									if WAR.bhbm[4000 + jqid] <= 0 then
									   WAR.bhbm[4000 + jqid] = nil
									end
									if wglw2(jqid,193) and PersonKF(jqid,193) then
										WAR.Person[i].Time = WAR.Person[i].Time + math.random(WAR.Person[i].TimeAdd,(WAR.Person[i].TimeAdd*2))
									else	
										WAR.Person[i].Time = WAR.Person[i].Time + math.random(-WAR.Person[i].TimeAdd,WAR.Person[i].TimeAdd)--math.random(WAR.Person[i].Time - math.modf(WAR.Person[i].TimeAdd*2),WAR.Person[i].Time + WAR.Person[i].TimeAdd)
									end
									if WAR.Person[i].Time <= -500 then 
									   WAR.Person[i].Time = -500
									end
									WAR.JQSDXS[WAR.Person[i]["人物编号"]] =  WAR.Person[i].TimeAdd
									if WAR.LQZ[jqid] == 100 then
										WAR.JQSDXS[WAR.Person[i]["人物编号"]] =  WAR.Person[i].TimeAdd*2
									end				
							elseif WAR.LHFM[jqid] ~= nil and WAR.KLJZ ~= 2  then --罗汉伏魔
								local jq1 = WAR.Person[i].TimeAdd
								local jq2 = WAR.Person[i].TimeAdd
								local jq3 = WAR.Person[i].TimeAdd
								local x = 0
								--jq1 = WAR.Person[i].TimeAdd
								if WAR.CHZ[jqid] ~= nil and WAR.CHZ[jqid] > 0 then 
								   if wglw(jqid,178) or (DT(jqid,69) and PersonKF(jqid,178)) or T9ZY(jqid) or DT(jqid,602) then --九龙功
								   jq1 = math.modf(WAR.Person[i].TimeAdd*2)
								   else
								   jq1 = math.modf(WAR.Person[i].TimeAdd/2)
								   end
								end
								if WAR.CHZ[jqid] ~= nil and WAR.CHZ[jqid] > 0 then 
								   if wglw(jqid,182) or (DT(jqid,5) and PersonGT(jqid,182)) then 
								   jq1 = math.modf(WAR.Person[i].TimeAdd*2)
								   else
								   jq1 = math.modf(WAR.Person[i].TimeAdd/2)
								   end
								end
								jq2 = jq1
								jq3 = jq1
								if WAR.Person[i].TimeAdd > 0 and jq3 < 5 then 
								   jq3 = 5 
								end
								if putong() == 2 and jqid == 0 then 
									local jsyx = wgnumber(0, 2)
									jq3 = jq3+5 * (jsyx)
								end		 
								if MPPD(jqid) == 11 and MPDJ(jqid) > 2 then 
									if putong() == 2 and jqid == 0 then 
										local jsyx = wgnumber(0, 2)
										jq3 = WAR.YDSD[jqid]+5 * (jsyx)
									else 
										jq3 = WAR.YDSD[jqid]
									end
								end
								if DT(jqid, 617) then 
								   jq3 = 120
								end   
								if jq3 > 120 then 
								   jq3 = 120 
								end   
								if WAR.LQZ[jqid] == 100 then
									if jq3<=120 then
										jq3 = 240 - jq3
									else

									end
								else
									if jq3<=50 then
										jq3 = 120 - jq3
									else

									end
								end
								
								WAR.Person[i].Time = WAR.Person[i].Time - jq3
							
								if WAR.LQZ[jqid] == 100 then
								  WAR.Person[i].Time = WAR.Person[i].Time - jq3
								end
								if WAR.Person[i].Time <= -500 then 
								   WAR.Person[i].Time = -500
								end 
								WAR.JQSDXS[WAR.Person[i]["人物编号"]] = -jq3
							elseif jqid == 0 and WAR.BHCS[jqid] == 1 then --魔音・碧海潮生12.26
								local jq = 0
								for j = 0, WAR.PersonNum - 1 do
								if WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] then
								   jq = math.random(math.floor(WAR.Person[j].TimeAdd/2),WAR.Person[j].TimeAdd)
								end
								if WAR.Person[j]["我方"] == WAR.Person[i]["我方"] then
								   jq = math.random(WAR.Person[j].TimeAdd,math.floor(WAR.Person[j].TimeAdd*1.5))
								end	
								WAR.Person[j].Time = WAR.Person[j].Time + jq 
								WAR.JQSDXS[WAR.Person[j]["人物编号"]] =  jq
								end
							elseif WAR.CYSH[jqid] ~= nil then --豸苗：李秋水
									local jq = 0
									if JY.Person[jqid]["内力"] >= 8000 then
									   jq = math.random(math.floor(WAR.Person[i].TimeAdd * 0.5),WAR.Person[i].TimeAdd)
									elseif JY.Person[jqid]["内力"] >= 6000 and JY.Person[jqid]["内力"] < 8000 then
									   jq = math.random(math.floor(WAR.Person[i].TimeAdd * 0.6),WAR.Person[i].TimeAdd)
									elseif JY.Person[jqid]["内力"] >= 4000 and JY.Person[jqid]["内力"] < 6000 then  
									   jq = math.random(math.floor(WAR.Person[i].TimeAdd * 0.7),WAR.Person[i].TimeAdd)
									elseif JY.Person[jqid]["内力"] >= 2000 and JY.Person[jqid]["内力"] < 4000 then 
									   jq = math.random(math.floor(WAR.Person[i].TimeAdd * 0.8),WAR.Person[i].TimeAdd)					
									elseif JY.Person[jqid]["内力"] >= 0 and JY.Person[jqid]["内力"] < 2000 then  
									   jq = math.random(math.floor(WAR.Person[i].TimeAdd * 0.9),WAR.Person[i].TimeAdd)
									end				
									WAR.Person[i].Time = WAR.Person[i].Time + jq 
									WAR.JQSDXS[WAR.Person[i]["人物编号"]] = jq						
							elseif PersonKF(jqid, 104) == false and (WAR.HOT[jqid] or 0) < 20 then --如果没学逆运，正常集气
								local jq1 = WAR.Person[i].TimeAdd
								local jq2 = WAR.Person[i].TimeAdd
								local jq3 = WAR.Person[i].TimeAdd
								local x = 0
								--jq1 = WAR.Person[i].TimeAdd
								if WAR.CHZ[jqid] ~= nil and WAR.CHZ[jqid] > 0 then 
								   if wglw(jqid,178) or wglw(jqid,182) or (DT(jqid,5) and PersonGT(jqid,182)) or (DT(jqid,69) and PersonKF(jqid,178)) or T9ZY(jqid) or DT(jqid,602) then --九龙功
										jq1 = math.modf(WAR.Person[i].TimeAdd*2)
								   elseif PersonKF(jqid,143) and MPPD(jqid) == 5 and MPDJ(jqid) >= 2 then
										if WAR.CHZ[jqid] > 30 then
											jq1 = math.modf(WAR.Person[i].TimeAdd*1.5)
										elseif WAR.CHZ[jqid] <= 30 then
											jq1 = WAR.Person[i].TimeAdd
										end
								   else
										jq1 = math.modf(WAR.Person[i].TimeAdd/2)
								   end
								end
								jq2 = jq1
								jq3 = jq1
								if WAR.ICE[jqid] ~= nil then
									x = 0
								end	
								if wglw(jqid,178) or (DT(jqid,69) and PersonKF(jqid,178)) or T9ZY(jqid) or DT(jqid,602) then --九龙功
									jq3 = jq2 + x
								elseif wglw1(jqid,176) or (DT(jqid,49) and PersonKF(jqid,176)) or DT(jqid,117) or DT(jqid,618) then --生死符
									jq3 = jq2 + x
								end
								if wglw(jqid,182) or (DT(jqid,5) and PersonGT(jqid,182)) then 
									jq3 = jq2 + x
								end
								if WAR.Person[i].TimeAdd > 0 and jq3 < 5 then 
								   jq3 = 5 
								end
								if putong() == 2 and jqid == 0 then 
									 local jsyx = wgnumber(0, 2)
									 jq3 = jq3+5 * (jsyx)
								end		 
								if MPPD(jqid) == 11 and MPDJ(jqid) > 2 then 
									 if putong() == 2 and jqid == 0 then 
										 local jsyx = wgnumber(0, 2)
										 jq3 = WAR.YDSD[jqid]+5 * (jsyx)
									 else 
										jq3 = WAR.YDSD[jqid]
									 end
								end
								if MPPD(jqid) == 8 and PersonKF(jqid, 118) and math.random(10) >= 5 then
									WAR.Person[i].Time = WAR.Person[i].Time + (25*MPDJ(jqid))+25
									jq3 = jq3 + 10
								end	
								if wglw(jqid,189) and WAR.YSJS[jqid] ~=nil and WAR.YSJS[jqid] > 0 and math.random(10) >= 5 then
									WAR.Person[i].Time = WAR.Person[i].Time + 250
									jq3 = jq3 + 20
								end	
								if DT(jqid, 617) then 
								   jq3 = 100
								end   
								if (jqid == 0 and GetS(114,0,0,0) > 0) or DT(jqid,667) then
									jq3 = jq3 + 25
									if jq3 < 30 and wglw2(jqid,193) then
										jq3 = 30
									end	
									if jq3 > 120 and not wglw2(jqid,190) then 
										jq3 = 120
									end
								else   
									if jq3 > 100 then 
										jq3 = 100 
									end
								end   
								if WAR.LQZ[jqid] ~= nil and WAR.LQZ[jqid] == 100 then
									if wglw(jqid,178) or wglw(jqid,182) or wglw1(jqid,48) or (DT(jqid,5) and PersonGT(jqid,182)) or (DT(jqid,69) and PersonKF(jqid,178)) or T9ZY(jqid) or DT(jqid,602) then
										jq3 = jq3 * 3
									else
										jq3 = jq3 * 2
									end
								end	
								WAR.Person[i].Time = WAR.Person[i].Time + jq3
								WAR.JQSDXS[WAR.Person[i]["人物编号"]] = jq3	
							elseif PersonKF(jqid, 104) and PersonKF(jqid, 107) and (WAR.HOT[jqid] or 0) < 20 then --如果没学逆运，正常集气
								local jq1 = WAR.Person[i].TimeAdd
								local jq2 = WAR.Person[i].TimeAdd
								local jq3 = WAR.Person[i].TimeAdd
								local x = 0
								--jq1 = WAR.Person[i].TimeAdd
								if WAR.CHZ[jqid] ~= nil and WAR.CHZ[jqid] > 0 then 
								   if wglw(jqid,178) or wglw(jqid,182) or (DT(jqid,5) and PersonGT(jqid,182)) or (DT(jqid,69) and PersonKF(jqid,178)) or T9ZY(jqid) or DT(jqid,602) then --九龙功
										jq1 = math.modf(WAR.Person[i].TimeAdd*2)
								   elseif PersonKF(jqid,143) and MPPD(jqid) == 5 and MPDJ(jqid) >= 2 then
										if WAR.CHZ[jqid] > 30 then
											jq1 = math.modf(WAR.Person[i].TimeAdd*1.5)
										elseif WAR.CHZ[jqid] <= 30 then
											jq1 = WAR.Person[i].TimeAdd
										end
								   else
										jq1 = math.modf(WAR.Person[i].TimeAdd/2)
								   end
								end
								jq2 = jq1
								jq3 = jq1
								if WAR.ICE[jqid] ~= nil  and WAR.ICE[jqid] > 0 then
									x = 0
								end		
								if wglw(jqid,178) or (DT(jqid,69) and PersonKF(jqid,178)) or T9ZY(jqid) or DT(jqid,602) then --九龙功
									jq3 = jq2 + x
								elseif wglw1(jqid,176) or (DT(jqid,49) and PersonKF(jqid,176)) or DT(jqid,117) or DT(jqid,618) then --生死符
									jq3 = jq2 + x
								end
								if wglw(jqid,182) or (DT(jqid,5) and PersonGT(jqid,182)) then 
									jq3 = jq2 + x
								end
								if WAR.Person[i].TimeAdd > 0 and jq3 < 5 then 
								   jq3 = 5 
								end
								if putong() == 2 and jqid == 0 then 
									 local jsyx = wgnumber(0, 2)
									 jq3 = jq3+5 * (jsyx)
								end		 
								if MPPD(jqid) == 11 and MPDJ(jqid) > 2 then 
									 if putong() == 2 and jqid == 0 then 
										 local jsyx = wgnumber(0, 2)
										 jq3 = WAR.YDSD[jqid]+5 * (jsyx)
									 else 
										jq3 = WAR.YDSD[jqid]
									 end
								end
								if MPPD(jqid) == 8 and PersonKF(jqid, 118) and math.random(10) >= 5 then
									WAR.Person[i].Time = WAR.Person[i].Time + (25*MPDJ(jqid))+25
									jq3 = jq3 + 10
								end	
								if wglw(jqid,189) and WAR.YSJS[jqid] ~=nil and WAR.YSJS[jqid] > 0 and math.random(10) >= 5 then
									WAR.Person[i].Time = WAR.Person[i].Time + 250
									jq3 = jq3 + 20
								end	
								if DT(jqid, 617) then 
								   jq3 = 100
								end   
								if (jqid == 0 and GetS(114,0,0,0) > 0) or DT(jqid,667) then
									jq3 = jq3 + 25
									if jq3 < 30 and wglw2(jqid,193) then
										jq3 = 30
									end	
									if jq3 > 120 and not wglw2(jqid,190) then 
										jq3 = 120
									end
								else   
									if jq3 > 100 then 
										jq3 = 100 
									end
								end  
								if WAR.LQZ[jqid] ~= nil and WAR.LQZ[jqid] == 100 then
									if wglw(jqid,178) or wglw(jqid,182) or wglw1(jqid,48) or (DT(jqid,5) and PersonGT(jqid,182)) or (DT(jqid,69) and PersonKF(jqid,178)) or T9ZY(jqid) or DT(jqid,602) then
										jq3 = jq3 * 3
									else
										jq3 = jq3 * 2
									end
								end	
								WAR.Person[i].Time = WAR.Person[i].Time + jq3
								WAR.JQSDXS[WAR.Person[i]["人物编号"]] = jq3		
							else --如果没学九阴，集气絮乱	--------------------------------------()
								local jq1 = WAR.Person[i].TimeAdd
								local jq2 = WAR.Person[i].TimeAdd
								local jq3 = WAR.Person[i].TimeAdd
								local x = 0
								--jq1 = WAR.Person[i].TimeAdd
								if WAR.CHZ[jqid] ~= nil and WAR.CHZ[jqid] > 0 then 
								   if wglw(jqid,178) or (DT(jqid,69) and PersonKF(jqid,178)) or T9ZY(jqid) or DT(jqid,602) then --九龙功
								   jq1 = math.modf(WAR.Person[i].TimeAdd*2)
								   else
								   jq1 = math.modf(WAR.Person[i].TimeAdd/2)
								   end
								end
								   jq2 = jq1
								   jq3 = jq1
								if WAR.CHZ[jqid] ~= nil and WAR.CHZ[jqid] > 0 then 
									if wglw(jqid,182) or (DT(jqid,5) and PersonGT(jqid,182)) then 
										jq1 = math.modf(WAR.Person[i].TimeAdd*2)
									else
										jq1 = math.modf(WAR.Person[i].TimeAdd/2)
									end
								end
								if WAR.ICE[jqid] ~= nil  and WAR.ICE[jqid] > 0 then
									x = 0
								end	
								if wglw(jqid,178) or (DT(jqid,69) and PersonKF(jqid,178)) or T9ZY(jqid) or DT(jqid,602) then --九龙功
									jq3 = jq2 + x
								elseif wglw1(jqid,176) or (DT(jqid,49) and PersonKF(jqid,176)) or DT(jqid,117) or DT(jqid,618) then --生死符
									jq3 = jq2 + x
								end
								if WAR.Person[i].TimeAdd > 0 and jq3 < 5 then 
								   jq3 = 5 
								end
								if putong() == 2 and jqid == 0 then 
								 local jsyx = wgnumber(0, 2)
								 jq3 = jq3+5 * (jsyx)
								end
								if wglw(jqid,182) or (DT(jqid,5) and PersonGT(jqid,182)) then 
									jq3 = jq2 + x
								end	
								  if MPPD(jqid) == 11 and MPDJ(jqid) > 2 then 
									 if putong() == 2 and jqid == 0 then 
									 local jsyx = wgnumber(0, 2)
									 jq3 = WAR.YDSD[jqid]+5 * (jsyx)
									 else 
									 jq3 = WAR.YDSD[jqid]
									 end
								  end
								if DT(jqid, 617) then 
								   jq3 = 100
								end		
								if jq3 > 100 then 
								   jq3 = 100 
								end  
								local yqzsmy = math.modf(JY.Person[jqid]["内力"]/JY.Person[jqid]["内力最大值"])
								if (PersonKF(jqid, 107) == false or (WAR.HOT[jqid] or 0) >= 20) and WAR.Person[i].TimeAdd > 0 then          
									--local jq = 0; --蓝烟清：逆运集气速度变化           	
									if WAR.L_NYZH[WAR.Person[i]["人物编号"]] == nil then
										if wglw(jqid,104) then --豸苗：逆运精义
										   jq3 = math.random(math.floor(jq3*1.5),math.floor(jq3*2))
										   if WAR.LQZ[jqid] == 100 then
										   jq3 = math.random(math.floor(jq3*2.5),math.floor(jq3*3))
										   end
										elseif DT(jqid, 60) or DT(jqid, 620) then --豸苗：逆运精义
										   jq3 = math.random(jq3,math.floor(jq3*1.25))
										   if math.random(10) <= 2 and JX(jqid) then
										   jq3 = jq3+math.random(5,10)
										   end
										elseif wglw(jqid,178) or (DT(jqid,69) and PersonKF(jqid,178)) or T9ZY(jqid) or DT(jqid,602) then --九龙功  
										   jq3 = math.random(jq3,math.floor(jq3*1.5))
										elseif (wglw1(jqid,176) or (DT(jqid,59) and PersonKF(jqid,176)) or DT(jqid,117) or DT(jqid,618)) and ((WAR.HOT[jqid] or 0) >= 20) then --生死符
										   jq3 = math.random(jq3,math.floor(jq3*1.5))
										elseif wglw(jqid,182) or (DT(jqid,5) and PersonGT(jqid,182)) then 
										   jq3 = math.random(jq3,math.floor(jq3*1.5))
										elseif wglw1(jqid,68) and yqzsmy >= 0.25 then  
										else
										   jq3 = math.random(jq3) + 1	   
										end   
										WAR.Person[i].Time = WAR.Person[i].Time + jq3							
									elseif WAR.L_NYZH[WAR.Person[i]["人物编号"]] == 1 or (WAR.HOT[jqid] or 0) >= 20 then		--新逆运走火集气变化
										if T11CJR(jqid) and JY.Person[jqid]["内力性质"] == 0 and juexing() > 0 then --  
											jq3 = math.random(math.floor(jq3*1.5),math.floor(jq3*2))
										   if WAR.LQZ[jqid] == 100 then
											jq3 = math.random(math.floor(jq3*2.5),math.floor(jq3*3))
										   end
										elseif PersonGT(jqid, 104) then
											jq3 = math.random(math.floor(jq3/2),jq3*2)
										else
											jq3 = math.random(math.floor(jq3/3),jq3*2)
										end
										WAR.Person[i].Time = WAR.Person[i].Time + jq3
									end	            
									--絮乱状态下额外的集气加成，两次判断
									if (math.random(10) == 8 or (PersonGT(jqid, 104) and math.random(10) == 8)) and MPPD(jqid)~=8 then
										if wglw(jqid,104) or DT(jqid,620) then--豸苗：逆运精义
											if WAR.NYZJ[jqid] ~= nil then
											WAR.Person[i].Time = WAR.Person[i].Time + 50
											jq3 = jq3 + 50;
											else
											WAR.Person[i].Time = WAR.Person[i].Time
											jq3 = jq3 
											end
										else
											WAR.Person[i].Time = WAR.Person[i].Time + 50
											jq3 = jq3 + 50;
										end
									elseif MPPD(jqid)==8 and (PersonGT(jqid, 104) and math.random(10) >= 8) then
										WAR.Person[i].Time = WAR.Person[i].Time + 25*MPDJ(jqid)
										jq3 = jq3 + 25*MPDJ(jqid);
										if wglw(jqid,104) or DT(jqid,620) then--豸苗：逆运精义
											if WAR.NYZJ[jqid] ~= nil then
											WAR.Person[i].Time = WAR.Person[i].Time + 50
											jq3 = jq3 + 50;
											else
											WAR.Person[i].Time = WAR.Person[i].Time
											jq3 = jq3 + 25 
											end
										end
									elseif MPPD(jqid)==8 and (PersonKF(jqid, 118) and math.random(10) >= 0) then
											WAR.Person[i].Time = WAR.Person[i].Time + 15*MPDJ(jqid)
											jq3 = jq3 + 25
									elseif wglw(jqid,184) or DT(jqid,665) then --瑜伽密乘
										if WAR.YJMC[jqid] ~= nil then
											WAR.Person[i].Time = WAR.Person[i].Time + 100
											jq3 = jq3 + 100
										else
											WAR.Person[i].Time = WAR.Person[i].Time 
											jq3 = jq3 + 50
										end	
									else
										WAR.Person[i].Time = WAR.Person[i].Time 
										jq3 = jq3 ;
									end		
									--蓝烟清：刷新逆运絮乱集气时的速度
									WAR.JQSDXS[WAR.Person[i]["人物编号"]] = jq3;           
									if JY.Person[WAR.Person[i]["人物编号"]]["体力"] < 20 then
										WAR.tmp[1000 + jqid] = nil
									end
								else		--如果学了九阴，正常集气
									if wglw(jqid,104) or DT(jqid,620) then --豸苗：逆运精义
										jq3 = math.random(jq3*1.5,math.floor(jq3*2))
										if math.random(10) > 8 and WAR.NYZJ[jqid] ~= nil then
										   WAR.Person[i].Time = WAR.Person[i].Time + 50
										   jq3 = jq3 + 50;
										end
											WAR.Person[i].Time = WAR.Person[i].Time + jq3
											WAR.JQSDXS[WAR.Person[i]["人物编号"]] = jq3
										if WAR.LQZ[jqid] == 100 then
											WAR.Person[i].Time = WAR.Person[i].Time + jq3 *2
											WAR.JQSDXS[WAR.Person[i]["人物编号"]] = jq3 * 2
										--WAR.JQSDXS[WAR.Person[i]["人物编号"]] = jq3*2
										end
									elseif T11CJR(jqid) and JY.Person[jqid]["内力性质"] == 0 and juexing() > 0 then
										jq3 = math.random(jq3*1.5,math.floor(jq3*2))
										WAR.Person[i].Time = WAR.Person[i].Time + jq3
										WAR.JQSDXS[WAR.Person[i]["人物编号"]] = jq3
										if WAR.LQZ[jqid] == 100 then
										WAR.Person[i].Time = WAR.Person[i].Time + jq3 *2
										WAR.JQSDXS[WAR.Person[i]["人物编号"]] = jq3 * 2
										end
									elseif (DT(jqid, 60) or DT(jqid, 620)) and JX(jqid) then	
										--local jq = 0  
										jq3 = math.random(jq3,jq3*2)
										   if math.random(10) <= 2 then
										   jq3 = jq3 + math.random(10,20)
										   end
										if math.random(10) > 8 then
										   WAR.Person[i].Time = WAR.Person[i].Time + 100
										   jq3 = jq3 + 100;
										end  
											WAR.Person[i].Time = WAR.Person[i].Time + jq3
											WAR.JQSDXS[WAR.Person[i]["人物编号"]] = jq3
										if WAR.LQZ[jqid] == 100 then
											WAR.Person[i].Time = WAR.Person[i].Time + jq3 * 2
											WAR.JQSDXS[WAR.Person[i]["人物编号"]] = jq3*2
										--WAR.JQSDXS[WAR.Person[i]["人物编号"]] = jq3*2
										end
									elseif DT(jqid, 599) then	
										--local jq = 0  
										jq3 = math.random(jq3*2,jq3*3)
										   if math.random(10) <= 2 then
										   jq3 = jq3 + math.random(10,20)
										   end
										if math.random(10) > 8 then
										   local congqi=math.random(100,300)
										   WAR.Person[i].Time = WAR.Person[i].Time +congqi
										   jq3 = jq3 + congqi;
										end  
											WAR.Person[i].Time = WAR.Person[i].Time + jq3
											WAR.JQSDXS[WAR.Person[i]["人物编号"]] = jq3
										if WAR.LQZ[jqid] == 100 then
											WAR.Person[i].Time = WAR.Person[i].Time + jq3 * 2
											WAR.JQSDXS[WAR.Person[i]["人物编号"]] = jq3*2
										--WAR.JQSDXS[WAR.Person[i]["人物编号"]] = jq3*2
										end
									else
										WAR.Person[i].Time = WAR.Person[i].Time + jq3
										WAR.JQSDXS[WAR.Person[i]["人物编号"]] = jq3
										if WAR.LQZ[jqid] == 100 then
											if wglw(jqid,178) or wglw(jqid,182) or T9ZY(jqid) or DT(jqid,602) or wglw1(jqid,48) or 
											(DT(jqid,5) and PersonGT(jqid,182)) or (DT(jqid,69) and PersonKF(jqid,178))  then --九龙功
												WAR.Person[i].Time = WAR.Person[i].Time + jq3*3
												WAR.JQSDXS[WAR.Person[i]["人物编号"]] = jq3*3
											else
												WAR.Person[i].Time = WAR.Person[i].Time + jq3*2
												WAR.JQSDXS[WAR.Person[i]["人物编号"]] = jq3*2
											end
										end
									end	
								end	
							end

						end	
					end  
					--九阳神功回内
					if PersonKF(jqid, 106) and (JY.Person[jqid]["内力性质"] == 1 or JY.Person[jqid]["内力性质"] == 3) then
					  AddPersonAttrib(jqid, "内力",  4 + math.random(2))
					  if PersonGT(jqid, 106) then
						AddPersonAttrib(jqid, "内力",  3 + math.random(1))
					  end
					end
					if ((DT(jqid,59) and PersonKF(jqid,121)) or wglw(jqid,121) or DT(jqid,601)) then --17-3-3-玉女经
					   for j = 0,WAR.PersonNum-1 do 
						  if WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false and WAR.SPIRIT[WAR.Person[j]["人物编号"]] ~= nil then 
							 if WAR.SPIRIT[WAR.Person[j]["人物编号"]] > WAR.SPIRITMIN[WAR.Person[j]["人物编号"]] then 
								WAR.SPIRIT[WAR.Person[j]["人物编号"]] = WAR.SPIRITMIN[WAR.Person[j]["人物编号"]]
								WAR.QX1[WAR.Person[j]["人物编号"]] = 1
							 end	
						  end 
					   end
					end
					
					if WAR.QX1[jqid] == 1 then 
					   if WAR.LQZ[jqid] == nil then 
						  WAR.LQZ[jqid] = 0 
					   elseif WAR.LQZ[jqid] ~= nil and WAR.LQZ[jqid] <100 then--17-3-3-玉女经
						  WAR.LQZ[jqid]=WAR.LQZ[jqid]+1
					   end
					end
					
					--九阴神功回血
					if PersonKF(jqid, 107) and (JY.Person[jqid]["内力性质"] == 0 or JY.Person[jqid]["内力性质"] == 3) and WAR.XUEMO[jqid] == nil then
					  AddPersonAttrib(jqid, "生命", 2)
					  if PersonGT(jqid, 107) then
						AddPersonAttrib(jqid, "生命", 3)
					  end
					  if DT(jqid, 599) and PersonKF(jqid,100)  then
						AddPersonAttrib(jqid, "生命",  3 + math.random(3))
						if math.random(10) == 8 then----
						AddPersonAttrib(jqid, "生命",  math.random(3)*100)
						end
					  end
					  if DT(jqid, 599) and DT(jqid, 602) and PersonKF(jqid,152) then
						AddPersonAttrib(jqid, "内力",  5 + math.random(3))
						if math.random(10) == 8  then----
						AddPersonAttrib(jqid, "内力",  math.random(3)*300)
						end
					  end		  
					end
			
					--火焰刀气回内伤
					if ((DT(jqid, 103) or DT(jqid, 595)) or wglw1(jqid,66)) then 
						  if JY.Person[jqid]["受伤程度"] > 70 then
							JY.Person[jqid]["受伤程度"] = JY.Person[jqid]["受伤程度"] - 1
						  elseif JY.Person[jqid]["受伤程度"] > 40 and JLSD(15, 85, jqid) then
							JY.Person[jqid]["受伤程度"] = JY.Person[jqid]["受伤程度"] - 1
						  else
							JY.Person[jqid]["受伤程度"] = JY.Person[jqid]["受伤程度"] - 1
						  end
					end			
					
					--火焰刀气回内力
					if ((DT(jqid, 103) or DT(jqid, 595)) or wglw1(jqid,66)) then 
						JY.Person[jqid]["内力"] = JY.Person[jqid]["内力"] + 3 + math.random(2)
					end		
					
					if hasTF(jqid, 123) then	
						AddPersonAttrib(jqid, "内力",  2 + math.random(3))
						if wglw(jqid,152) and DT(jqid,602) then
							if math.random(10) == 8 and PersonKF(jqid,152) then----
							AddPersonAttrib(jqid, "内力",  math.random(3)*300)
							end
						end			
					end
					
					if hasTF(jqid, 124) then		
						AddPersonAttrib(jqid, "生命", math.random(2))
						if wglw(jqid,100) then
							if math.random(10) == 8 and PersonKF(jqid,100) then----
							AddPersonAttrib(jqid, "生命",  math.random(3)*100)
							end
						end
					end
					
					--乌蚕衣时序回内伤2点
					if JY.Person[jqid]["防具"] == 59 then	
						if JY.Person[jqid]["受伤程度"] > 0 then
							JY.Person[jqid]["受伤程度"] = JY.Person[jqid]["受伤程度"] - 10
						end	
					end			
					
					--鳄皮护甲时序恢复中毒2点	
					if JY.Person[jqid]["防具"] == 61 then	
						if JY.Person[jqid]["中毒程度"] > 0 then
							JY.Person[jqid]["中毒程度"] = JY.Person[jqid]["中毒程度"] - 10
						end	
					end
					
					if wglw(jqid,107) or DT(jqid,599) then --17-2-10
					   --JY.Person[jqid]["受伤程度"]
					   AddPersonAttrib(jqid, "生命", JY.Person[jqid]["受伤程度"]*5)
					   AddPersonAttrib(jqid, "受伤程度", -100)
					end
					
					if PersonGT(jqid, 90) then
						if XYL(jqid) or jtyl(jqid) then
						AddPersonAttrib(jqid, "体力", 1)
						elseif JLSD(10, 70, jqid) then --混元主功体1/2几率时序回体
						AddPersonAttrib(jqid, "体力", 1)
						end
					elseif PersonKF(jqid, 90) then 
						if (XYL(jqid) or jtyl(jqid)) and JLSD(10, 70, jqid) then
						AddPersonAttrib(jqid, "体力", 1)
						elseif JLSD(10, 40, jqid) then --混元主功体1/2几率时序回体
						AddPersonAttrib(jqid, "体力", 1)
						end
					end	
					
					if PersonGT(jqid, 180) then
						if XYL(jqid) or jtyl(jqid) then
						AddPersonAttrib(jqid, "体力", 1)
						elseif JLSD(10, 70, jqid) then --混元主功体1/2几率时序回体
						AddPersonAttrib(jqid, "体力", 1)
						end
					end
					
					if wglw(jqid, 90) then
						AddPersonAttrib(jqid, "体力", 1)
					end
					
					if (DT(jqid, 60) or DT(jqid, 620)) and PersonGT(jqid, 104) then	
						if JLSD(10, 60, jqid) then 
						AddPersonAttrib(jqid, "体力", 1)
						end
					end
					
					if (wglw(jqid,106) or (DT(jqid,9) and PersonKF(jqid,106))) then --17-2-8-生生不息
						AddPersonAttrib(jqid, "生命", 5);
						AddPersonAttrib(jqid, "内力", 10);
						AddPersonAttrib(jqid, "受伤程度", -8)
					end    

					--brolycjw: 先天功回内
					if PersonKF(jqid, 100) then
					   AddPersonAttrib(jqid, "内力", math.random(0, 3))
						if PersonGT(jqid, 100) then
							AddPersonAttrib(jqid, "内力", math.random(1, 2))
						end
					end
					
					--brolycjw: 先天功回内
					if wglw(jqid,100) or (DT(jqid,129) and PersonKF(jqid,100)) then 
						AddPersonAttrib(jqid, "内力", math.random(1, 3))--豸苗：先天领悟
						AddPersonAttrib(jqid, "生命", math.random(2, 4))
						if JY.Person[jqid]["受伤程度"] > 0 then 
							AddPersonAttrib(jqid, "生命", 5)
							AddPersonAttrib(jqid, "受伤程度", -1)
							AddPersonAttrib(jqid, "内力", 2)
						end
					end

					--brolycjw: 天南领悟回内
					if (wglw(jqid,152) or DT(jqid, 102) or DT(jqid, 65) or DT(jqid, 602)) and PersonKF(jqid,152) then 
						AddPersonAttrib(jqid, "内力", math.random(5, 10))
						if JY.Person[jqid]["内力"] <= math.modf(JY.Person[jqid]["内力最大值"]*0.25) then 
							AddPersonAttrib(jqid, "内力", 25)--沼跃鱼：天南应急处理
						end
						if JY.Person[jqid]["生命"] <= math.modf(JY.Person[jqid]["生命最大值"]*0.5) then 
							AddPersonAttrib(jqid, "内力", -15)--沼跃鱼：天南应急处理
							AddPersonAttrib(jqid, "生命", 15)--沼跃鱼：天南应急处理
						end
					end
					
					if wglw1(jqid,31) then 
					   AddPersonAttrib(jqid, "生命", math.random(3, 8))
					   if JY.Person[jqid]["中毒程度"] > 0 then 
						  AddPersonAttrib(jqid, "生命", 5)
						  AddPersonAttrib(jqid, "中毒程度", -1)
					   end
					end
					
					if NF(jqid) then --聂风冰心诀
						AddPersonAttrib(jqid, "生命", 3);
						AddPersonAttrib(jqid, "内力", 10);
						AddPersonAttrib(jqid, "体力", 2);
						AddPersonAttrib(jqid,"受伤程度", -3);
						AddPersonAttrib(jqid,"中毒程度", -3);
						WAR.FXDS[jqid] = nil;
						WAR.LXZT[jqid] = nil;		
					end
				   
					if DT(jqid,582) and JX(jqid) and WAR.MWQ1 == 1 then --木婉清湿婆降临时序回复
						AddPersonAttrib(jqid, "生命", 10);
						AddPersonAttrib(jqid, "内力", 10);
						AddPersonAttrib(jqid, "体力", 2);
						AddPersonAttrib(jqid,"受伤程度", -2);
						AddPersonAttrib(jqid,"中毒程度", -2);
					end
					
					if BJY(jqid) then --步惊云恢复
						AddPersonAttrib(jqid, "生命", 5);
						AddPersonAttrib(jqid, "内力", 15);
						AddPersonAttrib(jqid, "体力", 3);
						AddPersonAttrib(jqid,"受伤程度", -5);
						AddPersonAttrib(jqid,"中毒程度", -5);
						WAR.FXDS[jqid] = nil;
						WAR.LXZT[jqid] = nil;		
					end  		
					
					if DT(jqid, 600) then 
						AddPersonAttrib(jqid, "生命", 100);
						AddPersonAttrib(jqid, "内力", 100);
						AddPersonAttrib(jqid, "体力", 20);
						AddPersonAttrib(jqid,"受伤程度", -50);
						AddPersonAttrib(jqid,"中毒程度", -50);
						WAR.FXDS[jqid] = nil;
						WAR.LXZT[jqid] = nil;		
					end 	
					
					if DT(jqid, 602) then 
						AddPersonAttrib(jqid, "生命", 5);
						AddPersonAttrib(jqid, "内力", 5);
						AddPersonAttrib(jqid, "体力", 5);
						AddPersonAttrib(jqid,"受伤程度", -10);
						AddPersonAttrib(jqid,"中毒程度", -10);
						WAR.FXDS[jqid] = nil;
						WAR.LXZT[jqid] = nil;		
					end 	
					
					if wglw1(jqid,30) then 
						AddPersonAttrib(jqid, "内力", math.random(5, 10))
						if JY.Person[jqid]["受伤程度"] > 0 then 
							AddPersonAttrib(jqid, "受伤程度", -1)
							AddPersonAttrib(jqid, "内力", 10)
						end
					end
					
					 if MPPD(jqid)==16 then
						local aa=MPDJ(jqid)*math.random(2, 6)		 
						AddPersonAttrib(jqid, "生命", aa)
						if JY.Person[jqid]["受伤程度"] > 0 then 
							AddPersonAttrib(jqid, "生命", 3)
							AddPersonAttrib(jqid, "内力", 5)
							AddPersonAttrib(jqid, "受伤程度", -1)
						end
					end
					
					if jqid==0 and putong()==5 then 
						AddPersonAttrib(jqid, "内力", math.random(5, 10))
						if JY.Person[jqid]["受伤程度"] > 0 then 
							AddPersonAttrib(jqid, "受伤程度", -1)
							AddPersonAttrib(jqid, "内力", 10)
						end
					end
					
					--运内功时序恢复内力2点 12.26
					if JY.Person[jqid]["声望"] ~= 0 then
					   local v = JY.Person[jqid]["声望"]
						if PersonTFGT(jqid, v) then
							AddPersonAttrib(jqid, "受伤程度", -1)
							--AddPersonAttrib(jqid, "内力", 2)
						end
					end 
					
					if wglw(jqid,185) or (PersonGT(jqid,185) and DT(jqid,5)) or DT(jqid,666) then	--武当九阳
						AddPersonAttrib(jqid, "受伤程度", -2)
						AddPersonAttrib(jqid, "内力", 50)	
					end	
					
					if wglw(jqid,106) or (DT(jqid,9) and PersonKF(jqid,106)) then --九阳领悟后时序恢复内力
						if JY.Person[jqid]["受伤程度"] > 0 then 
							AddPersonAttrib(jqid, "生命", 5)
							AddPersonAttrib(jqid, "内力", 10)
						end	
					end			
					
					if wglw(jqid,182) or (DT(jqid,5) and PersonGT(jqid,182)) then --太极神功时序回复内伤、生命
						if JY.Person[jqid]["受伤程度"] > 0 then 
							AddPersonAttrib(jqid, "生命", 5)
							AddPersonAttrib(jqid, "受伤程度", -1)
						end
					end		
					
					if wglw(jqid,188) or (DT(jqid,48) and PersonGT(jqid,188)) then --神足经
						AddPersonAttrib(jqid, "受伤程度", -6)	
						AddPersonAttrib(jqid, "中毒程度", -6)
					end	
					
					if wglw(jqid,181) and JLSD(10,40,jqid) then --玄武真功反噬
						if JY.Person[jqid]["生命"] >= 0 then 
							AddPersonAttrib(jqid, "生命", -75)
							if JY.Person[jqid]["生命"] < 1 then
								JY.Person[jqid]["生命"] = 1
							end
						end	
						AddPersonAttrib(jqid, "体力", -5);
						AddPersonAttrib(jqid, "受伤程度", 15)
					end						
					
					if (wglw(jqid,105) and PersonGT(jqid,105)) or (PersonKF(jqid,105) and (DT(jqid,455))) or DT(jqid,617) then	--葵花领悟时序恢复内伤、中毒
						AddPersonAttrib(jqid, "受伤程度", -5)	
						AddPersonAttrib(jqid, "中毒程度", -5)
					end	
					
					if DT(jqid,603) then	
						AddPersonAttrib(jqid, "受伤程度", -7)	
						AddPersonAttrib(jqid, "中毒程度", -7)
						WAR.FXDS[jqid] = nil
						WAR.LXZT[jqid] = nil
					end	
					
					if (wglw(jqid,183) or (DT(jqid,615) and PersonGT(jqid,183))) then --洗髓经时序回复生命
						AddPersonAttrib(jqid, "生命", 10)
						AddPersonAttrib(jqid, "内力", 100)
					end			
					
					if DT(jqid,617) then
						AddPersonAttrib(jqid, "生命", 200)
						AddPersonAttrib(jqid, "内力", 300)
						AddPersonAttrib(jqid, "体力", 20)
						AddPersonAttrib(jqid, "受伤程度", -20)	
						AddPersonAttrib(jqid, "中毒程度", -20)
					end			
					
					if wglw(jqid,178) or (DT(jqid,69) and PersonKF(jqid,178)) or T9ZY(jqid) or DT(jqid,602) then --九龙功
						if JY.Person[jqid]["受伤程度"] > 0 then 
							AddPersonAttrib(jqid, "生命", 5)
							AddPersonAttrib(jqid, "受伤程度", -1)
						end
						if JY.Person[jqid]["中毒程度"] > 0 then 
							AddPersonAttrib(jqid, "体力", 1)
							AddPersonAttrib(jqid, "中毒程度", -1)
						end
					end
					
					if jtyl(jqid) then 
						AddPersonAttrib(jqid, "受伤程度", -100)
						AddPersonAttrib(jqid, "中毒程度", -100)
					end 
					
					if WAR.JYHT[jqid] ~= nil then --17-2-8
						AddPersonAttrib(jqid, "受伤程度", -100)
						AddPersonAttrib(jqid, "中毒程度", -100)
					end
					
					--持瑶琴回光返照
					if WAR.HGFZ[jqid] ~= nil then
						AddPersonAttrib(jqid, "中毒程度", -5)
						AddPersonAttrib(jqid, "内力", -50)
						AddPersonAttrib(jqid, "体力", -1)
						if JY.Person[jqid]["中毒程度"] <= 0 then
							local aa = math.random(100,150)
							JY.Person[jqid]["中毒程度"] = 0
							AddPersonAttrib(jqid, "生命", -aa)
							WAR.HGFZ[jqid] = nil
						end
					end	
					
					--持瑶琴魂牵罪判
					if WAR.HQZP[jqid] ~= nil then
						local aa = math.modf(20,100)
						local bb = math.modf(10,50)
						WAR.HQZP[jqid] = WAR.HQZP[jqid] - 1
						WAR.FXDS[jqid] = aa
						WAR.LXZT[jqid] = aa
						WAR.ICE[jqid] = bb
						WAR.HOT[jqid] = bb
						WAR.CHZ[jqid] = bb
						if WAR.HQZP[jqid] <= 0 then
							WAR.HQZP[jqid] = nil
						end
					end
					
					--狱龙破时序效果
					if WAR.YLP[jqid] ~= nil and WAR.YLP[jqid] > 0 then
						WAR.YLP[jqid] = WAR.YLP[jqid] - 1
						WAR.ATKDOWN[jqid] = WAR.ATKDOWN[jqid] or 0 + 10
						WAR.DEFDOWN[jqid] = WAR.DEFDOWN[jqid] or 0 + 10
						if WAR.SPIRIT[jqid] > 90 then
							WAR.SPIRIT[jqid] = WAR.SPIRIT[jqid] - 1
						end
						if WAR.YLP[jqid] <= 0 then
							WAR.YLP[jqid] = 0
							WAR.ATKDOWN[jqid] = 0
							WAR.DEFDOWN[jqid] = 0
						end
					end	
					
					--八卦刀领悟 易数值
					if WAR.TJNC[jqid] ~= nil and WAR.TJNC[jqid] > 0 then
						WAR.TJNC[jqid] = WAR.TJNC[jqid] - 1
						if WAR.TJNC[jqid] <= 0 then
							WAR.TJNC[jqid] = 0
							local aa = math.random(4)
							AddPersonAttrib(jqid, "生命", -(64*aa))
							if JLSD(10,50) then
							WAR.MENG[jqid] = 30 
							end
						end
					end	
					
					if WAR.BPD[jqid] ~= nil and WAR.BPD[jqid] > 0 then
						if WAR.Person[i].TimeAdd < 10 then
						AddPersonAttrib(jqid, "生命", -15)
						end
						WAR.BPD[jqid] = WAR.BPD[jqid] - 1
						if WAR.BPD[jqid] <= 0 then
							WAR.BPD[jqid] = 0
						end	
					end
					
					--铁掌领悟 反噬
					if wglw1(jqid,13) and JY.Person[jqid]["内力性质"] ~= 1 and JLSD(10,20,jqid) then
						WAR.HOT[jqid] = (WAR.HOT[jqid] or 0) + 10
						WAR.FXDS[jqid] = (WAR.FXDS[jqid] or 0) + 20
					elseif wglw1(jqid,13) and JY.Person[jqid]["内力性质"] == 1 then
						WAR.HOT[jqid] = (WAR.HOT[jqid] or 0) - 5
					end
					
					--铁掌领悟 儒君子气
					if WAR.RJZQ[jqid] ~= nil and WAR.RJZQ[jqid] > 0 and JLSD(10,30,jqid) then 
						local aa = math.random(50,200)
						WAR.Person[i].Time = WAR.Person[i].Time - aa
						WAR.RJZQ[jqid] = WAR.RJZQ[jqid] - 1
						if WAR.Person[i].Time < -500 then WAR.Person[i].Time = -500 end
					end	
					--寒冰绵掌领悟 反噬
					if wglw1(jqid,5) and JY.Person[jqid]["内力性质"] ~= 0 and JLSD(10,20,jqid) then
						WAR.ICE[jqid] = (WAR.ICE[jqid] or 0) + 10
						WAR.LXZT[jqid] = (WAR.LXZT[jqid] or 0) + 20
					elseif wglw1(jqid,13) and JY.Person[jqid]["内力性质"] == 0 then
						WAR.ICE[jqid] = (WAR.ICE[jqid] or 0) - 5
					end
					
					if WAR.ZDNS[jqid] ~= nil then--重伤特效
						WAR.ZDNS[jqid] = WAR.ZDNS[jqid] - 1
						if WAR.ZDNS[jqid] <= 0 then
							WAR.ZDNS[jqid] = nil
						end	
					end		
					
					if WAR.SZZX1[jqid] ~= nil  then--三指诛仙
						if JY.Person[jqid]["生命"] > math.modf(JY.Person[jqid]["生命最大值"]/2) then
							JY.Person[jqid]["生命"] = math.modf(JY.Person[jqid]["生命最大值"]/2)
						end
						WAR.SZZX1[jqid] = WAR.SZZX1[jqid] - 1
						if WAR.SZZX1[jqid] <= 0 then
							WAR.SZZX1[jqid] = nil
						end
					end
					
					
					if WAR.XYLS[jqid] ~= nil then
						WAR.XYLS[jqid] = WAR.XYLS[jqid] - 1
						if WAR.XYLS[jqid] <= 0 then
							WAR.XYLS[jqid] = nil
						end	
					end
					
					if WAR.YJQS[jqid] ~= nil and WAR.YJQS[jqid] > 0 then--崆峒门派
						WAR.YJQS[jqid] = WAR.YJQS[jqid] - 1
						if 	WAR.YJQS[jqid] <= 0 then
							WAR.YJQS[jqid] = nil 
						end
						if WAR.YJQS[jqid] == 49 or WAR.YJQS[jqid] == 42 or WAR.YJQS[jqid] == 35 or WAR.YJQS[jqid] == 28 or WAR.YJQS[jqid] == 21 or WAR.YJQS[jqid] == 14 or WAR.YJQS[jqid] == 7 then
							local tmppid = WAR.CurID
								WAR.CurID = i
								WarDrawMap(0)
							local aa = math.random(1,7) 
							if aa == 1 then
								WAR.HOT[jqid] = (WAR.HOT[jqid] or 0 ) + (WAR.LQZ[jqid] or 0)
								
								DHdisplay(1747, 1759, "心火逆冲")
							elseif aa == 2 then
								local bb = math.modf(JY.Person[jqid]["内力"]/500)
								if bb < 10 then bb = 10 end
								WAR.ICE[jqid] = (WAR.ICE[jqid] or 0 ) + bb
								DHdisplay(1747, 1759, "肾水凝滞")
							elseif aa == 3 then
								if JY.Person[jqid]["中毒程度"] < 80 then
									WAR.L_WNGZL[jqid] = (WAR.L_WNGZL[jqid] or 0 ) + 15
								else
									WAR.L_WNGZL[jqid] = (WAR.L_WNGZL[jqid] or 0 ) + 15
									WAR.GUDUVICTIE[jqid] = (WAR.GUDUVICTIE[jqid] or 0) + 15
								end
								DHdisplay(1747, 1759, "肝木催折")
							elseif aa == 4 then
								WAR.LHFM[jqid] = (WAR.LHFM[jqid] or 0) + 5
								DHdisplay(1747, 1759, "脾土腐坏")
							elseif aa == 5 then
								WAR.Person[i].Time = WAR.Person[i].Time - 250 
								WAR.LXZT[jqid] = (WAR.LXZT[jqid] or 0 ) + 20
								if WAR.Person[i].Time < -500 then
									WAR.Person[i].Time = - 500
								end	
								DHdisplay(1747, 1759, "肺金蚀锈")
							elseif aa == 6 then
								JY.Person[jqid]["内力"] = (JY.Person[jqid]["内力"] or 0) - 500
								JY.Person[jqid]["受伤程度"] = (JY.Person[jqid]["受伤程度"] or 0) + 20
									if JY.Person[jqid]["内力性质"] == 1 then
										WAR.YMD[jqid] = 20
									else
										WAR.YMD[jqid] = 15
									end
								DHdisplay(1747, 1759, "阳脉寸断")
							elseif aa == 7 then	
								JY.Person[jqid]["内力"] = (JY.Person[jqid]["内力"] or 0) - 500
								JY.Person[jqid]["受伤程度"] = (JY.Person[jqid]["受伤程度"] or 0) + 20
									if JY.Person[jqid]["内力性质"] == 0 then
										WAR.YMH[jqid] = 20
									else
										WAR.YMH[jqid] = 15
									end
								DHdisplay(1747, 1759, "阴络尽毁")
							end
							WAR.CurID=tmppid		
						end	
					end
					if WAR.YMD[jqid] ~= nil then
						WAR.YMD[jqid] = WAR.YMD[jqid] - 1
						if WAR.YMD[jqid] <= 0 then
							WAR.YMD[jqid] = nil
						end	
					end	
					if WAR.YMH[jqid] ~= nil then
						WAR.YMH[jqid] = WAR.YMH[jqid] - 1
						if WAR.YMH[jqid] <= 0 then
							WAR.YMH[jqid] = nil
						end
					end	
					
					--密宗踏雪无痕
					if MPPD(jqid) == 6 and PersonKF(jqid,195) then
						if JLSD(10,80,jqid) then
							local aa = WAR.Person[i].TimeAdd or 0
							WAR.TSWH[jqid] = WAR.TSWH[jqid] or 0  + aa
						end
					end

					if (wglw(jqid,189) or (DT(jqid,603))) and (WAR.YANGJ[jqid] ~= nil and WAR.YANGJ[jqid] > 0) or (WAR.YINJ[jqid] ~= nil and WAR.YINJ[jqid] > 0) then--阴阳磨领悟
						local tmppid = WAR.CurID
						WAR.CurID = i
						WarDrawMap(0)
						if WAR.YANGJ[jqid] ~= nil and WAR.YANGJ[jqid] > 0 then
							local aa = math.random(3)
							WAR.YANGJ[jqid] = WAR.YANGJ[jqid] - 1
							AddPersonAttrib(jqid, "内力", 100*(aa))
							if math.random(10) > 4 then
								WAR.HOT[jqid] = 0
								WAR.FXDS[jqid] = 0
							end
							if 	WAR.YANGJ[jqid] < 1 then
								WAR.YANGJ[jqid] = nil
								WAR.YINJ[jqid] = 30
								JY.Person[jqid]["受伤程度"] = 0
								JY.Person[jqid]["中毒程度"] = 0
								DHdisplay(1909,1922,"阳极阴生")
							end
						elseif WAR.YINJ[jqid] ~= nil and WAR.YINJ[jqid] > 0 then
							WAR.YINJ[jqid] = WAR.YINJ[jqid] - 1
							if JLSD(10,40,jqid) then
								if math.random(10) > 5 then
									AddPersonAttrib(jqid, "生命", 50)
								else 
									AddPersonAttrib(jqid, "体力", 5)
								end	
							end
							if math.random(10) > 4 then	
								WAR.ICE[jqid] = 0
								WAR.CHZ[jqid] = 0
							end
							if WAR.YINJ[jqid] < 1 then
								WAR.YINJ[jqid] = nil 
								WAR.YANGJ[jqid] = 30
								JY.Person[jqid]["受伤程度"] = 0
								JY.Person[jqid]["中毒程度"] = 0
								DHdisplay(1924,1939,"阴极阳生")
							end
						end
						WAR.CurID=tmppid
					end

					if WAR.YQWR1[jqid] ~= nil and WAR.YQWR1[jqid] > 0 then
						WAR.YQWR1[jqid] = WAR.YQWR1[jqid] - 1
						if math.random(10)>7 then
							AddPersonAttrib(jqid, "内力", -100)
							WAR.HOT[jqid] = (WAR.HOT[jqid] or 0) + 10
						end
						if WAR.YQWR1[jqid] < 1 then
							WAR.YQWR1[jqid] = nil 
						end
					end	
					
					if WAR.YQWR2[jqid] ~= nil and WAR.YQWR2[jqid] > 0 then
						WAR.YQWR2[jqid] = WAR.YQWR2[jqid] - 1
						if math.random(10)>7 then
							AddPersonAttrib(jqid, "内力", -100)
							WAR.ICE[jqid] = (WAR.ICE[jqid] or 0) + 10
						end
						if WAR.YQWR2[jqid] < 1 then
							WAR.YQWR2[jqid] = nil 
						end
					end	
					
					if wglw(jqid,189) and WAR.YSJS[jqid] ~= nil and WAR.YSJS[jqid] > 0 then
						local tmppid = WAR.CurID
						WAR.CurID = i
						WarDrawMap(0)
						WAR.YSJS[jqid] = WAR.YSJS[jqid] -1 
						AddPersonAttrib(jqid, "内力", 1000)
						JY.Person[jqid]["受伤程度"] = 0
						JY.Person[jqid]["中毒程度"] = 0
						WAR.FXDS[jqid] = nil
						WAR.CHZ[jqid] = nil
						WAR.MENG[jqid] = nil
						WAR.SZWH[jqid] = nil
						WAR.GUDUVICTIE[jqid] = nil
						WAR.LHFM[jqid] = nil
						if JY.Person[jqid]["内力"] ==  JY.Person[jqid]["内力最大值"] then
							AddPersonAttrib(jqid, "生命", 100)
						end
						if WAR.YSJS[jqid] <= 0 then
							WAR.YSJS[jqid] = nil
							DHdisplay(1460,1476,"阳神降世・退")
						end	
						WAR.CurID=tmppid
					end
						
					if wglw(jqid,189) and WAR.YSZL[jqid] ~= nil and WAR.YSZL[jqid] > 0 then
						local tmppid = WAR.CurID
						WAR.CurID = i
						WarDrawMap(0)
						WAR.YSZL[jqid] = WAR.YSZL[jqid] -1 
						JY.Person[jqid]["受伤程度"] = 0
						JY.Person[jqid]["中毒程度"] = 0
						WAR.FXDS[jqid] = nil
						WAR.CHZ[jqid] = nil
						WAR.MENG[jqid] = nil
						WAR.SZWH[jqid] = nil
						WAR.GUDUVICTIE[jqid] = nil
						WAR.LHFM[jqid] = nil
						AddPersonAttrib(jqid, "生命", 80)
						if WAR.YSZL[jqid] <= 0 then
							WAR.YSZL[jqid] = nil
							DHdisplay(1478,1494,"阴圣再临・退")
						end
						WAR.CurID=tmppid		
					end	
					--阴阳磨领悟结束
					--灵蛇杖法领悟
					if WAR.LSZD[jqid] == 1 then
						WAR.LXZT[jqid] = (WAR.LXZT[jqid]or 0) + math.random(3,7)
						if WAR.LXZT[jqid] >= 100 and JY.Person[jqid]["中毒程度"] >= 100 then
							AddPersonAttrib(jqid, "生命", - 10)
							AddPersonAttrib(jqid, "受伤程度",  5)
						end	
					end
					if WAR.LSZD1[jqid] ~= nil then
						WAR.LSZD1[jqid] = WAR.LSZD1[jqid] - 1
						for i = 1, 5 do
							if JY.Person["技能"..i] ~= nil and JY.Person["技能"..i] > 0 then
								JY.Person["技能"..i] = nil
							end
						end	
						if WAR.LSZD1[jqid] < 1 then
							WAR.LSZD1[jqid] = nil
						end	
					end	
					--灵蛇拳法领悟
					if WAR.LSQ[jqid] ~= nil and (WAR.FXDS[jqid] == nil or (WAR.FXDS[jqid] ~= nil and WAR.FXDS[jqid] == 0)) then
						local tmppid = WAR.CurID
							WAR.CurID = i
							WarDrawMap(0)
						local str = ""
						local cc = JY.Person[jqid]["中毒程度"] or 0
						local a = math.random(3)
						local x1 = WAR.Person[i]["坐标X"];
						local y1 = WAR.Person[i]["坐标Y"];
						AddPersonAttrib(jqid,"生命",-cc)
						AddPersonAttrib(jqid,"内力",-(cc*10))
						for ex = x1 - 8, x1 + 8 do
							for ey = y1 - 8, y1 + 8 do
								SetWarMap(ex, ey, 4, 1)
								if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
									local ep = GetWarMap(ex, ey, 2)
									if WAR.Person[i]["我方"] ~= WAR.Person[ep]["我方"] then 
										if a == 1 then 
										WAR.LSZD[WAR.Person[ep]["人物编号"]] = 1
										str = "毒血漂橹"
									   elseif a == 2 then 
										WAR.LSZD2[WAR.Person[ep]["人物编号"]] = 1
										str = "毒惑心智"
									   elseif a == 3 then
										WAR.LSZD1[WAR.Person[ep]["人物编号"]] = 10
										str = "毒化本源"
									   end  
									end
								end
							end
						end
						DHdisplay(3185, 3200,"八岐乱世・"..str)
						WAR.CurID=tmppid
						WAR.LSQ[jqid] = nil	
					end
					if WAR.FDLJ1[jqid] ~= nil then
						WAR.FDLJ1[jqid] = WAR.FDLJ1[jqid] -1
						if WAR.FDLJ1[jqid] < 1 then
							WAR.FDLJ1[jqid] = nil
						end
					end	
					if 	WAR.FDLJ2[jqid] ~= nil then
						WAR.FDLJ2[jqid] = WAR.FDLJ2[jqid] -1
						if WAR.FDLJ2[jqid] < 1 then
							WAR.FDLJ2[jqid] = nil
						end
					end	
						
					if WAR.BTSP2[jqid] ~= nil then
						WAR.BTSP2[jqid] = WAR.BTSP2[jqid] - 1
						if WAR.BTSP2[jqid] < 1 and WAR.BTSP1[jqid] ~= nil then
							JY.Person[jqid]["受伤程度"] = (JY.Person[jqid]["受伤程度"] or 0) + WAR.BTSP1[jqid]
							WAR.BTSP2[jqid] = nil
							WAR.BTSP1[jqid] = nil
						end
					end
					--杨家枪
					if wglw1(jqid,68) then
						WAR.HOT[jqid] = (WAR.HOT[jqid] or 0) + 2
						if WAR.HOT[jqid] ~= nil then
							if math.random(10) > 8 then
								WAR.Person[i].Time = WAR.Person[i].Time + 50
								WAR.LQZ[jqid] = (WAR.LQZ[jqid] or 0) + 5
								if WAR.LQZ[jqid] > 100 then
									WAR.LQZ[jqid] = 100
								end	
							end
						end
						if WAR.YQHT[jqid] ~= nil then
							JY.Person[jqid]["受伤程度"] = 0
						end	
					end
					if WAR.YQLYQY[jqid] ~= nil and WAR.FXDS[jqid] == nil then
						local tmppid = WAR.CurID
						WAR.CurID = i
						WarDrawMap(0)
						WAR.MENG[jqid] = 20
						WAR.NHH[jqid] = 1
						AddPersonAttrib(jqid, "内力", -500)
						DHdisplay(2732,2739,"燎原枪焰・焚")
						WAR.YQLYQY[jqid] = nil
						WAR.CurID=tmppid
					end	
					--金蛇剑
					if WAR.JSXD[jqid] ~= nil then
						WAR.JSXD[jqid] = WAR.JSXD[jqid] + 1
						if WAR.LXZT[jqid] ~= nil then
							AddPersonAttrib(jqid,"生命", -2)
						end	
						if WAR.JSXD[jqid] == 11 then
							WAR.LXZT[jqid] = (WAR.LXZT[jqid] or 0) +20
							JY.Person[jqid]["中毒程度"] = (JY.Person[jqid]["中毒程度"] or 0) + 20
							local aa = WAR.LXZT[jqid] or 0
							local bb = JY.Person[jqid]["中毒程度"] or 0
							AddPersonAttrib(jqid,"生命", -((aa+bb)/2))
							for j = 0, WAR.PersonNum-1 do
								local tmppid = WAR.Person[j]["人物编号"]
								if wglw1(tmppid,40) and math.random(10) > 5 then
									WAR.JSHL[tmppid] = (WAR.JSHL[tmppid] or 0) + 5
								end
							end
							WAR.JSXD2[jqid] = (WAR.JSXD2[jqid] or 0) + 1
							if WAR.JSXD2[jqid] ~= nil and WAR.JSXD2[jqid] > 2 then
								if WAR.JSXD2[jqid] == 10 or math.random(10)>8 then
									WAR.JSXD[jqid] = 0
									WAR.JSXD2[jqid] = 0
								end
							end	
						end
						if WAR.JSXD[jqid] > 11 then
							WAR.JSXD[jqid] = 1
						end	
					end	
					--暗香疏影领悟
					if WAR.AXSY1[jqid] ~= nil then
						WAR.AXSY1[jqid] = WAR.AXSY1[jqid] - 1
						if WAR.AXSY1[jqid] < 1 then
							WAR.AXSY1[jqid] = nil
						end
					end

					if WAR.AXSY3[jqid] ~= nil then
						WAR.AXSY3[jqid] = WAR.AXSY3[jqid] - 1
						if WAR.AXSY3[jqid] < 1 then
							WAR.AXSY3[jqid] = nil
						end
					end
					
					--恐惧状态
					if WAR.XSKJ[jqid] ~= nil then
						if WAR.LQZ[jqid] ~= nil and WAR.LQZ[jqid] > 50 then
							WAR.LQZ[jqid] = 50
						end	
						WAR.XSKJ[jqid] = (WAR.XSKJ[jqid] or 0) - 1
						if WAR.XSKJ[jqid] < 1 then
							WAR.XSKJ[jqid] = nil
						end
					end	
					
					if WAR.FDZS[jqid] ~= nil then
						WAR.FDZS[jqid] = WAR.FDZS[jqid] - 1
						if WAR.FDZS[jqid] < 1 then
							WAR.FDZS[jqid] = nil
						end
					end	
					
					if wglw2(jqid,197) and PersonKF(jqid,197) then
						WAR.XYYLW[jqid] = (WAR.XYYLW[jqid] or 0 ) - 1
						local jiu = -1
						for i = 22, 25 do
							if hasthing(i) then
								jiu = i
								break
							end
						end
						if WAR.XYYLW[jqid] ~= nil and WAR.XYYLW[jqid] == 1 then
							local tmppid = WAR.CurID
							WAR.CurID = i
							WarDrawMap(0)
							if jiu == -1 then
								Cls()
								QZXS("没有酒了！")
							else
								addthing(jiu, -1, 1)
								if MPPD(jqid) == 2 then
									WAR.XYYLW[jqid] = 11
								else
									WAR.XYYLW[jqid] = 21
								end	
								WAR.XYYLW1[jqid] = 10
								WAR.XYYLW2[jqid] = (WAR.XYYLW2[jqid] or 0) + 1 
								local hejiu = math.random(3)
								if hejiu == 1 and WAR.XYYLW1[jqid] ~= nil then
									AddPersonAttrib(jqid, "生命", math.random(50,150))
									WAR.XYYLW1[jqid] = WAR.XYYLW1[jqid] - 1
									if WAR.XYYLW1[jqid] < 1 then
										WAR.XYYLW1[jqid] = nil
									end	
									DHdisplay(2318,2336,"逍遥醉步・命")
								elseif hejiu == 2 and WAR.XYYLW1[jqid] ~= nil then
									AddPersonAttrib(jqid, "内力", math.random(100,300))
									WAR.XYYLW1[jqid] = WAR.XYYLW1[jqid] - 1
									if WAR.XYYLW1[jqid] < 1 then
										WAR.XYYLW1[jqid] = nil
									end
									DHdisplay(2318,2336,"逍遥醉步・气")
								elseif hejiu == 3 and WAR.XYYLW1[jqid] ~= nil then
									if JLSD(10, 70, jqid) then
										WAR.Person[i].Time = WAR.Person[i].Time + math.random(30,100) 
									end	
									DHdisplay(2318,2336,"逍遥醉步・速")
									WAR.XYYLW1[jqid] = WAR.XYYLW1[jqid] - 1
									if WAR.XYYLW1[jqid] < 1 then
										WAR.XYYLW1[jqid] = nil
									end
								end	
							end
							WAR.CurID=tmppid
						end
					end	
					
					if MPPD(jqid) == 4 and wglw(jqid,182) and (wglw1(jqid,16) or wglw1(jqid,46)) and WAR.BG[jqid] ~= nil and WAR.WJ[jqid] ~= nil then
						if (WAR.BG[jqid] + WAR.WJ[jqid]) > 600 and JY.Person[jqid]["受伤程度"] ~= nil and JY.Person[jqid]["受伤程度"] > 0 then
							AddPersonAttrib(jqid,"受伤程度", -20)
							if (WAR.BG[jqid] + WAR.WJ[jqid]) > 1200 then
								JY.Person[jqid]["受伤程度"] = 0
							end
						end
					end	
					
					if WAR.KLJZ > 0 then--昆仑刀剑阵效果
						if WAR.KLJZ == 1 then
							if JY.Person[jqid]["内力性质"] == 0 then
								if WAR.KLJZWF[jqid] == 1 then
									if JY.Person[jqid]["生命"] < JY.Person[jqid]["生命最大值"] and math.random(10) > 7 then
										AddPersonAttrib(jqid,"生命",50)
									elseif JY.Person[jqid]["生命"] >= JY.Person[jqid]["生命最大值"]	then
										WAR.LQZ[jqid] = (WAR.LQZ[jqid] or 0) + 1
									end
								end
								if WAR.KLJZDF[jqid] == 1 and math.random(10) > 8 then
									AddPersonAttrib(jqid,"生命",-50)
								end
							elseif JY.Person[jqid]["内力性质"] == 1 then
								if WAR.KLJZWF[jqid] == 1 then
									if JY.Person[jqid]["内力"] < JY.Person[jqid]["内力最大值"] and math.random(10) > 7 then
										AddPersonAttrib(jqid,"内力",300)
									elseif JY.Person[jqid]["内力"] >= JY.Person[jqid]["内力最大值"]	then
										WAR.LQZ[jqid] = (WAR.LQZ[jqid] or 0) + 1
									end
								end
								if WAR.KLJZDF[jqid] == 1 and math.random(10) > 8 then
									AddPersonAttrib(jqid,"内力",-300)
								end
							elseif JY.Person[jqid]["内力性质"] == 2 then
								if WAR.KLJZWF[jqid] == 1 then
									if JY.Person[jqid]["体力"] < 100 and math.random(10) > 7 then
										AddPersonAttrib(jqid,"体力",5)
									elseif JY.Person[jqid]["体力"] >= 100 then
										WAR.LQZ[jqid] = (WAR.LQZ[jqid] or 0) + 1
									end
								end
								if WAR.KLJZDF[jqid] == 1 and math.random(10) > 8 then
									AddPersonAttrib(jqid,"体力",-5)
								end
							end	
						end
						if WAR.KLJZ == 2 then
							if WAR.KLJZWF[jqid] == 2 and math.random(10) > 7 then
								WAR.Person[i].Time = WAR.Person[i].Time + math.random(50,75)
							end
							if WAR.KLJZDF[jqid] == 2 and math.random(10) > 7 then
								WAR.Person[i].Time = WAR.Person[i].Time - math.random(50,75)
							end	
						end
						if WAR.KLJZ == 3 then
							if WAR.KLJZWF[jqid] == 3 then
								if sixi(jqid,2) > 300 and math.random(10) > 7 then
									WAR.QFY2[jqid] = (WAR.QFY2[jqid] or 0) + 10
								end
								if sixi(jqid,3) > 300 and math.random(10) > 7 then
									WAR.QFY3[jqid] = (WAR.QFY3[jqid] or 0) + 10
								end
							end
							if WAR.KLJZDF[jqid] == 3 then
								if (sixi(jqid,2) > 300 and math.random(10) > 7) or math.random(10) > 5 then
									WAR.DEFDOWN[jqid] = (WAR.DEFDOWN[jqid] or 0) + 5
								end
								if (sixi(jqid,3) > 300 and math.random(10) > 7) or math.random(10) > 5 then
									WAR.ATKDOWN[jqid] = (WAR.ATKDOWN[jqid] or 0) + 5
								end
							end
						end
						if WAR.KLJZ == 4 then
							local aa = math.random(2)
							local bb = math.modf(9*math.random(3))
							if WAR.KLJZWF[jqid] == 4 and math.random(10) > 7 then
								if aa == 1 then 
									WAR.HOT[jqid] = (WAR.HOT[jqid] or 0) - bb
								elseif aa == 2 then
									WAR.ICE[jqid] = (WAR.ICE[jqid] or 0) - bb
								end
							end
							if WAR.KLJZDF[jqid] == 4 and math.random(10) > 7 then
								if aa == 1 then 
									WAR.HOT[jqid] = (WAR.HOT[jqid] or 0) + bb
								elseif aa == 2 then
									WAR.ICE[jqid] = (WAR.ICE[jqid] or 0) + bb
								end
							end
						end
						if WAR.KLJZ == 5 then
							if WAR.KLJZWF[jqid] == 5 and math.random(10) > 7 then
								WAR.SPIRIT[jqid] = (WAR.SPIRIT[jqid] or 0) + 0.1
							end
							if WAR.KLJZDF[jqid] == 5 and math.random(10) > 7 then
								WAR.SPIRIT[jqid] = (WAR.SPIRIT[jqid] or 0) - 0.2
							end
						end
					end
					if WAR.KLLY1[jqid] == 1 then
						AddPersonAttrib(jqid,"内力",-50)
						if JY.Person[jqid]["内力"] < 1000 then
							WAR.KLLY1[jqid] = nil
						end
					end	
					if WAR.KLLY2[jqid] ~= nil then
						WAR.KLLY2[jqid] = WAR.KLLY2[jqid] - 1
						if WAR.KLLY2[jqid] < 1 then
							WAR.KLLY2[jqid] = nil
						end
					end	
					--brolycjw: 先天功回血
					if PersonKF(jqid, 100) and WAR.XUEMO[jqid] == nil then
						AddPersonAttrib(jqid, "生命", math.random(0, 3)) 
						if PersonGT(jqid, 100) then
							AddPersonAttrib(jqid, "生命", 3)
						end
						if DT(jqid,129) then
							AddPersonAttrib(jqid, "生命", 3)
						end
					end

					if WAR.bhbm[4000+jqid] ~= nil and WAR.bhbm[4000+jqid] >0 then --八荒八灭
						AddPersonAttrib(jqid, "生命", -10)
						AddPersonAttrib(jqid, "内力", -20)
					end   
			
					--两仪微尘阵	
					if (wglw1(jqid,60) or DT(jqid,166) or (WAR.KLLY1[jqid] == 1)) and PersonKF(jqid,37) and PersonKF(jqid,60) then 
						local x1 = WAR.Person[i]["坐标X"];
						local y1 = WAR.Person[i]["坐标Y"];
						for ex = x1 - 8, x1 + 8 do
							for ey = y1 - 8, y1 + 8 do
								SetWarMap(ex, ey, 4, 1)
								if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
									local ep = GetWarMap(ex, ey, 2)
									local epid = WAR.Person[ep]["人物编号"]
									if WAR.Person[i]["我方"] ~= WAR.Person[ep]["我方"] then 
										if WAR.LYDJLW2[epid] == nil then 
											WAR.LYDJLW2[epid] = 1 
										end 
										if WAR.LYDJLW2[epid] >= 1 then 
											WAR.LYDJLW2[epid] = 1 
										end
										if JLSD(10,42,ep)then
											AddPersonAttrib(epid, "生命", -32)
											AddPersonAttrib(epid, "内力", -80)
										end	
										if WAR.CHZ[epid] == nil then 
											WAR.CHZ[epid] = 5 
										else 
											WAR.CHZ[epid] = WAR.CHZ[epid] + 5
										end 
										if WAR.CHZ[epid] ~= nil and WAR.CHZ[epid] > 50 then 
											WAR.CHZ[epid] = 50 
										end	
										if JY.Person[epid]["生命"] == 0 then
										   WAR.Person[ep]["死亡"] = true
										--   lib.SetWarMap(WAR.Person[ep]["坐标X"], WAR.Person[ep]["坐标Y"], 5, -1)
										  -- lib.SetWarMap(WAR.Person[ep]["坐标X"], WAR.Person[ep]["坐标Y"], 2, -1)							   
										end   
									end
								end
							end
						end
					end
					--弹指玉女劲
					if wglw1(jqid,18) then 
						if WAR.TZQJ8[jqid] ~= nil then
							WAR.TZQJ8[jqid] = WAR.TZQJ8[jqid] - 1
							if WAR.TZQJ8[jqid] < 0 then
								WAR.TZQJ8[jqid] = nil
							end	
							local x1 = WAR.Person[i]["坐标X"];
							local y1 = WAR.Person[i]["坐标Y"];
							local nqhf = 0
							for ex = x1 - 5, x1 + 5 do
								for ey = y1 - 5, y1 + 5 do
									SetWarMap(ex, ey, 4, 1)
									if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
										local ep = GetWarMap(ex, ey, 2)
										local epid = WAR.Person[ep]["人物编号"]
										if WAR.Person[i]["我方"] ~= WAR.Person[ep]["我方"] and JLSD(10,40,epid) then 
											WAR.LQZ[epid] = (WAR.LQZ[epid] or 0) + math.random(3,5)
											nqhf = nqhf + (WAR.LQZ[epid] or 0)
										end
									end
								end
							end
							if nqhf > 300 then nqhf = 300 end
							AddPersonAttrib(jqid,"生命",nqhf)
							AddPersonAttrib(jqid,"体力",math.modf(nqhf/30))
						else
						end
					end
					--天罗地网领悟	
					if PersonKF(jqid,119) and (wglw2(jqid,119) or DT(jqid,59) or DT(jqid,617)) then 
						local x1 = WAR.Person[i]["坐标X"];
						local y1 = WAR.Person[i]["坐标Y"];
						for ex = x1 - 10, x1 + 10 do
							for ey = y1 - 10, y1 + 10 do
								SetWarMap(ex, ey, 4, 1)
								if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
									local ep = GetWarMap(ex, ey, 2)
									if WAR.Person[i]["我方"] ~= WAR.Person[ep]["我方"] then 
										if WAR.TLDW[WAR.Person[ep]["人物编号"]] == nil then 
											WAR.TLDW[WAR.Person[ep]["人物编号"]] = 1 
										end 
										if WAR.TLDW[WAR.Person[ep]["人物编号"]] >= 1 then 
											WAR.TLDW[WAR.Person[ep]["人物编号"]] = 1 
										end  
									end
								end
							end
						end
					end
					--八卦刀领悟	易数值
					if PersonKF(jqid,138) and wglw1(jqid,138) then 
						local x1 = WAR.Person[i]["坐标X"];
						local y1 = WAR.Person[i]["坐标Y"];
						local aa = sixi(jqid,1)+sixi(jqid,2)+sixi(jqid,3)+sixi(jqid,4)+sixi(jqid,5)
						local bb = math.ceil(aa/200)
						if aa > 1000 then aa=1000 end
						for ex = x1 - (3+bb), x1 + (3+bb) do
							for ey = y1 - (3+bb), y1 + (3+bb) do
								SetWarMap(ex, ey, 4, 1)
								if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
									local ep = GetWarMap(ex, ey, 2)
									if WAR.Person[i]["我方"] ~= WAR.Person[ep]["我方"] then 
										if WAR.YXZ[WAR.Person[ep]["人物编号"]] == nil then 
											WAR.YXZ[WAR.Person[ep]["人物编号"]] = 5 
										else 
											WAR.YXZ[WAR.Person[ep]["人物编号"]] = WAR.YXZ[WAR.Person[ep]["人物编号"]] + 5
										end  
										if WAR.YXZ[WAR.Person[ep]["人物编号"]] >= 100 then
											WAR.YXZ[WAR.Person[ep]["人物编号"]] = 100
										end
										if WAR.TJNC[WAR.Person[ep]["人物编号"]] == nil then 
											 WAR.TJNC[WAR.Person[ep]["人物编号"]] = 3
										else
											WAR.TJNC[WAR.Person[ep]["人物编号"]] = 3
										end	
									end
								end
							end
						end
					end
					--化功大法领悟领域
					if PersonKF(jqid,87) and (wglw(jqid,87) or DT(jqid,46) or (DT(jqid,2) and JX(jqid))) then
						local x1 = WAR.Person[i]["坐标X"];
						local y1 = WAR.Person[i]["坐标Y"];
						local aa = math.modf(JY.Person[jqid]["用毒能力"]/50)
						for ex = x1 - aa, x1 + aa do
							for ey = y1 - aa, y1 + aa do
								SetWarMap(ex, ey, 4, 1)
								if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
									local ep = GetWarMap(ex, ey, 2)
									if WAR.Person[i]["我方"] ~= WAR.Person[ep]["我方"] and JY.Person[WAR.Person[ep]["人物编号"]]["中毒程度"] ~= nil then
										if math.random(10) > 3 then
											AddPersonAttrib(WAR.Person[ep]["人物编号"], "内力", -(JY.Person[WAR.Person[ep]["人物编号"]]["中毒程度"]*2))
											if JY.Person[WAR.Person[ep]["人物编号"]]["内力"] < 0 then
												JY.Person[WAR.Person[ep]["人物编号"]]["内力"] = 0
											end
										end
									end
								end
							end
						end
					end	
					--灵蛇杖法领悟
					if PersonKF(jqid,120) and (wglw1(jqid,120) or ((DT(jqid,60) or DT(jqid,620)) and JX(jqid))) then --(wglw1(jqid,120) or DT(jqid,60) or DT(jqid,620))
						local x1 = WAR.Person[i]["坐标X"];
						local y1 = WAR.Person[i]["坐标Y"];
						local aa = math.modf(JY.Person[jqid]["用毒能力"]/100) + math.modf(sixi(jqid,4)/100)
						for ex = x1 - aa, x1 + aa do
							for ey = y1 - aa, y1 + aa do
								SetWarMap(ex, ey, 4, 1)
								if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
									local ep = GetWarMap(ex, ey, 2)
									local tmppid = WAR.Person[ep]["人物编号"]
									if WAR.Person[i]["我方"] ~= WAR.Person[ep]["我方"] then
										if math.random(10) > 3 then
											AddPersonAttrib(tmppid, "中毒程度", 10)
										end	
										if WAR.LSZD[tmppid] == nil and JY.Person[tmppid]["中毒程度"] ~= nil  and JY.Person[tmppid]["中毒程度"] > 20 then
											if math.random(3) == 1 then
												WAR.LSZD[tmppid] = 1 --出血毒
											elseif	math.random(3) == 2 then
												WAR.LSZD2[tmppid] = 1 --神经毒
											else
												WAR.LSZD1[tmppid] = 10 --基因毒
											end
										end	
										if JY.Person[tmppid]["中毒程度"] ~= nil  and JY.Person[tmppid]["中毒程度"] == 100 then
											WAR.POISON[tmppid] = 5
										end	
									end
								end		
							end				
						end
					end
					--摘星功领悟
					if WAR.ZXGLW[jqid] ~= nil and WAR.ZXGLW1[jqid] ~= nil then 
						local tmppid = WAR.CurID
						WAR.ZXGLW1[jqid] = WAR.ZXGLW1[jqid] - 1
						if WAR.ZXGLW1[jqid] == 1 then
							if WAR.ZXGLW[jqid] == 1 then
								WAR.CurID = i
								WarDrawMap(0)
								WAR.ZXGLW[jqid] = nil
								WAR.ZXGLW1[jqid] = nil
								AddPersonAttrib(jqid, "生命", -50)
								AddPersonAttrib(jqid, "中毒程度", 50)
								if math.random(10) > 5 then
									WAR.QSLZ[jqid] = 1
								end	
								DHdisplay(890,909,"紫气天罗")
								WAR.CurID=tmppid
								local x1 = WAR.Person[i]["坐标X"];
								local y1 = WAR.Person[i]["坐标Y"];
								local aa = 6
								local cc = JY.Person[jqid]["中毒程度"] or 0
								for ex = x1 - aa, x1 + aa do
									for ey = y1 - aa, y1 + aa do
										SetWarMap(ex, ey, 4, 1)
										if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
											local ep = GetWarMap(ex, ey, 2)
											local zxid = WAR.Person[ep]["人物编号"]
											if WAR.Person[i]["我方"] == WAR.Person[ep]["我方"] then
												AddPersonAttrib(zxid, "中毒程度", 50)
												AddPersonAttrib(zxid, "生命", -math.modf(2*cc))
												if JY.Person[zxid]["生命"] < 2 and WAR.ZXGLW[zxid] == nil and WAR.ZXGLW1[zxid] == nil then
													WAR.ZXGLW[zxid] = 1
													WAR.ZXGLW1[zxid] = 1
												end	
											end
										end		
									end				
								end
							else
								WAR.CurID = i
								WarDrawMap(0)
								WAR.ZXGLW1[jqid] = 11
								WAR.ZXGLW[jqid] = WAR.ZXGLW[jqid] - 1
								AddPersonAttrib(jqid, "生命", -50)
								AddPersonAttrib(jqid, "中毒程度", 50)
								if math.random(10) > 5 then
									WAR.QSLZ[jqid] = 1
								end	
								DHdisplay(890,909,"毒爆天星")
								WAR.CurID=tmppid	
							end
						end
					end	
					
					
					--豸苗：谢云流剑气无形
					if XYL(jqid) and juexing() > 2 and JY.Person[jqid]["声望"] == 180 then
						local x1 = WAR.Person[i]["坐标X"];
						local y1 = WAR.Person[i]["坐标Y"];
						for ex = x1 - 8, x1 + 8 do
							for ey = y1 - 8, y1 + 8 do
								SetWarMap(ex, ey, 4, 1)
								if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
									local ep = GetWarMap(ex, ey, 2)
									if WAR.Person[i]["我方"] ~= WAR.Person[ep]["我方"] then
										AddPersonAttrib(WAR.Person[ep]["人物编号"], "生命", -8)
										if JY.Person[WAR.Person[ep]["人物编号"]]["生命"] == 0 then
										   WAR.Person[ep]["死亡"] = true
										--   lib.SetWarMap(WAR.Person[ep]["坐标X"], WAR.Person[ep]["坐标Y"], 5, -1)
										  -- lib.SetWarMap(WAR.Person[ep]["坐标X"], WAR.Person[ep]["坐标Y"], 2, -1)							   
										end   
									end
								end
							end
						end
					end
					if WAR.ZSWQ[jqid] ~= nil and WAR.ZSWQ[jqid] > 0 then	--谢无悠
					 WAR.ZSWQ[jqid] = WAR.ZSWQ[jqid] - 1
					 if WAR.ZSWQ[jqid] <= 0 then 
						WAR.ZSWQ[jqid] = nil 
					 end 
					 if jtyl(jqid) then 
						WAR.ZSWQ[jqid] = nil 
					 end 
						local x1 = WAR.Person[i]["坐标X"];
						local y1 = WAR.Person[i]["坐标Y"];
						for ex = x1 - 8, x1 + 8 do
							for ey = y1 - 8, y1 + 8 do
								SetWarMap(ex, ey, 4, 1)
								if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
									local ep = GetWarMap(ex, ey, 2)
									if WAR.Person[i]["我方"] == WAR.Person[ep]["我方"] then
										AddPersonAttrib(WAR.Person[ep]["人物编号"], "生命", -20)
										if JY.Person[WAR.Person[ep]["人物编号"]]["生命"] == 0 then
										   WAR.Person[ep]["死亡"] = true
										--   lib.SetWarMap(WAR.Person[ep]["坐标X"], WAR.Person[ep]["坐标Y"], 5, -1)
										--   lib.SetWarMap(WAR.Person[ep]["坐标X"], WAR.Person[ep]["坐标Y"], 2, -1)							   
										end   
									end
								end
							end
						end
					end
					  --吸星大法万象吸引
					  if jqid ==0 and GetS(111,0,0,0) == 88 and WAR.WXXY == 1 then
							local x1 = WAR.Person[i]["坐标X"];
							local y1 = WAR.Person[i]["坐标Y"];
							for ex = x1 - 10, x1 + 10 do
								for ey = y1 - 10, y1 + 10 do
									SetWarMap(ex, ey, 4, 1)
									if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
										local ep = GetWarMap(ex, ey, 2)
										local xxrs = 0
										if WAR.Person[ep]["我方"] ~= WAR.Person[i]["我方"] then
											xxrs = xxrs + 1
											if WAR.LXZT[WAR.Person[ep]["人物编号"]] ~= nil and WAR.LXZT[WAR.Person[ep]["人物编号"]] > 0 then 
											AddPersonAttrib(WAR.Person[ep]["人物编号"], "生命", -5)
											end
											AddPersonAttrib(WAR.Person[ep]["人物编号"], "内力", -10)
											AddPersonAttrib(jqid, "内力", 10*xxrs)
											if JY.Person[WAR.Person[ep]["人物编号"]]["生命"] == 0 then
											   WAR.Person[ep]["死亡"] = true
											--   lib.SetWarMap(WAR.Person[ep]["坐标X"], WAR.Person[ep]["坐标Y"], 5, -1)
											 --  lib.SetWarMap(WAR.Person[ep]["坐标X"], WAR.Person[ep]["坐标Y"], 2, -1)							   
											end   
										end
									end
								end
							end
					  end
					--1-10-寒冰真气
					  if WAR.HBZQ[jqid] ~= nil and WAR.HBZQ[jqid] > 0 then
						 WAR.HBZQ[jqid] = WAR.HBZQ[jqid] -1
						 if WAR.HBZQ[jqid] <= 0 then 
							WAR.HBZQ[jqid] = nil
						 end
						 if WAR.HBZQ[jqid] == 1 then 
							WAR.HBZQ1[jqid] = 20
						 end
							if WAR.ICE[WAR.Person[i]["人物编号"]] == nil then 
								WAR.ICE[WAR.Person[i]["人物编号"]] = 2 
							else 
								WAR.ICE[WAR.Person[i]["人物编号"]] = WAR.ICE[WAR.Person[i]["人物编号"]] + 2
							end 
							local x1 = WAR.Person[i]["坐标X"];
							local y1 = WAR.Person[i]["坐标Y"];
							for ex = x1 - 8, x1 + 8 do
								for ey = y1 - 8, y1 + 8 do
									SetWarMap(ex, ey, 4, 1)
									if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
										local ep = GetWarMap(ex, ey, 2)
										if WAR.Person[i]["我方"] == WAR.Person[ep]["我方"] then
											if WAR.ICE[WAR.Person[ep]["人物编号"]] == nil then 
											   WAR.ICE[WAR.Person[ep]["人物编号"]] = 2 
											else 
											   WAR.ICE[WAR.Person[ep]["人物编号"]] = WAR.ICE[WAR.Person[ep]["人物编号"]] + 2
											end 
											if WAR.ICE[WAR.Person[ep]["人物编号"]] > 100 then WAR.ICE[WAR.Person[ep]["人物编号"]] = 100 end
											
											if WAR.HBZQ[WAR.Person[ep]["人物编号"]] == nil then
											   WAR.HBZQ2[WAR.Person[ep]["人物编号"]] = nil 
											elseif WAR.HBZQ[WAR.Person[ep]["人物编号"]] ~= nil and WAR.HBZQ[WAR.Person[ep]["人物编号"]] > 0 and WAR.HBZQ1[WAR.Person[ep]["人物编号"]] == nil then
											  if WAR.HBZQ2[WAR.Person[ep]["人物编号"]] == nil then 
											   WAR.HBZQ2[WAR.Person[ep]["人物编号"]] = 1
											  else   
											   WAR.HBZQ2[WAR.Person[ep]["人物编号"]] = WAR.HBZQ2[WAR.Person[ep]["人物编号"]] + 1
											  end 
											  if WAR.HBZQ2[WAR.Person[ep]["人物编号"]] == 30 then 
											   WAR.HBZQ1[WAR.Person[ep]["人物编号"]] = 20
											   WAR.HBZQ2[WAR.Person[ep]["人物编号"]] = nil
											   WAR.HBZQ[WAR.Person[ep]["人物编号"]] = nil
											  end   
											end
										end
									end
								end
							end
					  end
					--黄沙万里鞭折戟沉沙特效
					  if WAR.HSWLB[jqid] ~= nil and WAR.HSWLB[jqid] > 0 then
						 WAR.HSWLB[jqid] = WAR.HSWLB[jqid] -1
							if WAR.HSWLB[jqid] <= 0 then 
								WAR.HSWLB[jqid] = nil
							end
							if JLSD(10,60,jqid) then
								AddPersonAttrib(jqid, "生命", -15)
							end
							if JLSD(10,30,jqid) then
								AddPersonAttrib(jqid, "体力", -3)
								if JY.Person[jqid]["体力"] <= 9 then
									JY.Person[jqid]["体力"] = 9 
								end
							end	
							if WAR.CHZ[WAR.Person[i]["人物编号"]] == nil then 
								WAR.CHZ[WAR.Person[i]["人物编号"]] = 20 
							else 
								WAR.CHZ[WAR.Person[i]["人物编号"]] = WAR.CHZ[WAR.Person[i]["人物编号"]] + 2
							end 
							local x1 = WAR.Person[i]["坐标X"];
							local y1 = WAR.Person[i]["坐标Y"];
							for ex = x1 - 3, x1 + 3 do
								for ey = y1 - 3, y1 + 3 do
									SetWarMap(ex, ey, 4, 1)
									if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
										local ep = GetWarMap(ex, ey, 2)
										if WAR.Person[i]["我方"] == WAR.Person[ep]["我方"] then
											if WAR.CHZ[WAR.Person[ep]["人物编号"]] == nil then 
											   WAR.CHZ[WAR.Person[ep]["人物编号"]] = 2 
											else 
											   WAR.CHZ[WAR.Person[ep]["人物编号"]] = WAR.CHZ[WAR.Person[ep]["人物编号"]] + 1
											end 
											if WAR.CHZ[WAR.Person[ep]["人物编号"]] > 50 then WAR.CHZ[WAR.Person[ep]["人物编号"]] = 50 end
											
											if JLSD(10,40,ep)then
												AddPersonAttrib(WAR.Person[ep]["人物编号"], "生命", -20)
											end
										end
									end
								end
							end
					  end
					if WAR.SSTG[jqid] == 1 then
						for j = 0,WAR.PersonNum-1 do
							local n = 0
							if WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false then
								if JY.Person[WAR.Person[j]["人物编号"]]["生命"] < JY.Person[WAR.Person[j]["人物编号"]]["生命最大值"] then
									n = n + 1
								end   
								AddPersonAttrib(WAR.Person[j]["人物编号"], "生命", 15)
								AddPersonAttrib(WAR.Person[i]["人物编号"], "生命", -15*n)
								if JY.Person[WAR.Person[i]["人物编号"]]["生命"] == 0 then
								   WAR.Person[i]["死亡"] = true
								--   lib.SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 5, -1)
								 --  lib.SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 2, -1)							   
								end				
							end
						end
					end
					--冰封状态减内
					if DT(jqid,48) and JX(jqid) then
						if WAR.ICE[jqid] ~= nil then
							WAR.ICE[jqid] = WAR.ICE[jqid] - 0
							AddPersonAttrib(jqid, "内力", 30)
							if WAR.ICE[jqid] > 100 then
								WAR.ICE[jqid] = 100 
							end
						end
					else	
						if WAR.ICE[jqid] ~= nil then  --冰封恢复，如果集气人物id的冰封值不为空
							if WAR.ICE[jqid] > 50 then --17-2-12--
								if WAR.KLJZ == 4 then
									if inteam(jqid) then
										WAR.ICE[jqid] = 50 
									else	
										if WAR.ICE[jqid] > 99 then
											WAR.ICE[jqid] = 99
										end
									end	
								else
								WAR.ICE[jqid] = 50 
								end
							end
							local aa=1
							local bb=1
							if JY.Person[jqid]["受伤程度"]>=50 and JY.Person[jqid]["受伤程度"]<100 then
								aa=2
							elseif JY.Person[jqid]["受伤程度"]>=100 then
								aa=3
							else
								aa=1
							end	
						if WAR.HOT[jqid] ~= nil and WAR.HOT[jqid] > 0 then  --冰封恢复，如果集气人物id的冰封值不为空
							bb=2
						end
						if wglw(jqid,121) or (DT(jqid,59) and PersonKF(jqid,121)) or (DT(jqid,601) ) then --17-3-3-玉女经
						   AddPersonAttrib(jqid, "生命", 10)
						   AddPersonAttrib(jqid, "内力", 20)
						elseif wglw1(jqid,176) or (DT(jqid,49) and PersonKF(jqid,176)) or DT(jqid,116) then --17-3-3-玉女经
						   AddPersonAttrib(jqid, "内力", 30)
						else	
						if wglw(jqid,178) or (DT(jqid,69) and PersonGT(jqid,178)) or T9ZY(jqid) or DT(jqid,602) then --九龙功
						  JY.Person[jqid]["内力"] = JY.Person[jqid]["内力"] + ((math.random(1,5) + math.modf(JY.Person[jqid]["受伤程度"] / 5*aa))*bb) 
						else 
						  JY.Person[jqid]["内力"] = JY.Person[jqid]["内力"] - ((math.random(1,5) + math.modf(JY.Person[jqid]["受伤程度"] / 5*aa))*bb) 
						end	  
						  if WAR.ICE[jqid] > 30 then
							if wglw(jqid,178) or (DT(jqid,69) and PersonGT(jqid,178)) or T9ZY(jqid) or DT(jqid,602) then --九龙功
							   JY.Person[jqid]["内力"] = JY.Person[jqid]["内力"] + ((math.random(6,10) + math.modf(JY.Person[jqid]["受伤程度"] / 5*aa))*bb)  
							else 
							   JY.Person[jqid]["内力"] = JY.Person[jqid]["内力"] - ((math.random(6,10) + math.modf(JY.Person[jqid]["受伤程度"] / 5*aa))*bb)  
							end
						  end
						end  
						
						if wglw(jqid,182) or (DT(jqid,5) and PersonGT(jqid,182)) then 
							JY.Person[jqid]["内力"] = JY.Person[jqid]["内力"] + (math.random(1,5) + math.modf(JY.Person[jqid]["受伤程度"] / 5*2))
						else 
							JY.Person[jqid]["内力"] = JY.Person[jqid]["内力"] - (math.random(1,5) + math.modf(JY.Person[jqid]["受伤程度"] / 5*2)) 
						end	  
						if WAR.ICE[jqid] > 30 then
							if wglw(jqid,182) or (DT(jqid,5) and PersonGT(jqid,182)) then 
							   JY.Person[jqid]["内力"] = JY.Person[jqid]["内力"] + (math.random(6,10) + math.modf(JY.Person[jqid]["受伤程度"] / 5*2))  
							else 
							   JY.Person[jqid]["内力"] = JY.Person[jqid]["内力"] - (math.random(6,10) + math.modf(JY.Person[jqid]["受伤程度"] / 5*2))  
							end
						end 		
							WAR.ICE[jqid] = WAR.ICE[jqid] - 1
							if PersonKF(jqid, 106) then
								WAR.ICE[jqid] = WAR.ICE[jqid] - 1
							end
							if PersonKF(jqid,108) then
								WAR.ICE[jqid] = WAR.ICE[jqid] - 1
							end
							if PersonGT(jqid, 99) then
								WAR.ICE[jqid] = WAR.ICE[jqid] - 1
							end
							if PersonGT(jqid,106) then
								WAR.ICE[jqid] = WAR.ICE[jqid] - 1
							end
							if PersonGT(jqid,152) then
								WAR.ICE[jqid] = WAR.ICE[jqid] - 1
							end
							if hasTF(jqid, 134) or WAR.KHZJ[jqid] ~= nil or WAR.JYHT[jqid] ~= nil then--17-2-8
								WAR.ICE[jqid] = 0
							end
							if JY.Person[jqid]["防具"] == 63 then  --皮衣时序回冰封2点
								WAR.ICE[jqid] = WAR.ICE[jqid] - 10
							end
							if T2SQ(jqid) and juexing() > 1 then
								WAR.ICE[jqid] = 0
							end
							if wglw(jqid, 99) or DT(jqid,5) then--17-2-8
								WAR.ICE[jqid] = 0
							end
							if jtyl(jqid) then --谢无悠
								WAR.ICE[jqid] = 0
							end
							if wglw1(jqid,48) and WAR.LQZ[jqid] ~= nil and WAR.LQZ[jqid] >= 100 then
								WAR.ICE[jqid] = 0
							end	
							if WAR.ICE[jqid] <= 0 then
							WAR.ICE[jqid] = nil
							end
						end				
					end	
			
					--主角医生回生，减内伤，减中毒
					if jqid == 0 and putong() == 7 then
					  AddPersonAttrib(jqid, "生命", 1)
					  if JLSD(25, 75, jqid) then
						AddPersonAttrib(jqid, "受伤程度", -1)
					  end
					  AddPersonAttrib(jqid, "中毒程度", -1)
					end
					
					if WAR.DWLZ[jqid] ~= nil then
						if JY.Person[jqid]["生命"] < 100 then
							WAR.DWLZ[jqid] = nil 
						end
					end	
			
					--流血状态  
					if WAR.LXZT[jqid] ~= nil then
					  local aa=1
						if WAR.HOT[jqid]~=nil and WAR.HOT[jqid]>0 then
							 if WAR.HOT[jqid]<20 then
							 aa=2
							 else
							 aa=3
							 end
						end
						if PersonKF(jqid,191) then
							if aa >= 1 then 
								if wglw2(jqid,191) then
									aa = 0
								else	
									aa = 0.5 
								end
							end	
							if WAR.LXZT[jqid] > 0 then
								WAR.LXZT[jqid] = WAR.LXZT[jqid] + 0.5
							end
						end
						if inteam(jqid) then
							if wglw1(jqid,63) then
								JY.Person[jqid]["生命"] = JY.Person[jqid]["生命"] + (math.random(3)*aa)
								if  JY.Person[jqid]["受伤程度"] > 0 then
									JY.Person[jqid]["受伤程度"] = JY.Person[jqid]["受伤程度"] - aa
									if  JY.Person[jqid]["受伤程度"]<= 0 then
										JY.Person[jqid]["受伤程度"]=0
									end
								end
							elseif jqid==0 and putong() == 9 then
								JY.Person[jqid]["生命"] = JY.Person[jqid]["生命"] - (math.random(3)*aa)
							elseif  wglw(jqid,178) or (DT(jqid,69) and PersonKF(jqid,178)) or T9ZY(jqid) or DT(jqid,602) then --九龙功	
								JY.Person[jqid]["生命"] = JY.Person[jqid]["生命"] + ((math.random(3)+ math.modf(JY.Person[jqid]["受伤程度"] / 10))*aa)
							elseif  wglw(jqid,182) or (DT(jqid,5) and PersonGT(jqid,182)) then 
								JY.Person[jqid]["生命"] = JY.Person[jqid]["生命"] + (math.random(3)+ math.modf(JY.Person[jqid]["受伤程度"] / 10))	
							elseif WAR.DWLZ[jqid] ~= nil then
								JY.Person[jqid]["生命"] = JY.Person[jqid]["生命"] - ((math.random(3)+ math.modf(JY.Person[jqid]["受伤程度"] / 10))*aa*math.random(3))
							else
								JY.Person[jqid]["生命"] = JY.Person[jqid]["生命"] - ((math.random(3)+ math.modf(JY.Person[jqid]["受伤程度"] / 10))*aa)
							end
						elseif WAR.NS[jqid] ~= nil then 
							WAR.LXZT[jqid] = 100 
							JY.Person[jqid]["生命"] = JY.Person[jqid]["生命"] - ((math.random(3)+ math.modf(JY.Person[jqid]["受伤程度"] / 10))*aa)
						else
							 if wglw(jqid,178) or (DT(jqid,69) and PersonKF(jqid,178)) or T9ZY(jqid) or DT(jqid,602) then --九龙功
							 JY.Person[jqid]["生命"] = JY.Person[jqid]["生命"] +  ((1+ math.modf(JY.Person[jqid]["受伤程度"] / 10))*aa)
							 else
							 JY.Person[jqid]["生命"] = JY.Person[jqid]["生命"] -  ((1+ math.modf(JY.Person[jqid]["受伤程度"] / 10))*aa)
							 end
							 if wglw(jqid,182) or (DT(jqid,5) and PersonGT(jqid,182)) then 
								JY.Person[jqid]["生命"] = JY.Person[jqid]["生命"] +  (1+ math.modf(JY.Person[jqid]["受伤程度"] / 10))
							 else
								JY.Person[jqid]["生命"] = JY.Person[jqid]["生命"] -  (1+ math.modf(JY.Person[jqid]["受伤程度"] / 10))
							 end
							 if WAR.DWLZ[jqid] ~= nil then
								JY.Person[jqid]["生命"] = JY.Person[jqid]["生命"] - ((math.random(3)+ math.modf(JY.Person[jqid]["受伤程度"] / 10))*aa*math.random(3)) 
							end	
						end
						if JY.Person[jqid]["生命"] < 1 then
							JY.Person[jqid]["生命"] = 1
						end
						WAR.LXZT[jqid] = WAR.LXZT[jqid] - 1
						if PersonKF(jqid, 108) then	--brolycjw: 易筋经回流血 九阴主功体回流血
							WAR.LXZT[jqid] = WAR.LXZT[jqid] - 1
						end
						if PersonGT(jqid, 107) then	
							WAR.LXZT[jqid] = WAR.LXZT[jqid] - 1
						end		  
						if PersonKF(jqid, 187) then	 --少林九阳功
							WAR.LXZT[jqid] = WAR.LXZT[jqid] - 1
							if PersonGT(jqid, 187) then	
								WAR.LXZT[jqid] = WAR.LXZT[jqid] - 2
							end	
						end		
						if PersonGT(jqid, 96) then --罗汉伏魔功几率回流血
							if JLSD(10, 60, jqid) then
								WAR.LXZT[jqid] = WAR.LXZT[jqid] - 1
							end
						elseif PersonKF(jqid, 96) then 
							if JLSD(10, 30, jqid) then
								WAR.LXZT[jqid] = WAR.LXZT[jqid] - 1
							end			
						end
						if JY.Person[jqid]["防具"] == 62 then	--佛心甲时序回流血2点
							WAR.LXZT[jqid] = WAR.LXZT[jqid] - 10
						end
						if hasTF(jqid, 134) or WAR.KHZJ[jqid] ~= nil or WAR.JYHT[jqid] ~= nil then--17-2-8
							WAR.LXZT[jqid] = 0
						end	
						if T2SQ(jqid) and juexing() > 1 then
							WAR.LXZT[jqid] = 0
						end	
						if jtyl(jqid) then --谢无悠
							WAR.LXZT[jqid] = 0
						end		  
						if wglw1(jqid,48) and WAR.LQZ[jqid] ~= nil and WAR.LQZ[jqid] >= 100 then
							WAR.LXZT[jqid] = 0
						end	
						if WAR.LXZT[jqid] < 1 then
							WAR.LXZT[jqid] = nil
						end
					end
			
					--brolycjw: 易筋经,九阳主功体 回复内伤		
					if PersonGT(jqid, 108) and JY.Person[jqid]["受伤程度"] > 0 and JY.Person[jqid]["受伤程度"] ~= nil then
						AddPersonAttrib(jqid, "受伤程度", -1)
					elseif PersonKF(jqid, 108) then			
						if JY.Person[jqid]["受伤程度"] > 70 and JLSD(30, 70, jqid) then
							AddPersonAttrib(jqid, "受伤程度", -1)
						elseif JY.Person[jqid]["受伤程度"] > 40 and JLSD(15, 85, jqid) then
							AddPersonAttrib(jqid, "受伤程度", -1)
						else
							AddPersonAttrib(jqid, "受伤程度", -1)
						end
					end
					if PersonGT(jqid, 106) and JY.Person[jqid]["受伤程度"] > 0 and JY.Person[jqid]["受伤程度"] ~= nil then			
						if JY.Person[jqid]["受伤程度"] > 70 and JLSD(30, 70, jqid) then
							AddPersonAttrib(jqid, "受伤程度", -1)
						elseif JY.Person[jqid]["受伤程度"] > 40 and JLSD(15, 85, jqid) then
							AddPersonAttrib(jqid, "受伤程度", -1)
						else
							AddPersonAttrib(jqid, "受伤程度", -1)
						end
					end

					if PersonKF(jqid, 89) then --紫霞1/5恢复内伤
						if JLSD(10, 30, jqid) or (PersonGT(jqid, 89) and JLSD(10, 60, jqid)) then
							if JY.Person[jqid]["受伤程度"] <= 50 then
								AddPersonAttrib(jqid, "受伤程度", -1)
							elseif JLSD(10, 60, jqid) or PersonGT(jqid, 89) then
								AddPersonAttrib(jqid, "受伤程度", -1)
							end
						end		
					end

					--洗髓经时序清内伤
					if PersonKF(jqid,183) then	
						AddPersonAttrib(jqid,"受伤程度", -10)
						if PersonGT(jqid,183) then	
							AddPersonAttrib(jqid,"受伤程度", -15)	
						end
					end 
					
					--纯阳  回复中毒 1/2几率 主功体必回复
					if PersonKF(jqid, 99)  then
						if wglw1(jqid,18) and WAR.TZQJ2[jqid] ~= nil then
							AddPersonAttrib(jqid, "中毒程度", -10)
							WAR.TZQJ2[jqid] = WAR.TZQJ2[jqid] - 1
							if WAR.TZQJ2[jqid] < 1 then
								WAR.TZQJ2[jqid] = nil
							end	
						end	
						if JY.Person[jqid]["中毒程度"] > 0 and  PersonGT(jqid, 99) then
							AddPersonAttrib(jqid, "中毒程度", -1)
						elseif JY.Person[jqid]["中毒程度"] > 0 and JLSD(10, 60, jqid) then
							AddPersonAttrib(jqid, "中毒程度", -1)
						end
					end
					
					--太极神功几乎免毒
					if PersonKF(jqid,182) then	
						AddPersonAttrib(jqid,"中毒程度", -50)
						if PersonGT(jqid,182) then	
							AddPersonAttrib(jqid,"中毒程度", -100)	
						end
					end 		
					
					--洗髓经时序清毒
					if PersonKF(jqid,183) then	
						AddPersonAttrib(jqid,"中毒程度", -10)
						if PersonGT(jqid,183) then	
							AddPersonAttrib(jqid,"中毒程度", -15)	
						end
					end 		
					
					--瑜伽密乘时序清毒
					if PersonKF(jqid,184) then	
						AddPersonAttrib(jqid,"中毒程度", -20)
						if PersonGT(jqid,184) then	
							AddPersonAttrib(jqid,"中毒程度", -25)	
						end
					end 		
					
					if MPPD(jqid) == 8 and PersonGT(jqid, 95) then--白驼山化毒为愈
						if JY.Person[jqid]["中毒程度"] >0 then
						local aa=math.modf(JY.Person[jqid]["中毒程度"] / 25)
						AddPersonAttrib(jqid, "中毒程度", -1)
						AddPersonAttrib(jqid, "生命", aa*MPDJ(jqid))
						if JY.Person[jqid]["受伤程度"] > 0 then
						AddPersonAttrib(jqid, "受伤程度", -aa)
						end
						end
					end
					
					if MPPD(jqid) == 8 and PersonGT(jqid,95) and JLSD(10,40,jqid) then --白驼山主运蛤蟆功时序涨怒 
						if WAR.LQZ[jqid] == nil then
							WAR.LQZ[jqid] = 1
						elseif WAR.LQZ[jqid] < 100 then
							WAR.LQZ[jqid] = WAR.LQZ[jqid] + 5
						elseif WAR.LQZ[jqid] > 100 then
							WAR.LQZ[jqid] = 100
						end
					end	

					if wglw(jqid,185) or (PersonGT(jqid,185) and DT(jqid,5)) and JLSD(10,40,jqid) or DT(jqid,666) then --武当九阳
						if WAR.LQZ[jqid] == nil then
							WAR.LQZ[jqid] = 1
						elseif WAR.LQZ[jqid] < 100 then
							WAR.LQZ[jqid] = WAR.LQZ[jqid] + 1
						elseif WAR.LQZ[jqid] > 100 then
							WAR.LQZ[jqid] = 100
						end
					end 	

					if DT(jqid,585) then   --小二
						if WAR.LQZ[jqid] == nil then
							WAR.LQZ[jqid] = 1
						elseif WAR.LQZ[jqid] < 100 then
							WAR.LQZ[jqid] = WAR.LQZ[jqid] + 1
						elseif WAR.LQZ[jqid] > 100 then
							WAR.LQZ[jqid] = 100
						end
					end 	
						

					if PersonKF(jqid,186) and JLSD(10,40,jqid) then --峨眉九阳功
						if WAR.LQZ[jqid] == nil then
							WAR.LQZ[jqid] = 1
						elseif WAR.LQZ[jqid] < 100 then
							WAR.LQZ[jqid] = WAR.LQZ[jqid] + 1
						elseif WAR.LQZ[jqid] > 100 then
							WAR.LQZ[jqid] = 100
						end
						if PersonGT(jqid,186)and JLSD(10,40,jqid) then
							if WAR.LQZ[jqid] == nil then
								WAR.LQZ[jqid] = 1
							elseif WAR.LQZ[jqid] < 100 then
								WAR.LQZ[jqid] = WAR.LQZ[jqid] + 2
							elseif WAR.LQZ[jqid] > 100 then
								WAR.LQZ[jqid] = 100
							end	
						end
					end			

					--胡刀苍龙破涨怒
					if (wglw1(jqid,67) or (DT(jqid, 1) and JX(jqid)) or (DT(jqid, 621) and JX(jqid))) and WAR.QLP ~= nil and JLSD(10,60,jqid) then
						if WAR.LQZ[jqid] == nil then
							WAR.LQZ[jqid] = 1
						elseif WAR.LQZ[jqid] < 100 then
							WAR.LQZ[jqid] = WAR.LQZ[jqid] + 3
						elseif WAR.LQZ[jqid] > 100 then
							WAR.LQZ[jqid] = 100
						end
						if WAR.SPIRIT[jqid] ~= nil and JLSD(10,45,jqid) and WAR.QLP > 5 then
							WAR.SPIRIT[jqid] = WAR.SPIRIT[jqid] + 1
							if WAR.SPIRIT >= 140 then
								WAR.SPIRIT[jqid] = WAR.SPIRIT[jqid] + 0
							end
						end	
					end	
					
					if wglw1(jqid,8) and JLSD(10,60,jqid) then --天山六阳掌时序涨怒
						if WAR.LQZ[jqid] == nil then
							WAR.LQZ[jqid] = 1
						elseif WAR.LQZ[jqid] < 100 then
							WAR.LQZ[jqid] = WAR.LQZ[jqid] + 5
						elseif WAR.LQZ[jqid] > 100 then
							WAR.LQZ[jqid] = 100
						end
					end	
					
					if wglw(jqid,184) and PersonGT(jqid,184) or DT(jqid,665) then --瑜伽密乘时序涨怒 
						if WAR.LQZ[jqid] == nil then
							WAR.LQZ[jqid] = 1
						elseif WAR.LQZ[jqid] < 100 then
							WAR.LQZ[jqid] = WAR.LQZ[jqid] + 2
						elseif WAR.LQZ[jqid] > 100 then
							WAR.LQZ[jqid] = 100
						end
					end			
					
					if T2SQ(jqid) and JLSD(10,60,jqid) and juexing() > 0 then 
						if WAR.LQZ[jqid] == nil then
							WAR.LQZ[jqid] = 1
						elseif WAR.LQZ[jqid] < 100 then
							WAR.LQZ[jqid] = WAR.LQZ[jqid] + 4
						elseif WAR.LQZ[jqid] > 100 then
							WAR.LQZ[jqid] = 100
						end
					end	  
					
					if DT(jqid,583) then
						if WAR.LQZ[jqid] == nil then
							WAR.LQZ[jqid] = 1
						elseif WAR.LQZ[jqid] < 100 then
							WAR.LQZ[jqid] = WAR.LQZ[jqid] + 4
						elseif WAR.LQZ[jqid] > 100 then
							WAR.LQZ[jqid] = 100
						end
					end		
					
					if DT(jqid,48) and JX(jqid) and JLSD(10,70,jqid) then --游坦之觉醒时序涨自身冰封值
						if WAR.ICE[jqid] == nil then
							WAR.ICE[jqid] = 1
						elseif WAR.ICE[jqid] < 100 then
							WAR.ICE[jqid] = WAR.ICE[jqid] + 5
						elseif WAR.ICE[jqid] > 100 then
							WAR.ICE[jqid] = 100
						end
					end
					
					if BJY(jqid) and JLSD(10,40,jqid) and juexing() > 1 then
						if WAR.LQZ[jqid] == nil then
							WAR.LQZ[jqid] = 1
						elseif WAR.LQZ[jqid] < 100 then
							WAR.LQZ[jqid] = WAR.LQZ[jqid] + 2
						elseif WAR.LQZ[jqid] > 100 then
							WAR.LQZ[jqid] = 100
						end
					end				
					
					if (wglw1(jqid,47) or DT(jqid,592)) and WAR.DGJJ_ZJS == 1 then
						if WAR.LQZ[jqid] == nil then
							WAR.LQZ[jqid] = 1
						elseif WAR.LQZ[jqid] < 100 then
							WAR.LQZ[jqid] = WAR.LQZ[jqid] + 2
						elseif WAR.LQZ[jqid] > 100 then
							WAR.LQZ[jqid] = 100
						end
					end 		
					
					if 	jqid == 0 and putong() == 8 then			
						if juexing() > 0 then
							AddPersonAttrib(jqid, "中毒程度", math.random(0, 2))
						else
							AddPersonAttrib(jqid, "中毒程度", math.random(0, 1))
						end
					end

					--化功大法		
					if WAR.HGDF[jqid] ~= nil then 
					   AddPersonAttrib(jqid, "中毒程度", 1)
					   AddPersonAttrib(jqid, "内力", -math.random(3, 6))
					end
			
					if  T6XQS(jqid) and juexing() > 0 then	--萧秋水1次觉醒后时序清毒伤迟缓流血
						--时序清毒
						if JY.Person[jqid]["中毒程度"] > 70 and JLSD(10, 70, jqid) then
							AddPersonAttrib(jqid, "中毒程度", -1)
							AddPersonAttrib(jqid, "生命", juexing()*5)
						elseif JY.Person[jqid]["中毒程度"] > 40 and JLSD(15, 85, jqid) then
							AddPersonAttrib(jqid, "中毒程度", -1)
							AddPersonAttrib(jqid, "生命", juexing()*5)
						else
							AddPersonAttrib(jqid, "中毒程度", -1)
							AddPersonAttrib(jqid, "生命", juexing()*5)
						end	
						if JY.Person[jqid]["受伤程度"] > 70 and JLSD(10, 70, jqid) then
							AddPersonAttrib(jqid, "受伤程度", -1)
							AddPersonAttrib(jqid, "生命", juexing()*5)				
						elseif JY.Person[jqid]["受伤程度"] > 40 and JLSD(15, 85, jqid) then
							AddPersonAttrib(jqid, "受伤程度", -1)
							AddPersonAttrib(jqid, "生命", juexing()*5)				
						else
							AddPersonAttrib(jqid, "受伤程度", -1)
							AddPersonAttrib(jqid, "生命", juexing()*5)				
						end
						if WAR.CHZ[jqid] ~= nil then
							WAR.CHZ[jqid] = WAR.CHZ[jqid] - 1
							AddPersonAttrib(jqid, "生命", juexing()*5)
							if WAR.CHZ[jqid] < 1 then
								WAR.CHZ[jqid] = nil;
							end				
						end
						if WAR.LXZT[jqid] ~= nil then
							WAR.LXZT[jqid] = WAR.LXZT[jqid] - 1
							AddPersonAttrib(jqid, "生命", juexing()*5)
							if WAR.LXZT[jqid] < 1 then
								WAR.LXZT[jqid] = nil;
							end				
						end
						if WAR.FXDS[jqid] ~= nil then
							WAR.FXDS[jqid] = WAR.FXDS[jqid] - 1
							AddPersonAttrib(jqid, "生命", juexing()*5)
							if WAR.FXDS[jqid] < 1 then
								WAR.FXDS[jqid] = nil;
							end				
						end
						if WAR.HOT[jqid] ~= nil then
							WAR.HOT[jqid] = WAR.HOT[jqid] - 1
							AddPersonAttrib(jqid, "生命", juexing()*5)
							if WAR.HOT[jqid] < 1 then
								WAR.HOT[jqid] = nil;
							end				
						end	
						if WAR.ICE[jqid] ~= nil then
							WAR.ICE[jqid] = WAR.ICE[jqid] - 1
							AddPersonAttrib(jqid, "生命", juexing()*5)
							if WAR.ICE[jqid] < 1 then
								WAR.ICE[jqid] = nil;
							end				
						end				
					end
			
					if  MPPD(jqid)==5 and wglw(jqid,108) then	--萧秋水1次觉醒后时序清毒伤迟缓流血
						local mpdj=MPDJ(jqid)
						if JY.Person[jqid]["中毒程度"] > 70 and JLSD(10, 70, jqid) then
							AddPersonAttrib(jqid, "中毒程度", -1)
							AddPersonAttrib(jqid, "生命", mpdj*5)
							AddPersonAttrib(jqid, "内力", mpdj*15)
						elseif JY.Person[jqid]["中毒程度"] > 40 and JLSD(15, 85, jqid) then
							AddPersonAttrib(jqid, "中毒程度", -1)
							AddPersonAttrib(jqid, "生命", mpdj*5)
							AddPersonAttrib(jqid, "内力", mpdj*15)
						else
							AddPersonAttrib(jqid, "中毒程度", -1)
							AddPersonAttrib(jqid, "生命", mpdj*5)
							AddPersonAttrib(jqid, "内力", mpdj*15)
						end	
						if JY.Person[jqid]["受伤程度"] > 70 and JLSD(10, 70, jqid) then
							AddPersonAttrib(jqid, "受伤程度", -1)
							AddPersonAttrib(jqid, "生命", mpdj*5)	
							AddPersonAttrib(jqid, "内力", mpdj*15)				
						elseif JY.Person[jqid]["受伤程度"] > 40 and JLSD(15, 85, jqid) then
							AddPersonAttrib(jqid, "受伤程度", -1)
							AddPersonAttrib(jqid, "生命", mpdj*5)	
							AddPersonAttrib(jqid, "内力", mpdj*15)				
						else
							AddPersonAttrib(jqid, "受伤程度", -1)
							AddPersonAttrib(jqid, "生命", mpdj*5)
							AddPersonAttrib(jqid, "内力", mpdj*15)				
						end
						if WAR.CHZ[jqid] ~= nil then
							WAR.CHZ[jqid] = WAR.CHZ[jqid] - 1
							AddPersonAttrib(jqid, "生命", mpdj*5)
							AddPersonAttrib(jqid, "内力", mpdj*15)
							if WAR.CHZ[jqid] < 1 then
								WAR.CHZ[jqid] = nil;
							end				
						end
						if WAR.LXZT[jqid] ~= nil then
							WAR.LXZT[jqid] = WAR.LXZT[jqid] - 1
							AddPersonAttrib(jqid, "生命", mpdj*5)
							AddPersonAttrib(jqid, "内力", mpdj*15)
							if WAR.LXZT[jqid] < 1 then
								WAR.LXZT[jqid] = nil;
							end				
						end
						if WAR.FXDS[jqid] ~= nil then
							WAR.FXDS[jqid] = WAR.FXDS[jqid] - 1
							AddPersonAttrib(jqid, "生命", mpdj*5)
							AddPersonAttrib(jqid, "内力", mpdj*15)
							if WAR.FXDS[jqid] < 1 then
								WAR.FXDS[jqid] = nil;
							end				
						end
						if WAR.HOT[jqid] ~= nil then
							WAR.HOT[jqid] = WAR.HOT[jqid] - 1
							AddPersonAttrib(jqid, "生命", mpdj*5)
							AddPersonAttrib(jqid, "内力", mpdj*15)
							if WAR.HOT[jqid] < 1 then
								WAR.HOT[jqid] = nil;
							end				
						end	
						if WAR.ICE[jqid] ~= nil then
							WAR.ICE[jqid] = WAR.ICE[jqid] - 1
							AddPersonAttrib(jqid, "生命", mpdj*5)
							AddPersonAttrib(jqid, "内力", mpdj*15)
							if WAR.ICE[jqid] < 1 then
								WAR.ICE[jqid] = nil;
							end				
						end				
					end
					--蓝烟清：狄云 领悟神照经真髓，时序回血、回内、减内伤、清除
					if DT(jqid, 37) and JX(jqid) then
						--时序清毒
						if JY.Person[jqid]["中毒程度"] > 70 and JLSD(30, 70, jqid) then
							AddPersonAttrib(jqid, "中毒程度", -1)
						elseif JY.Person[jqid]["中毒程度"] > 40 and JLSD(15, 85, jqid) then
							AddPersonAttrib(jqid, "中毒程度", -1)
						else
							AddPersonAttrib(jqid, "中毒程度", -1)
						end

						--狄云时序减内伤
						if JY.Person[jqid]["受伤程度"] > 70 and JLSD(30, 70, jqid) then
							AddPersonAttrib(jqid, "受伤程度", -1)
						elseif JY.Person[jqid]["受伤程度"] > 40 and JLSD(15, 85, jqid) then
							AddPersonAttrib(jqid, "受伤程度", -1)
						else
							AddPersonAttrib(jqid, "受伤程度", -1)
						end
					end
					--豸苗：李秋水走火内伤
					if WAR.CYSH[jqid] ~= nil then
						if JY.Person[jqid]["内力"] >= 6000 then
						  AddPersonAttrib(jqid, "受伤程度", math.random(0,1))
						elseif JY.Person[jqid]["内力"] >= 2000 and JY.Person[jqid]["内力"] < 6000 then  
						  AddPersonAttrib(jqid, "受伤程度", math.random(0,2))  
						elseif JY.Person[jqid]["内力"] >= 0 and JY.Person[jqid]["内力"] < 2000 then  
						  AddPersonAttrib(jqid, "受伤程度", math.random(0,2))
						  AddPersonAttrib(jqid, "生命", -5)
						end
					end
					--龙元火劲
					if WAR.CYSH[jqid] ~= nil then
						if JY.Person[jqid]["内力"] >= 6000 then
						  AddPersonAttrib(jqid, "受伤程度", math.random(0,1))
						elseif JY.Person[jqid]["内力"] >= 2000 and JY.Person[jqid]["内力"] < 6000 then  
						  AddPersonAttrib(jqid, "受伤程度", math.random(0,2))  
						elseif JY.Person[jqid]["内力"] >= 0 and JY.Person[jqid]["内力"] < 2000 then  
						  AddPersonAttrib(jqid, "受伤程度", math.random(0,2))
						  AddPersonAttrib(jqid, "生命", -5)
						end
					end
					if DT3(jqid, 37) then --狄云指令每时序减25内
						if WAR.DYWY[jqid] == 1 then
							JY.Person[jqid]["内力"] = JY.Person[jqid]["内力"] - 25
							if JY.Person[jqid]["内力"] < 25 then
								WAR.DYWY[jqid] = nil
							end
						end
					end
					if jqid == 0 then --葵花涅时序耗内
						if WAR.KHNP1[jqid] ~= nil then
						   JY.Person[jqid]["内力"] = JY.Person[jqid]["内力"] - 15
							if JY.Person[jqid]["内力"] < 2000 then
								WAR.KHNP1[jqid] = nil
							end 
						end	
					end
					if jqid == 0 then --魔音・碧海潮生
						if WAR.BHCS[jqid] ~= nil then
						   JY.Person[jqid]["内力"] = JY.Person[jqid]["内力"] - 20
							if JY.Person[jqid]["内力"] < 2000 then
								WAR.BHCS[jqid] = nil
							end 
						end	
					end
					if jqid == 0 then --lhfm时序耗内
						if WAR.XLFH[jqid] ~= nil then
						   JY.Person[jqid]["内力"] = JY.Person[jqid]["内力"] - 15
							if JY.Person[jqid]["内力"] < 2000 then
								WAR.XLFH[jqid] = nil
							end 
						end	
					end
					if jqid == 0 then --逆运走火时序耗内
						if WAR.NYZJ[jqid] ~= nil then
						   JY.Person[jqid]["内力"] = JY.Person[jqid]["内力"] - 15
							if JY.Person[jqid]["内力"] < 2000 then
								WAR.NYZJ[jqid] = nil
							end 
						end	
					end
					if MPPD(jqid) == 6 then --血魔
						if WAR.XUEMO[jqid] ~= nil then
							AddPersonAttrib(jqid, "生命", -5)
							if WAR.LQZ[jqid] < 100 then
								WAR.LQZ[jqid] = 100
							end	
							if JY.Person[jqid]["生命"] >= math.modf(JY.Person[jqid]["生命最大值"] * 0.5) then
								AddPersonAttrib(jqid, "生命", -5)
								if WAR.LQZ[jqid] < 100 then
									WAR.LQZ[jqid] = 100
								end	
							elseif JY.Person[jqid]["生命"] < math.modf(JY.Person[jqid]["生命最大值"] * 0.5) then
								WAR.XUEMO[jqid] = nil
								WAR.LQZ[jqid] = nil
							end				
							if JY.Person[jqid]["生命"] < 0 then JY.Person[jqid]["生命"] = 1 end --武骧金星：避免血魔流血至死
						end
					end
					
					--蓝烟清：迟缓值回复
					if WAR.CHZ[jqid] ~= nil then
						if WAR.CHZ[jqid] > 50 then --17-2-12--
						   WAR.CHZ[jqid] = 50 
						end   
						WAR.CHZ[jqid] = WAR.CHZ[jqid] - 1;
						if PersonKF(jqid, 115) or PersonKF(jqid, 116) or 
							PersonKF(jqid, 117) or PersonKF(jqid, 118) or PersonKF(jqid, 119) then
							WAR.CHZ[jqid] = WAR.CHZ[jqid] - 1;
						end
						
						if PersonKF(jqid, 108) then --nino 易筋经回迟缓加倍
							WAR.CHZ[jqid] = WAR.CHZ[jqid] - 1;
						end
						
						if PersonGT(jqid, 99) then --纯阳主功体 回复迟缓
							WAR.CHZ[jqid] = WAR.CHZ[jqid] - 1;
						elseif PersonKF(jqid, 99) then --nino 纯阳回复0-1
							WAR.CHZ[jqid] = WAR.CHZ[jqid] - math.random(0,1);
						end
						
						if PersonKF(jqid,204) then--太清罡气
							if PersonGT(jqid,204) then
								WAR.CHZ[jqid] = WAR.CHZ[jqid] - 3
								AddPersonAttrib(jqid,"生命",20)
							else
								WAR.CHZ[jqid] = WAR.CHZ[jqid] - 2
							end
						end	
						
						if JY.Person[jqid]["防具"] == 58 then  --软猬甲时序回迟缓2点
							WAR.CHZ[jqid] = WAR.CHZ[jqid] - 10
						end
						
						if WAR.LQZ[jqid] == 100 then --怒气值100恢复加倍
							WAR.CHZ[jqid] = WAR.CHZ[jqid] - 1;
						end
						if hasTF(jqid, 134) or WAR.KHZJ[jqid] ~= nil or WAR.JYHT[jqid] ~= nil then--17-2-8
							WAR.CHZ[jqid] = 0
						end
						if T2SQ(jqid) and juexing() > 1 then
							WAR.CHZ[jqid] = 0
						end
						if wglw2(jqid,193) and PersonKF(jqid,193) then
							WAR.CHZ[jqid] = 0
						end	
						if wglw(jqid, 99) or DT(jqid,5) or (PersonKF(jqid,143) and MPPD(jqid) ~= 5) or (PersonKF(jqid,143) and MPPD(jqid) == 5 and MPDJ(jqid) < 2 )then--17-2-8
							WAR.CHZ[jqid] = 0
						end
						if jtyl(jqid) then --谢无悠
							WAR.CHZ[jqid] = 0
						end	
						if wglw1(jqid,48) and WAR.LQZ[jqid] ~= nil and WAR.LQZ[jqid] >= 100 then
							WAR.CHZ[jqid] = 0
						end			
						if WAR.CHZ[jqid] < 1 then
							WAR.CHZ[jqid] = nil;
						end
					end
					
					--麻痹值回复
					if WAR.MABI[jqid] ~= nil then
						if WAR.MABI[jqid] > 50 then
							WAR.MABI[jqid] = 50
						end
						WAR.MABI[jqid] = WAR.MABI[jqid] - 1
						--从这里开始是个别加强解麻痹的效果
						if PersonKF(jqid,204) then--太清罡气
							if PersonGT(jqid,204) then
								WAR.MABI[jqid] = WAR.MABI[jqid] - 3
								AddPersonAttrib(jqid,"内力",100)
							else
								WAR.MABI[jqid] = WAR.MABI[jqid] - 2
							end
						end
						if hasTF(jqid, 134) or WAR.KHZJ[jqid] ~= nil or WAR.JYHT[jqid] ~= nil then
							WAR.MABI[jqid] = 0
						end
						if wglw2(jqid,193) and PersonKF(jqid,193) then
							WAR.MABI[jqid] = 0
						end
						--个别加强结束		
						if WAR.MABI[jqid] <= 0 then
							WAR.MABI[jqid] = nil
						end	
					end	
					
					if WAR.YRKG[jqid] ~= nil then --以柔克刚重置
						WAR.YRKG[jqid] = WAR.YRKG[jqid] - 1
						if WAR.YRKG[jqid] <= 0 then
							WAR.YRKG[jqid] = nil
						end
					end
					
					if ZYBF(jqid) and WAR.LQZ[jqid] ~= nil and WAR.LQZ[jqid] <100 and not DT(jqid,50) and WAR.QX1[jqid] ~= 1 then--沼跃鱼：战意开启后时序涨怒气--17-3-3-玉女经
					   WAR.LQZ[jqid]=WAR.LQZ[jqid]+1
						for j = 0, WAR.PersonNum - 1 do 
							if wglw1(WAR.Person[j]["人物编号"], 57) and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~=  WAR.Person[i]["我方"] then
								WAR.LQZ[jqid] = nil
							end
						end
					   if WAR.LQZ[jqid]==100 then 
					   local str=".战技"
					   if DT(jqid,1) then
						  str=".绝刀"
					   end
					   if DT(jqid,51) then
						  str=".修罗无间"
					   end
					   if (DT(jqid,103) or DT(jqid,595)) and WAR.CHD==0 then
						  str=".明王残火刀"
						  WAR.CHD=5
					   end
						if DT(jqid,50) then
						   str=".天缚苍龙诀"
						end
						if T13TQS(jqid) then
						   str=".兽血沸腾"
						end
						if T8LXY(jqid) then
						   str=".蜀山剑神"
						end
					   local tmppid=WAR.CurID
					   WAR.CurID=i
					   DHdisplay(1694, 1705, "战意爆发"..str)
					   WAR.CurID=tmppid
					   end
					end
			

					--水镜四奇，100时序满云体风身，需要3次觉醒
					if (T2SQ(jqid) and juexing() > 2) or DT(jqid, 662) then
					  if WAR.YTFS < 100 then
						WAR.YTFS = WAR.YTFS + 1
					  end
					  if WAR.YTFS == 100 then
						  DrawStrBox(-1, -1, CC.WARS17, C_GOLD, 30)
						  ShowScreen()
						  lib.Delay(100)
						  WAR.YTFS = 101
						end
					end
					
					if DT(jqid,55) and JX(jqid) and WAR.SHENJIAN==0 then
					  if WAR.XLLQ < 100 then
						WAR.XLLQ = WAR.XLLQ + 1
					  end
					  if WAR.XLLQ == 100 then
						  DrawStrBox(-1, -1, "翔龙神箭冷却完毕", C_GOLD, 30)
						  ShowScreen()
						  lib.Delay(100)
						  WAR.SHENJIAN = 1
						end
					end
					
					if wglw(jqid,106) or (DT(jqid,9) and PersonKF(jqid,106)) then --17-2-8-
					   if WAR.JYHT1 < 25 then 
						  WAR.JYHT1 = WAR.JYHT1 + 1
					   end
					   if WAR.JYHT1 == 25 then 
						  if WAR.JYHT[jqid] == nil then 
							 WAR.JYHT[jqid] = 1 
						  else 	 
							 WAR.JYHT[jqid] = WAR.JYHT[jqid] + 1 
						  end
						  if WAR.JYHT[jqid] >= 5 then 
							 WAR.JYHT[jqid] = 5
						  end
						  WAR.JYHT1 = 0
					   end  
					end
					if wglw(jqid,107) or DT(jqid,599) then --17-2-8-
						if WAR.JYHT2 < 25 then 
							WAR.JYHT2 = WAR.JYHT2 + 1
						end
						if WAR.JYHT2 == 25 then 
							if WAR.JYZQ[jqid] == nil then 
								WAR.JYZQ[jqid] = 1 
							else 	 
								WAR.JYZQ[jqid] = WAR.JYZQ[jqid] + 1 
							end
							if WAR.JYZQ[jqid] >= 5 then 
								WAR.JYZQ[jqid] = 5
							end
							WAR.JYHT2 = 0
						end  
					end
					if wglw(jqid,592) or DT(jqid,592) then --17-2-8-
						if WAR.DGJY1 < 15 then 
							WAR.DGJY1 = WAR.DGJY1 + 1
						end
						if WAR.DGJY1 == 15 then 
							if WAR.DGJY[jqid] == nil then 
								WAR.DGJY[jqid] = 1 
							else 	 
								WAR.DGJY[jqid] = WAR.DGJY[jqid] + 1 
							end
							if WAR.DGJY[jqid] >= 9 then 
								WAR.DGJY[jqid] = 9
							end
							WAR.DGJY1 = 0
						end  
					end
					--豸苗：返老还童
					if DT(jqid, 117) then
					  if WAR.FLHT < 190 then
						WAR.FLHT = WAR.FLHT + 1
					  elseif WAR.FLHT >= 190 then
						WAR.FLHT = 190
						end
					  if WAR.FLHT == 100 then
						  DrawStrBox(-1, -1, "返老还童", C_GOLD, 30)
						  ShowScreen()
						  lib.Delay(200)
						end
					end
					
					--豸苗：谢云流坐忘无我
					if XYL(jqid) and JY.Person[jqid]["声望"] == 180 and juexing() > 1 then
					  if WAR.ZWWW1 < 60 then
						WAR.ZWWW1 = WAR.ZWWW1 + 1
					  end
					  if WAR.ZWWW1 == 60 then
						 WAR.ZWWW = 300
						 WAR.ZWWW1 = 0
					  end
					end  
					  
					if WAR.AN[jqid] ~= nil then --阿奴夺魂指令
						local xixue = 0
						xixue = xixue + math.modf(JY.Person[jqid]["生命"]/200)
						xixue = xixue + math.modf(JY.Person[jqid]["中毒程度"]/25)
						JY.Person[jqid]["生命"] = JY.Person[jqid]["生命"] - xixue
						if JY.Person[jqid]["生命"] <= 0 then 
							JY.Person[jqid]["生命"] = 1
						end
						AddPersonAttrib(92, "生命", xixue)
						WAR.AN[jqid] = WAR.AN[jqid] - 1
						if WAR.AN[jqid] <= 0 then
							WAR.AN[jqid] = nil
						end
					end

					if WAR.AN2[jqid] ~= nil then --阿奴夺魂指令
						local xixue = 0
						xixue = xixue + math.modf(JY.Person[jqid]["生命"]/200)
						xixue = xixue + math.modf(JY.Person[jqid]["中毒程度"]/25)
						xixue = xixue + math.modf(JY.Person[jqid]["受伤程度"]/25)
						JY.Person[jqid]["生命"] = JY.Person[jqid]["生命"] - xixue
						if JY.Person[jqid]["生命"] <= 0 then 
							JY.Person[jqid]["生命"] = 1
						end
						WAR.AN2[jqid] = WAR.AN2[jqid] - 1
						if WAR.AN2[jqid] <= 0 then
							WAR.AN2[jqid] = nil
						end
					end
					
					
					if jqid == 0 and putong() == 11 then
						if WAR.PLJZ["生命值"] ~= nil then
							AddPersonAttrib(jqid, "生命", WAR.PLJZ["生命值"])
						end
						if WAR.PLJZ["内力值"] ~= nil then
							AddPersonAttrib(jqid, "内力", WAR.PLJZ["内力值"])
						end			
					end
					
					--蓝烟清：王难姑指令，按时序中毒，按百分比减血
						if WAR.Person[i]["我方"] == false and WAR.Person[i]["死亡"] == false then
						  if WAR.L_WNGZL[jqid] ~= nil and WAR.L_WNGZL[jqid] > 0 then
							
							JY.Person[jqid]["中毒程度"] = JY.Person[jqid]["中毒程度"] + 1
								JY.Person[jqid]["生命"] = JY.Person[jqid]["生命"] - math.modf(JY.Person[jqid]["生命"]/150);
								WAR.L_WNGZL[jqid] = WAR.L_WNGZL[jqid] -1;
								
								if WAR.L_WNGZL[jqid] <= 0 then
									WAR.L_WNGZL[jqid] = nil;
									flag = 1;
								end
							end
						end
						
					--brolycjw：胡青牛指令，按时序回血回内伤，按百分比回血
					if WAR.Person[i]["我方"] == true and WAR.Person[i]["死亡"] == false then
						if WAR.L_HQNZL[jqid] ~= nil and WAR.L_HQNZL[jqid] > 0 then
							AddPersonAttrib(jqid, "生命", 1 + math.modf((JY.Person[jqid]["生命最大值"]-JY.Person[jqid]["生命"])/40))
							if JY.Person[jqid]["受伤程度"] > 50 then
								AddPersonAttrib(jqid, "受伤程度", -2)
							else
								AddPersonAttrib(jqid, "受伤程度", -1)
							end
							WAR.L_HQNZL[jqid] = WAR.L_HQNZL[jqid] -1;
							if WAR.L_HQNZL[jqid] <= 0 then
								WAR.L_HQNZL[jqid] = nil;
								flag = 1;
							end
						end
					end
					 
					if T13TQS(jqid) and JY.Person[jqid]["生命"]<= math.modf(0.5* JY.Person[jqid]["生命最大值"]) and juexing()> 0 then
						AddPersonAttrib(jqid, "生命", 1 + math.modf((JY.Person[jqid]["生命最大值"]-JY.Person[jqid]["生命"])/40))
						if JY.Person[jqid]["受伤程度"] > 50 then
							AddPersonAttrib(jqid, "受伤程度", -2)
						else
							AddPersonAttrib(jqid, "受伤程度", -1)
						end
					end	
				
					if WAR.Person[i]["死亡"] == false then --朱九真魅惑100时序，npc复原
						if WAR.NPC[jqid] ~= nil then
							WAR.NPC[jqid] = WAR.NPC[jqid] - 1
							if WAR.NPC[jqid] <= 0 then
								WAR.NPC[jqid] = nil
								WAR.Person[i]["我方"] = not WAR.Person[i]["我方"]
								if WAR.ZOMBIE[jqid] ~= nil then
									WAR.Person[i]["死亡"] = true
									lib.SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 5, -1)
									lib.SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 2, -1)	
								end
							end
						end
					end
					
					if WAR.HXB1[100+jqid] ~= nil and WAR.HXB1[100+jqid] > 0 then --唐门模式
					   JY.Person[jqid]["中毒程度"] = JY.Person[jqid]["中毒程度"] + 1
					   AddPersonAttrib(jqid, "生命", -5)
					   WAR.HXB1[100+jqid] = WAR.HXB1[100+jqid] -1;
					   if WAR.HXB1[100+jqid] <= 0 then 
						  WAR.HXB1[100+jqid] = nil 
					   end	  
					end
					if WAR.HXB1[200+jqid] ~= nil and WAR.HXB1[200+jqid] > 0 then --唐门模式
					   --JY.Person[jqid]["中毒程度"] = JY.Person[jqid]["中毒程度"] + 1
					   AddPersonAttrib(jqid, "生命", -5)
					   AddPersonAttrib(jqid, "内力", -15)
					   WAR.HXB1[200+jqid] = WAR.HXB1[200+jqid] -1;
					   if WAR.HXB1[200+jqid] <= 0 then 
						  WAR.HXB1[200+jqid] = nil 
					   end	  
					end
					if WAR.Person[i]["死亡"] == false then
						if WAR.UNDEAD[jqid] ~= nil then
							WAR.UNDEAD[jqid] = WAR.UNDEAD[jqid] - 1
							JY.Person[jqid]["生命"] = 1
							if WAR.UNDEAD[jqid] <= 0 then
								WAR.UNDEAD[jqid] = nil
								WAR.Person[i]["死亡"] = true
								lib.SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 5, -1)
								--lib.SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 2, -1)						
							end
						end
					end

					
					if WAR.Person[i]["死亡"] == false then --回魂仙梦复原
						if WAR.MENG[jqid] ~= nil then
							WAR.MENG[jqid] = WAR.MENG[jqid] - 1
							if WAR.MENG[jqid] <= 0 then
								WAR.MENG[jqid] = nil
							end
						end
					end
			
					  if WAR.HOT[jqid] ~= nil then --灼烧恢复
						if WAR.HOT[jqid] > 50 then --17-2-12--
						   if wglw1(jqid,68) then
								if WAR.HOT[jqid] > 100 then
									WAR.HOT[jqid] = 100
								end	
						   elseif WAR.KLJZ == 4 then
								if inteam(jqid) then
									WAR.HOT[jqid] = 50
								else
									if WAR.HOT[jqid] > 99 then
										WAR.HOT[jqid] = 99
									end
								end	
						   else
							WAR.HOT[jqid] = 50 
						   end
						end
						if WAR.HOT[jqid] > 20 then --重度灼烧加内伤
							if wglw(jqid,178) or (DT(jqid,69) and PersonKF(jqid,178)) or T9ZY(jqid) or DT(jqid,602) then --九龙功
							   AddPersonAttrib(jqid, "受伤程度", -1)
							elseif wglw1(jqid,176) or (DT(jqid,49) and PersonKF(jqid,176)) or DT(jqid,117) or DT(jqid,618) then --生死符
							   AddPersonAttrib(jqid, "受伤程度", -1)
							elseif wglw(jqid,182) or (DT(jqid,5) and PersonGT(jqid,182)) then 
							   AddPersonAttrib(jqid, "受伤程度", -1)
							elseif wglw1(jqid,68)then 
							else 
							   AddPersonAttrib(jqid, "受伤程度", 1)
							end   
						end
						WAR.HOT[jqid] = WAR.HOT[jqid] - 1
						if PersonKF(jqid, 107) then
							WAR.HOT[jqid] = WAR.HOT[jqid] - 1
						end
						if PersonKF(jqid, 108) then
							WAR.HOT[jqid] = WAR.HOT[jqid] - 1
						end			
						if PersonGT(jqid, 107) then
							WAR.HOT[jqid] = WAR.HOT[jqid] - 1
						end			
						if PersonGT(jqid, 124) then
							WAR.HOT[jqid] = WAR.HOT[jqid] - 1
						end	
						if wglw1(jqid,68) then
						else	
							if hasTF(jqid, 134) or WAR.KHZJ[jqid] ~= nil or WAR.JYHT[jqid] ~= nil then --17-2-8
								WAR.HOT[jqid] = 0
							end	
							if T2SQ(jqid) and juexing() > 1 then
								WAR.HOT[jqid] = 0
							end		
							if JY.Person[jqid]["防具"] == 63 then  --皮衣时序回灼烧2点
								WAR.HOT[jqid] = WAR.HOT[jqid] - 10
							end	
							if wglw(jqid, 99) or DT(jqid,5) then--17-2-8
								WAR.HOT[jqid] = 0
							end
							if jtyl(jqid) then --谢无悠
								WAR.HOT[jqid] = 0
							end
							if wglw1(jqid,48) and WAR.LQZ[jqid] ~= nil and WAR.LQZ[jqid] >= 100 then
								WAR.HOT[jqid] = 0
							end	
							if wglw(jqid,121) or (DT(jqid,59) and PersonKF(jqid,121)) or (DT(jqid,601) ) then --17-3-3-玉女经
								WAR.HOT[jqid] = 0
							end
						end	
						if WAR.HOT[jqid] <= 0 then
							WAR.HOT[jqid] = nil
						end
					  end		
			
					if WAR.QFY1[jqid] ~= nil and WAR.QFY1[jqid] > 0 then --飞燕凌波 时序
						WAR.QFY1[jqid] = WAR.QFY1[jqid] - 1
						if WAR.QFY1[jqid] <= 0 then
							WAR.QFY1[jqid] = nil
						end		
					end
					
					if WAR.QFY2[jqid] ~= nil and WAR.QFY2[jqid] > 0 then --破虏令 时序
						WAR.QFY2[jqid] = WAR.QFY2[jqid] - 1
						if WAR.QFY2[jqid] <= 0 then
							WAR.QFY2[jqid] = nil
						end		
					end		
					
					if WAR.QFY3[jqid] ~= nil and WAR.QFY3[jqid] > 0 then --空山鸣涧 时序
						WAR.QFY3[jqid] = WAR.QFY3[jqid] - 1
						if WAR.QFY3[jqid] <= 0 then
							WAR.QFY3[jqid] = nil
						end		
					end		
					
					if WAR.ATKDOWN[jqid] ~= nil and WAR.ATKDOWN[jqid] > 0 then
						WAR.ATKDOWN[jqid] = WAR.ATKDOWN[jqid] - 1
						if WAR.ATKDOWN[jqid] <= 0 then
							WAR.ATKDOWN[jqid] = nil
						end		
					end		
					
					if WAR.DEFDOWN[jqid] ~= nil and WAR.DEFDOWN[jqid] > 0 then
						WAR.DEFDOWN[jqid] = WAR.DEFDOWN[jqid] - 1
						if WAR.DEFDOWN[jqid] <= 0 then
							WAR.DEFDOWN[jqid] = nil
						end		
					end
					
					if WAR.XYWX[100+jqid] ~= nil and WAR.XYWX[100+jqid] > 0 then --玄一无相
						WAR.XYWX[100+jqid] = WAR.XYWX[100+jqid] - 1
						if WAR.XYWX[100+jqid] <= 0 then
							WAR.XYWX[100+jqid] = nil
						end		
					end
					
					if WAR.SPDDOWN[jqid] ~= nil and WAR.SPDDOWN[jqid] > 0 then
						WAR.SPDDOWN[jqid] = WAR.SPDDOWN[jqid] - 1
						if WAR.SPDDOWN[jqid] <= 0 then
							WAR.SPDDOWN[jqid] = nil
						end		
					end				
					
					if WAR.HIDE[jqid] ~= nil and WAR.HIDE[jqid] > 0 then --隐蔽 时序
						WAR.HIDE[jqid] = WAR.HIDE[jqid] - 1
						if WAR.HIDE[jqid] <= 0 then
							WAR.HIDE[jqid] = nil
						end		
					end		

					if WAR.DR[jqid] ~= nil and WAR.DR[jqid] > 0 then --豸苗：谢云流叠刃
						WAR.DR[jqid] = WAR.DR[jqid] - 1
						if WAR.DR[jqid] <= 0 then
							WAR.DR[jqid] = nil
							WAR.DR_X[jqid] = nil
						end	
					   local a = 1
					   if WAR.DR_X[jqid] ~= nil and WAR.DR_X[jqid] > 0 then 
						  a = WAR.DR_X[jqid]
						  if a >= 5 then 
							 a = 5
						  end 
					   end  
					   AddPersonAttrib(jqid, "生命", -2*a)
			--		   if JY.Person[jqid]["生命"] == 0 then
			--			  WAR.Person[i]["死亡"] = true
			--			  lib.SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 5, -1)
						 -- lib.SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 2, -1)
			--		   end				   	
					end	
					
					if WAR.CYSH[jqid] ~= nil and WAR.CYSH[jqid] > 0 then --豸苗：李秋水
						WAR.CYSH[jqid] = WAR.CYSH[jqid] - 1
						if WAR.CYSH[jqid] <= 0 then
							WAR.CYSH[jqid] = nil
						end		
					end

					if WAR.bhbm[1000+jqid] ~= nil and WAR.bhbm[1000+jqid] > 0 then --豸苗：八荒八灭
						WAR.bhbm[1000+jqid] = WAR.bhbm[1000+jqid] - 1
						if WAR.bhbm[1000+jqid] <= 0 then
							WAR.bhbm[1000+jqid] = nil
						end		
						if WAR.bhbm[2000+jqid] ~= nil and WAR.bhbm[2000+jqid] > 0 then
						   WAR.bhbm[3000+jqid] = 92
						   WAR.bhbm[1000+jqid] = nil
						   WAR.bhbm[2000+jqid] = nil
						end   
					end		
					if WAR.bhbm[2000+jqid] ~= nil and WAR.bhbm[2000+jqid] > 0 then --豸苗：豸苗：八荒八灭
						WAR.bhbm[2000+jqid] = WAR.bhbm[2000+jqid] - 1
						if WAR.bhbm[2000+jqid] <= 0 then
							WAR.bhbm[2000+jqid] = nil
						end		
						if WAR.bhbm[1000+jqid] ~= nil and WAR.bhbm[1000+jqid] > 0 then
						   WAR.bhbm[3000+jqid] = 92
						   WAR.bhbm[1000+jqid] = nil
						   WAR.bhbm[2000+jqid] = nil
						end   
					end	
					if WAR.bhbm[3000+jqid] ~= nil and WAR.bhbm[3000+jqid] > 0 then --豸苗：豸苗：八荒八灭
						WAR.bhbm[3000+jqid] = WAR.bhbm[3000+jqid] - 1
						if WAR.bhbm[3000+jqid] <= 0 then
							WAR.bhbm[3000+jqid] = nil
						end		
						if WAR.bhbm[3000+jqid] == 91 or WAR.bhbm[3000+jqid] == 61 or WAR.bhbm[3000+jqid] == 31 then
						   WAR.bhbm[4000+jqid] = 15
						end   
					end
					if WAR.HGDF[jqid] ~= nil and WAR.HGDF[jqid] > 0 then --豸苗：化功大法
						WAR.HGDF[jqid] = WAR.HGDF[jqid] - 1
						if WAR.HGDF[jqid] <= 0 then
							WAR.HGDF[jqid] = nil
						end		
					end	

					--三千越甲不可敌一人一竹 千军止步-12-29-
					if WAR.QJZB[jqid] ~= nil and WAR.QJZB[jqid] > 0 then --豸苗：千军止步
						WAR.QJZB[jqid] = WAR.QJZB[jqid] - 1
						if WAR.QJZB[jqid] <= 0 then
							WAR.QJZB[jqid] = nil
						end
						local qjzb = WAR.Person[i].TimeAdd
						for j=0,WAR.PersonNum-1 do
							if WAR.Person[j]["死亡"]==false and WAR.Person[j]["我方"] == WAR.Person[i]["我方"] and WAR.Person[i]["死亡"] == false then                            			   			                   
							   if WAR.Person[j].TimeAdd>qjzb then
								  WAR.Person[j].TimeAdd = qjzb
							   end
							if WAR.LQZ[WAR.Person[i]["人物编号"]] == 100 then
							WAR.JQSDXS[WAR.Person[i]["人物编号"]]=qjzb*2
							else
							WAR.JQSDXS[WAR.Person[i]["人物编号"]]=qjzb
							end
							end
						end
					end	
					if WAR.WRHX[jqid] ~= nil and WAR.WRHX[jqid] > 0 and jtyl(jqid) then --谢无悠
					   WAR.WRHX[jqid] = WAR.WRHX[jqid] -1
						if WAR.WRHX[jqid] <= 0 then
							WAR.WRHX[jqid] = nil
						end
					   for j = 0, WAR.PersonNum - 1 do
					   if WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false and not jtyl(WAR.Person[j]["人物编号"]) then
						  if WAR.Person[j].Time > WAR.Person[i].Time then 
							 WAR.Person[j].Time = WAR.Person[i].Time - 200
						  elseif WAR.Person[j].Time > WAR.Person[i].Time - 200 then
							 WAR.Person[j].Time = WAR.Person[i].Time - 200
						  end	 
					   end 
					   end
					end
			
					if WAR.CMCF[jqid] ~= nil and WAR.CMCF[jqid] > 0 and jtyl(jqid) then --谢无悠
						WAR.CMCF[jqid] = WAR.CMCF[jqid] - 1
						if WAR.CMCF[jqid] <= 0 then 
						   WAR.CMCF[jqid] = nil
						end
						local n = 0
						for j = 0,WAR.PersonNum-1 do
							if WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false then
								n = n + 1
								if JY.Person[WAR.Person[i]["人物编号"]]["生命"] < JY.Person[WAR.Person[i]["人物编号"]]["生命最大值"] then
									AddPersonAttrib(WAR.Person[i]["人物编号"], "生命", 20*n)
									AddPersonAttrib(WAR.Person[j]["人物编号"], "生命", -20)  
									if JY.Person[WAR.Person[j]["人物编号"]]["生命"] == 0 then
										WAR.Person[j]["死亡"] = true
										--lib.SetWarMap(WAR.Person[j]["坐标X"], WAR.Person[j]["坐标Y"], 5, -1)
										--lib.SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 2, -1)							   
									end
								end
							end				
						end					
					end

		 
					if WAR.LGQJ[jqid] ~= nil and WAR.LGQJ[jqid] > 0 and not jtyl(jqid) then 
						WAR.LGQJ[jqid] = WAR.LGQJ[jqid] - 1
						if WAR.LGQJ[jqid] <= 0 then
							WAR.LGQJ[jqid] = nil
						end		
					end
					if WAR.NTLW4[jqid] ~= nil then
						WAR.NTLW4[jqid] = WAR.NTLW4[jqid] -1
						if WAR.NTLW4[jqid] <= 0 then
							WAR.NTLW4[jqid] = nil
						end
					end
						
					if (ycfy(jqid) or wssz(jqid) or WAR.JYHT[jqid] ~= nil or WAR.JSJY[200+jqid] ~= nil or WAR.QJBMS[jqid] ~= nil or WAR.NTLW4[jqid] ~= nil) and WAR.AXSY3[jqid] == nil then
						WAR.SZWH[jqid] = nil 
						WAR.LHFM[jqid] = nil
						WAR.BWAX[jqid] = nil
						WAR.HBZQ[jqid] = nil
						WAR.YHDF[jqid] = nil --17-2-10
						WAR.ATKDOWN[jqid] = nil
						WAR.DEFDOWN[jqid] = nil
						WAR.SPDDOWN[jqid] = nil
						WAR.L_WNGZL[jqid] = nil
						WAR.L_NOT_MOVE[jqid] = nil
						WAR.KHCM[jqid] = nil
						WAR.BZ[jqid] = nil
						WAR.GUDUVICTIE[jqid] = nil
						WAR.CONFUSE[jqid] = nil
						WAR.PEACE[jqid] = nil
						WAR.SH[jqid] = nil
						WAR.KHG[jqid] = nil
						WAR.OYFSD[jqid] = nil
						WAR.SSNS[jqid] = nil
						WAR.NS[jqid] = nil
						WAR.POISON[jqid] = nil
						WAR.bhbm[4000 + jqid] = nil
						WAR.NPC[jqid] = nil
						WAR.SSTG[jqid] = nil
						WAR.WYWX[jqid] = nil
						WAR.MENG[jqid] = nil
						WAR.YQWR1[jqid] = nil
						WAR.YQWR2[jqid] = nil
						WAR.BPD[jqid] = nil
						WAR.BTSP[jqid] = nil
						WAR.LSZD[jqid] = nil
						WAR.LSZD1[jqid] = nil
						WAR.LSZD2[jqid] = nil
						WAR.NHH[jqid] = nil
						WAR.NBH[jqid] = nil
						WAR.LXZS[jqid] = nil
						WAR.WDWJJ[jqid] = nil
					end
					
					--一苇渡江领悟
					if (wglw2(jqid,143) or DT(jqid,615) or DT(jqid,114) or DT(jqid,617)) and PersonKF(jqid,143) then
						WAR.SZWH[jqid] = nil 
						WAR.LHFM[jqid] = nil
						WAR.MENG[jqid] = nil
					end	
					
					if PersonKF(jqid,193) then--旋风扫叶腿
						WAR.SPDDOWN[jqid] = nil
						WAR.L_NOT_MOVE[jqid] = nil
						WAR.SZWH[jqid] = (WAR.SZWH[jqid] or 0) - 1
						WAR.GUDUVICTIE[jqid] = (WAR.GUDUVICTIE[jqid] or 0 ) - 1
						if WAR.GUDUVICTIE[jqid] <= 0 then
							WAR.GUDUVICTIE[jqid] = nil
						end	
						if WAR.SZWH[jqid] <= 0 then
							WAR.SZWH[jqid] = nil
						end
					end	
					
					--梯云领悟怀若虚云
					if WAR.HRXY[jqid] ~= nil then
						WAR.HRXY1 = math.random(6)
						if WAR.HRXY1 == 1 then
							JY.Person[jqid]["受伤程度"] = 0
							WAR.HRXY1 = nil
							WAR.HRXY[jqid] = nil
						elseif WAR.HRXY1 == 2 then
							WAR.HOT[jqid] = nil
							WAR.HRXY1 = nil
							WAR.HRXY[jqid] = nil
						elseif WAR.HRXY1 == 3 then
							WAR.ICE[jqid] = nil
							WAR.HRXY1 = nil
							WAR.HRXY[jqid] = nil
						elseif WAR.HRXY1 == 4 then
							WAR.LXZT[jqid] = nil
							WAR.HRXY1 = nil
							WAR.HRXY[jqid] = nil
						elseif WAR.HRXY1 == 5 then
							WAR.FXDS[jqid] = nil
							WAR.HRXY1 = nil
							WAR.HRXY[jqid] = nil
						elseif WAR.HRXY1 == 6 then
							WAR.CHZ[jqid] = nil 
							WAR.HRXY1 = nil
							WAR.HRXY[jqid] = nil
						end	
					end	
					
					--弹指领悟气劲复原
					if wglw1(jqid,18) and WAR.TZQJ1[jqid] ~= nil then
						WAR.TZQJ1[jqid] = WAR.TZQJ1[jqid] - 1
						if WAR.TZQJ1[jqid] < 1 then
							WAR.TZQJ1[jqid] = nil 
						end
					end	
					
					if wglw1(jqid,18) and WAR.TZQJ2[jqid] ~= nil then
						WAR.TZQJ2[jqid] = WAR.TZQJ2[jqid] - 1
						if WAR.TZQJ2[jqid] < 1 then
							WAR.TZQJ2[jqid] = nil 
						end
					end
					
					if wglw1(jqid,18) and WAR.TZQJ3[jqid] ~= nil then
						WAR.TZQJ3[jqid] = WAR.TZQJ3[jqid] - 1
						if WAR.TZQJ3[jqid] < 1 then
							WAR.TZQJ3[jqid] = nil 
						end
					end
					
					if WAR.TZQJ5[jqid] ~= nil then -- 逆运劲
						if JLSD(10,60,jqid) then
							AddPersonAttrib(jqid,"受伤程度",math.random(3,5))
							if math.random(10) > 6 then
								WAR.Person[i].Time = WAR.Person[i].Time - math.modf((JY.Person[jqid]["受伤程度"] or 0)*math.random(3))
							end
						end	
						WAR.TZQJ5[jqid] = WAR.TZQJ5[jqid] - 1
						if WAR.TZQJ5[jqid] < 1 then
							WAR.TZQJ5[jqid] = nil 
						end
					end	
					
					if wglw1(jqid,18) and WAR.TZQJ6[jqid] ~= nil then
						WAR.TZQJ6[jqid] = WAR.TZQJ6[jqid] - 1
						if WAR.TZQJ6[jqid] < 1 then
							WAR.TZQJ6[jqid] = nil 
						end
					end
					
					if wglw1(jqid,18) and WAR.TZQJ7[jqid] ~= nil then
						WAR.TZQJ7[jqid] = WAR.TZQJ7[jqid] - 1
						if WAR.TZQJ7[jqid] < 1 then
							WAR.TZQJ7[jqid] = nil 
						end
					end
					
					if wglw1(jqid,18) and WAR.TZQJ9[jqid] ~= nil then
						WAR.TZQJ9[jqid] = WAR.TZQJ9[jqid] - 1
						if WAR.TZQJ9[jqid] < 1 then
							WAR.TZQJ9[jqid] = nil 
						end
					end
					
					if wglw1(jqid,18) and WAR.TZQJ10[jqid] ~= nil then
						WAR.TZQJ10[jqid] = WAR.TZQJ10[jqid] - 1
						if WAR.TZQJ10[jqid] < 1 then
							WAR.TZQJ10[jqid] = nil 
						end
					end
					
					if wglw1(jqid,18) and WAR.TZQJ11[jqid] ~= nil then
						WAR.TZQJ11[jqid] = WAR.TZQJ11[jqid] - 1
						if WAR.TZQJ11[jqid] < 1 then
							WAR.TZQJ11[jqid] = nil 
						end
					end
					
					if wglw1(jqid,18) and WAR.TZQJ14[jqid] ~= nil then
						WAR.TZQJ14[jqid] = WAR.TZQJ14[jqid] - 1
						if WAR.TZQJ14[jqid] < 1 then
							WAR.TZQJ14[jqid] = nil 
						end
					end
					--弹指气劲复原结束
					
					if jtyl(jqid) then --谢无悠
					   if WAR.Person[i].Time < 0 then 
						  WAR.Person[i].Time = 600 
					   end  
					end
					--混元一气・大海无量	
					if WAR.HYYQ[jqid] == 1 and WAR.Person[i]["死亡"] == false then
							JY.Person[jqid]["体力"] = JY.Person[jqid]["体力"] - 1
							if JY.Person[jqid]["体力"] < 50 then
								WAR.HYYQ[jqid] = nil
							end
					--   for j = 0, WAR.PersonNum - 1 do
					--   if WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[j].Time > 500 then
					--      WAR.Person[j].Time = 500
					--   end 
					--   end
					end
					--寒冰真气
					if WAR.BFQL[jqid] == 1 and WAR.Person[i]["死亡"] == false then
							JY.Person[jqid]["内力"] = JY.Person[jqid]["内力"] - 15
							if JY.Person[jqid]["内力"] < 1000 then
								WAR.BFQL[jqid] = nil
							end
						local x1 = WAR.Person[i]["坐标X"];
						local y1 = WAR.Person[i]["坐标Y"];
						for ex = x1 - 8, x1 + 8 do
							for ey = y1 - 8, y1 + 8 do
								SetWarMap(ex, ey, 4, 1)
								if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
									local ep = GetWarMap(ex, ey, 2)
									if WAR.Person[i]["我方"] ~= WAR.Person[ep]["我方"] then
										if WAR.ICE[WAR.Person[ep]["人物编号"]] == nil then 
										   WAR.ICE[WAR.Person[ep]["人物编号"]] = 2 
										else 
										   WAR.ICE[WAR.Person[ep]["人物编号"]] = WAR.ICE[WAR.Person[ep]["人物编号"]] + 2
										end 
										if WAR.ICE[WAR.Person[ep]["人物编号"]] > 100 then WAR.ICE[WAR.Person[ep]["人物编号"]] = 100 end
									end
								end
							end
						end
					end
					
					if (wglw(jqid,95) or ((DT(jqid,60) or DT(jqid,620)) and PersonKF(jqid,95))) and WAR.Person[i]["死亡"] == false and WAR.HMJT[WAR.Person[i]["人物编号"]] ~= nil 
					  and WAR.HMJT[WAR.Person[i]["人物编号"]] > 0 then --蛤蟆九天17-2-23
						local a = 20 
						if inteam(WAR.Person[i]["人物编号"]) then 
						   a = 30
						end 
						if JLSD(10,a,jqid) then 
						local x1 = WAR.Person[i]["坐标X"];
						local y1 = WAR.Person[i]["坐标Y"];
						for ex = x1 - 8, x1 + 8 do
							for ey = y1 - 8, y1 + 8 do
								SetWarMap(ex, ey, 4, 1)
								if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
									local ep = GetWarMap(ex, ey, 2)
									if WAR.Person[i]["我方"] ~= WAR.Person[ep]["我方"] then
									   WAR.Person[ep].Time = WAR.Person[ep].Time - math.modf(WAR.HMJT[WAR.Person[i]["人物编号"]]/50)
									   if WAR.Person[ep].Time < -500 then 
										  WAR.Person[ep].Time = -500 
									   end	  
									end
								end
							end
						end
						end
					end
					
					if WAR.SSNS[jqid] ~= nil and WAR.SSNS[jqid] > 0 then --豸苗：日月神教三尸脑神丹
						WAR.SSNS[jqid] = WAR.SSNS[jqid] - 1
						if WAR.Person[i]["死亡"] == false then 
							if WAR.SSNS[jqid] < 450 then
								if math.random(10)< 6 then 
								   WAR.Person[i]["我方"] = true
								elseif math.random(10)>= 6 then 
								   WAR.Person[i]["我方"] = false
								end
							end	
						end
						if WAR.SSNS[jqid] == 1 then
						WAR.Person[i]["死亡"] = true
						--lib.SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 5, -1)
					   -- lib.SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 2, -1)
						end
						if WAR.SSNS[jqid] <= 0 then
							WAR.SSNS[jqid] = nil
						WAR.Person[i]["我方"] = not WAR.Person[i]["我方"]	
						end		
					end
					if WAR.BLHQ[jqid] ~= nil and WAR.BLHQ[jqid] > 0 then --豸苗：日月神教三尸脑神丹
						WAR.BLHQ[jqid] = WAR.BLHQ[jqid] - 1
						if WAR.Person[i]["死亡"] == false then 
							WAR.Person[i]["我方"] = true
						end
						if WAR.BLHQ[jqid] == 1 then
						WAR.Person[i]["死亡"] = true
						WAR.BLHQ1 = 2
						end
						if WAR.BLHQ[jqid] <= 0 then
							WAR.BLHQ[jqid] = nil
							WAR.Person[i]["我方"] = not WAR.Person[i]["我方"]	
						end		
					end	
					if WAR.DW[jqid] ~= nil and WAR.WAWY~= 1 then 
					   if WAR.DW[jqid] == 1 then 
						  WAR.Person[i]["我方"] = true
					   end
					   if WAR.DW[jqid] == 2 then 
						  WAR.Person[i]["我方"] = false
					   end
					end
					--12.27改
					if DT(jqid,592) and JLSD(10,60,jqid) then 
						for j = 0, WAR.PersonNum-1 do 
							local df = WAR.Person[j]["人物编号"] 
							if WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false then
								if WAR.Person[j].Time >= 980 and WAR.ZYHB == 0 and WAR.Person[i].Time < WAR.Person[j].Time then 
									WAR.Person[j].Time = 980
									if WAR.Person[j].Time >= 1000 then
										WAR.Person[j].Time = 980
									end 
									DIYdisplay("料敌先机")
									lib.Delay(100)
									DIYdisplay("后发先至")
									WAR.Person[i].Time = 1005
								end
							end
						end			
					end--12.27改
					
					if NF(jqid) and JLSD(50,85,jqid) and juexing() > 2 then 
						for j = 0, WAR.PersonNum-1 do 
							local df = WAR.Person[j]["人物编号"] 
							if WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false then
								if WAR.Person[j].Time >= 980 and WAR.ZYHB == 0 and WAR.Person[i].Time < WAR.Person[j].Time then 
									WAR.Person[j].Time = 980
									if WAR.Person[j].Time >= 1000 then
										WAR.Person[j].Time = 980
									end 
									DIYdisplay("步如风")
									lib.Delay(100)
									DIYdisplay("足如影")
									WAR.Person[i].Time = 1005
								end
							end
						end			
					end 		
					
					if FHXX(jqid) then --风花雪月
						if WAR.FHXY[jqid] == nil then 
						WAR.FHXY[jqid] = 1
						else
						WAR.FHXY[jqid] = WAR.FHXY[jqid] + 1
						end
						if WAR.FHXY[jqid] ~= nil then 
						WAR.Person[i].Time = WAR.Person[i].Time + WAR.FHXY[jqid]*30
						end
					end	
					
					if jtyl(jqid) and WAR.JTWW1 < 50 then 
					   WAR.JTWW1 = WAR.JTWW1 + 1   
					   if  WAR.JTWW1 == 50 then
						DHdisplay(2197, 2219,"九天一流・万物两断")
						WAR.JTWW = 1
						WAR.JTWW1 = 0
						end   
					end
					
					--日月捧月派
					if ((MPPD(jqid)==12 and PersonKF(jqid, 88) and not PersonGT(jqid, 105) and GetS(54,0,0,1) == 1) or DT(jqid,26)) and JLSD(0,30,jqid) and MPDJ(jqid)>1 then 
						for j = 0, WAR.PersonNum-1 do 
							local df = WAR.Person[j]["人物编号"] 
							local offset1 = math.abs(WAR.Person[i]["坐标X"] - WAR.Person[j]["坐标X"]) 
							local offset2 = math.abs(WAR.Person[i]["坐标Y"] - WAR.Person[j]["坐标Y"])
							local offset=offset1+offset2
							local mpdj=MPDJ(jqid)*2			
							if WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false and (offset1<=mpdj and offset2<=mpdj) then
							 local xn=10
							 if offset<=10 then
							 xn=xn+math.modf(offset*2)
							 end
							 local xx=math.modf(xn/2)
							 if WAR.LXZT[WAR.Person[j]["人物编号"]] ~= nil and WAR.LXZT[WAR.Person[j]["人物编号"]] > 0 then 
								AddPersonAttrib(df, "生命", -xx)
							 end
							AddPersonAttrib(df, "内力", -xn)
							AddPersonAttrib(jqid, "内力", xn)	
							WAR.XXQF[df]=WAR.XXQF[df] or 0 + xx
							WAR.XXQG[jqid]=WAR.XXQG[jqid] or 0 + xx
							end
							end		    		
					end
					
					--落英领悟，散华领域
					if  wglw1(jqid,12)  then 
						for j = 0, WAR.PersonNum-1 do 
							local df = WAR.Person[j]["人物编号"] 
							local offset1 = math.abs(WAR.Person[i]["坐标X"] - WAR.Person[j]["坐标X"]) 
							local offset2 = math.abs(WAR.Person[i]["坐标Y"] - WAR.Person[j]["坐标Y"])
							local offset=offset1+offset2
							local mpdj=math.modf((JY.Person[jqid]["拳掌功夫"]+JY.Person[jqid]["御剑能力"])/300)+3		
							if WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false and (offset1<=mpdj and offset2<=mpdj) then
							 local xn=10+mpdj
							 if offset<=10 then
							 xn=xn+math.modf(offset*2)
							 end
							 local xx=math.modf(xn/2)
							 if math.random(10)<4 then
							 WAR.LXZT[WAR.Person[j]["人物编号"]]=WAR.LXZT[WAR.Person[j]["人物编号"]] or 0 +math.random(1,5)
							 end
							 if WAR.LXZT[WAR.Person[j]["人物编号"]] ~= nil and WAR.LXZT[WAR.Person[j]["人物编号"]] > 0 then 
								AddPersonAttrib(df, "生命", -xx)
							 end
							 if JY.Person[WAR.Person[j]["人物编号"]]["生命"] == 0 then
								WAR.Person[j]["死亡"] = true 					   
							 end   
							end
							end		    		
					end
					--木婉清修罗领域
					if DT(jqid,582) and JX(jqid) then 
						local mpdj = math.modf(JY.Person[jqid]["耍刀技巧"] * 0.1)
						for j = 0, WAR.PersonNum-1 do 
							local df = WAR.Person[j]["人物编号"]            		
							if WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false and not ((df == 445 or df == 446) and WAR.ZDDH == 226) then
								local offset1 = math.abs(WAR.Person[i]["坐标X"] - WAR.Person[j]["坐标X"]) 
								local offset2 = math.abs(WAR.Person[i]["坐标Y"] - WAR.Person[j]["坐标Y"])
								local offset = offset1 + offset2
								if offset1 <= mpdj and offset2 <= mpdj then
									--[[
									local xn = 10 + mpdj
									if offset <= 10 then
										offset = 10 - offset
										xn = xn + math.modf(offset * 2)
									end]]
									if math.random(10) < 4 then
										local ab = mpdj / 2			
										AddPersonAttrib(df, "受伤程度", math.floor(ab * 0.1))
										AddPersonAttrib(df, "生命", -math.modf(ab))
										if JY.Person[df]["受伤程度"] > 100 then
											JY.Person[df]["受伤程度"] = 100
											if JY.Person[WAR.Person[j]["人物编号"]]["生命"] == 0 then
												WAR.Person[j]["死亡"] = true 					   
											end  
										end 
									end
								end
							end
						end		    		
					end
		
					if T1LEQ(jqid) and JLSD(0,30,jqid) then 
						for j = 0, WAR.PersonNum-1 do 
							local df = WAR.Person[j]["人物编号"] 
							local offset1 = math.abs(WAR.Person[i]["坐标X"] - WAR.Person[j]["坐标X"]) 
							local offset2 = math.abs(WAR.Person[i]["坐标Y"] - WAR.Person[j]["坐标Y"])
							local offset=offset1+offset2
							local mpdj=10			
							if WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false and (offset1<=mpdj and offset2<=mpdj) then
								local xn=10
								if offset<=10 then
									xn=xn+math.modf(offset*2)
								end
								local xx=math.modf(xn/2)
								if WAR.LXZT[WAR.Person[j]["人物编号"]] ~= nil and WAR.LXZT[WAR.Person[j]["人物编号"]] > 0 then 
									AddPersonAttrib(df, "生命", -xx)
								end
								AddPersonAttrib(df, "内力", -xn)
								AddPersonAttrib(jqid, "内力", xn)	
								WAR.XXQF[df]=WAR.XXQF[df] or 0 + xx
								WAR.XXQG[jqid]=WAR.XXQG[jqid] or 0 + xx
							end
						end		    		
					end

					if wglw(jqid,178) or (DT(jqid,69) and PersonKF(jqid,178)) or T9ZY(jqid) or DT(jqid,602) then --九龙功
						if WAR.Defup[jqid] == 1 then
						   if WAR.Person[i].Time < 500 then 
						   WAR.Person[i].Time = 500
						   end
						elseif WAR.Person[i].Time < 250 then 
						   WAR.Person[i].Time = 250
						end  
					end
					if wglw(jqid,182) or (DT(jqid,5) and PersonGT(jqid,182)) then 
						if WAR.Defup[jqid] == 1 then
							if WAR.Person[i].Time < 400 then 
								WAR.Person[i].Time = 400
							end
							elseif WAR.Person[i].Time < 200 then 
								WAR.Person[i].Time = 200
						end  
					end
					if jqid == 0 and WAR.HFXZ == 1 then --豸苗：九剑后发先制
						for j = 0, WAR.PersonNum - 1 do
						if WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[j].Time >= 980 and WAR.ZYHB == 0 and WAR.Person[i].Time < WAR.Person[j].Time then
						   WAR.Person[j].Time = 980
						   if WAR.Person[j].Time >= 1000 then
							  WAR.Person[j].Time = 980
						   end  
						DIYdisplay("料敌先机")
						lib.Delay(100)
						DIYdisplay("后发先至")
						   WAR.Person[i].Time = 1005
						   WAR.HFXZ = 0
						end
						end	
					end	--12.27改
					
					if XYL(jqid) then --豸苗：谢云流剑冲阴阳
						for j = 0, WAR.PersonNum - 1 do
						if WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[j].Time >= 980 and WAR.ZYHB == 0 and WAR.Person[i].Time < WAR.Person[j].Time
						and WAR.WJGZ[WAR.Person[j]["人物编号"]] ~= nil then 
							WAR.Person[j].Time = 980
						   if WAR.Person[j].Time >= 1000 then
							  WAR.Person[j].Time = 980
						   end 
								DIYdisplay("天道剑势")
								lib.Delay(100)
								DIYdisplay("剑冲阴阳")
						   WAR.Person[i].Time = 1005
						   WAR.WJGZ[WAR.Person[j]["人物编号"]] = nil
						end
						end
					end	
				
					if wglw(jqid,101) or (DT(jqid,117) and PersonKF(jqid,101)) then	--唯我独尊--17-2-27
					   --if WAR.Person[i].Time <= -500 then 
					   --   WAR.WWDZ[WAR.Person[i]["人物编号"]] = 1 
					   --end
					   if WAR.WWDZ[WAR.Person[i]["人物编号"]] == 1 and WAR.Person[i].Time < 1005 then
						for j = 0, WAR.PersonNum-1 do 
						if WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false then
							   if WAR.Person[j].Time >= 1000 then
								  WAR.Person[j].Time = 980
							   end 
						   end
						end		   
						  WAR.Person[i].Time = 1005
					   end
					end
					if wglw2(jqid,118) or DT(jqid,617) or DT(jqid,666) then	  --瞬息千里领悟
						if WAR.WWDZ[WAR.Person[i]["人物编号"]] == 1 and WAR.Person[i].Time < 1005 then
							WAR.ACT = 10
							for j = 0, WAR.PersonNum-1 do 
								if WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false then
									if WAR.Person[j].Time >= 1000 then
										WAR.Person[j].Time = 980
									end 
								end
							end		   
							WAR.Person[i].Time = 1005
						end
					end
					if wglw(jqid,184) and PersonGT(jqid,184) or DT(jqid,665) then	  --瑜伽密乘
						if WAR.YJSG[WAR.Person[i]["人物编号"]] == 1 and WAR.Person[i].Time < 1005 then
							for j = 0, WAR.PersonNum-1 do 
								if WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false then
									if WAR.Person[j].Time >= 1000 then
										WAR.Person[j].Time = 980
									end 
								end
							end		   
							WAR.Person[i].Time = 1005
						end
					end
					if NF(jqid) and juexing() > 2 then
						for j = 0, WAR.PersonNum - 1 do
							if WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[j].Time >= 980 and WAR.ZYHB == 0 and WAR.Person[i].Time < WAR.Person[j].Time
								and WAR.FZZS[WAR.Person[j]["人物编号"]] ~= nil then 
								WAR.Person[j].Time = 980
								if WAR.Person[j].Time >= 1000 then
									WAR.Person[j].Time = 980
								end 
								WAR.Person[i].Time = 1005
								WAR.FZZS[WAR.Person[j]["人物编号"]] = nil
							end
						end
					end	
					if jqid == 0 and WAR.YYHJ == 10 then 
						if WAR.Person[i].Time < 1005  then
						   WAR.Person[i].Time = 1005
						end 
							local tmppid=WAR.CurID
								  WAR.CurID=jqid
								  DHdisplay(1123, 1141, "阴阳汇聚 刹那永劫")
								  WAR.CurID=tmppid			
						for j = 0, WAR.PersonNum-1 do 
						if WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false then
							   if WAR.Person[j].Time >= 1000 then
								  WAR.Person[j].Time = 980
							   end 
						   end
						end	
						WAR.YYHJ = 0 			
					end--12.27改	
					
					if jqid == 0 and zjtype()==1 and tianshu()>=2 and (math.random(1000)<tianshu()+5+math.modf(JY.Person[jqid]["资质"]/20)) then 
						local tmppid=WAR.CurID
						WAR.CurID=jqid
						DHdisplay(605, 627, "临兵冲强行冲击集气")
						local bb=math.modf(JY.Person[jqid]["资质"]/20)
						bb=5+bb
						local aa=math.random(bb)*50
						WAR.Person[i].Time = WAR.Person[i].Time +aa
						if WAR.Person[i].Time >= 1005  then
						   WAR.Person[i].Time = 1005
						end
						DHdisplay(2165, 2182, "集气冲击完成")
						DHdisplay(1123, 1141, "强行冲击"..aa.."点集气")
						if putong()==6 then
						local cc=math.random(bb)*15
						AddPersonAttrib(WAR.Person[i]["人物编号"], "生命", cc)
						DHdisplay(605, 627, "生命奔流"..cc.."点集气")
						end			 
						for j = 0, WAR.PersonNum-1 do 
						if WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false then
							   if WAR.Person[j].Time >= 1000 then
								  WAR.Person[j].Time = 980
							   end 
						   end
						end	
						WAR.CurID=tmppid			
					end--12.27改	 	
		
					if jqid == 0 and zjtype()==1 and putong()==7 and juexing()>0 and (math.random(1000)<tianshu()+15) then 
						local tmppid=WAR.CurID
						WAR.CurID=jqid
						DHdisplay(605, 627, "回天圣手.真八门聚万象")
						Cls()
						zssdz(jqid)
						for i = 12, 30 do
							NewDrawString(-1, -1, "八门聚万象真传." .. "回天返虚", C_WHITE, 25 + i)
							ShowScreen()
							if i == 30 then
								Cls()
								local a = JY.Person[jqid]["半身像"]*2
								lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
								lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
								NewDrawString(-1, -1,"八门聚万象真传." .. "回天返虚", C_WHITE, 25 + i)
								ShowScreen()
								lib.Delay(500)
							else
								lib.Delay(1)
							end
						end
						WAR.Person[i].Time = 1005		
						for j = 0, WAR.PersonNum-1 do 
							if WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false then
								if WAR.Person[j].Time >= 1000 then
									WAR.Person[j].Time = 980
								end 
							end
						end	
						WAR.CurID=tmppid			
					end--12.27改
		
					if jqid == 0 and T1LEQ(jqid) and juexing()>2 and (math.random(1000)<tianshu()+15) then 
						local tmppid=WAR.CurID
						WAR.CurID=jqid
						DHdisplay(605, 627, "逍遥雁行诀发动")
						Cls()
						zssdz(jqid)
						for i = 12, 30 do
							NewDrawString(-1, -1, "逍遥雁行诀" .. "战斗续行", C_WHITE, 25 + i)
							ShowScreen()
							if i == 30 then
								Cls()
								local a = JY.Person[jqid]["半身像"]*2
								lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
								lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
								NewDrawString(-1, -1,"逍遥雁行诀" .. "战斗续行", C_WHITE, 25 + i)
								  ShowScreen()
								  lib.Delay(500)
							else
								lib.Delay(1)
							end
						end
						WAR.Person[i].Time = 1005		
						for j = 0, WAR.PersonNum-1 do 
							if WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false then
								if WAR.Person[j].Time >= 1000 then
									WAR.Person[j].Time = 980
								end 
							end
						end	
						WAR.CurID=tmppid			
					end--12.27改
			
		
					if jqid == 0 and T2SQ(jqid) and juexing()>2 and (math.random(2000)<WAR.YTFS1*5+25) then 
						local tmppid=WAR.CurID
						WAR.CurID=jqid
						DHdisplay(605, 627, "风凌长空")
						Cls()
						zssdz(jqid)
						for i = 12, 30 do
							NewDrawString(-1, -1, "水镜先生" .. "风凌长空", C_WHITE, 25 + i)
							ShowScreen()
							if i == 30 then
								Cls()
								local a = JY.Person[jqid]["半身像"]*2
								lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55,121)
								lib.PicLoadCache(55, a, CC.ScreenW/2, CC.ScreenH/2)
								NewDrawString(-1, -1, "水镜先生" .. "风凌长空", C_WHITE, 25 + i)
								ShowScreen()
								lib.Delay(500)
							else
								lib.Delay(1)
							end
						end
						for j = 0, WAR.PersonNum-1 do 
							if WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false then
								if WAR.Person[j].Time >= 1000 then
									WAR.Person[j].Time = 980
								end 
							end
						end
						WAR.SQGJ = 1			
						War_Fight_Sub(i, 2, WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"])	
						WAR.Person[WAR.CurID][CC.TXDH] = 65
						WAR.SQGJ = 0
						WAR.WS = 1
						WAR.CurID=tmppid
						xunhuan=false			
					end--12.27改
			
			
					if jqid == 0 and zjtype()==4 and tianshu()>=2 and (math.random(1000)<tianshu()+5+math.modf(JY.Person[jqid]["资质"]/20)) then 
						local tmppid=WAR.CurID
						WAR.CurID=jqid
						DHdisplay(605, 627, "皆阵行强行冲击集气")
						local bb=math.modf(JY.Person[jqid]["资质"]/20)
						bb=5+bb
						local aa=math.random(bb)*50
						local cc=math.random(bb)*15
						WAR.Person[i].Time = WAR.Person[i].Time +aa
						if WAR.Person[i].Time >= 1005  then
						   WAR.Person[i].Time = 1005
						end
						AddPersonAttrib(WAR.Person[i]["人物编号"], "生命", cc)
						DHdisplay(2165, 2182, "次元积蓄完成")
						DHdisplay(1123, 1141, "强行冲击"..aa.."点集气")
						DHdisplay(1258, 1275, "强行恢复"..cc.."点生命")   			
						for j = 0, WAR.PersonNum-1 do 
						if WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false then
							   if WAR.Person[j].Time >= 1000 then
								  WAR.Person[j].Time = 980
							   end 
						   end
						end	
						WAR.CurID=tmppid			
					end--皆阵术强行冲击集气
					
					
					if WAR.JSJY[200+jqid] ~= nil then --剑势剑影
						WAR.JSJY[100+jqid] = WAR.JSJY[100+jqid] - 1
						if WAR.JSJY[100+jqid] <= 0 then
							xunhuan = false 
							for j = 0,WAR.PersonNum-1 do 
								if WAR.Person[j]["我方"] == WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false then 
									if WAR.JSJY[WAR.Person[j]["人物编号"]]== WAR.Person[i]["人物编号"] then
										WAR.JSJY[WAR.Person[j]["人物编号"]] = nil
									end  
								end 
							end
						  WAR.JSJY[100+jqid] = nil
						  WAR.Person[i]["死亡"] = true
						end
						local x,y = WAR.Person[i]["坐标X"],WAR.Person[i]["坐标Y"]
						for j = 0,WAR.PersonNum-1 do 
							if WAR.Person[j]["我方"] == WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == true then 
								if WAR.JSJY[WAR.Person[j]["人物编号"]]== WAR.Person[i]["人物编号"] then
									xunhuan = false
									--and WAR.Person[i]["人物编号"] ~= WAR.JSJY[WAR.Person[j]["人物编号"]] then
									DHdisplay(2165, 2182, "秘剑演武・剑势剑影")
									JY.Person[WAR.JSJY[200+WAR.Person[i]["人物编号"]]]["生命"] = JY.Person[WAR.Person[i]["人物编号"]]["生命"]
									WAR.Person[i]["死亡"] = true
									WAR.JSJY[WAR.Person[j]["人物编号"]] = nil
									--NewWARPersonZJ(WAR.JSJY[200+WAR.Person[i]["人物编号"]], true, x, y, false, 1); 
									WAR.JSJY[200+jqid] = nil
									WAR.Person[j]["死亡"] = false
									WAR.MJYW[WAR.Person[j]["人物编号"]] = 1
									--WAR.Person[i]["死亡"] = true
								end  
							end 
						end	
						if WAR.JSJY[300+jqid] == 1 then 
						   WAR.Person[i].Time = 1005
						end			
					end
					
					if WAR.SFJS[200+jqid] ~= nil then 
						WAR.SFJS [100+jqid] = WAR.SFJS[100+jqid] - 1
						if WAR.SFJS[100+jqid] <= 0 then
							xunhuan = false 
							for j = 0,WAR.PersonNum-1 do 
								if WAR.Person[j]["我方"] == WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false then 
									if WAR.SFJS[WAR.Person[j]["人物编号"]]== WAR.Person[i]["人物编号"] then
										WAR.SFJS[WAR.Person[j]["人物编号"]] = nil
									end  
								end 
							end
							WAR.SFJS[100+jqid] = nil
							WAR.Person[i]["死亡"] = true
						end
						local x,y = WAR.Person[i]["坐标X"],WAR.Person[i]["坐标Y"]
						for j = 0,WAR.PersonNum-1 do 
							if WAR.Person[j]["我方"] == WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == true then 
								if WAR.SFJS[WAR.Person[j]["人物编号"]]== WAR.Person[i]["人物编号"] then
									xunhuan = false
									DHdisplay(2165, 2182, "玄武真功・十强武道")
									JY.Person[WAR.SFJS[200+WAR.Person[i]["人物编号"]]]["生命"] = JY.Person[WAR.Person[i]["人物编号"]]["生命"]
									WAR.Person[i]["死亡"] = true
									WAR.SFJS[WAR.Person[j]["人物编号"]] = nil
									WAR.SFJS[200+jqid] = nil
									WAR.Person[j]["死亡"] = false
									WAR.SFJM[WAR.Person[j]["人物编号"]] = 1
								end  
							end 
						end	
						if WAR.SFJS[300+jqid] == 1 then 
						   WAR.Person[i].Time = 1005
						end			
					end		
					
					if WAR.NJXY[200+jqid] ~= nil then 
						WAR.NJXY[100+jqid] = WAR.NJXY[100+jqid] - 1
						if WAR.NJXY[100+jqid] <= 0 then
							xunhuan = false 
							for j = 0,WAR.PersonNum-1 do 
								if WAR.Person[j]["我方"] == WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false then 
									if WAR.NJXY[WAR.Person[j]["人物编号"]]== WAR.Person[i]["人物编号"] then
										WAR.NJXY[WAR.Person[j]["人物编号"]] = nil
									end  
								end 
							end
							WAR.NJXY[100+jqid] = nil
							WAR.Person[i]["死亡"] = true
						end
						local x,y = WAR.Person[i]["坐标X"],WAR.Person[i]["坐标Y"]
						for j = 0,WAR.PersonNum-1 do 
							if WAR.Person[j]["我方"] == WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == true then 
								if WAR.NJXY[WAR.Person[j]["人物编号"]]== WAR.Person[i]["人物编号"] then
									xunhuan = false
									DHdisplay(2209, 2218, "风无相・以气留型")
									JY.Person[WAR.NJXY[200+WAR.Person[i]["人物编号"]]]["生命"] = JY.Person[WAR.Person[i]["人物编号"]]["生命"]
									WAR.Person[i]["死亡"] = true
									WAR.NJXY[WAR.Person[j]["人物编号"]] = nil
									WAR.NJXY[200+jqid] = nil
									WAR.Person[j]["死亡"] = false
									WAR.XYCD[WAR.Person[j]["人物编号"]] = 1
								end  
							end 
						end	
						if WAR.NJXY[300+jqid] == 1 then 
						   WAR.Person[i].Time = 1005
						end			
					end			
					
					if WAR.TMMS[500+jqid] ~= nil then --唐门模式千机变
					    WAR.TMMS[500+jqid] = WAR.TMMS[500+jqid] - 1
						if WAR.QJBMS[1000+jqid] ==nil then 
							WAR.QJBMS[1000+jqid] = 1 
						else 
							WAR.QJBMS[1000+jqid] = WAR.QJBMS[1000+jqid]+1 
						end
						if WAR.QJBMS[jqid] == 1 then
							if WAR.QJBMS[1000+jqid] == 15 then
								for j = 0, WAR.PersonNum-1 do 
									if WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false then
										if WAR.Person[j].Time >= 1000 then
											WAR.Person[j].Time = 980
										end 
									end
								end		   
								WAR.Person[i].Time = 1005
								WAR.QJBMS[1000+jqid] = nil
							end
						elseif WAR.QJBMS[jqid] == 2 then 
							if WAR.QJBMS[1000+jqid] == 30 then
								for j = 0, WAR.PersonNum-1 do 
									if WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false then
										if WAR.Person[j].Time >= 1000 then
											WAR.Person[j].Time = 980
										end 
									end
								end		   
								WAR.Person[i].Time = 1005
								WAR.QJBMS[1000+jqid] = nil
							end
						else 
							if WAR.QJBMS[1000+jqid] == 10 then
								for j = 0, WAR.PersonNum-1 do 
									if WAR.Person[j]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false then
										if WAR.Person[j].Time >= 1000 then
											WAR.Person[j].Time = 980
										end 
									end
								end		   
								WAR.Person[i].Time = 1005
								WAR.QJBMS[1000+jqid] = nil
							end
						end
						if WAR.TMMS[500+jqid] <= 0 then
							xunhuan = false 
							for j = 0,WAR.PersonNum-1 do 
								if WAR.Person[j]["我方"] == WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false then 
									if WAR.TMMS[400+WAR.Person[j]["人物编号"]]== WAR.Person[i]["人物编号"] then
										WAR.TMMS[400+WAR.Person[j]["人物编号"]] = nil
									end  
								end 
							end
							WAR.TMMS[500+jqid] = nil
							WAR.Person[i]["死亡"] = true
						end		
						if WAR.Person[i]["死亡"] == true then 
							for j = 0,WAR.PersonNum-1 do 
								if WAR.Person[j]["我方"] == WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == false then 
									if WAR.TMMS[400+WAR.Person[j]["人物编号"]]== WAR.Person[i]["人物编号"] then
										WAR.TMMS[400+WAR.Person[j]["人物编号"]] = nil
									end  
								end 
							end
						end		   
					end

			 --  for j = 0,WAR.PersonNum-1 do 
			   --    if WAR.Person[j]["我方"] == WAR.Person[i]["我方"] and WAR.Person[j]["死亡"] == true and WAR.TMMS[500+WAR.Person[j]["人物编号"]] ~= nil then 
					--    WAR.TMMS[400+WAR.Person[i]["人物编号"]] = nil
					--	WAR.TMMS[500+WAR.Person[j]["人物编号"]] = nil
				  -- end 
			 --  end
			--end
					if WAR.NS[jqid] ~= nil and WAR.NS[jqid] > 0 then --豸苗：日月神教逆杀
						WAR.NS[jqid] = WAR.NS[jqid] - 1
						if WAR.NS[jqid] <= 0 then
							WAR.NS[jqid] = nil
						end		
					end
					
					if WAR.BWAX[jqid] ~= nil and WAR.BWAX[jqid] > 0 then --豸苗：李秋水
						WAR.BWAX[jqid] = WAR.BWAX[jqid] - 1
						if WAR.BWAX[jqid] <= 0 then
							WAR.BWAX[jqid] = nil
						end		
					end
					
					if WAR.SZWH[jqid] ~= nil and WAR.SZWH[jqid] > 0 then --豸苗：狮子王吼  
						WAR.SZWH[jqid] = WAR.SZWH[jqid] - 1
						if WAR.SZWH[jqid] > 75 then 
						   WAR.SZWH[jqid] = 75 
						end 			
						if WAR.SZWH[jqid] <= 0 then
							WAR.SZWH[jqid] = nil
						end		
					end	
					
					if WAR.LHFM[jqid] ~= nil and WAR.LHFM[jqid] > 0 then --豸苗：罗汉伏魔
						WAR.LHFM[jqid] = WAR.LHFM[jqid] - 1
						if WAR.LHFM[jqid] > 20 then 
						   WAR.LHFM[jqid] = 20
						end
						if WAR.LHFM[jqid] <= 0 then
							WAR.LHFM[jqid] = nil
						end	
					end	
					
					if WAR.OYFSD[jqid] ~= nil and WAR.OYFSD[jqid] > 0 then --豸苗：欧阳锋蛇毒
						WAR.OYFSD[jqid] = WAR.OYFSD[jqid] - 1
						if WAR.OYFSD[jqid] <= 0 then
							WAR.OYFSD[jqid] = nil
						end		
					end	

					if WAR.KHG[jqid] ~= nil and WAR.KHG[jqid] > 0 then --豸苗：谢烟客控鹤功
						WAR.KHG[jqid] = WAR.KHG[jqid] - 1
						if WAR.KHG[jqid] <= 0 then
							WAR.KHG[jqid] = nil
						end		
					end	
					
					if WAR.TXJ[jqid] ~= nil and WAR.TXJ[jqid] > 0 then --豸苗：太玄经
						WAR.TXJ[jqid] = WAR.TXJ[jqid] - 1
						if WAR.TXJ[jqid] <= 0 then
							WAR.TXJ[jqid] = nil
						end		
					end	
					if WAR.TXJ2[jqid] ~= nil and WAR.TXJ2[jqid] > 0 then --豸苗：太玄经
						WAR.TXJ2[jqid] = WAR.TXJ2[jqid] - 1
						if WAR.TXJ2[jqid] <= 0 then
							WAR.TXJ2[jqid] = nil
						end		
					end	
					
					if WAR.PEACE[jqid] ~= nil and WAR.PEACE[jqid] > 0 then 
						WAR.PEACE[jqid] = WAR.PEACE[jqid] - 1
						if WAR.PEACE[jqid] <= 0 then
							WAR.PEACE[jqid] = nil
						end		
					end					

					if WAR.POISON[jqid] ~= nil and WAR.POISON[jqid] > 0 then 
						WAR.POISON[jqid] = WAR.POISON[jqid] - 1
						if WAR.POISON[jqid] <= 0 then
							WAR.POISON[jqid] = nil
						end		
					end				
					
					if WAR.CONFUSE[jqid] ~= nil and WAR.CONFUSE[jqid] > 0 then 
						WAR.CONFUSE[jqid] = WAR.CONFUSE[jqid] - 1
						if WAR.CONFUSE[jqid] <= 0 then
							WAR.CONFUSE[jqid] = nil
							if WAR.CONFUSEO[jqid] == 1 then 
							   WAR.Person[i]["我方"] = true
							elseif WAR.CONFUSEO[jqid] == 2 then
							   WAR.Person[i]["我方"] = false
							end
							--WAR.Person[i]["我方"] = WAR.CONFUSEO[jqid]
							--WAR.CONFUSEO[jqid] = nil
						end
					end				
					
					if T8LXY(jqid) then --李逍遥仙风30时序
						if WAR.LXYXF > 0 then 
							WAR.LXYXF = WAR.LXYXF - 1
						end
					end
					
					if DT3(jqid , 54) then --袁承志虎乱100时序
						if WAR.YCZHL[jqid] ~= nil and WAR.YCZHL[jqid] > 0 then 
							WAR.YCZHL[jqid] = WAR.YCZHL[jqid] - 1
							if WAR.YCZHL[jqid] <= 0 then
								WAR.YCZHL[jqid] = nil
							end
						end
					end
					
					if T9ZY(jqid) and juexing() > 2 then
						if JY.Person[jqid]["生命"] > math.modf(JY.Person[jqid]["生命最大值"]/2) then --赵云无双100时序
						   WAR.ZYWS = 0
						end   
						if JY.Person[jqid]["生命"] < math.modf(JY.Person[jqid]["生命最大值"]/2) and WAR.ZYWS == 0 then
						   WAR.ZYWS = 1
						   WAR.LQZ[jqid] = 100
						   WAR.FXDS[jqid] = nil
						   WAR.LXZT[jqid] = nil
						   WAR.CHZ[jqid] = nil
						   JY.Person[jqid]["受伤程度"] = 0
						   JY.Person[jqid]["中毒程度"] = 0
						--   WAR.Person[i].TimeAdd = WAR.Person[i].TimeAdd*2
						   WAR.JQSDXS[WAR.Person[i]["人物编号"]]=WAR.Person[i].TimeAdd*2
						end
						if JY.Person[jqid]["生命"] < math.modf(JY.Person[jqid]["生命最大值"]/2) and WAR.ZYWS == 1 then
						   WAR.LQZ[jqid] = 100
						end
					end		
					if jtyl(jqid) then 
						WAR.Person[i].Time = WAR.Person[i].Time + WAR.YDSD[WAR.Person[i]["人物编号"]]
						if WAR.LQZ[jqid] == 100 then
						WAR.Person[i].Time = WAR.Person[i].Time + WAR.YDSD[WAR.Person[i]["人物编号"]]
						end
						if WAR.SJSM[1000+jqid] ~= nil then 
						if JY.Person[jqid]["生命"] < WAR.SJSM[1000+jqid] then 
						JY.Person[jqid]["生命"] = WAR.SJSM[1000+jqid]
						end
						end
						WAR.FXDS[jqid] = 0
					end
						
					if jtyl(jqid) then
						local x1 = WAR.Person[i]["坐标X"];
						local y1 = WAR.Person[i]["坐标Y"];
						for ex = x1 - 8, x1 + 8 do
							for ey = y1 - 8, y1 + 8 do
								SetWarMap(ex, ey, 4, 1)
								if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
									local ep = GetWarMap(ex, ey, 2)
									if WAR.Person[i]["我方"] ~= WAR.Person[ep]["我方"] and not jtyl(WAR.Person[ep]["人物编号"]) then
										--AddPersonAttrib(WAR.Person[ep]["人物编号"], "生命", -8)
										JY.Person[WAR.Person[ep]["人物编号"]]["生命"] = JY.Person[WAR.Person[ep]["人物编号"]]["生命"] - 10
										if JY.Person[WAR.Person[ep]["人物编号"]]["生命"] == 0 then
										   WAR.Person[ep]["死亡"] = true
										--   lib.SetWarMap(WAR.Person[ep]["坐标X"], WAR.Person[ep]["坐标Y"], 5, -1)
										  -- lib.SetWarMap(WAR.Person[ep]["坐标X"], WAR.Person[ep]["坐标Y"], 2, -1)							   
										end   
									end
								end
							end
						end
					end
			
					if WAR.XRWDNX[jqid] ~= nil then
						WAR.Person[i].TimeAdd = 0
						WAR.XRWDNX[jqid] = WAR.XRWDNX[jqid] - 1
						if WAR.XRWDNX[jqid] <= 0 then
							WAR.XRWDNX[jqid] = nil
						end
					end
					--判断是否在正常数据范围之内
					if JY.Person[jqid]["中毒程度"] < 0 then
						JY.Person[jqid]["中毒程度"] = 0;
					end
					if JY.Person[jqid]["中毒程度"] > 100 then
						JY.Person[jqid]["中毒程度"] = 100;
					end
					if JY.Person[jqid]["受伤程度"] < 0 then
						JY.Person[jqid]["受伤程度"] = 0;
					end
					if JY.Person[jqid]["受伤程度"] > 100 then
						JY.Person[jqid]["受伤程度"] = 100;
					end		
					if JY.Person[jqid]["体力"] > 100 then
						JY.Person[jqid]["体力"] = 100;
					end				
					if JY.Person[jqid]["体力"] < 0 then
						JY.Person[jqid]["体力"] = 0;
					end							
					if JY.Person[jqid]["内力"] < 0 then JY.Person[jqid]["内力"] = 0 end
					if JY.Person[jqid]["生命"] < 0 then JY.Person[jqid]["生命"] = 0 end
					if JY.Person[jqid]["内力最大值"] < JY.Person[jqid]["内力"] then
					  JY.Person[jqid]["内力"] = JY.Person[jqid]["内力最大值"]
					end
					if JY.Person[jqid]["生命最大值"] < JY.Person[jqid]["生命"] then
						JY.Person[jqid]["生命"] = JY.Person[jqid]["生命最大值"]
					end
			 
					if WAR.Person[i].Time >= 1000 then
						if WAR.ZYHB == 1 then
							if i ~= WAR.ZYHBP then
								WAR.Person[i].Time = 990
							else
								WAR.Person[i].Time = 1001
							end
						end
						xunhuan = false
					end
				--集气过程中按键有效
					local keypress = lib.GetKey()
					if WAR.AutoFight == 1 and (keypress == VK_SPACE or keypress == VK_RETURN) then
						WAR.AutoFight = 0
					end
					if keypress == 113 or keypress == 290 then
						if DrawStrBoxYesNo(-1, -1, "真的要放弃战斗么？", C_WHITE, 30) == true then
							for i = 0, WAR.PersonNum - 1 do
								if WAR.Person[i]["我方"] then
									WAR.Person[i]["死亡"] = true
								end		
							end
						return 1
					end
				  --[[if DrawStrBoxYesNo(-1, -1, CC.s74, C_WHITE, 30) == true then
					JY.Status = x
				  end]]
					Cls()
					end
					if keypress == 127 and JY.WGLVXS == 1 then
						for d = 0, WAR.PersonNum - 1 do
							if WAR.Person[d]["我方"] == false then
							WAR.Person[d]["死亡"] = true
							end
						end
					end
					if keypress == 277 and JY.WGLVXS == 1 then
						if JY.ZJSL == 0 then
							JY.ZJSL = 1
						else
							JY.ZJSL = 0
						end
					end
				end
			end
		end
		
		DrawTimeBar_sub(x1, x2, y, 0)
		ShowScreen()
		lib.Delay(delay)
		if flag == 1 then
			WarDrawMap(0);
		end
		WAR.SXTJ = WAR.SXTJ + 1
		if WAR.NOTF ~= nil and WAR.NOTF[3] ~= nil and WAR.NOTF[3] > 0 then 
			WAR.NOTF[3] = WAR.NOTF[3] - 1
			if WAR.NOTF[3] <= 0 then
				WAR.NOTF = nil
			end		
		end		
	end
    for i = 0, WAR.PersonNum - 1 do
		if WAR.Person[i]["死亡"] == false then
			WAR.Person[i].TimeAdd = 0
		end
    end
    WAR.ZYHBP = -1
    lib.Delay(100)
    lib.FreeSur(surid)
end
--绘画整体集气条
function DrawTimeBar_sub(x1, x2, y, flag)
    if not x1 then
       x1 = CC.ScreenW * 5 / 8
    end
    if not x2 then
       x2 = CC.ScreenW * 15 / 16
    end
    if not y then
       y = CC.FontSmall * 5
    end
    local least = WAR.LifeNum * 15
    if flag == 1 then
       least = 0
    end
    DrawBox_1(x1 - 3, y, x2 + 3, y + 3, C_ORANGE)
    DrawBox_1(x1 - (x2 - x1) / 2, y, x1 - 3, y + 3, C_RED)
    DrawString(x1 - (x2 - x1) / 2 - 20, y - 23, "连锁", C_WHITE, 15) --连锁显示
    if math.max(WAR.URCHAIN, WAR.MYCHAIN) < 2 then
	   DrawString(x1 - (x2 - x1) / 2 - 20, y - 3, "0", C_GOLD, 20)  
    else
	   DrawString(x1 - (x2 - x1) / 2 - 20, y - 3, math.max(WAR.URCHAIN, WAR.MYCHAIN), C_GOLD, 20)  
    end
    for i = 0, WAR.PersonNum - 1 do
    if not WAR.Person[i]["死亡"] then
      local cx = x1 + math.modf(WAR.Person[i].Time*(x2 - x1)/1000)
      local color = C_WHITE
      if WAR.Person[i].TimeAdd < 5 then
        color = C_ORANGE
      end
	  if WAR.ICE[WAR.Person[i]["人物编号"]] ~= 0 then
	  	color = M_DeepSkyBlue
	  end
	  if (WAR.HOT[WAR.Person[i]["人物编号"]] or 0) >= 30 then
	  	color = C_RED
	  end	  
      if WAR.Person[i]["我方"] then
        drawname(cx, 0, JY.Person[WAR.Person[i]["人物编号"]]["姓名"], CC.FontSmall, color)
		local th = gethead(WAR.Person[i]["人物编号"])
        local w, h = lib.PicGetXY(99, th * 2)
		
        lib.PicLoadCache(99, th * 2, cx - w / 2, y - h - 8, 1, 0)
        --改成都显示集气速度
        if WAR.JQSDXS[WAR.Person[i]["人物编号"]] ~= nil  then
        	DrawString(cx - w / 2 + 2, y - h - 4 + 18, WAR.JQSDXS[WAR.Person[i]["人物编号"]], C_GOLD, 15)
      	end
      else
			local th = gethead(WAR.Person[i]["人物编号"])
	      local w, h = lib.PicGetXY(99, th * 2)
	      lib.PicLoadCache(99, th * 2, cx - w / 2, y + 6, 1, 0)
	      
	      --改成都显示集气速度
	      if WAR.JQSDXS[WAR.Person[i]["人物编号"]] ~= nil then
	        DrawString(cx - w / 2 + 2, y + 6 + 18, WAR.JQSDXS[WAR.Person[i]["人物编号"]], C_GOLD, 15)
	      end
	      drawname(cx, y + 32, JY.Person[WAR.Person[i]["人物编号"]]["姓名"], CC.FontSmall, color)
	    end
    end
    end
    DrawString(x2 + 10, y - 23, CC.s39, C_WHITE, 15)
    DrawString(x2 + 10, y - 3, WAR.SXTJ, C_GOLD, 20)
  
    if CC.MyShowWarInfo == 1 then 
	  local hp = math.modf(JY.Person[0]["生命"] * 320 / JY.Person[0]["生命最大值"])
	  local mp = math.modf(JY.Person[0]["内力"] * 320 / JY.Person[0]["内力最大值"])
	  local zt1 = math.modf(JY.Person[0]["受伤程度"] * 100 / 100)
	  local fx, lx = 0, 0
	  if WAR.FXDS[0] ~= nil then
	    fx = WAR.FXDS[0]
	  end
	  if WAR.LXZT[0] ~= nil then
	    lx = WAR.LXZT[0]
	  end
	  
	  local chz = 0;
	  if WAR.CHZ[0] ~= nil then
	  	chz = WAR.CHZ[0];
	  end
	  
	  --蓝烟清：增加中毒和怒气值显示，迟缓显示
	  local zt4 = math.modf(JY.Person[0]["中毒程度"] * 100 / 100);		--显示中毒
	  local lqz = 0;
	  if WAR.LQZ[0] ~= nil then
	  	lqz = WAR.LQZ[0];
	  end
	  local zt5 = math.modf(lqz * 100 / 100);			--显示怒气值
	  local zt6 = math.modf(chz * 100 / 100);		--显示迟缓
	  
	  -------------------------------------------
	  
	  local zt2 = math.modf(fx * 100 / 50)
	  local zt3 = math.modf(lx * 100 / 100)
	  local A, B = x1 - (10 + (x2 - x1) / 2) + 35, y * 2 + 15
	  local a = 0
	  local my = nil
	  for t = 0, WAR.PersonNum - 1 do
	    if WAR.Person[t]["人物编号"] == 0 and WAR.Person[t]["死亡"] == false then
	      a = 1
	      my = t
	    end
	  end
	  if a == 1 then
	    local hid = 0
	    hid = gethead(hid)
	    lib.PicLoadCache(99, (hid) * 2, A - 25, B - 3, 1, 0)
	    DrawBox_1(A, B, A + 320, B + 10, C_RED)
	    lib.Background(A, B, A + hp - 1, B + 10, 50, C_RED)
	    DrawString(A + 2, B + 1, "生命", C_GOLD, 8)
	    DrawBox_1(A, B + 10, A + 320, B + 20, M_DeepSkyBlue)			--蓝烟清：修改内力显示条为天蓝色
	    lib.Background(A, B + 10, A + mp - 1, B + 20, 50, M_DeepSkyBlue)
	    DrawString(A + 2, B + 11, "内力", C_GOLD, 8)
	    DrawBox_1(A, B + 20, A + 100, B + 30, C_RED)
	    lib.Background(A, B + 20, A + zt1 - 1, B + 30, 50, C_RED)
	    DrawString(A + 2, B + 21, "内伤", C_GOLD, 8)
	    DrawBox_1(A + 110, B + 20, A + 210, B + 30, C_ORANGE)
	    lib.Background(A + 110, B + 20, A + 110 + zt2 - 1, B + 30, 50, C_ORANGE)
	    DrawString(A + 2 + 110, B + 21, "封穴", C_GOLD, 8)
	    DrawBox_1(A + 220, B + 20, A + 320, B + 30, C_RED)
	    lib.Background(A + 220, B + 20, A + 220 + zt3 - 1, B + 30, 50, C_RED)
	    DrawString(A + 2 + 220, B + 21, "流血", C_GOLD, 8)
	    
	    --蓝烟清：绘画中毒和怒气值
	    DrawBox_1(A, B + 30 + 2, A + 100, B + 40 + 2, M_Green)
	    lib.Background(A, B + 30 + 2, A + zt4 - 1, B + 40 + 2, 50, M_Green)
	    DrawString(A + 2, B + 31 + 2, "中毒", C_GOLD, 8)
	    
	    DrawBox_1(A + 110, B + 30 + 2, A + 210, B + 40 + 2, M_Yellow)
	    if lqz >= 100 then
	    	lib.Background(A + 110, B + 30 + 2, A + 110 + zt5 - 1, B + 40 + 2, 50, C_RED)
	   	else
	    	lib.Background(A + 110, B + 30 + 2, A + 110 + zt5 - 1, B + 40 + 2, 50, M_Yellow)
	    end
	    DrawString(A + 2 + 110, B + 31 + 2, "怒气", C_GOLD, 8)
	    
	    --蓝烟清：绘画迟缓
	    DrawBox_1(A + 220, B + 30 + 2, A + 320, B + 40 + 2, RGB(134,194,255))
	    lib.Background(A + 220, B + 30 + 2, A  + 220 + zt6 - 1, B + 40 + 2, 50, RGB(134,194,255))
	    DrawString(A + 2 + 220, B + 31 + 2, "迟缓", C_GOLD, 8)
	    ------------------------------------------
	    
	  end
	  if my ~= nil and JY.WGLVXS == 1 then
	    DrawString(10, CC.ScreenH - 20, WAR.Person[my]["坐标X"] .. "  " .. WAR.Person[my]["坐标Y"], C_WHITE, 20)
	  end
	end
end


--开始新游戏
function SBLNewGame()
    SBLDATAL(0)       --加载新游戏默认数据
    resetRW()
    JY.TERM = JY.Thing[203][WZ6]
    local w = filelength(CONFIG.DataPath .. "waring.grp")
    local d = Byte.create(w)
    Byte.loadfile(d, CONFIG.DataPath .. "waring.grp", 0, w)
    local ss = Byte.hash(d, w)
    if ss ~= -191974594 then
  	   --lib.Debug("ss="..ss);
      --xx = xx
    end

    local zs1, zs2 = GetS(100, 10, 10, 4), GetS(100, 10, 10, 5)
    CC.S_Filename[0] = CONFIG.DataPath .. "waring.grp"
    lib.LoadSMap(CC.S_Filename[0], CC.TempS_Filename, JY.SceneNum, CC.SWidth, CC.SHeight, CC.D_Filename[0], CC.DNum, 11)
    CC.S_Filename[0] = CONFIG.DataPath .. "allsin.grp"
    SetS(100, 10, 10, 4, zs1)
    SetS(100, 10, 10, 5, zs2)
    FRISTWORK()    --初始化游戏的状态  像是验证用的
    CXDYWPSX()   --初始化自定义的物品设置，人物设置
    CSPJC()   --人物数据验证，验证不通过不给玩游戏。。。
    CSWPJC()  --物品数据验证
    CSCJJC()  --场景数据验证
    CSWGJC()  --武功数据验证
    CSSDJC()  --商店数据验证
    ClsN()   --清除贴图
    lib.FillColor(0, 0, CC.ScreenW, CC.ScreenH, C_BLACK)
    ShowScreen()
    lib.Delay(10)
    local ssid = lib.SaveSur(0, 0, CC.ScreenW, CC.ScreenH)
    lib.FreeSur(ssid)
	
    --武骧金星：一些初始化调整
	for i = 0,JY.PersonNum-1 do 
	   for j = 11,HHH_GAME_SETTING["WG_COUNT_MAX"] do 
	    JY.Person[i]["武功"..j] = 0
	   end 
	end   
	
	--[[if JY.ZLXF == 1	then	--飞影彩蛋：真龙心法
		JY.Wugong[91]["名称"] = "真龙心法"
	end]]
	

	JY.Thing[268]["名称"] = "斩流剑术"
    JY.Thing[268]["物品说明"] = "谢云流独门武功"
    JY.Thing[268]["练出武功"] = 131
    JY.Thing[268]["加攻击力"] = 3
	JY.Thing[268]["加防御力"] = 2
	JY.Thing[268]["加轻功"] = 3
    JY.Thing[268]["加御剑能力"] = 4
	JY.Thing[268]["需御剑能力"] = 320
	JY.Wugong[14]["攻击力10"] = 1100
	JY.Wugong[39]["名称"] = "北斗罡剑"
	JY.Wugong[42]["名称"] = "玉女素心剑"
	JY.Wugong[104]["名称"] = "逆运筋脉"
	JY.Wugong[132]["武功类型"] = 1 --白虹掌法
	JY.Wugong[133]["武功类型"] = 1 --参合指
	JY.Thing[238]["需资质"] = 0
    JY.Thing[339]["名称"] = "凌波微步"
    JY.Thing[339]["物品说明"] = "逍遥派绝世轻功"
    JY.Thing[339]["练出武功"] = 179
    JY.Thing[339]["加攻击力"] = 1
    JY.Thing[339]["加轻功"] = 4
    JY.Thing[339]["需轻功"] = 300
    JY.Thing[340]["练出武功"] = 180
    JY.Thing[340]["加攻击力"] = 2
    JY.Thing[340]["加防御力"] = 0
    JY.Thing[340]["加轻功"] = 2
    JY.Thing[340]["加内力最大值"] = 20
    for i,v in pairs(CC.Wugong_S) do
    JY.Wugong[131][i] = JY.Wugong[110][i]
    end
    JY.Wugong[131]["攻击力10"] = 1500
    JY.Wugong[131]["移动范围10"] = 8
    JY.Wugong[131]["杀伤范围10"] = 8
    JY.Wugong[131]["名称"] = "斩流剑术"

    for i,v in pairs(CC.Thing_S) do
    JY.Thing[280][i] = JY.Thing[240][i]
    end
    JY.Thing[280]["名称"] = "一苇渡江"
    JY.Thing[280]["物品说明"] = "少林绝世轻功"
    JY.Thing[280]["练出武功"] = 143
    JY.Thing[280]["加攻击力"] = 1
    JY.Thing[280]["加轻功"] = 3
    JY.Thing[280]["需轻功"] = 220
    for i,v in pairs(CC.Wugong_S) do
    JY.Wugong[143][i] = JY.Wugong[117][i]
    end
    JY.Wugong[143]["名称"] = "一苇渡江"
	for i = 138, 141 do
		JY.Wugong[i]["武功类型"] = 3
	end
	for i = 142, 147 do
		JY.Wugong[i]["武功类型"] = 4
	end	

        JY.Thing[0]["加生命"]= 300        --小还丹
		JY.Thing[0]["加内力"]= 200        
		JY.Thing[0]["加体力"]= 2          
        JY.Thing[1]["加生命"]= 400        --天香断续膏
		JY.Thing[1]["加内力"]= 300        
		JY.Thing[1]["加体力"]= 3          
        JY.Thing[2]["加生命"]= 800        --黑玉断续膏 
		JY.Thing[2]["加内力"]= 500        
		JY.Thing[2]["加体力"]= 5         
        JY.Thing[3]["加内力"]= 550        --白云熊胆丸 
		JY.Thing[3]["加生命"]= 350        
		JY.Thing[3]["加体力"]= 3          
        JY.Thing[4]["加内力"]= 800        --田七沙胆散
		JY.Thing[4]["加生命"]= 500        
		JY.Thing[4]["加体力"]= 5          
        JY.Thing[5]["加内力"]= 1100       --九花玉露丸
        JY.Thing[5]["加生命"]= 600        
		JY.Thing[5]["加体力"]= 6          
        JY.Thing[6]["加内力"]= 3600       --九转熊蛇丸 
		JY.Thing[6]["加生命"]= 800        
		JY.Thing[6]["加体力"]= 8          
        JY.Thing[7]["加生命"]= 500        --无常丹 
        JY.Thing[7]["加内力"]= 500         		
		JY.Thing[7]["加体力"]= 5           
        JY.Thing[8]["加生命"]= 1200       --天王保命丹      
        JY.Thing[8]["加内力"]= 3500 
		JY.Thing[8]["加中毒解毒"] = - 50
        JY.Thing[8]["加体力"] = 50
		JY.Thing[9]["加中毒解毒"] = - 10  --牛黄解毒丸
		JY.Thing[9]["加生命"]= 200           
        JY.Thing[9]["加内力"]= 300 
		JY.Thing[10]["加中毒解毒"] = - 20 --牛黄血蝎丹
		JY.Thing[10]["加生命"]= 400           
        JY.Thing[10]["加内力"]= 600 
		JY.Thing[11]["加中毒解毒"] = - 30 --六阳正气丹 
		JY.Thing[11]["加生命"]= 600           
        JY.Thing[11]["加内力"]= 800     
        JY.Thing[12]["加中毒解毒"] = - 40 --精气丸 
		JY.Thing[12]["加体力"]= 45
		JY.Thing[13]["加中毒解毒"] = - 50 --玉灵散
		JY.Thing[13]["加体力"]= 80   		  		   

        JY.Thing[64]["改变内力性质"] = -1 --北冥攻防轻各加10
        JY.Thing[64]["加轻功"]= 1
        JY.Thing[64]["加攻击力"]= 1
        JY.Thing[64]["加防御力"]= 1

        JY.Thing[65]["改变内力性质"] = -1 --吸星大法攻防轻各加10
        JY.Thing[65]["加轻功"]= 1
        JY.Thing[65]["加攻击力"]= 1
        JY.Thing[65]["加防御力"]= 1

        JY.Thing[66]["加轻功"]= 1        --化工大法攻防轻各加10
        JY.Thing[66]["加攻击力"]= 1
        JY.Thing[66]["加防御力"]= 1

        JY.Thing[67]["加御剑能力"]= 1     --紫霞加10点御剑能力，攻防轻各加10
        JY.Thing[67]["加轻功"]= 1        
        JY.Thing[67]["加攻击力"]= 1
        JY.Thing[67]["加防御力"]= 1

        JY.Thing[68]["加轻功"]= 2        --混元功攻防轻各加20
        JY.Thing[68]["加攻击力"]= 2
        JY.Thing[68]["加防御力"]= 2

        JY.Thing[69]["加轻功"]= 1        --狮吼功攻防轻各加10
        JY.Thing[69]["加攻击力"]= 1
        JY.Thing[69]["加防御力"]= 1

        JY.Thing[70]["加轻功"]= 3        --圣火攻10防10轻30耍刀10
        JY.Thing[70]["加攻击力"]= 1
        JY.Thing[70]["加防御力"]= 1
        JY.Thing[70]["加耍刀技巧"]= 1 

        JY.Thing[71]["加轻功"]= 1        --神照经轻1攻1防2医疗4解毒4
        JY.Thing[71]["加攻击力"]= 1
        JY.Thing[71]["加防御力"]= 2
        JY.Thing[71]["加医疗能力"]= 4 
        JY.Thing[71]["加解毒能力"]= 4 

        JY.Thing[72]["加特殊兵器"]= 1     --十八泥偶加10点特殊兵器，攻防轻各加10
        JY.Thing[72]["加轻功"]= 2        
        JY.Thing[72]["加攻击力"]= 2
        JY.Thing[72]["加防御力"]= 2

        JY.Thing[73]["加轻功"]= 2        --蛤蟆功攻防轻各加20
        JY.Thing[73]["加攻击力"]= 2
        JY.Thing[73]["加防御力"]= 2

        JY.Thing[74]["加轻功"]= 1        --乾坤大挪移攻防轻各加10
        JY.Thing[74]["加攻击力"]= 1
        JY.Thing[74]["加防御力"]= 1

        JY.Thing[75]["加轻功"]= 1        --小无相功攻防轻各加10
        JY.Thing[75]["加攻击力"]= 1
        JY.Thing[75]["加防御力"]= 1

        JY.Thing[76]["加轻功"]= 1        --纯阳无极功攻10防20轻10
        JY.Thing[76]["加攻击力"]= 1
        JY.Thing[76]["加防御力"]= 2

        JY.Thing[77]["加轻功"]= 1        --先天功攻20防20轻10
        JY.Thing[77]["加攻击力"]= 2
        JY.Thing[77]["加防御力"]= 2

        JY.Thing[79]["加轻功"]= 2        --八荒攻10防20轻20
        JY.Thing[79]["加攻击力"]= 1
        JY.Thing[79]["加防御力"]= 2

        JY.Thing[80]["加轻功"]= 2        --太玄攻20防20轻20
        JY.Thing[80]["加攻击力"]= 2
        JY.Thing[80]["加防御力"]= 2

        JY.Thing[81]["加轻功"]= 1        --龙象攻20防20轻10
        JY.Thing[81]["加攻击力"]= 2
        JY.Thing[81]["加防御力"]= 2

        JY.Thing[82]["加轻功"]= 2        --逆运真经攻20防10轻20
        JY.Thing[82]["加攻击力"]= 2
        JY.Thing[82]["加防御力"]= 1

        JY.Thing[83]["改变内力性质"] = 4 --九阴九阳
        JY.Thing[83]["加轻功"]= 1  
        JY.Thing[84]["改变内力性质"] = 3
        JY.Thing[84]["加轻功"]= 1

        JY.Thing[85]["加轻功"]= 1 --易筋经加轻功10 
  
        JY.Thing[99]["加拳掌功夫"]= 3    --天山折梅手
        JY.Thing[101]["需拳掌功夫"] = 60   --落英神剑掌
        JY.Thing[101]["需御剑能力"] = 0
        JY.Thing[101]["需资质"] = 60
 
        JY.Thing[107]["加轻功"]= 1      --碧海潮生功攻20防10轻10
        JY.Thing[107]["加攻击力"]= 2
        JY.Thing[107]["加防御力"]= 1
 
        JY.Thing[113]["需内力"]= 6666    --六脉神剑需内力6666
        JY.Thing[113]["加拳掌功夫"]= 2
        JY.Thing[113]["加御剑能力"]= 2

	    JY.Thing[114]["需资质"] = 80 --独孤九剑
	    JY.Thing[114]["仅修炼人物"] = -1
	    JY.Thing[115]["需资质"] = 0 --太极剑法
	    JY.Thing[123]["需资质"] = 0 --玉箫剑法
	    JY.Thing[123]["需拳掌功夫"] = 0 
	    JY.Thing[173]["需内力"] = 0 --黄沙万里鞭
        JY.Thing[176]["加特殊兵器"]= 2  --阴阳捣乱刃
	    JY.Thing[181]["需暗器技巧"] = JY.Thing[181]["需特殊兵器"] --棋盘招式
	    JY.Thing[181]["需特殊兵器"] = 0
	for i = 1, JY.PersonNum - 1 do
	if JY.Person[i]["等级"] > 30 then JY.Person[i]["等级"] = 30 end
	end

        JY.Thing[238]["加轻功"]= 4        --梯云纵轻4防1防2
        JY.Thing[238]["加攻击力"]= 1
        JY.Thing[238]["加防御力"]= 2
        JY.Thing[238]["需资质"] = 0

        JY.Thing[239]["加轻功"]= 4        --四象步法轻4攻1防1需资质50
        JY.Thing[239]["加攻击力"]= 1
        JY.Thing[239]["加防御力"]= 1
        JY.Thing[239]["需资质"] = 50

        JY.Thing[240]["加轻功"]= 4        --神行百变轻4攻1防1需轻功333
        JY.Thing[240]["加攻击力"]= 1
        JY.Thing[240]["加防御力"]= 1
        JY.Thing[240]["需轻功"] = 333

        JY.Thing[241]["加轻功"]= 4        --瞬息千里轻4攻2防2需资质50
        JY.Thing[241]["加攻击力"]= 2
        JY.Thing[241]["加防御力"]= 2
        JY.Thing[241]["需资质"] = 50

        JY.Thing[242]["加轻功"]= 5        --天罗地网身法轻50攻0防0
        JY.Thing[242]["加攻击力"]= 0
        JY.Thing[242]["加防御力"]= 0

        JY.Thing[339]["加轻功"]= 5        --凌波微步轻50攻0防10
        JY.Thing[339]["加攻击力"]= 0
        JY.Thing[339]["加防御力"]= 1

        JY.Thing[280]["加攻击力"] = 1     --一苇渡江
        JY.Thing[280]["加轻功"] = 3

        JY.Thing[254]["加轻功"]= 3        --玉女心经轻30攻10防20
        JY.Thing[254]["加攻击力"]= 1
        JY.Thing[254]["加防御力"]= 2

        JY.Thing[261]["加轻功"]= 1        --寒冰真气轻10攻10防10
        JY.Thing[261]["加攻击力"]= 1
        JY.Thing[261]["加防御力"]= 1

        JY.Thing[287]["加轻功"]= 1    --金关玉锁诀加10点轻功10点攻击20点防御10点拳掌
        JY.Thing[287]["加攻击力"]= 1
        JY.Thing[287]["加防御力"]= 2
        JY.Thing[287]["加拳掌功夫"]= 1

        JY.Thing[288]["加轻功"]= 1    --金刚不坏体加10点攻击10点轻功20点防御
        JY.Thing[288]["加攻击力"]= 1
        JY.Thing[288]["加防御力"]= 2
     
        JY.Thing[289]["加攻击力"]= 1       --天南益阳诀加20点轻功10点攻击10点暗器
        JY.Thing[289]["加轻功"]= 2
        JY.Thing[289]["加暗器技巧"]= 1
 
        JY.Thing[290]["加轻功"]= 1         --临济十二庄加20点攻击10防御10点轻功10拳10剑
        JY.Thing[290]["加防御力"]= 1        
        JY.Thing[290]["加攻击力"]= 2
        JY.Thing[341]["加拳掌功夫"] = 1    
        JY.Thing[341]["加御剑能力"] = 1 

        JY.Thing[338]["加防御力"]= 1        --擒龙功攻防轻各加10点
        JY.Thing[338]["加攻击力"]= 1
        JY.Thing[338]["加轻功"]= 1  

        JY.Thing[341]["加拳掌功夫"] = 2     --玄武真功加各系数20点
        JY.Thing[341]["加御剑能力"] = 2
        JY.Thing[341]["加耍刀技巧"] = 2
        JY.Thing[341]["加特殊兵器"] = 2
        JY.Thing[341]["加暗器技巧"] = 2

	JY.Thing[230]["装备类型"] = 2
	JY.Thing[248]["装备类型"] = 2
	JY.Thing[64]["改变内力性质"] = -1 --北冥吸星
	JY.Thing[65]["改变内力性质"] = -1
	JY.Thing[83]["改变内力性质"] = 4 --九阴九阳
	JY.Thing[84]["改变内力性质"] = 3
	JY.Thing[114]["需资质"] = 80 --独孤九剑
	JY.Thing[114]["仅修炼人物"] = -1
	JY.Thing[115]["需资质"] = 0 --太极剑法
	JY.Thing[173]["需内力"] = 0 --黄沙万里鞭
	JY.Thing[181]["需暗器技巧"] = JY.Thing[181]["需特殊兵器"] --棋盘招式
	JY.Thing[181]["需特殊兵器"] = 0
	JY.Thing[343]["改变内力性质"] = -1 --太极不改变内力属性
	JY.Thing[344]["改变内力性质"] = -1 --洗髓不改变内力属性
	JY.Thing[345]["改变内力性质"] = -1 --瑜伽不改变内力属性
	
	for i = 1, JY.PersonNum - 1 do
		if JY.Person[i]["等级"] > 30 then JY.Person[i]["等级"] = 30 end
	end
	JY.Person[0]["出招动画帧数1"] = 10
	JY.Person[0]["出招动画帧数2"] = 12
	JY.Person[0]["出招动画帧数3"] = 11
	JY.Person[0]["出招动画帧数4"] = 11
	JY.Person[0]["出招动画帧数5"] = 15
	JY.Person[0]["出招动画延迟1"] = 7
	JY.Person[0]["出招动画延迟2"] = 10
	JY.Person[0]["出招动画延迟3"] = 9
	JY.Person[0]["出招动画延迟4"] = 9
	JY.Person[0]["出招动画延迟5"] = 10
	JY.Person[0]["武功音效延迟1"] = 0
	JY.Person[0]["武功音效延迟2"] = 8
	JY.Person[0]["武功音效延迟3"] = 5
	JY.Person[0]["武功音效延迟4"] = 7
	JY.Person[0]["武功音效延迟5"] = 0

	JY.Person[1]["武功1"] = 0 --胡斐
	JY.Person[1]["技能3"] = 9
	JY.Person[2]["武功1"] = 0 --程灵素
	JY.Person[2]["技能3"] = 66
	JY.Person[2]["拳掌功夫"] = 40
	JY.Person[2]["御剑能力"] = 18
	JY.Person[3]["携带物品4"] = 117 --苗人凤
	JY.Person[3]["携带物品数量4"] = 1	
	JY.Person[4]["携带物品4"] = 166 --阎基
	JY.Person[4]["携带物品数量4"] = 1
	JY.Person[4]["武功1"] = 50
	JY.Person[5]["武功4"] = 182 --张三丰太极神功
	JY.Person[5]["武功等级4"] = 999
	JY.Person[5]["武功5"] = 185 
	JY.Person[5]["武功等级5"] = 999
	JY.Person[5]["声望"] = 182
	JY.Person[6]["携带物品4"] = 120 --灭绝
	JY.Person[6]["携带物品数量4"] = 1
	JY.Person[6]["武功5"] = 186 
	JY.Person[6]["武功等级5"] = 999	
	JoinMP(6,17,2) --峨眉灭绝
	JoinMP(8,18,4) --崆峒唐文亮
	JY.Person[8]["声望"] = 189
	JY.Person[9]["携带物品4"] = 106 --张无忌
	JY.Person[9]["携带物品数量4"] = 1
	JoinMP(9,4,3)
    JoinMP(10,13,4)
    JoinMP(11,13,4)
	JY.Person[10]["武功3"] = 194 --范遥
	JY.Person[10]["武功等级3"] = 999
	JY.Person[11]["武功1"] = 18 --杨逍
	JY.Person[11]["御剑能力"] = 66
	JY.Person[11]["武功等级3"] = 999
	JY.Person[12]["携带物品4"] = 109 --殷天正
	JY.Person[12]["武功2"] = 166 
	JY.Person[12]["武功等级2"] = 999
    JoinMP(12,13,3)
	JY.Person[12]["携带物品数量4"] = 1
    JoinMP(13,13,3)
	JY.Person[13]["携带物品3"] = 11 --谢逊
	JY.Person[13]["携带物品4"] = 13	
	JY.Person[14]["武功2"] = 124 --韦一笑
	JY.Person[14]["武功等级2"] = 900
	JY.Person[14]["声望"] = 124
	JY.Person[14]["携带物品4"] = 261
	JY.Person[14]["携带物品数量4"] = 1
	JY.Person[15]["出招动画帧数5"] = 20 --金花婆婆
	JY.Person[15]["出招动画延迟5"] = 12
	JY.Person[15]["武功音效延迟5"] = 9
	JY.Person[15]["武功2"] = 93
	JY.Person[15]["武功等级2"] = 999
	JY.Person[15]["声望"] = 93
	JY.Person[16]["拳掌功夫"] = 10  --胡青牛
	JY.Person[16]["御剑能力"] = 10
	JY.Person[16]["暗器技巧"] = 40
	JY.Person[17]["拳掌功夫"] = 10  --王难姑
	JY.Person[17]["御剑能力"] = 10
	JY.Person[17]["特殊兵器"] = 40
    JoinMP(14,13,3)
    JoinMP(15,13,3)
    JoinMP(16,13,2)
    JoinMP(17,13,2)
	JoinMP(18,5,4)
	JY.Person[18]["武功3"] = 187 
	JY.Person[18]["武功等级3"] = 999	
	JY.Person[19]["武功2"] = 89 --岳不群
	JY.Person[19]["武功等级2"] = 900
	JY.Person[19]["武功等级3"] = 0
	JY.Person[19]["声望"] = 89
	JY.Person[19]["武功3"] = 0
	JY.Person[19]["携带物品4"] = 13
    JoinMP(19,14,5)
    JoinMP(20,14,4)
	JY.Person[20]["武功2"] = 89 --莫大
	JY.Person[20]["武功等级2"] = 900
	JY.Person[20]["武功等级3"] = 0
	JY.Person[20]["声望"] = 89
	JY.Person[20]["武功3"] = 0
	JY.Person[20]["携带物品4"] = 13
    JoinMP(21,14,4)
	JY.Person[21]["武功2"] = 90 --定闲
	JY.Person[21]["武功等级2"] = 900
	JY.Person[21]["武功等级3"] = 0
	JY.Person[21]["声望"] = 90
	JY.Person[21]["武功3"] = 0
	JY.Person[21]["携带物品4"] = 13
    JoinMP(22,14,5)
    JY.Person[23]["武功2"] = 90 --天门
	JY.Person[23]["武功等级2"] = 900
	JY.Person[23]["武功等级3"] = 0
	JY.Person[23]["声望"] = 90
	JY.Person[23]["武功3"] = 0
	JY.Person[23]["携带物品4"] = 13
    JoinMP(23,14,4)
	JY.Person[25]["武功2"] = 0  --蓝凤凰
	JY.Person[25]["武功等级2"] = 0 
	JY.Person[25]["御剑能力"] = 20
	JY.Person[26]["武功2"] = 88 --任我行
	JY.Person[26]["武功等级2"] = 900 
    JoinMP(26,12,5)
	JY.Person[27]["武功2"] = 177 --东方不败
	JY.Person[27]["武功等级2"] = 999
    JoinMP(27,12,5)
	JY.Person[28]["武功1"] = 0 --平一指
	JY.Person[28]["拳掌功夫"] = 10
	JY.Person[28]["御剑能力"] = 10
	JY.Person[28]["耍刀技巧"] = 35
    JoinMP(28,12,1)
	JY.Person[29]["武功等级1"] = 999  --田伯光
	JY.Person[29]["武功2"] = 0 
	JY.Person[29]["武功等级2"] = 0
	JY.Person[29]["拳掌功夫"] = 22
	JY.Person[29]["御剑能力"] = 32
	JY.Person[29]["耍刀技巧"] = 73
    JY.Person[29]["生命"] = 880
    JY.Person[29]["生命最大值"] = 880
    JY.Person[29]["内力"] = 2000
    JY.Person[29]["内力最大值"] = 2000
    JY.Person[29]["轻功"] = 86
    JY.Person[29]["体力"] =  100
    JY.Person[29]["武学常识"] =  15
    JY.Person[29]["实战"] =  150
	JY.Person[30]["武功1"] = 0 --郭靖1
	JY.Person[30]["武功等级1"] = 0
	JY.Person[30]["携带物品3"] = 260
	JY.Person[30]["携带物品数量3"] = 1
	JY.Person[31]["携带物品4"] = 262 --丹青生
	JY.Person[31]["携带物品数量4"] = 1
    JoinMP(31,12,2)
	JY.Person[32]["携带物品4"] = 183 --秃笔翁
	JY.Person[32]["携带物品数量4"] = 1
    JoinMP(32,12,2)
	JY.Person[34]["携带物品4"] = 54 --黄钟公
	JY.Person[34]["携带物品数量4"] = 1	
	JY.Person[35]["耍刀技巧"] = 10 --令狐冲
	JY.Person[35]["特殊兵器"] = 10
    JoinMP(33,12,2)
    JoinMP(34,12,2)
    JoinMP(35,14,2)--令狐冲
    JoinMP(73,12,4) --任盈盈
	JY.Person[37]["拳掌功夫"] = 25  --狄云
	JY.Person[37]["御剑能力"] = 54
	JY.Person[38]["声望"] = 96 --石破天
	JY.Person[38]["携带物品1"] = 21
	JY.Person[38]["携带物品数量1"] = 1
	JY.Person[42]["武功1"] = 101 --李四
	JY.Person[42]["声望"] = 101 
	JY.Person[45]["武功1"] = 0 --薛慕华
	JY.Person[45]["武功2"] = 0
	JoinMP(45,7,1)
	JY.Person[46]["武功2"] = 169 --丁春秋
	JY.Person[46]["武功4"] = 0
	JY.Person[46]["武功等级4"] = 0
	JY.Person[46]["声望"] = 0 
	JY.Person[47]["武功3"] = 200 --阿紫
	JY.Person[47]["武功4"] = 0
	JY.Person[47]["武功等级4"] = 0
	JY.Person[47]["武功等级1"] = 999
	JY.Person[47]["武功等级2"] = 999
	JY.Person[47]["技能2"] = 20
	JY.Person[47]["携带物品4"] = 295
	JY.Person[47]["携带物品数量4"] = 1
	setJX(47)
	JY.Person[48]["御剑能力"] = 20 --游坦之 
	JY.Person[48]["半身像"] = 48
	JY.Person[48]["武功等级1"] = 999
	JY.Person[48]["武功2"] = 188
	JY.Person[48]["武功等级2"] = 999
	JY.Person[48]["声望"] = 188
	JY.Person[48]["出招动画帧数2"] = 9
	JY.Person[48]["出招动画延迟2"] = 7
	JY.Person[48]["武功音效延迟2"] = 5
	JY.Person[49]["资质"] = 40  --虚竹
	JY.Person[49]["御剑能力"] = 10 
	JY.Person[49]["耍刀技巧"] = 10 
	JY.Person[49]["特殊兵器"] = 10 
	JY.Person[49]["暗器技巧"] = 10 
	JoinMP(49,5,1)
	JY.Person[50]["技能1"] = 134 --乔峰
	JY.Person[50]["技能2"] = 33
	JY.Person[50]["技能3"] = 47
	JY.Person[50]["技能4"] = 125
	JY.Person[50]["技能5"] = 137
	setJX(50)
	JY.Person[51]["武功等级1"] = 900
	JY.Person[52]["技能2"] = 13 --花铁干
	JY.Person[52]["出招动画帧数5"] = 6
	JY.Person[53]["武功1"] = 85 --段誉
	JY.Person[53]["武功等级1"] = 100
	JY.Person[53]["武功2"] = 49 
	JY.Person[53]["武功等级2"] = 400
	JY.Person[53]["御剑能力"] = 20
	JY.Person[54]["携带物品4"] = 240 --袁承志
	JY.Person[54]["携带物品数量4"] = 1
	JY.Person[54]["携带物品2"] = 333
	JY.Person[54]["携带物品数量2"] = 1
    JoinMP(54,14,3)--袁承志
    JoinMP(53,15,2)--段誉
	JY.Person[55]["武功2"] = 150 --郭靖
	JY.Person[55]["技能3"] = 137
	JY.Person[55]["内力性质"] = 0
	JY.Person[55]["御剑能力"] = 30
	JY.Person[55]["特殊兵器"] = 32
	JY.Person[56]["武功2"] = 6 --黄蓉
	JY.Person[56]["技能2"] = 4
	JY.Person[56]["技能3"] = 137
	JY.Person[56]["携带物品1"] = 49 
	JY.Person[56]["携带物品数量1"] = 1
	JY.Person[56]["携带物品2"] = 17 
	JY.Person[56]["携带物品数量2"] = 1
	JY.Person[56]["携带物品4"] = 107 
	JY.Person[56]["携带物品数量4"] = 1
    JoinMP(56, 10, 2)--沼跃鱼：黄容入桃花
    JoinMP(57, 10, 3)--沼跃鱼：黄药师
    JoinMP(63, 10, 2)--沼跃鱼：程英
    JoinMP(78, 10, 2)--沼跃鱼：梅超风
	JY.Person[58]["武功3"] = 121 --杨过
	JY.Person[58]["声望"] = 121
	JY.Person[58]["拳掌功夫"] = 106
	JY.Person[58]["御剑能力"] = 104
	JY.Person[58]["耍刀技巧"] = 0
	JY.Person[58]["特殊兵器"] = 10
	JY.Person[58]["技能2"] = 129
	JY.Person[59]["武功2"] = 168 --小龙女
	JY.Person[59]["携带物品2"] = 254
	JY.Person[59]["武功4"] = 119
	JY.Person[59]["技能2"] = 129
	JY.Person[60]["武功1"] = 9 --欧阳锋
	JY.Person[60]["武功2"] = 120
	JY.Person[60]["武功3"] = 95
	JY.Person[60]["武功4"] = 118
	JY.Person[60]["武功等级4"] = 999
	JY.Person[60]["声望"] = 95
	JY.Person[60]["携带物品4"] = 73
	JY.Person[60]["携带物品数量4"] = 1	
    JoinMP(60, 8, 3)
    JoinMP(620, 8, 3)
	JY.Person[61]["携带物品4"] = 241 --欧阳克
	JY.Person[61]["携带物品数量4"] = 1	
	JY.Person[61]["武功等级3"] = 900
	JY.Person[61]["御剑能力"] = 32	
    JoinMP(61, 8, 2)
    JoinMP(62,6,3)
	JY.Person[62]["携带物品4"] = 284 --金轮法王
	JY.Person[62]["携带物品数量4"] = 1
	JY.Person[62]["武功1"] = 147
	JY.Person[62]["武功2"] = 103
	JY.Person[63]["武功2"] = 0 --程英
	JY.Person[63]["武功3"] = 0
	JY.Person[63]["武功等级2"] = 0
	JY.Person[63]["武功等级3"] = 0
	JY.Person[63]["声望"] = 0
	JY.Person[64]["武功4"] = 150 --周伯通
	JY.Person[64]["武功等级4"] = 999
	JY.Person[64]["内力性质"] = 0
	JY.Person[64]["出招动画帧数2"] = 30
	JY.Person[64]["出招动画延迟2"] = 20
	JY.Person[64]["武功音效延迟2"] = 18
    JoinMP(64,16,4)
	JY.Person[65]["携带物品4"] = 96 --一灯
	JY.Person[65]["携带物品数量4"] = 1	
    JoinMP(65, 15, 4)--沼跃鱼：程英
	JY.Person[66]["武功1"] = 146	--小昭
	JY.Person[66]["武功等级1"] = 900
	JY.Person[66]["武功等级2"] = 999
	JY.Person[66]["武功3"] = 0
	JY.Person[66]["武功等级3"] = 0
	JY.Person[66]["御剑能力"] = 33
    JoinMP(66,13,5)
	JY.Person[67]["武功2"] = 0 --裘千仞
	JY.Person[68]["携带物品4"] = 77 --丘处机
	JY.Person[68]["携带物品数量4"] = 1
	JY.Person[68]["武功3"] = 150
	JY.Person[68]["武功等级3"] = 999
	JY.Person[68]["声望"] = 150
    JoinMP(68,16,3)
	JY.Person[70]["内力性质"] = 2 --玄慈
	JY.Person[71]["技能4"] = 133 --洪教主
	JY.Person[73]["携带物品1"] = -1 --任盈盈
	JY.Person[73]["携带物品数量1"] = 0
	JY.Person[73]["武功3"] = 196
	JY.Person[73]["武功等级3"] = 800
	JY.Person[73]["拳掌功夫"] = 40
	JY.Person[73]["御剑能力"] = 50
	JY.Person[74]["御剑能力"] = 60  --霍青桐
	JY.Person[74]["武功等级1"] = 300
	for i = 2, 5 do 
		JY.Person[76]["出招动画帧数"..i] = 9
	end	
	JY.Person[77]["携带物品2"] = -1 --萧中慧
	JY.Person[77]["携带物品数量2"] = 0
	JY.Person[77]["武功1"] = 0
	JY.Person[77]["武功等级1"] = 0
	JY.Person[77]["拳掌功夫"] = 18
	JY.Person[77]["御剑能力"] = 28	
    JY.Person[78]["武功2"]=6        --梅超风
    JY.Person[78]["武功等级2"]=600	
	JY.Person[78]["武功3"] = 0 
	JY.Person[78]["武功4"] = 0
	JY.Person[78]["武功等级3"] = 0 
	JY.Person[78]["武功等级4"] = 0
	JY.Person[78]["声望"] = 0
	JY.Person[78]["御剑能力"] = 28
	JY.Person[78]["耍刀技巧"] = 20
	JY.Person[78]["携带物品4"] = -1
	JY.Person[78]["携带物品数量4"] = 0
    JoinMP(79,14,2)--岳灵珊
	JY.Person[79]["拳掌功夫"] = 11  --岳灵珊
    JY.Person[79]["生命"] = 500
    JY.Person[79]["生命最大值"] = 500
    JY.Person[79]["内力"] = 2000
    JY.Person[79]["内力最大值"] = 2000
    JY.Person[79]["攻击力"] = 60
    JY.Person[79]["轻功"] = 80
    JY.Person[79]["防御力"] = 60
    JY.Person[79]["体力"] =  100
    JY.Person[79]["武学常识"] =  15
    JY.Person[79]["实战"] =  150
	JY.Person[79]["出招动画帧数3"] = 11
	JoinMP(80,4,4)
	JoinMP(82,4,3)
	JY.Person[81]["出招动画帧数2"] = 14
	JY.Person[81]["出招动画延迟2"] = 9
	JY.Person[81]["武功音效延迟2"] = 8
	JY.Person[82]["武功2"] = 0 --宋青书
	JY.Person[82]["武功等级2"] = 0
	JY.Person[82]["携带物品2"] = -1
	JY.Person[82]["携带物品数量2"] = 0
	JY.Person[83]["武功2"] = 3 --何铁手
	JY.Person[83]["携带物品4"] = -1
	JY.Person[83]["御剑能力"] = 20
	JY.Person[83]["耍刀技巧"] = 20
	JY.Person[83]["携带物品数量4"] = 0
    JoinMP(84,6,2)--霍都
    JoinMP(81, 15, 1)
    JoinMP(165, 15, 1)--朱氏父女
	JY.Person[84]["拳掌功夫"] = 50 --霍都
	JY.Person[84]["御剑能力"] = 40
	JY.Person[84]["耍刀技巧"] = 40
	JY.Person[85]["技能2"] = 27 --贝海石
	JY.Person[86]["武功1"] = 0  --阿珂
	JY.Person[86]["御剑能力"] = 50
	JY.Person[86]["出招动画帧数2"] = 0
	JY.Person[86]["出招动画延迟2"] = 0
	JY.Person[86]["武功音效延迟2"] = 0
	JY.Person[86]["出招动画帧数3"] = 11
	JY.Person[86]["出招动画延迟3"] = 9
	JY.Person[86]["武功音效延迟3"] = 8
	JY.Person[87]["武功1"] = 0  --苏荃
	JY.Person[87]["出招动画帧数5"] = 21
	JY.Person[87]["出招动画延迟5"] = 17
	JY.Person[87]["武功音效延迟5"] = 15
	JY.Person[88]["武功1"] = 0 --祖千秋
	JY.Person[88]["拳掌功夫"] = 50
	JY.Person[88]["技能1"] = 123
	JY.Person[88]["携带物品4"] = 265
	JY.Person[88]["携带物品数量4"] = 1
	JY.Person[89]["技能1"] = 67 --人厨子
	JY.Person[89]["武功1"] = 0
	JY.Person[89]["拳掌功夫"] = 11
	JY.Person[89]["御剑能力"] = 30
	JY.Person[89]["耍刀技巧"] = 50
	JY.Person[90]["技能3"] = 140 --钟灵
	JY.Person[90]["武功1"] = 0  
	JY.Person[90]["拳掌功夫"] = 20
	JY.Person[90]["御剑能力"] = 20
	JY.Person[90]["耍刀技巧"] = 20
	JY.Person[91]["武功1"] = 0  --温青青
	JY.Person[91]["拳掌功夫"] = 15
	JY.Person[91]["御剑能力"] = 45
	JY.Person[93]["武功1"] = 0 --李浣芷改成唐萌浅
	JY.Person[93]["姓名"] = "唐萌浅"
	JY.Person[93]["性别"] = 1
	JY.Person[93]["半身像"] = 589
	JY.Person[93]["头像代号"] = 339
	JY.Person[93]["出招动画帧数3"] = 8
	JY.Person[93]["出招动画延迟3"] = 8
	JY.Person[93]["武功音效延迟3"] = 8
	JY.Person[93]["资质"] = 80
	JY.Person[93]["内力性质"] = 0
	JY.Person[93]["技能1"] = 38
	JY.Person[93]["技能2"] = 103
	JY.Person[93]["技能3"] = 142
	JY.Person[93]["排行"] = 3
	AddPersonAttrib(93, "暗器技巧", 50)
	JoinMP(93, 9, 2)	
	JY.Person[95]["武功1"] = 46 --刘乘风
	JY.Person[97]["武功2"] = 184 --血刀老祖
	JY.Person[97]["武功等级2"] = 999
	JY.Person[97]["声望"] = 184
    JoinMP(98,15,2)--段延庆
	JY.Person[98]["武功3"] = 199
	JY.Person[98]["武功等级3"] = 999
    --JoinMP(44,15,1)--岳老三		
    --for i = 99, 101 do --恶人+朱丹臣
    JoinMP(101, 15, 1)
    --end
    JoinMP(102,15,3)--枯荣大师		
	JY.Person[100]["武功1"] = 74 --云中鹤
	JY.Person[100]["携带物品4"] = 179
	JY.Person[100]["携带物品数量4"] = 1
	JY.Person[103]["携带物品4"] = 135 --鸠摩智
	JY.Person[103]["携带物品数量4"] = 1
	JY.Person[103]["半身像"] = 552
	JY.Person[103]["技能3"] = 11
	setJX(103)
    JoinMP(103,6,3)
	for i,v in pairs(CC.Person_S) do--谢无悠
		JY.Person[109][i] = JY.Person[19][i]
	end
	JY.Person[109]["姓名"] = "鲜于通"
	JY.Person[109]["头像代号"] = 19
	JY.Person[595]["携带物品4"] = 135 --鸠摩智
	JY.Person[595]["携带物品数量4"] = 1
	JY.Person[595]["技能3"] = 11
	JY.Person[595]["半身像"] = 552
	setJX(595)
	JY.Person[104]["武功1"] = 0 --阿朱
	JY.Person[104]["武功2"] = 0
	JY.Person[104]["声望"] = 0
	JY.Person[104]["出招动画帧数2"] = 17
	JY.Person[104]["出招动画延迟2"] = 11
	JY.Person[104]["武功音效延迟2"] = 9
	setJX(104)
    JoinMP(104, 15, 2)
	JY.Person[105]["武功1"] = 0 --阿碧
	JY.Person[105]["武功等级1"] = 0
	JY.Person[106]["出招动画帧数4"] = 12
	JY.Person[106]["出招动画延迟4"] = 8
	JY.Person[106]["武功音效延迟4"] = 7
	JY.Person[107]["携带物品4"] = 142 --矮老者
	JY.Person[107]["携带物品数量4"] = 1
    JoinMP(107,14,3)
    JoinMP(108,14,3)
    JoinMP(109,14,4)
	JY.Person[112]["内力性质"] = 2 --萧远山
	--JY.Person[112]["武功1"] = 26
	JY.Person[113]["武功2"] = 108 --慕容博
	JY.Person[113]["声望"] = 108
	JY.Person[113]["内力性质"] = 2
	JY.Person[113]["携带物品2"] = 270
	JY.Person[113]["携带物品数量2"] = 1
	JY.Person[114]["内力性质"] = 2 --扫地老僧
	JY.Person[114]["武功2"] = 143 --扫地老僧
	JY.Person[114]["武功等级2"] = 999
	JY.Person[115]["武功5"] = 179 --苏星河
	JY.Person[115]["武功等级5"] = 999 
	JY.Person[116]["武功1"] = 8 --无崖子
	JY.Person[116]["内力性质"] = 3
	JY.Person[116]["武功等级1"] = 999 
	JY.Person[116]["武功2"] = 85 
	JY.Person[116]["武功等级2"] = 999 
	JY.Person[116]["武功3"] = 98 
	JY.Person[116]["武功等级3"] = 999 
	JY.Person[116]["武功4"] = 179 
	JY.Person[116]["武功等级4"] = 999 
	JY.Person[117]["武功1"] = 176 --天山童姥
	JY.Person[117]["武功等级1"] = 999
	JY.Person[117]["武功2"] = 14 
	JY.Person[117]["武功等级2"] = 999 
	JY.Person[117]["武功3"] = 101 
	JY.Person[117]["武功等级2"] = 999 
	JY.Person[117]["武功4"] = 179 
	JY.Person[117]["武功5"] = 0
	JY.Person[117]["武功等级5"] = 0	
	JY.Person[118]["武功1"] = 132 --李秋水
	JY.Person[118]["武功等级1"] = 999
	JY.Person[118]["武功2"] = 98 
	JY.Person[118]["武功等级2"] = 999
	JY.Person[118]["武功3"] = 85 
	JY.Person[118]["武功等级3"] = 999
	JY.Person[118]["武功4"] = 179 
	JY.Person[118]["武功等级4"] = 999
    JoinMP(114, 5, 4)
	JY.Person[116]["技能5"] = 132
    JoinMP(116, 7, 5)
    JoinMP(117, 7, 3)
    JoinMP(118, 7, 3)
	for i = 119, 122 do --渔樵耕读
    JoinMP(i, 15, 1)
	end
	for i = 124, 127 do
		for j,v in pairs(CC.Person_S) do
		JY.Person[i][j] = JY.Person[68][j]
		end
	end
	for i = 123, 128 do --全真六子
		JY.Person[i]["武功3"] = 150
		JY.Person[i]["武功等级3"] = 999	
		JY.Person[i]["排行"] = 3
		JY.Person[i]["声望"] = 150
		JoinMP(i,16,3)
	end
	JY.Person[123]["姓名"] = "马钰"
	JY.Person[124]["姓名"] = "谭处端"
	JY.Person[125]["姓名"] = "刘处玄"
	JY.Person[126]["姓名"] = "王处一"
	JY.Person[127]["姓名"] = "郝大通"
	JY.Person[128]["出招动画帧数3"] = 13
	JY.Person[128]["出招动画延迟3"] = 11
	JY.Person[128]["武功音效延迟3"] = 10
	--JY.Person[129]["武功4"] = 107 --王重阳
	--JY.Person[129]["武功等级4"] = 999
	JY.Person[129]["武功5"] = 39
	JY.Person[129]["武功等级5"] = 999
	JY.Person[129]["武功6"] = 107
	JY.Person[129]["武功等级6"] = 999	
	JY.Person[129]["技能4"] = 35
	JY.Person[129]["内力性质"] = 0
	JY.Person[130]["携带物品4"] = 8 --柯镇恶
	JY.Person[130]["携带物品数量4"] = 1	
	JY.Person[133]["武功1"] = 53 --南希仁
	JY.Person[133]["耍刀技巧"] = JY.Person[133]["特殊兵器"]
	JY.Person[133]["特殊兵器"] = JY.Person[133]["拳掌功夫"]
	JY.Person[140]["武功1"] = 47 --风清扬
	JY.Person[140]["武功2"] = 0
	JY.Person[140]["武功3"] = 0
	JY.Person[140]["武功等级2"] = 0
	JY.Person[140]["武功等级3"] = 0
	JY.Person[140]["声望"] = 0
	JoinMP(141,14,3)
    JoinMP(142,14,3)
    JoinMP(140,14,3) --风清扬
	JY.Person[149]["排行"] = 1 --方证
	JoinMP(149,5,5)
	JY.Person[151]["武功1"] = 13 --文泰来
	JY.Person[151]["排行"] = 3
	JY.Person[152]["武功1"] = 36 --赵半山
	JY.Person[152]["技能2"] = 127 --无尘
    --JoinMP(157,6,2)--潇湘子
    --JoinMP(158,6,2)--尹克西
    --JoinMP(159,6,2)--尼摩星
    JoinMP(160,6,2)--达尔巴
	JY.Person[161]["声望"] = 0 --李莫愁
	JY.Person[161]["御剑能力"] = 60
	JY.Person[161]["武功1"] = 145 
	JY.Person[161]["武功等级1"] = 800
	JY.Person[161]["武功2"] = 119
	JY.Person[161]["武功等级2"] = 50
	JY.Person[161]["武功3"] = 170
	JY.Person[161]["武功等级3"] = 900
	JY.Person[161]["武功4"] = 0
	JY.Person[161]["耍刀技巧"] = 31
	JY.Person[162]["武功1"] = 69 --丁不三
	JY.Person[162]["拳掌功夫"] = 10
	JY.Person[162]["特殊兵器"] = 67
	JY.Person[163]["拳掌功夫"] = 10 --丁不四
	JY.Person[163]["特殊兵器"] = 67	
	JY.Person[164]["武功2"] = 0 --谢烟客
	JY.Person[164]["声望"] = 0
	setJX(164)
	JY.Person[166]["耍刀技巧"] = 53
	JY.Person[166]["武功1"] = 37
	JY.Person[166]["武功等级1"] = 999
	JY.Person[166]["武功2"] = 60
	JY.Person[166]["武功等级2"] = 999
	JoinMP(167,18,4) --崆峒宗维侠
	JoinMP(168,18,4) --崆峒常敬之
	JY.Person[167]["声望"] = 189
	JY.Person[168]["声望"] = 189
	JY.Person[170]["武功2"] = 96 --空性
	JY.Person[170]["声望"] = 96
	JY.Person[171]["武功1"] = 16 --宋远桥
	JY.Person[172]["武功1"] = 134 --莫声谷
	JY.Person[172]["武功3"] = 135
	for i = 173, 175 do --波斯三使
	JoinMP(i,13,3)
	end
	JY.Person[182]["武功1"] = 13 --刘培生
	JY.Person[185]["武功1"] = 90 --穆人清
	JY.Person[185]["声望"] = 90
	JoinMP(182,14,1)
	JoinMP(183,14,1)
    JoinMP(185,14,4)
    JoinMP(186,14,3)
    JoinMP(187,14,2)
    JoinMP(188,14,3)
	JY.Person[188]["武功1"] = 13 --黄真
	JY.Person[189]["武功2"] = 0 --萧半和
	JY.Person[189]["武功3"] = 0 
	JY.Person[190]["武功1"] = 163 --莽牯朱蛤
	for i = 191, 210 do --五岳弟子
    JoinMP(i,14,1)
	end
	for i = 231, 240 do --日月教徒
    JoinMP(i,12,1)
	end
	for i = 251, 260 do --药王门师徒
	JoinMP(i,6,1)
	end
	for i = 291, 300 do --日月教徒
    JoinMP(i,16,1)
	end
	for i = 301, 310 do --明教弟子
    JoinMP(i,13,1)
	end
	for i = 330, 339 do --峨眉弟子
    JoinMP(i,17,1)
	end
	for i = 350, 358 do --崆峒弟子
    JoinMP(i,18,1)
	end
	JoinMP(359,18,2)
	for i = 360, 388 do --五岳弟子
    JoinMP(i,14,1)
	end
	JoinMP(379,14,2)
	JoinMP(389,14,2)
	for i = 818, 847 do --五岳弟子
    JoinMP(i,14,1)
	end	
	JY.Person[419]["声望"] = 95 --蛇王
	JY.Person[419]["技能1"] = 68
	JY.Person[430]["声望"] = 106 --蛛王
	JY.Person[430]["武功2"] = 106
	JY.Person[430]["武功等级2"] = 999
	JY.Person[430]["技能1"] = 34
	JY.Person[440]["声望"] = 107 --蟾王
	JY.Person[440]["武功2"] = 107
	JY.Person[440]["武功等级2"] = 999
	JY.Person[440]["内力性质"] = 0
	JY.Person[440]["技能1"] = 52
	for i = 441, 450 do --官兵
		JY.Person[i]["武功1"] = 149
		JY.Person[i]["武器"] = 306
		JY.Person[i]["防具"] = 63		
	end
	for i = 899, 908 do --官兵
		JY.Person[i]["武功1"] = 149
		JY.Person[i]["武器"] = 306
		JY.Person[i]["防具"] = 63
	end	
	JY.Person[451]["武功1"] = 2 --高三娘
	JY.Person[451]["暗器技巧"] = 40
	JY.Person[453]["武功1"] = 138 --吕正平
	JY.Person[453]["拳掌功夫"] = 10	
	JY.Person[453]["耍刀技巧"] = 40	
	JY.Person[454]["武功1"] = 69 --风良
	JY.Person[454]["拳掌功夫"] = 10	
	JY.Person[454]["特殊兵器"] = 40	
	JY.Person[455]["姓名"] = "无酒不欢" --丁氏门人
	JY.Person[455]["生命最大值"] = 920
	JY.Person[455]["内力最大值"] = 4300
	JY.Person[455]["攻击力"] = 280
	JY.Person[455]["防御力"] = 250
	JY.Person[455]["轻功"] = 300
	JY.Person[455]["等级"] = 30
	JY.Person[455]["武功1"] = 110
	JY.Person[455]["武功等级1"] = 999
	JY.Person[455]["排行"] = 8
	JY.Person[455]["资质"] = 100
	JY.Person[455]["御剑能力"] = 200
	JY.Person[455]["武学常识"] = 100
	JY.Person[455]["左右互搏"] = 1	
	JY.Person[455]["半身像"] = 35
	JY.Person[455]["头像代号"] = 310
	JY.Person[455]["出招动画帧数3"] = 14
	
    JY.Person[456]["姓名"] = "安七"
	JY.Person[456]["等级"] = 10
	JY.Person[456]["生命"] = 900
	JY.Person[456]["生命最大值"] = 900	
	JY.Person[456]["内力"] = 10000
	JY.Person[456]["内力最大值"] = 10000
	JY.Person[456]["武功1"] = 49
	JY.Person[456]["武功等级1"] = 999
	JY.Person[456]["武功2"] = 180
	JY.Person[456]["武功等级2"] = 999
	JY.Person[456]["武功3"] = 117
	JY.Person[456]["武功等级3"] = 999
	JY.Person[456]["武功4"] = 43
	JY.Person[456]["武功等级4"] = 999
	JY.Person[456]["拳掌功夫"] = 100
    JY.Person[456]["御剑能力"] = 600
    JY.Person[456]["耍刀技巧"] = 100
    JY.Person[456]["特殊兵器"] = 100
    JY.Person[456]["暗器技巧"] = 100
	JY.Person[456]["攻击力"] = 200
	JY.Person[456]["防御力"] = 200
	JY.Person[456]["轻功"] = 300
	JY.Person[456]["内力性质"] = 2
	JY.Person[456]["声望"] = 180
	JY.Person[456]["资质"] = 100
	JY.Person[456]["半身像"] = 579
	JY.Person[456]["头像代号"] = 310
	JY.Person[456]["技能1"] = 2
	JY.Person[456]["技能2"] = 27
	JY.Person[456]["技能3"] = 38
	JY.Person[456]["技能4"] = 112
	JY.Person[456]["技能5"] = 142
	JY.Person[456]["排行"] = 8  	
	
	JY.Person[457]["姓名"] = "紫落梵"
	JY.Person[457]["等级"] = 10
	JY.Person[457]["生命"] = 900
	JY.Person[457]["生命最大值"] = 900	
	JY.Person[457]["内力"] = 10000
	JY.Person[457]["内力最大值"] = 10000
	JY.Person[457]["武功1"] = 86
	JY.Person[457]["武功等级1"] = 999
	JY.Person[457]["武功2"] = 108
	JY.Person[457]["武功等级2"] = 999
	JY.Person[457]["武功3"] = 143
	JY.Person[457]["武功等级3"] = 999
	JY.Person[457]["武功4"] = 151
	JY.Person[457]["武功等级4"] = 999
	JY.Person[457]["武功5"] = 96
	JY.Person[457]["武功等级5"] = 999
	JY.Person[457]["武功6"] = 187
	JY.Person[457]["武功等级6"] = 999
	JY.Person[457]["武功7"] = 183
	JY.Person[457]["武功等级7"] = 999
	--JY.Person[457]["武功8"] = 143
	--JY.Person[457]["武功等级8"] = 999
	JY.Person[457]["拳掌功夫"] = 200
    JY.Person[457]["御剑能力"] = 200
    JY.Person[457]["耍刀技巧"] = 200
    JY.Person[457]["特殊兵器"] = 666
    JY.Person[457]["暗器技巧"] = 200
	JY.Person[457]["攻击力"] = 200
	JY.Person[457]["防御力"] = 200
	JY.Person[457]["轻功"] = 300
	JY.Person[457]["声望"] = 108
	JY.Person[457]["资质"] = 100
	JY.Person[457]["半身像"] = 258
	JY.Person[457]["头像代号"] = 121
	JY.Person[457]["技能1"] = 13
	JY.Person[457]["技能2"] = 79
	JY.Person[457]["技能3"] = 145
	JY.Person[457]["技能4"] = 146
	JY.Person[457]["技能5"] = 155
	JY.Person[457]["排行"] = 8
	JoinMP(457,5,4)
	
	JY.Person[458]["武功2"] = 0 --解风
	JY.Person[458]["武功等级2"] = 0 
	JY.Person[458]["声望"] = 0
	JY.Person[458]["技能1"] = 60
	JY.Person[459]["武功2"] = 0 --史火龙
	JY.Person[459]["武功等级2"] = 0 
	JY.Person[459]["声望"] = 0
	JY.Person[459]["技能1"] = 60
	for i = 497, 515 do --日本忍者
		JY.Person[i]["技能1"] = 64
		JY.Person[i]["技能2"] = 99
		JY.Person[i]["技能3"] = 101
		JY.Person[i]["武器"] = 307
		JY.Person[i]["防具"] = 58
	end
	for i = 516, 536 do --日本剑豪
		JY.Person[i]["技能1"] = 46
		JY.Person[i]["技能2"] = 99
		JY.Person[i]["技能3"] = 101
		JY.Person[i]["武器"] = 303
		JY.Person[i]["防具"] = 61		
	end
	JY.Person[516]["姓名"] = "宫本武藏" --丁氏门人
	JY.Person[516]["生命最大值"] = 920
	JY.Person[516]["内力最大值"] = 4300
	JY.Person[516]["攻击力"] = 280
	JY.Person[516]["防御力"] = 250
	JY.Person[516]["轻功"] = 300
	JY.Person[516]["等级"] = 30
	JY.Person[516]["武功1"] = 110
	JY.Person[516]["武功等级1"] = 999
	JY.Person[516]["排行"] = 8
	JY.Person[516]["资质"] = 100
	JY.Person[516]["御剑能力"] = 200
	JY.Person[516]["武学常识"] = 100
	JY.Person[516]["左右互搏"] = 1	
	JY.Person[516]["半身像"] = 260
	JY.Person[516]["头像代号"] = 335
	JY.Person[516]["出招动画帧数3"] = 14
	
	JY.Person[517]["姓名"] = "佐佐木严流" --丁氏门人
	JY.Person[517]["生命最大值"] = 920
	JY.Person[517]["内力最大值"] = 4300
	JY.Person[517]["攻击力"] = 280
	JY.Person[517]["防御力"] = 250
	JY.Person[517]["轻功"] = 300
	JY.Person[517]["等级"] = 30
	JY.Person[517]["武功1"] = 110
	JY.Person[517]["武功等级1"] = 999
	JY.Person[517]["排行"] = 8
	JY.Person[517]["资质"] = 100
	JY.Person[517]["御剑能力"] = 200
	JY.Person[517]["武学常识"] = 100
	JY.Person[517]["半身像"] = 257
	JY.Person[517]["头像代号"] = 333
	JY.Person[517]["出招动画帧数3"] = 14
	
	for i = 537, 557 do --日本大名
		JY.Person[i]["技能1"] = 83
		JY.Person[i]["技能2"] = 99
		JY.Person[i]["技能3"] = 101
		JY.Person[i]["武器"] = 296
		JY.Person[i]["防具"] = 60		
	end
	for i = 559, 577 do --日本战犯
		JY.Person[i]["技能1"] = 126
		JY.Person[i]["技能2"] = 99
		JY.Person[i]["技能3"] = 101
		JY.Person[i]["武器"] = 306
		JY.Person[i]["防具"] = 59		
	end
    JY.Person[558]["姓名"] = "霍山" 
	JY.Person[558]["生命最大值"] = 990
	JY.Person[558]["内力最大值"] = 8300
	JY.Person[558]["攻击力"] = 280
	JY.Person[558]["防御力"] = 250
	JY.Person[558]["轻功"] = 350
	JY.Person[558]["等级"] = 30
	JY.Person[558]["武功1"] = 97
	JY.Person[558]["武功等级1"] = 999
	JY.Person[558]["武功2"] = 93
	JY.Person[558]["武功等级2"] = 999
	JY.Person[558]["武功3"] = 140
	JY.Person[558]["武功等级3"] = 999
	JY.Person[558]["武功4"] = 146
	JY.Person[558]["武功等级4"] = 999
	JY.Person[558]["武功5"] = 194
	JY.Person[558]["武功等级5"] = 999	
	JY.Person[558]["技能1"] = 65
	JY.Person[558]["排行"] = 8
	JY.Person[558]["资质"] = 100
	JY.Person[558]["耍刀技巧"] = 200
	JY.Person[558]["特殊兵器"] = 200
    JY.Person[558]["声望"] = 93	
	JY.Person[558]["半身像"] = 208
	JY.Person[558]["头像代号"] = 348
	JY.Person[558]["出招动画帧数2"] = 12
	JY.Person[558]["出招动画延迟2"] = 8
	JY.Person[558]["武功音效延迟2"] = 7
    JoinMP(558,13,5)

    JY.Person[49]["姓名"] = "虚竹" 
	--JoinMP(49,7,1)
	JY.Person[578]["拳掌功夫"] = 0
	JY.Person[580]["声望"] = 6 --白雕
	JY.Person[580]["武功2"] = 6
	JY.Person[580]["技能1"] = 16
	JY.Person[581]["携带物品2"] = 327 --曲非烟
	JY.Person[581]["携带物品数量2"] = 1
	JY.Person[581]["武功1"] = 0
    JoinMP(581,12,1)
	JY.Person[582]["头像代号"] = 227 --木婉清
	JY.Person[582]["半身像"] = 572
	JY.Person[582]["性别"] = 1
	JY.Person[582]["排行"] = 3
	JY.Person[582]["姓名"] = "木婉清"
	JY.Person[582]["出招动画帧数3"] = 10
	JY.Person[582]["出招动画延迟3"] = 8
	JY.Person[582]["武功音效延迟3"] = 7
	JY.Person[582]["耍刀技巧"] = 50
	JY.Person[582]["暗器技巧"] = 50
	JY.Person[582]["武功1"] = 58
	JY.Person[582]["技能1"] = 13
	JY.Person[582]["技能2"] = 32
	JY.Person[582]["技能3"] = 42
	JY.Person[582]["技能4"] = 28 --木婉清
    JY.Person[583]["姓名"] = "隼人天隐"    --隼人天隐
	JY.Person[583]["等级"] = 10
	JY.Person[583]["生命"] = 1200
	JY.Person[583]["生命最大值"] = 1200	
	JY.Person[583]["内力"] = 10000
	JY.Person[583]["内力最大值"] = 10000
	JY.Person[583]["内力性质"] = 3
	--JY.Person[583]["声望"] = 182
	--JY.Person[583]["外号"] = 180
	JY.Person[583]["武功1"] = 98
	JY.Person[583]["武功等级1"] = 999
	JY.Person[583]["拳掌功夫"] = 600
    JY.Person[583]["御剑能力"] = 600
    JY.Person[583]["耍刀技巧"] = 600
    JY.Person[583]["特殊兵器"] = 600
    JY.Person[583]["暗器技巧"] = 600
	JY.Person[583]["攻击力"] = 300
	JY.Person[583]["防御力"] = 300
	JY.Person[583]["轻功"] = 200
	JY.Person[583]["性别"] = 0
	JY.Person[583]["资质"] = 100
	JY.Person[583]["半身像"] = 545
	JY.Person[583]["头像代号"] = 302
	JY.Person[583]["排行"] = 8
	JY.Person[583]["技能1"] = 103
	JY.Person[583]["技能2"] = 112
	JY.Person[583]["技能3"] = 134
	JY.Person[583]["技能4"] = 143
	JY.Person[583]["技能5"] = 145	
	JY.Person[583]["出招动画帧数5"] = 20
	JY.Person[583]["出招动画延迟5"] = 15
	JY.Person[583]["武功音效延迟5"] = 11
	JY.Person[585]["生命最大值"] = 999 --神秘小二
	JY.Person[585]["等级"] = 20
	JY.Person[585]["内力性质"] = 2
	JY.Person[585]["抗毒能力"] = 0
	JY.Person[585]["攻击带毒"] = 0
	JY.Person[585]["武学常识"] = 100
	JY.Person[585]["武功1"] = 111
	JY.Person[585]["武功5"] = 88
	JY.Person[585]["武功6"] = 100
	JY.Person[585]["武功7"] = 96
	JY.Person[585]["武功8"] = 97
	JY.Person[585]["武功9"] = 151
	JY.Person[585]["武功10"] = 124
	for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
	JY.Person[585]["武功等级"..i] = 999
	end	
	JY.Person[585]["技能1"] = 104
	JY.Person[585]["技能2"] = 105
	JY.Person[585]["技能3"] = 106
	JY.Person[585]["技能4"] = 107
	JY.Person[585]["技能5"] = 108
	JY.Person[589]["武功1"] = 0 --水笙
	JY.Person[589]["拳掌功夫"] = 14
	JY.Person[589]["御剑能力"] = 52
	JY.Person[590]["拳掌功夫"] = 30   --李文秀
	JY.Person[590]["御剑能力"] = 50
	JY.Person[591]["武功1"] = 0 --石中玉
	JY.Person[592]["御剑能力"] = 510  --独孤求败
	JY.Person[594]["御剑能力"] = 60  --金轮法王
	JoinMP(594,6,3)
	JoinMP(595,6,3)
	JY.Person[596]["御剑能力"] = 76  --洪安通
	JY.Person[596]["技能4"] = 133 --洪教主
	JY.Person[607]["武功2"] = 103 --神雕
	JY.Person[607]["声望"] = 103
	JY.Person[607]["技能1"] = 100
	JY.Person[608]["武功1"] = 140 --大雕
	JY.Person[608]["御剑能力"] = 10
	JY.Person[608]["耍刀技巧"] = 100
	JY.Person[609]["武功1"] = 19 --火蟾
	JY.Person[609]["武功2"] = 124
	JY.Person[609]["声望"] = 124
	JY.Person[610]["武功2"] = 101 --玄蟒
	JY.Person[610]["声望"] = 101
	JY.Person[610]["武功1"] = 176
	JY.Person[610]["暗器技巧"] = JY.Person[610]["拳掌功夫"]
	JY.Person[610]["拳掌功夫"] = JY.Person[610]["耍刀技巧"]
	JY.Person[611]["武功1"] = 96 --古鳄
	JY.Person[611]["技能1"] = 91
	JY.Person[611]["特殊兵器"] = 10
	JY.Person[611]["内力"] = 8000
	JY.Person[611]["内力最大值"] = 8000
	JY.Person[612]["武功2"] = 104 --彩蛛
	JY.Person[612]["声望"] = 104
	JY.Person[613]["武功1"] = 49 --白猿
	JY.Person[613]["御剑能力"] = JY.Person[613]["耍刀技巧"]
	JY.Person[613]["耍刀技巧"] = JY.Person[613]["拳掌功夫"]
	JY.Person[614]["声望"] = 0 --阿青
	JY.Person[614]["武功1"] = 123
	JY.Person[614]["武功等级1"] = 999
	JY.Person[614]["携带物品1"] = 24
	JY.Person[614]["技能1"] = 113
	JY.Person[614]["技能2"] = 116
	JY.Person[614]["技能3"] = 118
	JY.Person[614]["技能4"] = 134
	JY.Person[615]["武功2"] = 86 --达摩祖师
	JY.Person[615]["武学常识"] = 100
	JY.Person[615]["武功4"] = 143 --达摩祖师
	JY.Person[615]["武功等级4"] = 999
	JY.Person[615]["武功5"] = 183 --达摩祖师
	JY.Person[615]["武功等级5"] = 999
	JY.Person[615]["声望"] = 183
    JoinMP(615, 5, 5)
	JY.Person[616]["武功1"] = 11 --完颜康
	JY.Person[616]["武功等级1"] = 400
	JY.Person[616]["武功2"] = 150
	JY.Person[616]["武功等级2"] = 400
	JY.Person[616]["武功3"] = 0
	JY.Person[616]["携带物品2"] = 186
	JY.Person[616]["拳掌功夫"] = 52  
	JY.Person[616]["御剑能力"] = 58
    JoinMP(616,16,2)
	JY.Person[617]["姓名"] = "春风醉" --Mr. Spring
	JY.Person[617]["等级"] = 10
	JY.Person[617]["出招动画帧数3"] = 10
	JY.Person[617]["头像代号"] = 326
	JY.Person[617]["资质"] = 50
	JY.Person[617]["声望"] = 105
	--JY.Person[617]["外号"] = 108
	JY.Person[617]["内力性质"] = 3
	JY.Person[617]["半身像"] = 540
	JY.Person[617]["声望"] = 105
	JY.Person[617]["武功1"] = 26
	JY.Person[617]["武功2"] = 105
	JY.Person[617]["武功3"] = 88
	JY.Person[617]["武功4"] = 43
	JY.Person[617]["武功5"] = 117
	JY.Person[617]["武功6"] = 118
	JY.Person[617]["武功7"] = 119
	JY.Person[617]["武功8"] = 143
	--JY.Person[617]["武功9"] = 124
	--JY.Person[617]["武功10"] = 105
	for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
	JY.Person[617]["武功等级"..i] = 999
	end
	JY.Person[617]["拳掌功夫"] = 999
	JY.Person[617]["御剑能力"] = 200
	JY.Person[617]["耍刀技巧"] = 200
	JY.Person[617]["特殊兵器"] = 200
	JY.Person[617]["暗器技巧"] = 200
	JY.Person[617]["武学常识"] = 100
	JY.Person[617]["左右互搏"] = 1
	JY.Person[617]["技能1"] = 13
	JY.Person[617]["技能2"] = 103
	JY.Person[617]["技能3"] = 105
	JY.Person[617]["技能4"] = 134
	JY.Person[617]["技能5"] = 143
	JY.Person[618]["声望"] = 101 --逍遥子
	JY.Person[618]["内力性质"] = 3
	JY.Person[618]["技能1"] = 10
	JY.Person[618]["技能2"] = 93
	JY.Person[618]["技能3"] = 103
	JY.Person[618]["技能4"] = 105
	JY.Person[618]["技能5"] = 106
	JY.Person[618]["出招动画帧数3"] = 16
    JoinMP(618, 7, 3)
	JY.Person[618]["无用13"] = 1000
	JY.Person[618]["左右互搏"] = 1
	JY.Person[618]["武功4"] = 179
	JY.Person[618]["武功等级4"] = 999
	JY.Person[618]["武功5"] = 0

	JY.Person[619]["武功1"] = 129 --耶律齐
	JY.Person[619]["武功等级1"] = 500
	JY.Person[619]["武功2"] = 150 
	JY.Person[619]["武功等级2"] = 500
	JY.Person[619]["武功3"] = 0 
	JY.Person[619]["武功等级3"] = 0 	
	JY.Person[619]["武功4"] = 0 
	JY.Person[619]["武功等级4"] = 0
	JY.Person[619]["武功等级5"] = 0 
	JY.Person[619]["声望"] = 150
	JY.Person[619]["拳掌功夫"] = 58 
	JY.Person[619]["御剑能力"] = 64 
	JY.Person[619]["携带物品2"] = 287
    JoinMP(619, 16, 3)
	JY.Person[620]["武功1"] = 9 --欧阳锋
	JY.Person[620]["武功2"] = 120
	JY.Person[620]["武功3"] = 95
	JY.Person[620]["武功4"] = 118
	JY.Person[620]["武功等级4"] = 999
	JY.Person[620]["声望"] = 95
	JY.Person[620]["携带物品4"] = 73
	JY.Person[620]["御剑能力"] = 75
	JY.Person[620]["携带物品数量4"] = 1	
	JY.Person[621]["携带物品4"] = 249 --胡一刀
	JY.Person[621]["携带物品数量4"] = 1	
	for i = 622, 624 do --药王门师徒
		JY.Person[i]["武功1"] = 3
		JY.Person[i]["声望"] = 0
	end
	JY.Person[624]["武功2"] = 159
	JY.Person[624]["武功等级2"] = 999
	JY.Person[625]["武功1"] = 0 --袁冠南
	JY.Person[625]["武功等级1"] = 0
	JY.Person[625]["拳掌功夫"] = 30 
	JY.Person[625]["御剑能力"] = 50		
	JY.Person[626]["武功2"] = 204 --何足道
	JY.Person[626]["武功等级2"] = 999	
	JY.Person[626]["声望"] = 204	
	JY.Person[627]["携带物品1"] = 334 --公孙绿萼
	JY.Person[627]["携带物品数量1"] = 1 
			for i,v in pairs(CC.Person_S) do--谢无悠
                JY.Person[597][i] = JY.Person[636][i]
			end
				JY.Person[597]["姓名"] = "谢无悠"
				JY.Person[597]["等级"] = 10
	JY.Person[597]["生命"] = 900
	JY.Person[597]["生命最大值"] = 900	
	JY.Person[597]["内力"] = 10000
	JY.Person[597]["内力最大值"] = 10000
	            JY.Person[597]["武功2"] = 180
	            JY.Person[597]["武功等级2"] = 999
	            JY.Person[597]["武功3"] = 115
	            JY.Person[597]["武功等级3"] = 999
				JY.Person[597]["御剑能力"] = 200
				JY.Person[597]["攻击力"] = 120
				JY.Person[597]["防御力"] = 120
				JY.Person[597]["声望"] = 180
				JY.Person[597]["轻功"] = 120
				JY.Person[597]["武功1"] = 131
                JY.Person[597]["武功等级1"] = 999
		        JY.Person[597]["性别"] = 1
		        JY.Person[597]["资质"] = 100
		        JY.Person[597]["内力性质"] = 3
		        JY.Person[597]["左右互搏"] = 0
	            JY.Person[597]["半身像"] = 578
	            JY.Person[597]["头像代号"] = 342
				JY.Person[597]["技能1"] = 0
	            JY.Person[597]["技能2"] = 0
				JY.Person[597]["技能3"] = 0
				JY.Person[597]["携带物品1"] = 268
	            JY.Person[597]["携带物品数量1"] = 1
				JY.Person[597]["携带物品2"] = -1
	            JY.Person[597]["携带物品数量2"] = 0
				JY.Person[597]["排行"] = 8
				JoinMP(597,11,4)
	for i,v in pairs(CC.Person_S) do--谢无悠
                JY.Person[598][i] = JY.Person[637][i]
			end
				JY.Person[598]["姓名"] = "滕文婷"
				JY.Person[598]["等级"] = 10
	JY.Person[598]["生命"] = 900
	JY.Person[598]["生命最大值"] = 900	
	JY.Person[598]["内力"] = 10000
	JY.Person[598]["内力最大值"] = 10000
	            JY.Person[598]["武功1"] = 109
	            JY.Person[598]["武功等级1"] = 999
	            JY.Person[598]["武功2"] = 111
	            JY.Person[598]["武功等级2"] = 999
	            JY.Person[598]["拳掌功夫"] = 400
	            JY.Person[598]["耍刀技巧"] = 400
				JY.Person[598]["攻击力"] = 120
				JY.Person[598]["防御力"] = 120
				JY.Person[598]["轻功"] = 120
		        JY.Person[598]["性别"] = 1
		        JY.Person[598]["资质"] = 100
		        JY.Person[598]["内力性质"] = 0
		        JY.Person[598]["左右互搏"] = 0
	            JY.Person[598]["半身像"] = 385
	            JY.Person[598]["头像代号"] = 334
				JY.Person[598]["技能1"] = 117
	            JY.Person[598]["技能2"] = 137
				JY.Person[598]["技能3"] = 13
				JY.Person[598]["排行"] = 8
	for i,v in pairs(CC.Person_S) do--黄裳
                JY.Person[599][i] = JY.Person[129][i]
			end
				JY.Person[599]["姓名"] = "黄裳"
				JY.Person[599]["等级"] = 10
	JY.Person[599]["生命"] = 900
	JY.Person[599]["生命最大值"] = 900	
	JY.Person[599]["内力"] = 10000
	JY.Person[599]["内力最大值"] = 10000
	            JY.Person[599]["武功1"] = 11
	            JY.Person[599]["武功等级1"] = 999
	            JY.Person[599]["武功2"] = 107
	            JY.Person[599]["武功等级2"] = 999
	            JY.Person[599]["武功3"] = 0
	            JY.Person[599]["武功等级3"] = 0
	            JY.Person[599]["武功4"] = 0
	            JY.Person[599]["武功等级4"] = 0
	            JY.Person[599]["武功5"] = 0
	            JY.Person[599]["武功等级5"] = 0
	            JY.Person[599]["武功6"] = 0
	            JY.Person[599]["武功等级6"] = 0				
	            JY.Person[599]["拳掌功夫"] = 400
	            JY.Person[599]["声望"] = 107
				JY.Person[599]["攻击力"] = 120
				JY.Person[599]["防御力"] = 120
				JY.Person[599]["轻功"] = 120
		        JY.Person[599]["资质"] = 100
	            JY.Person[599]["半身像"] = 124
	            JY.Person[599]["头像代号"] = 335
				JY.Person[599]["技能1"] = 124
	            JY.Person[599]["技能2"] = 134
				JY.Person[599]["技能3"] = 65
				JY.Person[599]["技能4"] = 105
				JY.Person[599]["排行"] = 8
    JoinMP(129,16,5)
	for i,v in pairs(CC.Person_S) do--武无敌
                JY.Person[600][i] = JY.Person[133][i]
			end
				JY.Person[600]["姓名"] = "武无敌"
				JY.Person[600]["等级"] = 10
	JY.Person[600]["生命"] = JY.Person[600]["生命最大值"]
	JY.Person[600]["生命最大值"] = JY.Person[600]["生命最大值"] + 1000	
	JY.Person[600]["内力"] = 10000
	JY.Person[600]["内力最大值"] = 10000
	            JY.Person[600]["武功1"] = 181
	            JY.Person[600]["武功等级1"] = 999
				JY.Person[600]["武功2"] = 43
	            JY.Person[600]["武功等级2"] = 999
	            JY.Person[600]["拳掌功夫"] = 999
                JY.Person[600]["御剑能力"] = 999
                JY.Person[600]["耍刀技巧"] = 999
                JY.Person[600]["特殊兵器"] = 999
                JY.Person[600]["暗器技巧"] = 999
				JY.Person[600]["攻击力"] = 200
				JY.Person[600]["防御力"] = 200
				JY.Person[600]["轻功"] = 200
				JY.Person[600]["声望"] = 181
		        JY.Person[600]["资质"] = 100
	            JY.Person[600]["半身像"] = 230
	            JY.Person[600]["头像代号"] = 164
				JY.Person[600]["排行"] = 8
    --for i,v in pairs(CC.Person_S) do--林朝英
               -- JY.Person[601][i] = JY.Person[638][i]
			--end
				JY.Person[601]["姓名"] = "林朝英"
				JY.Person[601]["等级"] = 10
	JY.Person[601]["生命"] = 900
	JY.Person[601]["生命最大值"] = 900	
	JY.Person[601]["内力"] = 6000
	JY.Person[601]["内力最大值"] = 6000
	            JY.Person[601]["武功1"] = 42
	            JY.Person[601]["武功等级1"] = 999
	            JY.Person[601]["武功2"] = 119
	            JY.Person[601]["武功等级2"] = 999
	            JY.Person[601]["武功3"] = 121
	            JY.Person[601]["武功等级3"] = 999
	            JY.Person[601]["武功4"] = 79
	            JY.Person[601]["武功等级4"] = 999
				JY.Person[601]["声望"] = 121
	            JY.Person[601]["拳掌功夫"]=200
                JY.Person[601]["御剑能力"]=200
                JY.Person[601]["特殊兵器"]=200
                JY.Person[601]["暗器技巧"]=200
				JY.Person[601]["攻击力"] = 120
				JY.Person[601]["防御力"] = 120
				JY.Person[601]["轻功"] = 120
		        JY.Person[601]["性别"] = 1
		        JY.Person[601]["资质"] = 80
		        JY.Person[601]["内力性质"] = 0
		        JY.Person[601]["左右互搏"] = 0
	            JY.Person[601]["半身像"] = 322
	            JY.Person[601]["头像代号"] = 330
				JY.Person[601]["技能1"] = 83
	            JY.Person[601]["技能2"] = 29
				JY.Person[601]["技能3"] = 107
				JY.Person[601]["排行"] = 7
				JoinMP(601,3,3)
	for i,v in pairs(CC.Person_S) do--段思平
                JY.Person[602][i] = JY.Person[133][i]
		    end
				JY.Person[602]["姓名"] = "段思平"
				JY.Person[602]["等级"] = 10
	JY.Person[602]["生命"] = 900
	JY.Person[602]["生命最大值"] = 900	
	JY.Person[602]["内力"] = 10000
	JY.Person[602]["内力最大值"] = 10000
	            JY.Person[602]["武功1"] = 49
	            JY.Person[602]["武功等级1"] = 999
				JY.Person[602]["武功2"] = 17
	            JY.Person[602]["武功等级2"] = 999
				JY.Person[602]["武功3"] = 152
	            JY.Person[602]["武功等级3"] = 999
				JY.Person[602]["武功4"] = 199
	            JY.Person[602]["武功等级4"] = 999
	            JY.Person[602]["拳掌功夫"]=200
                JY.Person[602]["御剑能力"]=200
				JY.Person[602]["攻击力"] = 150
				JY.Person[602]["防御力"] = 150
				JY.Person[602]["轻功"] = 120
				JY.Person[602]["声望"] = 152
				JY.Person[602]["性别"] = 0
		        JY.Person[602]["资质"] = 100
	            JY.Person[602]["半身像"] = 486
	            JY.Person[602]["头像代号"] = 65
				JY.Person[602]["排行"] = 8
				JoinMP(602,15,4)
	for i,v in pairs(CC.Person_S) do--木灵子
                JY.Person[603][i] = JY.Person[134][i]
		    end
				JY.Person[603]["姓名"] = "木灵子"
				JY.Person[603]["等级"] = 10
				JY.Person[603]["生命"] = 900
				JY.Person[603]["生命最大值"] = 900	
				JY.Person[603]["内力"] = 10000
				JY.Person[603]["内力最大值"] = 10000
				JY.Person[603]["内力性质"] = 3
				JY.Person[603]["声望"] = 189
	            JY.Person[603]["武功1"] = 23
	            JY.Person[603]["武功等级1"] = 999
				JY.Person[603]["武功2"] = 189
	            JY.Person[603]["武功等级2"] = 999
	            JY.Person[603]["拳掌功夫"] = 600
				JY.Person[603]["特殊兵器"] = 500
                JY.Person[603]["暗器技巧"] = 500
				JY.Person[603]["攻击力"] = 150
				JY.Person[603]["防御力"] = 100
				JY.Person[603]["轻功"] = 120
				JY.Person[603]["性别"] = 0
		        JY.Person[603]["资质"] = 100
	            JY.Person[603]["半身像"] = 231
	            JY.Person[603]["头像代号"] = 185
				JY.Person[603]["排行"] = 8
				JoinMP(603,18,5)
			for i,v in pairs(CC.Person_S) do--黄衫女
                JY.Person[604][i] = JY.Person[931][i]
		    end
				JY.Person[604]["姓名"] = "黄衫女"
				JY.Person[604]["等级"] = 10
				JY.Person[604]["生命"] = 900
				JY.Person[604]["生命最大值"] = 900	
				JY.Person[604]["内力"] = 10000
				JY.Person[604]["内力最大值"] = 10000
				JY.Person[604]["内力性质"] = 0
				JY.Person[604]["声望"] = 121
	            JY.Person[604]["武功1"] = 11
	            JY.Person[604]["武功等级1"] = 999
				JY.Person[604]["武功2"] = 121
	            JY.Person[604]["武功等级2"] = 999
				JY.Person[604]["武功3"] = 119
	            JY.Person[604]["武功等级3"] = 999
				JY.Person[604]["武功4"] = 107
	            JY.Person[604]["武功等级4"] = 999				
	            JY.Person[604]["拳掌功夫"] = 300
				JY.Person[604]["特殊兵器"] = 100
                JY.Person[604]["暗器技巧"] = 200
				JY.Person[604]["攻击力"] = 150
				JY.Person[604]["防御力"] = 100
				JY.Person[604]["轻功"] = 120
				JY.Person[604]["性别"] = 1
		        JY.Person[604]["资质"] = 90
	            JY.Person[604]["半身像"] = 360
	            JY.Person[604]["头像代号"] = 339
				JY.Person[604]["排行"] = 6
				JoinMP(604,3,2)
				--setJX(605)
				JY.Person[605]["姓名"] = "公孙止"
				JY.Person[605]["等级"] = 10
				JY.Person[605]["生命"] = 900
				JY.Person[605]["生命最大值"] = 900	
				JY.Person[605]["内力"] = 10000
				JY.Person[605]["内力最大值"] = 10000
				JY.Person[605]["内力性质"] = 0
	            JY.Person[605]["武功1"] = 77
	            JY.Person[605]["武功等级1"] = 999
	            JY.Person[605]["特殊兵器"] = 300
				JY.Person[605]["御剑能力"] = 200
                JY.Person[605]["耍刀技巧"] = 200
				JY.Person[605]["攻击力"] = 150
				JY.Person[605]["防御力"] = 100
				JY.Person[605]["轻功"] = 120
				JY.Person[605]["出招动画帧数5"] = 17
				JY.Person[605]["出招动画延迟5"] = 12
				JY.Person[605]["武功音效延迟5"] = 9
				JY.Person[605]["性别"] = 0
		        JY.Person[605]["资质"] = 30
	            JY.Person[605]["半身像"] = 549
	            JY.Person[605]["头像代号"] = 347
				JY.Person[605]["排行"] = 4
	JY.Person[629]["武功1"] = 0 --阿九
	JY.Person[629]["武功2"] = 0
	JY.Person[629]["武功等级1"] = 0
	JY.Person[629]["武功等级2"] = 0
	JY.Person[629]["携带物品1"] = 301
	JY.Person[630]["技能2"] = 23 --夏雪宜
	JoinMP(631,13,1)
	JY.Person[632]["武功1"] = 114 --丁典
	JY.Person[632]["武功2"] = 94 --丁典
	JY.Person[632]["武功3"] = 0 --丁典
	JY.Person[632]["御剑能力"] = 66
	JY.Person[632]["携带物品1"] = 237
	JY.Person[632]["携带物品数量1"] = 1	
	JY.Person[632]["携带物品2"] = -1
	JY.Person[632]["携带物品数量2"] = 0	
	JY.Person[635]["武功等级1"] = 900 --穆念慈
	JY.Person[635]["武功2"] = 0 
	JY.Person[635]["武功等级2"] = 0
	JY.Person[635]["武功3"] = 0
	JY.Person[635]["武功等级3"] = 0
	JY.Person[635]["声望"] = 0
	JY.Person[635]["御剑能力"] = 45
	JY.Person[635]["轻功"] = 60 	
	JY.Person[636]["武功1"] = 79 --袁紫衣
	for i,v in pairs(CC.Person_S) do
		JY.Person[637][i] = JY.Person[281][i]
	end
	JY.Person[637]["姓名"] = "凤天南" --凤天南
	JY.Person[637]["武功1"] = 138
	JY.Person[637]["武功等级1"] = 999
	JY.Person[637]["携带物品4"] = 275 --凤天南
	JY.Person[637]["携带物品数量4"] = 1
	JY.Person[637]["头像代号"] = 208
	JoinMP(638,17,1) --峨眉周芷若
	JY.Person[638]["武功3"] = 186
	JY.Person[639]["拳掌功夫"] = 34  --赵敏 
	JY.Person[639]["御剑能力"] = 42	
	JY.Person[639]["头像代号"] = 92
	JY.Person[639]["出招动画帧数5"] = 16
	JY.Person[639]["出招动画延迟5"] = 14
	JY.Person[639]["武功音效延迟5"] = 12
	JY.Person[642]["武功2"] = 0 --阿大
	JY.Person[642]["武功等级2"] = 0	
	JY.Person[642]["声望"] = 0
	JoinMP(640,5,3)
	JoinMP(641,5,3)
	JoinMP(642,2,3)
	JY.Person[650]["武功1"] = 78 --卓天雄
	JY.Person[650]["御剑能力"] = 10
	JY.Person[650]["特殊兵器"] = 84	
	JY.Person[655]["医疗能力"] = 0	--林月如
	JY.Person[655]["用毒能力"] = 0
	JY.Person[655]["解毒能力"] = 0
	JY.Person[655]["拳掌功夫"] = 40
	JY.Person[655]["暗器技巧"] = 10
	JY.Person[655]["技能1"] = 135
	JY.Person[655]["技能2"] = 128
	JY.Person[656]["用毒能力"] = 0	--赵灵儿	
	JY.Person[656]["拳掌功夫"] = 10
	JY.Person[656]["暗器技巧"] = 40
	JY.Person[656]["技能1"] = 136
	JY.Person[656]["技能2"] = 128	
	JY.Person[657]["抗毒能力"] = 100 --阿奴
	JY.Person[657]["攻击带毒"] = 100
	JY.Person[657]["武学常识"] = 0	
	JY.Person[657]["排行"] = 3
	JY.Person[657]["技能1"] = 138
	JY.Person[657]["技能2"] = 128	
	for i = 655, 657 do
		JY.Person[i]["性别"] = 1
		JY.Person[i]["资质"] = 90
		JY.Person[i]["武功1"] = 0
		JY.Person[i]["武功等级1"] = 0
	end
	JoinMP(658,6,2)--宝象
	JY.Person[661]["姓名"] = "白绣" --白绣
	JY.Person[661]["性别"] = 1
	JY.Person[661]["排行"] = 2
	JY.Person[661]["拳掌功夫"] = 30
	JY.Person[661]["御剑能力"] = 50
	JY.Person[661]["耍刀技巧"] = 30
	JY.Person[661]["特殊兵器"] = 30	
	JY.Person[661]["暗器技巧"] = 30
	JY.Person[661]["武功1"] = 0
	JY.Person[661]["武功等级1"] = 0	
	JY.Person[661]["内力性质"] = 0	
	JY.Person[661]["半身像"] = 570
	JY.Person[661]["头像代号"] = 92
	JY.Person[661]["资质"] = 80
	JY.Person[661]["技能1"] = 17
	JY.Person[661]["技能2"] = 89
	JY.Person[661]["技能3"] = 130	
	JY.Person[662]["武功1"] = 108 --水镜四奇
	JY.Person[662]["武功2"] = 47
	JY.Person[662]["武功3"] = 106
	JY.Person[662]["武功4"] = 107
	JY.Person[662]["武功5"] = 88
	JY.Person[662]["武功6"] = 103
	for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
	JY.Person[662]["武功等级"..i] = 999
	end
	JY.Person[662]["声望"] = 108
	JY.Person[662]["外号"] = 107
	JY.Person[662]["内力性质"] = 0
	JY.Person[662]["资质"] = 50
	JY.Person[662]["等级"] = 30
	JY.Person[662]["经验"] = 52000
	JY.Person[662]["生命最大值"] = 999
	JY.Person[662]["内力最大值"] = 7750
	JY.Person[662]["生命"] = 999
	JY.Person[662]["内力"] = 7750
	JY.Person[662]["攻击力"] = 380
	JY.Person[662]["防御力"] = 380
	JY.Person[662]["轻功"] = 380
	JY.Person[662]["拳掌功夫"] = 100
	JY.Person[662]["御剑能力"] = 100
	JY.Person[662]["耍刀技巧"] = 100
	JY.Person[662]["特殊兵器"] = 100
	JY.Person[662]["武学常识"] = 100
	JY.Person[662]["左右互搏"] = 1
	JY.Person[662]["姓名"] = "水镜四奇"
	JY.Person[662]["头像代号"] = 228
	JY.Person[662]["半身像"] = 565
	JY.Person[662]["出招动画帧数3"] = 23
	JY.Person[662]["技能1"] = 90
	JY.Person[662]["技能2"] = 95
	JY.Person[662]["技能3"] = 96
	JY.Person[662]["技能4"] = 98
	JY.Person[662]["技能5"] = 134	
	JY.Person[662]["排行"] = 8	
	JY.Person[663]["武功1"] = 0 --双儿
	JY.Person[663]["武功等级1"] = 0
	JY.Person[663]["拳掌功夫"] = 50
	JY.Person[663]["御剑能力"] = 10
	JY.Person[663]["耍刀技巧"] = 10
	JY.Person[663]["特殊兵器"] = 10
	JY.Person[663]["暗器技巧"] = 30
	JY.Person[663]["头像代号"] = 261
	JY.Person[663]["半身像"] = 261
	JY.Person[663]["性别"] = 1
	JY.Person[663]["出招动画帧数3"] = 11
	JY.Person[663]["技能1"] = 65
	JY.Person[663]["技能2"] = 131
	JY.Person[663]["排行"] = 2
	JY.Person[663]["内力性质"] = 2
	JY.Person[664]["武功3"] = 0 --小宝
	JY.Person[664]["武功等级3"] = 0
	JY.Person[664]["攻击力"] = 30
	JY.Person[664]["防御力"] = 30
	JY.Person[664]["轻功"] = 40
	JY.Person[664]["拳掌功夫"] = 15
	JY.Person[664]["御剑能力"] = 10
	JY.Person[664]["耍刀技巧"] = 10
	JY.Person[664]["特殊兵器"] = 10
	JY.Person[664]["暗器技巧"] = 40
	JY.Person[664]["携带物品3"] = 286 
	JY.Person[664]["携带物品数量3"] = 1	
	for i,v in pairs(CC.Person_S) do--组长
                JY.Person[665][i] = JY.Person[134][i]
		    end
				JY.Person[665]["姓名"] = "老贾"
				JY.Person[665]["等级"] = 10
				JY.Person[665]["生命"] = 900
				JY.Person[665]["生命最大值"] = 900	
				JY.Person[665]["内力"] = 10000
				JY.Person[665]["内力最大值"] = 10000
				JY.Person[665]["内力性质"] = 3
				JY.Person[665]["声望"] = 93
	            JY.Person[665]["外号"] = 184
	            JY.Person[665]["武功1"] = 155
	            JY.Person[665]["武功等级1"] = 999
				JY.Person[665]["武功2"] = 184
	            JY.Person[665]["武功等级2"] = 999
				JY.Person[665]["武功3"] = 93
	            JY.Person[665]["武功等级3"] = 999
				JY.Person[665]["武功4"] = 195
	            JY.Person[665]["武功等级4"] = 999
	            JY.Person[665]["耍刀技巧"] = 300
				JY.Person[665]["攻击力"] = 200
				JY.Person[665]["防御力"] = 100
				JY.Person[665]["轻功"] = 120
				JY.Person[665]["性别"] = 0
		        JY.Person[665]["资质"] = 100
	            JY.Person[665]["半身像"] = 245
	            JY.Person[665]["头像代号"] = 29
				JY.Person[665]["排行"] = 8
				JY.Person[665]["技能1"] = 19
	            JY.Person[665]["技能2"] = 20
	            JY.Person[665]["技能3"] = 83
	            JY.Person[665]["技能4"] = 107
				JY.Person[665]["技能5"] = 142
				JoinMP(665,13,4)
	for i,v in pairs(CC.Person_S) do--海底捞月
                JY.Person[666][i] = JY.Person[134][i]
		    end
				JY.Person[666]["姓名"] = "海底捞月"
				JY.Person[666]["等级"] = 10
				JY.Person[666]["生命"] = 900
				JY.Person[666]["生命最大值"] = 900	
				JY.Person[666]["内力"] = 10000
				JY.Person[666]["内力最大值"] = 10000
				JY.Person[666]["内力性质"] = 3
				JY.Person[666]["声望"] = 99
	            JY.Person[666]["外号"] = 185
				JY.Person[666]["武功1"] = 16
				JY.Person[666]["武功等级1"] = 999
	            JY.Person[666]["武功2"] = 46
				JY.Person[666]["武功等级2"] = 999
				JY.Person[666]["武功3"] = 99
	            JY.Person[666]["武功等级3"] = 999
				JY.Person[666]["武功4"] = 185
	            JY.Person[666]["武功等级4"] = 999
				JY.Person[666]["武功5"] = 118
	            JY.Person[666]["武功等级5"] = 999
				JY.Person[666]["武功6"] = 43
	            JY.Person[666]["武功等级6"] = 999
	            JY.Person[666]["拳掌功夫"] = 300
                JY.Person[666]["御剑能力"] = 300
                JY.Person[666]["耍刀技巧"] = 300
                JY.Person[666]["特殊兵器"] = 300
                JY.Person[666]["暗器技巧"] = 300
				JY.Person[666]["攻击力"] = 200
				JY.Person[666]["防御力"] = 100
				JY.Person[666]["轻功"] = 120
				JY.Person[666]["性别"] = 0
		        JY.Person[666]["资质"] = 100
				JY.Person[666]["内力性质"] = 0
	            JY.Person[666]["半身像"] = 378
	            JY.Person[666]["头像代号"] = 75
				JY.Person[666]["排行"] = 8
				JY.Person[666]["技能1"] = 74
	            JY.Person[666]["技能2"] = 103
	            JY.Person[666]["技能3"] = 112
	            JY.Person[666]["技能4"] = 143
				JY.Person[666]["技能5"] = 145	
				JoinMP(666,4,4)	
	for i,v in pairs(CC.Person_S) do--
                JY.Person[667][i] = JY.Person[84][i]
		    end
				JY.Person[667]["姓名"] = "商御隐"
				JY.Person[667]["等级"] = 10
				JY.Person[667]["生命"] = 900
				JY.Person[667]["生命最大值"] = 900	
				JY.Person[667]["内力"] = 10000
				JY.Person[667]["内力最大值"] = 10000
				JY.Person[667]["内力性质"] = 0
				JY.Person[667]["声望"] = 6
	            JY.Person[667]["外号"] = 93
				JY.Person[667]["武功1"] = 18
				JY.Person[667]["武功等级1"] = 999
	            JY.Person[667]["武功2"] = 6
				JY.Person[667]["武功等级2"] = 999
				JY.Person[667]["武功3"] = 193
	            JY.Person[667]["武功等级3"] = 999
				JY.Person[667]["武功4"] = 102
	            JY.Person[667]["武功等级4"] = 999
				JY.Person[667]["武功5"] = 93
	            JY.Person[667]["武功等级5"] = 999
	            JY.Person[667]["拳掌功夫"] = 450
                JY.Person[667]["御剑能力"] = 450
                JY.Person[667]["耍刀技巧"] = 300
                JY.Person[667]["特殊兵器"] = 300
                JY.Person[667]["暗器技巧"] = 600
				JY.Person[667]["攻击力"] = 200
				JY.Person[667]["防御力"] = 100
				JY.Person[667]["轻功"] = 300
				JY.Person[667]["性别"] = 0
		        JY.Person[667]["资质"] = 100
	            JY.Person[667]["半身像"] = 470
				JY.Person[667]["排行"] = 8
				JY.Person[667]["技能1"] = 13
	            JY.Person[667]["技能2"] = 134
	            JY.Person[667]["技能3"] = 150
	            JY.Person[667]["技能4"] = 145
				JY.Person[667]["技能5"] = 149	
				JoinMP(667,10,2)			
	JY.Person[668]["出招动画帧数2"] = 15--给步惊云用的码
	JY.Person[668]["出招动画延迟2"] = 14
	JY.Person[668]["武功音效延迟2"] = 13
	JY.Person[668]["出招动画帧数3"] = 9
	JY.Person[668]["出招动画延迟3"] = 8
	JY.Person[668]["武功音效延迟3"] = 7			
	JY.Person[929]["武功等级1"] = 999
	JY.Person[929]["武功等级2"] = 999
	JoinMP(929,11,3)
	JoinMP(932,19,5)
	JY.Person[932]["排行"] = 8
	JY.Person[932]["声望"] = 204
	for i = 689, 698 do --日月教徒
    JoinMP(i,12,1)
	end	
	for i = 709, 718 do --番僧
	JoinMP(i,6,1)
	end
	for i = 749, 758 do --番僧
	JoinMP(i,16,1)
	end
	for i = 759, 768 do --明教弟子
    JoinMP(i,13,1)
	end	
	for i = 788, 797 do --峨眉弟子
    JoinMP(i,17,1)
	end	
	for i = 808, 816 do --崆峒弟子
    JoinMP(i,18,1)
	end
	JoinMP(817,18,2)
	JoinMP(837,14,2)
	JoinMP(847,14,2)
	for i = 909, 928 do --五岳弟子
    JoinMP(i,14,1)
	end	
	
	--由于门派不足，暂时将部分人物归于其他的门派
	JoinMP(7,19,3) --何太冲
	JoinMP(24,14,4) --余沧海
	JoinMP(25,12,5) --蓝凤凰
	JoinMP(43,14,4) --白万剑
	JoinMP(67,18,5) --裘千仞
	JoinMP(71,13,5) --洪安通
	JoinMP(83,12,5) --何铁手
	JoinMP(87,13,2) --苏荃
	JoinMP(137,14,1) --陈达海
	JoinMP(166,19,3) --班淑娴
	JoinMP(176,12,2) --何红药
	JoinMP(180,19,2) --洞玄
	JoinMP(181,19,2) --闵子华
	--JoinMP(184,14,3) --玉真子
	JoinMP(596,13,5) --洪安通
	JoinMP(626,19,4) --何足道
	--JoinMP(629,14,2) --阿九
	JoinMP(661,14,2) --白绣
	JY.Person[7]["武功2"] = 204
	JY.Person[7]["武功等级2"] = 800
	JY.Person[7]["武功3"] = 205
	JY.Person[7]["武功等级3"] = 800
	JY.Person[7]["声望"] = 204
	JY.Person[166]["声望"] = 204
	JY.Person[166]["武功3"] = 204
	JY.Person[166]["武功等级3"] = 700
	JY.Person[166]["武功4"] = 205
	JY.Person[166]["武功等级4"] = 700
	JY.Person[626]["武功3"] = 205
	JY.Person[626]["武功等级3"] = 999
	for i = 211, 220 do --青城弟子
		JoinMP(i,14,1)
	end
	
	for i = 221, 230 do --五毒教徒
		JoinMP(i,12,1)
	end
	
	for i = 241, 250 do --雪山弟子
		JoinMP(i,14,1)
	end
	
	for i = 281, 290 do --铁掌帮众
		JoinMP(i,18,1)
	end
	
	for i = 340, 349 do --昆仑弟子
		JoinMP(i,19,1)
	end
	
	for i = 390, 398 do --神龙教徒
		JoinMP(i,13,1)
	end
	JoinMP(399,13,2)
	
	for i = 669, 678 do --青城弟子
		JoinMP(i,14,1)
	end
	
	for i = 679, 688 do --五毒教徒
		JoinMP(i,12,1)
	end
	
	for i = 699, 708 do --雪山弟子
		JoinMP(i,14,1)
	end
	
	for i = 739, 748 do --铁掌帮众
		JoinMP(i,18,1)
	end
	
	for i = 798, 807 do --昆仑弟子
		JoinMP(i,19,1)
	end
	
	for i = 848, 856 do --神龙教徒
		JoinMP(i,13,1)
	end
	JoinMP(857,13,2)

	for i = 497, 577 do --倭寇
		local aa = math.random(#CC.MP)
		local bb = math.random(2)
		if aa == 9 then
			if bb == 1 then
				aa = aa - math.random(5)
			else
				aa = aa + math.random(5)
			end
		end	
			
		if i == 558 then
		elseif i == 516 or i == 517 then
			JoinMP(i, 11, 3)
			JY.Person[i]["武功2"] = 180
			JY.Person[i]["武功等级2"] = 999
			JY.Person[i]["武功3"] = 115
			JY.Person[i]["武功等级3"] = 999
			JY.Person[i]["声望"] = 180
		else
			JoinMP(i, aa, 3)
		end
	end
	--临时处理结束
	
	for i = 1, JY.PersonNum - 1 do
		JY.Person[i]["实战"] = limitX(JY.Person[i]["排行"] - 2, 0, 6) * 75
	end
	JY.Scene[50]["名称"] = "阎基居"
	JY.Scene[61]["名称"] = "高升客栈"
	JY.Scene[78]["名称"] = "勃泥岛"
	--武骧金星：初始化调整结束


	--JY.WugongNum = 179
    --JY.ThingNum = 339	
	newgame()
	
	lib.FreeSur(ssid)
	--定义初始数据和事件
	SetS(0, 0, 0, 0, 1)
	SetS(0, 0, 0, 1, 0)
	SetS(10, 1, 0, 0, 1)
	SetS(57, 52, 29, 1, 5178)
	SetS(57, 52, 30, 1, 5178)
	SetD(70, 59, 0, 0)
	SetD(70, 59, 2, 0)
	SetD(71, 3, 2, 0)
	SetD(71, 2, 2, 0)

	SetS(0, 10, 0, 0, 0)
	
	SetS(13, 18, 28, 3, 101)
	SetS(13, 18, 29, 3, 102)
	instruct_3(13, 101, 0, 0, 0, 0, 2001, 0, 0, 0, 0, -2, -2)
	instruct_3(13, 102, 0, 0, 0, 0, 2001, 0, 0, 0, 0, -2, -2)
	SetS(102, 20, 25, 2, 0)
	SetD(102, 13, 2, 0)
	SetS(102, 17, 22, 3, 101)
	instruct_3(102, 101, 1, 0, 1014, 0, 0, 7262, 7262, 7262, 0, -2, -2)
	--instruct_3(32, 30, -1, 1, 3512, -1, -1, 4623*2, 4623*2, 4623*2, -2, 32, 30) -- 无酒自制神雕线
	--instruct_3(70, 82, -1, 1, 3501, -1, -1, 4413*2, 4413*2, 4413*2, -2, 7, 33) -- 小村添加舞
	--instruct_3(108, 50, 0, -1, -1, -1, 3503, -2, -2, -2, -2, 14, 27) -- 无酒自制飞雪线
	--instruct_3(108, 51, 0, -1, -1, -1, 3503, -2, -2, -2, -2, 15, 27) -- 无酒自制飞雪线
	--instruct_3()
	for i = 5, 7 do
	  SetD(104, 88, i, 8738)
	end
	
	SetS(99, 0, 0, 1, 0) --增加判定特殊人物华山觉醒技能
	SetS(99, 0, 0, 2, 0)
	SetS(72, 0, 0, 0, 10)
	
	SetS(103,17,21,3,80);		--新增药王庙事件编号80     --宝象贴图
	SetS(103,29,11,3,81);		--用来显示丁典的坟墓
	SetS(103,29,12,3,82);
	
	SetS(63,20,27,3,80);		--新增天宁寺事件编号80   戚长发贴图
	SetS(63,19,22,3,81);		--新增天宁寺事件编号81   获取连城诀之后路过触发遇到戚长发
	
	
	--nino：追加事件初始设置
	SetS(2, 25, 48, 3, 20) --西毒vs北丐支线设定
	SetS(2, 26, 48, 3, 21)
	SetS(2, 27, 48, 3, 22)
	SetS(2, 28, 48, 3, 23)
	SetS(2, 29, 48, 3, 24)
	instruct_3(2, 20, 0, 0, 0, 0, 10013, 0, 0, 0, 0, 0, 0)
	instruct_3(2, 21, 0, 0, 0, 0, 10013, 0, 0, 0, 0, 0, 0)
	instruct_3(2, 22, 0, 0, 0, 0, 10013, 0, 0, 0, 0, 0, 0)
	instruct_3(2, 23, 0, 0, 0, 0, 10013, 0, 0, 0, 0, 0, 0)
	instruct_3(2, 24, 0, 0, 0, 0, 10013, 0, 0, 0, 0, 0, 0)
	SetS(2, 23, 36, 3, 25)
	SetS(2, 25, 36, 3, 26)
	
	SetS(49, 26, 40, 3, 20) --药王庄事件
	SetS(49, 26, 39, 3, 21)
	SetS(49, 13, 26, 3, 22)
	SetS(49, 13, 25, 3, 23)
	SetS(49, 13, 24, 3, 24)
	
	SetS(49, 15, 24, 3, 25)
	SetS(49, 15, 22, 3, 26)
	SetS(49, 14, 22, 3, 27)
	instruct_3(49, 1, 0, 0, 0, 0, 10014, 0, 0, 0, 0, 0, 0)
	
	SetS(22, 24, 48, 3, 20) --绝情谷事件
	SetS(22, 23, 48, 3, 21)
	SetS(22, 22, 48, 3, 22)
	SetS(22, 35, 26, 3, 23)
	SetS(22, 35, 24, 3, 24)
	
	--instruct_3(1,1,-2,-2,10019,10020,-2,-2,-2,-2,-2,-2,-2)
	instruct_3(1,1,-2,-2,10019,0,-2,-2,-2,-2,-2,-2,-2)
	instruct_3(3,1,-2,-2,30015,-2,-2,-2,-2,-2,-2,-2,-2)
	instruct_3(60,0,-2,-2,30015,-2,-2,-2,-2,-2,-2,-2,-2)
	instruct_3(61,3,-2,-2,30015,-2,-2,-2,-2,-2,-2,-2,-2)
	instruct_3(35,0,-2,-2,31000,-2,-2,-2,-2,-2,-2,-2,-2)
	instruct_3(40,2,-2,-2,30014,-2,-2,-2,-2,-2,-2,-2,-2)
	
	local tmpmenu = {
		{1, 99},
		{3, 99},
		{60, 98},
		{61, 99},
	}
	local tmprand = math.random(#tmpmenu)
	SetS(tmpmenu[tmprand][1], 32, 30, 3, tmpmenu[tmprand][2])
	instruct_3(tmpmenu[tmprand][1],tmpmenu[tmprand][2],1,-2,31010,-2,-2,6266,6266,6266,-2,-2,-2)
	
	local tmpmenu = {
		{1, 26, 16, 100},
		{3, 27, 19, 100},
		{40, 22, 39, 100},
		{60, 20, 12, 100},
		{61, 32, 18, 100},		
	}
	for i = 1, #tmpmenu do
		SetS(tmpmenu[i][1], tmpmenu[i][2], tmpmenu[i][3], 3, tmpmenu[i][4])
		instruct_3(tmpmenu[i][1],tmpmenu[i][4],1,-2,30010,-2,-2,8844,8844,8844,-2,-2,-2)
	end
	
	JY.TL = 100
	
	SetS(103, 0, 0, 0, 0)
	
	--门派
	for i = 0, 63 do
		SetS(106, i, 0, 0, 0)
		SetS(106, i, 1, 0, 0)
	end	

	
	--任务/奇遇/传闻
	for i = 0, 63 do
		SetS(106, 63, i, 0, 0)
	end
	
	--[[
	--印信
	for i = 0, 63 do
		SetS(107, 63, i, 0, -2)
		SetS(107, 63, i, 1, -2)
	end]]
	
	for i = 0, 63 do --随机任务
		SetS(103, 63, i, 0, 0)
		SetS(103, 63, i, 1, 0)
	end
	
	addpoint(70, 102, 18, 29)
	addevent(70, 102, 1, 20005, 1, 5118) --, 5118, 5118) 武骧金星：这里我怀疑是BUG
	
	addpoint(104, 92, 30, 36)
	addevent(104, 92, 1, 20005, 1, 5118) --, 5118, 5118)
	
	for i = 1, #TeamP do --队友增强
		local pid = TeamP[i]		
		JY.Person[pid]["等级"] = JY.Person[pid]["等级"] - 10 --武骧金星：简化起见
		--if pid ~= 76 and pid ~= 0 then
		--	JY.Person[pid]["等级"] = JY.Person[pid]["等级"]-5	
		--end
		JY.Person[pid]["经验"] = 0
		if JY.Person[pid]["等级"] < 1 then
			JY.Person[pid]["等级"] = 1	
		end				
		local extra = (5 + math.modf((JY.Person[pid]["资质"]) / 20)) * (JY.Person[pid]["等级"] - 1)				
		local sanwei = 3 --武骧金星：固定升级成长
		while extra ~= 0 do
			--local sanwei=math.random(3)	
			if sanwei==1 then
				AddPersonAttrib(pid, "防御力", 1)
			elseif sanwei==2 then
				AddPersonAttrib(pid, "攻击力", 1)
			else
				AddPersonAttrib(pid, "轻功", 1)	  
			end	  
			extra = extra - 1
			sanwei = sanwei - 1
			if sanwei <= 0 then
				sanwei = 3
			end
		end	
		
		if JY.Person[pid]["拳掌功夫"] > 10 then
			JY.Person[pid]["拳掌功夫"] = JY.Person[pid]["拳掌功夫"] + 10			
		end
		if JY.Person[pid]["御剑能力"] > 10 then
			JY.Person[pid]["御剑能力"] = JY.Person[pid]["御剑能力"] + 10			
		end
		if JY.Person[pid]["耍刀技巧"] > 10 then
			JY.Person[pid]["耍刀技巧"] = JY.Person[pid]["耍刀技巧"] + 10	
		end
		if JY.Person[pid]["特殊兵器"] > 10 then
			JY.Person[pid]["特殊兵器"] = JY.Person[pid]["特殊兵器"] + 10
		end
		if JY.Person[pid]["暗器技巧"] > 10 then
			JY.Person[pid]["暗器技巧"] = JY.Person[pid]["暗器技巧"] + 10
		end		
	end

	local nglist = JY.nglist
	local nglist2 = JY.nglist2
	local qglist = JY.qglist
	
	local function rr(i)
		if JY.Thing[202][WZ7] > 1 then --JY.Person[i]["声望"] == 0 武骧金星：调整规则
			for j = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do			
				if JY.Person[i]["武功"..j] == 0 then
					local tmpwg = 0
					while PersonKF(i, tmpwg) do
						if math.random(10) == 1 and JY.Person[i]["声望"] > 0 then
							tmpwg = qglist[math.random(#qglist)]
						elseif math.random(30) == 1 then 
							tmpwg = nglist2[math.random(6, #nglist2)]	
						elseif math.random(20) == 1 then 
							tmpwg = nglist2[math.random(1, 5)]		
						else
							tmpwg = nglist[math.random(#nglist)]
						end
						if tmpwg == 121 and JY.Person[i]["性别"] ~= 1 then
							tmpwg = 119
						end						
					end
	
					if tmpwg == 105 and xiaobin(i) then							
						JY.Person[i]["性别"] = 2
					end
					JY.Person[i]["武功"..j] = tmpwg
					JY.Person[i]["武功等级"..j] = 900	

					if JY.Person[i]["声望"] == 0 and (JY.Thing[202][WZ7] >= 3 or not xiaobin(i)) then
						JY.Person[i]["声望"] = tmpwg
						if tmpwg == 106 then
							JY.Person[i]["内力性质"] = 1
						elseif tmpwg == 107 then
							JY.Person[i]["内力性质"] = 0							
						elseif tmpwg == 108 then
							JY.Person[i]["内力性质"] = 2
						end
					end
					--[[
					if math.random(30) == 1 and j ~= 10 then 
						JY.Person[i]["武功"..j + 1] = qglist[math.random(#qglist)]
						JY.Person[i]["武功等级"..j + 1] = 900
					end
					--]]
					break
				end
			end
		end
		for j = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
			if JY.Person[i]["武功"..j] > 0 then
				if JY.Person[i]["武功等级"..j] < 900 then --999 then 武骧金星：小兵的武功不会到极
					JY.Person[i]["武功等级"..j] = 900 --999
				end
				if JY.Person[i]["武功等级"..j] < 999 and (not xiaobin(i)) then
					JY.Person[i]["武功等级"..j] = 999
				end
			end
		end					
		if JY.Thing[202][WZ7] > 3 and JY.Person[i]["技能1"] == 0 and xiaobin(i) then
			JY.Person[i]["技能1"] = math.random(#CC.SK)
			if math.random(10) == 1 then
				local rjn = math.random(#CC.SK)
				if rjn ~= JY.Person[i]["技能1"] then
					JY.Person[i]["技能2"] = rjn
				end
			end
		end
		if JY.Thing[202][WZ7] >= 6 then
			local pos = 0
			for j = 1, 5 do
				if JY.Person[i]["技能"..j] == 0 then
					pos = j
					break
				end
			end
			if pos > 0 then
				if pos == 1 then
					JY.Person[i]["技能1"] = math.random(#CC.SK)
				else
					local sk = JY.Person[i]["技能1"]
					while hasTF(i, sk) do
						sk = math.random(#CC.SK)
					end
					JY.Person[i]["技能"..pos] = sk
				end
			end
		end	
		local tmprandom = JY.Person[i]["资质"]
		AddPersonAttrib(i, "攻击力", 50)
		AddPersonAttrib(i, "防御力", 50)		
		AddPersonAttrib(i, "轻功", 50)	
		for j = 1, JY.Thing[202][WZ7] do
			AddPersonAttrib(i, "攻击力", math.random(tmprandom))
			AddPersonAttrib(i, "轻功", math.random(tmprandom))
			AddPersonAttrib(i, "防御力", math.random(tmprandom))
		end
		local ratio = limitX(JY.Thing[202][WZ7], 1, 3)
		if JY.Person[i]["生命最大值"] <= ratio * 80 then
			JY.Person[i]["生命最大值"] = ratio * 200 + math.modf((101 - tmprandom) * 5) + math.random(800)
		else
			JY.Person[i]["生命最大值"] = ratio * JY.Person[i]["生命最大值"] + math.random(100)
		end
		JY.Person[i]["生命"] = JY.Person[i]["生命最大值"]
		if JY.Person[i]["内力最大值"] <= ratio * 200 + 100 then
			JY.Person[i]["内力最大值"] = ratio * 500 + 300 + math.modf((101 - tmprandom) * 30)
		elseif JY.Person[i]["内力最大值"] < CC.PersonAttribMax["内力最大值"] * 2 then
			JY.Person[i]["内力最大值"] = JY.Person[i]["内力最大值"] + 600 * ratio 
			+ math.modf((101 - tmprandom) * 10)
		end
		if JY.Person[i]["内力最大值"] > CC.PersonAttribMax["内力最大值"] * 2 then
			JY.Person[i]["内力最大值"] = CC.PersonAttribMax["内力最大值"] * 2
		end
		JY.Person[i]["内力"] = JY.Person[i]["内力最大值"]
		if JY.Thing[202][WZ7] >= 5 then --武骧金星：难5测试
			while true do
				local randomj = math.random(JY.PersonNum - 1)
				if randomj ~= i and JY.Person[randomj]["排行"] >= 2 and JY.Person[randomj]["排行"] <= 6 and CC.NLJS[JY.Person[randomj]["姓名"]] ~= nil and #CC.NLJS[JY.Person[randomj]["姓名"]] > 1 and randomj ~= 655 and randomj ~= 656 and randomj ~= 657 then
					JY.Person[i]["无用12"] = randomj
					break
				end
			end
		end
	end

	for a = 1, JY.PersonNum - 1 do --925 武骧金星：实际上有928个人
		for z = 1, 4 do
			if JY.Person[a]["携带物品" .. z] >= 28 and JY.Person[a]["携带物品" .. z]  <= 35 then
				JY.Person[a]["携带物品" .. z] = JY.Person[a]["携带物品" .. z] - 10 --math.random(0, 13) 武骧金星：改成食物和酒
				JY.Person[a]["携带物品数量" .. z] = 1
			end
		end
		if not duiyou(a) then
			rr(a)
		end	
		for b = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
			if JY.Person[a]["武功"..b] > 0 and JY.Person[a]["武功等级"..b] == 999 and JY.Person[a]["排行"] > 2 then
				local buff = (JY.Person[a]["排行"] - 2) * 100 + 100
				if b == 1 then buff = buff + 100 end 
				JY.Person[a]["武功等级"..b] = math.modf(JY.Person[a]["武功等级"..b] * buff / 100)
			end
		end
	end

   --S(4, 5, 5, 5 主角类型1-7普通，8特殊，9畅想，10自创
   --S(4, 5, 5, 4 特殊主角类型
	
	--SYP
    local p3 = JY.Person[0][CC.s23]
    if p3 == CC.s10 then
       JY.Person[0][CC.s23] = CC.EVB108
    end
  
    --非正常状态下选择特殊人物，名字变成  CC.EVB108 = "阿弥陀佛"
    if (p3 == JY.LEQ or p3 == JY.SQ or p3 == JY.XYK) and zjtype() ~= 2 then
       JY.Person[0][CC.s23] = CC.EVB108
    end
 
    lib.FreeSur(ssid)
      
	--苍天泰坦：物品名称和说明文字换行符BUG修正
	JY.Thing[88]["名称"]="须弥山神掌"
	JY.Thing[88]["名称2"]="须弥山神掌"
	JY.Thing[89]["名称"]="七伤拳谱"
	JY.Thing[89]["名称2"]="七伤拳谱"
	JY.Thing[110]["名称2"]="五毒秘传"
	JY.Thing[178]["名称"]="大剪刀刀法"
	JY.Thing[181]["名称2"]="棋盘招式"
	JY.Thing[196]["物品说明"]="大燕传国玉玺"
	JY.Thing[197]["物品说明"]="大燕皇帝世袭图表"
	JY.Thing[212]["名称2"]="广陵散琴曲" 
	JY.Thing[58]["名称"]="软卫甲"
	JY.Thing[58]["名称2"]="软卫甲"
	JY.Thing[148]["名称"]="射雕英雄传"
	JY.Thing[148]["名称2"]="射雕英雄传"
  
    --初始化事件，暂时不知道有什么用
    SetD(2, 3, 5, 8750)
    SetD(2, 3, 6, 8750)
    SetD(2, 3, 7, 8750)
    SetS(2, 24, 31, 1, 8762)
    SetS(2, 30, 34, 1, 8768)
    SetS(2, 27, 27, 1, 8758)
    JY.Wugong[34][WZ5] = 13225
    SetS(34, 34, 34, 5, 13225)
    SetD(34, 34, 8, 13225)
    JY.Thing[201][WZ6] = 7
    SetS(34, 34, 34, 4, 7)
    SetD(34, 33, 8, 7)
    SetS(34, 0, 9, 3, 80)
    local l = math.random(20000) + 10000
    JY.Wugong[34][WZ4] = l
    SetS(34, 0, 9, 5, l)
    SetD(34, 80, 8, l)
  
    FINALWORK2()   --初始化物品数据，武功数据，人物出招动作，战役数据等
  
    --初始化设置

	SetS(60,24,26,3,80);		--在龙门客栈门口增加事件编号80   路过事件
	SetS(60,25,26,3,81);		--在龙门客栈门口增加事件编号81
	SetS(60,26,22,3,82);		--在龙门客栈增加事件编号82		--客栈里水笙
	SetS(60,27,22,3,83);		--在龙门客栈增加事件编号83		--客栈里 汪啸风
	SetS(60,25,30,3,84);		--在龙门客栈增加事件编号84			--客栈外  狄云
	SetS(60,24,32,3,85);		--在龙门客栈增加事件编号85			--客栈外 水笙
	SetS(60,25,32,3,86);		--在龙门客栈增加事件编号86			--客栈外 汪啸风
	SetS(60,25,31,3,87);		--在龙门客栈增加事件编号87			--客栈外 血刀老祖
	SetS(60,26,30,3,88);		--在龙门客栈增加事件编号88			--客栈外 水笙被捉
	
	SetS(2,29,30,3,80);			--在雪山增加事件编号80		狄云
	SetS(2,29,31,3,81);			--在雪山增加事件编号81		水笙
	

	
	instruct_3(62,0,0,0,0,0,8601,-2,-2,-2,-2,-2,-2);
	instruct_3(62,1,0,0,0,0,8601,-2,-2,-2,-2,-2,-2);
	instruct_3(62,2,0,0,0,0,8601,-2,-2,-2,-2,-2,-2);
	
  	--JY.WugongNum = JY.WugongNum +2
    --JY.ThingNum = JY.ThingNum+2
  
     --队友挑战
	for i=1, #TeamP do
			SetS(86, 16, i, 5, 2);
			SetS(86, 17, i, 5, 1);
			SetS(86, 18, i, 5, 1);
			SetS(86, 19, i, 5, 1);
	end
end


--机率判断
function JLSD(s1, s2, dw)
	if s2 - s1 >= 100 then
		return true
	end
    if dw < 0 or dw >= JY.PersonNum then return false end
	
	if ceshi() then
		return inteam(dw)
	end --测试用
	
	local p = 0
	local s = math.random(100)
	
	if not inteam(dw) then		--敌人额外的机率
		p = p + 5;
	end
	
	if WAR.SPIRIT[dw] ~= nil and WAR.SPIRIT[dw] > 100 then
		p = p + 5
		if wglw2(dw,199) and WAR.SPIRIT[dw] > 120 then
			p = p + 5
		end
		if T9ZY(dw) and WAR.SPIRIT[dw] > 120 then
			p = p + 5
		end
	end
	if JY.Person[dw]["实战"] ~= nil and JY.Person[dw]["实战"] > 0 then
		p = p + math.modf(JY.Person[dw]["实战"]/100)
	end
	if WAR.XYLS[dw] ~= nil then
		p = p - 10
	end
	if PersonKF(dw,102) then
		p = p + 2
		if PersonGT(dw,102) then
			p = p + 5
		end
	end	
	if WAR.BXJF3 > 0 then
		if WAR.BXJF3 == 1 then
			p = p - 15
		elseif WAR.BXJF3 == 2 then
			p = p - 30
		elseif WAR.BXJF3 == 3 then
			p = p - 40
		end
		--if wglw(dw,)	
	end	
    --if inteam(dw) then return true end  --测试用	
	--[[
    if inteam(dw) then
		if s1 < s and s < s2 then
			return true	  
		else
			return false
		end
    elseif s1 - 5 < s and s < s2 + 5 then
		return true
    else
		return false
    end
	]]
	if p > 40 then p = 40 end
	return s1 - p < s and s < s2 + p
end

--SetGlobalConst 
SetGlobalConst = function()
  VK_ESCAPE = 27
  VK_Y = 121
  VK_N = 110
  VK_SPACE = 32
  VK_RETURN = 13
  SDLK_UP = 273
  SDLK_DOWN = 274
  SDLK_LEFT = 276
  SDLK_RIGHT = 275
  if CONFIG.Rotate == 0 then
    VK_UP = SDLK_UP
    VK_DOWN = SDLK_DOWN
    VK_LEFT = SDLK_LEFT
    VK_RIGHT = SDLK_RIGHT
  else
    VK_UP = SDLK_RIGHT
    VK_DOWN = SDLK_LEFT
    VK_LEFT = SDLK_UP
    VK_RIGHT = SDLK_DOWN
  end
  C_STARTMENU = RGB(182, 80, 54)
  C_RED = RGB(216, 20, 24)
  C_WHITE = RGB(236, 236, 236)
  C_ORANGE = RGB(252, 148, 16)
  C_GOLD = RGB(236, 200, 40)
  C_BLACK = RGB(0, 0, 0)
  M_Black = RGB(0, 0, 0)
  M_Sienna = RGB(160, 82, 45)
  M_DarkOliveGreen = RGB(85, 107, 47)
  M_DarkGreen = RGB(0, 100, 0)
  M_DarkSlateBlue = RGB(72, 61, 139)
  M_Navy = RGB(0, 0, 128)
  M_Indigo = RGB(75, 0, 130)
  M_DarkSlateGray = RGB(47, 79, 79)
  M_DarkRed = RGB(139, 0, 0)
  M_DarkOrange = RGB(255, 140, 0)
  M_Olive = RGB(128, 128, 0)
  M_Green = RGB(0, 128, 0)
  M_Teal = RGB(0, 128, 128)
  M_Blue = RGB(0, 0, 255)
  M_SlateGray = RGB(112, 128, 144)
  M_DimGray = RGB(105, 105, 105)
  M_Red = RGB(255, 0, 0)
  M_SandyBrown = RGB(244, 164, 96)
  M_YellowGreen = RGB(154, 205, 50)
  M_SeaGreen = RGB(46, 139, 87)
  M_MediumTurquoise = RGB(72, 209, 204)
  M_RoyalBlue = RGB(65, 105, 225)
  M_Purple = RGB(128, 0, 128)
  M_Gray = RGB(128, 128, 128)
  M_Magenta = RGB(255, 0, 255)
  M_Orange = RGB(255, 165, 0)
  M_Yellow = RGB(255, 255, 0)
  M_Lime = RGB(0, 255, 0)
  M_Cyan = RGB(0, 255, 255)
  M_DeepSkyBlue = RGB(0, 191, 255)
  M_green1 = RGB(145, 235, 45)
  M_DarkOrchid = RGB(153, 50, 204)
  M_Silver = RGB(192, 192, 192)
  M_Pink = RGB(255, 192, 203)
  M_Wheat = RGB(245, 222, 179)
  M_LemonChiffon = RGB(255, 250, 205)
  M_PaleGreen = RGB(152, 251, 152)
  M_PaleTurquoise = RGB(175, 238, 238)
  M_LightBlue = RGB(173, 216, 230)
  M_Plum = RGB(221, 160, 221)
  M_White = RGB(255, 255, 255)
  M_DIY1 = RGB(151, 106, 165)
  M_DIY2 = RGB(237, 138, 100)
  GAME_START = 0
  GAME_START2 = "1"
  GAME_FIRSTMMAP = 1
  GAME_MMAP = 2
  GAME_FIRSTSMAP = 3
  GAME_SMAP = 4
  GAME_WMAP = 5
  GAME_DEAD = 6
  GAME_END = 7
  GAME_YC = 8 --需添加
  GAME_PET = 9
  GAME_MATCH = 10
  CC = {}
  BJ = {}
  YC = {}
  CC.SrcCharSet = 0
  CC.OSCharSet = CONFIG.OSCharSet
  CC.FontName = CONFIG.FontName
  CC.ScreenW = CONFIG.Width
  CC.ScreenH = CONFIG.Height
  CC.R_IDXFilename = {CONFIG.DataPath .. "r1.idx", CONFIG.DataPath .. "r2.idx", CONFIG.DataPath .. "r3.idx", CONFIG.DataPath .. "r4.idx", CONFIG.DataPath .. "r5.idx", CONFIG.DataPath .. "r6.idx", CONFIG.DataPath .. "r7.idx", CONFIG.DataPath .. "r8.idx", CONFIG.DataPath .. "r9.idx", CONFIG.DataPath .. "r10.idx", CONFIG.DataPath .. "r_auto.idx"; [0] = CONFIG.DataPath .. "ranger.idx"}
	CC.R_GRPFilename = {CONFIG.DataPath .. "\\SAVE\\r1.grp", CONFIG.DataPath .. "\\SAVE\\r2.grp", CONFIG.DataPath .. "\\SAVE\\r3.grp", CONFIG.DataPath .. "\\SAVE\\r4.grp", CONFIG.DataPath .. "\\SAVE\\r5.grp", CONFIG.DataPath .. "\\SAVE\\r6.grp", CONFIG.DataPath .. "\\SAVE\\r7.grp", CONFIG.DataPath .. "\\SAVE\\r8.grp", CONFIG.DataPath .. "\\SAVE\\r9.grp", CONFIG.DataPath .. "\\SAVE\\r10.grp", CONFIG.DataPath .. "\\SAVE\\r_auto.grp"; [0] = CONFIG.DataPath .. "ranger.grp"}
	CC.R_PADFilename = { CONFIG.DataPath .. "\\SAVE\\\\pad1.grp", CONFIG.DataPath .. "\\SAVE\\\\pad2.grp", CONFIG.DataPath .. "\\SAVE\\\\pad3.grp", CONFIG.DataPath .. "\\SAVE\\pad4.grp", CONFIG.DataPath .. "\\SAVE\\pad5.grp", CONFIG.DataPath .. "\\SAVE\\pad6.grp", CONFIG.DataPath .. "\\SAVE\\pad7.grp", CONFIG.DataPath .. "\\SAVE\\pad8.grp", CONFIG.DataPath .. "\\SAVE\\pad9.grp", CONFIG.DataPath .. "\\SAVE\\pad10.grp", CONFIG.DataPath .. "\\SAVE\\pad_auto.grp";[0] = CONFIG.DataPath .. "padded.grp" }
	CC.R_PersonSkillFilename = { CONFIG.DataPath .. "\\SAVE\\\\p_sk1.grp", CONFIG.DataPath .. "\\SAVE\\\\p_sk2.grp", CONFIG.DataPath .. "\\SAVE\\\\p_sk3.grp", CONFIG.DataPath .. "\\SAVE\\p_sk4.grp", CONFIG.DataPath .. "\\SAVE\\p_sk5.grp", CONFIG.DataPath .. "\\SAVE\\p_sk6.grp", CONFIG.DataPath .. "\\SAVE\\p_sk7.grp", CONFIG.DataPath .. "\\SAVE\\p_sk8.grp", CONFIG.DataPath .. "\\SAVE\\p_sk9.grp", CONFIG.DataPath .. "\\SAVE\\p_sk10.grp", CONFIG.DataPath .. "\\SAVE\\p_sk_auto.grp";[0] = CONFIG.DataPath .. "p_sk.grp" }
	CC.S_Filename = {CONFIG.DataPath .. "\\SAVE\\s1.grp", CONFIG.DataPath .. "\\SAVE\\s2.grp", CONFIG.DataPath .. "\\SAVE\\s3.grp", CONFIG.DataPath .. "\\SAVE\\s4.grp", CONFIG.DataPath .. "\\SAVE\\s5.grp", CONFIG.DataPath .. "\\SAVE\\s6.grp", CONFIG.DataPath .. "\\SAVE\\s7.grp", CONFIG.DataPath .. "\\SAVE\\s8.grp", CONFIG.DataPath .. "\\SAVE\\s9.grp", CONFIG.DataPath .. "\\SAVE\\s10.grp", CONFIG.DataPath .. "\\SAVE\\s_auto.grp"; [0] = CONFIG.DataPath .. "allsin.grp"}
	CC.D_Filename = {CONFIG.DataPath .. "\\SAVE\\d1.grp", CONFIG.DataPath .. "\\SAVE\\d2.grp", CONFIG.DataPath .. "\\SAVE\\d3.grp", CONFIG.DataPath .. "\\SAVE\\d4.grp", CONFIG.DataPath .. "\\SAVE\\d5.grp", CONFIG.DataPath .. "\\SAVE\\d6.grp", CONFIG.DataPath .. "\\SAVE\\d7.grp", CONFIG.DataPath .. "\\SAVE\\d8.grp", CONFIG.DataPath .. "\\SAVE\\d9.grp", CONFIG.DataPath .. "\\SAVE\\d10.grp", CONFIG.DataPath .. "\\SAVE\\d_auto.grp"; [0] = CONFIG.DataPath .. "alldef.grp"}

  CC.TempS_Filename = CONFIG.DataPath .. "allsinbk.grp"
  CC.PaletteFile = CONFIG.DataPath .. "mmap.col"
  CC.TSAVE = CONFIG.DataPath .. "sd"
	CC.FirstFile = CONFIG.PicturePath .. "title1.png"
  CC.DeadFile = CONFIG.PicturePath .. "dead.png"
  CC.TF = CONFIG.PicturePath .. "DA.png"
  CC.STA = CONFIG.PicturePath .. "sta.png"
  CC.MMapFile = {CONFIG.DataPath .. "earth.002", CONFIG.DataPath .. "surface.002", CONFIG.DataPath .. "building.002", CONFIG.DataPath .. "buildx.002", CONFIG.DataPath .. "buildy.002"}
  CC.MMAPPicFile = {CONFIG.DataPath .. "mmap.idx", CONFIG.DataPath .. "mmap.grp"}
  CC.SMAPPicFile = {CONFIG.DataPath .. "smap.idx", CONFIG.DataPath .. "smap.grp"}
  CC.WMAPPicFile = {CONFIG.DataPath .. "wmap.idx", CONFIG.DataPath .. "wmap.grp"}
  CC.EffectFile = {CONFIG.DataPath .. "eft.idx", CONFIG.DataPath .. "eft.grp"}
  CC.FightPicFile = {CONFIG.DataPath .. "fight%03d.idx", CONFIG.DataPath .. "fight%03d.grp"}
  --CC.HeadPicFile = {CONFIG.DataPath .. "atmb.idx", CONFIG.DataPath .. "atmb.grp"}
  CC.HeadPicFile = {CONFIG.DataPath .. "shead.idx", CONFIG.DataPath .. "shead.grp"}
  CC.BigHead = {CONFIG.DataPath .. "head.idx", CONFIG.DataPath .. "head.grp"}
  CC.ThingPicFile = {CONFIG.DataPath .. "thing.idx", CONFIG.DataPath .. "thing.grp"}
  CC.HZPicFile = {CONFIG.DataPath .. "emblem.idx", CONFIG.DataPath .. "emblem.grp"}
  CC.GamePicFile = {CONFIG.DataPath .. "game.idx", CONFIG.DataPath .. "game.grp"}
  CC.YCPicFile = {CONFIG.DataPath .. "icon.idx", CONFIG.DataPath .. "icon.grp"}
  CC.SXTFDJ = {CONFIG.DataPath .. "tfdj.idx", CONFIG.DataPath .. "tfdj.grp"}
  CC.WpPic = {CONFIG.DataPath .. "wp.idx", CONFIG.DataPath .. "wp.grp"} --贴图修正
  if CONFIG.MP3 == 1 then
    CC.MIDIFile = CONFIG.SoundPath .. "game%02d.MP3"
  else
    CC.MIDIFile = CONFIG.SoundPath .. "game%02d.MID"
  end
  CC.ATKFile = CONFIG.SoundPath .. "atk%02d.wav"
  CC.ATKFileM = CONFIG.SoundPath .. "atk%02d.MP3"
  CC.EFile = CONFIG.SoundPath .. "e%02d.wav"
  CC.WarFile = CONFIG.DataPath .. "war.sta"
  CC.WarMapFile = {CONFIG.DataPath .. "warfld.idx", CONFIG.DataPath .. "warfld.grp"}
  CC.TalkIdxFile = CONFIG.ScriptPath .. "oldtalk.idx"
  CC.TalkGrpFile = CONFIG.ScriptPath .. "oldtalk.grp"
  CC.KDEFFILE = CONFIG.DataPath .. "Kdef.grp"
  CC.LUASYP = CONFIG.ScriptPath .. "SYP.lua"
  CC.LUASYP2 = CONFIG.ScriptPath .. "SYP2.lua"
  CC.D1 = CONFIG.DataPath .. "D1.grp"
  CC.KDEFSIZE = 189644
  CC.WFSIZE = -833963105
  CC.CONFIG = CONFIG.CurrentPath .. "config.lua"
  CC.RKHSK = CONFIG.ScriptPath .. "readkdef.hsk"
  CC.CYEXE = CONFIG.CurrentPath .. "苍炎.exe"
  CC.R1 = CONFIG.DataPath .. "ranger.grp"
  CC.EXITSAY = "系统崩溃"
  CC.CNMS = "菜鸟模式"
  CC.NGAME = "需要重新开始游戏"
  CC.QSQJ = "七伤拳经"
  CC.DJDP = "大剪刀谱"
  CC.TXDH = "特效动画"
  CC.TXWZ0 = "特效文字0";		--特效文字0
  CC.TXWZ1 = "特效文字1"
  CC.TXWZ2 = "特效文字2"
  CC.TXWZ3 = "特效文字3"
  CC.TXWZ4 = "特效文字4"
  CC.DHJC = "代号"
  CC.say1 = "老叫化也来凑个热闹！"
  CC.say2 = "控制这蝌蚪一样的气流在体内游走越发随心所欲了！真有趣！"
  CC.say3 = "石破天轻功上升50点"
  CC.s4 = "请选择游戏模式"
  CC.s5 = "此模式目前还未开放！"
  CC.s6 = "外号"
  CC.s7 = "武功1"
  CC.s8 = "武功"
  CC.s9 = "武功等级"
  CC.s10 = "SYP"
  CC.s11 = "我的世界我作主"
  CC.s12 = "想玩你心中的江湖那就说出它的模样百花谷恭候大驾"
  CC.s13 = "你还是重选吧，偶的能力现在被封印了，无法成长，呜呜......"
  CC.s14 = "请选择主角的天赋能力"
  CC.s15 = "拳掌功夫"
  CC.s16 = "御剑能力"
  CC.s17 = "耍刀技巧"
  CC.s18 = "特殊兵器"
  CC.s19 = "内力最大值"
  CC.s20 = "内力性质"
  CC.s21 = "品德"
  CC.s22 = "盈盈，你先退下！为父来会会你东方阿姨，哈哈哈----"
  CC.s23 = "姓名"
  CC.s24 = "天赋："
  CC.s25 = "称号："
  CC.s26 = "攻击力"
  CC.s27 = "防御力"
  CC.s28 = "轻功"
  CC.s29 = "周目奖励"
  CC.s30 = "新・苍龙半即时天赋称号版"
  CC.s31 = "辛卯0415版"
  CC.s32 = "周目"
  CC.s33 = "整理完毕"
  CC.s34 = "要换哪位队员的位置"
  CC.s35 = "主角不能换位"
  CC.s36 = "要和哪位队员替换"
  CC.s37 = "队伍"
  CC.s38 = "无法选择此角色进行游戏"
  CC.s39 = "时序"
  CC.s40 = "【炎之运手】制作组出品"
  CC.s41 = "我去大厅看看"
  CC.s42 = "妙风使！"
  CC.s43 = "流云使！"
  CC.s44 = "辉月使！圣火三绝阵！"
  CC.s45 = "风云再起"
  CC.s46 = "成员：水镜四奇  qiu001  tsmdsyp"
  CC.s47 = "（这小子来这里做什么？想找俺们陪他练功？他家里不是有两位巨侠做陪练吗！不跟他玩了）Ｐ少侠武功高强，小人不是对手！"
  CC.s48 = "（嗯，没功夫跟这小子纠缠了）Ｐ哈哈哈，小子，算你走运！老夫还有要事待办，这次就放你一马！"
  CC.s49 = "不好！有埋伏----"
  CC.s50 = "无名刀谱"
  CC.s51 = "无名刀法"
  --CC.s52 = "１嗯，Ｒ无名刀谱Ｗ９－－－－－－ＨＷ看来这是一本记载着一套绝世无双之刀法的古书！我得好好研究一下这套武功！"
  CC.s52 = "嗯，无名刀谱－－－－－－看来这是一本记载着一套绝世无双之刀法的古书！我得好好研究一下这套武功！"
  CC.s53 = "刀"
  CC.s54 = "道德:%d 银两:%d"
  CC.s55 = "游戏时间:%2d时%2d分"
  --CC.s56 = "感谢下载Ｒ炎之运手制作组Ｗ出品的ＨＧ新苍龙逐日半即时天赋称号版Ｗ！Ｈ选择重新开始可进行下一周目的游戏！"
  CC.s56 = "在此感谢无私奉献的各位前辈同好，以及电脑前面的你。选择重新开始可进行下一周目的游戏，希望你能得到新的体验。"
  --CC.s57 = "炎之英雄"
  CC.s57 = "小二"
  CC.s58 = "小小猪"
  CC.s59 = "马车传送"
  CC.s60 = "少侠想去什么地方？"
  CC.s61 = "列表选择"
  CC.s62 = "手动输入"
  CC.s63 = "抱歉，现在无法去那里！"
  CC.s64 = "车夫"
  CC.s65 = "快速行走"
  CC.s66 = "慢速行走"
  CC.s67 = "须弥山神掌"
  CC.s68 = "姓名"
  CC.s69 = "阿朱"
  CC.s70 = "阿朱 "
  CC.s71 = "是否观看序幕事件"
  CC.s72 = "在开始游戏前，有件事先说明一下：这个游戏是针对骨灰级玩家来制作的，难度甚高！不适合一般玩家！所以，如果对玩游戏没有足够的耐心和钻研精神，请选择退出游戏！"
  CC.s73 = "如果选择了继续，那么就请不要抱怨难度高！制作者是个暴脾气，不耐烦听这些废话！谢谢合作！接下来，请选择--"
  CC.s74 = "是否退出游戏"
  CC.EVB = {}
  CC.EVB[1] = "人X1"
  CC.EVB[2] = "人Y1"
  CC.EVB[3] = "人方向"
  CC.EVB[4] = "武具商"
  CC.EVB[5] = "物品"
  CC.EVB[6] = "物品数量"
  CC.EVB[7] = "名称"
  CC.EVB[8] = "确定卖出"
  CC.EVB[9] = "加攻击力"
  CC.EVB[10] = "加防御力"
  CC.EVB[11] = "想卖出哪件武具？"
  CC.EVB[12] = "加轻功"
  CC.EVB[13] = "想卖出哪本秘籍？"
  CC.EVB[14] = "秘籍商"
  CC.EVB[15] = "使用人"
  CC.EVB[16] = "需经验"
  CC.EVB[17] = "纹银一千两买药材50个！"
  CC.EVB[18] = "药材商"
  CC.EVB[19] = "要买药材吗？"
  CC.EVB[20] = "下次再说吧"
  CC.EVB[21] = "你的钱不够！"
  CC.EVB[22] = "纹银一千两买食材30个！"
  CC.EVB[23] = "食材商"
  CC.EVB[24] = "要买食材吗？"
  CC.EVB1 = "人X1"
  CC.EVB2 = "人Y1"
  CC.EVB3 = "人方向"
  CC.EVB4 = "咦，有张纸条......（小子，这是留给你的五千两银子，好好准备一下吧）哈，那老家伙还很够意思嘛！"
  CC.EVB5 = "武功等级1"
  CC.EVB6 = "苗大侠，我已经找到雪山飞狐这本书了"
  CC.EVB7 = "嗯，很好！看来你的胡家刀法也已练得炉火纯青了，以后的江湖就看你们这些年轻人的了！这本苗家剑法你拿去吧！"
  CC.EVB8 = "多谢苗大侠！"
  CC.EVB9 = "武功"
  CC.EVB10 = "武功等级"
  CC.EVB11 = "胡斐学会苗家剑法"
  CC.EVB12 = "物品"
  CC.EVB13 = "雕兄－－，真想见识一下独孤前辈的风采啊！最近总感觉到对九剑有了新的领悟，但又很模糊，不能具体总结出来！"
  CC.EVB14 = "哈哈－－－－，是时候了！"
  CC.EVB15 = "风太师叔！！！"
  CC.EVB16 = "冲儿，跟我一起唱：沧海一声笑　滔滔两岸潮　浮沉随浪只记今朝　苍天笑　纷纷世上潮　谁负谁胜出天知晓　江山笑　烟雨遥　涛浪淘尽红尘俗事知多少　清风笑竟惹寂寥　豪情还剩一襟晚照　苍生笑　不再寂寥　豪情仍在痴痴笑笑"
  CC.EVB17 = "冲儿，九剑的极意就隐藏在这首歌中，自已好好去体会吧！老夫心愿已了，从此再无牵挂，就此去也，哈哈－－－－"
  CC.EVB18 = "多谢太师叔传剑，你老人家多保重！嗯，就在这里参悟九剑的奥义吧－－－－"
  CC.EVB19 = "三日后"
  CC.EVB20 = "成了！这才是真正的独孤九剑啊！此生有幸能学到独孤前辈之神技，夫复何憾！"
  CC.EVB21 = "令狐冲领悟九剑之秘传"
  CC.EVB22 = "令狐冲称号变改"
  CC.EVB23 = "给你人头！"
  CC.EVB24 = "给你书！"
  CC.EVB25 = "你好，偶是来自未来的软体娃娃！偶的任务是让在你身体里沉睡的力量觉醒！"
  CC.EVB26 = "软体娃娃"
  CC.EVB27 = "很好，你已经具备觉醒的条件了！Ｈ偶给你看点好东西吧－－－－"
  CC.EVB28 = "是否要观看战斗影像？"
  CC.EVB29 = "携带物品1"
  CC.EVB30 = "携带物品2"
  CC.EVB31 = "携带物品3"
  CC.EVB32 = "携带物品4"
  CC.EVB33 = "最强人物模拟战斗影像－－－－Ｈ第一场：张三丰对决东方不败"
  CC.EVB34 = "最强人物模拟战斗影像－－－－Ｈ第二场：张三丰对决扫地神僧"
  CC.EVB35 = "最强人物模拟战斗影像－－－－Ｈ第三场：张三丰对决萧峰"
  CC.EVB36 = "最强人物模拟战斗影像－－－－Ｈ第四场：东方不败对决萧峰"
  CC.EVB37 = "最强人物模拟战斗影像－－－－Ｈ第五场：东方不败对决扫地神僧"
  CC.EVB38 = "最强人物模拟战斗影像－－－－Ｈ第六场：萧峰对决扫地神僧"
  CC.EVB39 = "太强了！我好像领悟到什么了.........."
  CC.EVB40 = "武功2"
  CC.EVB41 = "武功等级2"
  CC.EVB42 = "名称"
  CC.EVB43 = "六如苍龙诀"
  CC.EVB44 = "攻击力10"
  CC.EVB45 = "武功动画&音效"
  CC.EVB46 = "主角学会绝技--六如苍龙诀"
  CC.EVB47 = "主角获得称号--觉醒之苍龙"
  CC.EVB48 = "其实你的力量还可以进一步觉醒！要想得到最后的能力，就去见那个人吧！偶已经把封印之卷轴交给他了！他会指引你完成最后的试炼！"
  CC.EVB49 = "主角攻防轻能力各提升30点"
  CC.EVB50 = "很好，偶的任务完成了，再见！"
  --CC.EVB51 = "１嗯，好像还不是时候，再去江湖上闯荡一番再来吧！"
  CC.EVB51 = "嗯，可惜你的力量暂时没有办法更进一步觉醒！"
  CC.EVB52 = "你终于来了！很简单，战胜老夫，即可得到最后的力量！准备好了吗？"
  CC.EVB53 = "（......也不知道那个阮娲为什么要老夫跟这小子过两招！只听她说在她和这小子的那个空间中有很多人觉得老夫很弱！也罢，那就来玩玩吧！）"
  CC.EVB54 = "要挑战吗？"
  CC.EVB55 = "好功夫！这是阮娲留给你的卷轴，拿去吧！"
  CC.EVB56 = "呼，终于到手了！真不容易啊！武当掌门果然名不虚传！看看这卷轴的内容----"
  CC.EVB57 = "..........我懂了！！！"
  CC.EVB58 = "%s领悟隼旋击，和六如隼龙诀"
  CC.EVB59 = "姓名"
  CC.EVB60 = "名称"
  CC.EVB61 = "六如隼龙诀"
  CC.EVB62 = "攻击力10"
  CC.EVB63 = "行了，你已经领悟了！继续去完成你的使命吧！"
  CC.EVB64 = "还缺点火候，下次再来吧！"
  CC.EVB65 = "随时可以再来！老夫恭候！"
  CC.EVB66 = "是否想直接挑战十五大高手？"
  CC.EVB67 = "要直接挑战吗？"
  CC.EVB68 = "品德"
  CC.EVB69 = "恭喜你战胜了十五大，那么－－－－"
  CC.EVB70 = "没关系，再去好好准备一下吧！"
  CC.EVB71 = "那就请上擂台吧！"
  CC.EVB72 = "ＳＹＰ"
  CC.EVB73 = "一路来到这里，真是辛苦了！Ｈ偶是ＳＹＰ！大虾请休息一下，让偶来帮你放书吧！"
  CC.EVB74 = "好了，其它的书都放好了！这本天龙八部你自已去放吧，这是偶最喜欢的天书！再见了！"
  CC.EVB75 = "性别"
  CC.EVB76 = "辽国皇帝耶律洪基即将进军中原，萧大哥在尽力想法劝阻，所以无法赶来相助，这是他让我交给你的东西"
  CC.EVB77 = "我要回去帮助萧大哥了，再见！"
  CC.EVB78 = "使用人"
  CC.EVB79 = "武器"
  CC.EVB80 = "加轻功"
  CC.EVB81 = "加攻击力"
  CC.EVB82 = "战斗胜利"
  CC.EVB83 = "战斗失败"
  CC.EVB84 = "特殊奖励：千年灵芝两枚"
  CC.EVB85 = "特殊奖励：主角四系兵器值提升十点"
  CC.EVB86 = "特殊奖励：获得天王保命丹两颗"
  CC.EVB87 = "特殊奖励：获得蛤蟆功秘籍一册"
  CC.EVB88 = "特殊奖励：获得天山雪莲两枚"
  CC.EVB89 = "特殊奖励：主角拳掌功夫提升十点"
  CC.EVB90 = "特殊奖励：主角防御力和轻功各提升十点"
  CC.EVB91 = "无忌，太师父再传你一套Ｒ太极拳剑Ｗ！看好了！"
  CC.EVB92 = "华山，真是一番好景致啊！献歌一首：ＨＧ山上的山花儿开呀嘛我才到山上来　小小的一片云呀　请你停下来！ＨＷ四处转转----"
  CC.EVB93 = "嗯－－－－，头好晕！！！"
  CC.EVB94 = "哈哈哈，这西夏的Ｒ悲酥清风Ｗ果然了得！此番终于捉到这小子了！"
  CC.EVB95 = "速速将他交予那人，获取我们各自想要的东西！"
  CC.EVB96 = "动手！"
  CC.EVB97 = "自打盘古开天辟地  侠行天下是礼是义不战而胜最是理想  闯荡江湖身不由已  除暴安良一身正气　闯荡江湖无人能敌　哪怕不知去向何方　努力下去就是希望"
  CC.EVB98 = "什么人？"
  CC.EVB99 = "呵呵，问俺吗？俺的名字是 S　 Y　 P"
  CC.EVB100 = "八部神威登场"
  CC.EVB101 = "敬请期待后续情节"
  CC.EVB102 = "论剑结束"
  CC.EVB103 = "武功天下第一者："
  CC.EVB104 = "是否选用特殊人物进行游戏"
  CC.EVB105 = "要选择哪位特殊人物"
  --CC.EVB106 = "【零】颖悟绝伦&苍半无双  *【水】万般皆通&浑天水镜  "
  CC.EVB106 = "【零】颖悟绝伦&苍半无双  *【水】万般皆通&浑天水镜  *【石】相思销魂&仁义行侠  *【白】白首翩翩&鸿鹄千里    *【萧】太上忘情&神州奇侠      *【东】武学全才&逍遥小子      *【李】持酒放歌&仗剑逍遥      *【云】义贯金石&白马银枪"
  --CC.EVB107 = "Ｖｅｒ11.10.26"
  CC.EVB107 = "四叶版v1"
  CC.EVB108 = "阿弥陀佛"
  CC.EVB109 = "伪"
  CC.EVB110 = "化朽为奇"
  CC.EVB111 = "保存进度"
  CC.EVB112 = "要将当前进度保存到哪个档案中？"
  CC.EVB113 = "存档完毕"
  CC.EVB114 = "读取进度"
  CC.EVB115 = "要从哪个档案中读取进度？"
  CC.EVB116 = "读档完毕"
  CC.EVB117 = "A：攻击 D：防御 P：蓄力 I：物品 R：休息"
  CC.EVB118 = "S：存档  L：读档  Q：退出  I：物品  Z：状态"
  CC.EVB119 = "F1：传送 F2：走速 F3：队列 F4：物品 F5：全屏 F6：音乐"
  CC.EVB120 = "片尾曲：英雄梦"
  CC.EVB121 = "按任意键退出"
  CC.EVB122 = "请选择"
  CC.EVB123 = "想要哪种属性的内力"
  CC.EVB124 = "请输入角色的资质 范围0-100"
  CC.EVB125 = "输入错误 范围0-100 请重新输入"
  CC.EVB126 = {"阴性", "阳性", "调和"}
  CC.EVB127 = "想卖出什么物品？"
  CC.EVB128 = "大商家"
  CC.EVB129 = "确定要卖出"
  CC.EVB130 = "吗？"
  CC.EVB131 = "请输入卖出数量"
  CC.EVB132 = "卖出数量输入有误"
  CC.EVB133 = "还想继续卖出物品吗"
  CC.EVB134 = "本店供应食材和药材！食材一千两三十个　药材一千两五十个要买点吗？"
  CC.EVB135 = "请选择"
  CC.EVB136 = "本店商品价廉物美，客官想买点什么吗？"
  CC.EVB137 = {"食材", "药材", "不买"}
  CC.EVB138 = "先看看，下次再来！"
  CC.EVB139 = "没钱了，以后再来买吧"
  CC.EVB140 = "此物品已经有人修炼，是否换人修炼?"
  CC.EVB141 = "谁要修炼%s?"
  CC.EVB142 = "一个人只能修炼10种武功"
  CC.EVB143 = "欲练神功　挥刀自宫"
  CC.EVB144 = "这太惨了吧！先看看再说....Ｈ（翻到下一页）"
  CC.EVB145 = "若不自宫　也可练功"
  CC.EVB146 = "哈，原来不自宫也能练啊！Ｈ太棒了！！！"
  CC.EVB147 = "修炼此书必须先挥刀自宫，是否仍要修炼?"
  CC.EVB148 = "此人不适合修炼此物品"
  CC.EVB149 = "此物品有人正在使用 无法卖出"
  CC.EVB150 = "这把金蛇剑是有产权认证的，要想卖出的话请带着它的产权认证人一起来！"
  CC.EVB151 = "老板，这把剑现在已经属于这位公子了！"
  CC.EVB152 = "哦，既然袁少侠这么说了，那么小店立即收货！"
  CC.EVB153 = "常回家看看"
  CC.EVB154 = "公子，你回来啦！*在外面奔波这么久，一定很辛苦吧*现在想做什么？"
  CC.EVB155 = {"休息", "练功", "起程"}
  CC.EVB156 = "请输入主角的名字"
  CC.EVB157 = "年轻人，又见面了，看来你的能力已经完全觉醒了！以你现在的实力，可以算得上是一位绝顶高手了！"
  CC.EVB158 = "当初在这里观看四大高手比武时，是否觉得不能参予其中有点遗憾呢？"
  CC.EVB159 = "哦，是这样吗？那好吧，祝你旅程愉快，再见！"
  CC.EVB160 = "嗯，很好，年轻人就该有这样的斗志！那么，现在就来弥补这个缺憾吧！"
  CC.EVB161 = "昔日在这华山之上，曾有过数次论剑，都由当时五位绝顶高手参予，胜者将获得Ｒ武功天下第一之称号！"
  CC.EVB162 = "以当今世上高手来算，五绝当由少林的扫地僧，武当的张三丰，日月神教的东方不败，丐帮帮主乔峰和后起一辈人物之魁首－－也就是你来组成"
  CC.EVB163 = "好，新华山论剑－－－－－－－开战！！！！！！！"
  CC.EVB164 = "软体娃娃"
  CC.EVB165 = "是否觉得很遗憾呢？"
  CC.EVB166 = "人物头像更换完毕"
  CC.EVB167 = "习得『"
  CC.EVB168 = "嗯，这里还有一本秘籍！待我看看......"
  CC.EVB169 = "好像是门很厉害的武功，而且很合我修炼的路数嘛，哈哈！"
  CC.EVB170 = "此书果然在这里！......可叹华山众人暴尸荒野，还是把他们埋了吧！"
  CC.EVB171 = "休息一下"
  CC.EVB172 = "特色指令："
  CC.EVB173 = {"确定", "取消"}
  CC.EVB174 = "休迅飞凫 飘忽若神"
  CC.EVB175 = "凌波微步 罗袜生尘"
  CC.EVB176 = "未满足发动条件"
  CC.EVB177 = "催符："
  CC.EVB178 = "符掌生死 德折群雄"
  CC.EVB179 = "封穴"
  CC.EVB180 = "气补："
  CC.EVB181 = "化气补元"
  CC.EVB182 = "恢复体力50点"
  CC.EVB183 = "挪移："
  CC.EVB184 = "请选择要将"
  CC.EVB185 = "挪移到什么位置？"
  CC.EVB186 = "此处有人！请重新选择"
  CC.EVB187 = "水面，不可进入！请重新选择"
  CC.EVB188 = "九阳明尊 挪移乾坤"
  CC.EVB189 = "传功："
  CC.EVB190 = "酒神戏红尘"
  CC.EVB191 = "集气上升500"
  CC.EVB192 = "零二七的武学常识提升至100"
  CC.EVB193 = "水镜四奇的左右互搏机率提升"
  CC.EVB194 = "获得称号：真苍半无双"
  CC.EVB195 = "醉卧云端笑"
  CC.EVB196 = "恭喜你终于获得Ｒ武功天下第一的称号！凭你现在的修为，要完成你所背负的使命相信也不是什么难事了！偶会在龙之国度等待你的归来，再见......"
  CC.EVB197 = "攻轻防各提升30点 实战经验提升至极"
  CC.EVB198 = "精彩的战斗，相信你也从中获益不少吧！再见......"
  CC.EVB199 = "实战经验提升"
  CC.EVB200 = "华山论剑"
  CC.EVB201 = "易经筋加力"
  CC.EVB202 = "般若掌"
  CC.EVB203 = "达摩掌"
  CC.EVB204 = "忍法胧地斩"
  CC.EVB205 = "小子，你终于来了，在这里等你半天了！"
  CC.EVB206 = "不要我加入吗？那我走了！"
  CC.EVB207 = "霹雳刀法・天火围城"
  CC.EVB208 = "雷震九州"
  CC.EVB209 = "玄武奥义・强极十道"
  CC.EVB210 = "如来千手"
  CC.EVB211 = "大慈大悲如来天佛手"
  CC.EVB212 = "小村杂货铺"
  CC.EVB213 = "走过路过，千万不要错过，本店有特殊服务！"
  CC.WARS1 = "官兵"
  CC.WARS2 = "为国为民"
  CC.WARS3 = "侠之大者"
  CC.WARS4 = "血刀攻击吸取生命"
  CC.WARS5 = "负けいくざ　だが　オレうちなるとうしが　それをこばむ　これはぶもんのいちか　真田幸村　いざ　まいる"
  CC.WARS6 = "もはや　これまでか.........."
  CC.WARS7 = "（真田幸村－－－－，真是让人钦佩的勇士啊！！！）"
  CC.WARS8 = "（真田兄，一六一五年大阪城再会吧！Ｈ那时我的名字是......）"
  CC.WARS9 = "罗汉伏魔功恢复生命"
  CC.WARS10 = "紫霞神功恢复内力"
  CC.WARS11 = "混元功恢复体力"
  CC.WARS12 = "盲目状态恢复"
  CC.WARS13 = "铁掌"
  CC.WARS14 = "哈哈哈－－－，苗人凤，你终于死于我手了！今日方解多年之恨！"
  CC.WARS15 = "田归农攻防轻能力各提升20点 学会苗家剑法与胡家刀法"
  CC.WARS16 = "龙儿－－－－－－！啊－－－－－－－－－－－－！！！"
  CC.WARS17 = "水镜四奇云体风身蓄力完毕"
  CC.WARSHMXC = "%s发动幻梦星辰反击"
  CC.WARS18 = "%s发动离合参商反击"
  CC.WARS19 = "%s发动斗转星移反击"
  CC.WARS20 = "%s发动北斗移辰反击"
  CC.WARS21 = "（唉，这些年轻人闯荡江湖也不容易，也罢，此战就以太祖长拳来陪你们玩玩吧！）"
  CC.WARS22 = "太祖长拳"
  CC.WARS23 = "降龙三叠浪"
  CC.WARS24 = "教单于折箭 六军辟易 奋英雄怒"
  CC.WARS25 = "虽万千人吾往矣"
  CC.WARS26 = "胡汉恩仇  须倾英雄泪"
  CC.WARS27 = "日出东方  唯我不败"
  CC.WARS28 = "暴击加力"
  CC.WARS29 = "暴击"
  CC.WARS30 = "连击"
  CC.WARS31 = "・战吼"
  CC.WARS32 = "葵花神功加力"
  CC.WARS33 = "北冥神功"
  CC.WARS34 = "吸星大法"
  CC.WARS35 = "化功大法"
  CC.WARS36 = "擒龙功加力"
  CC.WARS37 = "小无相功加力"
  CC.WARS38 = "先天功加力"
  CC.WARS39 = "天罡真气・"
  CC.WARS40 = "乾坤大挪移加力"
  CC.WARS41 = "九阳神功加力"
  CC.WARS42 = "魔帝・吸星"
  CC.WARS43 = "神照经・无影神拳"
  CC.WARS44 = "胡刀苗剑 归真合一"
  CC.WARS45 = "碧海潮生曲"
  CC.WARS450 = "真传.碧海怒涛"
  CC.WARS46 = "铁尸之怨念"
  CC.WARS47 = "中平神枪"
  CC.WARS48 = "西狂之怒啸"
  CC.WARS49 = "西狂之震怒・雷霆狂啸"
  CC.WARS50 = "七弦无琴剑气"
  CC.WARS51 = "剑胆琴心 笑傲江湖"
  CC.WARS52 = "万法自然"
  CC.WARS53 = "福泽加护"
  CC.WARS54 = "葵花点穴手"
  CC.WARS55 = "七心海棠"
  CC.WARS56 = "大轮密宗・火焰刀"
  CC.WARS57 = "混元霹雳功加力"
  CC.WARS58 = "魔相・幻阴"
  CC.WARS59 = "太极拳借力打力"
  CC.WARS60 = "灵鹫宫绝学・生死符"
  CC.WARS61 = "打狗棒法绝学--天下无狗"
  CC.WARS62 = "重剑真传・浪如山涌剑如虹"
  CC.WARS63 = "暗箭・扇中钉"
  CC.WARS64 = "火凤燎原"
  CC.WARS65 = "炎枪素浅鸣・无双乱舞皆传"
  CC.WARS66 = "炎枪素浅鸣・真无双乱舞"
  CC.WARS67 = "炎枪素浅鸣・无双乱舞"
  CC.WARS68 = "二天一流秘奥义・万物一空"
  CC.WARS69 = "毗沙门天之加护"
  CC.WARS70 = "真辟邪剑法・葵花刺目"
  CC.WARS71 = "盲目状态・攻击无效"
  CC.WARS72 = "+会心之一击"
  CC.WARS73 = "会心之一击"
  CC.WARS74 = "+蓄力攻击"
  CC.WARS75 = "蓄力攻击"
  CC.WARS76 = "%s修炼%s到登峰造极"
  CC.WARS77 = "%s 升为 %d 级"
  CC.WARS78 = "云体风身反攻"
  CC.WARS79 = "+防御状态"
  CC.WARS80 = "防御状态"
  CC.WARS81 = "九阳神功护体"
  CC.WARS82 = "擒龙功护体"
  CC.WARS83 = "小无相功护体"
  CC.WARS84 = "混元霹雳功护体"
  CC.WARS85 = "先天功护体"
  CC.WARS86 = "日月・同辉"
  CC.WARS87 = "北冥真气"
  CC.WARS88 = "离合参商"
  CC.WARS89 = "斗转星移"
  CC.WARS90 = "北斗移辰"
  CC.WARS91 = "+森罗万象"
  CC.WARS92 = "森罗万象"
  CC.WARS93 = "无根无形"
  CC.WARS94 = "葵花移形"
  CC.WARS95 = "酒神秘踪步"
  CC.WARS96 = "凌波微步"
  CC.WARS97 = "葵花移形"
  CC.WARS98 = "天机身法"
  CC.WARS99 = "秘传・破掌式"
  CC.WARS100 = "秘传・破剑式"
  CC.WARS101 = "秘传・破刀式"
  CC.WARS102 = "秘传・破棍式"
  CC.WARS103 = "秘传・破气式"
  CC.WARS104 = "天罡护体"
  CC.WARS105 = "+天罡护体"
  CC.WARS106 = "反弹"
  CC.WARS107 = "・连反弹"
  CC.WARS108 = "真--逆运筋脉走火入魔"
  CC.WARS109 = "逆运筋脉走火入魔"
  CC.WARS110 = "九阳神功反震"
  CC.WARS111 = "起死回生"
  CC.WARS112 = "先天一阳 起死回生"
  CC.WARS113 = "阎王敌 重生"
  CC.WARS114 = "天地独尊"
  CC.WARS115 = "+太极奥义"
  CC.WARS116 = "太极奥义--四两拨千斤"
  CC.WARS117 = "+怒气爆发"
  CC.WARS118 = "怒气爆发"
  CC.WARS119 = "+云体风身"
  CC.WARS120 = "云体风身"
  CC.WARS121 = "防御开始"
  CC.WARS122 = "蓄力失败"
  CC.WARS123 = "蓄力成功"
  CC.WARS124 = "%s 获得经验点数 %d"
  CC.WARS125 = "%s 升级了"
  CC.WARS126 = "%s 修炼 %s 成功"
  CC.WARS127 = "%s 升为第%s级"
  CC.WARS128 = "修习会减少生命值"
  CC.WARS129 = "八门回天"
  CC.WARS130 = "・狮王之咆哮"
  CC.WARS131 = "%s 攻击+ %d 防御+ %d 轻功+ %d"
  CC.WARS132 = "%s 的 %s 熟练度提升"
  CC.WARS133 = "玄武真功恢复内力"
  CC.WARS134 = "降龙奥义・有余不尽"
  CC.WARS135 = "太极神功恢复内力"
  CC.WARS136 = "崆峒秘法恢复生命"
  CC.WARS137 = "崆峒秘法恢复内力"
  CC.WARS138 = "神足经恢复生命"
  CC.WARS139 = "神足经恢复内力"
  CC.T1 = {"零", "镜", "奇", "二", "四", "七", "水", "雨", "客", "萧"}
  CC.NUM = {"壹", "贰", "叁", "肆", "伍", "陆", "柒", "捌", "玖", "拾"}
  GZM = {"二", "三", "四", "五", "六", "七", "八", "九", "十"}
  GZMYZM = {0, 3185, 7293}
  SZB = {"一", "二", "三", "四", "五", "六", "七", "八", "九", "十", "十一", "十二", "十三", "十四", "十五", "十六", "十七", "十八", "十九", "二十"}
  LMSJ = {"少商剑", "商阳剑", "中冲剑", "关冲剑", "少冲剑", "少泽剑", "六脉齐发"}
  XL18 = {"亢龙有悔", "见龙在田", "飞龙在天", "双龙出水", "神龙摆尾", "潜龙勿用"}
  XL18JY = {"极意--亢龙・鸿渐於陆", "极意--飞龙・或跃在渊", "极意--潜龙・密雨不云", "极意--神龙・震惊百里", "极意--见龙・利涉大川", "极意--双龙・突如其来", "极意--六龙・履霜冰至", "极意--龙战・损则有孚"}
  HDZC = {"真传・云龙三现", "秘技・上步摘星刀", "秘技・鹞子翻身刀"}
  TFSSJ = {"・『天道惊雷憾』", "・『一剑镇神洲』", "・『羽葬煌炎斩』", "・『千机龙绝闪』", "・『斗焰罡霸体』", "・『侠行天下』", "・『八门聚万象』", "・『五毒秘・法用万物』", "・『血洗天河』", "・『天地随我心』", "・『一掷生死』", "・『乾坤起阵・八部天龙』", "『暗无天日・器绝十方』"}
  ZJTF = {"灵犀真拳", "剑神一笑", "傲世狂刀", "棍藏天机", "绝世天罡", "仁者无敌", "回天圣手", "欲天摩罗", "血海飘零", "凌空摘星", "盘龙九注", "指掌乾坤", "千魂弄巧"}
  ZJTF2 = {"苍半无双", "浑天水镜", "血翼军神", "相思销魂", "白首鸿鹄", "太上忘情", "万般皆通", "仗剑逍遥", "义贯金石", "万象森罗", "战神", "神枪", "蛮荒兽王", "东瀛剑魔", "风中之神", "不哭死神"} --武骧金星：增加赵云和萧笑竹
  TFE = {"拳", "剑", "刀", "特", "罡", "仁", "医"}
  KJDYSAVE = {"存档一", "存档二", "存档三", "不存档"}
  KJDYLOAD = {"存档一", "存档二", "存档三", "不读档"}
  WARSZJY = {3, 2, 5, 2, 40, 15, 5, 5, 5, 5, 5, 5, 5, 5, 3, 2, 2, 10, 5, 4, 4, 5, 4, 2, 2, 20, 40, 2, 3, 3, 3, 3, 3, 3, 5, 3, 4, 4, 8, 8, 4, 4, 4, 4, 2, 5, 3, 4, 3, 30, 4, 2, 3, 3, 4, 4, 15, 5, 5, 15, 3, 15, 3, 15, 10, 2, 8, 3, 15, 7, 8, 3, 3, 3, 4, 2, 2, 2, 2, 4, 2, 2, 2, 3, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 2, 7, 7, 4, 4, 2, 2, 12, 2, 2, 2, 3, 3, 3, 3, 3, 7, 7, 50, 3, 3, 5, 6, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 20, 3, 3, 3, 3, 3, 3, 3, 2, 3, 2, 35, 2, 2, 2, 2, 2, 2, 2, 2, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 3, 4, 3, 4, 4, 4, 2, 2, 2, 2, 2, 2, 2, 3, 7, 7, 4, 3, 5, 5, 3}
  RWWH = {}
  RWWH[50] = "狂龙天征"
  RWWH[53] = "六脉真传"
  RWWH[67] = "铁掌帮主"
  RWWH[51] = "姑苏慕容"
  RWWH[35] = "九剑传人"
  RWWH["35"] = "剑魔再临"
  RWWH[69] = "北丐"
  RWWH[27] = "唯我不败"
  RWWH[64] = "顽童武痴"
  RWWH[55] = "侠之大者"
  RWWH[58] = "西狂"
  RWWH[59] = "联心素女"
  RWWH[9] = "九阳明尊"
  RWWH[76] = "琅窒勺"
  RWWH[75] = "天池红花"
  RWWH[37] = "真名神照"
  RWWH[56] = "女诸葛"
  RWWH[60] = "西毒"
  RWWH[1] = "雪山飞狐"
  RWWH[54] = "气侠风雷"
  RWWH[2] = "毒手药仙"
  RWWH[16] = "蝶谷医仙"
  RWWH[28] = "杀人名医"
  RWWH[45] = "阎王敌"
  RWWH[6] = "月月轻松"
  RWWH[114] = "达摩再世"
  RWWH[5] = "太极宗师"
  RWWH[103] = "大轮明王"
  RWWH[48] = "冰毒怪客"
  RWWH[47] = "铁丑之主"
  RWWH[129] = "中神通"
  RWWH[57] = "桃花岛主"
  RWWH[65] = "南僧"
  RWWH[63] = "青箫落瑛"
  RWWH[78] = "铁尸魔煞"
  RWWH[73] = "日月圣姑"
  RWWH[36] = "辟邪剑客"
  RWWH[29] = "万里独行"
  RWWH[72] = "天龙掌门"
  RWWH[25] = "五毒教主"
  RWWH[83] = "铁袖拂风"
  RWWH[17] = "毒手姑婆"
  RWWH[91] = "青青子衿"
  RWWH[74] = "翠羽黄衫"
  RWWH[80] = "火手判官"
  RWWH[62] = "元蒙帝师"
  RWWH[84] = "吾乃蛮夷"
  RWWH[85] = "着手回春"
  RWWH[86] = "鸣珂锵玉"
  RWWH[87] = "倾国妖娆"  
  RWWH[66] = "波斯圣女"
  RWWH[81] = "一阳传人"
  RWWH[77] = "慧心鸳鸾"
  RWWH[88] = "酒神"
  RWWH[89] = "食神"
  RWWH[90] = "毓秀灵姝"
  RWWH[44] = "凶神恶煞"
  RWWH[52] = "中平神枪"
  RWWH[82] = "玉面孟尝"
  RWWH[92] = "悠悠我心"
  RWWH[79] = "慧中灵剑"
  RWWH[26] = "日月魔帝"
  RWWH[553] = "真田一之兵"
  RWWH["01"] = "苍半无双"
  RWWH["01b"] = "真苍半无双"
  RWWH["02"] = "浑天水镜"
  RWWH["03"] = "血翼军神"
  RWWH["04"] = "觉醒之苍龙"
  RWWH["49"] = "逍遥掌门"
  RWWH["38"] = "白首太玄"
  RWWH[171] = "武当七侠"
  RWWH[172] = "武当七侠"
  
  RWTFLB = {}
  RWTFLB[72] = "风流蕴藉" 
  RWTFLB[50] = "奋英雄怒"
  RWTFLB[49] = "福缘深厚"
  RWTFLB[35] = "灵奇洒脱"
  RWTFLB[55] = "大器晚成"
  RWTFLB[58] = "逆流勇进"
  RWTFLB[76] = "博闻强记"
  RWTFLB[75] = "孤山北望"
  RWTFLB[56] = "兰心慧质"
  RWTFLB[38] = "质朴刚健"
  RWTFLB[25] = "凤凰于飞"
  RWTFLB[84] = "巧诈凉薄"  
  RWTFLB[6] = "那个不痛"
  RWTFLB[1] = "魂系一刀"
  RWTFLB[2] = "灵柩素问"
  RWTFLB[37] = "赤心连城"
  RWTFLB[53] = "磊落仁心"
  RWTFLB[51] = "离合参商"
  RWTFLB[48] = "心无所住"
  RWTFLB[64] = "童真永留"
  RWTFLB[60] = "倒行逆施"
  RWTFLB[63] = "外和内刚"
  RWTFLB[87] = "媚眼如丝"
  RWTFLB[86] = "倾国倾城"
  RWTFLB[73] = "琴铮盈盈"
  RWTFLB[74] = "巾帼之才"
  RWTFLB[80] = "勇猛精进"
  RWTFLB[59] = "冷剑冰霜"
  RWTFLB[9] = "谁与争峰"
  RWTFLB[82] = "我为伊狂"
  RWTFLB[54] = "志垂日月"
  RWTFLB[553] = "赤胆忠魂"
  RWTFLB["01"] = "颖悟绝伦"
  RWTFLB["02"] = "万般皆通"
  RWTFLB["03"] = "慈严掌兵"
  RWTFLB[81] = "灵獒毒娇"
  RWTFLB[47] = "绛紫为邪" 
  RWTFLB[92] = "玲珑七窍" 
  RWTFLB[78] = "流萤若华" 
  RWTFLB[79] = "情深不寿" 
  RWTFLB[83] = "软红千丈"
  RWTFLB[66] = "日月昭昭"
  --水笙 称号，天赋
  RWWH[589] = "冰山侠女";
	RWTFLB[589] = "似水柔情";

	--李文秀  称号，天赋
	RWWH[590] = "白马之女";
	RWTFLB[590] = "心秀天铃";
	
	--石中玉
	RWWH[591] = "心狠手辣";
	RWTFLB[591] = "心灵感应";
	
	--冰糖恋：瓦尔拉齐 称号一指震江南
	RWWH[138] = "一指震江南";
	
	--欧阳克
	RWWH[61] = "白驼少主";
	RWTFLB[61] = "白凤灵蛇";
	
	--曲非烟
	RWWH[581] = "琴剑飘零";
	RWTFLB[581] = "似水如烟";	

	RWTFLB[594] = "十龙十象"
	RWTFLB[595] = "武中无相"
	RWTFLB[596] = "降龙伏虎"
	RWWH[594] = "元蒙帝师"
	RWWH[595] = "大轮明王"
	RWWH[596] = "神龙教主"  
	RWWH[11] = "光明左使"
	RWTFLB[11] = "狂放羁傲"
	RWWH[161] = "赤炼仙子"
	RWTFLB[161] = "情空余恨"	
	--RWWH[582] = "白马银枪"
	--RWTFLB[582] = "义贯金石"		
	--RWWH[0] = "血海飘零";
	--RWTFLB[0] = "血手仁义";
	RWWH[39] = "侠客岛主"
	RWWH[40] = "侠客岛主"
	RWTFLB[116] = "包罗万象"
	RWTFLB[117] = "不老长春"
	RWTFLB[118] = "秋水无尘"
	RWWH[19] = "华山掌门"
	RWWH[20] = "衡山掌门"
	RWWH[21] = "恒山掌门"
	RWWH[22] = "嵩山掌门"
	RWWH[23] = "泰山掌门"
	RWWH[3] = "金面佛"
	RWWH[14] = "青翼蝠王"
	RWTFLB[31] = "画痴"
	RWTFLB[32] = "书痴"
	RWTFLB[33] = "棋痴"
	RWTFLB[34] = "琴痴"
	RWWH[31] = "江南四友"
	RWWH[32] = "江南四友"
	RWWH[33] = "江南四友"
	RWWH[34] = "江南四友"
	RWWH[98] = "恶贯满盈"
	RWWH[99] = "无恶不做"
	RWWH[100] = "穷凶极恶"
	RWTFLB[19] = "岸然道貌"
	RWTFLB[20] = "潇湘夜雨"
	RWTFLB[112] = "万夫莫摧"
	RWWH[112] = "霸者横栏"	
	RWTFLB[113] = "离合无常"
	RWWH[113] = "参合庄主"
	RWTFLB[102] = "双树枯荣"	
	RWTFLB[614] = "镜心通明"
	RWWH[614] = "越女剑仙"		
	RWTFLB[4] = "雁过拨毛"   
	RWWH[4] = "宝树阎罗"
	RWTFLB[140] = "无我无剑"   
	RWWH[140] = "剑魔再临"	
	RWTFLB[592] = "无剑无招"   
	RWWH[592] = "剑魔"		
	RWTFLB[615] = "明心见性"   
	RWWH[615] = "菩提金身"		
	RWWH[46] = "星宿老仙"	
	RWWH[619] = "顽童嫡传"	
	RWTFLB[619] = "强毅厚重"
	RWWH[70] = "伏虎罗汉"	
	RWTFLB[70] = "一空到底"	
	RWTFLB[620] = "倒行逆施"
	RWWH[620] = "西毒"	
	RWWH[621] = "辽东大侠"	
	RWTFLB[621] = "刀意纵横"
	RWWH[625] = "鸳俦凤侣"	
	RWWH[626] = "昆仑三圣"	
	RWTFLB[626] = "昆仑三圣"
	RWWH[627] = "空谷幽香"	
	RWTFLB[627] = "痴情自伤"
	RWWH[628] = "香魂浩渺"	
	RWTFLB[628] = "刹那芳华"
	RWWH[629] = "瑶琨碧玉"	
	RWTFLB[629] = "楚挽沧浪"
	RWWH[630] = "金蛇郎君"	
	RWTFLB[630] = "桀骜乖张"
	RWWH[631] = "离人不归"	
	--RWTFLB[631] = "红颜如醉"	
	RWWH[632] = "菊花剑客"	
	RWTFLB[632] = "神照无影"
	RWWH[633] = "淡菊傲霜"	
	RWTFLB[633] = "情厮缘灭"
	RWWH[636] = "紫衫仙罗"	
	RWTFLB[636] = "聪慧绝伦"
	RWWH[635] = "寄水浮莲"	
	RWTFLB[635] = "霞采流虹"	
	RWWH[176] = "红药谁知"	
	RWTFLB[176] = "旧人谁怜"	
	RWWH[616] = "锦衣贵胄"	
	RWTFLB[616] = "机关算尽"	
	RWTFLB[104] = "朱颜不辞"
	RWWH[97] = "血刀老祖"
	RWTFLB[97] = "茹毛饮血"
	
	RWWH[638] = "天青孤月"	
	RWTFLB[638] = "神凝若芷"	
	RWWH[639] = "香衣夜影"	
	RWTFLB[639] = "惊才绝世"		
	
	RWWH["赵灵儿"] = "仙岛青莲"
	RWWH["林月如"] = "泪叹红颜"
	RWWH["阿奴"] = "伴月孤星"
	RWWH["郭襄"] = "烛影浮灯"
	RWWH["苗若兰"] = "兰心蕙质"
	RWWH["唐萌浅"] = "泼墨留白"
	RWTFLB["郭襄"] = "青衫缱绻"
	RWTFLB["赵灵儿"] = "仙岛青莲"
	RWTFLB["林月如"] = "泪叹红颜"
	RWTFLB["阿奴"] = "幽谷残笛"	

	RWTFLB["周芷若"] = "神凝若芷"	
	RWTFLB["赵敏"] = "香衣夜影"	
	RWTFLB["陆无双"] = "冷月星弧"		
    --新增天赋
    --新增称号	
    PSX = {"代号", "头像代号", "半身像", "生命增长", "无用", "HZ1", "HZ2", "HZ3", "HZ4", "技能1", "技能2", "技能3", "技能4", "技能5", "实战", "排行", "解锁", "USE", "YES", "挑战", "觉醒", "友好度", "性别", "等级", "经验", "生命", "生命最大值", "受伤程度", "中毒程度", "体力", "物品修炼点数", "武器", "防具", "出招动画帧数1", "出招动画帧数2", "出招动画帧数3", "出招动画帧数4", "出招动画帧数5", "出招动画延迟1", "出招动画延迟2", "出招动画延迟3", "出招动画延迟4", "出招动画延迟5", "武功音效延迟1", "武功音效延迟2", "武功音效延迟3", "武功音效延迟4", "武功音效延迟5", "内力性质", "内力", "内力最大值", "攻击力", "轻功", "防御力", "医疗能力", "用毒能力", "解毒能力", "抗毒能力", "拳掌功夫", "御剑能力", "耍刀技巧", "特殊兵器", "暗器技巧", "武学常识", "品德", "攻击带毒", "左右互搏", "声望", "资质", "修炼物品", "修炼点数", "武功1", "武功2", "武功3", "武功4", "武功5", "武功6", "武功7", "武功8", "武功9", "武功10", "武功11","武功12","武功等级1", "武功等级2", "武功等级3", "武功等级4", "武功等级5", "武功等级6", "武功等级7", "武功等级8", "武功等级9", "武功等级10", "武功等级11", "武功等级12","无用15", "携带物品1", "携带物品2", "携带物品3", "携带物品4", "携带物品数量1", "携带物品数量2", "携带物品数量3", "携带物品数量4"}
    WPSX = {"代号", "练出武功", "暗器动画编号", "使用人", "装备类型", "显示物品说明", "类型", "加生命", "加生命最大值", "加中毒解毒", "加体力", "改变内力性质", "加内力", "加内力最大值", "加攻击力", "加轻功", "加防御力", "加医疗能力", "加用毒能力", "加解毒能力", "加抗毒能力", "加拳掌功夫", "加御剑能力", "加耍刀技巧", "加特殊兵器", "加暗器技巧", "加武学常识", "加品德", "加攻击次数", "加攻击带毒", "仅修炼人物", "需内力性质", "需内力", "需攻击力", "需轻功", "需用毒能力", "需医疗能力", "需解毒能力", "需拳掌功夫", "需御剑能力", "需耍刀技巧", "需特殊兵器", "需暗器技巧", "需资质", "需经验", "练出物品需经验", "需材料", "练出物品1", "练出物品2", "练出物品3", "练出物品4", "练出物品5", "需要物品数量1", "需要物品数量2", "需要物品数量3", "需要物品数量4", "需要物品数量5", "练出武功", "使用人", "装备类型"}
    CJSX = {"代号", "跳转场景", "进入条件", "跳转口X1", "跳转口Y1", "跳转口X2", "跳转口Y2"}
    WGSX = {"攻击力1", "攻击力2", "攻击力3", "攻击力4", "攻击力5", "攻击力6", "攻击力7", "攻击力8", "攻击力9", "攻击力10", "移动范围1", "移动范围2", "移动范围3", "移动范围4", "移动范围5", "移动范围6", "移动范围7", "移动范围8", "移动范围9", "移动范围10", "杀伤范围1", "杀伤范围2", "杀伤范围3", "杀伤范围4", "杀伤范围5", "杀伤范围6", "杀伤范围7", "杀伤范围8", "杀伤范围9", "杀伤范围10", "加内力1", "加内力2", "加内力3", "加内力4", "加内力5", "加内力6", "加内力7", "加内力8", "加内力9", "加内力10", "杀内力1", "杀内力2", "杀内力3", "杀内力4", "杀内力5", "杀内力6", "杀内力7", "杀内力8", "杀内力9", "杀内力10", "代号", "武功类型", "伤害类型", "攻击范围", "消耗内力点数", "敌人中毒点数", "攻击力10", "移动范围10", "杀伤范围10", "加内力9"}
    SDSX = {"物品1", "物品2", "物品3", "物品4", "物品5", "物品数量1", "物品数量2", "物品数量3", "物品数量4", "物品数量5", "物品价格1", "物品价格2", "物品价格3", "物品价格4", "物品价格5", "物品1", "物品2", "物品3", "物品4", "物品5"}
    PSXJL = {"代号", "头像代号", "生命增长", "性别", "HZ1", "HZ2", "HZ3", "HZ4", "技能1", "技能2", "技能3", "技能4", "技能5", "实战", "解锁", "USE", "YES", "觉醒", "友好度", "等级", "生命", "生命最大值", "武器", "防具", "内力性质", "内力", "内力最大值", "攻击力", "轻功", "防御力", "医疗能力", "用毒能力", "解毒能力", "抗毒能力", "拳掌功夫", "御剑能力", "耍刀技巧", "特殊兵器", "暗器技巧", "武学常识", "品德", "攻击带毒", "左右互搏", "资质", "修炼物品", "武功1", "武功2", "武功3", "武功4", "武功5", "武功6", "武功7", "武功8", "武功9", "武功10", "携带物品1", "携带物品2", "携带物品3", "携带物品4", "携带物品数量1", "携带物品数量2", "携带物品数量3", "携带物品数量4"}
    ZYDATA = {"姓名", "无用", "HZ1", "HZ2", "HZ3", "HZ4", "技能1", "技能2", "技能3", "技能4", "技能5", "实战", "解锁", "USE", "YES", "觉醒", "友好度", "生命增长", "性别", "等级", "经验", "生命", "生命最大值", "受伤程度", "中毒程度", "体力", "物品修炼点数", "武器", "防具", "内力性质", "内力", "内力最大值", "攻击力", "轻功", "防御力", "医疗能力", "用毒能力", "解毒能力", "抗毒能力", "拳掌功夫", "御剑能力", "耍刀技巧", "特殊兵器", "暗器技巧", "武学常识", "品德", "攻击带毒", "左右互搏", "声望", "资质", "修炼物品", "修炼点数", "武功1", "武功2", "武功3", "武功4", "武功5", "武功6", "武功7", "武功8", "武功9", "武功10", "武功等级1", "武功等级2", "武功等级3", "武功等级4", "武功等级5", "武功等级6", "武功等级7", "武功等级8", "武功等级9", "武功等级10", "实战"} 
    TeamP = {0, 1, 2, 4, 9, 16, 17, 25, 28, 29, 30, 35, 36, 37, 38, 44, 
    45, 47, 48, 49, 51, 52, 53, 54, 55, 56, 58, 59, 63, 66, 72, 73, 74, 
    75, 76, 77, 78, 79, 80, 81, 82, 83, 84, 85, 86, 87, 88, 89, 90, 91, 
    92, 93, 581, 589, 590, 591, 61, 594, 595, 596, 11, 161, 582, 614, 619, 616, 620, 3, 621, 625, 626, 627,
    628, 629, 630, 631, 632, 633, 635, 636, 176, 104, 638, 639, 655, 656, 657, 661, 662, 663, 664, 929}
  
    --新队友
    TeamN = {614, 619, 616, 620, 161, 3, 621, 625, 626, 627,
    628, 629, 630, 631, 632, 633, 635, 636, 176, 104, 638, 639, 655, 656, 657, 661, 662, 663, 664, 929, 93}
    FLHSYL = {"其疾如风", "其徐如林", "侵略如火", "不动如山", "难知如阴", "动如雷震", "六如隼龙诀"}
    YYGZT = {"六如苍龙诀", "六如隼龙诀"}
    --TSXMLB = {"零二七", "水镜四奇", "萧雨客"}
    --TSXMLB = {"零二七", "水镜四奇", "王小石", "白愁飞"}
    TSXMLB = {"零", "水", "石", "白", "萧", "东", "李", "云"}
    MODEXZ = {"初次接触本作和不擅长玩游戏者", "请选择『初入江湖』模式"}
    MODEXZ2 = {"初入江湖", "千锤百炼", "凤舞九天"}
    TFXZSAY1 = " 朔雪飘飘开雁门 * 平沙历乱卷蓬根 * 功名耻计擒生数 * 直斩楼兰报国恩 "
    TFXZSAY2 = " 【灵犀真拳】 * 【剑神一笑】 * 【傲世狂刀】 * 【棍藏天机】 * 【绝世天罡】 * 【仁者无敌】 * 【回天圣手】 "
    XKXSJ = {"赵客缦胡缨 吴钩霜雪明", "十步杀一人 千里不留行", "纵死侠骨香 不惭世上英", "谁能书阁下 白首太玄经"}
    --指令显示
    GRTS = {}
    GRTS[53] = "凌波"
    GRTS[118] = "凌波"
    GRTS[49] = "催符"
    GRTS[89] = "气补"
    GRTS[9] = "挪移"
    GRTS[88] = "传功"
    GRTS[114] = "洗髓"--17-2-19
    GRTSSAY = {}
    GRTSSAY[53] = "效果：至该角色下次行动为止*      闪避机率大幅提升*条件：消耗体力10点"
    GRTSSAY[118] = "效果：至该角色下次行动为止*      闪避机率大幅提升*条件：消耗体力10点"
    GRTSSAY[49] = "效果：催动敌人身上的生死符*      使其封穴25时序*条件：消耗体力5点 内力500点"
    GRTSSAY[89] = "效果：回复指定邻接队友体力50点*条件：消耗体力25点 内力300点"
    GRTSSAY[9] = "效果：将八格范围内的我方任一队友*      挪移到指定位置*条件：消耗体力10点 内力500点"
    GRTSSAY[88] = "效果：将五格范围内我方任一队友*      当前集气提升500点*条件：消耗体力10点 内力700点"
    GRTSSAY[114] = "效果：调整自身资质      *条件：无"--17-2-19
    --霍青桐 统率，我方全体集气加200点
	GRTS[74] = "统率"
	GRTSSAY[74] = "效果：我方全体集气加200点*条件：体力大于10点 内力大于150点*消耗：消耗体力10点 内力150点"
	
	--平一指 疗伤
	GRTS[28] = "疗伤"
	GRTSSAY[28] = "效果：我方全体回复一定生命值和内伤*条件：体力大于20点 内力大于250点*消耗：体力10点 内力250点 "
	
	--李文秀 天铃
	GRTS[590] = "天铃"
	GRTSSAY[590] = "效果：所有队友回复一定状态*条件：一次战斗仅限一次*消耗：使用后自己将奄奄一息"
	
	--王难姑 施毒
	GRTS[17] = "施毒"
	GRTSSAY[17] = "效果：周围五格范围内的敌人时序中毒并*      按比例减血，持续50时序*条件：体力大于30 内力大于300*消耗：体力15点 内力300点"
	
	--胡青牛 群疗
	GRTS[16] = "群疗"
	GRTSSAY[16] = "效果：周围四格范围内的队友时序回内伤*      并按比例回复生命*条件：体力大于30 内力大于300*消耗：体力15点 内力300点"
	
	--萧中慧 慧心
	GRTS[77] = "慧心"
	GRTSSAY[77] = "效果：回复袁冠南的状态为最满*条件：生命大于500 内伤小于50*消耗：使用后自己将奄奄一息"
	
	--主角召唤独孤求败
	GRTS[664] = "石灰"
	GRTSSAY[664] = "效果：周围四格范围内不分敌我致盲*消耗：体力5点，道德1点，每致盲一个敌人会降低2点声望"
	
	--青青大暴
	GRTS[91] = "大暴"
	GRTSSAY[91] = "效果：本次攻击必连击*条件：体力大于20*消耗：体力10点"

	--慕容幻梦星辰
	GRTS[51] = "幻梦"
	GRTSSAY[51] = "效果：使用后受到3次攻击中发动*      幻梦星辰反击*消耗：体力5点、内力500点"
	
	--mm宿缘
	GRTS[92] = "宿缘"
	GRTSSAY[92] = "效果：每使用一次增强主角和自身*      的集气速度和伤害*条件：体力大于10*消耗：体力2点"	
	
	--狄云神照
	GRTS[37] = "神照"
	GRTSSAY[37] = "效果：使用后提升集气速度10*条件：内力2000以上*消耗：每时序消耗25内力"		
	
	--程英青箫
	GRTS[63] = "青箫"
	GRTSSAY[63] = "效果：恢复全员内伤35点*条件：体力20内力500以上*消耗：体力10点内力350点"		

	--引毒指令
	GRTS[2] = "引毒"
	GRTSSAY[2] = "效果：引发敌人体内毒素*条件：体力10以上*消耗：体力2点"		
	GRTS[47] = "引毒"
	GRTSSAY[47] = "效果：引发敌人体内毒素*条件：体力10以上*消耗：体力2点"	
	
	--袁承志虎乱指令
	GRTS[54] = "虎乱"
	GRTSSAY[54] = "效果：自身战意提升3点*      100时序内怒气增长速度提升50%*条件：无"	

	--胡斐飞狐指令
	GRTS[1] = "飞狐"
	GRTSSAY[1] = "效果：使用后此回合无视ZOC移动*条件：体力10以上*消耗：体力5点"	

	--石破天飒行指令
	GRTS[38] = "飒行"
	GRTSSAY[38] = "效果：当次行动攻击每击退1敌人*      集气恢复300点*条件：体力15以上*消耗：体力10点"		
	
	--欧阳克蛇笛指令
	GRTS[61] = "蛇笛"
	GRTSSAY[61] = "效果：招唤蛇王助战，每场战斗限一次*条件：体力15以上*消耗：体力10点"		
	
	--独孤求败 神雕指令
	GRTS[592] = "神雕"
	GRTSSAY[592] = "效果：招唤神雕助战，每场战斗限一次*条件：体力15以上*消耗：体力10点"		

	--殷离千蛛指令
	GRTS[631] = "千蛛"
	GRTSSAY[631] = "效果：招唤蛛王助战，每场战斗限一次*条件：体力15以上*消耗：体力10点"	

	--蓝凤凰金蟾指令
	GRTS[25] = "金蟾"
	GRTSSAY[25] = "效果：招唤蟾王助战，每场战斗限一次*条件：体力15以上*消耗：体力10点"	

	--郭靖灵雕指令
	GRTS[55] = "灵雕"
	GRTSSAY[55] = "效果：招唤白雕助战，每场战斗限一次*条件：体力15以上*消耗：体力10点"

	--阿青心猿指令
	GRTS[614] = "心猿"
	GRTSSAY[614] = "效果：招唤白猿助战，每场战斗限一次*条件：体力15以上*消耗：体力10点"	
	
	--岳老三鳄神指令
	GRTS[44] = "鼍龙"
	GRTSSAY[44] = "效果：招唤古鳄助战，每场战斗限一次*条件：体力15以上*消耗：体力10点"		
	
	--龙女御蜂指令
	GRTS[59] = "御蜂"
	GRTSSAY[59] = "效果：驱使玉蜂群攻击敌人造成200点伤害*      每场战斗限用3次*条件：体力15以上*消耗：体力10点"

	--杨过机变指令
	GRTS[58] = "机变"
	GRTSSAY[58] = "效果：可以切换使用不同的门派技能，每场战斗限一次"	
	
	--隼人森罗指令
	GRTS[583] = "森罗"
	GRTSSAY[583] = "效果：战场中使用不同战术，无限制使用次数"	

	--张召重激励指令
	GRTS[80] = "激励"
	GRTSSAY[80] = "效果：提升我方全体战意2点怒气20点*条件：体力15以上*消耗：体力10点"		
		
	--水镜灵罡指令
	GRTS[662] = "灵罡"
	GRTSSAY[662] = "效果：战场上可以随意转换内力属性，*      每回合可以转换一次*条件：无"	
	
	--郭靖灵罡指令
	GRTS[55] = "灵罡"
	GRTSSAY[55] = "效果：战场上可以随意转换内力属性，*      每回合可以转换一次*条件：无"		

	--黄蓉奇阵指令
	GRTS[56] = "奇阵"
	GRTSSAY[56] = "效果：以奇门八阵困住选定的敌方人物*      使其在下次行动时无法移动且当*      前集气速度下降*条件：消耗体力15"	

	--曲非烟清弦指令
	GRTS[581] = "清弦"
	GRTSSAY[581] = "效果：弹出琴音造成随机我方增益效果*条件：体力15内力1000以上*消耗：体力10点内力600点"		

	--任盈盈幽韵指令
	GRTS[73] = "幽韵"
	GRTSSAY[73] = "效果：弹出琴音造成随机敌方负面效果*条件：体力15内力1000以上*消耗：体力10点内力600点"		
	
	--钟灵灵貂指令
	GRTS[90] = "灵貂"
	GRTSSAY[90] = "效果：放闪电貂攻击5格内敌人使之中毒30点*      并可盗取对方所持物品一件*条件：体力10点以上*消耗：无"		
	--飞影测试：双儿背刺指令
	GRTS[663] = "刺杀"
	GRTSSAY[663] = "效果：根据站位不同出现不同刺杀效果**条件：体力50点以上*消耗：消耗体力30点"	
	
	--田归农谗言指令
	GRTS[72] = "谗言"
	GRTSSAY[72] = "效果：以犀利话术降低5格内一位敌人*      怒气值30点*条件：体力10点*消耗：体力5点"		
	
	--杨逍乾坤指令
	GRTS[11] = "乾坤"
	GRTSSAY[11] = "效果：如触发乾坤反弹则消耗伤害两倍*      的内力反弹100%的伤害*条件：体力20点内力1000点以上*消耗：体力15点"			
	
	--何铁手龙眠指令
	GRTS[83] = "龙眠"
	GRTSSAY[83] = "效果：四格范围内的敌人三回合内行动*      后集气从负数开始*条件：体力20点内力1000点以上*消耗：体力15点内力500点"			
 
	--王语嫣点破指令
	GRTS[76] = "点破"
	GRTSSAY[76] = "效果：至下次行动为止，被盯上*      的敌人攻击和杀气效果减*      百分之三十*条件：体力20点以上*消耗：体力5点"			
 
	GRTS[656] = "梦蛇"
	GRTSSAY[656] = "效果：除自身外我方全体怒气为100且*      集气+200；每场战斗限两次*条件：内力1000点怒气100点以上*消耗：内力700点怒气100点"			
	GRTS[655] = "七诀"
	GRTSSAY[655] = "效果：此次攻击变为全屏攻击*      每场战斗限三次*条件：体力15点内力1000点以上*消耗：体力10点内力500点"			
	GRTS[657] = "夺魂"
	GRTSSAY[657] = "效果：中术者50时序内持续减血*      自身50时序内持续加血*条件：体力50点以上*消耗：体力15点"			
		

  CC.TeamNum = 12 --队伍中队友人数
  CC.MyThingNum = 400
  CC.Kungfunum = 12
  CC.MyTeamNum = 54;		--队友总数量
	CC.MyShowWarInfo = (CONFIG.ShowWarInfo or 0);		--是否时刻显示主角信息
	CC.ShowWarInstruction = (CONFIG.ShowWarInstruction or 0);	--是否显示战斗说明
	
  BASEDATA = {"人X", "人Y", "人X1", "人Y1", "队伍1", "队伍2", "队伍3", "队伍4", "队伍5", "队伍6"}
  WZ = "未知"
  WZ1 = "未知1"
  WZ2 = "未知2"
  WZ3 = "未知3"
  WZ4 = "未知4"
  WZ5 = "未知5"
  WZ6 = "未知6"
  WZ7 = "未知7"
  CC.Base_S = {}
  CC.Base_S["乘船"] = {0, 0, 2}
  CC.Base_S["无用"] = {2, 0, 2}
  CC.Base_S["人X"] = {4, 0, 2}
  CC.Base_S["人Y"] = {6, 0, 2}
  CC.Base_S["人X1"] = {8, 0, 2}
  CC.Base_S["人Y1"] = {10, 0, 2}
  CC.Base_S["人方向"] = {12, 0, 2}
  CC.Base_S["船X"] = {14, 0, 2}
  CC.Base_S["船Y"] = {16, 0, 2}
  CC.Base_S["船X1"] = {18, 0, 2}
  CC.Base_S["船Y1"] = {20, 0, 2}
  CC.Base_S["船方向"] = {22, 0, 2}
  for i = 1, CC.TeamNum do --diy队友人数12
    CC.Base_S["队伍" .. i] = {24 + 2 * (i - 1), 0, 2}
  end
  for i = 1, CC.MyThingNum do
    CC.Base_S["物品" .. i] = {4 + 44 + 4 * (i - 1), 0, 2}
    CC.Base_S["物品数量" .. i] = {4 + 44 + 4 * (i - 1) + 2, 0, 2}
  end
  CC.Base_S["宠物"] = {1648, 0, 2}
  CC.Base_S["点数"] = {1650, 0, 2}
  CC.Base_S["技能点"] = {1652, 0, 2}
  CC.Base_S["周目"] = {1654, 0, 2}
  CC.Base_S["类型"] = {1656, 0, 2} --1普通2特殊3畅想4自创
  CC.Base_S["普通"] = {1658, 0, 2} --普通：1拳2剑3刀4特5罡6仁7医；特殊1零2水3石4白5萧6东7李8赵   
  CC.Base_S["特殊"] = {1660, 0, 2}
  CC.Base_S["无用3"] = {1662, 0, 2}
  CC.Base_S["无用4"] = {1664, 0, 2}
  CC.Base_S["无用5"] = {1666, 0, 2}  
  
  CC.PersonSize = 228 --nino: 扩展数据大小
  CC.Person_S = {}
  CC.Person_S["代号"] = {0, 0, 2}
  CC.Person_S["头像代号"] = {2, 0, 2}
  CC.Person_S["生命增长"] = {4, 0, 2}
  CC.Person_S["无用"] = {6, 0, 2}
  CC.Person_S["姓名"] = {8, 2, 10}
  CC.Person_S["外号"] = {18, 2, 10}
  CC.Person_S["性别"] = {28, 0, 2}
  CC.Person_S["等级"] = {30, 0, 2}
  CC.Person_S["经验"] = {32, 1, 2}
  CC.Person_S["生命"] = {34, 0, 2}
  CC.Person_S["生命最大值"] = {36, 0, 2}
  CC.Person_S["受伤程度"] = {38, 0, 2}
  CC.Person_S["中毒程度"] = {40, 0, 2}
  CC.Person_S["体力"] = {42, 0, 2}
  CC.Person_S["物品修炼点数"] = {44, 0, 2}
  CC.Person_S["武器"] = {46, 0, 2}
  CC.Person_S["防具"] = {48, 0, 2}
  for i = 1, 5 do
    CC.Person_S["出招动画帧数" .. i] = {50 + 2 * (i - 1), 0, 2}
    CC.Person_S["出招动画延迟" .. i] = {60 + 2 * (i - 1), 0, 2}
    CC.Person_S["武功音效延迟" .. i] = {70 + 2 * (i - 1), 0, 2}
  end
  CC.Person_S["内力性质"] = {80, 0, 2}
  CC.Person_S["内力"] = {82, 0, 2}
  CC.Person_S["内力最大值"] = {84, 0, 2}
  CC.Person_S["攻击力"] = {86, 0, 2}
  CC.Person_S["轻功"] = {88, 0, 2}
  CC.Person_S["防御力"] = {90, 0, 2}
  CC.Person_S["医疗能力"] = {92, 0, 2}
  CC.Person_S["用毒能力"] = {94, 0, 2}
  CC.Person_S["解毒能力"] = {96, 0, 2}
  CC.Person_S["抗毒能力"] = {98, 0, 2}
  CC.Person_S["拳掌功夫"] = {100, 0, 2}
  CC.Person_S["御剑能力"] = {102, 0, 2}
  CC.Person_S["耍刀技巧"] = {104, 0, 2}
  CC.Person_S["特殊兵器"] = {106, 0, 2}
  CC.Person_S["暗器技巧"] = {108, 0, 2}
  CC.Person_S["武学常识"] = {110, 0, 2}
  CC.Person_S["品德"] = {112, 0, 2}
  CC.Person_S["攻击带毒"] = {114, 0, 2}
  CC.Person_S["左右互搏"] = {116, 0, 2}
  CC.Person_S["声望"] = {118, 0, 2}
  CC.Person_S["资质"] = {120, 0, 2}
  CC.Person_S["修炼物品"] = {122, 0, 2}
  CC.Person_S["修炼点数"] = {124, 0, 2}
  for i = 1, 10 do
    CC.Person_S["武功" .. i] = {126 + 2 * (i - 1), 0, 2}
    CC.Person_S["武功等级" .. i] = {146 + 2 * (i - 1), 0, 2}
  end
  for i = 1, 4 do
    CC.Person_S["携带物品" .. i] = {166 + 2 * (i - 1), 0, 2}
    CC.Person_S["携带物品数量" .. i] = {174 + 2 * (i - 1), 0, 2} --nino: 扩展数据
  end
  CC.Person_S["HZ1"] = {182, 0, 2} --nino：扩展数据
  CC.Person_S["HZ2"] = {184, 0, 2}
  CC.Person_S["HZ3"] = {186, 0, 2}
  CC.Person_S["HZ4"] = {188, 0, 2}
  CC.Person_S["实战"] = {190, 0, 2}
  CC.Person_S["解锁"] = {192, 0, 2} 
  CC.Person_S["USE"] = {194, 0, 2}
  CC.Person_S["友好度"] = {196, 0, 2}
  CC.Person_S["YES"] = {198, 0, 2}
  CC.Person_S["觉醒"] = {200, 0, 2}
  CC.Person_S["排行"] = {202, 0, 2}
  CC.Person_S["挑战"] = {204, 0, 2}
  CC.Person_S["技能1"] = {206, 0, 2}
  CC.Person_S["技能2"] = {208, 0, 2}
  CC.Person_S["技能3"] = {210, 0, 2}
  CC.Person_S["技能4"] = {212, 0, 2}
  CC.Person_S["技能5"] = {214, 0, 2}
  CC.Person_S["半身像"] = {216, 0, 2}
  CC.Person_S["无用12"] = {218, 0, 2}
  CC.Person_S["无用13"] = {220, 0, 2}
  CC.Person_S["无用14"] = {222, 0, 2}
  CC.Person_S["无用15"] = {224, 0, 2}
  CC.Person_S["无用16"] = {226, 0, 2}  
  
    CC.PaddedPersonSize = help.data.Expand_getPersonPaddedDataLength()
	-- 扩展数据大小
	CC.PaddedPerson_S = { }

	CC.PaddedPerson_S["经验2"] = { 0, 5, 4 }
	local no_use_counter = 100
	for i = 1, HHH_GAME_SETTING["PADDED_NOUSE_2B_FIELD_COUNT"] do
		-- 提供60个 uint16 字段，供将来扩充用
		no_use_counter = no_use_counter + 1
		local key = "无用" ..(no_use_counter)
		CC.PaddedPerson_S[key] = { 4 + 2 *(i - 1), 0, 2 }
		-- 3个字段分别代表 在结构中的offset处、所放数据的类型（0 被视为uint16）、数据所占的字节长度

		-- help.util.debug("[CC.PaddedPerson_S]["..key.."]={"..CC.PaddedPerson_S[key][1]..", "..CC.PaddedPerson_S[key][2]..", "..CC.PaddedPerson_S[key][3].."}")
	end
	for i = 1, HHH_GAME_SETTING["PADDED_NOUSE_4B_FIELD_COUNT"] do
		-- 提供20个 int32 字段，供将来扩充用
		no_use_counter = no_use_counter + 1
		local key = "无用" ..(no_use_counter)
		CC.PaddedPerson_S[key] = { 4 + 2 * HHH_GAME_SETTING["PADDED_NOUSE_2B_FIELD_COUNT"] + 4 *(i - 1), 5, 4 }
		-- 3个字段分别代表 在结构中的offset处、所放数据的类型（5 被我视为int32）、数据所占的字节长度

		-- help.util.debug("[CC.PaddedPerson_S]["..key.."]={"..CC.PaddedPerson_S[key][1]..", "..CC.PaddedPerson_S[key][2]..", "..CC.PaddedPerson_S[key][3].."}")
	end
	for i = 10 + 1, HHH_GAME_SETTING["WG_COUNT_MAX_LIMIT"] do
		-- HHH_GAME_SETTING["WG_COUNT_MAX"] 不能超过50，应该够了
		CC.PaddedPerson_S["武功" .. i] = { 4 + 2 * HHH_GAME_SETTING["PADDED_NOUSE_2B_FIELD_COUNT"] + 4 * HHH_GAME_SETTING["PADDED_NOUSE_4B_FIELD_COUNT"] + 4 *((i - 10) -1), 0, 2 }
		-- 204开始, 每个武功占4个单位,名称和等级各2个单位, 原来每人10武功, 现在为HHH_GAME_SETTING["WG_COUNT_MAX"]个
		CC.PaddedPerson_S["武功等级" .. i] = { 4 + 2 * HHH_GAME_SETTING["PADDED_NOUSE_2B_FIELD_COUNT"] + 4 * HHH_GAME_SETTING["PADDED_NOUSE_4B_FIELD_COUNT"] + 4 *((i - 10) -1) + 2, 0, 2 }
		-- i是从11开始的，所以要减10

		local key1 = "武功" .. i
		local key2 = "武功等级" .. i
		-- help.util.debug("[CC.PaddedPerson_S][武功    " .. i.."]={"..CC.PaddedPerson_S[key1][1]..", "..CC.PaddedPerson_S[key1][2]..", "..CC.PaddedPerson_S[key1][3].."}")
		-- help.util.debug("[CC.PaddedPerson_S][武功等级" .. i.."]={"..CC.PaddedPerson_S[key2][1]..", "..CC.PaddedPerson_S[key2][2]..", "..CC.PaddedPerson_S[key2][3].."}")
	end
  
  CC.TFJL = "生命增长"
  CC.ThingSize = 200
  CC.Thing_S = {}
  CC.Thing_S["代号"] = {0, 0, 2}
  CC.Thing_S["名称"] = {2, 2, 20}
  CC.Thing_S["名称2"] = {22, 2, 20}
  CC.Thing_S["物品说明"] = {42, 2, 30}
  CC.Thing_S["练出武功"] = {72, 0, 2}
  CC.Thing_S["暗器动画编号"] = {74, 0, 2}
  CC.Thing_S["使用人"] = {76, 0, 2}
  CC.Thing_S["装备类型"] = {78, 0, 2}
  CC.Thing_S["显示物品说明"] = {80, 0, 2}
  CC.Thing_S["类型"] = {82, 0, 2}
  CC.Thing_S["未知5"] = {84, 0, 2}
  CC.Thing_S["未知6"] = {86, 0, 2}
  CC.Thing_S["未知7"] = {88, 0, 2}
  CC.Thing_S["加生命"] = {90, 0, 2}
  CC.Thing_S["加生命最大值"] = {92, 0, 2}
  CC.Thing_S["加中毒解毒"] = {94, 0, 2}
  CC.Thing_S["加体力"] = {96, 0, 2}
  CC.Thing_S["改变内力性质"] = {98, 0, 2}
  CC.Thing_S["加内力"] = {100, 0, 2}
  CC.Thing_S["加内力最大值"] = {102, 0, 2}
  CC.Thing_S["加攻击力"] = {104, 0, 2}
  CC.Thing_S["加轻功"] = {106, 0, 2}
  CC.Thing_S["加防御力"] = {108, 0, 2}
  CC.Thing_S["加医疗能力"] = {110, 0, 2}
  CC.Thing_S["加用毒能力"] = {112, 0, 2}
  CC.Thing_S["加解毒能力"] = {114, 0, 2}
  CC.Thing_S["加抗毒能力"] = {116, 0, 2}
  CC.Thing_S["加拳掌功夫"] = {118, 0, 2}
  CC.Thing_S["加御剑能力"] = {120, 0, 2}
  CC.Thing_S["加耍刀技巧"] = {122, 0, 2}
  CC.Thing_S["加特殊兵器"] = {124, 0, 2}
  CC.Thing_S["加暗器技巧"] = {126, 0, 2}
  CC.Thing_S["加武学常识"] = {128, 0, 2}
  CC.Thing_S["加品德"] = {130, 0, 2}
  CC.Thing_S["加攻击次数"] = {132, 0, 2}
  CC.Thing_S["加攻击带毒"] = {134, 0, 2}
  CC.Thing_S["仅修炼人物"] = {136, 0, 2}
  CC.Thing_S["需内力性质"] = {138, 0, 2}
  CC.Thing_S["需内力"] = {140, 0, 2}
  CC.Thing_S["需攻击力"] = {142, 0, 2}
  CC.Thing_S["需轻功"] = {144, 0, 2}
  CC.Thing_S["需用毒能力"] = {146, 0, 2}
  CC.Thing_S["需医疗能力"] = {148, 0, 2}
  CC.Thing_S["需解毒能力"] = {150, 0, 2}
  CC.Thing_S["需拳掌功夫"] = {152, 0, 2}
  CC.Thing_S["需御剑能力"] = {154, 0, 2}
  CC.Thing_S["需耍刀技巧"] = {156, 0, 2}
  CC.Thing_S["需特殊兵器"] = {158, 0, 2}
  CC.Thing_S["需暗器技巧"] = {160, 0, 2}
  CC.Thing_S["需资质"] = {162, 0, 2}
  CC.Thing_S["需经验"] = {164, 0, 2}
  CC.Thing_S["练出物品需经验"] = {166, 0, 2}
  CC.Thing_S["需材料"] = {168, 0, 2}
  for i = 1, 5 do
    CC.Thing_S["练出物品" .. i] = {170 + 2 * (i - 1), 0, 2}
    CC.Thing_S["需要物品数量" .. i] = {180 + 2 * (i - 1), 0, 2}
  end
  CC.Thing_S["价钱"] = {190, 0, 2}
  CC.Thing_S["无用2"] = {192, 0, 2}
  CC.Thing_S["无用3"] = {194, 0, 2}
  CC.Thing_S["无用4"] = {196, 0, 2}
  CC.Thing_S["无用5"] = {198, 0, 2}
  
  CC.SceneSize = 52
  CC.Scene_S = {}
  CC.Scene_S["代号"] = {0, 0, 2}
  CC.Scene_S["名称"] = {2, 2, 10}
  CC.Scene_S["出门音乐"] = {12, 0, 2}
  CC.Scene_S["进门音乐"] = {14, 0, 2}
  CC.Scene_S["跳转场景"] = {16, 0, 2}
  CC.Scene_S["进入条件"] = {18, 0, 2}
  CC.Scene_S["外景入口X1"] = {20, 0, 2}
  CC.Scene_S["外景入口Y1"] = {22, 0, 2}
  CC.Scene_S["外景入口X2"] = {24, 0, 2}
  CC.Scene_S["外景入口Y2"] = {26, 0, 2}
  CC.Scene_S["入口X"] = {28, 0, 2}
  CC.Scene_S["入口Y"] = {30, 0, 2}
  CC.Scene_S["出口X1"] = {32, 0, 2}
  CC.Scene_S["出口X2"] = {34, 0, 2}
  CC.Scene_S["出口X3"] = {36, 0, 2}
  CC.Scene_S["出口Y1"] = {38, 0, 2}
  CC.Scene_S["出口Y2"] = {40, 0, 2}
  CC.Scene_S["出口Y3"] = {42, 0, 2}
  CC.Scene_S["跳转口X1"] = {44, 0, 2}
  CC.Scene_S["跳转口Y1"] = {46, 0, 2}
  CC.Scene_S["跳转口X2"] = {48, 0, 2}
  CC.Scene_S["跳转口Y2"] = {50, 0, 2}
  
  CC.WugongSize = 152
  CC.Wugong_S = {}
  CC.Wugong_S["代号"] = {0, 0, 2}
  CC.Wugong_S["名称"] = {2, 2, 10}
  CC.Wugong_S["未知1"] = {12, 0, 2}
  CC.Wugong_S["未知2"] = {14, 0, 2}
  CC.Wugong_S["未知3"] = {16, 0, 2}
  CC.Wugong_S["未知4"] = {18, 0, 2}
  CC.Wugong_S["未知5"] = {20, 0, 2}
  CC.Wugong_S["出招音效"] = {22, 0, 2}
  CC.Wugong_S["武功类型"] = {24, 0, 2}
  CC.Wugong_S["武功动画&音效"] = {26, 0, 2}
  CC.Wugong_S["伤害类型"] = {28, 0, 2}
  CC.Wugong_S["攻击范围"] = {30, 0, 2}
  CC.Wugong_S["消耗内力点数"] = {32, 0, 2}
  CC.Wugong_S["敌人中毒点数"] = {34, 0, 2}
  for i = 1, 10 do
    CC.Wugong_S["攻击力" .. i] = {36 + 2 * (i - 1), 0, 2}
    CC.Wugong_S["移动范围" .. i] = {56 + 2 * (i - 1), 0, 2}
    CC.Wugong_S["杀伤范围" .. i] = {76 + 2 * (i - 1), 0, 2}
    CC.Wugong_S["加内力" .. i] = {96 + 2 * (i - 1), 0, 2}
    CC.Wugong_S["杀内力" .. i] = {116 + 2 * (i - 1), 0, 2}
  end
  CC.Wugong_S["类型"] = {136, 0, 2}
  CC.Wugong_S["等级"] = {138, 0, 2}
  CC.Wugong_S["上限"] = {140, 0, 2}  
  CC.Wugong_S["无用3"] = {142, 0, 2}  
  CC.Wugong_S["无用4"] = {144, 0, 2}  
  CC.Wugong_S["无用5"] = {146, 0, 2}  
  CC.Wugong_S["无用6"] = {148, 0, 2}  
  CC.Wugong_S["无用7"] = {150, 0, 2}    
  
  CC.ShopSize = 30
  CC.Shop_S = {}
  for i = 1, 5 do
    CC.Shop_S["物品" .. i] = {0 + 2 * (i - 1), 0, 2}
    CC.Shop_S["物品数量" .. i] = {10 + 2 * (i - 1), 0, 2}
    CC.Shop_S["物品价格" .. i] = {20 + 2 * (i - 1), 0, 2}
  end
  CC.ShopScene = {}
  CC.ShopScene[0] = {sceneid = 1, d_shop = 16, 
d_leave = {17, 18}}
  CC.ShopScene[1] = {sceneid = 3, d_shop = 14, 
d_leave = {15, 16}}
  CC.ShopScene[2] = {sceneid = 40, d_shop = 20, 
d_leave = {21, 22}}
  CC.ShopScene[3] = {sceneid = 60, d_shop = 16, 
d_leave = {17, 18}}
  CC.ShopScene[4] = {sceneid = 61, d_shop = 9, 
d_leave = {10, 11, 12}}
  CC.MWidth = 480
  CC.MHeight = 480
  CC.SWidth = 64
  CC.SHeight = 64
  CC.DNum = 200
  CC.XScale = CONFIG.XScale
  CC.YScale = CONFIG.YScale
  CC.Frame = 50
  CC.SceneMoveFrame = CC.Frame * 2
  CC.PersonMoveFrame = CC.Frame * 2
  CC.AnimationFrame = CC.Frame * 3
  CC.WarAutoDelay = 300
  CC.DirectX = {0, 1, -1, 0}
  CC.DirectY = {-1, 0, 0, 1}
  CC.MyStartPic = 2501 --行走贴图
  CC.BoatStartPic = 3715
   CC.BoatStartPic = 2629
  CC.Level = 30
  CC.Exp = {50, 150, 300, 500, 750, 1050, 1400, 1800, 2250, 2750, 3850, 5050, 6350, 7750, 9250, 10850, 12550, 14350, 16750, 18250, 21400, 24700, 28150, 31750, 35500, 39400, 43450, 47650, 52000, 60000; [0] = 0}
  CC.MMapBoat = {}
  local tmpBoat = {
{358, 362}, 
{374, 380}, 
{458, 464}, 
{506, 610}, 
{1016, 1022}}
  for i,v in ipairs(tmpBoat) do
    for j = v[1], v[2], 2 do
      CC.MMapBoat[j] = 1
    end
  end
  CC.SceneWater = {}
  local tmpWater = {
{358, 362}, 
{374, 380}, 
{458, 464}, 
{506, 610}, 
{818, 824}, 
{838, 838}, 
{934, 936}, 
{1016, 1022}, 
{1324, 1348}}
  for i,v in ipairs(tmpWater) do
    for j = v[1], v[2], 2 do
      CC.SceneWater[j] = 1
    end
  end
  CC.WarWater = {}
  local tmpWater = {
{358, 362}, 
{374, 380}, 
{458, 464}, 
{506, 610}, 
{818, 824}, 
{838, 838}, 
{934, 936}, 
{1016, 1022}, 
{1324, 1348}}
  for i,v in ipairs(tmpWater) do
    for j = v[1], v[2], 2 do
      CC.WarWater[j] = 1
    end
  end
  CC.PersonExit = {
{1, 950}, 
{2, 952}, 
{9, 954}, 
{16, 956}, 
{17, 958}, 
{25, 960}, 
{28, 962}, 
{29, 964}, 
{35, 966}, 
{36, 968}, 
{37, 970}, 
{38, 972}, 
{44, 974}, 
{45, 976}, 
{47, 978}, 
{48, 980}, 
{49, 982}, 
{51, 984}, 
{53, 986}, 
{54, 988}, 
{58, 990}, 
{59, 992}, 
{61, 994}, 
{63, 996}, 
{76, 998}}
  CC.AllPersonExit = {
{0, 0}, 
{49, 2}, 
{4, 1}, 
{44, 0}, 
{44, 1}, 
{37, 5}, 
{30, 0}, 
{59, 0}, 
{40, 3}, 
{56, 1}, 
{1, 7}, 
{1, 8}, 
{1, 10}, 
{40, 7}, 
{40, 8}, 
{77, 0}, 
{54, 0}, 
{62, 3}, 
{62, 4}, 
{60, 2}, 
{60, 15}, 
{52, 1}, 
{61, 0}, 
{61, 8}, 
{78, 0}, 
{18, 0}, 
{18, 1}, 
{69, 0}, 
{69, 1}, 
{45, 0}, 
{52, 2}, 
{42, 6}, 
{42, 7}, 
{8, 8}, 
{7, 6}, 
{80, 1}}
  CC.BookNum = 14
  CC.BookStart = 144
  CC.MoneyID = 174
  CC.Shemale = {[78] = 1, [93] = 1, [337] = 1, [357] = 1}
 -- CC.Effect = {14, 17, 9, 13, 17, 17, 17, 18, 19, 19, 15, 13, 10, 10, 15, 21, 16, 9, 11, 8, 9, 8, 8, 7, 8, 8, 9, 12, 19, 11, 14, 12, 17, 8, 11, 10, 13, 10, 19, 14, 17, 19, 14, 21, 16, 13, 18, 14, 17, 17, 16, 7, 12, 40, 16, 9, 15, 15, 31, 38, 24, 26, 24, 20, 12, 17, 14, 14, 10, 10, 18, 31, 12, 7, 6, 7, 28, 16, 7, 16, 20, 15, 13, 15, 11, 11, 11, 20, 20, 20, 17, 17, 17, 9, 8, 8, 17, 10, 11, 8, 29, 6, 13, 31, 14, 4, 13, 13, 15; [0] = 9}
  --[[ CC.Effect={[0]=9,14,17,9,13,                    --eft.idx/grp贴图各个武功效果贴图个数
                 17,17,17,18,19,						--NND,不止第一帧有问题，中间还有个也有问题。另外从金水复制过来的，也有两帧有问题
                 19,15,13,10,10,
                 15,21,16,9,11,
                 8,9,8,8,7,
                 8,8,9,12,19,
                 11,14,12,17,8,
                 11,10,13,10,19,
                 14,17,19,14,21,
                 16,13,18,14,17,
                 17,16,7,12,40,
				 16,9,15,15,31,
				 38,24,26,24,20,
				 12,17,14,14,10,
				 10,18,31,12,7,
				 6,7,28,16,7,
				 16,20,15,13,15,
				 11,11,11,20,20,
				 20,17,17,17,9,
				 8,8,17,10,11,
				 8,29,6,13,31,
				 14,4,13,13,15,
				 12,18,11,18,10,
				 12,27,};  ]]
CC.Effect={[0]=9, 13, 17, 10, 13, 17, 17, 16, 18, 20, 21, 15, 13, 10, 10, 15, 21, 16, 13, 11, 8, 9, 8, 8, 7, 9, 13, 10, 13, 20, 12, 17, 13, 13, 13, 14, 11, 12, 11, 20, 15, 18, 20, 15, 22, 17, 13, 21, 13, 18, 18, 17, 26, 13, 36, 17, 10, 15, 16, 13, 20, 39, 25, 27, 25, 21, 12, 17, 14, 14, 10, 10, 18, 31, 24, 11, 25, 17, 8, 17, 21, 16, 14, 16, 12, 12, 12, 21, 21, 21, 18, 18, 18, 10, 8, 9, 18, 11, 21, 28, 7, 13, 32, 15, 5, 14, 14, 15, 13, 19, 12, 19, 11, 13, 28, 19, 15, 21, 23, 15, 17, 11, 15, 21, 11, 5, 17, 34, 16, 9, 9, 18, 14, 15, 16, 14, 17, 15, 12, 10,};   
CC.Effect={[0]=9, 13, 17, 9, 13, 17, 17, 17, 18, 19, 21, 15, 13, 10, 10, 15, 21, 16, 13, 11, 8, 9, 9, 7, 8, 9, 13, 10, 13, 20, 12, 17, 13, 13, 13, 14, 11, 12, 11, 20, 15, 18, 20, 15, 22, 17, 13, 21, 13, 18, 18, 17, 26, 13, 36, 17, 10, 15, 16, 13, 20, 39, 25, 27, 25, 21, 12, 17, 14, 14, 10, 10, 18, 31, 24, 11, 25, 17, 8, 17, 21, 16, 14, 16, 12, 12, 12, 21, 21, 21, 18, 18, 18, 10, 8, 9, 18, 11, 21, 28, 7, 13, 32, 15, 5, 14, 14, 15, 13, 19, 12, 19, 11, 13, 28, 19, 15, 21, 23, 15, 17, 11, 15, 21, 11, 5, 17, 34, 16, 9, 9, 18, 14, 15, 16, 14, 17, 15, 12, 10, 23, 18, 18, 22, 17, 21, 28, 28, 19, 21, 13, 14, 11, 13, 27, 11, 15, 20, 24, 14, 14, 32, 22, 16, 11, 12, 28, 9, 15,19, 11, 11, 17, 13, 16, 11, 10, 8, 11, 17, 20, 18, 20, 30, 23, 13, 14, 9,13,25,41,12,12,21,9,19,20,11,13,10,26,32,19,};  

 CC.ExtraOffense = {
{106, 57, 100}, 
{107, 49, 50}, 
{108, 49, 50}, 
{110, 54, 80}, 
{115, 63, 50}, 
{116, 67, 70}, 
{119, 68, 100}}
  CC.NewPersonName = "徐小侠"
  CC.NewGameSceneID = 70
  CC.NewGameSceneX = 19
  CC.NewGameSceneY = 20
  CC.NewGameEvent = 691
  CC.NewPersonPic = 3445
  CC.PersonAttribMax = {}
  CC.PersonAttribMax["经验"] = 60000
  CC.PersonAttribMax["物品修炼点数"] = 60000
  CC.PersonAttribMax["修炼点数"] = 60000
  CC.PersonAttribMax["生命最大值"] = 999
  CC.PersonAttribMax["受伤程度"] = 100
  CC.PersonAttribMax["中毒程度"] = 100
  CC.PersonAttribMax["内力最大值"] = 999
  CC.PersonAttribMax["体力"] = 100
  CC.PersonAttribMax["攻击力"] = 100
  CC.PersonAttribMax["防御力"] = 100
  CC.PersonAttribMax["轻功"] = 100
  CC.PersonAttribMax["医疗能力"] = 100
  CC.PersonAttribMax["用毒能力"] = 100
  CC.PersonAttribMax["解毒能力"] = 100
  CC.PersonAttribMax["抗毒能力"] = 100
  CC.PersonAttribMax["拳掌功夫"] = 100
  CC.PersonAttribMax["御剑能力"] = 100
  CC.PersonAttribMax["耍刀技巧"] = 100
  CC.PersonAttribMax["特殊兵器"] = 100
  CC.PersonAttribMax["暗器技巧"] = 100
  CC.PersonAttribMax["武学常识"] = 100
  CC.PersonAttribMax["品德"] = 100
  CC.PersonAttribMax["资质"] = 100
  CC.PersonAttribMax["攻击带毒"] = 100
  CC.WarDataSize = 186
  CC.WarData_S = {}
  CC.WarData_S["代号"] = {0, 0, 2}
  CC.WarData_S["名称"] = {2, 2, 10}
  CC.WarData_S["地图"] = {12, 0, 2}
  CC.WarData_S["经验"] = {14, 0, 2}
  CC.WarData_S["音乐"] = {16, 0, 2}
  for i = 1, 6 do
    CC.WarData_S["手动选择参战人" .. i] = {18 + (i - 1) * 2, 0, 2}
    CC.WarData_S["自动选择参战人" .. i] = {30 + (i - 1) * 2, 0, 2}
    CC.WarData_S["我方X" .. i] = {42 + (i - 1) * 2, 0, 2}
    CC.WarData_S["我方Y" .. i] = {54 + (i - 1) * 2, 0, 2}
  end
  for i = 1, 20 do
    CC.WarData_S["敌人" .. i] = {66 + (i - 1) * 2, 0, 2}
    CC.WarData_S["敌方X" .. i] = {106 + (i - 1) * 2, 0, 2}
    CC.WarData_S["敌方Y" .. i] = {146 + (i - 1) * 2, 0, 2}
  end
  CC.WarWidth = 64
  CC.WarHeight = 64
  CC.ShowXY = 0
  CC.RowPixel = 4
  CC.MenuBorderPixel = 5
  if CONFIG.Type == 0 then
    CC.DefaultFont = 16
    CC.StartMenuFontSize = 16
    CC.NewGameFontSize = 16
    CC.MainMenuX = 10
    CC.MainMenuY = 10
    CC.GameOverX = 90
    CC.GameOverY = 65
    CC.PersonStateRowPixel = 1
  else
    if CONFIG.Type == 1 then
      CC.DefaultFont = math.modf(math.min(CC.ScreenW, CC.ScreenH) / 20)
      CC.StartMenuFontSize = math.modf(math.min(CC.ScreenW, CC.ScreenH) / 15)
      CC.NewGameFontSize = math.modf(math.min(CC.ScreenW, CC.ScreenH) / 20)
      
      --固定大小
      CC.DefaultFont = 30;
      CC.StartMenuFontSize = 40;
      CC.NewGameFontSize = 30;
      CC.MainMenuX = 10
      CC.MainMenuY = 10
      CC.GameOverX = 255
      CC.GameOverY = 165
      CC.PersonStateRowPixel = 4
    end
  end
  
  
  CC.StartMenuY = CC.ScreenH - 3 * (CC.StartMenuFontSize + CC.RowPixel) - 20
  CC.NewGameY = CC.ScreenH - 4 * (CC.NewGameFontSize + CC.RowPixel) - 10
  CC.MainSubMenuX = CC.MainMenuX + 2 * CC.MenuBorderPixel + 2 * CC.DefaultFont + 5
  CC.MainSubMenuY = CC.MainMenuY
  CC.MainSubMenuX2 = CC.MainSubMenuX + 2 * CC.MenuBorderPixel + 4 * CC.DefaultFont + 5
  CC.SingleLineHeight = CC.DefaultFont + 2 * CC.MenuBorderPixel + 5
  if CONFIG.Type == 0 then
    CC.ThingFontSize = 16
    CC.ThingPicWidth = 40
    CC.ThingPicHeight = 40
    CC.MenuThingXnum = 5
    CC.MenuThingYnum = 3
    CC.ThingGapOut = 10
    CC.ThingGapIn = 5
  else
    if CONFIG.Type == 1 then
      CC.ThingFontSize = 24
      CC.ThingPicWidth = 40
      CC.ThingPicHeight = 40
      CC.MenuThingXnum = 10
      CC.MenuThingYnum = 5
      CC.ThingGapOut = 10
      CC.ThingGapIn = 10
    end
  end
  if CONFIG.Zoom == 1 then
    CC.ThingPicWidth = 80
    CC.ThingPicHeight = 80
    local n = nil
    n = math.modf(CC.ScreenW * 0.75 / 80)
    if n < CC.MenuThingXnum then
      CC.MenuThingXnum = n
    end
    n = math.modf(CC.ScreenH * 0.65 / 80)
    if n < CC.MenuThingYnum then
    	CC.MenuThingYnum = n
  	end
  end
  
  if CONFIG.Type == 0 then
    CC.SceneXMin = 12
    CC.SceneYMin = 12
    CC.SceneXMax = 45
    CC.SceneYMax = 45
  else
    if CONFIG.Type == 1 then
      CC.SceneXMin = 11
      CC.SceneYMin = 11
      CC.SceneXMax = 47
      CC.SceneYMax = 47
    end
  end
  CC.SceneFlagPic = {2749, 2846}
  if CONFIG.FastShowScreen == 0 then
    CC.ShowFlag = 1
    if CONFIG.Type == 1 then
      CC.AutoWarShowHead = 1
    else
      CC.AutoWarShowHead = 0
    end
  else
    CC.ShowFlag = 0
    CC.AutoWarShowHead = 0
  end
  CC.LoadThingPic = 1
  CC.StartThingPic = 0
  
  --加载自己文件
  dofile (CONFIG.ScriptPath .."MyConst.lua"); 
  dofile (CONFIG.ScriptPath .."nino_bj.lua");
  dofile (CONFIG.ScriptPath .."nino_yc.lua");
  dofile (CONFIG.ScriptPath .."nino_rw.lua");
  dofile (CONFIG.ScriptPath .."nino_gambling_event.lua");
end
--SetModify 

SetModify = function()
  instruct_11_old = instruct_11
  instruct_11 = instruct_11_new
  instruct_45_old = instruct_45
  instruct_45 = instruct_45_new
  instruct_46_old = instruct_46
  instruct_46 = instruct_46_new
  instruct_47_old = instruct_47
  instruct_47 = instruct_47_new
  instruct_48_old = instruct_48
  instruct_48 = instruct_48_new
  DrawBoxTitle = NewDrawBoxTitle
  JY.ThingUseFunction[182] = Show_Position
  CC.FontBIG = math.modf(math.min(CC.ScreenW, CC.ScreenH) / 12)
  CC.FontBig = math.modf(math.min(CC.ScreenW, CC.ScreenH) / 15)
  CC.Fontbig = math.modf(math.min(CC.ScreenW, CC.ScreenH) / 20)
  CC.Fontsmall = math.modf(math.min(CC.ScreenW, CC.ScreenH) / 24)
  CC.FontSmall = math.modf(math.min(CC.ScreenW, CC.ScreenH) / 30)
  CC.FontSMALL = math.modf(math.min(CC.ScreenW, CC.ScreenH) / 40)
  CC.RowPixel = math.modf(math.min(CC.ScreenW, CC.ScreenH) / 100)
  CC.SMAPPicFile = {CONFIG.DataPath .. "sdx", CONFIG.DataPath .. "smp"}
  CC.WMAPPicFile = {CONFIG.DataPath .. "wdx", CONFIG.DataPath .. "wmp"}
  CC.FightPicFile = {CONFIG.DataPath .. "\\fight\\fdx%03d", CONFIG.DataPath .. "\\fight\\fmp%03d"}
  --武功招式
CC.KfName={
{1,'黑虎偷心',300}, --罗汉拳3招
{1,'拗步拉弓',300},
{1,'单凤朝阳',300},
{2,'饭来张口',600}, --逍遥游3招
{2,'沿门托钵',600},
{2,'见人伸手',600},
{3,'五毒摧心',700},	--五毒神掌1招
{4,'锁喉',900},	--鹰爪功2招
{4,'探目',900},
{5,'寒冰封体',600},	--寒冰绵掌1招
{7,'绵绵不绝',700}, --绵掌3招
{7,'绵里藏针',700}, 
{7,'花开并蒂',700}, 
{8,'阳歌天钧',900}, --天山六阳掌3招
{8,'阳春白雪',900},
{8,'阳关三叠',900}, 
{9,'神驼西来',800},	--白驼雪山掌1招
{9,'飘雪穿云',800},
{10,'一错',800},	--百花错拳2招
{10,'再错',800},	
{11,'旋',800},	--九阴白骨爪2招
{11,'钻',800}, 
{12,'珞樱缤纷',900}, --落英神剑掌3招
{12,'雨急风狂',900},
{12,'江城飞花',900},
{13,'铁砂掌',1000},
{13,'黑砂掌',1000},
{14,'踏雪寻梅',1000},	--天山折梅手2招
{14,'天山灵鹫',1000},
{15,'妙手空空',1000}, --空明拳4招
{15,'空碗盛饭',1000},
{15,'深藏若虚',1000},
{15,'空屋住人',1000},
{16,'上步野马分鬃',1000}, --太极拳9招
{16,'提步高探马',1000},
{16,'左右玉女穿梭',1000},
{16,'如封似闭',1000},
{16,'搂膝拗步',1000},
{16,'白鹤晾翅',1000},
{16,'十字手',1000},
{16,'弯弓射虎',1000},
{16,'揽雀尾',1000},
{17,'初动玄黄',1100}, --一阳指2招
{17,'先天一气',1100},
{18,'弹指一瞬',1100},
{18,'白驹过隙',1100},	--弹指神通2招
{19,'魔幻天阴',1000},	--幻阴指1招
{20,'拿云式',1100}, --龙爪手5招
{20,'捕风式',1100},
{20,'捉影式',1100},
{20,'抚琴式',1100},
{20,'鼓瑟式',1100},	
{21,'玄冥侵体',1100},	--玄冥神掌2招
{21,'冰毒缭绕',1100},
{22,'金刚大手印',1200},	--大金刚掌1招
{23,'损心诀',1300},	--七伤拳5招
{23,'伤肺诀',1300},
{23,'摧肝肠诀',1300},
{23,'藏离诀',1300},
{23,'精失诀',1300},
{24,'色空四显',1200}, --须弥山神掌3招
{24,'无色无相',1200},
{24,'慑伏外道',1200},
{25,'拖泥带水',1400}, --销魂掌6招
{25,'倒行逆施',1400},
{25,'行尸走肉',1400},
{25,'魂不守舍',1400},
{25,'心惊肉跳',1400},
{25,'六神不安',1400},
{127,'西施捧心',600}, --美女拳法7招
{127,'天孙织绵',600},
{127,'贵妃醉酒',600},
{127,'红拂夜奔',600},
{127,'洛神凌波',600},
{127,'古墓幽居',600},
{127,'红玉击鼓',600},
{128,'断金碎石',800},	--大嵩阳掌2招
{128,'惊涛拍浪',800},
{129,'宇宙在乎手',900},	--三花聚顶掌2招
{129,'万物生乎身',900},
{130,'天地阴阳',1000},--四象掌2招
{130,'方圆动静',1000},
{132,'白虹贯日',1300},--白虹掌2招
{132,'隐若白虹',1300},
{133,'动如参商',1300},--参合指3招
{133,'参商永隔',1300},
{133,'参合斗转',1300},



{27,'平沙落雁式',300}, --松风剑术3招
{27,'鸿飞冥冥',300},
{27,'碧渊腾蛟',300},
{28,'轰雷掣电',500}, --雷震剑术3招
{28,'雷霆万钧',500},
{28,'驱雷掣电',500},
{29,'冰河倒泻',500}, --三分剑术3招
{29,'雪中奇莲',500},
{29,'冰河开冻',500}, 
{30,'万花齐放',600}, --恒山剑法3招
{30,'万卉争艳',600},
{30,'清澈梅花',600}, 
{31,'五大夫剑',700}, --泰山剑法4招
{31,'岱宗如何',700},
{31,'快活三',700},
{31,'七星落长空',700}, 
{32,'泉鸣芙蓉',700}, --衡山剑法5招
{32,'鹤翔紫盖',700},
{32,'雁回祝融',700},
{32,'石廪书声',700},
{32,'天柱云气',700}, 
{33,'叠翠浮青',800}, --嵩山剑法3招
{33,'玉进天池',800},
{33,'千古人龙',800}, 
{34,'苍松迎客',700}, --华山剑法4招
{34,'金雁横空',700},
{34,'天坤倒悬',700},
{34,'天外玉龙',700}, 
{35,'老枝横斜',500}, --雪山剑法5招
{35,'梅雪争春',500},
{35,'风沙莽莽',500}, 
{35,'明月羌笛',500}, 
{35,'暗香疏影',500}, 
{36,'杏花春雨',700}, --柔云剑法3招
{36,'满天花雨',700},
{36,'玉带围腰',700}, 
{37,'雪拥蓝桥',700}, --两仪剑法3招
{37,'木叶萧萧',700},
{37,'玉碎昆冈',700}, 
{38,'山外清音',900}, --玉萧剑法5招
{38,'金声玉振',900},
{38,'凤曲长鸣',900},
{38,'响隔楼台',900},
{38,'棹歌中流',900}, 
{39,'关河梦断',1000}, --全真剑法6招
{39,'醉里贪欢',1000},
{39,'暮云合璧',1000},
{39,'明河共影',1000},
{39,'细斟北斗',1000},
{39,'寒烟衰草',1000}, 
{40,'金蛇万道',900}, --金蛇剑法7招
{40,'金蛇狂舞',900},
{40,'金光蛇影',900},
{40,'蛇影万馈',900},
{40,'灵蛇电闪',900},
{40,'蛇困愁城',900},
{40,'金蛇化龙',900}, 
{41,'灭',1000}, --灭剑绝剑2招
{41,'绝',1000}, 
{42,'冷月窥人',1000}, --玉女剑法6招
{42,'浪迹天涯',1000},
{42,'举案齐眉',1000},
{42,'彩笔画眉',1000},
{42,'小园艺菊',1000},
{42,'皓腕玉镯',1000}, 
{44,'冲天掌苏秦背剑',1100}, --苗家剑法6招
{44,'黄龙转身吐须势',1100},
{44,'迎门腿反劈华山',1100},
{44,'洗剑怀中抱月',1100},
{44,'上步云边摘月',1100},
{44,'提撩剑白鹤舒翅',1100}, 
{45,'重剑无锋',1400}, --玄铁剑法2招
{45,'大巧不工',1400},
{46,'仙人指路',1200}, --太极剑法9招
{46,'三环套月',1200},
{46,'云麾三舞',1200}, 
{46,'犀牛望月',1300},
{46,'野马跳涧',1300},
{46,'魁星势',1300},
{46,'金针指南',1400},
{46,'摘星换斗',1400},
{46,'金针倒挂',1400},
{47,'总决式',1400}, --独孤九剑9招
{47,'破剑式',1200},
{47,'破枪式',1200},
{47,'破刀式',1200},
{47,'破鞭式',1200},
{47,'破索式',1200},
{47,'破掌式',1200},
{47,'破箭式',1200},
{47,'破气式',1600},
{131,'缠缚剑',1600},	
{131,'绝妙剑',1600},
{131,'转身剑',1600},
{131,'心妙剑',1600},	--豸苗：一刀流斩流剑
{48,'扫荡群魔',1200}, --辟邪剑法9招
{48,'紫气东来',1200},
{48,'锺馗抉目',1200}, 
{48,'花开见佛',1200},
{48,'直捣黄龙',1200}, 
{48,'指打奸邪',1200}, 
{48,'锺馗抉目',1200}, 
{48,'流星飞堕',1200},
{48,'飞燕穿柳',1200}, 
{48,'江上弄笛',1200},
{123,'杳之若日',500}, --越女剑法4招
{123,'偏如腾兔',500}, 
{123,'追形逐影',500}, 
{123,'光若仿佛',500}, 
{125,'白虹贯日',400}, --泼墨披麻剑4招
{125,'春风杨柳',400}, 
{125,'腾蛟起凤',400}, 
{125,'玉龙倒崖',400}, 
{135,'上善若水',1000}, --绕指柔剑3招
{135,'不执无争',1000}, 
{135,'忘尘至明',1000}, 
{136,'虚式分金',1000}, --达摩剑法6招
{136,'古树盘根',1000}, 
{136,'金刚伏虎',1000}, 
{136,'九品莲台',1000}, 
{136,'横江飞渡',1000}, 
{136,'起凤腾蛟',1000}, 
{137,'风掣雷行',1100}, --迅雷剑法5招
{137,'瓦缶雷鸣',1100}, 
{137,'疾风迅雷',1100}, 
{137,'密云不雨',1100}, 
{137,'雷奔云谲',1100}, 
{154,'志在凌霄',1000}, --慕容剑法2招
{154,'器堪名世',1000}, 

{50,'砍',300}, 	--柴刀十八路2招
{50,'劈',300},
{52,'鬼见愁',400}, 	--鬼头刀法1招
{53,'进步提篮',400},	--南山刀法2招
{53,'单刀破枪',400},
{54,'大青',800},	--鸳鸯刀法2招
{54,'小青',800},
{55,'狂风大作',700}, 	--狂风刀法2招
{55,'飞沙走石',700},
{56,'带醉脱靴',600},	--奇门三才刀2招
{56,'奇刀单鞭式',600}, 
{57,'放下屠刀',600},	--慈悲刀法4招
{57,'立地成佛',600},	
{57,'苦海无边',600},
{57,'回头是岸',600},
{58,'恨意绵绵',700},	--修罗刀1招
{59,'白虎跳涧',700},	--五虎断门刀2招
{59,'剪扑自如',700},
{60,'重节守义',800},	--反两仪刀法2招
{60,'万劫不复',800},
{61,'梅雪逢夏',800}, 	--金乌刀法5招
{61,'赤日炎炎',800}, 
{61,'千钧压驼',800}, 
{61,'大海沉沙',800}, 
{61,'开门揖盗',800}, 
{62,'女貌郎才珠万斛',1000}, 	--夫妻刀法8招
{62,'天教丽质为眷属',1000}, 
{62,'清风引佩下瑶台',1000}, 
{62,'明月照妆成金屋',1000}, 
{62,'刀光掩映孔雀屏',1000}, 
{62,'喜结丝萝在乔木',1000}, 
{62,'英雄无双风流婿',1000}, 
{62,'却扇洞房燃花烛',1000}, 
{63,'呕心沥血',900}, 	--血刀大法3招
{63,'批纸削腐',900},
{63,'流星经天',900}, 
{64,'金书玉清',1000},	--玄虚刀法2招
{64,'神栖事外',1000},
{65,'钻木取火',1100},	--燃木刀法2招
{65,'无名孽火',1100},
{66,'烈火燎原',1200},	--火焰刀法2招
{66,'举火烧天',1200},
{67,'穿手藏刀式',1100},	--胡家刀法2招
{67,'八方藏刀式',1100},
{138,'夜战八方',900},	--八卦刀法3招
{138,'海底捞月',900},
{138,'钻身探海',900},
{139,'六道轮回',1000},	--降魔刀法3招
{139,'普渡众生',1000},
{139,'佛法无边',1000},
{140,'阴风凉野',1100}, --阴风刀3招
{140,'阴风怒号',1100},
{140,'西风萧索',1100},
{141,'瓦釜雷鸣',1300}, --霹雳刀法5招
{141,'黄钟毁弃',1300}, 
{141,'九州风雷',1300}, 
{141,'四海云水',1300}, 
{141,'无声惊雷',1300}, 
{155,'五指擎天',400}, --五指秘刀1招
{156,'银狐弯月',400}, --陆家刀法1招
{157,'碧海流花',700}, --回风拂柳刀3招
{157,'白虹彤霞',700},
{157,'落雁平沙',700},


{68,'回马枪',500},	--杨家枪法3招
{68,'春雷震怒',500},
{68,'凤点头',500},
{70,'四夷宾服',500},	--中平枪法2招
{70,'枪平九洲',500},
{71,'大君制六合',600},	--裴将军帖2招
{71,'猛将清九垓',700},
{71,'战马若龙虎',700},
{71,'腾陵何壮哉',700},
{74,'灵蛇吐信',600},	--鹤蛇八打2招
{74,'冲天一鹤',600},
{75,'咔嚓',800},	--大剪刀2招
{75,'我剪',800},	
{77,"假刀非刀",600},    --阴阳倒乱刃3招
{77,"假剑非剑",600},
{78,"血染黄沙",800},	--黄沙万里鞭2招
{78,"飞沙万里",800},
{79,"银索缠身",900},	--银索金铃2招
{79,"锁穴金铃",900},
{80,'棒打狗头',1200},	--打狗棒法5招
{80,'反截狗臀',1200},
{80,'拨狗朝天',1200},
{80,'棒打双犬',1200},
{80,'压肩狗背',1200},
{80,'獒口夺杖',1200},
{120,'蛇磐青竹',1200}, --灵蛇杖法5招
{120,'灵蛇出洞',1200},
{120,'蛇游蟒走',1200},
{120,'灵蛇下涧',1200},
{120,'万蛇汹涌',1300},
{81,'书化丹心',1000},	--一阳指书2招
{81,'尔乃蛮夷',1000}, 
{82,'祗园精舍',1200},	--金刚伏魔圈4招
{82,'诸行无常',1200},
{82,'娑罗双树',1200}, 
{82,'幻梦一场',1200},
{83,'力战千钧',1300},	--无上大力杵3招
{83,'拔山填海',1300},
{83,'千钧压顶',1300},
{84,'武林至尊',1000},	--倚天屠龙功6招
{84,'宝刀屠龙',1000},
{84,'号令天下',1100},
{84,'莫敢不从',1100},
{84,'倚天不出',1200},
{84,'谁与争锋',1200},
{86,'天魔降伏',1300},	--伏魔杖法2招
{86,'降龙伏虎',1300},
{142,'软红十丈',600}, --软红蛛索2招
{142,'红尘四合',600},
{144,'寒阴孤地',1000}, --寒阴箭4招
{144,'寒骨玉h',1000},
{144,'寒霰聚阴',1000},
{144,'寒鸦归渡',1000},
{145,'无孔不入',900}, --云帚拂尘功3招
{145,'无所不至',900},
{145,'无所不为',900},
{146,'悲乐归土',1200},	--圣火令秘诀2招
{146,'烈焰焚躯',1200},	
{147,'金轮',1400}, --五轮大转5招
{147,'银轮',1400},
{147,'铜轮',1400},
{147,'铁轮',1400},	
{147,'铅轮',1400},	
	
{148,'连珠箭', 800},
{149,'火枪连射', 1200},	
{158,'毒铁菱', 400},
{159,'三蜈五蟆烟', 500},
{160,'腐尸毒', 500},
{161,'毒龙锥', 600},
{162,'青字九打', 700},
{163,'毒蟾砂', 700},
{164,'回龙璧', 1000},
{165,'夺命金花', 900},
{166,'蚊须针', 800},
{167,'黑血神针', 800},
{168,'玉蜂针', 800},
{169,'三笑逍遥散', 800},
{170,'冰魄银针', 800},
{171,'七绝针', 1100},
{172,'透骨针', 1100},
{173,'金蛇锥', 1100},
{174,'枣核钉', 1300},
{175,'霹雳雷火弹', 1400},
{176,'生死符', 1300},
{177,'葵花神针', 1300},
	
	
{109,'石头',1500},	--野球拳3招
{109,'剪子',1400},
{109,'布',1300},
{110,'神洲移山剑',1200},	--神山剑法3招
{110,'神洲镇山剑',1300},
{110,'神洲擎山剑',1400},
{111,'切瓜',1300},	--西瓜刀法3招
{111,'剁瓜',1400},
{111,'砍瓜',1500},
{112,'一闪',1100},	--朐铝骺3招
{112,'连一闪',1200},
{112,'真一闪',1300},
{114,'床前明月光',800},	--连城剑法4招
{114,'疑是地上霜',800},
{114,'举头望明月',800},
{114,'低头思故乡',800},

};
--队伍离队
CC.PersonExit = {
{1, 100}, 
{2, 102}, 
{4, 104}, 
{9, 106}, 
{16, 108}, 
{17, 110}, 
{25, 112}, 
{28, 114}, 
{29, 116}, 
{30, 118}, 
{35, 120}, 
{36, 122}, 
{37, 124}, 
{38, 126}, 
{44, 128}, 
{45, 130}, 
{47, 132}, 
{48, 134}, 
{49, 136}, 
{51, 138}, 
{52, 140}, 
{53, 142}, 
{54, 144}, 
{55, 146}, 
{56, 148}, 
{58, 150}, 
{59, 152}, 
{63, 154}, 
{66, 156}, 
{72, 158}, 
{73, 160}, 
{74, 162}, 
{75, 164}, 
{76, 166}, 
{77, 168}, 
{78, 170}, 
{79, 172}, 
{80, 174}, 
{81, 176}, 
{82, 178}, 
{83, 180}, 
{84, 182}, 
{85, 184}, 
{86, 186}, 
{87, 188}, 
{88, 190}, 
{89, 192}, 
{90, 194}, 
{91, 196}, 
{92, 198},
{594, 1090},
{595, 1093},
{596, 1096},
{11, 20000}, --杨逍离队事件
{161, 20003}, --李莫愁离队事件
{61, 10003},--欧阳克离队事件
{581, 10006},--曲非烟离队事件
{589, 8005},--水笙离队事件
{590, 8650},--李文秀离队事件
{591, 8305}, --石中玉离队事件
{614, 20006}, --阿青离队事件
{619, 20007}, --耶律齐离队事件
{616, 20008}, --杨康离队事件
{620, 20009}, --欧阳锋离队事件
{621, 20010}, --胡一刀离队事件
{664, 8652}, --韦小宝离队事件
{3, 20011}, --苗人凤离队事件
{93, 20012}, --唐萌浅离队事件
}
  

CC.WGJC={ --武功连击暴击加成
{1, 20, 20},	--罗汉拳
{2, 45, 0},		--逍遥游
{3, 0, 35},		--五毒神掌
{4, 35, 10},	--鹰爪功
{5, 10, 25},	--寒冰绵掌
{7, 40, 0},		--绵掌
{8, 10, 30},	--天山六阳掌
{9, 30, 30},	--白驼雪山掌
{10, 25, 25},	--百花错拳
{11, 0, 50},	--九阴白骨爪
{12, 20, 10},	--落英神剑掌
{13, 25, 0},	--铁掌
{14, 10, 30},	--天山折梅手
{15, 35, 10},	--空明拳
{16, 25, 0},	--太极拳
{17, 0, 40},	--一阳指
{18, 0, 45},	--弹指神通
{19, 15, 10},	--幻阴指
{20, 20, 20},	--龙爪手
{21, 0, 40},	--玄冥神掌
{22, 0, 30},	--大金刚掌
{23, 0, 30},	--七伤拳
{24, 0, 20},	--须弥山神掌
{25, 20, 0},	--黯然销魂掌
{26, 10, 10},	--降龙十八掌
{27, 30, 0},	--松风剑法
{28, 0, 40},	--雷震剑法
{29, 0, 20},	--三分剑术
{30, 15, 15},	--万花剑法
{31, 10, 30},	--泰山十八盘
{32, 20, 10},	--云雾十三式
{33, 10, 40},	--万岳朝宗
{34, 40, 10},	--太岳三青峰
{35, 0, 30},	--雪山剑法
{36, 30, 0},	--柔云剑术
{37, 45, 0},	--两仪剑法
{38, 30, 0},	--玉箫剑法
{39, 0, 30},	--七星剑法
{40, 40, 15},	--金蛇剑法
{41, 0, 50},	--灭剑绝剑
{42, 50, 0},	--玉女素心剑
{44, 10, 15},	--苗家剑法
{45, 0, 25},	--玄铁剑法
{46, 10, 10},	--太极剑法
{47, 30, 0},	--独孤九剑
{48, 25, 25},	--辟邪剑法
{49, 10, 10},	--六脉神剑
{50, 0, 50},	--柴刀十八路
{51, 0, 30},	--万劫刀法
{52, 10, 10},	--鬼头刀法
{53, 20, 20},	--南山刀法
{54, 50, 0},	--鸳鸯刀法
{55, 45, 0},	--狂风刀法
{56, 30, 30},	--奇门三才刀
{57, 30, 0},	--慈悲刀法
{58, 0, 40},	--修罗刀
{59, 0, 45},	--五虎断门刀
{60, 35, 0},	--反两仪刀法
{61, 0, 30},	--金乌刀法
{62, 40, 0},	--夫妻刀法
{63, 0, 35},	--血刀大法
{64, 30, 0},	--玄虚刀法
{65, 10, 10},	--燃木刀法
{66, 20, 20},	--火焰刀法
{67, 0, 40},	--胡家刀法
{68, 30, 30},	--杨家枪法
{69, 0, 40},	--毒龙鞭法
{70, 20, 20},	--中平枪法
{71, 0, 40},	--裴将军帖
{72, 10, 30},	--棋盘招式
{73, 30, 0},	--持瑶琴
{74, 35, 10},	--鹤蛇八打
{75, 0, 50},	--大剪刀
{76, 45, 0},	--海叟钓法
{77, 40, 0},	--阴阳倒乱刃
{78, 20, 30},	--黄沙万里鞭
{79, 50, 0},	--银索金铃
{80, 10, 20},	--打狗棒法
{86, 0, 35},	--伏魔杖法
{81, 10, 30},	--一阳指书
{82, 5, 35},	--金刚伏魔圈
{83, 0, 40},	--无上大力杵
{84, 15, 15},	--倚天屠龙功
{114, 30, 0},	--连城剑法
{120, 20, 20},	--灵蛇杖法
{123, 20, 5},	--越女剑法
{125, 15, 15},	--泼墨披麻剑
{126, 25, 0},	--千蛛万毒手
{127, 30, 10},	--美女拳法
{128, 5, 35},	--大嵩阳掌
{129, 15, 15},	--三花聚顶掌
{130, 25, 10},	--四象掌
{131, 50, 25},	--斩流剑
{132, 30, 20},	--白虹掌
{133, 0, 40},	--参合指
{134, 10, 10},	--神门十三剑
{135, 35, 0},	--绕指柔剑
{136, 5, 30},	--达摩剑法
{137, 25, 25},	--迅雷剑
{138, 40, 0},	--八卦刀法
{139, 0, 40},	--降魔刀法
{140, 20, 20},	--阴风刀
{141, 10, 30},	--霹雳刀法
{142, 30, 10},	--软红蛛索
{144, 25, 25},	--寒阴箭
{145, 40, 20},	--云帚拂尘功
{146, 30, 30},	--圣火令秘诀
{147, 20, 30},	--五轮大转
{148, 20, 10},	--白羽箭
{149, 15, 20},	--火枪连射
{154, 30, 30}, --慕容剑法
{155, 0, 20}, --五指秘刀
{156, 20, 10}, --陆家刀法
{157, 15, 15}, --回风拂柳刀
{158, 10, 30}, --毒铁菱
{159, 20, 10}, --三蜈五蟆烟
{160, 20, 10}, --腐尸毒
{161, 0, 30}, --毒龙锥
{162, 25, 10}, --青字九打
{163, 10, 35}, --毒蟾砂
{164, 40, 30}, --回龙璧
{165, 20, 20}, --夺命金花
{166, 30, 10}, --蚊须针
{167, 10, 30}, --黑血神针
{168, 40, 0}, --玉蜂针
{169, 20, 30}, --三笑逍遥散
{170, 30, 20}, --冰魄银针
{171, 10, 30}, --七绝针
{172, 20, 20}, --透骨针
{173, 10, 30}, --金蛇锥
{174, 0, 50}, --枣核钉
{175, 10, 40}, --霹雳雷火弹
{176, 25, 25}, --生死符
{177, 50, 0}, --葵花神针
{202, 20, 20}, --狂风迅雷功
{109, 0, 50}, --四大神技
{110, 50, 0}, 
{111, 25, 25}, 
{112, 25, 25}, 
{85,20,10}, --北冥神功
{87,10,15}, --化功大法
{88,15,10}, --吸星大法
{89, 10, 10},	--紫霞
{90, 10, 10},	--混元
{91, 40, 40},	--风林火山功
{92, 0, 40},	--狮子吼
{93, 30, 5},	--圣火
{94, 5, 5},	--神照
{95, 15, 25},	--蛤蟆
{96, 10, 30},	--罗汉
{97, 35, 0},	--乾坤
{98, 15, 15},	--小无相
{99, 15, 15},	--纯阳
{100, 20, 20},	--先天
{101, 20, 20},	--八荒
{102, 25, 25},	--太玄
{103, 0, 50},	--龙象
{104, 20, 20},	--逆运
{105, 50, 0},	--葵花
{106, 10, 40},	--九阳
{107, 40, 10},	--九阴
{108, 30, 30},	--易筋
{121, 30, 10},	--玉女
{124, 10, 20},	--寒冰
{150, 15, 15},	--金关玉锁诀
{151, 10, 25},	--金刚不坏体
{152, 25, 10},	--天南易阳决
{153, 15, 15},	--临济十二庄
{6, 30, 10},		--碧海潮生功
{178, 10, 30},		--擒龙功
{180, 25, 30},		--擒龙功
{9999, 25, 30},		--擒龙功
}

CC.WGJC2={ --武功封穴流血迟缓加成
{1, 3, 1, 2},	--罗汉拳
{2, 4, 2, 5},		--逍遥游
{3, 4, 1, 1},		--五毒神掌
{4, 6, 6, 6},	--鹰爪功
{5, 5, 4, 6},	--寒冰绵掌
{7, 8, 1, 9},		--绵掌
{8, 7, 3, 2},	--天山六阳掌
{9, 6, 2, 1},	--白驼雪山掌
{10, 7, 2, 2},	--百花错拳
{11, 4, 9, 1},	--九阴白骨爪
{12, 7, 5, 5},	--落英神剑掌
{13, 6, 3, 1},	--铁掌
{14, 7, 4, 3},	--天山折梅手
{15, 8, 1, 8},	--空明拳
{16, 7, 1, 8},	--太极拳
{17, 10, 1, 3},	--一阳指
{18, 9, 3, 1},	--弹指神通
{19, 7, 7, 6},	--幻阴指
{20, 8, 5, 7},	--龙爪手
{21, 7, 5, 5},	--玄冥神掌
{22, 7, 4, 2},	--大金刚掌
{23, 8, 8, 1},	--七伤拳
{24, 7, 8, 3},	--须弥山神掌
{25, 8, 2, 7},	--黯然销魂掌
{26, 7, 5, 2},	--降龙十八掌

{27, 1, 5, 3},	--松风剑法
{28, 1, 6, 2},	--雷震剑法
{29, 5, 5, 5},	--三分剑术
{30, 2, 6, 5},	--万花剑法
{31, 3, 6, 3},	--泰山十八盘
{32, 1, 6, 6},	--云雾十三式
{33, 3, 7, 2},	--万岳朝宗
{34, 3, 6, 3},	--太岳三青峰
{35, 1, 6, 8},	--雪山剑法
{36, 5, 7, 7},	--柔云剑术
{37, 5, 7, 6},	--两仪剑法
{38, 7, 7, 4},	--玉箫剑法
{39, 5, 7, 5},	--七星剑法
{40, 5, 9, 1},	--金蛇剑法
{41, 4, 9, 2},	--灭剑绝剑
{42, 2, 8, 6},	--玉女素心剑
{44, 2, 9, 3},	--苗家剑法
{45, 6, 6, 6},	--玄铁剑法
{46, 3, 8, 6},	--太极剑法
{47, 3, 9, 4},	--独孤九剑
{48, 3, 10, 1}, --辟邪剑法
{49, 9, 9, 4},	 --六脉神剑

{50, 1, 5, 3},	--柴刀十八路
{51, 1, 6, 2},	--万劫刀法
{52, 1, 8, 2},	--鬼头刀法
{53, 3, 7, 4},	--南山刀法
{54, 2, 8, 5},	--鸳鸯刀法
{55, 1, 7, 8},	--狂风刀法
{56, 7, 7, 7},	--奇门三才刀
{57, 3, 7, 5},	--慈悲刀法
{58, 2, 8, 3},	--修罗刀
{59, 1, 7, 2},	--五虎断门刀
{60, 4, 7, 6},	--反两仪刀法
{61, 4, 7, 4},	--金乌刀法
{62, 3, 8, 5},	--夫妻刀法
{63, 1, 10, 2},	--血刀大法
{64, 5, 8, 6},	--玄虚刀法
{65, 3, 7, 3},	--燃木刀法
{66, 4, 9, 1},	--火焰刀法
{67, 5, 9, 2},	--胡家刀法

{68, 5, 5, 5},	--杨家枪法
{69, 4, 5, 1},	--毒龙鞭法
{70, 4, 5, 2},	--中平枪法
{71, 5, 4, 2},	--裴将军帖
{72, 7, 3, 3},	--棋盘招式
{73, 6, 4, 8},	--持瑶琴
{74, 4, 6, 3},	--鹤蛇八打
{75, 1, 8, 2},	--大剪刀
{76, 5, 6, 5},	--海叟钓法
{77, 6, 6, 6},	--阴阳倒乱刃
{78, 6, 7, 7},	--黄沙万里鞭
{79, 7, 4, 8},	--银索金铃
{80, 7, 5, 6},	--打狗棒法
{86, 7, 6, 2},	--伏魔杖法
{81, 8, 6, 5},	--一阳指书
{82, 7, 6, 7},	--金刚伏魔圈
{83, 6, 8, 3},	--无上大力杵
{84, 7, 7, 7},	--倚天屠龙功
{120, 4, 9, 4},	--灵蛇杖法
{202, 5, 3, 8},	--灵蛇杖法

{114, 3, 7, 2},	--连城剑法
{123, 8, 2, 5},	--越女剑法
{125, 2, 5, 5},	--泼墨披麻剑
{126, 2, 5, 3},	--千蛛万毒手
{127, 7, 2, 6},	--美女拳法
{128, 1, 8, 2},	--大嵩阳掌
{129, 3, 4, 5},	--三花聚顶掌
{130, 5, 5, 5},	--四象掌
{131, 8, 8, 8},	--斩流剑
{132, 7, 7, 7},	--白虹掌
{133, 1, 10, 5},	--参合指
{134, 5, 1, 2},	--神门十三剑
{135, 5, 3, 6},	--绕指柔剑
{136, 4, 6, 5},	--达摩剑法
{137, 4, 8, 3},	--迅雷剑
{138, 4, 4, 8},	--八卦刀法
{139, 3, 7, 2},	--降魔刀法
{140, 5, 6, 5},	--阴风刀
{141, 7, 7, 7},	--霹雳刀法
{142, 8, 3, 10},	--软红蛛索
{144, 2, 9, 9},	--寒阴箭
{145, 9, 2, 8},	--云帚拂尘功
{146, 7, 8, 8},	--圣火令秘诀
{147, 1, 10, 1},	--五轮大转
{148, 2, 8, 3},	--白羽箭
{149, 1, 10, 1},	--火枪连射
{154, 5, 5, 5}, ----慕容剑法
{155, 1, 7, 1}, ----五指秘刀
{156, 3, 2, 3}, ----陆家刀法
{157, 2, 0, 4}, ----回风拂柳刀
{158, 2, 5, 2}, ----毒铁菱
{159, 1, 1, 10}, ----三蜈五蟆烟
{160, 5, 1, 8}, ----腐尸毒
{161, 5, 8, 2}, ----毒龙锥
{162, 8, 6, 6}, ----青字九打
{163, 5, 2, 6}, ----毒蟾砂
{164, 7, 7, 2}, ----回龙璧
{165, 10, 10, 1}, ----夺命金花
{166, 7, 3, 9}, ----蚊须针
{167, 6, 8, 3}, ----黑血神针
{168, 8, 1, 8}, ----玉蜂针
{169, 7, 2, 10}, ----三笑逍遥散
{170, 7, 2, 8}, ----冰魄银针
{171, 9, 1, 5}, ----七绝针
{172, 7, 7, 10}, ----透骨针
{173, 5, 10, 1}, ----金蛇锥
{174, 8, 10, 1}, ----枣核钉
{175, 8, 8, 8}, ----霹雳雷火弹
{176, 10, 1, 10}, ----生死符
{177, 10, 10, 1}, ----葵花神针
{109, 10, 1, 10}, --四大神技
{110, 10, 10, 1}, 
{111, 1, 10, 10}, 
{112, 7, 7, 7},
{85,5,3,5}, --北冥神功
{87,3,2,3}, --化功大法
{88,2,5,5}, --吸星大法
{89, 2, 2, 5},	--紫霞
{90, 2, 5, 2},	--混元
{91, 8, 8, 8},	--风林火山功
{92, 1, 7, 1},	--狮子吼
{93, 4, 4, 4},	--圣火
{94, 2, 2, 2},	--神照
{95, 4, 7, 3},	--蛤蟆
{96, 5, 1, 1},	--罗汉
{97, 5, 5, 5},	--乾坤
{98, 2, 2, 8},	--小无相
{99, 5, 5, 2},	--纯阳
{100, 2, 2, 2},	--先天
{101, 6, 2, 2},	--八荒
{102, 5, 5, 5},	--太玄
{103, 2, 6, 1},	--龙象
{104, 7, 4, 2},	--逆运
{105, 8, 0, 5},	--葵花
{106, 7, 3, 3},	--九阳
{107, 3, 7, 3},	--九阴
{108, 5, 5, 5},	--易筋
{121, 2, 6, 7},	--玉女
{124, 2, 1, 9},	--寒冰
{150, 3, 3, 3},	--金关玉锁诀
{151, 1, 7, 1},	--金刚不坏体
{152, 7, 1, 1},	--天南易阳决
{6, 3, 1, 10},		--碧海潮生功
{178, 3, 7, 1},		--擒龙功
{180, 5, 5, 5},		--擒龙功
{9999,5, 5, 5},		--擒龙功
}

--主功体发动机率加成人物组合
CC.ExtraGT = {
	{5, 99},
	{6, 153},
	{18, 90},
	{27, 105},
	{38, 102},
	{50, 108},
	{60, 95},
	{60, 104},
	{61, 95},
	{62, 103},
	{98, 152},
	{103, 98},
	{114, 108},
	{116, 98},
	{140, 89},
	{494, 103},
	{495, 98},
	{615, 108},
	{620, 95},
	{620, 104},	
	{597, 180},	
}
		
CC.ZGTATK={ --主功体气攻
{85,1200,1700}, --北冥神功
{87,900,1100}, --化功大法
{88,1000,1200}, --吸星大法
{89,900,950}, --紫霞
{90,900,1000}, --混元
{91,1400,1700}, --六如
{92,1000,1300}, --狮子
{93,900,1000}, --圣火
{94,900,950}, --神照
{95,1150,1200}, --蛤蟆
{96,950,1000}, --罗汉
{97,950,1100}, --乾坤
{98,950,1100}, --无相
{99,1000,1100}, --纯阳
{100,1100,1250}, --先天
{101,1000,1200}, --八荒
{102,1200,1400}, --太玄
{103,1300,1600}, --龙象
{104,1000,1800}, --逆运
{105,1200,1500}, --葵花
{106,1300,1500}, --九阳
{107,1600,1900}, --九阴
{108,1500,1700}, --易筋
{121,1100,1200}, --玉女
{124,950,1100}, --寒冰
{150,900,1100}, --金关
{151,900,1000}, --金刚
{152,900,1000}, --天南
{153,1000,1200}, --临济
{6, 1000, 1100},		--碧海潮生功
{178, 1000, 1200},		--擒龙功
{180, 1500, 1700},     --太虚
{181, 1800, 2000},     --玄武
{182, 1500, 1700},     --太极
{183, 1500, 1700},     --洗髓
{184, 1500, 1700},     --瑜伽
{185, 1000, 1200},     --武当九阳
{186, 1000, 1200},     --峨嵋九阳
{187, 1000, 1200},     --少林九阳
{188, 1400, 1600},     --神足经
{189, 1100, 1300},     --阴阳磨
{203, 1500, 1900},	--怒海剑涛
{204, 1000, 1200},	--太清罡气
{9999, 1500, 1700},
}

CC.ZGTDEF={ --主功体气防
{85,1200,1700}, --北冥神功
{87,900,1200}, --化功大法
{88,1000,1400}, --吸星大法
{89,900,1000}, --紫霞
{90,900,950}, --混元
{91,1400,1700}, --六如
{92,900,901}, --狮子
{93,950,1050}, --圣火
{94,1050,1051}, --神照
{95,1050,1100}, --蛤蟆
{96,900,1100}, --罗汉
{97,1200,1400}, --乾坤
{98,950,1100}, --无相
{99,1000,1200}, --纯阳
{100,1150,1300}, --先天
{101,1200,1400}, --八荒
{102,1100,1350}, --太玄
{103,1100,1300}, --龙象
{104,1000,1600}, --逆运
{105,1100,1300}, --葵花
{106,1500,1800}, --九阳
{107,1200,1400}, --九阴
{108,1500,1700}, --易筋
{121,1100,1300}, --玉女
{124,900,950}, --寒冰
{150,1000,1100}, --金关
{151,1200,1500}, --金刚
{152,900,950}, --天南
{153,1000,1100}, --临济
{6, 1000, 1200},		--碧海潮生功
{178, 950, 1000},		--擒龙功
{180, 1200, 1700},     --太虚
{181, 1800, 2000},     --玄武
{182, 1500, 1700},     --太极
{183, 1500, 1700},     --洗髓
{184, 1500, 1700},     --瑜伽
{185, 1000, 1200},     --武当九阳
{186, 1000, 1200},     --峨嵋九阳
{187, 1000, 1200},     --少林九阳
{188, 1400, 1600},     --神足经
{189, 1100, 1500},     --阴阳磨
{203, 1200, 1700},	--怒海剑涛
{204, 1700, 2000},	--太清罡气
{9999, 1500, 1700},
}


--主功体杀怒气
CC.ZGT1 = {
	{25, 104, 30},--逆运黯然30
	{15, 100, 10},--先天空明10
	{49, 108, 20}, --易筋六脉20
	{114, 94, 15},--神照连城15
	{139, 151, 15},--金刚降魔15
	{18, 107, 15},--九阴弹指15
	{135, 99, 20},--纯阳绕指柔20	
	{41, 153, 10},--临济灭绝10	
	{57, 92, 20},--慈悲狮子20	
	{175, 178, 10},--霹雳擒龙10
	{176, 102, 12},--生死符太玄12
	{67, 93, 25},--武骧金星：圣火胡刀25
	{60, 204, 20},--武骧金星：太清罡气反两仪20
	{48, 95, 20},--武骧金星：蛤蟆辟邪20	
}

--主功体非百分比增加伤害
CC.ZGT2 = {
	{1, 96, 80},--罗汉伏魔功+罗汉拳伤害+80
	{136, 151, 70},--金刚不坏+达摩剑伤害+70
	{68, 150, 80},--金关玉锁+杨家枪伤害+80
	{14, 101, 80}, --八荒+折梅伤害+80
	{84, 106, 90},--九阳+倚天屠龙伤害+90
	{45, 103, 90},--龙象+玄铁伤害+90
	{56, 97, 70},--乾坤+奇门三才刀伤害+70
	{53, 102, 80},--太玄+南山刀伤害+80
	{82, 92, 80},--狮子吼+金刚伏魔圈伤害+80
	{39, 100, 70},  --先天+七星伤害+70
	{36, 99, 70}, --纯阳无极功+柔云伤害+70
	{127, 121, 80}, --玉女美女伤害+80
	{133, 98, 70}, --无相参合伤害+70
	{126, 95, 80}, --蛤蟆千蛛伤害+80
	{171, 152, 90},--七绝天南伤害+90	
	{175, 153, 80},--霹雳临济伤害+80
	{80, 108, 70},--打狗易经伤害+70
	{63, 104, 100},--武骧金星：血刀逆运伤害+100
	{42, 107, 80},--武骧金星：玉女九阴伤害+80	
    {46, 180, 100},--武骧金星：玉女八荒连击--15%三连  
}	

--主功体百分比增加伤害
CC.ZGT3 = {
	{24, 96, 20},--罗汉伏魔功+须弥山神掌20%
	{16, 99, 25},--纯阳无极功+太极拳25%
	{41, 104, 40},--逆运+灭绝剑40%
	{22, 92, 25},--狮子+大金刚25%
	{42, 121, 20},--玉女+玉女20%
	{17, 152, 30},--天南+一阳30%
	{137, 89, 40},--紫霞+迅雷40%	
	{140, 93, 20},--圣火+阴风20%	
	{141, 106, 20},--九阳+霹雳20%	
	{154, 98, 30},--慕容+小无相30%	
	{80, 178, 25},--打狗+擒龙25%	
	{38, 6, 25},--玉箫+碧海25%
	{64, 107, 25},--玄虚+九阴25%
	{67, 100, 35},--武骧金星：胡刀+先天35%	
	{66, 108, 40},--武骧金星：火刀+易筋40%	
	{23, 103, 40},--武骧金星：七伤+龙象40%	
	{58, 101, 40},--武骧金星：修罗+八荒40%
	{26, 106, 20},--武骧金星：降龙+九阳+40%
}

--主功体连击
CC.ZGT4 = {
	{11, 107, 20},--九阴白骨连击--20%三连
	{145, 121, 20}, --玉女拂尘连击 --20%三连
	{52, 94, 25},--神照鬼头连击--25%三连
	--{70, 94, 25},
	{7, 99, 20},--纯阳棉掌连击--20%三连
	{138, 90, 15},--混元八卦刀连击--15%三连
	{37, 153, 20},--临济两仪剑连击--20%三连	
	{60, 153, 20},--临济两仪刀连击--20%三连	
	{2, 150, 20},--金关逍遥连击--20%三连
	{166, 99, 20},--蚊须纯阳连击--20%三连
	{172, 93, 15},--透骨圣火连击--15%三连	
	{12, 6, 20},--落英碧海连击--20%三连
	{68, 96, 20},--武骧金星：杨家罗汉连击--20%三连
	{49, 100, 10},--武骧金星：六脉先天连击--10%三连
	{82, 98, 15},--武骧金星：金刚小无连击--15%三连
	{47, 108, 10},--武骧金星：独孤易筋连击--10%三连
	{120, 95, 15},--武骧金星：灵蛇蛤蟆连击--15%三连
	{42, 101, 15},--武骧金星：玉女八荒连击--15%三连	
	{131, 180, 20},--武骧金星：玉女八荒连击--15%三连	
}

--主功体行动后恢复集气
CC.ZGT5 = {
	{46, 99, 150},--纯阳太极集气150
	{86, 96, 200},--罗汉+伏魔杖集气200
	{78, 105, 150},--葵花黄沙集气150
	{44, 106, 150}, --九阳苗家集气150
	{83, 103, 300},--龙象无上集气300
	{77, 97, 300},--乾坤阴阳集气300
	{55, 93, 250},--圣火狂风集气250
	{2, 102, 300},--太玄逍遥集气300
	{66, 98, 200},--无相火焰集气200
	{26, 108, 250},--易筋降龙集气250
	{5, 124, 300},--寒冰寒冰集气300
	{144, 152, 250},--天南寒阴集气250
	{39, 150, 200},--金关全真剑集气200	
	{168, 121, 250},--玉蜂玉女集气250		
	{137, 153, 300},--临济迅雷集气300
	{45, 104, 188},--逆运玄铁集气188	
}

--主功体杀气
CC.ZGT6 = {
	{9, 95, 200},--蛤蟆灵蛇200
	{65, 106, 150},--九阳燃木150
	{48, 124, 250},--寒冰辟邪250
	{35, 94, 200},--神照雪山200
	{74, 93, 150},--圣火鹤蛇150
	{76, 102, 200},--太玄海叟200
	{20, 98, 200},--无相龙爪200
	{17, 100, 150},--先天一阳150
	{81, 152, 150},--天南一阳书150
	{15, 150, 200},--金关空明200
	{147, 103, 150},--龙象五轮150
	{86, 108, 200},--易筋伏魔杖200
	{130, 153, 200},--临济四象200	
	{47, 89, 150},--独孤紫霞150	
	{19, 90, 150},--幻阴混元150		
	{139, 96, 200},--降魔罗汉200	
	{26, 107, 150},--九阴降龙150	
	{174, 92, 200},--枣核狮子200	
	{167, 105, 200},--黑血葵花200	
	{166, 97, 200},--蚊须乾坤200	
	{2, 178, 250},--逍遥擒龙250	
	{45, 6, 150},--玄铁碧海150
	{62, 121, 175},--夫妻玉女175
	{79, 101, 150},--武骧金星：银锁八荒150
	{47, 180, 150},--武骧金星：九剑太虚150
}

--主功体暴击
CC.ZGT7 = {
	{40, 90},--混元金蛇必暴
	{82, 151},--金刚金刚必暴
	{130, 106},--九阳四象必暴
	{13, 92},--狮子铁掌必暴	
	{19, 124},--幻阴寒阴必暴	
	{20, 178},--龙爪擒龙必暴
	{44, 107},--苗剑九阴必暴
	{49, 102},--武骧金星：六脉太玄必暴
	{46, 98},--武骧金星：太极小无必暴
	{67, 99},--武骧金星：胡刀纯阳必暴
	{127, 89},--武骧金星：美女紫霞必暴	
}

--主功体减内力消耗
CC.ZGT8 = {
	{49, 152, 50},--天南六脉内力-50%
}

--主功体杀体力
CC.ZGT9 = {
	{133, 152, 15},--天南参合15%
	{132, 98, 15},--小无相白虹15%
	{140, 97, 20},--乾坤阴风20%	
	{18, 6, 20},--弹指碧海20%
	{37, 204, 15},	--太清罡气两仪剑
}

--主功体封穴
CC.ZGT10 = {
	{79, 121, 30}, --玉女银索30
	{19, 107, 20}, --幻阴九阴20
	{17, 106, 20}, --一阳九阳20
	{133, 108, 20}, --参合易筋20
	{144, 124, 20}, --寒阴寒冰20
	{173, 90, 25}, --金蛇锥混元25	
	{165, 97, 25}, --金花乾坤25	
	{25, 6, 20}, --黯然碧海20	
}

--主攻体对武功威力加成
CC.ZGT11={ 
	{8,101,300}, --八荒+六阳
	{60,90,250}, --混元+反两仪刀
	{37,89,300}, --紫霞+两仪
	{5,95,400}, --蛤蟆+寒冰
	{128,124,350}, --寒冰+嵩阳
	{129,150,300}, --金关+三花
	{146,93,250}, --圣火+圣火
	--[[{71,105,250}, --琴棋书画+葵花
	{72,105,250}, --琴棋书画+葵花
	
	{125,105,250}, --琴棋书画+葵花]]
	{73,6,300}, --琴+碧海
	{155,102,250}, --五指+太玄	
	{168,100,300}, --玉蜂+先天	
	{84,103,300}, --倚天屠龙功+龙象300	
}

--主功体上毒
CC.ZGT12={
	{176, 101, 30}, --生死符+八荒30点
	{170, 121, 25}, --冰魄+玉女25点
	{9, 104, 25}, --灵蛇+逆运25点
	{21, 95, 30}, --武骧金星：玄冥+蛤蟆30点
}

--主功体按中毒加伤害
CC.ZGT13={
	{3, 95, 200}, --五毒+蛤蟆200%
	{120, 104, 100}, --灵蛇+逆运100%
}

--主功体按内伤加伤害
CC.ZGT14={
	{23, 92, 150}, --七伤+狮子150%
	{26, 178, 120}, --降龙+擒龙120%
	{149, 98, 120}, --火枪连射+小无120%
}

-------------------------------------------------

--武器对武功威力加成
CC.ExtraOffense = {
{52, 75, 200}, --鳄嘴剪
{45, 67, 100},  --冷月宝刀
{37, 41, 150}, --倚天剑
{37, 137, 100}, --倚天剑
{49, 80, 200}, --打狗棒
{50, 83, 100}, --伏魔杵
{50, 86, 100}, --伏魔杵
{44, 63, 150}, --血刀
{40, 40, 150}, --金蛇剑
{53, 84, 100}, --判官笔
{54, 73, 200}, --瑶琴加成
{246, 9, 150}, --扇子加成白驼功夫
--{246, 95, 100}, 
{243, 25, 100}, --掌套加成黯然
{243, 127, 200},  --掌套加成美女拳法
{247, 14, 200},  --指环加成
{247, 8, 200},  
{247, 132, 200}, 
--{247, 2, 300},   
{48, 77, 200},  --金刀黑剑
{252, 120, 100},  --灵蛇杖加成
{36, 45, 100}, --玄铁剑加成
{38, 39, 100}, --君子淑女剑加成
{38, 42, 100}, --君子淑女剑加成
{39, 114, 200}, --白龙剑加成
{39, 37, 100}, --白龙剑加成
{41, 36, 150}, --凝碧剑加成
{41, 134, 200}, --凝碧剑加成
{41, 135, 100}, --凝碧剑加成
{42, 29, 100}, --白虹剑加成
{42, 35, 200}, --白虹剑加成
{43, 139, 150}, --屠龙刀加成
{43, 140, 111}, --屠龙刀加成
{43, 66, 100}, --屠龙刀加成
{46, 58, 150}, --绿波香露刀加成
{46, 55, 150}, --绿波香露刀加成
{47, 59, 200}, --金刀加成
{51, 69, 300}, --金龙鞭加成
{51, 78, 150}, --金龙鞭加成
{53, 81, 100}, --判官笔加成
{53, 71, 150}, --判官笔加成
{244, 3, 200}, --金蜈钩加成
{244, 126, 100}, --金蜈钩加成
{245, 17, 100}, --玄铁指环加成
{245, 19, 100}, --玄铁指环加成
{245, 133, 100}, --玄铁指环加成
{249, 61, 100}, --闯王宝刀加成
{249, 65, 100}, --闯王宝刀加成
{250, 54, 300}, --鸳鸯宝刀加成
{250, 62, 150}, --鸳鸯宝刀加成
{255, 68, 600}, --龙胆亮银枪加成
{255, 70, 300}, --龙胆亮银枪加成
{236, 46, 100}, --真武剑加成
{300, 2, 200}, --峨嵋刺加成
{300, 7, 200}, --峨嵋刺加成
{300, 12, 150}, --峨嵋刺加成
{300, 130, 150}, --峨嵋刺加成
{301, 123, 200}, --青竹棒加成
{301, 125, 150}, --青竹棒加成
{301, 136, 100}, --青竹棒加成
{302, 27, 500}, --木剑加成
{302, 47, 100}, --木剑加成
{303, 43, 100}, --紫薇软剑加成
{303, 48, 100}, --紫薇软剑加成
{303, 154, 100}, --紫薇软剑加成
{304, 38, 150}, --玉箫加成
{305, 138, 200}, --紫金八卦刀加成
{306, 149, 250}, --火枪加成
{307, 82, 100}, --四丈银鞭加成
{308, 145, 150}, --银丝拂尘加成
{309, 142, 250}, --软红蛛索加成
{310, 79, 150}, --金铃索带加成
{311, 146, 150}, --圣火令加成
{312, 147, 100}, --金轮加成
--{299, 141, 150}, --金轮加成
{291, 159, 300}, --银烟管加成
--{291, 169, 100}, --银烟管加成
{292, 72, 100}, --铁棋盘加成
{293, 171, 100}, --刺针指环加成
{293, 172, 100}, --刺针指环加成
{293, 18, 100}, --刺针指环加成
{294, 148, 150}, --射雕弓加成
{295, 160, 200}, --柔丝索加成
{295, 169, 150}, --柔丝索加成
{296, 161, 150}, --阴阳扇加成
{296, 162, 150}, --阴阳扇加成
{296, 202, 200}, --阴阳扇加成
{297, 163, 300}, --含沙射影加成
{297, 166, 100}, --含沙射影加成
{297, 167, 100}, --含沙射影加成
{297, 168, 100}, --含沙射影加成
{297, 170, 100}, --含沙射影加成
{298, 177, 100}, --绣花针加成
{299, 141, 100}, --霹雳狂刀加成
{313, 156, 300}, --银弧刀加成
{253, 176, 100}, --七星海棠加成
--{253, 159, 200}, --七星海棠加成
--{253, 161, 200}, --七星海棠加成
{55, 110, 300},
{56, 111, 300},
{57, 112, 300},
}
--天赋外功
CC.TFWG={
    {1, 67, 1.5},--胡斐 胡刀
	{2, 159, 2},--程灵素 三蜈五蛤烟
	{3, 44, 1.5},--苗人凤 苗剑
	{4, 50, 1.5},--阎基 柴刀十八路
	{5, 46, 1.5},--张三丰 太极剑
	{6, 41, 1.3},--灭绝 灭绝剑
	{7, 37, 1.3},--何太冲 两仪剑
	{8, 23, 1.3},--唐文亮 七伤拳
	{9, 46, 1.3},--张无忌 太极剑
	{10, 13, 1.6},--范遥 铁拳
	{11, 18, 1.4},--杨逍 弹指神通
	{12, 4, 1.5},--殷天正 鹰爪功
	{13, 23, 1.3},--谢逊 七伤拳
	{14, 5, 1.5},--韦一笑 寒冰绵掌
	{15, 165, 1.3},--金花 金花
	{18, 19, 1.5},--成昆 幻阴指
	{19, 34, 1.7},--岳不群 太岳三青峰
	{20, 32, 1.7},--莫大 云雾十三
	{21, 30, 1.7},--定闲 万花剑法
	{22, 33, 1.5},--左冷禅 万岳朝宗
	{23, 31, 1.7},--天门 泰山十八盘
	{24, 27, 2.5},--余沧海 松风
	{25, 78, 2},--蓝凤凰 黄沙万里鞭
	{26, 21, 1.5},--任我行 玄冥神掌
	{27, 177, 1.5},--东方不败 葵花神针
	{29, 55, 2},--田伯光 狂风刀
	{31, 125, 1.5},--丹青生 泼墨披麻剑
	{32, 71, 1.5},--秃笔翁 裴将军帖
	{33, 72, 1.5},--黑白子 棋盘招式
	{34, 73, 1.5},--黄钟公 持瑶琴
	{35, 47, 1.5},--令狐冲 独孤九剑
	{36, 48, 1.5},--林平之 辟邪剑法
	{37, 114, 1.4},--狄云 连城剑法
	{38, 61, 1.5},--石破天 金乌刀法
	{43, 35, 1.3},--白万剑 雪山剑法
	{44, 75, 1.3},--岳老三 大剪刀
	{46, 169, 1.3},--丁春秋 三笑逍遥散
	{47, 169, 1.3},--阿紫 三笑逍遥散
	{48, 21, 1.3},--游坦之 玄冥神掌
	{49, 14, 1.5},--虚竹 折梅手
	{50, 26, 1.5},--萧峰 降龙
	{51, 43, 1.5},--慕容复 斗转星移
	{52, 70, 2},--花铁杆 中平枪
	{53, 49, 1.6},--段誉 六脉
	{54, 40, 1.3},--袁承志 金蛇剑
	{55, 26, 1.5},--郭靖 降龙
	{56, 80, 1.5},--黄蓉 打狗
	{57, 18, 1.5},--黄药师 弹指
    {58, 45, 1.5},--杨过 玄铁剑
	{59, 42, 1.5},--小龙女 玉女剑
	{601, 42, 3},--小龙女 玉女剑
	{60, 120, 1.3},--欧阳锋 灵蛇杖法
	{620, 120, 1.3},--欧阳锋 灵蛇杖法
	{61, 9, 1.3},--欧阳克 白驼雪山掌
	{62, 147, 1.3},--金轮法王 五轮大转
	{594, 147, 1.3},--金轮法王 五轮大转
	{63, 38, 1.5},--程英 玉箫剑法
	{64, 15, 1.8},--周伯通 空明拳
	{65, 17, 1.5},--一灯 一阳指
	{66, 146, 1.3},--小昭 圣火令
	{67, 13, 1.3},--裘千仞 铁掌
	{68, 39, 1.3},--丘处机 北斗罡剑
	{69, 26, 1.4},--洪七公 降龙
	{70, 22, 1.3},--玄慈 大力金刚
	{71, 86, 1.3},--洪安通 伏魔杖
	{596, 86, 1.3},--洪安通 伏魔杖
	{72, 28, 2},--田归农 雷震剑法
	{73, 73, 1.7},--任盈盈 持瑶琴
	{74, 29, 2},--霍青桐 三分
	{75, 10, 2},--陈家洛 百家错
	{77, 62, 1.5},--萧中慧 夫妻刀法
	{78, 11, 1.5},--梅超风 九阴爪
	{79, 34, 1.5},--岳灵珊 太岳
	{80, 36, 1.5},--张召忠 柔云剑
	{81, 17, 1.3},--朱九真 一阳指
	{82, 7, 1.3},--宋青书 绵掌
	{83, 142, 1.5},--何铁手 软红蛛索
	{85, 3, 2.5},--贝海石 五毒神掌
	--{86, 30, 1.5},--阿珂 万花
	--{87, 78, 1.5},--苏荃 黄沙万里鞭
	{88, 128, 1.5},--祖千秋 大嵩阳掌
	{89, 56, 2},--人厨子 奇门三才刀
	{90, 51, 1.5},--钟灵 万劫刀
	{91, 28, 2},--温青青 雷震剑法
	--{93, 36, 1.3},--李浣芷 柔云
	{94, 52, 1.5},--陆天枢 鬼头刀
	{95, 46, 1.5},--刘乘风 太极剑
	{96, 37, 1.3},--水袋 两仪剑
	{97, 63, 1.5},--血刀 血刀
	{98, 17, 1.5},--段延庆 一阳指
	{99, 33, 1.5},--叶二娘 万岳朝宗
	{100, 74, 1.3},--云中鹤 蛇鹤八打
	{102, 17, 1.5},--枯荣 一阳指
	{103, 66, 1.5},--鸠摩智 火焰刀
	{595, 66, 1.5},--鸠摩智 火焰刀
	{106, 59, 1.3},--王元吧 五虎断门
	{107, 60, 1.3},--高老头 反两仪刀
	{108, 60, 1.3},--矮老头 反两仪刀
	{109, 34, 1.6},--鲜于通 太岳三青峰
	{110, 76, 1.3},--游骥 海叟钓法
	{111, 77, 1.3},--游驹 阴阳倒乱刃
	{112, 22, 2},--萧远山 大金刚掌
	{113, 43, 1.5},--慕容博 斗转
	{115, 8, 1.5},--苏星河 天山六阳掌
	{116, 8, 2},--无崖子 天山六阳掌
	{117, 14, 2},--天山童姥 天山折梅手
	{118, 132, 1.8},--李秋水 白虹掌
	{119, 17, 1.3},--渔 一阳指
	{120, 17, 1.3},--樵 一阳指
	{121, 17, 1.3},--耕 一阳指
	{122, 81, 1.3},--读 一阳指书
	{123, 39, 1.3},--马钰 北斗罡剑
	{124, 39, 1.3},--谭处端 北斗罡剑
	{125, 39, 1.3},--刘处玄 北斗罡剑
	{126, 39, 1.3},--王处一 北斗罡剑
	{127, 39, 1.3},--郝大通 北斗罡剑
	{128, 39, 1.3},--孙不二 北斗罡剑
	{129, 39, 1.8},--王重阳 北斗罡剑
	{130, 86, 1.3},--柯镇恶 伏魔杖
	{131, 10, 1.4},--朱聪 百花错
	{132, 78, 1.4},--韩宝驹 黄沙万里鞭
	{133, 53, 1.4},--南希仁 南山刀法
	{134, 76, 1.4},--张阿生 海叟钓法
	{135, 41, 1.3},--张阿生 灭绝
	{136, 123, 2},--韩小莹 越女
	{137, 27, 1.6},--陈达海 松风
	{138, 78, 1.5},--瓦耳拉齐 黄沙万里鞭
	{139, 28, 1.5},--郑克爽 雷震剑法
	{140, 47, 1.5},--风清扬 独孤九剑
	{141, 34, 1.5},--成不由 太岳三青峰
	{142, 34, 1.5},--封不平 太岳三青峰
	{143, 69, 2},--六仙 毒龙鞭法
	{144, 69, 2},--六仙 毒龙鞭法
	{145, 69, 2},--六仙 毒龙鞭法
	{146, 69, 2},--六仙 毒龙鞭法
	{147, 69, 2},--六仙 毒龙鞭法
	{148, 69, 2},--六仙 毒龙鞭法
	{150, 37, 1.5},--冯锡范 两仪剑
	{151, 13, 1.5},--文泰来 铁掌
	{152, 36, 1.5},--无尘 柔云剑
	{153, 164, 1.3},--赵半山 回龙璧
	{154, 54, 1.5},--骆冰 鸳鸯刀
	{155, 69, 1.3},--常赫志 毒龙鞭法
	{156, 69, 1.3},--常伯志 毒龙鞭法
	{157, 74, 1.3},--潇湘子 鹤蛇八打
	{158, 78, 1.3},--尹克西 黄沙万里鞭
	{159, 86, 1.3},--尼摩星 伏魔杖
	{160, 83, 1.5},--达尔巴 无上大力杵
	{161, 145, 3},--李莫愁 云尘
	{162, 69, 2},--不三 毒龙鞭法
	{163, 69, 2},--不四 毒龙鞭法
	{164, 18, 1.4},--谢烟客 弹指神通
	{165, 17, 1.2},--朱长龄 一阳指
	{166, 60, 1.5},--班淑娴 两仪剑
	{167, 23, 1.3},--宗维侠 七伤拳
	{168, 23, 1.3},--常敬之 七伤拳
	{169, 22, 1.4},--空闻 大金刚掌
	{170, 20, 1.4},--空性 龙爪手
	{171, 46, 1.4},--宋远桥 太极剑
	{172, 134, 1.5},--莫声谷 神门十三剑
	{173, 146, 1.3},--妙风使 圣火令秘诀
	{174, 140, 1.3},--流云使 阴风刀
	{175, 172, 1.3},--辉月使 透骨针
	{176, 142, 1.3},--何红药 软红蛛索
	{177, 28, 1.3},--史秉光 雷震剑法
	{178, 28, 1.3},--史秉文 雷震剑法
	{179, 28, 1.3},--黎刚 雷震剑法
	{180, 37, 1.3},--洞玄 两仪剑
	{181, 37, 1.3},--闵子华 两仪剑
	{182, 13, 1.3},--刘培生 铁掌
	{183, 34, 1.5},--刘培生 太岳三青峰
	{184, 44, 1.3},--玉真子 苗家剑法
	{185, 13, 1.4},--穆人清 铁掌
	{186, 13, 1.3},--归心树 铁掌
	{187, 13, 1.3},--冯难敌 铁掌
	{188, 13, 1.3},--黄真 铁掌
	{190, 163, 1.3},--莽牯朱蛤 毒蟾砂
	{419, 21, 1.3},--蛇王 玄冥神掌
	{430, 84, 1.3},--蛛王 倚天屠龙功
	{440, 19, 1.3},--蟾王 幻阴指
	{451, 2, 1.2},--高三娘 逍遥游
	{452, 71, 1.2},--范一飞 裴将军帖
	{453, 138, 1.2},--吕正平 八卦刀法
	{454, 69, 1.2},--风良 毒龙鞭法
	{455, 110, 2},--无酒不欢 神山剑
	{456, 49, 1.5},--安七 六脉神剑
	{457, 86, 1.5},--紫落梵 伏魔杖法
	{458, 26, 1.2},--解风 降龙
	{459, 26, 1.2},--史火龙 降龙
	{516, 110, 1.5},--宫本 神山
	{517, 110, 1.5},--佐佐木 神山
	{558, 140, 1.5},--霍山 阴风刀
	{580, 45, 1.3},--白雕 玄铁剑法
	{582, 58, 1.3},--木婉清 修罗刀
	{585, 111, 2},--小二 西瓜
	{589, 114, 1.3},--水笙 连城剑法
	{590, 79, 1.5},--水笙 银索金铃
	{592, 47, 2},--独孤求败 独孤九剑
	{593, 86, 1.3},--不戒和尚 伏魔杖
	{597, 131, 1.5},--谢无悠 斩流剑术
	{598, 109, 1.5},--腾文婷 野球拳
	{599, 11, 3},--黄裳 九阴爪
	{600, 43, 2},--武无敌 斗转星移
	{602, 17, 2},--段思平 一阳指
	{603, 23, 2}, --木灵子 七伤拳
	{604, 11, 1.5}, --黄衫女 九阴爪
	{605, 77, 1.3}, --公孙止 阴阳倒乱刃
	{607, 45, 1.3},--神雕 玄铁剑法
	{608, 140, 1.3},--大雕 阴风刀
	{609, 19, 1.3},--火蟾 幻阴指
	{610, 176, 1.3},--玄蟒 生死符
	{612, 120, 1.3},--彩蛛 灵蛇杖法
	{613, 49, 1.3},--白猿 六脉神剑
	{614, 123, 5.5},--阿青 越女剑
	{615, 86, 1.5},--达摩 伏魔杖
	{616, 11, 1.3},--完颜康 九阴爪
	{617, 26, 1.5},--春风 降龙
	{618, 8, 2},--逍遥子 天山六阳掌
	{619, 129, 1.8},--耶律齐 三花聚顶掌
	{621, 67, 1.5},--胡一刀 狐刀
	{622, 3, 1.3},--慕容景悦 五毒神掌
	{623, 3, 1.3},--薛鹊 五毒神掌
	{624, 3, 1.3},--石万噌 五毒神掌
	{625, 62, 1.5},--袁冠南 夫妻刀
	{626, 137, 1.6},--何足道 迅雷剑
	{627, 77, 1.5},--公孙绿萼 阴阳捣乱
	--{628, 29, 2},--柯思丽 三分
	--{629, 30, 2},--阿九 万花
	{630, 40, 1.4},--夏雪宜 金蛇
	{631, 126, 2},--殷离 千蛛万毒
	{632, 114, 1.3},--丁典 连城剑法
	{634, 86, 1.2},--凌退思 伏魔杖
	{635, 2, 1.7},--穆念慈 逍遥游
	{636, 79, 1.5},--袁紫衣 银索金铃
	{637, 138, 1.2},--凤天南 八卦刀
	{638, 41, 1.5},--周芷若 灭绝剑
	--{639, 46, 1.3},--赵敏 太极剑
	{640, 22, 1.3},--阿三 金刚
	{641, 22, 1.3},--阿二 金刚
	{642, 136, 1.3},--阿大 金刚
	{643, 21, 1.3},--玄冥 玄冥
	{644, 21, 1.3},--玄冥 玄冥
	{645, 37, 1.3},--温家五 
	{646, 138, 1.3},--温家五 
	{647, 83, 1.3},--温家五 无上大力杵
	{648, 138, 1.3},--温家五 
	{649, 78, 1.3},--温家五 黄沙万里鞭
	{650, 78, 1.4},--卓天雄 黄沙万里鞭
	{661, 35, 1.3},--白绣 雪山剑法
	{662, 47, 1.3},--水镜四奇 独孤九剑
	{664, 149, 1.4},--韦小宝 火枪
	{665, 155, 1.5},--组长 五指刀
	{666, 46, 1.5},--海底捞月 太极剑
	{667, 18, 3},--商御隐 弹指
	{929, 131, 1.3},--水镜四奇 易筋经
	{84, 202, 1.5},--霍都 狂风迅雷功
	{932, 60, 2},--青灵子 两仪剑
}
--天赋外功1
CC.TFWG1={
	{1, 44, 1.5},--胡斐 胡刀
	{2, 21, 2},--程灵素 玄冥
	{80, 46, 2},--张召忠 太极剑
	{5, 16, 2},--张三丰 太极拳
	{6, 130, 1.5},--灭绝 四象掌
	{9, 16, 1.6},--张无忌 太极拳
	{12, 166, 1.5},--殷天正 蚊须针
	{19, 48, 1.5},--岳不群 辟邪剑法
	{22, 128, 2},--左冷禅 大嵩阳掌
	{24, 162, 2},--余沧海 青字九打
	{37, 63, 1.3},--狄云 血刀大法
	{46, 160, 1.3},--丁春秋 腐尸毒
	{47, 160, 1.3},--丁春秋 腐尸毒
	{49, 176, 1.5},--虚竹 生死符
	{54, 173, 1.3},--袁承志 金蛇锥
	{57, 38, 1.5},--黄药师 落英神剑掌
    {58, 25, 1.5},--杨过 黯然销魂掌
	{59, 79, 1.5},--小龙女 银索金铃
	{601, 79, 3},--小龙女 玉女剑
	{60, 9, 1.3},--欧阳锋 白驼雪山掌
	{620, 9, 1.3},--欧阳锋 白驼雪山掌
	--{63, 18, 1.3},--程英 弹指
	{69, 80, 1.5},--洪七公 打狗
	{72, 161, 2},--田归农 毒龙锥
	{77, 54, 1.5},--萧中慧 鸳鸯刀法
	--{78, 18, 1.4},--梅超风 弹指神通
	{82, 16, 1.3},--宋青书 太极拳
	{83, 3, 2.5},--何铁手 五毒神掌
	{113, 133, 1.5},--慕容博 参合指
	{115, 14, 1.3},--苏星河 天山折梅手
	{116, 14, 2},--无崖子 天山折梅手
	{117, 176, 2},--天山童姥 生死符
	{129, 17, 1.8},--王重阳 一阳指
	{130, 158, 1.3},--柯镇恶 毒铁菱
	{161, 170, 2},--李莫愁 冰魄银针
	{166, 37, 1.5},--班淑娴 两仪剑
	{171, 16, 1.4},--宋远桥 太极拳
	{172, 135, 1.5},--莫声谷 绕指柔剑
	{176, 163, 1.3},--何红药 毒蟾砂
	{456, 43, 1.5},--安七 斗转星移
	{558, 146, 1.5},--霍山 圣火令秘诀
	{582, 57, 1.3},--木婉清 慈悲刀
	{592, 45, 2},--独孤求败 玄铁剑法
	{598, 111, 1.5},--腾文婷 西瓜刀法
	{602, 49, 2},--段思平 六脉神剑
	{615, 24, 1.5},--达摩 须弥山神掌
	{618, 14, 1.7},--逍遥子 天山折梅手
	{624, 159, 1.5},--石万噌 三蜈五蛤烟
	{625, 54, 1.5},--袁冠南 鸳鸯刀
	{627, 174, 1.3},--公孙绿萼 枣核钉
	{630, 173, 1.3},--夏雪宜 金蛇
	{638, 130, 2},--周芷若 四象掌
	{666, 16, 1.5},--海底捞月 太极拳
	--{662, 26, 1.3},--水镜四奇 降龙
	{932, 37, 2},--班淑娴 两仪剑
}
--天赋内功
CC.TFNG={
	{2, 87, 3},--程灵素 化功
	{5, 99, 3},--张三丰 纯阳无极功
	{6, 153, 3},--灭绝 临济十二庄
	{7, 204, 3},--何太冲 太清罡气
	{8, 189, 3},--唐文亮 阴阳磨
	{9, 106, 3},--张无忌 九阳神功
	{10, 97, 3},--范遥 乾坤大挪移
	{11, 97, 3},--杨逍 乾坤大挪移
	{13, 92, 3},--谢逊 狮吼功
	{14, 124, 3},--韦一笑 寒冰真气
    {15, 93, 3},--金花 圣火神功
	{18, 90, 3},--成昆 混元功
	{19, 89, 3},--岳不群 紫霞
	{20, 89, 3},--莫大 紫霞
	{21, 90, 3},--定闲 混元
	{22, 124, 3},--左冷禅 寒冰真气
	{23, 90, 3},--天门 混元
	{26, 88, 3},--任我行 吸星大法
	{27, 105, 3},--东方不败 葵花神功
	{35, 108, 3},--令狐冲 易筋经
	--{36, 105, 3},--林平之 葵花神功
	{37, 94, 3},--狄云 神照功
	{38, 102, 3},--石破天 太玄经
	{39, 103, 3},--龙岛主 龙象
	{40, 101, 3},--木岛主 八荒
	{41, 103, 3},--张三 龙象
	{42, 101, 3},--李四 八荒
	{46, 87, 3},--丁春秋 化功大法
	{47, 87, 3},--阿紫 化功大法
	{48, 188, 3},--游坦之 易筋经
	{49, 98, 3},--虚竹 小无相
	{50, 178, 3},--萧峰 擒龙
	{53, 85, 3},--段誉 北冥神功
	{54, 90, 3},--袁承志 混元功
	{55, 107, 3},--郭靖 九阴
	{56, 6, 3},--黄蓉 碧海
	{57, 6, 3},--黄药师 碧海
	{58, 104, 3},--杨过 玉女
	{59, 121, 3},--小龙女 玉女
	{60, 104, 3},--欧阳锋 逆运真经
	{620, 104, 3},--欧阳锋 逆运真经
	{61, 95, 3},--欧阳克 蛤蟆功
	{62, 103, 3},--金轮法王 龙象
	{594, 103, 3},--金轮法王 龙象
	{63, 6, 3},--程英 碧海
	{64, 100, 3},--周伯通 先天功
	{65, 100, 3},--一灯 先天功
	{66, 93, 3},--小昭 圣火
	{68, 150, 3},--丘处机 先天功
	{69, 178, 3},--洪七公 擒龙功
	{70, 108, 3},--玄慈 易筋经
	--{71, 96, 3},--洪安通 罗汉伏魔功
	--{596, 96, 3},--洪安通 罗汉伏魔功
	{73, 88, 3},--任盈盈 吸星大法
	{78, 6, 3},--梅超风 碧海
	{79, 89, 3},--岳灵珊 紫霞
	{80, 99, 3},--张召忠 纯阳无极
	{82, 99, 3},--宋青书 纯阳无极
	{84, 103, 3},--霍都 龙象
	--{85, 108, 3},--贝海石 易筋经
	{97, 184, 3},--血刀老祖 瑜伽
	{98, 152, 3},--段延庆 天南易阳决
	{102, 152, 3},--枯荣 天南易阳决
	{103, 98, 3},--鸠摩智 小无相
	{595, 98, 3},--鸠摩智 小无相
	{109, 89, 3},--鲜于通 紫霞
	{112, 108, 3},--萧远山 易筋经
	{113, 108, 3},--慕容博 易筋经
	{114, 108, 3},--扫地 易筋经
	{115, 98, 3},--苏星河 小无相
	{116, 98, 3},--无崖子 小无相
	{117, 101, 3},--天山童姥 八荒
	{118, 98, 3},--李秋水 小无相
	{123, 150, 3},--马钰 先天功
	{124, 150, 3},--谭处端 先天功
	{125, 150, 3},--刘处玄 先天功
	{126, 150, 3},--王处一 先天功
	{127, 150, 3},--郝大通 先天功
	{128, 150, 3},--孙不二 先天功
	{129, 100, 3},--王重阳 先天功
	--{140, 90, 3},--风清扬 混元功
	--{160, 103, 3},--达尔巴 龙象
	{161, 121, 3},--李莫愁 玉女
	{166, 204, 3},--班淑娴 太清罡气
	{167, 189, 3},--宗维侠 阴阳磨
	{168, 189, 3},--常敬之 阴阳磨
	{601, 121, 3},--林朝英 玉女剑
	{169, 151, 3},--空闻 金刚不坏
	{170, 96, 3},--空性 罗汉伏魔
	{171, 99, 3},--宋远桥 纯阳无极
	{172, 99, 3},--莫声谷 纯阳无极
	{173, 93, 3},--妙风使 圣火
	{174, 93, 3},--流云使 圣火
	{175, 93, 3},--辉月使 圣火
	{185, 90, 3},--穆人清 混元功
	{189, 90, 3},--萧半和 混元功
	{419, 95, 3},--蛇王 蛤蟆功
	{430, 106, 3},--蛛王 九阳神功
	{440, 107, 3},--蟾王 九阴神功
	{455, 181, 3},--无酒 玄武
	{456, 180, 3},--安七 太虚剑意
	{457, 108, 3},--紫落梵 易筋经
	{516, 180, 3},--宫本 太虚剑意
	{517, 180, 3},--佐佐木 太虚剑意
	{558, 93, 3},--霍山 圣火神功
	{580, 6, 3},--白雕 碧海
	{585, 108, 3},--小二 易筋经
	{592, 203, 3},--独孤求败 怒海剑涛
	{597, 180, 3},--谢无悠 太虚剑
	{599, 107, 3},--黄裳 九阴
	{600, 181, 3},--武无敌 玄武
	{602, 152, 3},--段思平 天南
	{604, 121, 3},--黄衫女 玉女
	{603, 189, 3},--木灵 阴阳磨
	{607, 103, 3},--神雕 龙象
	{608, 93, 3},--大雕 圣火
	{609, 124, 3},--火蟾 寒冰真气
	{610, 101, 3},--玄蟒 八荒
	{611, 96, 3},--古鳄 罗汉伏魔功
	{612, 104, 3},--彩蛛 逆运
	{613, 100, 3},--白猿 先天功
	{615, 108, 3},--达摩 易筋经
	{616, 150, 3},--杨康 金关
	{617, 105, 3},--春风 葵花
	{618, 101, 3},--逍遥子 八荒
	{619, 150, 3},--耶律齐 金关
	{626, 204, 3},--何足道 太清罡气
	{632, 94, 3},--丁典 神照
	{638, 186, 3},--周芷若 峨眉九阳功
	--{639, 103, 3},--赵敏 龙象
	{640, 151, 3},--阿大 金刚不坏
	{641, 151, 3},--阿二 金刚不坏
	--{642, 151, 3},--阿三 金刚不坏
	{643, 124, 3},--玄冥 寒冰
	{644, 124, 3},--玄冥 寒冰
	{662, 108, 3},--水镜四奇 易筋经
	{665, 184, 3},--组长 瑜伽
	{666, 99, 3},--海底捞月 纯阳无极功
	{929, 180, 3},--水镜四奇 易筋经
	--{663, 102, 3},--双儿 太玄神功
	{667, 6, 3},--商御隐 碧海
	{932, 204, 3},--青灵子 太清罡气
}
--天赋内功1
CC.TFNG1={
	{5, 182, 3},--张三丰 太极神功
	{6, 186, 3},--灭绝 峨眉九阳功
	{9, 97, 3},--张无忌 乾坤大挪移
	--{13, 97, 3},--谢逊 乾坤大挪移
	{18, 187, 3},--成昆 少林九阳功
	--{19, 105, 3},--岳不群 葵花神功
	{35, 88, 3},--令狐冲 吸星大法
	{38, 96, 3},--石破天 罗汉伏魔功
	{49, 101, 3},--虚竹 八荒
	{55, 150, 3},--郭靖 金关
	{56, 107, 3},--黄蓉 九阴
	{58, 107, 3},--杨过 九阴
	{59, 107, 3},--小龙女 九阴
	{60, 95, 3},--欧阳锋 蛤蟆功
	{620, 95, 3},--欧阳锋 蛤蟆功
	{64, 107, 3},--周伯通 九阴
	{65, 152, 3},--一灯 天南
	--{69, 107, 3},--洪七公 九阴
	{115, 85, 3},--苏星河 北冥
	{116, 85, 3},--无崖子 北冥
	{118, 85, 3},--李秋水 北冥
	{129, 107, 3},--王重阳 九阴
	{455, 105, 3},--无酒 葵花
	{457, 183, 3},--紫落梵 洗髓经
	{558, 97, 3},--霍山 乾坤大挪移
	{611, 151, 3},--古鳄 金刚不坏体
	{615, 183, 3},--达摩 洗髓经
	--{617, 108, 3},--春风 易筋经
	{618, 98, 3},--逍遥子 小无
	{604, 107, 3},--黄衫女 九阴
	{665, 93, 3},--组长 圣火
	{666, 185, 3},--海底捞月 纯阳无极功
	{667, 102, 3},--商御隐 太玄
}
--天赋轻功
CC.TFQG={
	{1, 116, 1},--胡斐  飞天
	--{3, 116, 1},--苗人凤 飞天
	{5, 115, 3},--张三丰 梯云
	{6, 190, 1},--灭绝 流云追月
	{7, 205, 1},--何太冲 云龙三折
	{9, 115, 1},--张无忌 梯云
	{10, 194, 1},--范遥 暗影迷踪
	{11, 194, 1},--杨逍 暗影迷踪
	{19, 198, 1},--岳不群 君子风
	{27, 196, 1},--东方不败 暗香疏影
	--{29, 118, 1},--田伯光 瞬息千里
	--{37, 117, 1},--狄云 神行百变
	{46, 200, 1},--丁春秋 摘星功
	{47, 200, 1},--阿紫 摘星功
	--{49, 179, 1},--虚竹 凌波微步
	{50, 197, 1},--乔峰 逍遥游身法
	--{51, 119, 1},--慕容复 天罗地网
	{53, 179, 1},--段誉 凌波微步
	{54, 117, 1},--袁承志 神行百变
	{56, 193, 1},--黄蓉 旋风扫叶腿
	{57, 193, 3},--黄药师 旋风扫叶腿
    {58, 119, 1},--杨过 天罗地网
	{601, 119, 3},--小龙女 天罗地网
	{59, 119, 1},--小龙女 天罗地网
	{60, 118, 1},--欧阳锋 瞬息千里
	{620, 118, 1},--欧阳锋 瞬息千里
	{61, 118, 1},--欧阳克 瞬息千里
	{65, 199, 1},--一灯 龙行虎步
	{69, 197, 1},--洪七公 逍遥游身法
	{73, 196, 1},--任盈盈 暗香疏影
	--{70, 143, 1},--玄慈 一苇渡江
	--{76, 143, 1},--王语嫣 一苇渡江
	{80, 115, 1},--张召忠 梯云
	{82, 115, 1},--宋青书 梯云
	{93, 191, 1},--唐萌浅 追魂无影
	{98, 199, 1},--段延庆 龙行虎步
	{109, 198, 1},--鲜于通 君子风
	{114, 143, 1},--扫地 一苇渡江
	{129, 192, 1},--王重阳 金雁功
	{161, 119, 1},--李莫愁 天罗地网
	--{164, 119, 1},--谢烟客 天罗地网
	{166, 205, 1},--班淑娴 云龙三折
	{171, 115, 1},--宋远桥 梯云
	{172, 115, 1},--莫声谷 梯云
	{184, 117, 1},--玉真子 神行百变
	{456, 117, 1},--安七 神行百变
	{457, 143, 1},--紫落梵 一苇渡江
	{516, 115, 1},--宫本 梯云
	{517, 115, 1},--佐佐木 梯云
	{558, 194, 3},--霍山 暗影迷踪
	{589, 195, 1},--水笙 踏雪无痕
	--{590, 117, 1},--李文秀 神行百变
	--{591, 116, 1},--石中玉 飞天神行
	--{594, 118, 1},--鸠摩智 瞬息千里
	--{596, 119, 1},--洪安通 天罗地网
	{597, 115, 1},--谢无悠 梯云纵
	{615, 143, 1},--达摩 一苇渡江
	{621, 116, 1},--胡一刀 飞天
	{664, 117, 1},--韦小宝 神行百变
	{629, 117, 1},--阿九 神行百变
	{115, 179, 1},--苏星河 凌波
	{116, 179, 1},--无崖子 凌波
	{117, 179, 1},--天山童姥 凌波
	{118, 179, 1},--李秋水 凌波
	{602, 199, 1},--段思平 龙行虎步
	{604, 119, 1},--黄衫女 天罗地网
	{618, 179, 1},--逍遥子 凌波
	{626, 205, 1},--何足道 云龙三折
	--{632, 119, 1},--丁典 天罗地网
	--{663, 179, 1},--双儿 凌波微步
	{665, 195, 1},--组长 踏雪无痕
	{666, 118, 1},--海底捞月 瞬息千里
	{667, 193, 1},--商御隐 旋风扫叶
	{929, 115, 1},--森九岚 梯云纵横
	{932, 205, 1},--青灵子 云龙三折
}
CC.JCLW={
	{1, 1},--罗汉 基础拳法
	{155, 1},--五指秘刀 基础拳法
	{30, 2},--五岳 基础剑法
	{31, 2},--五岳 基础剑法
	{32, 2},--五岳 基础剑法
	{33, 2},--五岳 基础剑法
	{34, 2},--五岳 基础剑法
	{63, 3},--血刀 基础刀法
	{155, 3},--五指秘刀 基础刀法
	{77, 2},--阴阳倒乱刃 基础剑法
	{77, 3},--阴阳倒乱刃 基础刀法
	{77, 4},--阴阳倒乱刃 基础特系
	{58, 3},--修罗刀 基础刀法
	{57, 3},--慈悲刀 基础刀法
}
-------------------------------------------------
CC.COMBO = {
	{1, 2, "飞雪情侠"},
	{4, 72, "狼狈为奸"},
	{37, 38, "赤诚仁心"},
	{47, 48, "铁怪毒娇"},
	{51, 76, "姑苏表亲"},
	{53, 76, "仙洞眷侣"},
	{90, 582, "灵婉双娇"},
	{55, 56, "铁血丹心"},
	{87, 86, "鹿鼎双妹"},
	{35, 73, "剑胆琴心"},
	{36, 79, "苦命鸳鸯"},
	{75, 74, "巾帼红花"},
	{58, 59, "神雕侠侣"},
	{9, 66, "倚天奇情"},
	{16, 17, "蝶谷怪医"},
	{54, 91, "碧血情天"},
	{88, 89, "酒食为天"},
	{35, 58, "独孤传人"},
	{83, 25, "五毒五仙"},
	{35, 29, "酒肉冤家"},
	{0, 92, "前尘如梦"},
	{37, 589, "雪山隐士"},
	{38, 661, "金乌玉兔"},
	{29, 591, "风流浪荡"},
	{10, 11, "逍遥二仙"},
	{162, 163, "不三不四"},
	{60, 61, "雪山白驼"},
	{620, 61, "雪山白驼"},
	{51, 113, "燕国遗脉"},
	{50, 112, "大辽战神"},
	{3, 621, "刀剑双绝"},
	{632, 633, "人淡如菊"},
	{616, 635, "情义无解"},	
	{77, 625, "女貌郎才"},		
	{643, 644, "玄冥二老"},	
	{663, 664, "义重情深"},	
	{9, 638, "情深不寿"},
	{9, 639, "张郎画眉"},
	{50, 104, "情天可补"}, --武骧金星：增加一个几乎不会出现的
	--{, , ""},

}
		
--武器对武功杀气加成
CC.WPSQ = {
	{40, 40, 100}, --金蛇+金蛇
	{45, 67, 120}, --冷月+胡刀
}

--武器与武功搭配必连击
CC.WPLJ = {

}

--武器与武功搭配必暴击
CC.WPBJ = {

}		

dofile (CONFIG.ScriptPath .."data.lua");

  CC.PersonAttribMax = {}
  CC.PersonAttribMax["经验"] = 60000
  CC.PersonAttribMax["物品修炼点数"] = 30000
  CC.PersonAttribMax["修炼点数"] = 30000
  CC.PersonAttribMax["生命最大值"] = 1500
  CC.PersonAttribMax["受伤程度"] = 100
  CC.PersonAttribMax["中毒程度"] = 100
  CC.PersonAttribMax["内力最大值"] = 5000
  CC.PersonAttribMax["体力"] = 100
  CC.PersonAttribMax["攻击力"] = 999 --600 武骧金星：调整属性最大值
  CC.PersonAttribMax["防御力"] = 999 --600
  CC.PersonAttribMax["轻功"] = 999 --600
  CC.PersonAttribMax["医疗能力"] = 250
  CC.PersonAttribMax["用毒能力"] = 250
  CC.PersonAttribMax["解毒能力"] = 250
  CC.PersonAttribMax["抗毒能力"] = 250
  CC.PersonAttribMax["拳掌功夫"] = 999 --240
  CC.PersonAttribMax["御剑能力"] = 999 --240
  CC.PersonAttribMax["耍刀技巧"] = 999 --240
  CC.PersonAttribMax["特殊兵器"] = 999 --240
  CC.PersonAttribMax["暗器技巧"] = 999 --240
  CC.PersonAttribMax["武学常识"] = 100
  CC.PersonAttribMax["品德"] = 100
  CC.PersonAttribMax["资质"] = 100
  CC.PersonAttribMax["攻击带毒"] = 250
  CC.PersonAttribMax["友好度"] = 100
  CC.PersonAttribMax["实战"] = 500
  CC.NewPersonName = "徐小侠"
  CC.NewGameSceneID = 70
  CC.NewGameSceneX = 16
  CC.NewGameSceneY = 31
  CC.NewGameEvent = 691
  CC.NewPersonPic = 2515
  CC.LoadThingPic = 1
  CC.StartThingPic = 4131
  CC.forg = false
  CC.KRP = ".\\data\\kdef.grp"
  CC.KDX = ".\\data\\kdef.idx"
  CC.TRP = ".\\data\\talk.grp"
  CC.TDX = ".\\data\\talk.idx"
  CC.MapKind = (CONFIG.DrawMini or 0)
  CC.MapSize = 16
  --队友攻击加成
CC.AddAtk = {
{10, 15, 50}, 
{11, 15, 50}, 
{12, 15, 50}, 
{13, 15, 50}, 
{14, 15, 50}, 
{48, 47, 100}, 
{47, 50, 100}, 
{53, 76, 100}, 
{79, 36, 60}, 
{74, 75, 50}, 
{59, 58, 100}, 
{54, 91, 100}, 
{99, 70, 100}, 
{119, 65, 50}, 
{120, 65, 50}, 
{121, 65, 50}, 
{122, 65, 50}, 
{68, 129, 50}, 
{123, 129, 50}, 
{124, 129, 50}, 
{125, 129, 50}, 
{126, 129, 50}, 
{127, 129, 50}, 
{128, 129, 50},
{37, 589, 50},		--狄云、水笙在场，攻各加50
{589, 37, 50},
{635, 616, 80},
{632, 633, 100},
{77, 625, 100},	
{631, 9, 60},	
{134, 136, 70},	
{136, 134, 30},	
{639, 9, 50}, 
{9, 639, 50},
{0, 655, 50}, --武骧金星：补全仙剑主角情侣加成 
}

--队友防御加成
CC.AddDef = {
{76, 51, 100}, 
{55, 56, 50}, 
{56, 55, 100}, 
{35, 73, 100}, 
{79, 36, 60}, 
{73, 35, 50}, 
{74, 75, 50}, 
{58, 59, 50}, 
{59, 58, 50}, 
{66, 9, 50}, 
{9, 66, 50}, 
{91, 54, 100}, 
{119, 65, 50}, 
{120, 65, 50}, 
{121, 65, 50}, 
{122, 65, 50}, 
{68, 129, 50}, 
{123, 129, 50}, 
{124, 129, 50}, 
{125, 129, 50}, 
{126, 129, 50}, 
{127, 129, 50}, 
{128, 129, 50},
{37, 589, 50},			--狄云、水笙在场，防各加50
{589, 37, 50},
{633, 632, 100},
{1, 636, 50},
{0, 656, 50},
}

--队友速度加成
CC.AddSpd = {
{25, 35, 50}, 
{90, 53, 50},
{582, 53, 50}, --武骧金星：补全木婉清加成 
{55, 56, 100}, 
{56, 55, 50}, 
{35, 79, 100}, 
{73, 35, 50}, 
{74, 75, 50}, 
{58, 59, 100}, 
{63, 58, 60}, 
{83, 54, 50},
{37, 589, 50},
{589, 37, 50},			--狄云、水笙在场，轻各加50
{625, 77, 100},	
{627, 58, 50},	
{616, 635, 50},
{134, 136, 30},	
{136, 134, 70},	
{638, 9, 50}, 
{9, 638, 50},
{0, 657, 50}, 
}
  CC.AddDoc = {
{2, 1, 120}, 
{16, 17, 50}}
  CC.AddPoi = {
{17, 16, 50}}
  CC.Timer = {stime = 0, status = 0, str = "", len = 0, fun = demostr}
  
  CC.RUNSTR = {
	"请不要随意使用你不知其所以然的DIY文件", 
	"为了避免BUG，请不要随意在场景内使用快捷键传送", 
	"请经常手动存档，不要相信自动档，另外存档时尽量使用前面的", 
	"如果游戏跳出，请第一时间汇报游戏目录下的DEBUG.txt文件",
	"请不要给027学北冥神功", 
	"多培养一些队友，可以让你后面的战斗更轻松", 
	"主角各系天赋的终极技都非常强大", 
	"和人对话时请尽量站在对方的正面  否则很没礼貌", 
	"每打通一个周目可以获得新的技能点",
	"飞雪连天射白鹿  笑书神侠倚碧鸳  红尘有你终相伴  笑傲江湖情两牵", 
	}
end

--程序主函数入口
function JY_Main()
  os.remove("debug.txt")
  xpcall(JY_Main_sub, myErrFun)
end--主函数
function JY_Main_sub()
  IncludeFile()
  help.playersetting.myInit_1step()
  --IncludeFile()     --加载文件
  SetGlobalConst()  --设置全局常量
  SetGlobal()   --设置全局变量
  GenTalkIdx()  --生成对话文件索引
  SetModify()   --设置修改
  help.playersetting.myInit_2step()
  setmetatable(_G, {__newindex = function(_, n)
    error("attempt read write to undeclared variable " .. n, 2)
  end, __index = function(_, n)
    error("attempt read read to undeclared variable " .. n, 2)
  end})
  lib.Debug("JY_Main start.")
  math.randomseed(os.time())
  lib.EnableKeyRepeat(CONFIG.KeyRepeatDelay, CONFIG.KeyRePeatInterval)
  JY.Status = GAME_START
   local ff = "title"..math.random(12)..".png"
   ff = "title"..math.random(12)..".png"
  ff = "title"..math.random(12)..".png"
CC.FirstFile = CONFIG.PicturePath .. ff
  lib.PicInit(CC.PaletteFile)
  Cls()
  PlayMIDI(30)
  lib.PicLoadFile(CC.HeadPicFile[1], CC.HeadPicFile[2], 1)
  lib.PicLoadFile(CC.EffectFile[1], CC.EffectFile[2], 3)
  lib.PicLoadFile(CC.BigHead[1], CC.BigHead[2], 55, 110)
  lib.PicLoadFile(string.format(CC.FightPicFile[1], 35), string.format(CC.FightPicFile[2], 35), 4)
  lib.PicLoadFile(string.format(CC.FightPicFile[1], 50), string.format(CC.FightPicFile[2], 50), 5)
  lib.PicLoadFile(CC.WpPic[1], CC.WpPic[2], 2)
  lib.PicLoadCache(2, 339 * 2, (CC.ScreenW - 4 * CC.StartMenuFontSize - 2 * CC.MenuBorderPixel) / 2-90, CC.StartMenuY + 60)
  lib.PicLoadCache(2, 339 * 2, (CC.ScreenW - 4 * CC.StartMenuFontSize - 2 * CC.MenuBorderPixel) / 2+90, CC.StartMenuY + 60)
  lib.PicLoadCache(2, 339 * 2, (CC.ScreenW - 4 * CC.StartMenuFontSize - 2 * CC.MenuBorderPixel) / 2+270, CC.StartMenuY + 60)
  local menu = {
{"始     ", nil, 1}, 
{"临     ", nil, 1}, 
{"归", nil, 1}}
  local menux = (CC.ScreenW - 4 * CC.StartMenuFontSize - 2 * CC.MenuBorderPixel) / 2
  --DrawString(720, 580, CC.EVB107, C_GOLD, 20)
  local menuReturn = ShowMenu2(menu, 3, 0, menux-120, CC.StartMenuY + 30, 0, 0, 0, 0, 50, C_STARTMENU, C_GOLD)
  --local menuReturn = ShowMenu(menu, 3, 0, menux, CC.StartMenuY + 30, 0, 0, 0, 0, 35, C_GOLD, C_WHITE)
  if menuReturn == 1 then
    ClsN()
    PlayMIDI(31)
    ShowScreen()
    --STARTDH()    --加载贴图文件
    JY.Status = GAME_START2
	--dofile(CONFIG.ScriptPath .. "CatDIY.lua")
    SBLNewGame()
	if JY.Person[zj()]["性别"] == 1 then
		addevent(41, 3, 1, 1082, 1, 2522*2)
	end
	Cls()
	DrawStrBoxWaitKey("游戏初始化完毕 请按任意键继续", C_GOLD, 40)
    JY.SubScene = CC.NewGameSceneID
    JY.Base["人X1"] = CC.NewGameSceneX
    JY.Base["人Y1"] = CC.NewGameSceneY
    JY.MyPic = CC.NewPersonPic
	if JY.Person[0]["性别"] == 1 then JY.MyPic = 4669 end
    lib.ShowSlow(50, 1)
    JY.Status = GAME_SMAP
    JY.MmapMusic = -1
    CleanMemory()
	lib.PicInit()--
    Init_SMap(0)
    Cls()
    if (JY.Thing[203][WZ6] or 0) < 2 then
		if DrawStrBoxYesNo(-1, -1, CC.s71, C_WHITE, 30) == true then    --是否观看开始动画
			oldCallEvent(CC.NewGameEvent)
		end
	else
      OEVENTLUA[691]()
    end
	setteam(662, 1)
	setLW1(0)
	if (JY.Thing[203][WZ6] or 0) >= 2 then
		if DrawStrBoxYesNo(-1, -1, "恭喜您进入高周目游戏，要领取奖励礼包么？", C_WHITE, 30) == true then
			setteam(104, 1)
			setteam(582, 1)
			setteam(627, 1)
			setteam(661, 1)
			setteam(663, 1)
			--addthing(278)
			--addthing(299)
			addthing(321)
			addthing(327)
			addthing(328)
			--addthing(335)
			addHZ(84)
			addHZ(85)
			addHZ(92)
			addthing(20,99)
			addthing(25,99)
			--SetS(52, 0, 0, 5, 1000)
        end
		SetS(70, 18, 34, 3, 120)
		instruct_3(70,120,1,0,8501,0,0,5118,5118,5118,0,0,0)
		instruct_3(42, 1, -2, 0, 5003, 0, 0, -2, -2, -2, -2, -2, -2)
    end
	
	if not (XYL(0) or cxzj() == 597 or cxzj() == 929) then
	    instruct_3(113, 1, 1, 0, 5002, 0, 0, 9424, 9424, 9424, -2, 13, 15) --加贴图 --1-26-
	end
	instruct_3(113, 2, 1, 0, 5006, 0, 0, 9398, 9398, 9398, -2, 13, 13) --加贴图 --1-26-
	instruct_3(113, 3, 0, 0, 0, 0, 5008, 0, 0, 0, -2, 28, 31) --加贴图 --1-26-
	instruct_3(80, 151, 0, 0, 0, 0, 5005, 0, 0, 0, -2, 15, 30) --加贴图 --1-26-
	instruct_3(111, 15, 0, 0, 0, 0, 5059, 0, 0, 0, -2, 37, 35) --箫半和
	if JY.Person[0]["性别"] == 1 then addHZ(62) end
	if putong() == 10 then addHZ(97) end
	if T3XYK(0) then addHZ(99) addHZ(101) end
	if putong() == 7 then addHZ(128) end
	if putong() == 12 then addHZ(160) end
	if T8LXY(0) then addHZ(129) end
	if T6XQS(0) then addHZ(130) end
	if putong() == 6 then addHZ(131) end
	if putong() == 7 then addHZ(147) end
	if putong() == 13 then addHZ(148) end
	if putong() == 12 then addHZ(132) end
	if putong() == 5 then JY.Person[0]["内力性质"] = 3 end
	if XYL(0) or cxzj() == 929 then
	    instruct_2(268) 
	    instruct_2(340)
	end
	if T4WXS(0) then
		DrawStrBoxWaitKey("请选择第二天赋外功", C_WHITE, 30)
		--DrawStrBoxWaitKey("请选择性别", C_WHITE, 30)
			local mm = {
				{"  拳  ", nil, 1},
				{"  剑  ", nil, 1},	
				{"  刀  ", nil, 1},
				{"  特  ", nil, 1},
				{"  暗  ", nil, 1},
			}
			Cls()
			local aa = ShowMenu3(mm,#mm,1,-2,-2,-2,-2,1,0,24,C_GOLD,C_WHITE,nil, nil,M_DimGray,C_RED)
		local list = {}
		local x1 = CC.MainSubMenuX
		local y1 = CC.MainSubMenuY		
			if aa == 1 then
				list = {1,3,4,5,7,8,9,10,11,12,13,14,15,16,17,19,20,21,22,23,24,25,26,126,127,128,129,130,132,133}
			elseif aa == 2 then
				list = {27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45,46,47,48,49,114,123,125,134,135,136,137,154}
			elseif aa == 3 then
				list = {50,51,52,53,54,55,56,57,58,59,60,61,62,63,64,65,66,67,138,139,140,141,155,156,157}
			elseif aa == 4 then
				list = {68,69,70,71,72,73,74,75,76,77,78,79,80,81,82,83,84,86,120,142,144,145,146,147,202}
			elseif aa == 5 then
				list = {148,149,158,159,160,161,162,163,164,165,166,167,168,169,170,171,172,173,174,18,175,176,177}
			end
		local menu = {}
		for i = 1, #list do
			menu[i] = {JY.Wugong[list[i]]["名称"], nil, 1}
		end
		local r = ShowMenu(menu,#menu,15,x1,y1+CC.SingleLineHeight,0,0,1,1,CC.DefaultFont,C_ORANGE,C_WHITE);
		SetS(112,4,0,0,list[r])
	end
	if T9ZY(0) then	
		JY.Person[0]["声望"] = -1	
	end	
	if NF(0) then
	    instruct_2(65)
	    instruct_2(75) 
	    instruct_2(315)
		addHZ(35)
		SetS(113,0,0,0,98)
	end
	if BJY(0) then
	    instruct_2(65)
	    instruct_2(269) 
		addHZ(47)
	end
	if FHXX(0) then
	    JY.Person[0]["声望"] = 102 
	    JY.Person[0]["外号"] = 108
	    JY.Person[0]["武功1"] = 47
	    JY.Person[0]["武功等级1"] = 999
	    JY.Person[0]["武功等级2"] = 999
	    JY.Person[0]["武功2"] = 119
	end
	JY.Base["点数"] = 0
	JY.Base["宠物"] = 0
	addevent(70, 81, 1, 8007, 1, 7028)
    for i = 5, 7 do
        SetD(70, 2, i, 8738)
        SetD(104, 88, i, 8738)
    end
	if (JY.Thing[203][WZ6] or 0) < 2 then
		say("在你踏入江湖之前，我来给你些提示吧。",228,0,"小二")
		if DrawStrBoxYesNo(-1, -1, "要听说明么？", C_WHITE, 30) == true then
			say("你房间里那位穿着黄衫的老管家是位百事通，有什么疑问都可以去找他，他还能做很多其他事情，比如说可以找人来帮你练功。",228,0,"小二")
			say("如果累了想歇歇的话，找你房间里的丫头就好。",228,0,"小二")
			say("建议你先去找些会武功的人帮忙，否则你现在啥功夫不会，想练功都没办法。",228,0,"小二")
			say("有些武林人士加入你之后不会住在小村，如果需要他们的帮助就来找我，我就站在你房间外面。",228,0,"小二")
			say("我有个双胞胎兄弟在村里经营决斗场，不过他最近得罪了村长，场子被封了。可别把我和这彪子搞错了啊。",228,0,"小二")
			say("靠近村口有山西同福商号的两位管事，有什么用不到的东西可以去卖给他们换点银两，他们也经营药材和粮食批发业务。",228,0,"小二")
			say("村里有个灶台和药炉，想要喝两盅或者自己捣鼓点药品就去那儿吧，练武人总得有那么几个压箱底方子。",228,0,"小二")
			say("反正你一开始要去送介绍信，不如坐马车去吧。想坐马车可以找百事通，或者在大地图上使用＜系统＞菜单里的＜马车传送＞",228,0,"小二")
			say("交完介绍信以后，可以去院子里找那位穿着绿色衣服的姑娘唠唠――但在此之前，你可千万别随便乱拿别人家的东西啊！",228,0,"小二")
		end
	end
  elseif menuReturn == 2 then
    Cls()
  lib.PicLoadFile(CC.WpPic[1], CC.WpPic[2], 2)
  lib.PicLoadCache(2, 339 * 2, (CC.ScreenW - 4 * CC.StartMenuFontSize - 2 * CC.MenuBorderPixel) / 2-90, CC.StartMenuY + 60)
  lib.PicLoadCache(2, 339 * 2, (CC.ScreenW - 4 * CC.StartMenuFontSize - 2 * CC.MenuBorderPixel) / 2+90, CC.StartMenuY + 60)
  lib.PicLoadCache(2, 339 * 2, (CC.ScreenW - 4 * CC.StartMenuFontSize - 2 * CC.MenuBorderPixel) / 2+270, CC.StartMenuY + 60)
    local loadMenu = {
{"一     ", nil, 1}, 
{"二     ", nil, 1}, 
{"三", nil, 1}}
    local menux = (CC.ScreenW - 3 * CC.StartMenuFontSize - 2 * CC.MenuBorderPixel) / 2
    local r = ShowMenu2(loadMenu, 3, 0, menux-140, CC.StartMenuY + 30, 0, 0, 0, 0, 50, C_STARTMENU, C_GOLD)
    Cls()
    DrawString(menux, CC.StartMenuY + 60, "请稍候...", C_GOLD, 35)
    ShowScreen()
    SBLDATAL(r)
    Cls()
    if YC_Status() == 0 then
		YC_Exit()
    elseif JY.Base["无用"] ~= -1 then   --是否处在子场景
      JY.Status = GAME_SMAP
      JY.SubScene = JY.Base["无用"]
      JY.MmapMusic = -1
      JY.MyPic = GetMyPic()
      Init_SMap(1)
    else
      JY.SubScene = -1
      JY.Status = GAME_FIRSTMMAP
    end
    ShowScreen()
  elseif menuReturn == 3 then
    return 
  end
  --lib.LoadPicture("", 0, 0)
  lib.GetKey()
  Game_Cycle()
end--选择框，每个选项都带边框
--title 标题
--str 内容 *换行
--button 选项
--num 选项的个数，一定要和选项对应起来
--headid 显示在内容左边的贴图，如果不传值则不显示贴图
function JYMsgBox(title, str, button, num, headid)
	
  local strArray = {}
  local xnum, ynum, width, height = nil, nil, nil, nil
  local picw, pich = 100, 0
  local x1, x2, y1, y2 = nil, nil, nil, nil
  local size = CC.DefaultFont;
	headid = nil
  if headid ~= nil then
  	--蓝烟清：主角头像显示
  	if headid == 0 then
  		headid = gethead(headid)
  	end
    headid = headid * 2
    picw, pich = lib.PicGetXY(1, headid)
    picw = picw + CC.MenuBorderPixel * 2
    pich = pich + CC.MenuBorderPixel * 2
  end
  ynum, strArray = Split(str, "*")
  xnum = 0
  for i = 1, ynum do
    local len = string.len(strArray[i])
    if xnum < len then
      xnum = len
    end
  end
  if xnum < 12 then
    xnum = 12
  end
  width = CC.MenuBorderPixel * 2 + math.modf(size * xnum / 2) + (picw)
  height = CC.MenuBorderPixel * 2 + (size + CC.MenuBorderPixel) * ynum
  if height < pich then
    height = pich
  end
  y2 = height
  height = height + CC.MenuBorderPixel * 2 + size * 2
  x1 = (CC.ScreenW - (width)) / 2 + CC.MenuBorderPixel
  x2 = x1 + (picw / 2)
  y1 = (CC.ScreenH - (height)) / 2 + CC.MenuBorderPixel + 2 + size * 0.7
  y2 = y2 + (y1) - 5
  local select = 1
  
  local surid = lib.SaveSur((CC.ScreenW - (width)) / 2 - 4, (CC.ScreenH - (height)) / 2 - size, (CC.ScreenW + (width)) / 2 + 4, (CC.ScreenH + (height)) / 2 + 4)
  lib.LoadSur(surid, (CC.ScreenW - (width)) / 2 - 4, (CC.ScreenH - (height)) / 2 - size)
  DrawBoxTitle(width, height, title, C_GOLD)
  if headid ~= nil then
    lib.PicLoadCache(1, headid, x1, y1, 1, 0)
  end
  for i = 1, ynum do
    DrawString(x2, y1 + (CC.MenuBorderPixel + size) * (i - 1), strArray[i], C_WHITE, size)
  end
  
  while true do
	  for i = 1, num do
	    local color, bjcolor = nil, nil
	    if i == select then
	      color = M_Yellow
	      bjcolor = M_DarkOliveGreen
	    else
	      color = M_DarkOliveGreen
	    end
	    DrawStrBox2((CC.ScreenW - (width)) / 2 + (width) * i / (num + 1) - string.len(button[i]) * size / 4, y2, button[i], color, size, bjcolor)
	  end
	  ShowScreen()
	  
	  local key = WaitKey()
	  if key == VK_LEFT then
	    select = select - 1
	    if select < 1 then
	      select = num
	    end
	  elseif key == VK_RIGHT then
	    select = select + 1
	    if num < select then
	      select = 1
	    end
	  elseif key == VK_RETURN or key == VK_SPACE then
	    break;
	  end
	end
  
  select = limitX(select, 1, num)
	lib.LoadSur(surid, (CC.ScreenW - (width)) / 2 - 4, (CC.ScreenH - (height)) / 2 - size)
	ShowScreen()
	lib.FreeSur(surid)
	return select
end--简易信息

--判断一个人是否可以装备或修炼一个物品
--返回 true可以修炼，false不可
function CanUseThing(id, personid)
  local str = ""
  if JY.Thing[id]["练出武功"] >= 0 then --武骧金星：不适用的人物不显示
    local yes = 0
    local full = 1
    for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
      if JY.Person[personid]["武功" .. i] == JY.Thing[id]["练出武功"] and id ~= 268 then
        yes = 1
      else
        if JY.Person[personid]["武功" .. i] == 0 then
          full = 0
        end
      end
    end
	if yes == 1 then return true end
	if full == 1 then return false end
  end 
	if id == 254 and MPPD(personid) == 3 then 
		return true
	end
  if id == 254 and JY.Person[personid]["性别"] ~= 1 then --玉女心经限制女人
	return false
	end
  if (id >= 238 and id <= 242) or id == 280 or id == 339 or (id >= 351 and id <= 360) then
	if personid == 0 and putong() == 10 then
		return true
	end
  end
  --12.26
  if id == 268 and (XYL(personid) or SJL(personid) or DT(personid,597)) then
	return true
  end
  if id == 340 and (XYL(personid) or SJL(personid) or DT(personid,597)) then
	return true
  end
  if id == 268 and not (XYL(personid) or SJL(personid) or DT(personid,597)) then
	return false
  end
	--无酒不欢：逍遥子不能练341号
	if id == 341 and DT(personid,618) then	
		return false
	end
	--12.26
  if (hasHZ(88) or hasTF(personid, 88)) and JY.Thing[id]["类型"] == 2 and JY.Thing[id]["练出武功"] > 0 and id ~= 268 then --hasTF(personid, 88) 武骧金星：免去换印信的麻烦
    return true
  elseif DT(personid, 636) and JY.Thing[id]["类型"] == 2 and JY.Thing[id]["练出武功"] > 0 and
	JY.Wugong[JY.Thing[id]["练出武功"]]["等级"] <= 8 then
	return true
  elseif (id == 220 or id == 221) and personid == 0 then
    return true
  elseif id > 186 and id < 194 and DT(personid , 44) then
    return true
  elseif id == 114 and personid == 0 and putong() == 2 and JY.Person[personid]["御剑能力"] > 99 then
    return true
	elseif id == 114 and personid == 0 and (T6XQS(0) or T7DFWM(0) or T8LXY(0)) and JY.Person[personid]["御剑能力"] > 99 then --萧秋水和东方未明和李逍遥可以修炼九剑
		return true
	--elseif id == 114 and personid == 614 and JY.Person[personid]["御剑能力"] > 99 then
	--	return true
	elseif id == 86 and personid == 0 and putong() == 1 and JY.Person[personid]["拳掌功夫"] > 119 then
		return true
	elseif id == 87 and personid == 0 and putong() == 1 and JY.Person[personid]["拳掌功夫"] > 99 then
		return true
	elseif id == 168 and personid == 0 and putong() == 4 and JY.Person[personid]["特殊兵器"] > 99 then
		return true
	elseif id==97 and DT(personid,82) and JY.Person[personid]["拳掌功夫"] >= math.modf(JY.Thing[id]["需拳掌功夫"]/2) then --宋青书修炼太极拳/剑需要减半
		return true
	elseif id==115 and DT(personid,82) and JY.Person[personid]["御剑能力"] >= math.modf(JY.Thing[id]["需御剑能力"]/2) then
		return true
  else	
	if (id>=238 and id<=242) or id == 280 or id == 339 or (id>=351 and id<=360) or id == 111 or id == 369 then --轻功只能练一个
		if PersonKF(personid,115) or PersonKF(personid,116) or PersonKF(personid,117) or PersonKF(personid,118) or PersonKF(personid,119) 
			or PersonKF(personid,143) or PersonKF(personid,179) or PersonKF(personid,190) or PersonKF(personid,191) 
			or PersonKF(personid,192) or PersonKF(personid,193) or PersonKF(personid,194) or PersonKF(personid,195) 
			or PersonKF(personid,196) or PersonKF(personid,197) or PersonKF(personid,198) or PersonKF(personid,199) or PersonKF(personid,200) 
			or PersonKF(personid,205) then
			return false
		end
	end
    if JY.Thing[id]["仅修炼人物"] >= 0 and JY.Thing[id]["仅修炼人物"] ~= personid then
      return false
    end
	if JY.Thing[id]["需内力性质"] ~= 2 and JY.Person[personid]["内力性质"] ~= 2 
		and JY.Thing[id]["需内力性质"] ~= JY.Person[personid]["内力性质"] then
		if DT(personid, 92) and not T8LXY(0) then
		
		elseif hasHZ(86) or hasTF(personid, 86) then --hasTF(personid, 86) 武骧金星：免去换印信的麻烦
		
		elseif wglw(personid,99) or DT(personid, 5) then
		
		elseif JY.Person[personid]["内力性质"] == 3 then
		
		else
			return false
		end
	end
	
    if JY.Person[personid]["内力最大值"] < JY.Thing[id]["需内力"] then
      return false
    end
    if JY.Person[personid]["攻击力"] < JY.Thing[id]["需攻击力"] then
      return false
    end
    if JY.Person[personid]["轻功"] < JY.Thing[id]["需轻功"] then
      return false
    end
    if JY.Person[personid]["用毒能力"] < JY.Thing[id]["需用毒能力"] then
      return false
    end
    if JY.Person[personid]["医疗能力"] < JY.Thing[id]["需医疗能力"] then
      return false
    end
    if JY.Person[personid]["解毒能力"] < JY.Thing[id]["需解毒能力"] then
      return false
    end
    

		--第三版本，小无相功减少修炼所需兵器值，每级减少一点
	local lv = 0;
  --[[	for i=1, 10 do
  		if JY.Person[personid]["武功"..i] == 98 then
  			lv = math.modf(JY.Person[personid]["武功等级"..i]/100) + 1;
  			break;
  		end
  	end]]
	if PersonKF(personid, 98) then
		lv = 10
	end
  	--lv = limitX(lv, 0, 10);
	--组合练了一个另一个减10
    	--[[
		玄冥91 21 火刀135 66
		须弥88 24 伏魔杖168 86
		苗剑117 44 胡刀136 67
		]]
	if (id == 91 and PersonKFJ(personid, 66)) or (id == 135 and PersonKFJ(personid, 21)) then
		lv = lv + 20
	end
	if (id == 88 and PersonKFJ(personid, 86)) or (id == 168 and PersonKFJ(personid, 24)) then	
		lv = lv + 20
	end
	if (id == 117 and PersonKFJ(personid, 67)) or (id == 136 and PersonKFJ(personid, 44)) then	
		lv = lv + 20
	end
	
	--if hasHZ(88) then --无相印13 武骧金星：修正这里的错误
	--	lv = lv + 10
	--end
	
	if T3XYK(personid) then
		lv = lv + limitX(math.modf(JY.Person[personid]["实战"] / 15), 0, 30)
	end	
	
	if DT(personid, 10) then
		lv = 20
	end
	
  for i,v in ipairs(CC.TFWG) do --1-29-
    if ((v[1] == personid) or (v[1] == cxzj() and personid == 0)) and v[2] == JY.Thing[id]["练出武功"] then
      lv = lv + 40
	  break
    end
  end
  --天赋武功12.26
  if personid == 0 and (putong() > 0 or teshu() > 0) and (JY.Thing[id]["练出武功"] == GetS(112,1,0,0) or JY.Thing[id]["练出武功"] == GetS(112,4,0,0))then
	  lv = lv + 40				
  end--12.26
  --天赋武功12.26
  if personid == 92 and JY.Thing[id]["练出武功"] == JY.Person[578]["攻击力"] then
	  lv = lv + 40
  end
  --天赋武功12.26
  for i,v in ipairs(CC.TFWG1) do
    if ((v[1] == personid) or (v[1] == cxzj() and personid == 0)) and v[2] == JY.Thing[id]["练出武功"] then
      lv = lv + 40
	  break
    end
  end --1-29-
  
	if JY.Person[personid]["拳掌功夫"] + lv < JY.Thing[id]["需拳掌功夫"] then
      return false
    end
    if JY.Person[personid]["御剑能力"] + lv  < JY.Thing[id]["需御剑能力"] then
      return false
    end
    if JY.Person[personid]["耍刀技巧"] + lv  < JY.Thing[id]["需耍刀技巧"] then
      return false
    end
    if JY.Person[personid]["特殊兵器"] + lv < JY.Thing[id]["需特殊兵器"] then
      return false
    end
    if JY.Person[personid]["暗器技巧"] + lv < JY.Thing[id]["需暗器技巧"] then
      return false
    end
  
    if JY.Thing[id]["需资质"] >= 0 then --山洞mm修炼物品无视资质
      if JY.Thing[id]["需资质"] > JY.Person[personid]["资质"] and (not DT(personid, 92)) and (not (hasHZ(87) or hasHZ(88) or hasTF(personid, 87) or hasTF(personid, 88))) then --hasTF(personid, 87) and not hasHZ(15) 武骧金星：免去换印信的麻烦
          return false;
      end
    else
    	if -JY.Thing[id]["需资质"] < JY.Person[personid]["资质"] and (not DT(personid, 92)) and (not (hasHZ(87) or hasHZ(88) or hasTF(personid, 87) or hasTF(personid, 88))) then
      	return false;
     	end 
    end
    
    if JY.Person[personid]["姓名"] == CC.s10 then       --SYP不可修练
      return false
    end
  end
  
  --斗转限制
  if id == 118 then
    local R = JY.Person[personid]
    local wp = JY.Person[personid]["拳掌功夫"] + JY.Person[personid]["御剑能力"] + 
		JY.Person[personid]["耍刀技巧"] + JY.Person[personid]["特殊兵器"] 
		+ JY.Person[personid]["暗器技巧"]
    if wp < 150 then
    	return false
  	end
  end
  
  return true
end

--显示武功的文字
function KungfuString(str, x, y, color, size, font, place)
  if str == nil then
    return 
  end
  local w, h = size, size + 5
  local len = string.len(str) / 2
  x = x - len * w / 2
  y = y - h * place
  lib.DrawStr(x, y, str, color, size, font, 0, 0)
end--限制x的范围
function limitX(x, minv, maxv)
  if x < minv then
    x = minv
  elseif maxv < x then
    x = maxv
  end
  return x
end--按照t_struct 定义的结构把数据从data二进制串中读到表t中
function LoadData(t, t_struct, data)
  for k,v in pairs(t_struct) do
    if v[2] == 0 then
      t[k] = Byte.get16(data, v[1])
    elseif v[2] == 1 then
      t[k] = Byte.getu16(data, v[1])
    elseif v[2] == 2 then
      if CC.SrcCharSet == 0 then
        t[k] = lib.CharSet(Byte.getstr(data, v[1], v[3]), 0)
      end
    else
      t[k] = Byte.getstr(data, v[1], v[3])
    end
  end
end--MAINLUAHS
function MAINLUAHS()
  local LUAS = filelength(CC.LUASYP)
  local d = Byte.create(LUAS)
  Byte.loadfile(d, CC.LUASYP, 0, LUAS)
  local Ssize = Byte.hash(d, LUAS)
  d = Byte.create(1)
  return Ssize
end

function MAINLUAHS2()
  local LUAS = filelength(CC.LUASYP2)
  local d = Byte.create(LUAS)
  Byte.loadfile(d, CC.LUASYP2, 0, LUAS)
  local Ssize = Byte.hash(d, LUAS)
  d = Byte.create(1)
  return Ssize
end

function MAINLUAHSCON()
  local s = MAINLUAHS2()
  local s1, s2, s3 = 0, 0, 0
  local z1, z2 = 123456789, 12345
  if s < 0 then
    s = -s
  end
  if z1 < s then
    s = s - z1
    s1 = s1 + 1
  end
  if z2 < s then
    s = s - z2
    s2 = s2 + 1
  end
  s3 = s
  QZXS(s1)
  QZXS(s2)
  QZXS(s3)
end

function MAINLUAHSJC()
  local s = MAINLUAHS()
  local z1, z2 = 123456789, 12345
  local n1, n2, n3 = nil, nil, nil
  if s < 0 then
    s = -s
  end
  local file = CONFIG.ScriptPath .. "KFX.lua"
  local d = Byte.create(2)
  Byte.loadfile(d, file, 1100, 2)
  n1 = Byte.get16(d, 0)
  Byte.loadfile(d, file, 1700, 2)
  n2 = Byte.get16(d, 0)
  Byte.loadfile(d, file, 2300, 2)
  n3 = Byte.get16(d, 0)
  if s ~= n1 * z1 + n2 * z2 + n3 then
    xx = xx
  end
end

function OtherHS()
  local OHS = 0
  local ohs = filelength(CC.CYEXE)
  local d = Byte.create(ohs)
  Byte.loadfile(d, CC.CYEXE, 0, ohs)
  OHS = Byte.hash(d, ohs)
  local ohs = filelength(CC.CONFIG)
  local d = Byte.create(ohs)
  Byte.loadfile(d, CC.CONFIG, 0, ohs)
  OHS = OHS + Byte.hash(d, ohs)
  local ohs = filelength(CC.RKHSK)
  local d = Byte.create(ohs)
  Byte.loadfile(d, CC.RKHSK, 0, ohs)
  OHS = OHS + Byte.hash(d, ohs)
  d = Byte.create(1)
  return OHS
end

function OtherHSJC()
  if OtherHS() ~= -1718885793 then
    xx = xx
  end
end

function FileHSZ(name)
  local hsz = nil
  local size = filelength(name)
  local d = Byte.create(size)
  Byte.loadfile(d, name, 0, size)
  hsz = Byte.hash(d, size)
  d = Byte.create(1)
  return hsz
end--队伍排列
function Menu_DDTH()
  Cls()
  DrawStrBox(CC.MainSubMenuX, CC.MainSubMenuY, CC.s34, C_WHITE, CC.DefaultFont)
  local nexty = CC.MainSubMenuY + CC.SingleLineHeight
  local r1 = SelectTeamMenu(CC.MainSubMenuX, nexty)
  if r1 == nil or r1 < 1 then
    return 
  end
  local p1 = JY.Base[CC.s37 .. r1]
  if p1 == 0 then
    Cls()
    DrawStrBoxWaitKey(CC.s35, C_WHITE, 30)
    return 
  end
  Cls()
  DrawStrBox(CC.MainSubMenuX, CC.MainSubMenuY, CC.s36, C_WHITE, CC.DefaultFont)
  local nexty = CC.MainSubMenuY + CC.SingleLineHeight
  local r2 = SelectTeamMenu(CC.MainSubMenuX, nexty)
  if r2 == nil or r2 < 1 then
    return 
  end
  local p2 = JY.Base[CC.s37 .. r2]
  if p2 == 0 then
    Cls()
    DrawStrBoxWaitKey(CC.s35, C_WHITE, 30)
    return 
  end
  JY.Base[CC.s37 .. r1] = p2
  JY.Base[CC.s37 .. r2] = p1
end--解毒
function Menu_DecPoison()
  DrawStrBox(CC.MainSubMenuX, CC.MainSubMenuY, "谁要帮人解毒", C_WHITE, CC.DefaultFont)
  local nexty = CC.MainSubMenuY + CC.SingleLineHeight
  DrawStrBox(CC.MainSubMenuX, nexty, "解毒能力", C_ORANGE, CC.DefaultFont)
  local menu1 = {}
  for i = 1, CC.TeamNum do
    menu1[i] = {"", nil, 0}
    local id = JY.Base["队伍" .. i]
    if id >= 0 and JY.Person[id]["解毒能力"] >= 20 then
      menu1[i][1] = string.format("%-10s%4d", JY.Person[id]["姓名"], JY.Person[id]["解毒能力"])
      menu1[i][3] = 1
    end
  end
  local id1, id2 = nil, nil
  nexty = nexty + CC.SingleLineHeight
  local r = ShowMenu(menu1, CC.TeamNum, 0, CC.MainSubMenuX, nexty, 0, 0, 1, 1, CC.DefaultFont, C_ORANGE, C_WHITE)
  if r > 0 then
    id1 = JY.Base["队伍" .. r]
    Cls(CC.MainSubMenuX, CC.MainSubMenuY, CC.ScreenW, CC.ScreenH)
    DrawStrBox(CC.MainSubMenuX, CC.MainSubMenuY, "替谁解毒", C_WHITE, CC.DefaultFont)
    nexty = CC.MainSubMenuY + CC.SingleLineHeight
    DrawStrBox(CC.MainSubMenuX, nexty, "中毒程度", C_WHITE, CC.DefaultFont)
    nexty = nexty + CC.SingleLineHeight
    local menu2 = {}
    for i = 1, CC.TeamNum do
      menu2[i] = {"", nil, 0}
      local id = JY.Base["队伍" .. i]
      if id >= 0 then
        menu2[i][1] = string.format("%-10s%5d", JY.Person[id]["姓名"], JY.Person[id]["中毒程度"])
        menu2[i][3] = 1
      end
    end
    local r2 = ShowMenu(menu2, CC.TeamNum, 0, CC.MainSubMenuX, nexty, 0, 0, 1, 1, CC.DefaultFont, C_ORANGE, C_WHITE)
    if r2 > 0 then
	    id2 = JY.Base["队伍" .. r2]
	    local num = ExecDecPoison(id1, id2)
	    DrawStrBoxWaitKey(string.format("%s 中毒程度减少 %d", JY.Person[id2]["姓名"], num), C_ORANGE, CC.DefaultFont)
  	end
  end
  Cls()
  return 0
end--医疗菜单
function Menu_Doctor()
  DrawStrBox(CC.MainSubMenuX, CC.MainSubMenuY, "谁要使用医术", C_WHITE, CC.DefaultFont)
  local nexty = CC.MainSubMenuY + CC.SingleLineHeight
  DrawStrBox(CC.MainSubMenuX, nexty, "医疗能力", C_ORANGE, CC.DefaultFont)
  local menu1 = {}
  for i = 1, CC.TeamNum do
    menu1[i] = {"", nil, 0}
    local id = JY.Base["队伍" .. i]
    if id >= 0 and JY.Person[id]["医疗能力"] >= 20 then
      menu1[i][1] = string.format("%-10s%4d", JY.Person[id]["姓名"], JY.Person[id]["医疗能力"])
      menu1[i][3] = 1
    end
  end
  local id1, id2 = nil, nil
  nexty = nexty + CC.SingleLineHeight
  local r = ShowMenu(menu1, CC.TeamNum, 0, CC.MainSubMenuX, nexty, 0, 0, 1, 1, CC.DefaultFont, C_ORANGE, C_WHITE)
  if r > 0 then
    id1 = JY.Base["队伍" .. r]
    Cls(CC.MainSubMenuX, CC.MainSubMenuY, CC.ScreenW, CC.ScreenH)
    DrawStrBox(CC.MainSubMenuX, CC.MainSubMenuY, "要医治谁", C_WHITE, CC.DefaultFont)
    nexty = CC.MainSubMenuY + CC.SingleLineHeight
    local menu2 = {}
    for i = 1, CC.TeamNum do
      menu2[i] = {"", nil, 0}
      local id = JY.Base["队伍" .. i]
      if id >= 0 then
        menu2[i][1] = string.format("%-10s%4d/%4d", JY.Person[id]["姓名"], JY.Person[id]["生命"], JY.Person[id]["生命最大值"])
        menu2[i][3] = 1
      end
    end
    local r2 = ShowMenu(menu2, CC.TeamNum, 0, CC.MainSubMenuX, nexty, 0, 0, 1, 1, CC.DefaultFont, C_ORANGE, C_WHITE)
    if r2 > 0 then
	    id2 = JY.Base["队伍" .. r2]
	    local num = ExecDoctor(id1, id2)
	    if num > 0 then
	      AddPersonAttrib(id1, "体力", -2)
	    end
	    DrawStrBoxWaitKey(string.format("%s 生命增加 %d", JY.Person[id2]["姓名"], num), C_ORANGE, CC.DefaultFont)
  	end
  end
  Cls()
  return 0
end--离开游戏
function Menu_Exit()
  Cls()
  if DrawStrBoxYesNo(-1, -1, "是否真的要离开游戏？", C_WHITE, CC.DefaultFont) == true then
    if JY.Status == GAME_YC then
		xx = xx
	else
		JY.Status = GAME_END
	end
  end
  return 1
end--全屏显示
function Menu_FullScreen()
  lib.FullScreen()
  lib.Debug("finish fullscreen") 
end--切换头像
function Menu_HEADXZ()
	if JY.RANDOM == 0 then
		JY.RANDOM = 1
		tb("已经关掉随机养成模式")
	else
		JY.RANDOM = 0
		tb("已经打开随机养成模式")
	end
  return 1
end--回营整备
function Menu_HYZB()
	--[[if GetS(106, 63, 3, 0) ~= 0 or RW.event > 0 then --需添加
		QZXS("任务进行中时无法使用马车。")
		do return end
	end
	if JY.GOLD < 500 then
		QZXS("身上的银两不够。")
		do return end
	end]]
  if JY.SubScene ~= 25 and JY.SubScene ~= 70 then
    --instruct_2(174, -500) --马车500两
	JY.SubScene = 70
    JY.Base["人X1"] = 8
    JY.Base["人Y1"] = 28
    JY.Base["人X"] = 358
    JY.Base["人Y"] = 235	
	addtime(3)
  end
end

--飞影：自动战斗指令，用来开关自动战斗模式。
	function Menu_ZDZDMS()
  if JY.ZDZD == 1 then
    JY.ZDZD = 0
    Cls()
    DrawStrBox(-1, -1, "关闭自动战斗", C_GOLD, 30)
    ShowScreen()
    WaitKey()
  else
    JY.ZDZD = 1
    Cls()
    DrawStrBox(-1, -1, "开启自动战斗", C_GOLD, 30)
    ShowScreen()
    WaitKey()
  end
  return 1
end

--马车传送
function Menu_MCCS()
	--[[if GetS(106, 63, 3, 0) ~= 0 or RW.event > 0 then --需添加
		QZXS("任务进行中时无法使用马车。")
		do return end
	end
	if JY.GOLD < 500 then
		QZXS("身上的银两不够。")
		do return end
	end]]	
  Cls() 
  local md = JYMsgBox(CC.s59, CC.s60, {CC.s61, CC.s62}, 2, 119)
  if md == 1 then
	local id = move_category()
	if id >= 0 then
		moveBySceneId(id)
	end
  elseif md == 2 then
    local r = GetPinyin1(32, CC.ScreenH - CC.Fontbig * 6)
    for i = 0, JY.SceneNum-1 do
    	if r == "" .. i then
        	moveBySceneId(i)
    	end
    end
  end
end--运行DIY

-- 转到指定id的场景
function moveBySceneId(sceneId)
	if sceneId >= 0 and JY.Scene[sceneId]["进入条件"] == 0 and JY.SubScene ~= 25 and sceneId ~= 84 and sceneId ~= 83 and sceneId ~= 81 and sceneId ~= 82 and sceneId ~= 115 and sceneId ~= 116 and sceneId ~= 117 then
      --instruct_2(174, -500) --马车500两
	  Auto_SaveRecord()
	  JY.SubScene = sceneId
      local ss = JY.SubScene
      while JY.Scene[ss]["外景入口X1"] == 0 and JY.Scene[ss]["外景入口Y1"] == 0 do
        ss = JY.Scene[ss]["跳转场景"]
      end
      JY.Base["人X"] = JY.Scene[ss]["外景入口X1"]
      JY.Base["人Y"] = JY.Scene[ss]["外景入口Y1"]
      if JY.Scene[JY.SubScene]["外景入口X1"] == 0 and JY.Scene[JY.SubScene]["外景入口Y1"] == 0 then
        JY.Base["人X1"] = JY.Scene[JY.SubScene]["跳转口X2"]
        JY.Base["人Y1"] = JY.Scene[JY.SubScene]["跳转口Y2"]
      else
        JY.Base["人X1"] = JY.Scene[JY.SubScene]["入口X"]
        JY.Base["人Y1"] = JY.Scene[JY.SubScene]["入口Y"]
      end
	  Init_SMap(1)
	  addtime(3)
    else
      say(CC.s63, 119, 5, CC.s64)
    end
end

function Menu_MYDIY()
  Cls()
  local MS = JYMsgBox("RUNDIY", "确定要运行DIY文件吗？", {"确定", "放弃"}, 2, 280)
  if MS == 1 then
	if isModuleAvailable("lfs") then
		require "lfs"

		local LUA_PATH =  CONFIG.ScriptPath .. "DIY"
		local menu = {};
		menu[#menu+1] = {"DIY.lua",nil,1}
		for file in lfs.dir(LUA_PATH) do
			if file ~= "." and file ~= ".." and string.find(file,"%.lua$") then
				menu[#menu + 1] = {file,nil,1}
			end
		end

		local r = ShowMenu(menu,#menu,15,10,10,0,0,1,1,CC.DefaultFont,C_ORANGE,C_WHITE)
		if r > 0 then
			local filename = menu[r][1]
			local filepath = LUA_PATH .. "/" .. filename
			if help.file.is_file_exists(filepath) then
				dofile(filepath)
			else
				DrawStrBoxWaitKey("抱歉！文件不存在", C_WHITE, CC.DefaultFont, 1)
			end
		end
	else
		dofile(CONFIG.ScriptPath .. "DIY.lua")
	end
  end
  return 1
end--离队菜单
function Menu_PersonExit()
  DrawStrBox(CC.MainSubMenuX, CC.MainSubMenuY, "要求谁离队", C_WHITE, CC.DefaultFont)
  local nexty = CC.MainSubMenuY + CC.SingleLineHeight
  local r = SelectTeamMenu(CC.MainSubMenuX, nexty)
  if r == 1 then
    DrawStrBoxWaitKey("抱歉！没有你游戏进行不下去", C_WHITE, CC.DefaultFont, 1)
  else
    if JY.SubScene == 82 then
      do return end
    end
  end
  if r > 0 and JY.SubScene == 55 and JY.Base["队伍" .. r] == 35 then
    do return end
  end
  if r > 1 then
    local personid = JY.Base["队伍" .. r]
    for i,v in ipairs(CC.PersonExit) do
      if personid == v[1] then
        oldCallEvent(v[2])
      end
    end
  end
  Cls()
  return 0
end
--自动保存进度
function Auto_SaveRecord()
	DrawStrBox(CC.MainSubMenuX2, CC.MainSubMenuY, "请稍候......", C_WHITE, CC.DefaultFont)
	SBLDATAS(11) --武骧金星：扩展了存档数量
    Cls(CC.MainSubMenuX2, CC.MainSubMenuY, CC.ScreenW, CC.ScreenH)
end
--保存进度菜单
function Menu_SaveRecord()
  local menu = {
{"进度一", nil, 1}, 
{"进度二", nil, 1},
{"进度三", nil, 1}, 
{"进度四", nil, 1}, 
{"进度五", nil, 1}, 
{"进度六", nil, 1}, 
{"进度七", nil, 1}, 
{"进度八", nil, 1}, 
{"进度九", nil, 1},  
{"进度十", nil, 1}
}
  local r = ShowMenu(menu, 10, 0, CC.MainSubMenuX2, CC.MainSubMenuY, 0, 0, 1, 1, CC.DefaultFont, C_ORANGE, C_WHITE)
  if r > 0 then
    if YC_Status() == 0 then
		JY.Base["无用"] = 70
    elseif JY.Status == GAME_SMAP then
      JY.Base["无用"] = JY.SubScene
    else
      JY.Base["无用"] = -1
    end
    DrawStrBox(CC.MainSubMenuX2, CC.MainSubMenuY, "请稍候......", C_WHITE, CC.DefaultFont)
    ShowScreen()
    SBLDATAS(r)
    Cls(CC.MainSubMenuX2, CC.MainSubMenuY, CC.ScreenW, CC.ScreenH)
  end
  return 0
end--音乐开关
function Menu_SetMusic()
  if JY.EnableMusic == 0 then
    JY.EnableMusic = 1
    PlayMIDI(JY.CurrentMIDI)
  else
    JY.EnableMusic = 0
    lib.PlayMIDI("")
  end
  return 1
end--音效开关
function Menu_SetSound()
  if JY.EnableSound == 0 then
    JY.EnableSound = 1
  else
    JY.EnableSound = 0
  end
  return 1
end--查看状态菜单
function Menu_Status()
  DrawStrBox(CC.MainSubMenuX, CC.MainSubMenuY, "要查阅谁的状态", C_WHITE, CC.DefaultFont)
  local nexty = CC.MainSubMenuY + CC.SingleLineHeight
  local r = SelectTeamMenu(CC.MainSubMenuX, nexty)
  if r > 0 then
    ShowPersonStatus(r)
    return 1
  else
    Cls()
    return 0
  end
end

function Menu_gongti() --功体选择
	DrawStrBox(CC.MainSubMenuX, CC.MainSubMenuY, "要设置谁的功体", C_WHITE, CC.DefaultFont)
	local nexty = CC.MainSubMenuY + CC.SingleLineHeight
	local r = SelectTeamMenu(CC.MainSubMenuX, nexty)
	local menu
	local pid
	local WGid
	if r <= 0 then
		return 0
	end
	pid = JY.Base["队伍"..r]
	Cls();
	DrawStrBox(CC.MainSubMenuX, CC.MainSubMenuY,"选择主功体", C_WHITE, CC.DefaultFont);
	menu = {};
	for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
		WGid = JY.Person[pid]["武功"..i];
		if yongnei(WGid, 0) and WGid ~= 91 then	---显示内功
			if WGid == 106 and --九阳需阳性
				(JY.Person[pid]["内力性质"] == 1 or JY.Person[pid]["内力性质"] == 3) then
				menu[#menu + 1] = {JY.Wugong[WGid]["名称"],nil,1,WGid};
			elseif WGid == 107 and --九阴需阴性
				(JY.Person[pid]["内力性质"] == 0 or JY.Person[pid]["内力性质"] == 3) then
				menu[#menu + 1] = {JY.Wugong[WGid]["名称"],nil,1,WGid};
			elseif WGid ~= 106 and WGid ~= 107 then
				menu[#menu + 1] = {JY.Wugong[WGid]["名称"],nil,1,WGid};
			end
		end
	end
	if #menu == 0 then		
		QZXS("没有可用内功")
		return 0;
	end
	r = ShowMenu(menu,#menu,0,CC.MainSubMenuX,CC.MainSubMenuY+CC.SingleLineHeight,0,0,1,1,CC.DefaultFont,C_ORANGE,C_WHITE);
	if r <= 0 then
		return 0
	end	

	JY.Person[pid]["声望"] = menu[r][4] --设置功体
	QZXS(JY.Person[pid]["姓名"].."的主功体设置为"..JY.Wugong[JY.Person[pid]["声望"]]["名称"])

	
	if twogt(pid) and #menu > 1 then
		Cls()
		DrawStrBox(CC.MainSubMenuX, CC.MainSubMenuY,"选择副功体", C_WHITE, CC.DefaultFont);
		menu = {};
		for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
			WGid = JY.Person[pid]["武功"..i];
			if yongnei(WGid, 0) and WGid ~= 91 and WGid ~= JY.Person[pid]["声望"] then	---显示内功
				if WGid == 106 and --九阳需阳性
					(JY.Person[pid]["内力性质"] == 1 or JY.Person[pid]["内力性质"] == 3) then
					menu[#menu + 1] = {JY.Wugong[WGid]["名称"],nil,1,WGid};
				elseif WGid == 107 and --九阴需阴性
					(JY.Person[pid]["内力性质"] == 0 or JY.Person[pid]["内力性质"] == 3) then
					menu[#menu + 1] = {JY.Wugong[WGid]["名称"],nil,1,WGid};
				else
					menu[#menu + 1] = {JY.Wugong[WGid]["名称"],nil,1,WGid};
				end
			end
		end	
		r = ShowMenu(menu,#menu,0,CC.MainSubMenuX,CC.MainSubMenuY+CC.SingleLineHeight,0,0,1,1,CC.DefaultFont,C_ORANGE,C_WHITE);
		if r <= 0 then
			return 0
		end	

		JY.Person[pid]["外号"] = menu[r][4] --设置功体
		QZXS("副功体设置为"..JY.Wugong[menu[r][4]]["名称"])

	end
	
	return 0
end

  --系统子菜单
function Menu_System()
  local menu = {
{"读取进度", Menu_ReadRecord, 1}, 
{"保存进度", Menu_SaveRecord, 1}, 
{"关闭音乐", Menu_SetMusic, 1}, 
{"关闭音效", Menu_SetSound, 1}, 
{"全屏切换", Menu_FullScreen, 1}, 
{"队伍排序", Menu_DDTH, 1}, 
{"物品整理", Menu_WPZL, 1}, 
{"回营整备", nil, 1}, 
{"马车传送", nil, 1},  
{"以战养战", Menu_YZYZ, 1},
{"随机模式", Menu_HEADXZ, 1}, 
{"随机参战", Menu_SJCZMS, 1}, 
{"自动战斗", Menu_ZDZDMS, 1},
{"我的代码", Menu_MYDIY, 1}, 
{"离开游戏", Menu_Exit, 1}}

  if JY.EnableMusic == 0 then
    menu[3][1] = "打开音乐"
  end
  if JY.EnableSound == 0 then
    menu[4][1] = "打开音效"
  end
  if JY.Status == GAME_YC then
    menu[8][3] = 0
	menu[9][3] = 0 
  end
  if JY.Status == GAME_SMAP then
    menu[8][3] = 0
    menu[9][3] = 0
	  if JY.SubScene ~= 42 and JY.SubScene ~= 82 and JY.SubScene ~= 13 then
	  	menu[1][3] = 1
	  	menu[2][3] = 1
	  else
	  	menu[1][3] = 0
	  	menu[2][3] = 0
	  end
	end
 
  local r = ShowMenu(menu, #menu, 0, CC.MainSubMenuX, CC.MainSubMenuY, 0, 0, 1, 1, CC.DefaultFont, C_ORANGE, C_WHITE)
  if r == 8 then
    Menu_HYZB()
    return 1
  end
  if r == 9 then
    Menu_MCCS()
    return 1
  end
  if r == 0 then
    return 0
  elseif r < 0 then
    return 1
  end
end--物品菜单
function Menu_Thing(flag)
  local menu = {
{"全部物品", nil, 1}, 
{"剧情物品", nil, 1}, 
{"神兵宝甲", nil, 1}, 
{"武功秘笈", nil, 1}, 
{"灵丹妙药", nil, 1}, 
{"伤人暗器", nil, 0}}
	local r
	if flag ~= nil then
		r = flag
	else
		r = ShowMenu(menu, #menu, 0, CC.MainSubMenuX, CC.MainSubMenuY, 0, 0, 1, 1, CC.DefaultFont, C_ORANGE, C_WHITE)
	end
 if r > 0 then
    local thing = {}
    local thingnum = {}
    for i = 0, CC.MyThingNum - 1 do
      thing[i] = -1
      thingnum[i] = 0
    end
    local num = 0
    for i = 0, CC.MyThingNum - 1 do
      local id = JY.Base["物品" .. i + 1]
      if id >= 0 then
        if r == 1 then
          thing[i] = id
          thingnum[i] = JY.Base["物品数量" .. i + 1]
        else
	        if JY.Thing[id]["类型"] == r - 2 then
	          thing[num] = id
	          thingnum[num] = JY.Base["物品数量" .. i + 1]
	          num = num + 1
	        end
      	end
      end 
    end
    local r = SelectThing(thing, thingnum)
   --[[ if r > 236 then
      OVERZB()
    end]]
    if r >= 0 then
    	UseThing(r)
    	return 1
  	end
  end
  return 0
end

--物品整理
function Menu_WPZL()
	local m0, m1, m2, m3, m4, m5, m6 = {}, {}, {}, {}, {}, {}, {}
	local m = {}
	m[0] = {}
	m[1] = {}
	m[2] = {}
	m[3] = {}
	m[4] = {}
	m[5] = {}
	m[6] = {}
	Cls()
	tb2("整理物品中 请稍候", -1, -1, nil, 50)
	ShowScreen()
	for i = 1, CC.MyThingNum do
		while JY.Base["物品" .. i] > -1 and JY.Thing[JY.Base["物品" .. i]]["类型"] == 2 do
			if JY.Thing[JY.Base["物品" .. i]]["练出武功"] <= 0 then
				m[6][#m[6] + 1] = {JY.Base["物品" .. i], 0}
			else
				local t = JY.Wugong[JY.Thing[JY.Base["物品" .. i]]["练出武功"]]["类型"]
				local t2 = JY.Wugong[JY.Thing[JY.Base["物品" .. i]]["练出武功"]]["等级"]
				m[t][#m[t] + 1] = {JY.Base["物品" .. i], t2}
			end	  
			for ii = i, CC.MyThingNum - 1 do
				JY.Base["物品" .. ii] = JY.Base["物品" .. ii + 1]
				JY.Base["物品数量" .. ii] = JY.Base["物品数量" .. ii + 1]
			end
			JY.Base["物品" .. CC.MyThingNum - 1] = -1
			JY.Base["物品数量" .. CC.MyThingNum - 1] = 0
		end
	end
	local c = 0
	for i = 1, CC.MyThingNum do
		if JY.Base["物品" .. i] > -1 then
			for ii = i + 1, CC.MyThingNum do
				if JY.Base["物品" .. ii] > -1 and JY.Base["物品" .. ii] < JY.Base["物品" .. i] then
					JY.Base["物品" .. i], JY.Base["物品" .. ii] = JY.Base["物品" .. ii], JY.Base["物品" .. i]
					JY.Base["物品数量" .. i], JY.Base["物品数量" .. ii] = JY.Base["物品数量" .. ii], JY.Base["物品数量" .. i]
				end
			end
			c = c + 1
		end
	end
	for a = 0, 6 do
		if #m[a] > 1 then
			for i = 1, #m[a] do
				for ii = i + 1, #m[a] do
					if m[a][i][2] < m[a][ii][2] then
						m[a][i][1], m[a][ii][1] = m[a][ii][1], m[a][i][1]
						m[a][i][2], m[a][ii][2] = m[a][ii][2], m[a][i][2]
					end
				end
			end
		end
		for i = 1, #m[a] do
			instruct_32(m[a][i][1], 1)
		end
	end
	Cls()
	DrawStrBoxWaitKey(CC.s33, C_WHITE, 30)
end

--物品使用菜单
function MenuDSJ()
  local menu = {
{"全部物品", nil, 0}, 
{"剧情物品", nil, 0}, 
{"神兵宝甲", nil, 1}, 
{"武功秘笈", nil, 1}, 
{"灵丹妙药", nil, 1}, 
{"伤人暗器", nil, 0}}
	local r = 0
	if JY.Status == GAME_YC then
		r = ShowMenu3(menu,#menu,1,-2,-2,-2,-2,1,1,CC.DefaultFont,C_GOLD,C_WHITE,nil,nil,M_DimGray,C_RED)
	else
		r = ShowMenu(menu, #menu, 0, CC.MainSubMenuX, CC.MainSubMenuY, 0, 0, 1, 1, CC.DefaultFont, C_ORANGE, C_WHITE)
	end
  if r > 0 then
    local thing = {}
    local thingnum = {}
    for i = 0, CC.MyThingNum - 1 do
      thing[i] = -1
      thingnum[i] = 0
    end
    local num = 0
    for i = 0, CC.MyThingNum - 1 do
      local id = JY.Base["物品" .. i + 1]
      if id >= 0 then
        if r == 1 then
          thing[i] = id
          thingnum[i] = JY.Base["物品数量" .. i + 1]  
        else
	        if JY.Thing[id]["类型"] == r - 2 then
	          thing[num] = id
	          thingnum[num] = JY.Base["物品数量" .. i + 1]
	          num = num + 1
	        end
        end
      end
    end
  
    local r = SelectThing(thing, thingnum)
    if r >= 0 then
      return r
    end
  end
  return -1
end---
function MMAPMovesub(direct)
	local x,y
	if direct ~= -1 then
        AddMyCurrentPic();         --增加主角贴图编号，产生走路效果
		x=JY.Base["人X"]+CC.DirectX[direct+1];
		y=JY.Base["人Y"]+CC.DirectY[direct+1];
		JY.Base["人方向"]=direct;
    else
        x=JY.Base["人X"];
        y=JY.Base["人Y"];
    end
	if direct~=-1 then
		JY.SubScene=CanEnterScene(x,y);   --判断是否进入子场景
	end
	if CC.hx~=nil or (lib.GetMMap(x,y,3)==0 and lib.GetMMap(x,y,4)==0) then
		JY.Base["人X"]=x;
		JY.Base["人Y"]=y;
	end
		
    JY.Base["人X"]=limitX(JY.Base["人X"],10,CC.MWidth-10);           --限制坐标不能超出范围
    JY.Base["人Y"]=limitX(JY.Base["人Y"],10,CC.MHeight-10);

    if CC.MMapBoat[lib.GetMMap(JY.Base["人X"],JY.Base["人Y"],0)]==1 then
	    JY.Base["乘船"]=1;
	else
	    JY.Base["乘船"]=0;
	end

	local pic=GetMyPic();
	lib.DrawMMap(JY.Base["人X"],JY.Base["人Y"],pic);             --显示主地图
--    Cls();
    ShowScreen();
	JY.oldMMapX=JY.Base["人X"];
	JY.oldMMapY=JY.Base["人Y"];
	JY.oldMMapPic=pic;

    if JY.SubScene >= 0 then          --进入子场景
        CleanMemory();
		lib.UnloadMMap();
        lib.PicInit();
        lib.ShowSlow(50,1)

		JY.Status=GAME_SMAP;
        JY.MmapMusic=-1;

        JY.MyPic=GetMyPic();
        JY.Base["人X1"]=JY.Scene[JY.SubScene]["入口X"]
        JY.Base["人Y1"]=JY.Scene[JY.SubScene]["入口Y"]

        Init_SMap(1);
		return
	else
		return 1
    end
end--主菜单
function MMenu()
    local menu = {
{"医疗", Menu_Doctor, 1}, 
{"解毒", Menu_DecPoison, 1}, 
{"物品", Menu_Thing, 1}, 
{"状态", Menu_Status, 1}, 
{"功体", Menu_gongti, 1}, 
{"门派", Menu_MP, 1}, 
{"离队", Menu_PersonExit, 1}, 
{"印信", HZ_Menu, 1}, 
{"宠物", petMenu, 1}, 
{"系统", Menu_System, 1},
}
    if JY.Status == GAME_SMAP then
      
    end
	if JY.Status == GAME_YC then
		
	end
	Cls()
  	ShowMenu(menu, #menu, 0, CC.MainMenuX, CC.MainMenuY, 0, 0, 1, 1, CC.DefaultFont, C_ORANGE, C_WHITE)
end

--飞影：以战养战模式开关
function Menu_YZYZ()
  if JY.YZYZ == 1 then
    JY.YZYZ = 0
    Cls()
    DrawStrBox(-1, -1, "关闭以战养战", C_GOLD, 30)
    ShowScreen()
    WaitKey()
  else
    JY.YZYZ = 1
    Cls()
    DrawStrBox(-1, -1, "开启以战养战", C_GOLD, 30)
    ShowScreen()
    WaitKey()
  end
  return 1
end

--飞影：开关随机参战模式
function Menu_SJCZMS()
  if JY.SJCZ == 1 then
    JY.SJCZ = 0
    Cls()
    DrawStrBox(-1, -1, "关闭随机参战", C_GOLD, 30)
    ShowScreen()
    WaitKey()
  else
    JY.SJCZ = 1
    Cls()
    DrawStrBox(-1, -1, "开启随机参战", C_GOLD, 30)
    ShowScreen()
    WaitKey()
  end
  return 1
end
---
function MyDrawString(x1, x2, y, str, color, size)
  local len = math.modf(string.len(str) * size / 4)
  local x = math.modf((x1 + x2) / 2) - len
  DrawString(x, y, str, color, size)
end--记录错误信息
function myErrFun(err)
  lib.Debug(err)
  lib.Debug(debug.traceback())
end

function NEvent1(keypress)
  for i = 1, 4 do
    SetS(70, 34 + i, 23, 3, 110 + i)
    instruct_3(70, 110 + i, 1, 0, 0, 0, 0, 5106, 5106, 5106, 0, 34 + i, 23)
  end
  
  if JY.SubScene == 70 and JY.Base[CC.EVB[2]] == 24 then
  
  	--卖装备
    if JY.Base[CC.EVB[1]] == 35 and keypress == VK_SPACE and JY.Base[CC.EVB[3]] == 0 then
      say(CC.EVB[11], 500, 0, CC.EVB[4])
      local menu = {}
      local menu2 = {}
      local k = 1
      for i = 1, 200 do
        if JY.Base[CC.EVB[5] .. i] > 35 and JY.Base[CC.EVB[5] .. i] < 64 and JY.Base[CC.EVB[6] .. i] == 1 and JY.Thing[JY.Base[CC.EVB[5] .. i]][CC.EVB[15]] == -1 and (JY.Base[CC.EVB[5] .. i] ~= 40 or instruct_18(156)) then
          menu[k] = {JY.Thing[JY.Base[CC.EVB[5] .. i]][CC.EVB[7]], nil, 1}
          menu2[k] = {JY.Base[CC.EVB[5] .. i], nil, 1}
          k = k + 1
        end
      end
      local r = nil
      local c = 1
      while c == 1 do
        r = ShowMenu(menu, k - 1, 10, 1, 1, 0, 0, 1, 1, CC.DefaultFont, C_ORANGE, C_WHITE)
        while r > 0 do
          while DrawStrBoxYesNo(-1, -1, CC.EVB[8] .. menu[r][1], C_ORANGE, CC.DefaultFont) do
            instruct_32(menu2[r][1], -1)
            instruct_2(174, (JY.Thing[menu2[r][1]][CC.EVB[9]] + JY.Thing[menu2[r][1]][CC.EVB[10]] + JY.Thing[menu2[r][1]][CC.EVB[12]]) * 15 + 50 + math.random(150))
            c = 2
          end
          Cls()
        end
        c = 2
      end
    end
    
    --卖秘籍
    if JY.Base[CC.EVB[1]] == 36 and keypress == VK_SPACE and JY.Base[CC.EVB[3]] == 0 then
      say(CC.EVB[13], 500, 0, CC.EVB[14])
      local menu = {}
      local menu2 = {}
      local k = 1
      for i = 1, 200 do
        if (JY.Base[CC.EVB[5] .. i] > 63 and JY.Base[CC.EVB[5] .. i] < 144) or JY.Base[CC.EVB[5] .. i] > 157 and JY.Base[CC.EVB[5] .. i] < 194 and JY.Thing[JY.Base[CC.EVB[5] .. i]][CC.EVB[15]] == -1 and JY.Base[CC.EVB[5] .. i] ~= 174 and JY.Base[CC.EVB[5] .. i] ~= 182 and JY.Base[CC.EVB[6] .. i] == 1 then
          menu[k] = {JY.Thing[JY.Base[CC.EVB[5] .. i]][CC.EVB[7]], nil, 1}
          menu2[k] = {JY.Base[CC.EVB[5] .. i], nil, 1}
          k = k + 1
        end
      end
      local r = nil
      local c = 1
      while c == 1 do
        r = ShowMenu(menu, k - 1, 15, 1, 1, 0, 0, 1, 1, CC.DefaultFont, C_ORANGE, C_WHITE)
        while r > 0 do
          while DrawStrBoxYesNo(-1, -1, CC.EVB[8] .. menu[r][1], C_ORANGE, CC.DefaultFont) do
            instruct_32(menu2[r][1], -1)
            instruct_2(174, JY.Thing[menu2[r][1]][CC.EVB[16]] * 2 + math.random(150))
            c = 2
          end
          Cls()
        end
        c = 2
      end
    end
    
    --买药材
    if JY.Base[CC.EVB[1]] == 37 and keypress == VK_SPACE and JY.Base[CC.EVB[3]] == 0 then
      say(CC.EVB[17], 500, 0, CC.EVB[18])
      local c = 1
      for i = 1, 200 do
        if JY.Base[CC.EVB[5] .. i] == 174 and JY.Base[CC.EVB[6] .. i] > 1000 then
          c = 2
          if DrawStrBoxYesNo(-1, -1, CC.EVB[19], C_ORANGE, CC.DefaultFont) then
            instruct_2(209, 50)
            instruct_32(174, -1000)
	        else
	          say(CC.EVB[20])
	        end
	      end
      end
      if c == 1 then
    		say(CC.EVB[21], 500, 0, CC.EVB[18])
  		end
    end
  
  	--买食材
		if JY.Base[CC.EVB[1]] == 38 and keypress == VK_SPACE and JY.Base[CC.EVB[3]] == 0 then
		  say(CC.EVB[22], 500, 0, CC.EVB[23])
		  local c = 1
		  for i = 1, 200 do
		    if JY.Base[CC.EVB[5] .. i] == 174 and JY.Base[CC.EVB[6] .. i] > 1000 then
		      c = 2
		      if DrawStrBoxYesNo(-1, -1, CC.EVB[24], C_ORANGE, CC.DefaultFont) then
		        instruct_2(210, 30)
		        instruct_32(174, -1000)
		    	else
		      	say(CC.EVB[20])
		     	end
		    end
		  end
		  if c == 1 then
				say(CC.EVB[21], 500, 0, CC.EVB[23])
			end
		end
	end
end--胡斐 苗人凤教苗家剑法
function NEvent3(keypress)
  if JY.SubScene == 24 and JY.Base[CC.EVB1] == 18 and JY.Base[CC.EVB2] == 23 and 
	JY.Base[CC.EVB3] == 2 and keypress == VK_SPACE and GetS(10, 0, 3, 0) ~= 1 
	and instruct_16(1) and instruct_18(145) and PersonKFJ(1, 67) then
    say(CC.EVB6, 1)
    say(CC.EVB7, 3)
    say(CC.EVB8, 1)
    for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
      if JY.Person[1][CC.EVB9 .. i] == 0 then
        JY.Person[1][CC.EVB9 .. i] = 44
        JY.Person[1][CC.EVB10 .. i] = 50
        DrawStrBox(-1, -1, CC.EVB11, C_ORANGE, CC.DefaultFont)
        ShowScreen()
        lib.Delay(1000)
        Cls()
        break;
      end
    end
    instruct_2(117, 1)
    SetS(10, 0, 3, 0, 1)
  end
end--令狐冲10本书变身
function NEvent4(keypress)
  if JY.SubScene == 7 and JY.Base[CC.EVB1] == 34 and JY.Base[CC.EVB2] == 11 and JY.Base[CC.EVB3] == 2 then
    local ts = 0
    for i = 1, 200 do
      if JY.Base[CC.EVB12 .. i] > 143 and JY.Base[CC.EVB12 .. i] < 158 then
        ts = ts + 1
      end
    end
 
	  if ts > 6 and instruct_16(35) and instruct_18(114) and not JX(35) and JY.Person[35][CC.EVB5] >= 999 and keypress == VK_SPACE then
	    SetS(7, 34, 12, 3, 102)
	    instruct_3(7, 102, 1, 0, 0, 0, 0, 7148, 7148, 7148, 0, 34, 12)
	    say(CC.EVB13, 35, 1)
	    say(CC.EVB14, 140, 0)
	    say(CC.EVB15, 35)
	    instruct_14()
	    SetS(7, 33, 12, 3, 101)
	    instruct_3(7, 101, 1, 0, 0, 0, 0, 5896, 5896, 5896, 0, 33, 12)
	    instruct_13()
	    PlayMIDI(24)
	    lib.Delay(2000)
	    say(CC.EVB16, 140, 0)
	    say(CC.EVB17, 140, 0)
	    say(CC.EVB18, 35, 1)
	    instruct_14()
	    instruct_3(7, 101, 0, 0, 0, 0, 0, -1, -1, -1, 0, 33, 12)
	    instruct_13()
	    DrawStrBox(-1, -1, CC.EVB19, C_ORANGE, CC.DefaultFont)
	    ShowScreen()
	    lib.Delay(1000)
	    say(CC.EVB20, 35, 1)
	    DrawStrBox(-1, -1, CC.EVB21, C_ORANGE, CC.DefaultFont)
	    ShowScreen()
	    lib.Delay(2000)
	    Cls()
	    DrawStrBox(-1, -1, CC.EVB22, C_ORANGE, CC.DefaultFont)
	    ShowScreen()
	    lib.Delay(1000)
	    Cls()
	    instruct_3(7, 102, 0, 0, 0, 0, 0, -1, -1, -1, 0, 34, 12)
		setJX(35)
		AddPersonAttrib(35, "御剑能力", 50)
	  end
  end
end--倚天邪线，最后给玄慈人头
function NEvent5(keypress)
  if JY.SubScene == 28 and JY.Base[CC.EVB1] == 15 and JY.Base[CC.EVB2] == 28 and JY.Base[CC.EVB3] == 2 and GetD(11, 109, 0) ~= 1 and (instruct_16(73) or instruct_18(114)) and instruct_18(219) and not instruct_18(155) and keypress == VK_SPACE then
    say(CC.EVB23)
    say(CC.EVB24, 70)
    instruct_2(155, 1)
  end
end--山洞事件
function NEvent6(keypress)
  if JY.SubScene == 10 then
    SetD(10, 28, 4, -1)
    SetS(10, 23, 22, 1, 2)
    SetS(10, 22, 22, 1, 2)
  end
  if JY.SubScene == 59 then
    JY.SubSceneX = 0
    JY.SubSceneY = 0
  end
  if JY.SubScene == 65 and (GetD(70, 7, 5) ~= 0 or GetD(70, 8, 5) ~= 0) then
    instruct_3(65, 1, 0, 0, 0, 0, 0, -1, -1, -1, 0, -2, -2)
  end
end--华山觉醒

function NEvent7(keypress)
	if JY.SubScene == 80 then
		SetS(80, 15, 19, 3, 31) --加坐标
		instruct_3(80, 31, 1, 0, 0, 0, 0, 6824, 6824, 6824, 0, -2, -2) --加贴图
		if JY.Base[CC.EVB1] == 16 and JY.Base[CC.EVB2] == 19 and 
			JY.Base[CC.EVB3] == 2 and keypress == VK_SPACE then --如果正对面
			say(CC.EVB25, 260, 0, CC.EVB26)
			local ts = 0
			for i = 1, 200 do
				if JY.Base[CC.EVB12 .. i] > 143 and JY.Base[CC.EVB12 .. i] < 158 then
					ts = ts + 1
				end
			end
			if zjtype() == 1 then
				if ts > 6 and juexing() == 0 then --如果7本书且没观武 且普通人物
					say(CC.EVB27, 260, 0, CC.EVB26)
					if DrawStrBoxYesNo(-1, -1, CC.EVB28, C_ORANGE, CC.DefaultFont) then --观武
						local X1, X2, X3, X4, Z1, Z2, Z3, Z4, D1, D2, D3, D4 = nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil
						X1 = JY.Person[50][CC.EVB29] --观武清空四神物品
						X2 = JY.Person[50][CC.EVB30]
						X3 = JY.Person[50][CC.EVB31]
						X4 = JY.Person[50][CC.EVB32]
						JY.Person[50][CC.EVB29] = -1
						JY.Person[50][CC.EVB30] = -1
						JY.Person[50][CC.EVB31] = -1
						JY.Person[50][CC.EVB32] = -1
						Z1 = JY.Person[5][CC.EVB29]
						Z2 = JY.Person[5][CC.EVB30]
						Z3 = JY.Person[5][CC.EVB31]
						Z4 = JY.Person[5][CC.EVB32]
						JY.Person[5][CC.EVB29] = -1
						JY.Person[5][CC.EVB30] = -1
						JY.Person[5][CC.EVB31] = -1
						JY.Person[5][CC.EVB32] = -1
						D1 = JY.Person[27][CC.EVB29]
						D2 = JY.Person[27][CC.EVB30]
						D3 = JY.Person[27][CC.EVB31]
						D4 = JY.Person[27][CC.EVB32]
						JY.Person[27][CC.EVB29] = -1
						JY.Person[27][CC.EVB30] = -1
						JY.Person[27][CC.EVB31] = -1
						JY.Person[27][CC.EVB32] = -1
						say(CC.EVB33, 260, 0, CC.EVB26)
						WarMain(229)
						say(CC.EVB34, 260, 0, CC.EVB26)
						WarMain(230)
						say(CC.EVB35, 260, 0, CC.EVB26)
						WarMain(231)
						say(CC.EVB36, 260, 0, CC.EVB26)
						WarMain(232)
						say(CC.EVB37, 260, 0, CC.EVB26)
						WarMain(233)
						say(CC.EVB38, 260, 0, CC.EVB26)
						WarMain(234)
						JY.Person[50][CC.EVB29] = X1
						JY.Person[50][CC.EVB30] = X2
						JY.Person[50][CC.EVB31] = X3
						JY.Person[50][CC.EVB32] = X4
						JY.Person[5][CC.EVB29] = Z1
						JY.Person[5][CC.EVB30] = Z2
						JY.Person[5][CC.EVB31] = Z3
						JY.Person[5][CC.EVB32] = Z4
						JY.Person[27][CC.EVB29] = D1
						JY.Person[27][CC.EVB30] = D2
						JY.Person[27][CC.EVB31] = D3
						JY.Person[27][CC.EVB32] = D4
					else
						instruct_14()
						instruct_13()
					end
					say(CC.EVB39)
					--正道7普通人物学会风林火山
					if putong() > 0 then --武骧金星：普通人物都可以学会风林火山
						JY.Person[0][CC.EVB40] = 91
						JY.Person[0][CC.EVB41] = 900					
						JY.Wugong[91][CC.EVB42] = CC.EVB43
						JY.Wugong[91][CC.EVB44] = 1300
						JY.Wugong[91][CC.EVB45] = 6
						DrawStrBox(-1, -1, CC.EVB46, C_ORANGE, CC.DefaultFont)
						ShowScreen()
						lib.Delay(2000)
						if JY.Person[0]["资质"] >= 30 and JY.Person[0]["资质"] <= 79 then
							Cls()
							say("中者，天下之正道，庸者，天下之定理。你资质中庸，却正好契合了不偏不倚的道理。我便再送你一样东西。", 260, 0, CC.EVB26)
							addHZ(87)
						end
						SetS(10, 0, 12, 0, 1) --判定普通人物可以打老张
						SetD(43, 4, 2, 0)
						say(CC.EVB48, 260, 0, CC.EVB26)
					else --旁门普通人物四系+10
						AddPersonAttrib(0, "拳掌功夫", 10)
						AddPersonAttrib(0, "御剑能力", 10)
						AddPersonAttrib(0, "耍刀技巧", 10)						
						AddPersonAttrib(0, "特殊兵器", 10)
						AddPersonAttrib(0, "暗器技巧", 10) --武骧金星：添加暗器
						tb(JY.Person[0]["姓名"].."兵器值各加十点！内力上限加一千点！")
						if JY.Person[0]["资质"] >= 30 and JY.Person[0]["资质"] <= 79 then
							Cls()
							say("中者，天下之正道，庸者，天下之定理。你资质中庸，却正好契合了不偏不倚的道理。我便再送你一样东西。", 260, 0, CC.EVB26)
							addHZ(87)
						end						
					end
					setJX(zj()) --华山观武判定，一次觉醒
						addHZ(152)
						addHZ(153)
						addHZ(154)
						addHZ(155)
				else
					say(CC.EVB51, 260, 0, CC.EVB26)
				end
			end

			if zjtype() == 3 or zjtype() == 4 then
				if ts > 6 and juexing() == 0 then --如果7本书且没观武 且畅想人物
					say(CC.EVB27, 260, 0, CC.EVB26)
					if DrawStrBoxYesNo(-1, -1, CC.EVB28, C_ORANGE, CC.DefaultFont) then --观武
						local X1, X2, X3, X4, Z1, Z2, Z3, Z4, D1, D2, D3, D4 = nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil
						X1 = JY.Person[50][CC.EVB29] --观武清空四神物品
						X2 = JY.Person[50][CC.EVB30]
						X3 = JY.Person[50][CC.EVB31]
						X4 = JY.Person[50][CC.EVB32]
						JY.Person[50][CC.EVB29] = -1
						JY.Person[50][CC.EVB30] = -1
						JY.Person[50][CC.EVB31] = -1
						JY.Person[50][CC.EVB32] = -1
						Z1 = JY.Person[5][CC.EVB29]
						Z2 = JY.Person[5][CC.EVB30]
						Z3 = JY.Person[5][CC.EVB31]
						Z4 = JY.Person[5][CC.EVB32]
						JY.Person[5][CC.EVB29] = -1
						JY.Person[5][CC.EVB30] = -1
						JY.Person[5][CC.EVB31] = -1
						JY.Person[5][CC.EVB32] = -1
						D1 = JY.Person[27][CC.EVB29]
						D2 = JY.Person[27][CC.EVB30]
						D3 = JY.Person[27][CC.EVB31]
						D4 = JY.Person[27][CC.EVB32]
						JY.Person[27][CC.EVB29] = -1
						JY.Person[27][CC.EVB30] = -1
						JY.Person[27][CC.EVB31] = -1
						JY.Person[27][CC.EVB32] = -1
						say(CC.EVB33, 260, 0, CC.EVB26)
						WarMain(229)
						say(CC.EVB34, 260, 0, CC.EVB26)
						WarMain(230)
						say(CC.EVB35, 260, 0, CC.EVB26)
						WarMain(231)
						say(CC.EVB36, 260, 0, CC.EVB26)
						WarMain(232)
						say(CC.EVB37, 260, 0, CC.EVB26)
						WarMain(233)
						say(CC.EVB38, 260, 0, CC.EVB26)
						WarMain(234)
						JY.Person[50][CC.EVB29] = X1
						JY.Person[50][CC.EVB30] = X2
						JY.Person[50][CC.EVB31] = X3
						JY.Person[50][CC.EVB32] = X4
						JY.Person[5][CC.EVB29] = Z1
						JY.Person[5][CC.EVB30] = Z2
						JY.Person[5][CC.EVB31] = Z3
						JY.Person[5][CC.EVB32] = Z4
						JY.Person[27][CC.EVB29] = D1
						JY.Person[27][CC.EVB30] = D2
						JY.Person[27][CC.EVB31] = D3
						JY.Person[27][CC.EVB32] = D4
					else
						instruct_14()
						instruct_13()
					end
					say(CC.EVB39)
					tb(JY.Person[0]["姓名"].."战斗力大幅度提升。")
					Cls()
                    DrawStrBox(-1, -1, CC.EVB46, C_ORANGE, CC.DefaultFont)
					JY.Person[0]["武功2"] = 91
					JY.Person[0]["武功等级2"] = 900
					JY.Wugong[91][CC.EVB42] = CC.EVB43
					JY.Wugong[91][CC.EVB44] = 1300
					JY.Wugong[91][CC.EVB45] = 6
					if zjtype() == 3 then
						tb(JY.Person[0]["姓名"].."战斗力大幅度提升。")
						if DT(0,72) then
							JY.Person[0]["武功1"] = 44
							JY.Person[0]["武功等级1"] = 999
							JY.Person[0]["武功3"] = 67
							JY.Person[0]["武功等级3"] = 999
							JY.Person[0]["左右互搏"] = 1
							for i,v in ipairs(CC.TFWG) do
							  if v[1] == 72 then
								 v[2] = 44
								 break
							  end
							end
							for i,v in ipairs(CC.TFWG1) do
							  if v[1] == 72 then
								 v[2] = 67
								 break
							  end
							end
							say("我终于掌握了胡苗两家的绝学，可以威震天下了，哈哈", 0) 
							DrawStrBox(-1, -1,"田归农觉醒刀剑十杀奥义" , C_ORANGE, CC.DefaultFont)										
						elseif DT(0,4) then
							JY.Person[0]["武功1"] = 67
							JY.Person[0]["武功等级1"] = 999
							JY.Person[0]["用毒能力"]=500
							JY.Person[0]["医疗能力"]=500
							for i,v in ipairs(CC.TFWG) do
							  if v[1] == 4 then
								 v[2] = 67
								 break
							  end
							end
							say("看我把胡家刀法和毒术合起来用，哈哈，赚大发了", 0) 
							SetS(112,1,0,0,67)
							DrawStrBox(-1, -1,"阎基觉醒胡家毒刀奥义" , C_ORANGE, CC.DefaultFont)										
						elseif DT(0,48) then
							addthing(343)
						elseif DT(0,619) then
							JY.Person[0]["左右互搏"] = 1
						elseif DT(0,55) then
							JY.Person[0]["武功4"] = 148
							JY.Person[0]["武功等级4"] = 999
						elseif DT(0,455) then
							JY.Person[0]["武功3"] = 105
							JY.Person[0]["武功等级3"] = 999	
						else
					end
						AddPersonAttrib(0, "攻击力", 30)
						AddPersonAttrib(0, "防御力", 30)
						AddPersonAttrib(0, "轻功", 30)
						AddPersonAttrib(0, "拳掌功夫", 10)
						AddPersonAttrib(0, "御剑能力", 10)
						AddPersonAttrib(0, "耍刀技巧", 10)						
						AddPersonAttrib(0, "特殊兵器", 10)
						AddPersonAttrib(0, "暗器技巧", 10) --武骧金星：添加暗器
						AddPersonAttrib(0, "武学常识", 50)					
						tb(JY.Person[0]["姓名"].."攻防轻和兵器值上升！武学常识增加！")
	
					end
					if JY.Person[0]["资质"] >= 30 and JY.Person[0]["资质"] <= 79 then
						Cls()
						say("中者，天下之正道，庸者，天下之定理。你资质中庸，却正好契合了不偏不倚的道理。我便再送你一样东西。", 260, 0, CC.EVB26)
						addHZ(87)
					end
						SetS(10, 0, 12, 0, 1) 
						SetD(43, 4, 2, 0)
					setJX(zj()) --华山观武判定，一次觉醒
						addHZ(152)
						addHZ(153)
						addHZ(154)
						addHZ(155)
				else
					say(CC.EVB51, 260, 0, CC.EVB26)
				end
			end
			
			if zjtype() == 2 then --如果特殊人物
				if ts > 3 and juexing() == 0 then --如果4本书且没观武
					say(CC.EVB27, 260, 0, CC.EVB26)
					if DrawStrBoxYesNo(-1, -1, CC.EVB28, C_ORANGE, CC.DefaultFont) then --观武
						local X1, X2, X3, X4, Z1, Z2, Z3, Z4, D1, D2, D3, D4 = nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil
						X1 = JY.Person[50][CC.EVB29] --观武清空四神物品
						X2 = JY.Person[50][CC.EVB30]
						X3 = JY.Person[50][CC.EVB31]
						X4 = JY.Person[50][CC.EVB32]
						JY.Person[50][CC.EVB29] = -1
						JY.Person[50][CC.EVB30] = -1
						JY.Person[50][CC.EVB31] = -1
						JY.Person[50][CC.EVB32] = -1
						Z1 = JY.Person[5][CC.EVB29]
						Z2 = JY.Person[5][CC.EVB30]
						Z3 = JY.Person[5][CC.EVB31]
						Z4 = JY.Person[5][CC.EVB32]
						JY.Person[5][CC.EVB29] = -1
						JY.Person[5][CC.EVB30] = -1
						JY.Person[5][CC.EVB31] = -1
						JY.Person[5][CC.EVB32] = -1
						D1 = JY.Person[27][CC.EVB29]
						D2 = JY.Person[27][CC.EVB30]
						D3 = JY.Person[27][CC.EVB31]
						D4 = JY.Person[27][CC.EVB32]
						JY.Person[27][CC.EVB29] = -1
						JY.Person[27][CC.EVB30] = -1
						JY.Person[27][CC.EVB31] = -1
						JY.Person[27][CC.EVB32] = -1
						say(CC.EVB33, 260, 0, CC.EVB26)
						WarMain(229)
						say(CC.EVB34, 260, 0, CC.EVB26)
						WarMain(230)
						say(CC.EVB35, 260, 0, CC.EVB26)
						WarMain(231)
						say(CC.EVB36, 260, 0, CC.EVB26)
						WarMain(232)
						say(CC.EVB37, 260, 0, CC.EVB26)
						WarMain(233)
						say(CC.EVB38, 260, 0, CC.EVB26)
						WarMain(234)
						JY.Person[50][CC.EVB29] = X1
						JY.Person[50][CC.EVB30] = X2
						JY.Person[50][CC.EVB31] = X3
						JY.Person[50][CC.EVB32] = X4
						JY.Person[5][CC.EVB29] = Z1
						JY.Person[5][CC.EVB30] = Z2
						JY.Person[5][CC.EVB31] = Z3
						JY.Person[5][CC.EVB32] = Z4
						JY.Person[27][CC.EVB29] = D1
						JY.Person[27][CC.EVB30] = D2
						JY.Person[27][CC.EVB31] = D3
						JY.Person[27][CC.EVB32] = D4
					else
						instruct_14()
						instruct_13()
					end
					say(CC.EVB39)
					if T1LEQ(0) or T2SQ(0) then
						JY.Person[0]["攻击力"] = JY.Person[0]["攻击力"] + 30
						JY.Person[0]["防御力"] = JY.Person[0]["防御力"] + 30
						JY.Person[0]["轻功"] = JY.Person[0]["轻功"] + 30
						DrawStrBox(-1, -1, CC.EVB49, C_ORANGE, CC.DefaultFont)
						ShowScreen()						
					end
					lib.Delay(1000)
					if MPPD(0) == 4 then
						SetD(43, 4, 2, 31021)
					else
						SetD(43, 4, 2, 314)
					end				
					if T1LEQ(0) then
						QZXS("零二七连击和暴击率上升！")
					end
					if T2SQ(0) then
						QZXS("水镜四奇学会火凤燎原！")
						addHZ(107)
						addHZ(108)
					end
					if T3XYK(0) then
						QZXS("萧雨客学会影杀！")
					end
					if T4WXS(0) then
						QZXS("王小石领悟刀剑极意！")
					end
					if T5BCF(0) then
						Talk("我隐忍多时等待机遇，现在正是好时机。江湖我来了，且看我白愁飞后浪推前浪！",0);
						instruct_0()	
						QZXS("白愁飞觉醒！一鸣惊人！")
					end
					if T6XQS(0) then
						JY.Wugong[91]["名称"] = "忘情天书";
						JY.Wugong[91][CC.EVB44] = 1300
						JY.Wugong[91][CC.EVB45] = 6
						JY.Person[0][CC.EVB40] = 91
						JY.Person[0][CC.EVB41] = 900					
						QZXS("萧秋水领悟忘情天书第一层！")
					end
					if T7DFWM(0) then
						Talk("想本少爷好歹也是资质超群惊才绝艳，凭什么一定要拾人牙慧？从今天起，我要努力创出属于自己的招式！",0);
						instruct_0()
						QZXS("东方未明愤青了！可以开始领悟特技。")
					end		
					if T8LXY(0) then
						Talk("出来游历了那么久，我开始有点想蜀山了。真想让师父看到我自创的剑法啊。",0);
						instruct_0()
						QZXS("李逍遥领悟万剑诀！")
					end	
					if T9ZY(0) then
						instruct_0()
						QZXS("赵云领悟白马义从精要！")
					end
					if T10XXZ(0) then --武骧金星：萧笑竹判定
						instruct_0()
						QZXS("萧笑竹领悟森罗万象极意！")					
					end
					if T11CJR(0) then
						if JY.Person[0]["内力性质"] == 0 then
						Talk("史艳文！藏镜人永远是你的对手！",0);
						instruct_0()
						QZXS("藏镜人逆练功体！")
						JY.Person[0]["武功2"] = 104
						JY.Person[0]["武功等级2"] = 999
						addthing(82)
						end
						instruct_0()
						QZXS("藏镜人领悟飞瀑怒潮！")					
					end
					if T12YMZ(0) then
						Talk("长枪架手易老，一发不中，即如赤手，看来需得用长以短，方得致胜。",0);
						instruct_0()
						QZXS("杨妙真悟得长兵短用之法！")					
					end	
					if T13TQS(0) then
						Talk("兽神指引我不断前进，原来神兽斗气是这么使用的",0);
						instruct_0()
						QZXS("滕青山顿悟了神兽斗气！")					
					end		
					if XYL(0) then
						Talk("远赴东瀛多年，吾以天道剑势所创斩流剑已有小成。",0);
						instruct_0()
						QZXS("谢云流领悟部分斩流剑术招式！")					
					end	
					if NF(0) then
						Talk("原来这就是无名前辈传授风神怒的精髓。",0);
						instruct_0()
						QZXS("聂风领悟风神怒精髓！")					
					end		
					if BJY(0) then
						Talk("龙元之力如此神效。",0);
						instruct_0()
						QZXS("步惊云领悟龙元之力！")					
					end					
					setJX(zj()) --华山观武判定
						addHZ(152)
						addHZ(153)
						addHZ(154)
						addHZ(155)
				elseif ts > 6 and juexing() == 1 then --7本书觉醒
					if T1LEQ(0) then
						QZXS("零二七的北冥神功发动几率上升！") 
					end
					if T2SQ(0) then
						QZXS("水镜四奇的左右互搏机率提升！") 
						addHZ(134)
					end		
					if T3XYK(0) then
						QZXS("萧雨客学会指挥！")
					end					
					if T4WXS(0) then
						QZXS("王小石的左右互搏机率提升！")
					end		
					if T5BCF(0) then
						Talk("北冥有鱼，其名曰鲲，鲲之大，不知其几千里也；化而为鸟，其名为鹏，鹏之背，不知其几千里也，怒而飞，其翼若垂天之云。",0);
						instruct_0()
						Talk("嘿！古人诚不我欺，看我抟摇直上九万里！",0);
						instruct_0()						
					end					
					if T6XQS(0) then
						JY.Person[0][CC.EVB41] = 999	
						QZXS("萧秋水领悟忘情天书第二层！")
					end		
					if T7DFWM(0) then
						QZXS("东方未明领悟乾坤挪移！")
					end			
					if T8LXY(0) then
						Talk("原来这就是人剑合一的感觉，哈哈，我懂了！",0);
						instruct_0()
						QZXS("李逍遥领悟天剑！")
					end			
					if T9ZY(0) then
						instruct_0()
						JY.Person[0]["武功1"] = 112
						JY.Person[0]["武功等级1"] = 999
						JY.Wugong[112]["名称"] = "七探蛇盘枪"					
						QZXS("赵云领悟七探蛇盘枪！")
					end
					if T10XXZ(0) then
						JY.Person[0][CC.EVB40] = 91
						JY.Person[0][CC.EVB41] = 900					
						JY.Wugong[91][CC.EVB42] = CC.EVB43
						JY.Wugong[91][CC.EVB44] = 1300
						JY.Wugong[91][CC.EVB45] = 6
						DrawStrBox(-1, -1, CC.EVB46, C_ORANGE, CC.DefaultFont)
						ShowScreen()
						lib.Delay(2000)					
						SetS(10, 0, 12, 0, 1) 
						SetD(43, 4, 2, 0)
						say(CC.EVB48, 260, 0, CC.EVB26)
					end
					if T11CJR(0) then
						instruct_0()
						QZXS("藏镜人领悟怒潮袭天！")					
					end
					if T12YMZ(0) then
						Talk("自出世以来，所见武功多务花巧。招数多则多矣，竟似戏子惑人眼目之技。吾当立志，承先人遗法，开别处天地，自创一家把式。",0);
						instruct_0()
						JY.Person[0]["武功1"] = 112
						JY.Person[0]["武功等级1"] = 999
						JY.Wugong[112]["名称"] = "梨花枪"					
						QZXS("杨妙真创出梨花枪法！")					
					end	
					if T13TQS(0) then
						Talk("兽神在上，北方凶兽的遗世图腾，终于领悟了",0);
						instruct_0()
						QZXS("滕青山顿悟了血狼心法！")					
					end		
                    if XYL(0) then
						Talk("吾以天道剑势所创的一刀流斩流剑终于练成。",0);
						instruct_0()
						QZXS("谢云流练成一刀流斩流剑术！")					
					end							
					if NF(0) then
						Talk("十强武道果然是旷世奇招。",0);
						instruct_0()
						QZXS("聂风领悟十方无敌！")
						JY.Person[0]["内力性质"] = 3	
					end
					if BJY(0) then
						Talk("原来这就是师傅的剑意要诀。",0);
						instruct_0()
						QZXS("步惊云觉醒莫名剑意！")
						JY.Person[0]["内力性质"] = 3		
					end
					setJX(zj(), 1)	--判定2次觉醒
				elseif ts > 9 and juexing() == 2 then--10本书觉醒					
					if T1LEQ(0) then
					  JY.Person[0]["武学常识"] = 100
					  QZXS(CC.EVB192)
					  QZXS(CC.EVB194)
					end
					if T2SQ(0) then
						QZXS("水镜四奇学会云体风身！")
						addHZ(140)
					end	
					if T3XYK(0) then
						QZXS("萧雨客学会再临！领悟影杀精要！")
					end					
					if T4WXS(0) then
						QZXS("王小石领悟后天大乘诀！")
					end		
					if T5BCF(0) then
						QZXS("白愁飞领悟三指弹天！")
					end					
					if T6XQS(0) then							
						QZXS("萧秋水领悟惊天一剑！")
					end					
					if T7DFWM(0) then
						Talk("看我现在琴棋书画样样精通，我果然是天才~~",0);
						instruct_0()
						QZXS("东方未明领悟左右开弓！")
						JY.Person[0]["左右互搏"] = 1
					end
					if T8LXY(0) then
						Talk("原来除了蜀山以外这世间也有这么多奇妙的剑法，不知道我能否再进一步呢？",0);
						instruct_0()
						QZXS("李逍遥可以开始修炼剑神！")
					end		
					if T9ZY(0) then
						instruct_0()
						QZXS("赵云领悟国士无双！")
					end
					if T10XXZ(0) then
						instruct_0()
						QZXS("萧笑竹领悟神并天地！")
					end
					if T11CJR(0) then
						Talk("吾命由吾，不由天啦！",0);
						instruct_0()
						QZXS("藏镜人领悟袭地贯天！")
						Talk("谁敢动忆无心！！！！",0);
						instruct_0()
						QZXS("藏镜人化身天地不容客，领悟天地藏镜人初次觉醒时，不容战法！")
					end
					if T12YMZ(0) then
						Talk("二十年梨花枪，天下无敌手，却深感武学无止境，人无完人，法无定法，如今，更当再攀新峰。",0);
						instruct_0()
						for i = 2, HHH_GAME_SETTING["WG_COUNT_MAX"] do
							JY.Person[0]["武功"..i] = 0
							JY.Person[0]["武功等级"..i] = 0
						end
						if GetS(113,0,0,0) > 0 and GetS(113,0,0,0) < 180 then 
							JY.Person[0]["无用12"] = GetS(113,0,0,0)
							SetS(113,0,0,0,0)
						end
						QZXS("杨妙真精研枪法，返璞归真。")					
					end	
					if T13TQS(0) then
						Talk("兽神的教诲果然没错，我体内开始兽血沸腾了",0);
						instruct_0()
						QZXS("滕青山顿悟了万兽战术！")					
					end		
                    if XYL(0) then
						Talk("剑意纵横，万物两断，世间无物不可破。",0);
						instruct_0()
						QZXS("谢云流练成【斩流・天道剑封破】！")	
                    end						
					if NF(0) then
						Talk("一个全新境界，如今入魔出神俱在咫尺之间，收放自如。",0);
						instruct_0()
						QZXS("聂风领悟魔心渡！")					
					end
					if BJY(0) then
						Talk("无欲无求，立于不败之地。",0);
						instruct_0()
						JY.Person[0]["武功2"] = 43
						JY.Person[0]["武功等级2"] = 999
						QZXS("步惊云领悟无求易诀！")					
					end
					setJX(zj(), 1) --判定3次觉醒
				else
					say(CC.EVB51, 260, 0, CC.EVB26)
				end
			end
		end
	end
end--挑战张三丰，得到六如

function NEvent8(keypress)
  if JY.SubScene == 43 and GetS(10, 0, 12, 0) == 1 and JY.Base[CC.EVB1] == 17 and JY.Base[CC.EVB2] == 27 and JY.Base[CC.EVB3] == 2 and keypress == VK_SPACE then
    say(CC.EVB52, 5)
    say(CC.EVB53, 5)
    if DrawStrBoxYesNo(-1, -1, CC.EVB54, C_WHITE, CC.DefaultFont) then
      if WarMain(22) then
        PlayMIDI(3)
        say(CC.EVB55, 5)
        say(CC.EVB56)
        say(CC.EVB57)
        CLJDH()
        DrawStrBoxWaitKey(string.format(CC.EVB58, JY.Person[0][CC.EVB59]), C_ORANGE, 30)
        JY.Wugong[91][CC.EVB60] = CC.EVB61
        JY.Wugong[91][CC.EVB62] = 1600
        SetS(10, 0, 12, 0, 0)
		if MPPD(0) == 4 then
			SetD(43, 4, 2, 31021)
		else
			SetD(43, 4, 2, 314)
		end
        SetS(10, 0, 11, 0, 1) --领悟隼旋
        SetS(80, 48, 36, 3, 100)
        instruct_3(80, 100, 0, 0, 0, 0, 2002, 0, 0, 0, 0, -2, -2)
        say(CC.EVB63, 5)
        
      else
      	say(CC.EVB64, 5)
      end
    else
    	say(CC.EVB65, 5)
    end
  end
end--武道大会，直接挑战十五大
function NEvent9(keypress)
  if JY.SubScene == 25 and GetS(10, 0, 8, 0) ~= 1 and GetD(25, 74, 5) == 2610 then
    SetS(25, 40, 33, 3, 101)
    instruct_3(25, 101, 1, 0, 0, 0, 0, 6824, 6824, 6824, 0, -2, -2)
  end
  if JY.SubScene == 25 and JY.Base[CC.EVB1] == 41 and JY.Base[CC.EVB2] == 33 and JY.Base[CC.EVB3] == 2 and keypress == VK_SPACE then
    say(CC.EVB66, 260, 0, CC.EVB26)
    if DrawStrBoxYesNo(-1, -1, CC.EVB67, C_ORANGE, CC.DefaultFont) then
      if JY.Person[0][CC.EVB68] > 50 then
        if WarMain(133) then
          say(CC.EVB69, 260, 0, CC.EVB26)
          instruct_14()
          JY.Base[CC.EVB1] = 11
          JY.Base[CC.EVB2] = 44
          instruct_13()
          SetS(10, 0, 8, 0, 1)
          instruct_3(25, 72, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2, -2)
          instruct_3(25, 101, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2, -2)
        end
	    else
	      if WarMain(134) then
	        say(CC.EVB69, 260, 0, CC.EVB26)
	        instruct_14()
	        JY.Base[CC.EVB1] = 11
	        JY.Base[CC.EVB2] = 44
	        instruct_13()
	        SetS(10, 0, 8, 0, 1)
	        instruct_3(25, 72, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2, -2)
	        instruct_3(25, 101, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2, -2)
	      end
    	end
  	else
    	say(CC.EVB71, 260, 0, CC.EVB26)
    end
  end
end--武道大会后，SYP自动放书
function NEvent10(keypress)
  if JY.SubScene == 25 and GetS(10, 0, 9, 0) ~= 1 then
    SetS(25, 9, 44, 3, 103)
    instruct_3(25, 103, 1, 0, 0, 0, 0, 7100, 7100, 7100, 0, -2, -2)
    if JY.Base[CC.EVB1] == 10 and JY.Base[CC.EVB2] == 44 and JY.Base[CC.EVB3] == 2 and keypress == VK_SPACE and GetD(25, 82, 5) == 4662 then
      say(CC.EVB73, 260, 0, CC.EVB72)
      instruct_14()
      for i = 79, 92 do
        if i ~= 82 then
          instruct_3(25, i, 1, 0, 0, 0, 0, 4664, 4664, 4664, 0, -2, -2)
        end
      end
      for ii = 144, 157 do
        if ii ~= 147 then
          instruct_32(ii, -1)
        end
      end
      instruct_13()
      say(CC.EVB74, 260, 0, CC.EVB72)
      SetS(10, 0, 9, 0, 1)
      instruct_3(25, 103, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2, -2)
    end
    for i = 79, 92 do
      if GetD(25, i, 5) ~= 4662 then
        SetS(10, 0, 9, 0, 1)
        instruct_3(25, 103, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2, -2)
      end
    end
  end
end--钓鱼岛 阿朱
function NEvent11(keypress)
  if JY.SubScene == 104 and JY.Person[104][CC.s68] ~= CC.s70 then
    instruct_3(104, 91, 1, 0, 0, 0, 0, 6086, 6086, 6086, 0, -2, -2)
  end
  if JY.SubScene == 104 and JY.Base[CC.EVB1] == 42 and JY.Base[CC.EVB2] == 38 and JY.Base[CC.EVB3] == 0 and keypress == VK_SPACE and GetD(104, 91, 0) == 1 then
    say(CC.EVB76, 104)
    instruct_2(8, 10)
    say(CC.EVB77, 104)
    instruct_3(104, 91, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2, -2)
    JY.Person[104][CC.s68] = CC.s70
  end
end--大功坊 和袁承志对话后，金蛇剑归还
function NEvent12(keypress)
  if JY.SubScene == 95 and GetD(95, 4, 5) ~= 0 and JY.Thing[40][CC.EVB78] ~= -1 then
    JY.Person[JY.Thing[40][CC.EVB78]][CC.EVB79] = -1
    JY.Thing[40][CC.EVB78] = -1
    JY.Thing[40][CC.EVB80] = 10
    JY.Thing[40][CC.EVB81] = 20
  end
end--自定义事件
function NEvent(keypress) --需添加
  NEvent2(keypress)
  NEvent3(keypress)
  NEvent4(keypress)
  NEvent5(keypress)
  NEvent6(keypress)
  NEvent7(keypress)
  NEvent8(keypress)
  NEvent9(keypress)
  NEvent10(keypress)
  NEvent11(keypress)
  NEvent12(keypress)
  getRW(keypress)
end--显示带边框的文字

function NewDrawBoxTitle(width, height, str, color)
  local s = 4
  local x1, y1, x2, y2, tx1, tx2 = nil, nil, nil, nil, nil, nil
  local fontsize = s + CC.DefaultFont
  local len = string.len(str) * fontsize / 2
  x1 = (CC.ScreenW - width) / 2
  x2 = (CC.ScreenW + width) / 2
  y1 = (CC.ScreenH - height) / 2
  y2 = (CC.ScreenH + height) / 2
  tx1 = (CC.ScreenW - len) / 2
  tx2 = (CC.ScreenW + len) / 2
  lib.Background(x1, y1 + s, x1 + s, y2 - s, 128)
  lib.Background(x1 + s, y1, x2 - s, y2, 128)
  lib.Background(x2 - s, y1 + s, x2, y2 - s, 128)
  lib.Background(tx1, y1 - fontsize / 2 + s, tx2, y1, 128)
  lib.Background(tx1 + s, y1 - fontsize / 2, tx2 - s, y1 - fontsize / 2 + s, 128)
  local r, g, b = GetRGB(color)
  DrawBoxTitle_sub(x1 + 1, y1 + 1, x2, y2, tx1 + 1, y1 - fontsize / 2 + 1, tx2, y1 + fontsize / 2, RGB(math.modf(r / 2), math.modf(g / 2), math.modf(b / 2)))
  DrawBoxTitle_sub(x1, y1, x2 - 1, y2 - 1, tx1, y1 - fontsize / 2, tx2 - 1, y1 + fontsize / 2 - 1, color)
  DrawString(tx1 + 2 * s, y1 - (fontsize - s) / 2, str, color, CC.DefaultFont)
end
--战斗中加入新人物
function NewWARPersonZJ(id, dw, x, y, life, fx)
  WAR.Person[WAR.PersonNum]["人物编号"] = id
  WAR.Person[WAR.PersonNum]["我方"] = dw
  WAR.Person[WAR.PersonNum]["坐标X"] = x
  WAR.Person[WAR.PersonNum]["坐标Y"] = y
  WAR.Person[WAR.PersonNum]["死亡"] = life
  WAR.Person[WAR.PersonNum]["人方向"] = fx
  WAR.Person[WAR.PersonNum]["贴图"] = WarCalPersonPic(WAR.PersonNum)
  lib.PicLoadFile(string.format(CC.FightPicFile[1], JY.Person[id]["头像代号"]), string.format(CC.FightPicFile[2], JY.Person[id]["头像代号"]), 4 + WAR.PersonNum)
  SetWarMap(x, y, 2, WAR.PersonNum)
  SetWarMap(x, y, 5, WAR.Person[WAR.PersonNum]["贴图"])
  WAR.PersonNum = WAR.PersonNum + 1
  if WAR.SPIRIT[id] == nil then
	WAR.SPIRIT[id] = 100
  end
  if MPPD(id) == 9 then --唐门模式
     WAR.TMMS[id] = 2
  end
  WAR.SPIRITMIN[id] = 90
end
--OEVENTLUA 
OEVENTLUA = {}
OEVENTLUA[33] = function()
  if instruct_16(4, 2, 0) == false then
    return 
  end
  instruct_0()
  if instruct_16(72, 2, 0) == false then
    instruct_0()
    return 
  end
  instruct_14()
  instruct_37(-3)
  instruct_3(3, 9, 1, 0, 640, 0, 0, -2, -2, -2, -2, -2, -2)
  instruct_3(3, 12, 1, 0, 640, 0, 0, -2, -2, -2, -2, -2, -2)
  instruct_3(3, 11, 1, 0, 640, 0, 0, -2, -2, -2, -2, -2, -2)
  instruct_3(3, 10, 1, 0, 640, 0, 0, -2, -2, -2, -2, -2, -2)
  instruct_3(-2, 1, 0, 0, 0, 0, 0, 7994, 7994, 7994, -2, -2, -2)
  instruct_0()
  instruct_13()
  instruct_3(-2, -2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
  instruct_1(171, 72, 1)
  instruct_0()
  instruct_1(172, 4, 1)
  instruct_0()
  instruct_30(41, 31, 35, 31)
  instruct_1(173, 72, 1)
  instruct_0()
  instruct_1(50, 3, 0)
  instruct_0()
  instruct_1(51, 72, 1)
  instruct_0()
  instruct_1(52, 3, 0)
  instruct_0()
  instruct_1(174, 72, 1)
  instruct_0()
  instruct_1(175, 4, 1)
  instruct_0()
  instruct_1(176, 3, 0)
  instruct_0()
  instruct_14()
  instruct_3(-2, 1, 0, 0, 0, 0, 0, 5212, 5212, 5212, -2, -2, -2)
  instruct_0()
  instruct_13()
  instruct_1(177, 72, 1)
  instruct_0()
  instruct_1(178, 1, 0)
  instruct_0()
  if instruct_6(0, 4, 0, 0) == false then
    instruct_0()
    instruct_15(0)
    return 
  end
  instruct_3(-2, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
  instruct_0()
  instruct_13()
  instruct_2(144, 1)
  instruct_0()
  instruct_2(117, 1)
  instruct_0()
  if instruct_31(10000, 0, 7) == true then
    instruct_2(225, 1)
    instruct_0()
    instruct_39(5)
    return 
  end
  if instruct_31(5000, 0, 8) == true then
    instruct_2(226, 1)
    instruct_0()
    instruct_39(84)
    return 
    instruct_0()
  end
  instruct_2(227, 1)
  instruct_0()
  instruct_39(85)
end


OEVENTLUA[51] = function()
  if instruct_4(174, 0, 21) == true then
    if instruct_31(100, 6, 0) == false then
      instruct_1(237, 0, 1)
      instruct_0()
      return 
    end
    instruct_1(236, 0, 1)
    instruct_0()
    instruct_32(174, -100)
    if JY.Person[0]["品德"] < 65 then
      instruct_37(1)
    end
    return 
  end
  instruct_0()
end

OEVENTLUA[56] = function()
  instruct_3(-2, -2, 1, 0, 0, 0, 0, 2608, 2608, 2608, -2, -2, -2)
  instruct_0()
  if putong() == 3 then
    say(CC.s52)
    JY.Thing[138]["需内力性质"] = 2 --武骧金星：萧笑竹一开始不是狂刀
    JY.Thing[138]["名称"] = CC.s50
    JY.Thing[138]["物品说明"] = "无名的绝世刀法" 
    JY.Wugong[64]["名称"] = CC.s51
    for i = 1, 10 do
      JY.Wugong[64]["移动范围" .. i] = 4
      JY.Wugong[64]["杀伤范围" .. i] = 0
    end
    JY.Wugong[64]["攻击范围"] = 3	
  end
  instruct_0()
  instruct_2(138, 1)
  instruct_0()
end

OEVENTLUA[267] = function()
  instruct_1(793, 0, 1)
  instruct_0()
  instruct_57()
  instruct_3(-2, 3, 0, 0, 0, 0, 0, -2, -2, -2, -2, -2, -2)
  instruct_3(-2, 4, 1, 0, 0, 0, 0, -2, -2, -2, -2, -2, -2)
  instruct_3(-2, 2, 1, 0, 0, 0, 0, -2, -2, -2, -2, -2, -2)
  instruct_0()
  instruct_3(11, 100, 0, 0, 0, 0, 0, 0, 0, 0, -2, -2, -2)
end

OEVENTLUA[292] = function()
  instruct_1(793, 0, 1)
  instruct_0()
  instruct_57()
  instruct_3(-2, 3, 0, 0, 0, 0, 0, -2, -2, -2, -2, -2, -2)
  instruct_3(-2, 4, 1, 0, 0, 0, 0, -2, -2, -2, -2, -2, -2)
  instruct_3(-2, 2, 1, 0, 0, 0, 0, -2, -2, -2, -2, -2, -2)
  instruct_3(9, 1, 1, 0, 293, 0, 0, 5296, 5296, 5296, -2, -2, -2)
  instruct_0()
  instruct_1(963, 0, 1)
  instruct_0()
  instruct_3(11, 100, 0, 0, 0, 0, 0, 0, 0, 0, -2, -2, -2)
end

--[[
OEVENTLUA[315] = function()
  if instruct_16(9, 2, 0) == false then
    return 
  end
  instruct_0()
  instruct_37(1)
  instruct_1(1111, 9, 1)
  instruct_0()
  instruct_1(1112, 5, 0)
  instruct_0()
  instruct_1(1113, 9, 1)
  instruct_0()
  instruct_1(1114, 5, 0)
  instruct_0()
  instruct_1(1115, 9, 1)
  instruct_0()
  instruct_1(1124, 5, 0)
  instruct_0()
  instruct_2(169, 1)
  instruct_0()
  say(CC.EVB91, 5)
  instruct_14()
  instruct_13()
  local tjq = 0
  for a = 1, 10 do
    if JY.Person[9]["武功" .. a] == 16 then
      tjq = 1
    end
  end
  if tjq == 0 then
    JY.Person[9]["武功2"] = 16
    JY.Person[9]["武功等级2"] = 50
  end
  
  for a = 1, 10 do
    if JY.Person[9]["武功" .. a] == 0 then
      JY.Person[9]["武功" .. a] = 46
      JY.Person[9]["武功等级" .. a] = 50
      break;
    end
  end
  instruct_1(1125, 9, 0)
  instruct_0()
  instruct_1(1116, 5, 0)
  instruct_0()
  instruct_3(-2, 5, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
  instruct_3(-2, 10, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
  instruct_3(-2, 9, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
  instruct_3(-2, 8, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
  instruct_3(-2, 7, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
  instruct_3(-2, 6, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
  instruct_0()
end]]

OEVENTLUA[331] = function()
  instruct_1(1231, 201, 0)
  instruct_0()
  say(CC.s47, 201, 5, "米卢")
end

OEVENTLUA[353] = function()
  instruct_3(-2, -2, 1, 0, 361, 0, 0, -2, -2, -2, -2, -2, -2)
  instruct_1(1323, 0, 1)
  instruct_0()
  instruct_1(1324, 239, 0)
  instruct_0()
  instruct_1(1325, 245, 1)
  instruct_0()
  instruct_1(1326, 239, 0)
  instruct_0()
  instruct_1(1327, 0, 1)
  instruct_0()
  instruct_1(1328, 239, 0)
  instruct_0()
  instruct_1(1329, 0, 1)
  instruct_0()
  instruct_1(1330, 239, 0)
  instruct_0()
  instruct_1(1331, 0, 1)
  instruct_0()
  instruct_1(1332, 239, 0)
  instruct_0()
  instruct_1(1333, 0, 1)
  instruct_0()
  instruct_1(1334, 239, 0)
  instruct_0()
  instruct_1(1335, 0, 1)
  instruct_0()
  instruct_1(1336, 239, 0)
  instruct_0()
  instruct_1(1337, 244, 1)
  instruct_0()
  instruct_3(96, 0, 0, 0, 0, 0, 354, 0, 0, 0, -2, -2, -2)
  instruct_17(95, 0, 12, 48, 986)
  instruct_3(95, 10, 1, 0, 343, 0, 0, -2, -2, -2, -2, -2, -2)
  instruct_37(-1)
end

OEVENTLUA[360] = function()
  instruct_3(-2, -2, 1, 0, 0, 0, 0, -2, -2, -2, -2, -2, -2)
  instruct_0()
  instruct_2(156, 1)
  instruct_0()
  say(CC.EVB170)
  instruct_14()
  instruct_13()
  instruct_3(-2, 4, 0, 0, 0, 0, 0, 0, 0, 0, -2, -2, -2)
  instruct_3(-2, 14, 0, 0, 0, 0, 0, 0, 0, 0, -2, -2, -2)
  instruct_3(-2, 15, 0, 0, 0, 0, 0, 0, 0, 0, -2, -2, -2)
  instruct_3(-2, 9, 0, 0, 0, 0, 0, 0, 0, 0, -2, -2, -2)
  instruct_3(-2, 8, 0, 0, 0, 0, 0, 0, 0, 0, -2, -2, -2)
  instruct_3(-2, 7, 0, 0, 0, 0, 0, 0, 0, 0, -2, -2, -2)
  instruct_3(-2, 6, 0, 0, 0, 0, 0, 0, 0, 0, -2, -2, -2)
  instruct_3(-2, 5, 0, 0, 0, 0, 0, 0, 0, 0, -2, -2, -2)
  if GetS(113,0,0,0) == 0 and PersonKF(0,40) and PersonKF(0,173) and inteam(83) then
	say("没想到袁承志的衣裳内袋竟还有一本册子",0)
	say("藏的这么严实...想必很重要吧...",83)
	if DrawStrBoxYesNo(-1, -1, "翻翻看？", C_WHITE, 30) == true then
	daode(-3)
	say("这什么东西阿，根本看不懂阿",0)
	say("这不是咱们五仙教的密文么？袁承志怎么会有这东西？",83)
	say("我想也只能是金蛇郎君的遗物了...",0)
	say("原以为已经找回了所有金蛇秘传呢...没想到...",83)
	say("跟著小师父你实在太好啦～我现在就来看看这书里写了啥",83)
	dark()
	light()
	say("还好当初学密文时没偷跑啊，好累...",83)
	say("所以这本子写的究竟是？",0)
	say("小师父你赚到啦～这本子里写的是金蛇剑的秘传招式",83)
	say("以及真正的金蛇剑锥同使之法～",83)
	say("详情是这样子滴～",0)
	setLW1(40)
	instruct_35(0,0,40,1)
	instruct_35(0,2,173,1)
	QZXS("领悟金蛇秘传！")
	say("哈哈哈，谢谢俏徒弟！",0)
	say("以后谁敢欺负你，为师见一个打一个！！",0)
	else
	say("错手误杀了他们已经很愧疚了",0)
	say("还是让这册子一起入土了吧",0)
	say("小师父......",83)
	daode(2)
	end
  end	
end

OEVENTLUA[621] = function()
  instruct_0()
  instruct_3(-2, -2, -2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
end

OEVENTLUA[690] = function()
  --local r = JYMsgBox(CC.EVB153, CC.EVB154, CC.EVB155, 3, 261) 武骧金星：双儿这里直接休息
  --if r == 1 then
	say("公子，你回来啦！*在外面奔波这么久，一定很辛苦吧。*让双儿服侍您歇息。", 261, 0, "双儿")
    instruct_14()
    instruct_12()
    instruct_13()
    instruct_1(2830, 261, 0)
	local r=math.random(3)
	if JY.Person[0]["受伤程度"]>=30 then
	r=1
	end
	
	if r==1 then
	say("公子，在你休息时我收拾了一下房间。*发现了这些东西。", 261, 0, "双儿")
	if math.random(100) <= 50 then
	   addthing(174, math.random(100, 1000))		
	else
	   local thing = randomthing()
	   addthing(thing, math.random(1, 5))		
	end
	say("哈哈！赚到了赚到了！")
    else
	
	end
	instruct_0()

--[[
  elseif r == 2 then
    JY.Person[445]["等级"] = JY.Person[0]["等级"] * 30
    JY.Person[446]["等级"] = JY.Person[445]["等级"]
    JY.Person[445]["头像代号"] = math.random(190)
    JY.Person[446]["头像代号"] = math.random(190)
    JY.Person[445]["生命最大值"] = 1
    JY.Person[446]["生命最大值"] = 1
    JY.Person[445]["生命"] = JY.Person[445]["生命最大值"]
    JY.Person[446]["生命"] = JY.Person[446]["生命最大值"]
    instruct_6(226, 8, 0, 1)
    JY.Person[445]["等级"] = 10
    JY.Person[446]["等级"] = 10
    JY.Person[445]["头像代号"] = 208
    JY.Person[446]["头像代号"] = 208
  end
--]]
end

OEVENTLUA[691] = function()
  instruct_66(42)
  instruct_3(-2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
  instruct_19(16, 31)
  instruct_40(2)
  instruct_0()
  instruct_30(16, 31, 9, 31)
  instruct_0()
  instruct_14()
  instruct_3(-2, 62, 0, 0, 0, 0, 0, 8250, 8250, 8250, -2, -2, -2)
  instruct_3(-2, 4, 0, 0, 0, 0, 0, 0, 0, 0, -2, -2, -2)
  instruct_0()
  instruct_3(-2, 2, 1, 0, 690, 0, 0, 6086, 6086, 6086, -2, -2, -2)
  instruct_0()
  instruct_32(174, 1000)
  instruct_0()
  instruct_32(234, 1)
  instruct_0()
  instruct_32(182, 1)
  instruct_0()
  instruct_3(-2, 4, 1, 0, 695, 0, 0, 8250, 8250, 8250, -2, -2, -2)
  instruct_3(-2, 3, 1, 0, 694, 0, 0, 5098, 5098, 5098, -2, -2, -2)
  instruct_3(-2, 61, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
  instruct_3(-2, 62, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
  instruct_39(19)
  instruct_39(101)
  instruct_39(36)
  instruct_39(28)
  instruct_39(93)
  instruct_0()
  instruct_13()  
end
 
OEVENTLUA[707] = function()
  instruct_1(2879, 210, 0)
  local lhq = 0
  if JY.Scene[1]["进入条件"] == 0 then
    for i = 1, 200 do
      if JY.Base["物品" .. i] == 112 then
        lhq = 1
      end
    end
  end
  if lhq == 0 then
    instruct_32(112, 1)
    SetD(28, 11, 2, 0)
  end
end

OEVENTLUA[712] = function()
  instruct_1(2884, 210, 0)
  instruct_0()
  if instruct_5(2, 0) == false then
    return
  end
  instruct_1(2881, 210, 0)
  instruct_0()
  instruct_19(41, 14)
  instruct_0()
  if instruct_6(217, 0, 7, 1) == true then
    instruct_19(41, 7)
    instruct_0()
    instruct_13()
    instruct_0()
  else
    instruct_19(42, 17)
    instruct_0()
    instruct_13()
    instruct_3(-2, -2, 1, 0, 709, 0, 0, -2, -2, -2, -2, -2, -2)
  end
end

OEVENTLUA[714] = function()
  instruct_3(-2, -2, 1, 0, 0, 0, 0, 2952, 2952, 2952, -2, -2, -2)
  instruct_0()
  if GetS(10, 0, 16, 0) == 1 then
      instruct_2(85, 1)
	  instruct_2(344, 1)
  end
  instruct_0()
  instruct_14()
  instruct_3(-2, 25, 1, 0, 713, 0, 0, -2, -2, -2, -2, -2, -2)
  instruct_19(42, 17)
  instruct_0()
  instruct_13()
end

OEVENTLUA[882] = function()
  instruct_0()
end

OEVENTLUA[1082] = function() --山洞mm事件
 --山洞mm数据初始化
  local id = 92
	if T8LXY(0) then --武骧金星：李逍遥没有山洞女主
		local rr = math.random(3)
		if rr == 1 then
			say("逍遥哥哥......你又要丢下人家不管吗......", 656)
			id = 656
		elseif rr == 2 then
			say("喂！你想就这样把我丢下吗！", 655)
			id = 655
		else
			say("逍遥哥哥，让人家跟着你嘛！", 657)
			id = 657
		end
		return 
	else
	    if instruct_20(20, 0) == true then
		   bgtalk("你的队伍已满....")
           do return end
		else   
		--mm4R()
		bgtalk("你来了..我已经等了你很久了....")
		say("你是....？")
		local pid = 92
		JY.Person[pid]["姓名"] = "";
		while JY.Person[pid]["姓名"] == "" or (tianshu() < 4 and JY.Person[pid]["姓名"] == "森九岚") do
			JY.Person[pid]["姓名"] = Shurufa(32, CC.ScreenH - 6 * CC.Fontbig)
		end		
		say("是了！我想起来了！你是"..JY.Person[pid]["姓名"].."！")
		if not GX(pid) and not LWS(pid) and not MRL(pid) and not SJL(pid) and not TMQ(pid) then
			say("你的长相....？")
			JY.Person[pid]["半身像"] = pickhead()
			local body = pickbody()
			JY.Person[92]["头像代号"] = JY.Person[body]["头像代号"]
			for i = 1, 5 do
				JY.Person[92]["出招动画帧数" .. i] = JY.Person[body]["出招动画帧数" .. i]
				JY.Person[92]["出招动画延迟" .. i] = JY.Person[body]["出招动画延迟" .. i]
				JY.Person[92]["武功音效延迟" .. i] = JY.Person[body]["武功音效延迟" .. i]
			end
			mmtfkf()
		end
		say("我好像在梦中见过你....")
		if JY.Person[zj()]["性别"] == 0 then
			JY.Person[92]["性别"] = 1
		else
			JY.Person[92]["性别"] = 0
		end

		JY.Person[92]["医疗能力"] = 30 --武骧金星：微调
		JY.Person[92]["用毒能力"] = 30
		JY.Person[92]["解毒能力"] = 30
		JY.Person[92]["抗毒能力"] = 30	
		--JY.Person[92]["内力性质"] = math.random(0, 2) 
		if JY.Person[0]["内力性质"] == 0 then
		  JY.Person[92]["内力性质"] = 1
		elseif JY.Person[0]["内力性质"] == 1 then
		  JY.Person[92]["内力性质"] = 0
		else
		  JY.Person[92]["内力性质"] = 2
		end	
		JY.Person[92]["资质"] = 100 - JY.Person[zj()]["资质"] --+ math.random(-5, 5)
		JY.Person[92]["资质"] = limitX(JY.Person[92]["资质"], 1, 100)
	end
    instruct_14()
    instruct_3(-2, -2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
    instruct_0()
    instruct_13()
	if GX(id) then --武骧金星：郭襄和陆无双特殊化
		JY.Person[92]["性别"] = 1
		JY.Person[92]["半身像"] = 568
		JY.Person[92]["头像代号"] = 226
		JY.Person[92]["出招动画帧数1"] = 0
		JY.Person[92]["出招动画帧数2"] = 9
		JY.Person[92]["出招动画帧数3"] = 8
		JY.Person[92]["出招动画帧数4"] = 8
		JY.Person[92]["出招动画帧数5"] = 9
		JY.Person[92]["出招动画延迟1"] = 8
		JY.Person[92]["出招动画延迟2"] = 8
		JY.Person[92]["出招动画延迟3"] = 8
		JY.Person[92]["出招动画延迟4"] = 8
		JY.Person[92]["出招动画延迟5"] = 8
		JY.Person[92]["武功音效延迟1"] = 8
		JY.Person[92]["武功音效延迟2"] = 8
		JY.Person[92]["武功音效延迟3"] = 8
		JY.Person[92]["武功音效延迟4"] = 8
		JY.Person[92]["武功音效延迟5"] = 8
		JY.Person[92]["资质"] = 90
		JY.Person[92]["内力性质"] = 0
        AddPersonAttrib(92, "拳掌功夫", 15)
        AddPersonAttrib(92, "御剑能力", 15)
        AddPersonAttrib(92, "耍刀技巧", 15)
        AddPersonAttrib(92, "特殊兵器", 15)
        AddPersonAttrib(92, "暗器技巧", 15)
		JY.Person[92]["技能2"] = 45
		JY.Person[578]["攻击力"]=12
        JY.Person[578]["防御力"]=6
		JY.Person[578]["轻功"]=0
		JoinMP(92,10,2)
		--JoinMP(92, 17, 4) --沼跃鱼：郭襄入桃花岛
		if MPPD(0) == 0 and JY.Person[0]["性别"] == 0 then--沼跃鱼：入桃花岛门派
			say("大哥哥，我终于找到你了。", 92)
			say("哦不，你不是大哥哥。但你和大哥哥长的那么像，要不跟我一起回桃花岛吧？", 92)
			if DrawStrBoxYesNo(-1, -1, "要学桃花岛的武功么？", C_WHITE, 30) == true then 
				if JY.Person[0]["资质"] >= 80 then
					JoinMP(0, 10, 1) 
				else	
					say("...大哥哥看起来不太聪明的样子，学不来呢！。", 92)
					say("智、智商歧视？", 0)
				end
			end
		end
		if MPPD(0) == 0 and JY.Person[0]["性别"] ~= 0 then--沼跃鱼：入桃花岛门派
			say("大姐姐，我终于找到你了。", 92)
			say("哦不，你不是大姐姐。但你和大姐姐长的那么像，要不跟我一起回桃花岛吧？", 92)
			if DrawStrBoxYesNo(-1, -1, "要学桃花岛的武功么？", C_WHITE, 30) == true then 
				if JY.Person[0]["资质"] >= 80 then
					JoinMP(0, 10, 1) 
				else	
					say("...大姐姐看起来不太聪明的样子，学不来呢！。", 92)
					say("智、智商歧视？", 0)
				end
			end	
		end
	elseif LWS(id) then 
		JY.Person[92]["性别"] = 1
		JY.Person[92]["半身像"] = 569
		JY.Person[92]["头像代号"] = 304
		JY.Person[92]["出招动画帧数3"] = 7
		JY.Person[92]["出招动画延迟3"] = 8
		JY.Person[92]["武功音效延迟3"] = 8
		JY.Person[92]["资质"] = 50
		JY.Person[92]["内力性质"] = 0
        AddPersonAttrib(92, "御剑能力", 10)
        AddPersonAttrib(92, "拳掌功夫", 20)
        AddPersonAttrib(92, "耍刀技巧", 20)
		JY.Person[92]["技能2"] = 80
		JY.Person[578]["攻击力"]=156
        JY.Person[578]["防御力"]=121
		JY.Person[578]["轻功"]=0
		JoinMP(92, 3, 1)
		addthing(313)
		addthing(316)
		if MPPD(0) == 0 and JY.Person[0]["性别"] == 0 then
			say("傻蛋，傻蛋，我终于找到你了。", 92)
			say("哦不，你不是傻蛋，傻蛋跟龙姑娘走了。你长的那么像傻蛋，要不跟我一起去古墓见傻蛋吧？", 92)
			if DrawStrBoxYesNo(-1, -1, "要学古墓派的武功么？", C_WHITE, 30) == true then JoinMP(0, 3, 1) end
		end
		if MPPD(0) == 0 and JY.Person[0]["性别"] ~= 0 then
			say("表姐，表姐，我终于等到你了。", 92)
			say("哦不，你不是表姐。傻蛋跟龙姑娘走了。要不跟我一起去古墓见傻蛋吧？", 92)
			if DrawStrBoxYesNo(-1, -1, "要学古墓派的武功么？", C_WHITE, 30) == true then JoinMP(0, 3, 1) end
		end			
	elseif MRL(id) then 
		JY.Person[92]["性别"] = 1
		JY.Person[92]["半身像"] = 571
		JY.Person[92]["头像代号"] = 224	
		JY.Person[92]["出招动画帧数3"] = 11
		JY.Person[92]["出招动画延迟3"] = 8
		JY.Person[92]["武功音效延迟3"] = 8
		JY.Person[92]["资质"] = 30
		JY.Person[92]["内力性质"] = 0
		JY.Person[92]["技能2"] = 28
        AddPersonAttrib(92, "拳掌功夫", 10)
        AddPersonAttrib(92, "御剑能力", 10)
        AddPersonAttrib(92, "耍刀技巧", 10)
        AddPersonAttrib(92, "特殊兵器", 10)
        AddPersonAttrib(92, "暗器技巧", 20)
		JY.Person[578]["攻击力"]=44
		JY.Person[578]["防御力"]=0
		JY.Person[578]["轻功"]=116
	--[[
	elseif TMQ(id) then 
		JY.Person[92]["性别"] = 1
		JY.Person[92]["半身像"] = 589
		JY.Person[92]["头像代号"] = 339
		JY.Person[92]["出招动画帧数3"] = 8
		JY.Person[92]["出招动画延迟3"] = 8
		JY.Person[92]["武功音效延迟3"] = 8
		JY.Person[92]["资质"] = 80
		JY.Person[92]["内力性质"] = 0
		JY.Person[92]["技能2"] = 38
		AddPersonAttrib(92, "暗器技巧", 50)
		JY.Person[578]["攻击力"]=0
		JY.Person[578]["防御力"]=0
		JY.Person[578]["轻功"]=191
		JoinMP(92, 9, 2)
		say("是你？你也是来采集硝石的吗？", 92)
		say("你居然不知道硝石是什么东西？难道你没听过天下三大暗器之一的霹雳雷火弹？", 92)
		say("这么没常识可不行啊。",92)
		if MPPD(0) == 0 then
			say("这样吧，看在你勤勉好学的份上，本小姐就破例收你做跟班。", 92)
			if DrawStrBoxYesNo(-1, -1, "要做唐大小姐的跟班么？", C_WHITE, 30) == true then JoinMP(0, 9, 1) end
		end
	]]
	end
	instruct_10(id)
    return 
  end
  instruct_0()
  instruct_14()
  instruct_3(-2, -2, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0)
  if JY.Person[92]["性别"] == 1 then
	instruct_3(70, 1, 1, 0, 199, 0, 0, 7266, 7266, 7266, -2, -2, -2)
  else
	instruct_3(70, 1, 1, 0, 199, 0, 0, 2522*2, 2522*2, 2522*2, -2, -2, -2)
  end
  instruct_0()
  instruct_13()
end

OEVENTLUA[2001] = function()
  say(CC.s49)   --不好！有埋伏----
  if WarMain(237) then
  	instruct_3(13, 101, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2, -2)
  	instruct_3(13, 102, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2, -2)
  else
  	instruct_15()
  	return;
  end
end

OEVENTLUA[2002] = function()
  PlayMIDI(3)
  say(CC.EVB92)
  instruct_30(48, 36, 30, 42)
  say(CC.EVB93)
  JY.MyPic = 1
  for i = 2997, 3006 do
    SetS(80, 30, 42, 1, i * 2)
    DrawSMap()
    ShowScreen()
    lib.Delay(200)
  end
  SetS(80, 30, 40, 1, 7104)
  SetS(80, 29, 44, 1, 7108)
  SetS(80, 31, 44, 1, 7108)
  say(CC.EVB94, 103)
  say(CC.EVB95, 62, 1)
  say(CC.EVB96, 60)
  say(CC.EVB97, 553, 4, "???")
  say(CC.EVB98, 60)
  for i = 45, 25, -1 do
    SetS(80, i + 1, 41, 1, 0)
    SetS(80, i + 1, 41, 2, 0)
    SetS(80, i + 1, 41, 4, 0)
    SetS(80, i + 1, 41, 5, 0)
    SetS(80, i, 41, 1, 7094)
    SetS(80, i, 41, 2, 7120)
    SetS(80, i, 41, 4, 100)
    SetS(80, i, 41, 5, 60)
    DrawSMap()
    ShowScreen()
    lib.Delay(1)
  end
  for i = 1, 10 do
    SetS(80, 25, 41, 1, 0)
    SetS(80, 25, 41, 2, 0)
    SetS(80, 25, 41, 1, 7094)
    SetS(80, 25, 41, 2, 7120)
    SetS(80, 25, 41, 4, 100 - i * 5)
    SetS(80, 25, 41, 5, 60 - i * 5)
    DrawSMap()
    ShowScreen()
    lib.Delay(1)
  end
  for i = 1, 3 do
    SetS(80, 25, 41, 1, 0)
    DrawSMap()
    ShowScreen()
    lib.Delay(1)
    SetS(80, 25, 41, 1, 7094)
    DrawSMap()
    ShowScreen()
    lib.Delay(1)
  end
  SetS(80, 25, 41, 1, 0)
  SetS(80, 25, 41, 4, 0)
  for i = 1, 3 do
    SetS(80, 28, 41, 1, 7100)
    DrawSMap()
    ShowScreen()
    lib.Delay(1)
    SetS(80, 28, 41, 1, 0)
    DrawSMap()
    ShowScreen()
    lib.Delay(1)
  end
  SetS(80, 28, 41, 1, 7100)
  for i = 1, 20 do
    SetS(80, 25, 41, 5, i * 10)
    DrawSMap()
    ShowScreen()
    lib.Delay(1)
  end
  SetS(80, 25, 41, 5, 0)
  SetS(80, 25, 41, 2, 0)
  say(CC.EVB99, 553, 5, "???")
  lib.FillColor(0, 0, CC.ScreenW, CC.ScreenH, C_BLACK)
  ShowScreen()
  lib.Delay(100)
  for i = 1, 20 do
    DrawStrBox(-1, -1, CC.EVB100, C_GOLD, 10 + i)
    ShowScreen()
    lib.Delay(1)
    if i == 20 then
      lib.Delay(1000)
    end
  end
  for i = 1, 20 do
    DrawStrBox(-1, -1, CC.EVB101, C_WHITE, 10 + i)
    ShowScreen()
    lib.Delay(1)
    if i == 20 then
      lib.Delay(1000)
    end
  end
  SetS(80, 30, 40, 1, 0)
  SetS(80, 29, 44, 1, 0)
  SetS(80, 31, 44, 1, 0)
  SetS(80, 28, 41, 1, 0)
  SetS(80, 30, 42, 1, 0)
  instruct_3(80, 100, 0, 0, 0, 0, 2005, 0, 0, 0, 0, -2, -2)
end

--商店卖东西
OEVENTLUA[2003] = function()
  repeat
	  -- itemG = {50, 150, 20, 50, 100, 150, 120, 300, 10, 30, 80, 40, 100, 200, 150, 200, 300, 50, 100, 150, 200, 40, 80, 120, 180, 300, 300, 10, 20, 40, 60, 60, 70, 70, 100, 900, 1000, 300, 400, 600, 500, 300, 900, 700, 600, 500, 400, 300, 1000, 800, 500, 500, 400, 400, 2000, 2000, 2000, 1200, 800, 750, 650, 550, 400, 800, 800, 700, 600, 700, 800, 700, 800, 700, 800, 900, 700, 700, 900, 1100, 800, 900, 900, 900, 1200, 1200, 1200, 1200, 1100, 900, 700, 700, 800, 600, 1100, 700, 700, 800, 700, 700, 600, 600, 700, 600, 600, 500, 500, 400, 300, 400, 400, 300, 400, 100, 1200, 1200, 1000, 1000, 800, 1000, 700, 600, 600, 600, 700, 600, 500, 500, 500, 500, 500, 400, 400, 400, 300, 200, 1000, 1000, 800, 700, 700, 700, 600, 500, 400, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 400, 300, 400, 500, 400, 300, 400, 200, 150, 1000, 800, 750, 750, 700, 650, 600, 0, 600, 500, 400, 400, 450, 450, 350, 0, 450, 500, 300, 200, 600, 400, 500, 300, 450, 450, 550, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 10, 20, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1000, 1000, 0, 0, 0, 0, 0, 0, 0, 0, 700, 0, 0, 0, 0, 800, 900, 450; [0] = 20}
	  say(CC.EVB127, 223, 0, CC.EVB128)
	  local item = MenuDSJ()
	  if item > -1 and DrawStrBoxYesNo(-1, -1, CC.EVB129 .. JY.Thing[item]["名称"] .. CC.EVB130, C_WHITE, 30) then
	    if item < 36 then
	      Cls()
	      DrawStrBoxWaitKey(CC.EVB131, C_WHITE, 30)
	      local items = 0
	      for i = 1, 200 do
	        if JY.Base["物品" .. i] == item then
	          items = JY.Base["物品数量" .. i]
	        end
	      end
	      local T = {}
	      for a = 1, 1000 do
	        local b = "" .. a
	        T[b] = a
	      end
	      local r = GetPinyin1(32, CC.ScreenH - CC.Fontbig * 6)
	      if T[r] ~= nil and T[r] <= items then
	        instruct_32(item, -T[r])
	        instruct_2(174, math.modf(JY.Thing[item]["价钱"] * T[r] * 0.2))
	      else
	      	DrawStrBoxWaitKey(CC.EVB132, C_WHITE, 30)
	      end
	  	elseif JY.Thing[item]["使用人"] == -1 then
	      if item ~= 40 then
	        instruct_32(item, -1)
	        instruct_2(174, math.modf(JY.Thing[item]["价钱"] * 0.2))
		    else
		      say(CC.EVB150, 223, 0, CC.EVB128)	--"这把金蛇剑是有产权认证的，要想卖出的话请带着它的产权认证人一起来！"
		      if instruct_16(54) then
			      say(CC.EVB151, 54, 5)
			      say(CC.EVB152, 223, 0, CC.EVB128)
			      instruct_32(item, -1)
			      instruct_2(174, JY.Thing[item]["价钱"])
			    end
		    end
		  else
	    	DrawStrBoxWaitKey(CC.EVB149, C_WHITE, 30)	--"此物品有人正在使用 无法卖出"
	  	end
		end
	  Cls()
	until not DrawStrBoxYesNo(-1, -1, CC.EVB133, C_WHITE, 30)
end

--买食材和药材
OEVENTLUA[2004] = function()
  say(CC.EVB134, 223, 0, CC.EVB128)
  if instruct_31(1000) then
    local r = JYMsgBox(CC.EVB135, CC.EVB136, CC.EVB137, 3, 223)
    Cls()
    if r == 1 then
      instruct_2(210, 30)
      instruct_32(174, -1000)
    elseif r == 2 then
      instruct_2(209, 50)
      instruct_32(174, -1000)
    else
      say(CC.EVB138, 0, 5)
    end
  else
    say(CC.EVB139, 0, 5)
  end
end

OEVENTLUA[2005] = function()
  instruct_3(80, 100, 0, 0, 0, 0, 0, 0, 0, 0, 0, -2, -2)
  if JY.Thing[202][WZ7] > 1 then
    SetS(80, 25, 25, 3, 101)
    instruct_3(80, 101, 1, 0, 2006, 0, 0, 6874, 6842, 6828, 10, -2, -2)
  end
end

OEVENTLUA[8501] = function()
	say("这里可以让你查询江湖上所有人物的资料。",220,0,"小二")
	say("请输入人物等级（1~8），输入9则显示全部人物列表",220,0,"小二")
	local T = {}
	for a = 1, 1000 do
	  local b = "" .. a
	  T[b] = a
	end
	local dj = -1
	while dj == -1 do
		local r = GetPinyin1(32, CC.ScreenH - CC.Fontbig * 6)
		if T[r] ~= nil and T[r] >= 1 and T[r] <= 12 then
		  dj = T[r]
		else
			DrawStrBoxWaitKey("输入错误", C_WHITE, 30)
		end
	end	
	say("要查看哪个人物？",220,0,"小二")
	local menu = {};
	local list = {}
	local page = 1
	for i = 1,JY.PersonNum - 1 do
		if i ~= 92 and ((dj == 10 and duiyou(i)) or (dj == 11 and MPPD(i) == 0 and duiyou(i)) or (dj == 12 and JY.Person[i]["排行"] == 0) or dj == 9 or JY.Person[i]["排行"] == dj) then
			menu[#menu + 1] = {i.." "..JY.Person[i]["姓名"],nil,1}
			list[#list + 1] = i
		end
	end
	Cls()
	local r = ShowMenu(menu,#menu, 15, CC.MainSubMenuX, CC.MainSubMenuY, 0, 0, 1, 1, CC.DefaultFont, C_ORANGE, C_WHITE)
	if r < 1 then
		return
	end
	local id = list[r] 
	while true do
		Cls()
		page = limitX(page, 1, 2)
		--ShowPersonStatus_sub(list[r],page)
		if page == 1 then
			ShowPersonStatus_sub(list[r], page)
		elseif page == 2 then
			page = NLJS(list[r], page)
			if page == -1 then
				break
			end
			Cls()
			ShowPersonStatus_sub(list[r], page)
			ShowScreen()
		else
			ShowPersonStatus_sub(list[r], page)
		end	
		ShowScreen();
		local keypress = WaitKey()
		if keypress == VK_LEFT then
	  		page = page - 1;
   		elseif keypress == VK_RIGHT then
	  		page = page + 1;
	  	elseif keypress == VK_UP then
	  		r = r - 1
	  	elseif keypress == VK_DOWN then
	  		r = r + 1
		elseif keypress == 27 then
	  		break
		end
		if r < 1 then
			r = 1
		end
		if r > #list then
			r = #list
		end
	end
end 
 
dofile (CONFIG.ScriptPath .."MyOEvent.lua");
dofile (CONFIG.ScriptPath .."nino_event.lua");
dofile (CONFIG.ScriptPath .."nino_new_event.lua");
--dofile (CONFIG.ScriptPath .."CatDIYOEvent.lua");

--dofile (CONFIG.ScriptPath .."nino_weirdstuff.lua");

--dofile (CONFIG.ScriptPath .."change_zhujue.lua");
--dofile (CONFIG.ScriptPath .."nino_MP_event.lua");

--执行旧的事件函数
function oldCallEvent(eventnum)
  local eventfilename = string.format("oldevent_%d.lua", eventnum)
  lib.Debug(eventfilename)
  dofile(CONFIG.OldEventPath .. eventfilename)
end--调用原有的指定位置的函数
--旧的函数名字格式为  oldevent_xxx();  xxx为事件编号
function oldEventExecute(flag)
  local eventnum = nil
  if flag == 1 then
    eventnum = GetD(JY.SubScene, JY.CurrentD, 2)
  elseif flag == 2 then
    eventnum = GetD(JY.SubScene, JY.CurrentD, 3)
  elseif flag == 3 then
    eventnum = GetD(JY.SubScene, JY.CurrentD, 4)
  end
  if eventnum > 0 then	
    if OEVENTLUA[eventnum] ~= nil then			
		OEVENTLUA[eventnum]()
    else
	  	--事件验证
	    if FileHSZ(CONFIG.DataPath .. "kdef.grp") ~= -433326955 then
	    	--lib.Debug(FileHSZ(CONFIG.DataPath .. "kdef.grp"));
	      --xx = xx
	    end
	    oldCallEvent(eventnum)
    end
	diyevent(eventnum)	
  end
end

function null(sid, pid)
	addevent(sid, pid, 0, 0, 0, 0)
end

function diyevent(eventnum) --事件中增加坐标和事件
	if eventnum == 883 then		
		addpoint(56, 20, 26, 27)
		addpoint(56, 21, 20, 13)
		addpoint(56, 22, 13, 26)
		addpoint(56, 23, 13, 34)	
		addevent(56, 20, 1, 3000, nil, 0)
		if GetD(1, 15, 4) == 884 then
			setzx(151, 1)
		else
			setzx(151, 2)
		end
	end
	if (eventnum == 701 or eventnum == 722 or eventnum == 729 or eventnum == 737) and not hasthing(234) then
		JY.Scene[107]["进入条件"] = 0
		JY.Scene[108]["进入条件"] = 0
		JY.Scene[109]["进入条件"] = 0
		JY.Scene[103]["进入条件"] = 0
		JY.Scene[105]["进入条件"] = 0
		JY.Scene[106]["进入条件"] = 0
		JY.Scene[110]["进入条件"] = 0
		JY.Scene[111]["进入条件"] = 0
		JY.Scene[112]["进入条件"] = 0	
        JY.Scene[113]["进入条件"] = 0		
	end
	if eventnum == 1 then
		addevent(3, 2, 1, 666, 1)
		addevent(3, 3, 1, 666, 1)
	end
	if eventnum == 39 then
		null(111, 10)
	end	
	if eventnum == 316 then
		null(96, 0)
	end	
	if eventnum == 369 then --欢总
		addevent(113, 4, 1, 5009, 1,9282,38,27)
		--addevent(-2, 19, 1, 1329, 1, 7150)
	end
end

--判断人物是否有某种武功
function PersonKF(p, kf)
    if WAR.PJTX == 1 and not DT(p,592) then --破尽天下
	   return false
	end
	if WAR.TLHD == 1 and not DT(p,583) then
		return false
	end 	
	if WAR.BMGT2 == p and JY.Person[p]["声望"] == kf then --北冥吸功体
		return false
	end
	if WAR.SGDF == kf and WAR.SGDF2 == p then
		return false
	end
    if PersonGT(p, 9999) and (JY.Thing[224]["加攻击力"] == kf or JY.Thing[224]["加防御力"] == kf) then 
	   return true
	end
	if DT(p,667) and kf <= JY.WugongNum - 1 and yongqing(kf) then
		return true
	end		
	if PersonGT(p, kf) then --有功体则判定有武功
	--[[
	    for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
			if WAR.SGDF2 == p and JY.Person[p]["武功"..i] == kf and WAR.SGDF == kf then 
				return false
			else
				return true
			end
		end
	]]
		return true
	end
	for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
		if JY.Person[p]["武功" .. i] == kf then
		--[[
			if WAR.BMGT2 == p and JY.Person[p]["声望"] == kf then
				return false
			elseif WAR.SGDF == kf and WAR.SGDF2 == p then 
				return false
			else
				return true
			end
		]]
			return true
		end
		if JY.Person[p]["武功" .. i] == 9999 and (JY.Thing[224]["加攻击力"] == kf or JY.Thing[224]["加防御力"] == kf) then 
			return true
		end
	end	
	return false
end

--判断人物是否有某种武功，并且等级为极
function PersonKFJ(p, kf)
    if WAR.PJTX == 1 and not DT(p,592) then --破尽天下
	   return false
	end
	if WAR.TLHD == 1 and not DT(p,583) then
	   return false
	end 
	for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
    if JY.Person[p]["武功" .. i] == kf and JY.Person[p]["武功等级" .. i] >= 999 then
      return true
    end
  end
  return false
end

--判断人物是否为队友，不管在不在队
function isteam(p)
	return duiyou(p)
end


--显示拼音
--x,y为拼音显示的坐标
function Shurufa(x, y)
  local pinyin = ""
  local word = ""
  while 1 do
    local tmp = nil
    pinyin, tmp = GetPinyin(x, y, word)
    if tmp ~= nil then
      word = tmp
    end
    if pinyin == "finish" then
      break;
	  elseif pinyin ~= -1 and pinyin ~= "" then
	    word = word .. (SeleteHanzi(x, y, word, pinyin) or "")
    end
  end
  return word
end

--可选择的汉字
--x,y为文字显示的坐标
--word为已经输入好的文字
--pinyin为输入的拼音
function SeleteHanzi(x, y, word, pinyin)
  local T1 = {
de = {"的", "地", "得", "德", "底", "锝"}, 
di = {"的", "地", "第", "提", "低", "底", "抵", "弟", "迪", "递", "帝", "敌", "堤", "蒂", "缔", "滴", "涤", "翟", "娣", "笛", "棣", "荻", "谛", "狄", "邸", "嘀", "砥", "坻", "诋", "嫡", "镝", "碲", "骶", "氐", "柢", "绨", "籴", "羝", "睇", "觌"}, 
yi = {"一", "以", "已", "意", "议", "义", "益", "亿", "易", "医", "艺", "依", "移", "衣", "异", "伊", "仪", "宜", "遗", "疑", "毅", "谊", "亦", "疫", "役", "忆", "抑", "乙", "译", "翼", "溢", "椅", "沂", "逸", "蚁", "夷", "邑", "怡", "绎", "彝", "裔", "姨", "熠", "贻", "矣", "屹", "颐", "倚", "诣", "胰", "奕", "翌", "弈", "轶", "驿", "壹", "猗", "臆", "弋", "铱", "旖", "漪", "迤", "佚", "翊", "诒", "怿", "痍", "懿", "饴", "峄", "揖", "眙", "镒", "仡", "黟", "肄", "咿", "翳", "挹", "缢", "呓", "刈", "咦", "嶷", "羿", "钇", "殪", "荑", "薏", "蜴", "镱", "噫", "癔", "苡", "悒", "嗌", "瘗", "欹", "佾", "埸", "圯", "舣", "酏", "劓"}, 
guo = {"国", "过", "果", "郭", "锅", "裹", "帼", "涡", "椁", "蝈", "虢", "聒", "埚", "掴", "猓", "崞", "蜾", "呙", "馘"}, 
zai = {"在", "再", "灾", "载", "栽", "仔", "宰", "哉", "崽", "甾"}, 
ren = {"人", "任", "认", "仁", "忍", "韧", "刃", "纫", "饪", "妊", "荏", "稔", "壬", "仞", "轫", "衽", "葚"}, 
le = {"了", "乐", "勒", "肋", "叻", "鳓", "仂", "泐"}, 
liao = {"了", "料", "疗", "辽", "廖", "聊", "寥", "僚", "燎", "缭", "撂", "撩", "嘹", "潦", "镣", "寮", "蓼", "獠", "钌", "尥", "鹩"}, 
you = {"有", "由", "又", "优", "游", "油", "友", "右", "邮", "尤", "忧", "幼", "犹", "诱", "悠", "幽", "佑", "釉", "柚", "铀", "鱿", "囿", "酉", "攸", "黝", "莠", "猷", "蝣", "疣", "呦", "蚴", "莸", "莜", "铕", "宥", "繇", "卣", "牖", "鼬", "蝤", "尢", "蚰", "侑"}, 
zhong = {"中", "重", "种", "众", "终", "钟", "忠", "仲", "衷", "肿", "踵", "冢", "盅", "忪", "锺", "舯", "螽"}, 
shi = {"是", "市", "时", "实", "事", "十", "使", "世", "施", "式", "势", "视", "识", "师", "史", "示", "石", "食", "始", "士", "失", "适", "试", "什", "室", "似", "诗", "饰", "殖", "释", "驶", "氏", "逝", "湿", "蚀", "狮", "誓", "拾", "尸", "匙", "仕", "柿", "矢", "峙", "侍", "噬", "嗜", "拭", "嘘", "屎", "恃", "轼", "虱", "舐", "莳", "铈", "谥", "炻", "豕", "鲥", "螫", "酾", "筮", "埘", "弑", "蓍", "鲺", "贳"}, 
nian = {"年", "念", "酿", "粘", "碾", "廿", "捻", "撵", "拈", "蔫", "鲶", "埝", "鲇", "辇", "黏"}, 
he = {"和", "合", "河", "何", "核", "贺", "喝", "赫", "荷", "盒", "鹤", "吓", "呵", "禾", "菏", "壑", "褐", "涸", "阂", "阖", "劾", "诃", "颌", "嗬", "貉", "曷", "翮", "纥", "蚵", "盍"}, 
hu = {"和", "护", "户", "核", "湖", "互", "乎", "呼", "胡", "戏", "忽", "虎", "沪", "糊", "壶", "葫", "狐", "蝴", "弧", "瑚", "浒", "鹄", "琥", "扈", "唬", "滹", "惚", "祜", "囫", "斛", "笏", "醐", "猢", "怙", "唿", "戽", "槲", "觳", "煳", "鹕", "冱", "瓠", "岵", "鹱", "烀", "轷"}, 
huo = {"和", "活", "或", "货", "获", "火", "伙", "惑", "霍", "祸", "豁", "嚯", "藿", "锪", "蠖", "钬", "耠", "镬", "夥", "劐", "攉"}, 
da = {"大", "达", "打", "答", "塔", "搭", "沓", "瘩", "嗒", "哒", "耷", "鞑", "疸", "靼", "褡", "笪", "怛", "妲"}, 
dai = {"大", "代", "带", "待", "贷", "戴", "袋", "歹", "呆", "逮", "岱", "傣", "怠", "殆", "黛", "甙", "埭", "绐", "玳", "呔", "迨", "骀"}, 
ye = {"业", "也", "夜", "叶", "野", "液", "冶", "页", "爷", "耶", "邪", "咽", "椰", "哗", "烨", "掖", "拽", "曳", "晔", "谒", "腋", "噎", "揶", "靥", "邺", "铘"}, 
bu = {"不", "部", "步", "布", "补", "捕", "堡", "埔", "卜", "埠", "簿", "哺", "怖", "钚", "卟", "瓿", "逋", "晡", "醭", "钸"}, 
wei = {"为", "位", "委", "未", "维", "卫", "围", "违", "威", "伟", "危", "味", "微", "遗", "唯", "谓", "伪", "慰", "尾", "魏", "韦", "胃", "畏", "帷", "喂", "巍", "萎", "蔚", "纬", "潍", "尉", "渭", "惟", "薇", "苇", "炜", "圩", "娓", "诿", "玮", "崴", "桅", "偎", "逶", "猥", "囗", "葳", "隗", "痿", "猬", "涠", "嵬", "韪", "煨", "艉", "帏", "闱", "洧", "沩", "隈", "鲔", "軎"}, 
fa = {"发", "法", "罚", "乏", "伐", "阀", "筏", "砝", "垡", "珐"}, 
hui = {"会", "回", "挥", "汇", "惠", "辉", "恢", "徽", "绘", "毁", "慧", "灰", "贿", "卉", "悔", "徊", "秽", "溃", "荟", "晖", "彗", "讳", "诲", "珲", "堕", "诙", "蕙", "晦", "麾", "烩", "茴", "喙", "桧", "蛔", "洄", "浍", "虺", "恚", "蟪", "咴", "隳", "缋", "哕"}, 
kuai = {"会", "快", "块", "筷", "脍", "蒯", "侩", "浍", "郐", "狯", "哙"}, 
gong = {"工", "公", "共", "供", "功", "红", "贡", "攻", "宫", "巩", "龚", "恭", "拱", "躬", "弓", "汞", "蚣", "珙", "觥", "肱"}, 
jing = {"镜", "京", "精", "境", "竞", "景", "警", "竟", "井", "惊", "径", "经","静", "劲", "敬", "净", "镜", "睛", "晶", "荆", "兢", "靖", "泾", "憬", "鲸", "茎", "腈", "菁", "胫", "阱", "旌", "粳", "靓", "痉", "儆", "迳", "婧", "肼", "刭", "弪", "獍"}, 
shang = {"上", "商", "尚", "伤", "赏", "汤", "裳", "墒", "晌", "垧", "觞", "殇", "熵", "绱"}, 
yao = {"要", "约", "药", "邀", "陶", "摇", "耀", "腰", "遥", "姚", "窑", "瑶", "咬", "尧", "钥", "谣", "肴", "夭", "侥", "吆", "疟", "妖", "幺", "杳", "舀", "窈", "曜", "鹞", "爻", "繇", "徭", "轺", "铫", "鳐", "崾", "珧"}, 
ge = {"个", "合", "各", "革", "格", "歌", "哥", "盖", "隔", "割", "阁", "戈", "葛", "鸽", "搁", "屹", "胳", "舸", "疙", "铬", "骼", "蛤", "咯", "圪", "镉", "颌", "仡", "硌", "嗝", "鬲", "膈", "纥", "袼", "搿", "塥", "哿", "虼"}, 
chan = {"产", "单", "阐", "缠", "掺", "禅", "颤", "铲", "蝉", "搀", "潺", "蟾", "馋", "忏", "婵", "孱", "觇", "廛", "谄", "谗", "澶", "骣", "羼", "镡", "躔", "蒇", "冁"}, 
zhe = {"这", "者", "着", "浙", "折", "哲", "蔗", "遮", "辙", "辄", "柘", "锗", "褶", "蜇", "蛰", "鹧", "谪", "赭", "摺", "磔"}, 
chu = {"出", "处", "础", "初", "除", "储", "畜", "触", "楚", "厨", "雏", "矗", "橱", "锄", "褚", "滁", "躇", "怵", "绌", "搐", "刍", "蜍", "黜", "杵", "蹰", "亍", "樗", "憷", "楮"}, 
xing = {"行", "省", "性", "形", "型", "兴", "星", "刑", "幸", "姓", "醒", "邢", "杏", "腥", "猩", "悻", "荥", "陉", "惺", "饧", "擤", "硎", "荇"}, 
hang = {"行", "航", "杭", "巷", "夯", "吭", "珩", "沆", "绗", "颃"}, 
heng = {"行", "衡", "横", "恒", "亨", "哼", "珩", "桁", "蘅"}, 
zuo = {"作", "做", "座", "左", "坐", "昨", "佐", "琢", "凿", "搓", "撮", "祚", "柞", "唑", "嘬", "怍", "笮", "阼", "胙"}, 
sheng = {"生", "省", "声", "升", "胜", "盛", "乘", "圣", "剩", "牲", "绳", "笙", "甥", "嵊", "晟", "渑", "眚"}, 
jia = {"家", "加", "价", "假", "佳", "架", "甲", "嘉", "贾", "驾", "嫁", "夹", "稼", "钾", "茄", "挟", "迦", "伽", "颊", "浃", "枷", "戛", "荚", "痂", "镓", "笳", "珈", "岬", "胛", "嘏", "袈", "郏", "葭", "袷", "瘕", "铗", "跏", "蛱", "恝"}, 
jie = {"家", "结", "解", "价", "界", "接", "节", "届", "介", "阶", "街", "借", "杰", "洁", "截", "姐", "揭", "捷", "劫", "戒", "皆", "竭", "桔", "诫", "楷", "秸", "睫", "藉", "拮", "芥", "诘", "碣", "嗟", "颉", "蚧", "孑", "婕", "疖", "桀", "讦", "疥", "偈", "羯", "喈", "鲒", "骱"}, 
cheng = {"成", "程", "城", "承", "称", "盛", "乘", "诚", "呈", "惩", "撑", "澄", "秤", "橙", "骋", "逞", "瞠", "丞", "铛", "埕", "塍", "噌", "蛏", "柽", "铖", "酲", "裎", "枨"}, 
dao = {"到", "道", "导", "岛", "倒", "刀", "盗", "稻", "蹈", "悼", "捣", "叨", "祷", "焘", "氘", "纛", "帱", "忉"}, 
ri = {"日"}, 
min = {"民", "敏", "闽", "闵", "皿", "泯", "岷", "悯", "珉", "抿", "黾", "缗", "玟", "愍", "苠", "鳘"}, 
lai = {"来", "莱", "赖", "睐", "徕", "籁", "涞", "赉", "濑", "癞", "崃", "铼"}, 
wo = {"我", "握", "窝", "沃", "卧", "挝", "涡", "斡", "渥", "幄", "蜗", "喔", "倭", "莴", "龌", "肟", "硪"}, 
dui = {"对", "队", "敦", "兑", "堆", "碓", "怼", "憝"}, 
jin = {"进", "金", "今", "近", "仅", "紧", "尽", "津", "斤", "禁", "锦", "劲", "晋", "谨", "筋", "巾", "浸", "襟", "靳", "瑾", "烬", "缙", "觐", "堇", "馑", "荩", "噤", "廑", "妗", "槿", "赆", "衿", "卺"}, 
duo = {"多", "度", "夺", "朵", "躲", "铎", "咄", "堕", "舵", "驮", "垛", "惰", "哆", "踱", "跺", "掇", "剁", "柁", "缍", "沲", "裰", "哚"}, 
quan = {"全", "权", "券", "泉", "圈", "拳", "劝", "犬", "铨", "痊", "诠", "荃", "醛", "蜷", "颧", "绻", "筌", "鬈", "悛", "辁", "畎"}, 
jian = {"建", "间", "件", "见", "坚", "检", "健", "监", "减", "简", "艰", "践", "兼", "鉴", "键", "渐", "柬", "剑", "尖", "肩", "舰", "荐", "箭", "浅", "剪", "俭", "碱", "茧", "奸", "歼", "拣", "捡", "煎", "贱", "溅", "槛", "涧", "笺", "谏", "饯", "锏", "缄", "睑", "謇", "蹇", "腱", "菅", "翦", "戬", "毽", "笕", "犍", "硷", "鞯", "牮", "枧", "湔", "鲣", "囝", "裥", "踺", "搛", "缣", "鹣", "蒹", "谫", "僭", "戋", "趼", "楗"}, 
ta = {"他", "它", "她", "拓", "塔", "踏", "塌", "榻", "沓", "漯", "獭", "嗒", "挞", "蹋", "趿", "遢", "铊", "鳎", "溻", "闼"}, 
kai = {"开", "凯", "慨", "楷", "恺", "揩", "锴", "铠", "忾", "垲", "剀", "锎", "蒈"}, 
men = {"们", "门", "闷", "扪", "焖", "懑", "钔"}, 
chang = {"场", "长", "厂", "常", "偿", "昌", "唱", "畅", "倡", "尝", "肠", "敞", "倘", "猖", "娼", "裳", "徜", "昶", "怅", "嫦", "菖", "鲳", "阊", "伥", "苌", "氅", "惝", "鬯"}, 
zhan = {"展", "战", "占", "站", "崭", "粘", "湛", "沾", "瞻", "颤", "詹", "斩", "盏", "辗", "绽", "毡", "栈", "蘸", "旃", "谵", "搌"}, 
li = {"理", "力", "利", "立", "里", "李", "历", "例", "离", "励", "礼", "丽", "黎", "璃", "厉", "厘", "粒", "莉", "梨", "隶", "栗", "荔", "沥", "犁", "漓", "哩", "狸", "藜", "罹", "篱", "鲤", "砺", "吏", "澧", "俐", "骊", "溧", "砾", "莅", "锂", "笠", "蠡", "蛎", "痢", "雳", "俪", "傈", "醴", "栎", "郦", "俚", "枥", "喱", "逦", "娌", "鹂", "戾", "唳", "坜", "疠", "蜊", "黧", "猁", "鬲", "粝", "蓠", "呖", "跞", "疬", "缡", "鲡", "鳢", "嫠", "詈", "悝", "苈", "篥", "轹"}, 
xin = {"新", "心", "信", "寻", "辛", "欣", "薪", "馨", "鑫", "芯", "锌", "忻", "昕", "衅", "歆", "囟", "镡"}, 
fang = {"方", "放", "房", "防", "访", "纺", "芳", "仿", "坊", "妨", "肪", "邡", "舫", "彷", "枋", "鲂", "钫"}, 
zhu = {"主", "术", "住", "注", "助", "属", "逐", "著", "筑", "驻", "朱", "珠", "祝", "猪", "诸", "柱", "竹", "铸", "株", "瞩", "嘱", "贮", "煮", "烛", "褚", "蛛", "拄", "铢", "洙", "竺", "蛀", "渚", "伫", "杼", "侏", "诛", "茱", "箸", "炷", "躅", "翥", "潴", "邾", "槠", "舳", "橥", "瘃", "麈", "疰"}, 
qi = {"奇", "其", "起", "期", "气", "七", "器", "汽", "奇", "齐", "启", "旗", "棋", "妻", "弃", "歧", "欺", "骑", "契", "迄", "亟", "漆", "戚", "岂", "稽", "岐", "琦", "栖", "缉", "琪", "泣", "乞", "砌", "祁", "崎", "绮", "祺", "蹊", "祈", "凄", "淇", "杞", "脐", "麒", "圻", "岖", "憩", "芪", "俟", "畦", "荠", "耆", "葺", "沏", "萋", "骐", "鳍", "綦", "讫", "蕲", "屺", "颀", "亓", "碛", "柒", "汔", "綮", "萁", "嘁", "蛴", "槭", "欹", "芑", "桤", "蜞"}, 
zi = {"资", "自", "子", "字", "咨", "滋", "仔", "姿", "紫", "兹", "孜", "淄", "籽", "梓", "鲻", "渍", "姊", "吱", "秭", "恣", "孳", "訾", "滓", "锱", "辎", "趑", "龇", "赀", "眦", "缁", "呲", "笫", "谘", "嵫", "髭", "茈", "粢", "觜", "耔"}, 
xue = {"学", "血", "雪", "削", "薛", "穴", "靴", "谑", "噱", "鳕", "踅", "泶"}, 
bao = {"报", "保", "包", "宝", "暴", "胞", "薄", "爆", "炮", "饱", "抱", "堡", "剥", "鲍", "曝", "葆", "瀑", "豹", "刨", "褒", "雹", "孢", "苞", "煲", "褓", "趵", "鸨", "龅"}, 
zhi = {"制", "之", "治", "质", "职", "只", "志", "至", "指", "织", "支", "值", "知", "识", "直", "致", "执", "置", "止", "植", "纸", "智", "殖", "秩", "旨", "址", "滞", "氏", "枝", "芝", "脂", "帜", "汁", "肢", "挚", "稚", "酯", "掷", "峙", "炙", "栉", "侄", "芷", "窒", "咫", "吱", "趾", "痔", "蜘", "郅", "桎", "雉", "祉", "陟", "痣", "蛭", "帙", "枳", "踯", "徵", "胝", "栀", "贽", "祗", "豸", "鸷", "摭", "轵", "卮", "轾", "彘", "觯", "絷", "跖", "埴", "黹", "忮", "骘", "膣", "踬"}, 
zheng = {"政", "正", "证", "争", "整", "征", "郑", "丁", "症", "挣", "蒸", "睁", "铮", "筝", "拯", "帧", "峥", "怔", "诤", "狰", "徵", "钲"}, 
ji = {"济", "机", "其", "技", "基", "记", "计", "系", "革", "期", "际", "及", "集", "级", "几", "给", "积", "极", "己", "纪", "即", "继", "击", "既", "激", "绩", "急", "奇", "吉", "季", "齐", "疾", "迹", "鸡", "剂", "辑", "籍", "寄", "挤", "圾", "冀", "亟", "寂", "暨", "脊", "跻", "肌", "稽", "忌", "饥", "祭", "缉", "棘", "矶", "汲", "畸", "姬", "藉", "瘠", "骥", "羁", "妓", "讥", "稷", "蓟", "悸", "嫉", "岌", "叽", "伎", "鲫", "诘", "楫", "荠", "戟", "箕", "霁", "嵇", "觊", "麂", "畿", "玑", "笈", "犄", "芨", "唧", "屐", "髻", "戢", "佶", "偈", "笄", "跽", "蒺", "乩", "咭", "赍", "嵴", "虮", "掎", "齑", "殛", "鲚", "剞", "洎", "丌", "墼", "蕺", "芰", "哜"}, 
yong = {"用", "永", "拥", "勇", "涌", "泳", "庸", "俑", "踊", "佣", "咏", "雍", "甬", "镛", "臃", "邕", "蛹", "恿", "慵", "壅", "痈", "鳙", "墉", "饔", "喁"}, 
tong = {"同", "通", "统", "童", "痛", "铜", "桶", "桐", "筒", "彤", "侗", "佟", "潼", "捅", "酮", "砼", "瞳", "恸", "峒", "仝", "恫", "嗵", "垌", "茼"}, 
yu = {"于", "与", "育", "余", "预", "域", "予", "遇", "语", "誉", "玉", "鱼", "雨", "渔", "裕", "谷", "愈", "娱", "欲", "吁", "舆", "宇", "羽", "逾", "豫", "郁", "寓", "狱", "喻", "御", "浴", "愉", "禹", "俞", "蔚", "榆", "愚", "渝", "尉", "淤", "虞", "屿", "峪", "粥", "驭", "瑜", "禺", "毓", "钰", "隅", "芋", "熨", "瘀", "迂", "煜", "昱", "於", "臾", "盂", "聿", "竽", "萸", "妪", "腴", "圄", "谕", "觎", "揄", "龉", "谀", "俣", "馀", "庾", "妤", "瘐", "鬻", "欤", "腧", "鹬", "阈", "嵛", "雩", "鹆", "菀", "圉", "蜮", "伛", "纡", "窬", "窳", "饫", "蓣", "狳", "舁", "蝓", "燠"}, 
gao = {"高", "告", "搞", "稿", "膏", "糕", "镐", "皋", "羔", "锆", "杲", "郜", "睾", "诰", "藁", "篙", "缟", "槁", "槔"}, 
zhang = {"长", "张", "章", "障", "涨", "掌", "帐", "胀", "彰", "丈", "仗", "漳", "樟", "账", "杖", "璋", "嶂", "仉", "瘴", "蟑", "獐", "幛", "鄣", "嫜"}, 
xian = {"现", "先", "县", "见", "线", "限", "显", "险", "献", "鲜", "洗", "宪", "纤", "陷", "闲", "贤", "仙", "衔", "掀", "咸", "嫌", "羡", "弦", "腺", "痫", "娴", "舷", "馅", "酰", "铣", "冼", "涎", "暹", "籼", "锨", "苋", "蚬", "跹", "岘", "藓", "燹", "鹇", "氙", "莶", "霰", "跣", "猃", "祆", "筅"}, 
ben = {"本", "奔", "苯", "笨", "夯", "贲", "锛", "畚", "坌"}, 
yue = {"月", "说", "约", "越", "乐", "跃", "阅", "岳", "粤", "悦", "曰", "钥", "栎", "钺", "樾", "瀹", "龠", "刖"}, 
ding = {"定", "订", "顶", "丁", "鼎", "盯", "钉", "锭", "叮", "仃", "铤", "町", "酊", "啶", "碇", "腚", "疔", "玎", "耵"}, 
hua = {"化", "华", "划", "话", "花", "画", "滑", "哗", "豁", "骅", "桦", "猾", "铧", "砉"}, 
dong = {"动", "东", "董", "冬", "洞", "懂", "冻", "栋", "侗", "咚", "峒", "氡", "恫", "胴", "硐", "垌", "鸫", "岽", "胨"}, 
pin = {"品", "贫", "聘", "频", "拼", "苹", "拚", "颦", "姘", "嫔", "榀", "牝"}, 
chong = {"重", "种", "充", "冲", "涌", "崇", "虫", "宠", "忡", "憧", "舂", "茺", "铳", "艟"}, 
guan = {"关", "管", "观", "馆", "官", "贯", "冠", "惯", "灌", "罐", "莞", "纶", "棺", "矜", "倌", "鹳", "鳏", "盥", "掼", "涫"}, 
fen = {"分", "份", "纷", "奋", "粉", "氛", "芬", "愤", "粪", "坟", "汾", "焚", "酚", "吩", "忿", "棼", "玢", "鼢", "瀵", "偾", "鲼"}, 
wai = {"外", "歪"}, 
qu = {"区", "去", "取", "且", "曲", "趋", "渠", "趣", "驱", "屈", "躯", "衢", "娶", "祛", "瞿", "戌", "岖", "龋", "觑", "朐", "蛐", "癯", "蛆", "苣", "阒", "诎", "劬", "蕖", "蘧", "氍", "黢", "蠼", "璩", "麴", "鸲", "磲"}, 
ou = {"区", "欧", "偶", "殴", "呕", "藕", "讴", "鸥", "瓯", "沤", "耦", "怄"}, 
neng = {"能"}, 
she = {"设", "社", "摄", "涉", "射", "折", "舍", "蛇", "舌", "奢", "慑", "赦", "赊", "佘", "麝", "歙", "畲", "厍", "摺", "猞", "滠"}, 
hou = {"后", "候", "厚", "侯", "猴", "喉", "吼", "逅", "篌", "糇", "骺", "後", "鲎", "瘊", "堠"}, 
jiu = {"就", "究", "九", "酒", "久", "救", "旧", "纠", "舅", "灸", "疚", "揪", "咎", "韭", "玖", "臼", "柩", "赳", "鸠", "鹫", "厩", "啾", "阄", "桕", "僦", "鬏"}, 
deng = {"等", "登", "邓", "灯", "澄", "凳", "瞪", "蹬", "噔", "磴", "嶝", "镫", "簦", "戥"}, 
ti = {"体", "提", "题", "替", "梯", "踢", "惕", "剔", "蹄", "啼", "屉", "剃", "涕", "锑", "倜", "悌", "逖", "嚏", "荑", "醍", "绨", "鹈", "缇", "裼"}, 
xia = {"下", "夏", "峡", "厦", "辖", "霞", "虾", "狭", "吓", "侠", "暇", "遐", "瞎", "匣", "瑕", "唬", "呷", "黠", "硖", "罅", "狎", "瘕", "柙"}, 
wan = {"万", "完", "晚", "湾", "玩", "碗", "顽", "挽", "弯", "蔓", "丸", "莞", "皖", "宛", "婉", "腕", "蜿", "惋", "烷", "娩", "琬", "畹", "豌", "剜", "纨", "绾", "脘", "菀", "芄"}, 
mo = {"万", "无", "没", "模", "末", "冒", "莫", "摩", "墨", "默", "磨", "摸", "漠", "脉", "膜", "魔", "沫", "陌", "抹", "寞", "蘑", "摹", "蓦", "馍", "茉", "嘿", "谟", "秣", "貉", "嫫", "镆", "殁", "耱", "瘼", "貊", "貘"}, 
yuan = {"元", "员", "院", "原", "源", "远", "愿", "园", "援", "圆", "缘", "袁", "怨", "渊", "苑", "冤", "媛", "猿", "垣", "沅", "塬", "垸", "鸳", "辕", "鸢", "瑗", "圜", "爰", "芫", "鼋", "橼", "螈", "眢", "箢", "掾"}, 
qian = {"前", "千", "钱", "签", "潜", "迁", "欠", "纤", "牵", "浅", "遣", "谦", "乾", "铅", "歉", "黔", "谴", "嵌", "倩", "钳", "茜", "虔", "堑", "钎", "骞", "阡", "掮", "钤", "扦", "芊", "犍", "箬", "荨", "仟", "芡", "悭", "缱", "佥", "愆", "褰", "肷", "岍", "搴", "箝", "慊", "椠"}, 
mian = {"面", "棉", "免", "绵", "缅", "勉", "眠", "冕", "娩", "腼", "渑", "湎", "沔", "眄"}, 
nong = {"农", "浓", "弄", "脓", "侬", "哝"}, 
shuo = {"说", "数", "硕", "烁", "朔", "铄", "妁", "槊", "蒴", "搠"}, 
shui = {"说", "水", "税", "谁", "睡"}, 
yun = {"员", "运", "均", "云", "允", "孕", "蕴", "韵", "酝", "耘", "晕", "匀", "芸", "陨", "纭", "熨", "郧", "恽", "韫", "郓", "氲", "殒", "愠", "昀", "狁"}, 
er = {"而", "二", "尔", "儿", "耳", "迩", "饵", "洱", "贰", "铒", "珥", "佴", "鸸", "鲕"}, 
wu = {"务", "物", "无", "五", "武", "午", "吴", "舞", "伍", "污", "乌", "误", "亡", "恶", "屋", "晤", "悟", "吾", "雾", "芜", "梧", "勿", "巫", "侮", "坞", "毋", "诬", "呜", "钨", "邬", "捂", "鹜", "兀", "婺", "妩", "於", "戊", "鹉", "浯", "蜈", "唔", "骛", "仵", "焐", "芴", "鋈", "庑", "鼯", "牾", "怃", "圬", "忤", "痦", "迕", "杌", "寤", "阢"}, 
dian = {"电", "点", "店", "典", "奠", "甸", "碘", "淀", "殿", "垫", "颠", "滇", "癫", "巅", "惦", "掂", "癜", "玷", "佃", "踮", "靛", "钿", "簟", "坫", "阽"}, 
wen = {"文", "问", "闻", "稳", "温", "纹", "吻", "蚊", "雯", "紊", "瘟", "汶", "刎", "璺", "阌"}, 
ke = {"可", "科", "克", "客", "刻", "课", "颗", "渴", "壳", "柯", "棵", "呵", "坷", "恪", "苛", "咳", "磕", "珂", "稞", "瞌", "溘", "轲", "窠", "嗑", "疴", "蝌", "岢", "颏", "髁", "缂", "氪", "骒", "钶", "锞"}, 
zong = {"总", "综", "宗", "纵", "踪", "棕", "粽", "鬃", "偬", "枞", "腙"}, 
xmjc = {"零", "镜", "奇", "二", "四", "七", "水"}, 
gai = {"改", "该", "盖", "概", "溉", "钙", "丐", "芥", "赅", "垓", "陔", "戤"}, 
san = {"三", "散", "伞", "叁", "糁", "馓", "毵"}, 
hao = {"好", "号", "毫", "豪", "耗", "浩", "郝", "皓", "昊", "镐", "蒿", "壕", "灏", "嚎", "濠", "蚝", "貉", "颢", "嗥", "薅", "嚆"}, 
si = {"司", "四", "思", "斯", "食", "私", "死", "似", "丝", "饲", "寺", "厕", "肆", "撕", "泗", "伺", "嗣", "祀", "厮", "驷", "嘶", "锶", "俟", "巳", "蛳", "咝", "耜", "笥", "鸶", "缌", "澌", "姒", "汜", "厶", "兕"}, 
cong = {"从", "丛", "匆", "聪", "葱", "囱", "琮", "淙", "骢", "苁", "璁"}, 
ping = {"平", "评", "凭", "瓶", "冯", "屏", "萍", "苹", "乒", "坪", "枰", "娉", "俜", "鲆"}, 
dang = {"当", "党", "档", "荡", "挡", "宕", "砀", "裆", "凼", "菪", "谠"}, 
tian = {"天", "田", "添", "填", "甜", "恬", "腆", "佃", "舔", "阗", "忝", "殄", "畋", "掭"}, 
nei = {"内", "那", "哪", "馁"}, 
xiao = {"小", "效", "销", "消", "校", "晓", "笑", "肖", "削", "孝", "萧", "潇", "硝", "宵", "啸", "嚣", "霄", "淆", "哮", "筱", "逍", "箫", "骁", "枭", "哓", "绡", "蛸", "崤", "枵", "魈"}, 
mu = {"目", "模", "木", "亩", "幕", "母", "牧", "穆", "姆", "墓", "慕", "牟", "牡", "募", "睦", "沐", "暮", "拇", "姥", "钼", "苜", "仫", "毪", "坶"}, 
hai = {"海", "还", "害", "孩", "亥", "咳", "骸", "嘿", "骇", "氦", "嗨", "胲", "醢"}, 
suo = {"所", "索", "缩", "锁", "莎", "梭", "琐", "嗦", "唆", "唢", "娑", "蓑", "羧", "挲", "桫", "嗍", "睃"}, 
ru = {"入", "如", "乳", "儒", "辱", "汝", "茹", "褥", "孺", "濡", "蠕", "嚅", "缛", "溽", "铷", "洳", "薷", "襦", "颥", "蓐"}, 
liang = {"量", "两", "粮", "良", "辆", "亮", "梁", "凉", "谅", "粱", "晾", "靓", "踉", "莨", "椋", "魉", "墚"}, 
du = {"度", "都", "独", "督", "读", "顿", "毒", "渡", "杜", "堵", "赌", "睹", "肚", "镀", "渎", "笃", "嘟", "犊", "妒", "牍", "蠹", "椟", "黩", "芏", "髑"}, 
bei = {"北", "被", "备", "倍", "背", "杯", "贝", "辈", "悲", "碑", "臂", "卑", "悖", "惫", "蓓", "陂", "钡", "狈", "呗", "焙", "碚", "褙", "埤", "鞴", "孛", "鹎", "萆", "邶", "鐾"}, 
huan = {"还", "环", "换", "欢", "患", "缓", "唤", "焕", "幻", "痪", "桓", "寰", "涣", "宦", "洹", "浣", "豢", "奂", "郇", "圜", "獾", "鲩", "鬟", "萑", "逭", "漶", "锾", "缳", "擐"}, 
dou = {"都", "斗", "读", "豆", "抖", "兜", "陡", "逗", "窦", "蚪", "痘", "蔸", "篼"}, 
shu = {"术", "书", "数", "属", "树", "输", "束", "述", "署", "熟", "殊", "蔬", "舒", "疏", "鼠", "淑", "叔", "暑", "枢", "墅", "俞", "曙", "抒", "竖", "蜀", "薯", "梳", "戍", "恕", "孰", "沭", "赎", "庶", "漱", "塾", "倏", "澍", "纾", "姝", "菽", "黍", "腧", "秫", "毹", "殳", "摅", "丨"}, 
ming = {"明", "名", "命", "盟", "鸣", "铭", "冥", "茗", "溟", "酩", "瞑", "螟", "暝"}, 
zhao = {"着", "照", "招", "找", "召", "朝", "赵", "兆", "昭", "肇", "罩", "钊", "沼", "嘲", "爪", "诏", "啁", "棹", "笊"}, 
zhuo = {"着", "著", "缴", "桌", "卓", "捉", "琢", "灼", "浊", "酌", "拙", "茁", "涿", "镯", "啄", "濯", "焯", "倬", "擢", "斫", "棹", "诼", "浞", "禚"}, 
ci = {"次", "此", "词", "辞", "刺", "瓷", "磁", "兹", "慈", "茨", "赐", "祠", "伺", "雌", "疵", "鹚", "糍", "呲", "茈"}, 
jiang = {"将", "强", "江", "奖", "讲", "降", "疆", "蒋", "姜", "浆", "匠", "酱", "僵", "桨", "绛", "缰", "犟", "豇", "礓", "洚", "茳", "糨", "耩"}, 
qiang = {"将", "强", "抢", "墙", "枪", "腔", "锵", "呛", "羌", "蔷", "襁", "羟", "跄", "樯", "戕", "嫱", "戗", "炝", "镪", "锖", "蜣"}, 
zeng = {"增", "曾", "综", "赠", "憎", "锃", "甑", "罾", "缯"}, 
xiang = {"向", "项", "相", "想", "乡", "象", "响", "香", "降", "像", "享", "箱", "祥", "湘", "详", "橡", "巷", "翔", "襄", "厢", "镶", "飨", "饷", "缃", "骧", "芗", "庠", "鲞", "葙", "蟓"}, 
ying = {"应", "营", "影", "英", "迎", "映", "硬", "盈", "赢", "颖", "婴", "鹰", "荧", "莹", "樱", "瑛", "蝇", "萦", "莺", "颍", "膺", "缨", "瀛", "楹", "罂", "荥", "萤", "鹦", "滢", "蓥", "郢", "茔", "嘤", "璎", "嬴", "瘿", "媵", "撄", "潆"}, 
mei = {"美", "没", "每", "煤", "梅", "媒", "枚", "妹", "眉", "魅", "霉", "谜", "昧", "媚", "玫", "酶", "镁", "湄", "寐", "莓", "袂", "楣", "糜", "嵋", "镅", "浼", "猸", "鹛"}, 
gui = {"规", "贵", "归", "轨", "桂", "柜", "圭", "鬼", "硅", "瑰", "跪", "龟", "闺", "诡", "癸", "炔", "鳜", "桧", "皈", "鲑", "刽", "晷", "傀", "妫", "炅", "庋", "簋", "刿", "宄", "匦"}, 
xie = {"些", "解", "协", "写", "血", "叶", "谢", "械", "鞋", "胁", "斜", "携", "懈", "契", "卸", "谐", "泄", "蟹", "邪", "歇", "泻", "屑", "挟", "燮", "榭", "蝎", "撷", "偕", "亵", "楔", "颉", "缬", "邂", "瀣", "勰", "榍", "薤", "绁", "渫", "廨", "獬", "躞"}, 
biao = {"表", "标", "彪", "勺", "镖", "裱", "膘", "飙", "镳", "婊", "骠", "飑", "杓", "髟", "鳔", "瘭"}, 
xi = {"系", "西", "席", "息", "希", "习", "吸", "喜", "细", "析", "戏", "洗", "悉", "锡", "溪", "惜", "稀", "袭", "夕", "晰", "昔", "牺", "腊", "烯", "熙", "媳", "栖", "膝", "隙", "犀", "蹊", "硒", "兮", "熄", "曦", "禧", "茜", "嬉", "玺", "奚", "汐", "徙", "羲", "铣", "淅", "嘻", "歙", "熹", "矽", "蟋", "郗", "唏", "皙", "隰", "樨", "浠", "蜥", "檄", "翕", "阋", "舾", "屣", "葸", "螅", "粞", "觋", "欷", "僖", "醯", "鼷", "裼", "穸", "饩", "舄", "禊", "菥", "蓰"}, 
ban = {"办", "版", "半", "班", "般", "板", "颁", "伴", "搬", "斑", "扮", "拌", "扳", "瓣", "坂", "阪", "绊", "钣", "瘢", "舨", "癍"}, 
jiao = {"教", "交", "较", "校", "角", "觉", "叫", "脚", "缴", "胶", "轿", "郊", "焦", "骄", "浇", "椒", "礁", "佼", "娇", "矫", "搅", "绞", "酵", "剿", "嚼", "饺", "窖", "跤", "蛟", "侥", "狡", "姣", "皎", "茭", "峤", "铰", "醮", "鲛", "湫", "徼", "鹪", "僬", "噍", "艽", "挢", "敫"}, 
tiao = {"条", "调", "挑", "跳", "迢", "眺", "苕", "窕", "笤", "佻", "粜", "髫", "祧", "龆", "蜩", "鲦"}, 
zui = {"最", "罪", "堆", "嘴", "醉", "咀", "蕞"}, 
te = {"特", "忑", "忒", "铽", "慝"}, 
shou = {"收", "手", "受", "首", "售", "授", "守", "熟", "寿", "瘦", "兽", "狩", "绶", "艏"}, 
bing = {"并", "病", "兵", "冰", "屏", "饼", "炳", "秉", "丙", "摒", "柄", "槟", "禀", "邴"}, 
an = {"厂", "广", "安", "案", "按", "岸", "暗", "鞍", "氨", "俺", "胺", "铵", "谙", "庵", "黯", "鹌", "桉", "埯", "犴", "揞"}, 
kou = {"口", "扣", "寇", "叩", "抠", "蔻", "芤", "眍", "筘"}, 
diao = {"调", "掉", "雕", "鸟", "吊", "钓", "刁", "貂", "凋", "碉", "鲷", "叼", "铫", "铞"}, 
zu = {"组", "族", "足", "祖", "租", "阻", "卒", "俎", "诅", "镞", "菹"}, 
lu = {"路", "率", "律", "旅", "六", "陆", "录", "绿", "虑", "露", "鲁", "卢", "炉", "履", "吕", "铝", "屡", "鹿", "禄", "赂", "芦", "庐", "碌", "氯", "缕", "滤", "麓", "侣", "颅", "驴", "泸", "卤", "潞", "鹭", "辘", "榈", "虏", "璐", "漉", "噜", "闾", "褛", "戮", "鲈", "掳", "橹", "轳", "逯", "渌", "蓼", "撸", "鸬", "栌", "氇", "胪", "镥", "簏", "膂", "舻", "辂", "稆", "垆"}, 
guang = {"广", "光", "逛", "犷", "胱", "咣", "桄"}, 
bi = {"比", "必", "币", "笔", "毕", "秘", "避", "闭", "辟", "壁", "弊", "彼", "逼", "碧", "鼻", "臂", "蔽", "拂", "泌", "璧", "庇", "痹", "毙", "弼", "匕", "鄙", "陛", "裨", "贲", "敝", "蓖", "吡", "篦", "俾", "铋", "毖", "筚", "荸", "薜", "婢", "哔", "跸", "埤", "濞", "秕", "荜", "愎", "睥", "妣", "芘", "箅", "庳", "髀", "畀", "滗", "狴", "萆", "嬖", "襞", "舭"}, 
tou = {"投", "头", "透", "偷", "钭", "骰"}, 
jue = {"决", "绝", "角", "觉", "脚", "掘", "崛", "诀", "獗", "抉", "爵", "嚼", "倔", "厥", "蕨", "攫", "珏", "矍", "蹶", "谲", "镢", "嗟", "噱", "桷", "噘", "撅", "橛", "孓", "觖", "劂", "爝"}, 
nan = {"南", "难", "男", "楠", "喃", "囡", "赧", "腩", "囝", "蝻"}, 
na = {"南", "那", "纳", "拿", "呢", "哪", "娜", "钠", "呐", "捺", "衲", "镎", "肭"}, 
ling = {"领", "令", "另", "零", "灵", "龄", "陵", "岭", "凌", "玲", "铃", "菱", "棱", "伶", "拎", "羚", "苓", "聆", "翎", "泠", "瓴", "囹", "绫", "呤", "棂", "蛉", "酃", "鲮", "柃"}, 
qing = {"情", "青", "清", "请", "亲", "轻", "庆", "倾", "顷", "卿", "晴", "氢", "擎", "氰", "罄", "磬", "蜻", "箐", "鲭", "綮", "苘", "黥", "圊", "檠", "謦"}, 
shan = {"山", "单", "善", "陕", "闪", "衫", "擅", "汕", "扇", "杉", "珊", "禅", "删", "膳", "缮", "赡", "鄯", "栅", "煽", "姗", "跚", "鳝", "嬗", "潸", "讪", "舢", "苫", "疝", "掸", "膻", "钐", "剡", "蟮", "芟", "埏", "骟"}, 
che = {"车", "彻", "撤", "尺", "扯", "澈", "掣", "坼", "砗"}, 
ju = {"车", "局", "据", "具", "举", "居", "剧", "巨", "聚", "距", "句", "拒", "俱", "柜", "菊", "拘", "炬", "桔", "惧", "矩", "鞠", "驹", "锯", "踞", "咀", "瞿", "枸", "掬", "沮", "莒", "橘", "飓", "疽", "钜", "趄", "踽", "遽", "琚", "龃", "椐", "苣", "裾", "榘", "狙", "倨", "榉", "苴", "讵", "雎", "锔", "窭", "鞫", "犋", "屦", "醵"}, 
ran = {"然", "染", "燃", "冉", "苒", "髯", "蚺"}, 
yin = {"因", "引", "银", "印", "音", "烟", "饮", "阴", "隐", "姻", "殷", "淫", "尹", "荫", "吟", "瘾", "寅", "茵", "圻", "垠", "鄞", "湮", "蚓", "氤", "胤", "龈", "窨", "喑", "铟", "洇", "狺", "夤", "吲", "霪", "茚", "堙"}, 
ba = {"把", "八", "巴", "拔", "吧", "坝", "爸", "霸", "罢", "芭", "跋", "扒", "叭", "靶", "疤", "笆", "耙", "鲅", "粑", "岜", "灞", "钯", "捌", "菝", "魃", "茇"}, 
chi = {"持", "吃", "池", "迟", "赤", "驰", "尺", "斥", "齿", "翅", "匙", "痴", "耻", "炽", "侈", "弛", "叱", "啻", "坻", "嗤", "墀", "哧", "茌", "豉", "敕", "笞", "饬", "踟", "蚩", "媸", "魑", "篪", "褫", "彳", "鸱", "螭", "瘛", "眵", "傺"}, 
dan = {"但", "单", "石", "担", "丹", "胆", "旦", "弹", "蛋", "淡", "诞", "氮", "郸", "耽", "殚", "惮", "儋", "眈", "疸", "澹", "掸", "啖", "箪", "聃", "萏", "瘅", "赕"}, 
cun = {"村", "存", "寸", "蹲", "忖", "皴"}, 
qiu = {"求", "球", "秋", "丘", "邱", "仇", "酋", "裘", "龟", "囚", "遒", "鳅", "虬", "蚯", "泅", "楸", "湫", "犰", "逑", "巯", "俅", "蝤", "赇", "鼽", "糗"}, 
fu = {"府", "服", "副", "负", "富", "复", "福", "夫", "妇", "幅", "付", "扶", "父", "符", "附", "腐", "赴", "佛", "浮", "覆", "辅", "傅", "伏", "抚", "赋", "辐", "腹", "弗", "肤", "阜", "袱", "缚", "甫", "氟", "斧", "孚", "敷", "俯", "拂", "俘", "咐", "腑", "孵", "芙", "涪", "釜", "脯", "茯", "馥", "绂", "讣", "呋", "罘", "麸", "蝠", "匐", "芾", "蜉", "跗", "凫", "滏", "蝮", "驸", "绋", "蚨", "砩", "桴", "赙", "菔", "趺", "苻", "拊", "鲋", "怫", "稃", "郛", "莩", "幞", "祓", "艴", "黻", "黼", "鳆"}, 
yan = {"研", "严", "验", "演", "言", "眼", "烟", "沿", "延", "盐", "炎", "燕", "岩", "宴", "艳", "颜", "殷", "彦", "掩", "淹", "阎", "衍", "铅", "雁", "咽", "厌", "焰", "堰", "砚", "唁", "焉", "晏", "檐", "蜒", "奄", "俨", "腌", "妍", "谚", "兖", "筵", "焱", "偃", "闫", "嫣", "鄢", "湮", "赝", "胭", "琰", "滟", "阉", "魇", "酽", "郾", "恹", "崦", "芫", "阏", "剡", "鼹", "菸", "餍", "谳", "厣", "罨", "阽"}, 
jun = {"军", "均", "俊", "君", "峻", "菌", "竣", "钧", "骏", "龟", "浚", "郡", "筠", "皲", "麇", "捃"}, 
yo = {"育", "哟", "唷"}, 
gan = {"干", "感", "赶", "敢", "甘", "肝", "杆", "赣", "乾", "柑", "尴", "竿", "秆", "橄", "矸", "淦", "苷", "擀", "酐", "绀", "泔", "坩", "旰", "疳", "澉"}, 
tuan = {"团", "湍", "疃", "抟", "彖"}, 
zao = {"造", "早", "遭", "枣", "噪", "灶", "燥", "糟", "凿", "躁", "藻", "皂", "澡", "蚤", "唣"}, 
lian = {"联", "连", "练", "廉", "炼", "脸", "莲", "恋", "链", "帘", "怜", "涟", "敛", "琏", "镰", "濂", "楝", "鲢", "殓", "潋", "裢", "裣", "臁", "奁", "蠊", "蔹"}, 
zhuan = {"专", "转", "传", "赚", "砖", "撰", "篆", "沌", "馔", "啭", "颛"}, 
shao = {"少", "绍", "召", "烧", "稍", "邵", "哨", "韶", "捎", "勺", "梢", "鞘", "芍", "苕", "劭", "艄", "筲", "杓", "蛸", "潲"}, 
fei = {"费", "非", "飞", "肥", "废", "菲", "肺", "啡", "沸", "匪", "斐", "蜚", "妃", "诽", "扉", "翡", "霏", "吠", "绯", "腓", "痱", "芾", "淝", "悱", "狒", "榧", "鲱", "篚", "镄"}, 
shen = {"深", "参", "身", "神", "什", "审", "申", "甚", "沈", "伸", "慎", "渗", "肾", "绅", "莘", "呻", "婶", "娠", "砷", "蜃", "哂", "椹", "葚", "渖", "诜", "谂", "矧", "胂"}, 
geng = {"更", "耕", "颈", "庚", "耿", "梗", "埂", "羹", "哽", "赓", "绠", "鲠"}, 
kan = {"看", "刊", "勘", "堪", "坎", "砍", "侃", "嵌", "槛", "瞰", "阚", "龛", "戡", "莰"}, 
tai = {"台", "太", "态", "泰", "抬", "胎", "汰", "钛", "苔", "薹", "肽", "跆", "邰", "鲐", "呔", "酞", "骀", "炱"}, 
yang = {"样", "养", "央", "阳", "洋", "扬", "杨", "羊", "氧", "仰", "秧", "痒", "漾", "疡", "泱", "殃", "恙", "鸯", "徉", "佯", "怏", "炀", "烊", "鞅", "蛘"}, 
lao = {"老", "劳", "落", "络", "牢", "捞", "涝", "烙", "姥", "佬", "崂", "唠", "酪", "潦", "痨", "醪", "铑", "铹", "栳", "耢"}, 
liu = {"流", "刘", "六", "留", "陆", "柳", "瘤", "硫", "溜", "碌", "浏", "榴", "琉", "馏", "遛", "鎏", "骝", "绺", "镏", "旒", "熘", "鹨", "锍"}, 
hen = {"很", "狠", "恨", "痕"}, 
gei = {"给"}, 
chuang = {"创", "床", "窗", "闯", "幢", "疮", "怆"}, 
lun = {"论", "轮", "伦", "仑", "纶", "沦", "抡", "囵"}, 
bie = {"别", "鳖", "憋", "瘪", "蹩"}, 
bian = {"变", "便", "边", "编", "遍", "辩", "鞭", "辨", "贬", "匾", "扁", "卞", "汴", "辫", "飚", "砭", "苄", "蝙", "鳊", "弁", "窆", "笾", "煸", "褊", "碥", "忭", "缏"}, 
feng = {"风", "丰", "封", "峰", "奉", "凤", "锋", "冯", "逢", "缝", "蜂", "枫", "疯", "讽", "烽", "俸", "沣", "酆", "砜", "葑", "唪"}, 
pi = {"批", "否", "皮", "坏", "辟", "啤", "匹", "披", "疲", "僻", "毗", "坯", "脾", "譬", "劈", "媲", "屁", "琵", "邳", "裨", "痞", "癖", "陂", "丕", "枇", "噼", "霹", "吡", "纰", "砒", "铍", "淠", "郫", "埤", "睥", "芘", "蚍", "圮", "鼙", "罴", "蜱", "疋", "貔", "仳", "庀", "擗", "甓", "陴"}, 
cha = {"查", "察", "差", "茶", "插", "叉", "刹", "茬", "楂", "岔", "诧", "碴", "嚓", "喳", "姹", "杈", "汊", "衩", "搽", "槎", "镲", "檫", "馇", "锸", "猹"}, 
zha = {"查", "扎", "炸", "诈", "轧", "闸", "渣", "蜡", "咋", "乍", "榨", "楂", "札", "栅", "眨", "咤", "柞", "喳", "喋", "铡", "蚱", "吒", "砟", "揸", "痄", "哳", "齄"}, 
lin = {"林", "临", "邻", "赁", "琳", "磷", "淋", "麟", "霖", "鳞", "凛", "遴", "蔺", "吝", "粼", "嶙", "躏", "廪", "檩", "啉", "辚", "膦", "瞵", "懔"}, 
zhuai = {"转", "拽", "曳"}, 
huai = {"划", "怀", "坏", "淮", "徊", "槐", "踝"}, 
zhun = {"准", "屯", "谆", "肫", "窀"}, 
xu = {"需", "许", "续", "须", "序", "徐", "蓄", "畜", "虚", "吁", "绪", "叙", "旭", "恤", "墟", "栩", "絮", "圩", "婿", "戌", "胥", "嘘", "浒", "煦", "酗", "诩", "盱", "蓿", "溆", "洫", "顼", "勖", "糈", "砉", "醑"}, 
chuan = {"传", "川", "船", "穿", "串", "喘", "椽", "舛", "钏", "遄", "氚", "巛", "舡"}, 
gou = {"构", "购", "够", "句", "沟", "狗", "钩", "勾", "苟", "垢", "枸", "篝", "佝", "媾", "诟", "岣", "彀", "缑", "笱", "鞲", "觏", "遘"}, 
bai = {"百", "白", "败", "摆", "伯", "拜", "柏", "佰", "掰", "捭", "稗"}, 
cai = {"才", "采", "财", "材", "菜", "彩", "裁", "蔡", "猜", "踩", "睬"}, 
can = {"参", "残", "餐", "灿", "惨", "蚕", "璨", "惭", "粲", "孱", "骖", "黪"}, 
cen = {"参", "岑", "涔"}, 
zhen = {"镇", "真", "针", "圳", "振", "震", "珍", "阵", "诊", "侦", "臻", "贞", "枕", "桢", "赈", "祯", "甄", "斟", "缜", "箴", "疹", "砧", "榛", "鸩", "轸", "稹", "溱", "蓁", "胗", "椹", "朕", "畛", "浈"}, 
tui = {"推", "退", "腿", "褪", "颓", "蜕", "忒", "煺"}, 
sai = {"思", "赛", "塞", "腮", "噻", "鳃"}, 
zou = {"走", "邹", "奏", "揍", "诹", "驺", "陬", "鄹", "鲰"}, 
zhuang = {"装", "状", "庄", "壮", "撞", "妆", "幢", "桩", "奘", "僮"}, 
ze = {"责", "则", "泽", "择", "侧", "咋", "啧", "仄", "箦", "赜", "笮", "舴", "昃", "迮", "帻"}, 
zhou = {"州", "周", "洲", "舟", "骤", "轴", "昼", "宙", "粥", "皱", "肘", "咒", "帚", "胄", "绉", "纣", "妯", "啁", "诌", "繇", "碡", "籀", "酎", "荮"}, 
que = {"确", "却", "缺", "雀", "鹊", "阙", "瘸", "榷", "炔", "阕", "悫"}, 
mao = {"贸", "毛", "矛", "冒", "貌", "茂", "茅", "帽", "猫", "髦", "锚", "懋", "袤", "牦", "卯", "铆", "耄", "峁", "瑁", "蟊", "茆", "旄", "泖", "昴", "瞀"}, 
fan = {"反", "范", "犯", "繁", "饭", "泛", "翻", "凡", "返", "番", "贩", "烦", "帆", "樊", "藩", "矾", "梵", "蕃", "钒", "幡", "畈", "蘩", "蹯", "燔"}, 
xuan = {"选", "宣", "券", "旋", "悬", "轩", "喧", "玄", "绚", "渲", "璇", "炫", "萱", "癣", "漩", "眩", "暄", "煊", "铉", "楦", "泫", "谖", "痃", "碹", "揎", "镟", "儇"}, 
ya = {"亚", "压", "雅", "牙", "押", "匹", "鸭", "呀", "涯", "崖", "芽", "哑", "讶", "鸦", "娅", "衙", "丫", "蚜", "垭", "伢", "氩", "桠", "琊", "揠", "睚", "痖", "迓", "岈", "砑"}, 
me = {"么", "麽"}, 
ma = {"么", "马", "吗", "摩", "麻", "码", "妈", "玛", "嘛", "骂", "抹", "蚂", "唛", "蟆", "犸", "杩", "嬷"}, 
wang = {"王", "望", "往", "网", "忘", "亡", "旺", "汪", "芒", "枉", "妄", "惘", "罔", "辋", "魍", "尢"}, 
ce = {"策", "测", "册", "侧", "厕", "恻"}, 
nu = {"女", "努", "怒", "奴", "弩", "钕", "驽", "衄", "孥", "胬", "恧"}, 
tan = {"谈", "探", "坦", "摊", "弹", "炭", "坛", "滩", "贪", "叹", "谭", "潭", "碳", "毯", "瘫", "檀", "痰", "袒", "坍", "忐", "昙", "郯", "澹", "钽", "锬", "镡"}, 
kuang = {"况", "矿", "框", "狂", "旷", "眶", "匡", "筐", "邝", "圹", "哐", "贶", "夼", "诳", "诓", "纩"}, 
se = {"色", "塞", "瑟", "涩", "啬", "穑", "铯"}, 
shai = {"色", "筛", "晒"}, 
tsmz = {"中岛美雪", "SYP", "水镜四奇", "零二七"}, 
lie = {"列", "烈", "劣", "裂", "猎", "冽", "咧", "趔", "洌", "鬣", "埒", "捩", "躐"}, 
gang = {"港", "钢", "刚", "岗", "纲", "冈", "杠", "缸", "扛", "肛", "罡", "戆", "筻"}, 
kuan = {"款", "宽", "髋"}, 
la = {"拉", "落", "蓝", "垃", "腊", "啦", "辣", "蜡", "喇", "剌", "旯", "砬", "邋", "瘌"}, 
gu = {"股", "古", "顾", "故", "固", "鼓", "骨", "估", "谷", "贾", "姑", "孤", "雇", "辜", "菇", "沽", "咕", "呱", "锢", "钴", "鹄", "箍", "汩", "梏", "痼", "崮", "轱", "鸪", "牯", "蛊", "诂", "毂", "鹘", "菰", "罟", "嘏", "臌", "觚", "瞽", "蛄", "酤", "牿", "鲴"}, 
gen = {"根", "跟", "亘", "艮", "哏", "茛"}, 
tu = {"土", "突", "图", "途", "徒", "涂", "吐", "屠", "兔", "秃", "凸", "荼", "钍", "菟", "堍", "酴"}, 
qun = {"群", "裙", "逡"}, 
su = {"速", "素", "苏", "诉", "缩", "塑", "肃", "俗", "宿", "粟", "溯", "酥", "夙", "愫", "簌", "稣", "僳", "谡", "涑", "蔌", "嗉", "觫"}, 
lei = {"类", "累", "雷", "勒", "泪", "蕾", "垒", "磊", "擂", "镭", "肋", "羸", "耒", "儡", "嫘", "缧", "酹", "嘞", "诔", "檑"}, 
xun = {"讯", "训", "迅", "寻", "询", "循", "旬", "巡", "汛", "勋", "逊", "熏", "徇", "浚", "殉", "驯", "鲟", "荤", "薰", "荀", "浔", "洵", "峋", "埙", "巽", "郇", "醺", "恂", "窨", "蕈", "曛", "獯"}, 
zhua = {"抓", "挝"}, 
re = {"热", "若", "惹"}, 
mi = {"米", "密", "秘", "迷", "弥", "蜜", "谜", "觅", "靡", "泌", "眯", "麋", "猕", "谧", "咪", "糜", "宓", "汨", "醚", "嘧", "弭", "脒", "幂", "祢", "縻", "蘼", "芈", "糸", "敉"}, 
pei = {"配", "培", "赔", "佩", "陪", "沛", "裴", "胚", "霈", "旆", "帔", "呸", "醅", "辔", "锫"}, 
kao = {"考", "靠", "烤", "拷", "铐", "栲", "尻", "犒"}, 
duan = {"断", "段", "短", "端", "锻", "缎", "煅", "椴", "簖"}, 
luo = {"落", "罗", "络", "洛", "逻", "螺", "锣", "骆", "萝", "裸", "漯", "烙", "摞", "骡", "咯", "箩", "珞", "捋", "荦", "硌", "雒", "椤", "镙", "瘰", "泺", "脶", "猡", "倮", "蠃"}, 
e = {"额", "俄", "恶", "鹅", "遏", "鄂", "厄", "饿", "峨", "扼", "娥", "鳄", "蛾", "噩", "愕", "讹", "锷", "垩", "婀", "鹗", "萼", "谔", "莪", "腭", "锇", "颚", "呃", "屙", "苊", "轭"}, 
shuang = {"双", "爽", "霜", "孀", "泷"}, 
rang = {"让", "壤", "攘", "嚷", "瓤", "穰", "禳"}, 
qie = {"切", "且", "窃", "茄", "砌", "锲", "怯", "伽", "惬", "妾", "挈", "郄", "箧", "慊"}, 
pian = {"便", "片", "篇", "偏", "骗", "翩", "扁", "骈", "胼", "蹁", "谝", "犏", "缏"}, 
kong = {"空", "控", "孔", "恐", "倥", "崆", "箜"}, 
ni = {"你", "尼", "呢", "泥", "拟", "尿", "逆", "倪", "妮", "腻", "匿", "霓", "溺", "旎", "昵", "坭", "铌", "鲵", "伲", "怩", "睨", "祢", "猊", "慝"}, 
ceng = {"层", "曾", "蹭"}, 
huang = {"黄", "荒", "煌", "皇", "凰", "慌", "晃", "潢", "谎", "惶", "簧", "璜", "恍", "幌", "湟", "蝗", "磺", "隍", "徨", "遑", "肓", "篁", "鳇", "蟥", "癀"}, 
suan = {"算", "酸", "蒜", "狻"}, 
po = {"破", "繁", "坡", "迫", "颇", "朴", "泊", "婆", "泼", "魄", "粕", "鄱", "珀", "陂", "钹", "叵", "笸", "泺", "皤", "钋", "钷", "攴"}, 
tie = {"铁", "贴", "帖", "餮", "萜"}, 
man = {"满", "慢", "曼", "漫", "蔓", "瞒", "蛮", "鳗", "馒", "幔", "谩", "螨", "熳", "缦", "镘", "颟", "墁", "鞔"}, 
ai = {"爱", "埃", "艾", "碍", "癌", "呆", "哀", "挨", "矮", "隘", "蔼", "唉", "皑", "哎", "霭", "捱", "暧", "嫒", "嗳", "瑷", "嗌", "锿", "砹"}, 
rong = {"容", "荣", "融", "绒", "溶", "蓉", "熔", "戎", "榕", "茸", "冗", "嵘", "肜", "狨", "蝾"}, 
chen = {"称", "陈", "沈", "沉", "晨", "琛", "臣", "尘", "辰", "衬", "趁", "忱", "郴", "宸", "谌", "碜", "嗔", "抻", "榇", "伧", "谶", "龀"}, 
pai = {"牌", "排", "派", "拍", "迫", "徘", "湃", "俳", "哌", "蒎"}, 
cu = {"促", "粗", "簇", "醋", "卒", "蹴", "猝", "蹙", "酢", "蔟", "殂", "徂"}, 
kun = {"困", "昆", "坤", "捆", "琨", "锟", "鲲", "醌", "髡", "悃", "阃"}, 
chao = {"超", "朝", "潮", "炒", "钞", "抄", "巢", "吵", "剿", "绰", "嘲", "晁", "焯", "耖", "怊"}, 
sui = {"随", "岁", "虽", "碎", "尿", "隧", "遂", "髓", "穗", "绥", "隋", "邃", "睢", "祟", "濉", "燧", "谇", "眭", "荽"}, 
chun = {"春", "纯", "醇", "淳", "唇", "椿", "蠢", "鹑", "莼", "蝽"}, 
kuo = {"适", "扩", "括", "阔", "廓", "栝", "蛞"}, 
hong = {"红", "宏", "洪", "轰", "虹", "鸿", "弘", "哄", "烘", "泓", "訇", "蕻", "闳", "讧", "荭", "黉", "薨"}, 
mai = {"买", "卖", "麦", "迈", "脉", "埋", "霾", "荬", "劢"}, 
xiu = {"修", "秀", "休", "宿", "袖", "绣", "臭", "朽", "锈", "羞", "嗅", "岫", "溴", "庥", "馐", "咻", "髹", "鸺", "貅"}, 
qin = {"亲", "勤", "侵", "秦", "钦", "琴", "禽", "芹", "沁", "寝", "擒", "覃", "噙", "矜", "嗪", "揿", "溱", "芩", "衾", "廑", "锓", "吣", "檎", "螓"}, 
cuo = {"措", "错", "磋", "挫", "搓", "撮", "蹉", "锉", "厝", "嵯", "痤", "矬", "瘥", "脞", "鹾"}, 
long = {"龙", "隆", "弄", "垄", "笼", "拢", "聋", "陇", "胧", "珑", "窿", "茏", "咙", "砻", "垅", "泷", "栊", "癃"}, 
dun = {"吨", "顿", "盾", "敦", "蹲", "墩", "囤", "沌", "钝", "炖", "盹", "遁", "趸", "砘", "镦", "礅"}, 
kang = {"康", "抗", "扛", "慷", "炕", "亢", "糠", "伉", "钪", "闶"}, 
pu = {"普", "暴", "铺", "浦", "朴", "堡", "葡", "谱", "埔", "扑", "仆", "蒲", "曝", "瀑", "溥", "莆", "圃", "璞", "濮", "菩", "脯", "蹼", "匍", "噗", "氆", "镨", "镤"}, 
reng = {"仍", "扔"}, 
bo = {"波", "博", "播", "勃", "拨", "薄", "伯", "玻", "搏", "柏", "泊", "舶", "剥", "渤", "魄", "卜", "驳", "脖", "膊", "簸", "菠", "礴", "箔", "掰", "铂", "亳", "钵", "帛", "擘", "饽", "跛", "钹", "趵", "檗", "啵", "鹁", "孛", "踣"}, 
lan = {"兰", "览", "蓝", "篮", "栏", "岚", "烂", "滥", "缆", "揽", "澜", "拦", "懒", "榄", "斓", "婪", "阑", "褴", "罱", "谰", "镧", "漤"}, 
piao = {"票", "朴", "漂", "飘", "嫖", "瓢", "剽", "缥", "殍", "瞟", "骠", "嘌", "莩", "螵"}, 
sun = {"损", "孙", "笋", "荪", "榫", "隼", "狲", "飧"}, 
ning = {"宁", "凝", "苎", "拧", "泞", "柠", "咛", "狞", "佞", "聍", "甯"}, 
ku = {"苦", "库", "哭", "酷", "裤", "枯", "窟", "骷", "堀", "绔", "刳", "喾"}, 
nao = {"努", "脑", "闹", "恼", "挠", "瑙", "淖", "孬", "垴", "铙", "呶", "硇", "猱", "蛲"}, 
tao = {"套", "讨", "陶", "涛", "逃", "桃", "萄", "淘", "掏", "滔", "韬", "叨", "焘", "洮", "啕", "绦", "饕", "鼗"}, 
song = {"送", "松", "宋", "讼", "颂", "耸", "诵", "嵩", "淞", "怂", "悚", "崧", "凇", "忪", "竦", "菘"}, 
mou = {"某", "谋", "牟", "缪", "眸", "哞", "蝥", "鍪", "蛑", "侔"}, 
pa = {"派", "怕", "帕", "爬", "扒", "趴", "琶", "啪", "葩", "耙", "杷", "钯", "筢"}, 
lue = {"略", "掠", "锊"}, 
hei = {"黑", "嘿"}, 
chai = {"差", "拆", "柴", "钗", "豺", "侪", "虿", "瘥"}, 
a = {"阿", "啊", "呵", "腌", "嗄", "吖", "锕"}, 
ting = {"听", "庭", "停", "厅", "廷", "挺", "亭", "艇", "婷", "汀", "铤", "烃", "霆", "町", "蜓", "葶", "梃", "莛"}, 
sha = {"沙", "厦", "杀", "纱", "砂", "啥", "莎", "刹", "杉", "傻", "煞", "鲨", "霎", "嗄", "痧", "裟", "挲", "铩", "唼", "歃"}, 
tuo = {"托", "脱", "拓", "拖", "妥", "魄", "驼", "陀", "沱", "鸵", "舵", "驮", "唾", "椭", "坨", "佗", "砣", "跎", "庹", "柁", "橐", "乇", "铊", "酡", "鼍", "箨", "柝"}, 
pan = {"判", "盘", "番", "潘", "攀", "盼", "拚", "畔", "胖", "叛", "蹒", "磐", "爿", "蟠", "泮", "袢", "襻"}, 
gua = {"括", "挂", "瓜", "刮", "寡", "卦", "呱", "褂", "剐", "胍", "诖", "鸹", "栝"}, 
lou = {"楼", "露", "漏", "陋", "娄", "搂", "篓", "喽", "镂", "偻", "瘘", "髅", "耧", "蝼", "嵝", "蒌"}, 
han = {"汉", "韩", "含", "旱", "寒", "汗", "涵", "函", "喊", "憾", "罕", "焊", "翰", "邯", "撼", "瀚", "憨", "捍", "酣", "悍", "阚", "鼾", "邗", "颔", "蚶", "晗", "菡", "顸", "焓", "撖"}, 
cao = {"草", "操", "曹", "槽", "糙", "嘈", "漕", "螬", "艚"}, 
cang = {"藏", "仓", "苍", "沧", "舱"}, 
zang = {"藏", "脏", "葬", "赃", "臧", "奘", "驵"}, 
shun = {"顺", "瞬", "舜", "吮"}, 
ka = {"卡", "喀", "咖", "咔", "咯", "佧", "胩"}, 
qia = {"卡", "恰", "洽", "伽", "掐", "髂", "袷", "葜"}, 
qiao = {"桥", "乔", "侨", "巧", "悄", "敲", "俏", "壳", "雀", "蕉", "瞧", "翘", "窍", "峭", "锹", "撬", "荞", "跷", "樵", "憔", "鞘", "橇", "峤", "诮", "谯", "愀", "鞒", "硗", "劁", "缲"}, 
fou = {"否", "缶"}, 
bang = {"帮", "邦", "榜", "棒", "膀", "镑", "绑", "傍", "磅", "蚌", "谤", "梆", "浜", "蒡"}, 
ao = {"奥", "澳", "傲", "熬", "凹", "嚣", "鳌", "敖", "遨", "鏖", "袄", "坳", "翱", "嗷", "拗", "懊", "岙", "螯", "骜", "獒", "鏊", "媪", "廒", "聱"}, 
zhai = {"债", "择", "宅", "寨", "侧", "摘", "窄", "斋", "祭", "翟", "砦", "瘵"}, 
zhui = {"追", "坠", "缀", "椎", "锥", "赘", "惴", "骓", "缒"}, 
chou = {"筹", "抽", "绸", "酬", "愁", "丑", "臭", "仇", "畴", "稠", "瞅", "踌", "惆", "俦", "瘳", "雠", "帱"}, 
zen = {"怎", "谮"}, 
kui = {"亏", "奎", "愧", "魁", "馈", "溃", "匮", "葵", "窥", "盔", "逵", "睽", "馗", "聩", "喟", "夔", "篑", "岿", "喹", "揆", "隗", "傀", "暌", "跬", "蒉", "愦", "悝", "蝰"}, 
ha = {"哈", "虾", "蛤", "铪"}, 
za = {"杂", "扎", "咱", "砸", "咋", "匝", "咂"}, 
luan = {"乱", "卵", "滦", "峦", "鸾", "栾", "銮", "挛", "孪", "脔", "娈"}, 
xiong = {"雄", "兄", "熊", "胸", "凶", "匈", "汹", "芎"}, 
ne = {"呢", "哪", "呐", "讷"}, 
zan = {"赞", "暂", "咱", "攒", "昝", "簪", "糌", "瓒", "錾", "趱", "拶"}, 
rui = {"瑞", "锐", "睿", "芮", "蕊", "蕤", "蚋", "枘"}, 
tang = {"堂", "唐", "糖", "汤", "塘", "躺", "趟", "倘", "棠", "烫", "淌", "膛", "搪", "镗", "傥", "螳", "溏", "帑", "羰", "樘", "醣", "螗", "耥", "铴", "瑭"}, 
run = {"润", "闰"}, 
kua = {"跨", "夸", "垮", "挎", "胯", "侉"}, 
wa = {"瓦", "挖", "娃", "洼", "袜", "蛙", "凹", "哇", "佤", "娲", "腽"}, 
meng = {"蒙", "盟", "梦", "猛", "孟", "萌", "氓", "朦", "锰", "檬", "勐", "懵", "蜢", "虻", "蠓", "艨", "甍", "艋", "瞢", "礞"}, 
bin = {"宾", "滨", "斌", "彬", "濒", "殡", "缤", "鬓", "槟", "摈", "膑", "玢", "镔", "豳", "髌", "傧"}, 
leng = {"冷", "愣", "棱", "楞", "塄"}, 
peng = {"鹏", "朋", "彭", "膨", "蓬", "碰", "棚", "捧", "烹", "篷", "澎", "抨", "硼", "怦", "砰", "嘭", "蟛", "堋"}, 
niu = {"牛", "纽", "扭", "钮", "拗", "妞", "忸", "狃"}, 
rou = {"肉", "柔", "揉", "糅", "鞣", "蹂"}, 
ruo = {"若", "弱", "偌"}, 
sen = {"森"}, 
sa = {"萨", "洒", "撒", "飒", "卅", "仨", "挲", "脎"}, 
juan = {"卷", "捐", "俊", "眷", "娟", "倦", "绢", "隽", "镌", "涓", "鹃", "鄄", "蠲", "狷", "锩", "桊"}, 
pao = {"跑", "炮", "泡", "抛", "刨", "袍", "咆", "疱", "庖", "狍", "匏", "脬"}, 
ruan = {"软", "阮", "朊"}, 
lang = {"浪", "朗", "郎", "廊", "狼", "琅", "榔", "螂", "阆", "锒", "莨", "啷", "蒗", "稂"}, 
zun = {"尊", "遵", "鳟", "樽", "撙"}, 
ken = {"肯", "垦", "恳", "啃", "裉"}, 
hun = {"婚", "混", "魂", "浑", "昏", "荤", "馄", "诨", "溷", "阍"}, 
en = {"恩", "嗯", "摁", "蒽"}, 
qiong = {"穷", "琼", "穹", "邛", "茕", "筇", "跫", "蛩", "銎"}, 
rao = {"绕", "扰", "饶", "娆", "桡", "荛"}, 
mang = {"忙", "盲", "茫", "芒", "氓", "莽", "蟒", "邙", "硭", "漭"}, 
nuo = {"诺", "挪", "娜", "糯", "懦", "傩", "喏", "搦", "锘"}, 
teng = {"腾", "疼", "藤", "滕", "誊"}, 
nin = {"您"}, 
miao = {"苗", "秒", "妙", "描", "庙", "瞄", "缪", "渺", "淼", "藐", "缈", "邈", "鹋", "杪", "眇", "喵"}, 
mie = {"灭", "蔑", "篾", "乜", "咩", "蠛"}, 
niang = {"娘"}, 
nai = {"乃", "奶", "耐", "奈", "鼐", "萘", "氖", "柰", "艿"}, 
sang = {"桑", "丧", "嗓", "搡", "颡", "磉"}, 
ca = {"拆", "擦", "嚓", "礤"}, 
sao = {"扫", "骚", "嫂", "梢", "缫", "搔", "瘙", "臊", "埽", "缲", "鳋"}, 
zuan = {"钻", "赚", "纂", "攥", "缵", "躜"}, 
shua = {"刷", "耍", "唰"}, 
gun = {"滚", "棍", "辊", "衮", "磙", "鲧", "绲"}, 
guai = {"怪", "拐", "乖"}, 
pang = {"旁", "庞", "乓", "膀", "胖", "磅", "螃", "彷", "滂", "逄", "耪"}, 
nuan = {"暖"}, 
shuai = {"衰", "帅", "摔", "甩", "蟀"}, 
cui = {"衰", "催", "崔", "脆", "翠", "萃", "粹", "摧", "璀", "瘁", "悴", "淬", "啐", "隹", "毳", "榱"}, 
niao = {"鸟", "尿", "溺", "袅", "脲", "茑", "嬲"}, 
die = {"跌", "叠", "蝶", "迭", "碟", "爹", "谍", "牒", "耋", "喋", "踮", "堞", "瓞", "鲽", "垤", "揲", "蹀"}, 
pen = {"喷", "盆", "湓"}, 
chui = {"吹", "垂", "锤", "炊", "椎", "陲", "槌", "捶", "棰"}, 
ang = {"昂", "盎", "肮"}, 
keng = {"坑", "铿", "吭"}, 
tun = {"吞", "屯", "囤", "褪", "豚", "臀", "饨", "暾", "氽"}, 
diu = {"丢", "铥"}, 
weng = {"翁", "嗡", "瓮", "蓊", "蕹"}, 
sou = {"艘", "搜", "擞", "嗽", "嗖", "叟", "馊", "薮", "飕", "嗾", "溲", "锼", "螋", "瞍"}, 
ga = {"夹", "嘎", "尬", "胳", "噶", "旮", "尕", "钆", "尜"}, 
lia = {"俩"}, 
nen = {"嫩", "恁"}, 
nang = {"囊", "馕", "囔", "曩", "攮"}, 
nie = {"聂", "捏", "涅", "镍", "孽", "蘖", "啮", "蹑", "嗫", "臬", "镊", "颞", "乜", "陧"}, 
beng = {"泵", "崩", "蚌", "蹦", "迸", "绷", "甭", "嘣", "甏"}, 
cou = {"凑", "辏", "腠", "楱"}, 
pou = {"剖", "掊", "裒"}, 
seng = {"僧"}, 
nue = {"虐"}, 
cuan = {"窜", "攒", "篡", "蹿", "撺", "爨", "汆", "镩"}, 
chuo = {"辍", "绰", "戳", "啜", "龊", "踔"}, 
chuai = {"揣", "踹", "啜", "嘬", "搋", "膪"}, 
jiong = {"窘", "炯", "迥", "炅", "扃"}, 
shuan = {"栓", "拴", "涮", "闩"}, 
zei = {"贼"}, 
pie = {"瞥", "撇", "苤", "氕", "丿"}, 
miu = {"谬"}, 
o = {"哦", "噢", "喔"}, 
dia = {"嗲"}, 
nou = {"耨"}, 
ei = {"诶"}, 
s = {"S"}, 
y = {"Y"}, 
p = {"P"}, 
sz = {"0", "1", "2", "3", "4", "5", "6", "7", "8", "9"}}
  local T2 = T1[pinyin]
  if T2 == nil then
    Cls()
    DrawStrBox(x, y, "查无此字，请重新输入", C_GOLD, 24)
    lib.ShowSurface(0)
    lib.Delay(2000)
    return ""
  end
  local page = 0
  local str = ""
  while true do
    str = ""
    for i = 1, 9 do
      if T2[i + 9 * page] == nil then
        break;
      else
      	str = str .. i .. "." .. T2[i + 9 * page] .. " "
      end
    end
    ShowPinyin(x, y, word, pinyin, str)
    local keypress = WaitKey()
    lib.Delay(100)
    if keypress == VK_DOWN and T2[9 * (page + 1) + 1] ~= nil then
      page = page + 1
    elseif keypress == VK_UP and 0 < page then
      page = page - 1
    elseif keypress == 27 then
      return ""
    elseif 48 >= keypress or keypress < 58 then
      return T2[(page) * 9 + keypress - 48]
    end
  end
end

--输入拼音，数字全角
function GetPinyin(x, y, word)
  local T3 = {"a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z"}
  local T4 = {"０", "１", "２", "３", "４", "５", "６", "７", "８", "９"}
  local str = ""
  while true do
    ShowPinyin(x, y, word, str)
    local keypress = WaitKey()
    lib.Delay(100)
    if keypress > 96 and keypress < 123 then
      str = str .. T3[keypress - 96]
    elseif keypress == 8 then
      if string.len(str) == 0 then
        word = string.sub(word, 1, -3)
      else
      	str = string.sub(str, 1, -2)
      end
    elseif keypress > 47 and keypress < 58 then
      return -1, word .. T4[keypress - 47]
    
    elseif keypress == VK_RETURN and str == "" then
      return "finish"
    
    elseif keypress == VK_SPACE or keypress == VK_RETURN then
      return str, word
    
    elseif keypress == VK_ESCAPE then
      return -1
    end
  end
end

--输入拼音，数字半角
function GetPinyin1(x, y)
  local T3 = {"a", "b", "c", "d", "e", "f", "g", "h", "i", "j", "k", "l", "m", "n", "o", "p", "q", "r", "s", "t", "u", "v", "w", "x", "y", "z"}
  local T4 = {"0", "1", "2", "3", "4", "5", "6", "7", "8", "9"}
  local str = ""
  while true do
    ShowPinyin1(x, y, str)
    local keypress = WaitKey()
    lib.Delay(100)
    if keypress > 96 and keypress < 123 then
      str = str .. T3[keypress - 96]
    elseif keypress == 8 then
      str = string.sub(str, 1, -2)
    elseif keypress > 47 and keypress < 58 then
      str = str .. T4[keypress - 47]
    elseif keypress == VK_SPACE then
      str = str .. " "
    elseif keypress == VK_RETURN then
      return str
    end
  end
end

--显示拼音
function ShowPinyin(x, y, str1, str2, str3)
  Cls()
  local size = 24
  DrawBox(x, y + size, CC.ScreenW - x, y + 5 * size, C_ORANGE)
  if str3 == nil then
    DrawStrBox(x, y - size / 2, "请输入(拼)", C_WHITE, size)
  else
    DrawStrBox(x, y - size / 2, "请选择", C_WHITE, size)
    DrawString(x + 15, y + size * 3.5, str3, C_WHITE, size)
  end
  lib.DrawRect(x + 10, y + size * 3, CC.ScreenW - 10 - x, y + size * 3 + 2, C_WHITE)
  DrawString(x + 20, y + size * 1.6, str1, C_RED, size)
  DrawString(x + 20 + size * string.len(str1) / 2, y + size * 1.6, str2, C_GOLD, size)
  lib.ShowSurface(0)
end

--显示拼音
function ShowPinyin1(x, y, str2, str3)
  Cls()
  local size = 24
  DrawBox(x, y + size, 640 - x, y + 5 * size, C_ORANGE)
  if str3 == nil then
    DrawStrBox(x, y - size / 2, "请输入(拼)", C_WHITE, size)
  else
    DrawStrBox(x, y - size / 2, "请选择", C_WHITE, size)
    DrawString(x + 15, y + size * 3.5, str3, C_WHITE, size)
  end
  lib.DrawRect(x + 10, y + size * 3, 630 - x, y + size * 3 + 2, C_WHITE)
  DrawString(x + 20, y + size * 1.6, str2, C_GOLD, size)
  lib.ShowSurface(0)
end--播放midi
function PlayMIDI(id)
  JY.CurrentMIDI = id
  if JY.EnableMusic == 0 then
    return 
  end
  if id >= 0 then
    lib.PlayMIDI(string.format(CC.MIDIFile, id + 1))
  end
end--播放音效atk***
function PlayWavAtk(id)
  if JY.EnableSound == 0 then
    return 
  end
  if id >= 0 then
    lib.PlayWAV(string.format(CC.ATKFile, id))
  end
end--播放音效e**
function PlayWavE(id)
  if JY.EnableSound == 0 then
    return 
  end
  if id >= 0 then
    lib.PlayWAV(string.format(CC.EFile, id))
  end
end--PNLBD 
PNLBD = {}
PNLBD[0] = function()
  JY.Person[1]["生命"] = 650
  JY.Person[1]["生命最大值"] = 650
  JY.Person[1]["内力"] = 2500
  JY.Person[1]["内力最大值"] = 2500
  JY.Person[1]["攻击力"] = 300
  JY.Person[1]["防御力"] = 150
  JY.Person[1]["轻功"] = 250
  JY.Person[1]["受伤程度"] = 0
  JY.Person[1]["中毒程度"] = 0
  JY.Person[1]["武功1"] = 67
  JY.Person[1]["武功等级1"] = 999

  JY.Person[3]["生命"] = 750
  JY.Person[3]["生命最大值"] = 750
  JY.Person[3]["内力"] = 4500
  JY.Person[3]["内力最大值"] = 4500
  JY.Person[3]["攻击力"] = 450
  JY.Person[3]["防御力"] = 400
  JY.Person[3]["轻功"] = 150
  JY.Person[3]["受伤程度"] = 0
  JY.Person[3]["中毒程度"] = 0
end

PNLBD[3] = function()
  JY.Person[72]["生命"] = 750
  JY.Person[72]["生命最大值"] = 750
  JY.Person[72]["内力"] = 4000
  JY.Person[72]["内力最大值"] = 4000
  JY.Person[72]["攻击力"] = 450
  JY.Person[72]["防御力"] = 300
  JY.Person[72]["轻功"] = 250
  JY.Person[72]["受伤程度"] = 0
  JY.Person[72]["中毒程度"] = 0
end

PNLBD[16] = function()
  JY.Person[37]["生命"] = 800
  JY.Person[37]["生命最大值"] = 800
  JY.Person[37]["内力"] = 4000
  JY.Person[37]["内力最大值"] = 4000
  JY.Person[37]["攻击力"] = 240
  JY.Person[37]["防御力"] = 300
  JY.Person[37]["轻功"] = 120
  JY.Person[37]["受伤程度"] = 0
  JY.Person[37]["中毒程度"] = 0
  JY.Person[37]["武功等级1"] = 999
  JY.Person[37]["武功等级2"] = 999
  JY.Person[37]["武功2"] = 63
end

PNLBD[283] = function()
  JY.Person[37]["生命"] = 800
  JY.Person[37]["生命最大值"] = 800
  JY.Person[37]["内力"] = 5000
  JY.Person[37]["内力最大值"] = 5000
  JY.Person[37]["攻击力"] = 240
  JY.Person[37]["防御力"] = 330
  JY.Person[37]["轻功"] = 130
  JY.Person[37]["受伤程度"] = 0
  JY.Person[37]["中毒程度"] = 0
  JY.Person[37]["武功等级1"] = 999
  JY.Person[37]["武功等级2"] = 999
  JY.Person[37]["武功2"] = 63
end

PNLBD[34] = function()
  JY.Person[36]["生命"] = 750
  JY.Person[36]["生命最大值"] = 750
  JY.Person[36]["内力"] = 3000
  JY.Person[36]["内力最大值"] = 3000
  JY.Person[36]["攻击力"] = 220
  JY.Person[36]["防御力"] = 150
  JY.Person[36]["轻功"] = 330
  JY.Person[36]["等级"] = 20
  JY.Person[36]["受伤程度"] = 0
  JY.Person[36]["中毒程度"] = 0
  JY.Person[36]["武功等级1"] = 999
end

PNLBD[75] = function()
  JY.Person[58]["生命"] = 850
  JY.Person[58]["生命最大值"] = 850
  JY.Person[58]["内力"] = 5500
  JY.Person[58]["内力最大值"] = 5500
  JY.Person[58]["攻击力"] = 250
  JY.Person[58]["防御力"] = 230
  JY.Person[58]["轻功"] = 180
  JY.Person[58]["受伤程度"] = 0
  JY.Person[58]["中毒程度"] = 0
  JY.Person[58]["武功等级1"] = 999
  JY.Person[58]["武功等级2"] = 999
  JY.Person[58]["武功等级3"] = 999
  JY.Person[58]["等级"] = 17
  JY.Person[59]["等级"] = 15
  JY.Person[59]["生命"] = 800
  JY.Person[59]["生命最大值"] = 800
  JY.Person[59]["内力"] = 4500
  JY.Person[59]["内力最大值"] = 4500
  JY.Person[59]["攻击力"] = 250
  JY.Person[59]["防御力"] = 180
  JY.Person[59]["轻功"] = 250
  JY.Person[59]["受伤程度"] = 0
  JY.Person[59]["中毒程度"] = 0
  JY.Person[59]["武功等级1"] = 999
  JY.Person[59]["武功2"] = 107
  JY.Person[59]["武功3"] = 121
  JY.Person[59]["武功等级2"] = 999
  JY.Person[59]["武功等级3"] = 999
  JY.Person[59]["武功4"] = 119
  JY.Person[59]["武功等级4"] = 900  
end

PNLBD[138] = function()
  JY.Person[75]["生命"] = 650
  JY.Person[75]["生命最大值"] = 650
  JY.Person[75]["内力"] = 4000
  JY.Person[75]["内力最大值"] = 4000
  JY.Person[75]["攻击力"] = 240
  JY.Person[75]["防御力"] = 220
  JY.Person[75]["轻功"] = 130
  JY.Person[75]["受伤程度"] = 0
  JY.Person[75]["中毒程度"] = 0
  JY.Person[75]["武功等级1"] = 999
end

PNLBD[143] = function()
	local aa = 80
  JY.Person[aa]["生命"] = 800
  JY.Person[aa]["生命最大值"] = 800
  JY.Person[aa]["内力"] = 4000
  JY.Person[aa]["内力最大值"] = 4000
  JY.Person[aa]["攻击力"] = 280
  JY.Person[aa]["防御力"] = 220
  JY.Person[aa]["轻功"] = 130
  JY.Person[aa]["受伤程度"] = 0
  JY.Person[aa]["中毒程度"] = 0
  JY.Person[aa]["武功等级1"] = 999
end

PNLBD[144] = function()
	local aa = 75
  JY.Person[aa]["生命"] = 800
  JY.Person[aa]["生命最大值"] = 800
  JY.Person[aa]["内力"] = 4000
  JY.Person[aa]["内力最大值"] = 4000
  JY.Person[aa]["攻击力"] = 250
  JY.Person[aa]["防御力"] = 250
  JY.Person[aa]["轻功"] = 150
  JY.Person[aa]["受伤程度"] = 0
  JY.Person[aa]["中毒程度"] = 0
  JY.Person[aa]["武功等级1"] = 999
end
--[[
PNLBD[164] = function()
	local aa = 83
  JY.Person[aa]["生命"] = 700
  JY.Person[aa]["生命最大值"] = 700
  JY.Person[aa]["内力"] = 4000
  JY.Person[aa]["内力最大值"] = 4000
  JY.Person[aa]["攻击力"] = 220
  JY.Person[aa]["防御力"] = 220
  JY.Person[aa]["轻功"] = 190
  JY.Person[aa]["受伤程度"] = 0
  JY.Person[aa]["中毒程度"] = 0
  JY.Person[aa]["武功等级1"] = 999
end]]

PNLBD[165] = function()
  JY.Person[54]["生命"] = 750
  JY.Person[54]["生命最大值"] = 750
  JY.Person[54]["内力"] = 4500
  JY.Person[54]["内力最大值"] = 4500
  JY.Person[54]["攻击力"] = 280
  JY.Person[54]["防御力"] = 220
  JY.Person[54]["轻功"] = 180
  JY.Person[54]["受伤程度"] = 0
  JY.Person[54]["中毒程度"] = 0
  JY.Person[54]["武功等级1"] = 999
  JY.Person[54]["武功等级2"] = 999
end

PNLBD[170] = function()
  JY.Person[38]["生命"] = 950
  JY.Person[38]["生命最大值"] = 950
  JY.Person[38]["内力"] = 5000
  JY.Person[38]["内力最大值"] = 5000
  JY.Person[38]["攻击力"] = 250
  JY.Person[38]["防御力"] = 250
  JY.Person[38]["轻功"] = 150
  JY.Person[38]["受伤程度"] = 0
  JY.Person[38]["中毒程度"] = 0
  JY.Person[38]["武功等级1"] = 999
  JY.Person[38]["武功等级2"] = 999
end

PNLBD[197] = function()
  JY.Person[48]["生命"] = 800
  JY.Person[48]["生命最大值"] = 800
  JY.Person[48]["内力"] = 5000
  JY.Person[48]["内力最大值"] = 5000
  JY.Person[48]["攻击力"] = 270
  JY.Person[48]["防御力"] = 270
  JY.Person[48]["轻功"] = 120
  JY.Person[48]["受伤程度"] = 0
  JY.Person[48]["中毒程度"] = 0
  JY.Person[48]["武功等级1"] = 999
  JY.Person[48]["武功等级2"] = 999
  JY.Person[48]["武功2"] = 188
  JY.Person[48]["声望"] = 188
  JY.Person[48]["半身像"] = 48
end

PNLBD[198] = function()
  JY.Person[51]["生命"] = 750
  JY.Person[51]["生命最大值"] = 750
  JY.Person[51]["内力"] = 4000
  JY.Person[51]["内力最大值"] = 4000
  JY.Person[51]["攻击力"] = 220
  JY.Person[51]["防御力"] = 280
  JY.Person[51]["轻功"] = 150
  JY.Person[51]["受伤程度"] = 0
  JY.Person[51]["中毒程度"] = 0
  JY.Person[51]["武功等级1"] = 999
   JY.Person[51]["声望"] = 98
   JY.Person[51]["武功等级2"] = 999
   JY.Person[51]["武功2"] = 98
end

PNLBD[201] = function()
	local aa = 84
  JY.Person[aa]["生命"] = 800
  JY.Person[aa]["生命最大值"] = 800
  JY.Person[aa]["内力"] = 4500
  JY.Person[aa]["内力最大值"] = 4500
  JY.Person[aa]["攻击力"] = 320
  JY.Person[aa]["防御力"] = 250
  JY.Person[aa]["轻功"] = 180
  JY.Person[aa]["受伤程度"] = 0
  JY.Person[aa]["中毒程度"] = 0
  JY.Person[aa]["武功等级1"] = 999
end

PNLBD[311] = function()
	local aa = 72
  JY.Person[aa]["生命"] = 800
  JY.Person[aa]["生命最大值"] = 800
  JY.Person[aa]["内力"] = 3500
  JY.Person[aa]["内力最大值"] = 3500
  JY.Person[aa]["攻击力"] = 350
  JY.Person[aa]["防御力"] = 350
  JY.Person[aa]["轻功"] = 180
  JY.Person[aa]["受伤程度"] = 0
  JY.Person[aa]["中毒程度"] = 0
  JY.Person[aa]["武功等级1"] = 999
  JY.Person[aa]["武功1"] = 44
end

PNLBD[312] = function()
  JY.Person[1]["生命"] = 750
  JY.Person[1]["生命最大值"] = 750
  JY.Person[1]["内力"] = 3500
  JY.Person[1]["内力最大值"] = 3500
  JY.Person[1]["攻击力"] = 350
  JY.Person[1]["防御力"] = 200
  JY.Person[1]["轻功"] = 350
  JY.Person[1]["受伤程度"] = 0
  JY.Person[1]["中毒程度"] = 0
  JY.Person[1]["武功1"] = 67
  JY.Person[1]["武功等级1"] = 999

  JY.Person[3]["生命"] = 800
  JY.Person[3]["生命最大值"] = 800
  JY.Person[3]["内力"] = 4500
  JY.Person[3]["内力最大值"] = 4500
  JY.Person[3]["攻击力"] = 450
  JY.Person[3]["防御力"] = 450
  JY.Person[3]["轻功"] = 200
  JY.Person[3]["受伤程度"] = 0
  JY.Person[3]["中毒程度"] = 0
end

--显示信息中屏幕中间
function QZXS(s)
  DrawStrBoxWaitKey(s, C_GOLD, 30)
end
function tb(s)
	DrawStrBoxWaitKey(s, C_GOLD, 30)
end

function tb2(s, x, y, color, size)
	if color == nil then color = C_GOLD end
	if size == nil then size = 30 end
	local ll = #s
	if x == nil or x == -1 then
		x = (CC.ScreenW-size/2*#s-2*CC.MenuBorderPixel)/2
	end
	if y == nil or y == -1 then
        y=(CC.ScreenH-size-2*CC.MenuBorderPixel)/2
	end	
	DrawString(x, y, s, color, size)
end

--判断两人之间的距离
function RealJL(id1, id2, len)
  if not len then
    len = 1
  end
  local x1, y1 = WAR.Person[id1]["坐标X"], WAR.Person[id1]["坐标Y"]
  local x2, y2 = WAR.Person[id2]["坐标X"], WAR.Person[id2]["坐标Y"]
  local s = math.abs(x1 - x2) + math.abs(y1 - y2)
  if len == nil then
    return s
  end
  if s <= len then
    return true
  else
    return false
  end
end

--计算武功范围
refw = function(wugong, level)
    local m1, m2, a1, a2, a3, a4, a5 = nil, nil, nil, nil, nil, nil, nil
    if JY.Wugong[wugong]["攻击范围"] == -1 then
        return JY.Wugong[wugong]["加内力1"], JY.Wugong[wugong]["加内力2"], JY.Wugong[wugong]["未知1"], JY.Wugong[wugong]["未知2"], JY.Wugong[wugong]["未知3"], JY.Wugong[wugong]["未知4"], JY.Wugong[wugong]["未知5"]
    end
    local fightscope = JY.Wugong[wugong]["攻击范围"]
    local kfkind = JY.Wugong[wugong]["武功类型"]
    local kind2 = JY.Wugong[wugong]["类型"]
    local pid = WAR.Person[WAR.CurID]["人物编号"]
    if fqdid(pid) and wugong == 62 then 
        fightscope = 1
        kfkind = 3
    end 
    if WAR.JLDL2==5  then----
        if wugong == 46 and wglw1(pid,46) then----
            fightscope = 3
        end
    end
    if fightscope == 0 then --点 eg 罗汉拳，米字
        if level > 10 then
            m1 = 1
            m2 = JY.Wugong[wugong]["移动范围" .. 10]
            a1 = 1
            a2 = 3
            a3 = 3
			if PersonKF(pid,119) and (wglw2(pid,119) or DT(pid,59)) then
			a2 = a2+3
			a3 = a3+3
			end
			if D1GHYD(pid) and yongdao(wugong) then
			a2 = a2+3
			a3 = a3+3
			end
        else
            m1 = 0
            m2 = JY.Wugong[wugong]["移动范围" .. level]
            a1 = 1
            a2 = math.modf(level / 5)
            a3 = math.modf(level / 8)
        end
		if WAR.DXYM1[pid] == 1 and JLSD(10,40,pid) then--
			m1 = 0
		    a1 = 2
		    a2 = 0
		    m2 = 0
		    a3 = 0
			WAR.DXYM1[pid] = 0
		elseif (WAR.TMMS[pid] == 1 and (DT(pid, 93) or yongan(wugong))) or WAR.QJBMS[pid] == 1 or WAR.QJBMS[pid] == 2 then --唐门模式1
		    m1 = 0
		    a1 = 2
		    a2 = 0
		    m2 = 20
		    a3 = 0
		elseif wugong == 18 and (DT(pid, 57) or wglw1(pid,18)) then --弹指神通
			m1 = 0
		    a1 = 2
		    a2 = 0
		    m2 = 15
		    a3 = 0
		elseif wugong == 13 and wglw1(pid,13) and WAR.CYANGZ == 3 then -- 铁掌长型极意
			a1 = 10
			if level > 10 then
				m1 = 3
				m2 = 1
				a2 = JY.Wugong[wugong]["移动范围" .. 10]*2
				a3 = a2 - 1
				a4 = a3 - 1
			else
				m1 = 2
				m2 = 1
				a2 = JY.Wugong[wugong]["移动范围" .. level]*5
			end
			if level > 7 then
				a3 = a2 - 1
			end
		end		
    elseif fightscope == 1 then --线
		if WAR.DXYM1[pid] == 1 and JLSD(10,40,pid) then--
			m1 = 0
		    a1 = 2
		    a2 = 0
		    m2 = 0
		    a3 = 0
			WAR.DXYM1[pid] = 0
		else
			if kfkind == 1 then --拳，逍遥游，三角
				a1 = 12
				if level > 10 then
					m1 = 3
					m2 = 1
					a2 = JY.Wugong[wugong]["移动范围" .. 10] - 1
					if PersonKF(pid,119) and (wglw2(pid,119) or DT(pid,59)) then
					a2 = a2+3
					end
				else
					m1 = 2
					m2 = 1
					a2 = JY.Wugong[wugong]["移动范围" .. level] - 1
				end
			elseif kfkind == 2 then --剑，线
				if WAR.SBJ == 2 then 
					WAR.WJJF = 2
					a1 = 10
					if level > 10 then
						m1 = 3
						m2 = 1
						a2 = JY.Wugong[wugong]["移动范围" .. 10]*2
						a3 = a2 - 1
						a4 = a3 - 1
					else
						m1 = 2
						m2 = 1
						a2 = JY.Wugong[wugong]["移动范围" .. level]*5
					end
					if level > 7 then
						a3 = a2 - 1
					end	
				else
					WAR.WJJF = 1
					a1 = 11
					if level > 10 then
						m1 = 3
						m2 = 1
						a2 = JY.Wugong[wugong]["移动范围" .. 10] - 1
					else
						m1 = 2
						m2 = 1
						a2 = JY.Wugong[wugong]["移动范围" .. level] - 1
					end
				end 
				a1 = 10
				if level > 10 then
					m1 = 3
					m2 = 1
					a2 = JY.Wugong[wugong]["移动范围" .. 10]
					a3 = a2 - 1
					a4 = a3 - 1
				else
					m1 = 2
					m2 = 1
					a2 = JY.Wugong[wugong]["移动范围" .. level]
				end
				if level > 7 then
					a3 = a2 - 1
				end 
				if PersonKF(pid,119) and (wglw2(pid,119) or DT(pid,59)) and PersonKF(pid,180) == false then
					a2 = a2 + 3
					a3 = a2 - 1
					a4 = a3 - 1
				end
				if PersonGT(pid,180) then 
					a2 = a2 + 3
					a3 = a2 - 1
					a4 = a3 - 1
				elseif PersonKF(pid,180) then
					a2 = a2 + 2
					a3 = a2 - 1
					a4 = a3 - 1
				end
			elseif kfkind == 3 then --刀，三角 聂风傲寒六绝长型极意
				if NF(pid) and yongdao(wugong) and ((JLSD(10,50,pid) and WAR.AHLJ ~= 1) or WAR.AHLJ == 2) then 
					WAR.AHLJ = 2
					a1 = 10
					if level > 10 then
						m1 = 3
						m2 = 1
						a2 = JY.Wugong[wugong]["移动范围" .. 10]*2
						a3 = a2 - 1
						a4 = a3 - 1
					else
						m1 = 2
						m2 = 1
						a2 = JY.Wugong[wugong]["移动范围" .. level]*5
					end
					if level > 7 then
						a3 = a2 - 1
					end	
					WAR.Person[WAR.CurID][CC.TXWZ2] = "惊寒一瞥"
				else
					WAR.AHLJ = 1
					a1 = 11
					if level > 10 then
						m1 = 3
						m2 = 1
						a2 = JY.Wugong[wugong]["移动范围" .. 10] - 1
						if PersonKF(pid,119) and (wglw2(pid,119) or DT(pid,59)) then
						a2 = a2+3
						end
						if D1GHYD(pid) and yongdao(wugong) then
							a2 = a2 + 3
						end	
					else
						m1 = 2
						m2 = 1
						a2 = JY.Wugong[wugong]["移动范围" .. level] - 1
					end
					if wugong == 58 and wglw1(pid, 58) then----
						a2 = a2 * 2
						a3 = a2 - 1
						a4 = a3 - 1
					end
					if wugong == 65  then
						if JY.Person[pid]["武器"] == 366 then
						a2 = a2 + 2
						elseif JY.Person[pid]["武器"] == 367 then
						a2 = a2 + 4
						end
					end	
				end  
				if fqdid(pid) and wugong == 62 then 
					a2 = a2 *2
				end 
			elseif kfkind == 4 then --特殊，鞭，田字
				m1 = 2
				if level > 10 then
					m2 = JY.Wugong[wugong]["移动范围" .. 10] - 1
					a1 = 7
					a2 = 1 + math.modf(level / 3)
					a3 = a2 
					if PersonKF(pid,119) and (wglw2(pid,119) or DT(pid,59)) then
					m2 = JY.Wugong[wugong]["移动范围" .. 10] + 2
					a1 = 7
					a2 = 3 + math.modf(level / 3)
					a3 = a2
					end
					if wglw1(pid,78) and (JY.Person[pid]["武器"] == 51 or JY.Person[pid]["武器"] == 307) then
					m2 = JY.Wugong[wugong]["移动范围" .. 10] +2
					a1 = 7
					a2 = 2 + math.modf(level / 3)
					a3 = a2
					end
				else
					m2 = JY.Wugong[wugong]["移动范围" .. level] - 1
					a1 = 1
					a2 = 1 + math.modf(level / 3)
				end
			end
		end	
    elseif fightscope == 2 then --十字
		if WAR.DXYM1[pid] == 1 and JLSD(10,40,pid) then
			m1 = 0
		    a1 = 2
		    a2 = 0
		    m2 = 0
		    a3 = 0
			WAR.DXYM1[pid] = 0
		else	
			m1 = 0
			m2 = 0
			if kfkind == 3 then --刀，井字
				if level > 10 then
					a1 = 6
					a2 = JY.Wugong[wugong]["移动范围" .. 10]
					if PersonKF(pid,119) and (wglw2(pid,119) or DT(pid,59)) then
					a2 = JY.Wugong[wugong]["移动范围" .. 10]+3
					end
					if D1GHYD(pid) and yongdao(wugong) then
						a2 = JY.Wugong[wugong]["移动范围" .. 10]+3
					end	
				else
					a1 = 8
					a2 = JY.Wugong[wugong]["移动范围" .. level]
				end
			elseif level > 10 then --非刀，十字
			if kfkind == 1 then --拳，太极
				if DT(pid,5) and WAR.JLDL2 == 1 and wugong == 16 then
					a1 = 5
					a2 = JY.Wugong[wugong]["移动范围" .. 10]
					a3 = a2 - 3
				elseif DT(pid,5) and WAR.JLDL2 == 2 and wugong == 16 then
					a1 = 5
					a2 = JY.Wugong[wugong]["移动范围" .. 10] + 1
					a3 = a2 - 3		
				elseif DT(pid,5) and WAR.JLDL2 == 3 and wugong == 16 then
					a1 = 5
					a2 = JY.Wugong[wugong]["移动范围" .. 10] + 2
					a3 = a2 - 3	
				elseif DT(pid,5) and WAR.JLDL2 == 4 and wugong == 16 then
					a1 = 2
					a2 = JY.Wugong[wugong]["移动范围" .. 10] + 2
					a3 = a2 - 3
					m2 = JY.Wugong[wugong]["移动范围" .. 10] + 2				 
			else	 
				a1 = 5
				a2 = JY.Wugong[wugong]["移动范围" .. 10] - 1
				a3 = a2 - 3
				if PersonKF(pid,119) and (wglw2(pid,119) or DT(pid,59)) then
				a2 = JY.Wugong[wugong]["移动范围" .. 10]+3
				a3 = a2 - 3
				end
			end
			elseif kfkind == 2 then --剑，太极
				a1 = 1
				a2 = JY.Wugong[wugong]["移动范围" .. 10] - 1
				a3 = a2
				if PersonGT(pid,180) then 
					a2 = a2 + 3
					a3 = a2
				elseif PersonKF(pid,180) then
					a2 = a2 + 2
					a3 = a2
				end
					if PersonKF(pid,119) and (wglw2(pid,119) or DT(pid,59)) and PersonKF(pid,180) == false then
					a2 = a2 + 3
					a3 = a2
				end
				else --特殊，阴阳，原地菱形
					a1 = 2
					a2 = 1 + math.modf(JY.Wugong[wugong]["移动范围" .. 10] / 2)
					if PersonKF(pid,119) and (wglw2(pid,119) or DT(pid,59)) and PersonKF(pid,180) == false then
					a2 = a2 + 3
					end
					if (wglw1(pid,77) or ((DT(pid,605) or DT(pid,627))and JX(pid))) or wglw1(pid,120) then
						a2 = a2 + 3
					end	
				end
			else
				a1 = 1
				a2 = JY.Wugong[wugong]["移动范围" .. level]
				a3 = 0
				if PersonKF(pid,119) and (wglw2(pid,119) or DT(pid,59)) then
				a2 = a2 + 3
				a3 = 0
				end
				--if WAR.TMMS[pid] == 1 then 
				--a2 = JY.Wugong[wugong]["移动范围" .. level]
				--end
			end
		end	
    elseif fightscope == 3 then --面
		if WAR.DXYM1[pid] == 1 and JLSD(10,40,pid) then--
			m1 = 0
		    a1 = 2
		    a2 = 0
		    m2 = 0
		    a3 = 0
			WAR.DXYM1[pid] = 0
		else	
			if kind2 == 6 then
				m1 = 0
				a1 = 2
				if level > 10 then
					m2 = JY.Wugong[wugong]["移动范围" .. 10]
					a2 = 1 + JY.Wugong[wugong]["杀伤范围" .. 10]
					if PersonKF(pid,119) and (wglw2(pid,119) or DT(pid,59)) then
					m2 = JY.Wugong[wugong]["移动范围" .. 10]
					a2 = JY.Wugong[wugong]["杀伤范围" .. 10] + 3
					end
				else
					m2 = JY.Wugong[wugong]["移动范围" .. level]
					a2 = JY.Wugong[wugong]["杀伤范围" .. level]
				end
				if (WAR.TMMS[pid] == 1 and (DT(pid, 93) or yongan(wugong))) or WAR.QJBMS[pid] == 1 or WAR.QJBMS[pid] == 2 then --唐门模式1
					if ((DT(pid, 92) and TMQ(pid)) or DT(pid, 93)) and JX(pid) then
					else
						a2 = 0
					end
					m2 = 20
				end
			elseif WAR.JLDL2==5 then
				if  wugong== 46 then
					m1 = 0
					a1 = 2
					a2 = 10
					m2 = 20
				else
				end	
			else	
				m1 = 0
				a1 = 3
				if level > 10 then
					m2 = JY.Wugong[wugong]["移动范围" .. 10] + 1
					a2 = JY.Wugong[wugong]["杀伤范围" .. 10]
					a3 = a2
					if PersonKF(pid,119) and (wglw2(pid,119) or DT(pid,59)) then
					m2 = JY.Wugong[wugong]["移动范围" .. 10] + 1
					a2 = JY.Wugong[wugong]["杀伤范围" .. 10] + 3
					a3 = a2
					end
					if wugong == 139  then
						if JY.Person[pid]["武器"] == 365 then
						m2 = JY.Wugong[wugong]["移动范围" .. 10]
						a2 = JY.Wugong[wugong]["杀伤范围" .. 10] + 2
						a3=a2
						elseif JY.Person[pid]["武器"] == 367 then
						m2 = JY.Wugong[wugong]["移动范围" .. 10]
						a2 = JY.Wugong[wugong]["杀伤范围" .. 10] + 4
						a3=a2
						end
					end
					if D1GHYD(pid) and yongdao(wugong) then
						m2 = JY.Wugong[wugong]["移动范围" .. 10] + 1
						a2 = JY.Wugong[wugong]["杀伤范围" .. 10] + 3
						a3 = a2
					end	
				else
					m2 = JY.Wugong[wugong]["移动范围" .. level]
					a2 = JY.Wugong[wugong]["杀伤范围" .. level]
				end	
			end	
		end
    end
    return m1, m2, a1, a2, a3, a4, a5
end

WAR_CALLEVENT = function(num)
  local war = {}
  if war[num] == nil then
    dofile(CONFIG.ScriptPath .. "war\\warevent.lua")
    return 0
  else
    local eventfilename = string.format("warevent%d.lua", num)
    return dofile(CONFIG.ScriptPath .. "war\\" .. eventfilename) or 0
  end
end

WE_xy = function(x, y, id)
  if id ~= nil then
    War_CalMoveStep(id, 128, 0)
  else
    CleanWarMap(3, 0)
  end
  if GetWarMap(x, y, 3) ~= 255 and War_CanMoveXY(x, y, 0) then
    return x, y
  else
    for s = 1, 128 do
      for i = 1, s do
        local j = s - i
        if x + i < 63 and y + j < 63 and GetWarMap(x + i, y + j, 3) ~= 255 and War_CanMoveXY(x + i, y + j, 0) then
          return x + i, y + j
        end
        if x + j < 63 and y - i > 0 and GetWarMap(x + j, y - i, 3) ~= 255 and War_CanMoveXY(x + j, y - i, 0) then
          return x + j, y - i
        end
        if x - i > 0 and y - j > 0 and GetWarMap(x - i, y - j, 3) ~= 255 and War_CanMoveXY(x - i, y - j, 0) then
          return x - i, y - j
        end
        if x - j > 0 and y + i < 63 and GetWarMap(x - j, y + i, 3) ~= 255 and War_CanMoveXY(x - j, y + i, 0) then
          return x - j, y + i
        end
      end
    end
  end
  for s = 1, 128 do
    for i = 1, s do
      local j = s - i
      if x + i < 63 and y + j < 63 and War_CanMoveXY(x + i, y + j, 0) then
        return x + i, y + j
      end
      if x + j < 63 and y - i > 0 and War_CanMoveXY(x + j, y - i, 0) then
        return x + j, y - i
      end
      if x - i > 0 and y - j > 0 and War_CanMoveXY(x - i, y - j, 0) then
        return x - i, y - j
      end
      if x - j > 0 and y + i < 63 and War_CanMoveXY(x - j, y + i, 0) then
        return x - j, y + i
      end
    end
  end
  return x, y
end

WE_getwarid = function(pid)
  for i = 0, WAR.PersonNum - 1 do
    if WAR.Person[i]["人物编号"] == pid then
      return i
    end
  end
  return -1
end

WE_move = function(pid, x, y)
  local id = WE_getwarid(pid)
  if id == -1 then
    return 
  end
  WAR.CurID = id
  local cx, cy = WAR.Person[id]["坐标X"], WAR.Person[id]["坐标Y"]
  local nx, ny = WE_xy(cx + x, cy + y, id)
  War_MovePerson(nx, ny)
  lib.Delay(100)
end

WE_moveto = function(pid, x, y)
  local id = WE_getwarid(pid)
  if id == -1 then
    return 
  end
  WAR.CurID = id
  local nx, ny = WE_xy(x, y, id)
  War_MovePerson(nx, ny)
  lib.Delay(100)
end

WE_follow = function(pid, eid)
  local a = WE_getwarid(pid)
  local b = WE_getwarid(eid)
  if a == -1 or b == -1 then
    return 
  end
  WAR.CurID = a
  local x, y = WAR.Person[b]["坐标X"], WAR.Person[b]["坐标Y"]
  local nx, ny = WE_xy(x, y, a)
  War_MovePerson(nx, ny)
  lib.Delay(100)
end

WE_addperson = function(id, x, y, faseto, flag)
  if not faseto then
    faseto = 0
  end
  if not flag then
    flag = true
  end
  local cx, cy = WE_xy(x, y)
  WAR.Person[WAR.PersonNum]["人物编号"] = id
  WAR.Person[WAR.PersonNum]["我方"] = true
  WAR.Person[WAR.PersonNum]["坐标X"] = cx
  WAR.Person[WAR.PersonNum]["坐标Y"] = cy
  WAR.Person[WAR.PersonNum]["死亡"] = false
  WAR.Person[WAR.PersonNum]["人方向"] = faseto
  WAR.Person[WAR.PersonNum]["贴图"] = WarCalPersonPic(WAR.PersonNum)
  SetWarMap(cx, cy, 2, WAR.PersonNum)
  SetWarMap(cx, cy, 5, WAR.Person[WAR.PersonNum]["贴图"])
  lib.PicLoadFile(string.format(CC.FightPicFile[1], JY.Person[id]["头像代号"]), string.format(CC.FightPicFile[2], JY.Person[id]["头像代号"]), 4 + WAR.PersonNum)
  WAR.Person[WAR.PersonNum]["移动步数"] = math.modf(WAR.Person[WAR.PersonNum]["轻功"] / 20)
  WAR.PersonNum = WAR.PersonNum + 1
end

WE_sort = function()
  WarPersonSort(1)
  for i = 0, WAR.PersonNum - 1 do
    local pid = WAR.Person[i]["人物编号"]
    lib.PicLoadFile(string.format(CC.FightPicFile[1], JY.Person[pid]["头像代号"]), string.format(CC.FightPicFile[2], JY.Person[pid]["头像代号"]), 4 + i)
  end
end

WE_atk = function(id, cx, cy, kfid, lv, flag)
  CleanWarMap(4, 0)
  local cid = WE_getwarid(id)
  local x0 = WAR.Person[cid]["坐标X"]
  local y0 = WAR.Person[cid]["坐标Y"]
  if not War_Direct(0, 0, cx, cy) then
    WAR.Person[cid]["人方向"] = WAR.Person[cid]["人方向"]
  end
  if lv ~= nil then
    local kind, len1, len2 = fenjie(JY.Wugong[kfid]["范围" .. math.modf((lv + 2) / 3)])
    WarDrawAtt(x0 + cx, y0 + cy, kind, len1, len2, 3, x0, y0)
  end
  local tmp = WAR.CurID
  WAR.CurID = cid
  War_ShowFight(id, kfid, JY.Wugong[kfid]["类型"], lv, x0 + cx, y0 + cy, JY.Wugong[kfid]["武功动画&音效"], 0, 0, 0)
  WAR.CurID = tmp
  CleanWarMap(4, 0)
end

WE_JL = function(id1, id2, len)
  if not len then
    len = 1
  end
  local cid1 = WE_getwarid(id1)
  local cid2 = WE_getwarid(id2)
  local x1, y1 = WAR.Person[cid1]["坐标X"], WAR.Person[cid1]["坐标Y"]
  local x2, y2 = WAR.Person[cid2]["坐标X"], WAR.Person[cid2]["坐标Y"]
  local s = math.abs(x1 - x2) + math.abs(y1 - y2)
  if len == nil then
    return s
  end
  do return end
  if s <= len then
    return true
  else
    return false
  end
end

WE_chuxian = function(id, x, y)
  local pid = WE_getwarid(id)
  local cx, cy = WE_xy(x, y)
  SetWarMap(cx, cy, 2, pid)
  SetWarMap(cx, cy, 5, WAR.Person[pid]["贴图"])
  WAR.Person[pid]["坐标X"] = cx
  WAR.Person[pid]["坐标Y"] = cy
end

WE_xiaoshi = function(id)
  local pid = WE_getwarid(id)
  local cx, cy = WAR.Person[pid]["坐标X"], WAR.Person[pid]["坐标Y"]
  SetWarMap(cx, cy, 2, -1)
  SetWarMap(cx, cy, 5, -1)
end

mm4R = function()
	local r = nil
	r = math.random(2)
	if T8LXY(0) then
		r = math.random(3)
		local bdnl = {"姓名", "头像代号", "生命最大值", "内力最大值", "内力性质", "攻击力", "轻功", "防御力", "拳掌功夫", "御剑能力", "耍刀技巧", "特殊兵器", "武功1"}	
		local mm3 = {}
		JY.Person[92]["资质"] = math.random(80, 90)
		mm3[1] = {"赵灵儿", 311, 350, 600, math.random(0, 2), 40, 50, 50, 40, 40, 40, 60, 79}
		mm3[2] = {"林月如", 312, 350, 600, math.random(0, 2), 60, 40, 40, 40, 60, 40, 40, 41}
		mm3[3] =    {"阿奴", 25, 350, 600, math.random(0, 2), 50, 40, 50, 40, 40, 60, 40, 62}
		for i = 1, #bdnl do
			JY.Person[92][bdnl[i]] = mm3[r][i]
		end
		JY.Person[92]["等级"] = 3		
		for i = 1, 5 do
			JY.Person[92]["出招动画帧数" .. i] = 0
			JY.Person[92]["出招动画延迟" .. i] = 0
			JY.Person[92]["武功音效延迟" .. i] = 0
		end
		if r == 1 then
			JY.Person[92]["出招动画帧数1"] = 21
			JY.Person[92]["出招动画延迟1"] = 18
			JY.Person[92]["武功音效延迟1"] = 10		
		end
		if r == 2 then
			JY.Person[92]["出招动画帧数1"] = 12
			JY.Person[92]["出招动画延迟1"] = 7
			JY.Person[92]["武功音效延迟1"] = 5			
		end		
		if r == 3 then
			JY.Person[92]["出招动画帧数1"] = 22
			JY.Person[92]["出招动画延迟1"] = 9
			JY.Person[92]["武功音效延迟1"] = 11
		end
		JY.Person[92]["医疗能力"] = 50
		JY.Person[92]["用毒能力"] = 50
		JY.Person[92]["解毒能力"] = 50		
	else 
		local bdnl = {"姓名", "头像代号", "生命最大值", "内力最大值", "内力性质", "攻击力", "轻功", "防御力", "拳掌功夫", "御剑能力", "耍刀技巧", "特殊兵器", "资质", "武功1"}
		local mm4 = {}
		--local mmzizhi = 101 - JY.Person[0]["资质"]
		mm4[1] = {"周芷若", 301, 350, 600, 0, 60, 60, 60, 60, 70, 0, 0, math.random(70, 80), 41}
		mm4[2] = {"赵敏", 302, 270, 500, 1, 80, 40, 60, 0, 60, 70, 0, math.random(80, 90), 37}
		mm4[3] = {"郭襄", 303, 200, 500, 2, 70, 60, 50, 50, 50, 50, 50, math.random(80, 90), 12}
		mm4[4] = {"陆无双", 304, 400, 700, 0, 50, 70, 60, 60, 0, 70, 0, math.random(10, 50), 54}
		mm4[5] = {"森九岚", 336, 400, 700, 0, 80, 70, 60, 60, 70, 50, 0, math.random(10, 50), 47}
		for i = 1, 14 do
			JY.Person[92][bdnl[i]] = mm4[r][i]
		end
		JY.Person[92]["等级"] = 3

		for i = 1, 5 do
			JY.Person[92]["出招动画帧数" .. i] = 0
			JY.Person[92]["出招动画延迟" .. i] = 0
			JY.Person[92]["武功音效延迟" .. i] = 0
		end
		local avi = {
				{14, 6, 7}, 
				{10, 5, 2}, 
				{16, 10, 3}, 
				{7, 4, 5}}
		JY.Person[92]["出招动画帧数1"] = avi[r][1]
		JY.Person[92]["出招动画延迟1"] = avi[r][3]
		JY.Person[92]["武功音效延迟1"] = avi[r][2]
		if r == 4 then
			JoinMP(92, 3, 1)
		end
		if r == 5 then
			JoinMP(92, 11, 3)
		end
		--[[if r == 3 then
			local s = {
				{0, 0, 0}, 
				{9, 2, 3}, 
				{8, 3, 4}, 
				{8, 3, 4}, 
				{9, 5, 6}}
			for i = 1, 5 do
				JY.Person[92]["出招动画帧数" .. i] = s[i][1]
				JY.Person[92]["出招动画延迟" .. i] = s[i][3]
				JY.Person[92]["武功音效延迟" .. i] = s[i][2]
			end
		end]]
	end
end


--分离颜色的RGB分量
function GetRGB(color)
  color = color % 16777216
  local r = math.floor(color / 65536)
  color = color % 65536
  local g = math.floor(color / 256)
  local b = color % 256
  return r, g, b
end--返回 [0 , i-1] 的整形随机数
function Rnd(i)
  if i == nil or i == 0 then
    return 0
  end
  local r = math.random(i)
  return r - 1
end
--按照t_struct 定义的结构把数据写入data Byte数组中。
function SaveData(t, t_struct, data)
  for k,v in pairs(t_struct) do
    if v[2] == 0 then
      Byte.set16(data, v[1], t[k])
    elseif v[2] == 1 then
      Byte.setu16(data, v[1], t[k])
    elseif v[2] == 2 then
      local s = nil
      if CC.SrcCharSet == 0 then
        s = lib.CharSet(t[k], 1)
      else
        s = t[k]
      end
      Byte.setstr(data, v[1], v[3], s)
    end
  end
end

--场景坐标(x,y)是否可以通过
--返回true,可以，false不能
function SceneCanPass(x, y)
  local ispass = true
  if x > 63 or x < 0 or y > 63 or x < 0 then
    ispass = false
  end
  if GetS(JY.SubScene, x, y, 1) > 0 then
    ispass = false
  end
  local d_data = GetS(JY.SubScene, x, y, 3)
  if d_data >= 0 and GetD(JY.SubScene, d_data, 0) ~= 0 then
    ispass = false
  end
  if CC.SceneWater[GetS(JY.SubScene, x, y, 0)] ~= nil then
    ispass = false
  end
  local hb1, hb2 = nil, nil
  hb1 = GetS(JY.SubScene, JY.Base["人X1"], JY.Base["人Y1"], 4)
  hb2 = GetS(JY.SubScene, x, y, 4)
  if math.abs(hb1 - hb2) > 14 then
    ispass = false
  end
  return ispass
end
--选择场景，马车传送用的
--[[
function SelectSceneMenu(x, y)
  local menu = {};
	for i=0, JY.SceneNum-1 do
		menu[i+1] = {i..JY.Scene[i]["名称"], nil, 1};
	end
  return ShowMenu(menu, JY.SceneNum, 15, x, y, 0, 0, 1, 1, CC.DefaultFont, C_ORANGE, C_WHITE)
end
]]
function SelectSceneMenu(x, y)
  local menu = {};
	for i=0, JY.SceneNum-1 do
		menu[i+1] = {i..JY.Scene[i]["名称"], nil, 2};
		if JY.Scene[i]["进入条件"] == 0 and JY.SubScene ~= 25 and i ~= 83 and i ~= 82 and i ~= 81 then
			menu[i+1][3] = 1
		end
		if i == 13 then
			menu[i+1][3] = 2
		end
	end
  return ShowMenu3(menu, #menu, 7, -2, -2, -2, -2, 1, 1, 18, C_GOLD, C_WHITE,"传送列表","",M_DimGray,C_RED)
end

--选择队友菜单
--返回队友所在的位置
function SelectTeamMenu(x, y, flag) --武骧金星：不适用的人物不显示  
  local menu = {}
  for i = 1, CC.TeamNum do
    menu[i] = {"", nil, 0}
    local id = JY.Base["队伍" .. i]
    if id >= 0 and JY.Person[id]["生命"] > 0 then
      menu[i][1] = JY.Person[id]["姓名"]
	  if flag == nil then
		menu[i][3] = 1
      elseif CanUseThing(flag, id) or (T2SQ(id) and JY.Thing[flag]["类型"] == 1) then 
		menu[i][3] = 1
	  end
    end
  end
  return ShowMenu(menu, CC.TeamNum, 0, x, y, 0, 0, 1, 1, CC.DefaultFont, C_ORANGE, C_WHITE)
end--设置亮度
function setBright()
  for i = 0, 639 do
    Bright[i] = {}
    for j = 0, 479 do
      local light = CC.Light - math.sqrt(i - CC.ScreenW / 2 ^ 2 + j - CC.ScreenH / 2 ^ 2) * CC.Light / CC.Sight
      if light > 255 then
        light = 255
      elseif light < 0 then
        light = 0
      end
      Bright[i][j] = light
    end
  end
end----从数据的结构中翻译数据，保存数据
function SetDataFromStruct1(data, offset, t_struct, key, v)
  local t = t_struct[key]
  local high, low = nil, nil
  if t[2] == 0 then
    Byte.set16(data, t[1] + offset, v)
  elseif t[2] == 1 then
    Byte.setu16(data, t[1] + offset, v)
  elseif t[2] == 2 then
    local s = nil
    if CC.SrcCharSet == 0 then
      s = lib.CharSet(v, 1)
    else
      s = v
    end
    Byte.setstr(data, t[1] + offset, t[3], s)
  end
end---
function SetDataFromStruct2(data, offset, t_struct, key, v)
  local t = t_struct[key]
  local high, low = nil, nil
  if data == JY.Data_Base then
    if type(CC.SBL_Base[t[1] + offset]) ~= "table" then
      CC.SBL_Base[t[1] + offset] = {}
    end
    for s = 1, 10 do
      if CC.SBL_Base[t[1] + offset][s] == nil then
        CC.SBL_Base[t[1] + offset][s] = "◎○" .. v .. "★☆"
        if s == 1 then
          CC.SBL_Base[t[1] + offset][10] = nil
        end
        if s == 10 then
          for z = 1, 9 do
            CC.SBL_Base[t[1] + offset][z] = nil
          end
        end
      end
    end
  elseif data == JY.Data_Person then
    if type(CC.SBL_Person[t[1] + offset]) ~= "table" then
      CC.SBL_Person[t[1] + offset] = {}
    end
    for s = 1, 10 do
      if CC.SBL_Person[t[1] + offset][s] == nil then
        CC.SBL_Person[t[1] + offset][s] = "◎○" .. v .. "★☆"
        if s == 1 then
          CC.SBL_Person[t[1] + offset][10] = nil
        end
	      if s == 10 then
	        for z = 1, 9 do
	          CC.SBL_Person[t[1] + offset][z] = nil
	        end
	      end
	    end
    end
  elseif data == JY.Data_Thing then
    if type(CC.SBL_Thing[t[1] + offset]) ~= "table" then
      CC.SBL_Thing[t[1] + offset] = {}
    end
    for s = 1, 10 do
      if CC.SBL_Thing[t[1] + offset][s] == nil then
        CC.SBL_Thing[t[1] + offset][s] = "◎○" .. v .. "★☆"
        if s == 1 then
          CC.SBL_Thing[t[1] + offset][10] = nil
        end
        if s == 10 then
          for z = 1, 9 do
            CC.SBL_Thing[t[1] + offset][z] = nil
          end
        end
    	end
 		 end
  elseif data == JY.Data_Scene then
    if type(CC.SBL_Scene[t[1] + offset]) ~= "table" then
      CC.SBL_Scene[t[1] + offset] = {}
    end
    for s = 1, 10 do
      if CC.SBL_Scene[t[1] + offset][s] == nil then
        CC.SBL_Scene[t[1] + offset][s] = "◎○" .. v .. "★☆"
        if s == 1 then
          CC.SBL_Scene[t[1] + offset][10] = nil
        end
        if s == 10 then
          for z = 1, 9 do
            CC.SBL_Scene[t[1] + offset][z] = nil
          end
        end
      end
    end
  elseif data == JY.Data_Wugong then
    if type(CC.SBL_Wugong[t[1] + offset]) ~= "table" then
      CC.SBL_Wugong[t[1] + offset] = {}
    end
    for s = 1, 10 do
      if CC.SBL_Wugong[t[1] + offset][s] == nil then
        CC.SBL_Wugong[t[1] + offset][s] = "◎○" .. v .. "★☆"
        if s == 1 then
          CC.SBL_Wugong[t[1] + offset][10] = nil
        end
        if s == 10 then
          for z = 1, 9 do
            CC.SBL_Wugong[t[1] + offset][z] = nil
          end
        end
      end
    end
  elseif data == JY.Data_Shop then
    if type(CC.SBL_Shop[t[1] + offset]) ~= "table" then
      CC.SBL_Shop[t[1] + offset] = {}
    end
    for s = 1, 10 do
      if CC.SBL_Shop[t[1] + offset][s] == nil then
        CC.SBL_Shop[t[1] + offset][s] = "◎○" .. v .. "★☆"
        if s == 1 then
          CC.SBL_Shop[t[1] + offset][10] = nil
        end
        if s == 10 then
	        for z = 1, 9 do
	          CC.SBL_Shop[t[1] + offset][z] = nil
	        end
      	end
      end
    end
  end
  
  if t[2] == 0 then
    if v < 0 then
      v = v + 65536
    end
    high = math.modf((v) / 256)
    low = math.fmod(v, 256)
    v = low * 256 + high
    if v > 32767 then
      v = v - 65536
    end
    v = 65535 - (v)
    Byte.set16(data, t[1] + offset, v)
  elseif t[2] == 1 then
    high = math.modf((v) / 256)
    low = math.fmod(v, 256)
    v = low * 256 + high
    v = 65535 - (v)
    Byte.setu16(data, t[1] + offset, v)
  elseif t[2] == 2 then
    local s = nil
    if CC.SrcCharSet == 0 then
      s = lib.CharSet(v, 1)
    else
      s = v
    end
    Byte.setstr(data, t[1] + offset, t[3], s)
  end
end--从数据的结构中翻译数据，保存数据
function SetDataFromStruct(data, offset, t_struct, key, v)
  local t = t_struct[key]
  local high, low = nil, nil
  if t[2] == 0 then
    Byte.set16(data, t[1] + offset, v)
  elseif t[2] == 1 then
    Byte.setu16(data, t[1] + offset, v)
  elseif t[2] == 2 then
    local s = nil
    if CC.SrcCharSet == 0 then
      s = lib.CharSet(v, 1)
    else
      s = v
    end
    Byte.setstr(data, t[1] + offset, t[3], s)
  end
end--设置游戏内部使用的全程变量
function SetGlobal() --需添加
  JY = {}
  JY.Status = 0      --游戏状态
  JY.Base = {}    --基本数据
  JY.PersonNum = 0  --人物总数
  JY.Person = {}    --人物数据
  JY.ThingNum = 0   --物品总数
  JY.Thing = {}     --物品数据
  JY.SceneNum = 0   --场景总数
  JY.Scene = {}     --场景数据
  JY.WugongNum = 0  --武功总数
  JY.Wugong = {}    --武功数据
  JY.ShopNum = 0    --商店总数
  JY.Shop = {}     --商店数据
  JY.Data_Base = nil     --实际保存R*数据，苍炎似乎已经不用，改用下面的
  JY.Data_Person = nil
  JY.Data_Thing = nil
  JY.Data_Scene = nil
  JY.Data_Wugong = nil
  JY.Data_Shop = nil
  
	JY.Person_Padded = { }
	-- 我写的扩充人物数据的形式数组
	JY.Data_Person_Padded = nil
	
  CC.SBL_Base = {}      --S大写的保存R*数据
  CC.SBL_Person = {}
  CC.SBL_Thing = {}
  CC.SBL_Scene = {}
  CC.SBL_Wugong = {}
  CC.SBL_Shop = {}
  
  JY.MyCurrentPic = 0  --主角当前走路贴图在贴图文件中偏移
  JY.MyPic = 0     --主角当前贴图
  JY.MyTick = 0    --主角没有走路的持续帧数
  JY.MyTick2 = 0   --显示事件动画的节拍
  JY.CDD = 0
  JY.LOADTIME = 0
  JY.SAVETIME = 0
  JY.GTIME = 0
  JY.JB = 1
  JY.ZLXF = 0	--飞影彩蛋（真龙心法开关）
  JY.YZYZ = 0	--以战养战模式（默认开启）
  JY.SJCZ = 0	--随机参战参数（默认关闭）
  JY.ZDZD = 0	--自动战斗参数（默认关闭）
  JY.GOLD = 0
  JY.YEAR = 1
  JY.MONTH = 1
  JY.DAY = 1
  JY.TERM = 1
  JY.TL = 100
  JY.DIFF = 1
  JY.TIMECOUNT = 0

  JY.KHCSJL = 0  --葵花重生

  DIYglobal()
  
  JY.WGLVXS = 0
  JY.MY = 0
  JY.ZJSL = 0
  JY.SID = nil
  JY.LID = nil
  JY.XZSPD = 20
  JY.MV = 0
  JY.MAPKJ = 0
  JY.HEADXZ = 1
  JY.SZJPJC = {}
  JY.LEQ = CC.T1[1] .. CC.T1[4] .. CC.T1[6]
  JY.WXS = "王小石" --新人物
  JY.BCF = "白愁飞"
  JY.XQS = "萧秋水"
  JY.DFWM = "东方未明"
  JY.LXY = "李逍遥"
  JY.ZLE = "赵灵儿"
  JY.LYR = "林月如"
  JY.AN = "阿奴"
  JY.ZY = "赵云"
  JY.GX = "郭襄"
  JY.LWS = "陆无双"
  JY.ZM = "赵敏"
  JY.ZZR = "周芷若"
  JY.XYL = "谢云流"
  JY.SJL = "森九岚" --豸苗：一刀流新人物
  JY.stat = 0
  JY.SQ = CC.T1[7] .. CC.T1[2] .. CC.T1[5] .. CC.T1[3]
  JY.XYK = CC.T1[10] .. CC.T1[8] .. CC.T1[9]
  JY.TF = 0
  JY.RANDOM = 0
  JY.EnterSceneXY = nil    --保存进入场景的坐标，有值可以进入，为nil则重新计算。
  JY.oldMMapX = -1    --上次显示主地图的坐标。用来判断是否需要全部重绘屏幕
  JY.oldMMapY = -1
  JY.oldMMapPic = -1   --上次显示主地图主角贴图
  JY.SubScene = -1    --当前子场景编号
  JY.SubSceneX = 0    --子场景显示位置偏移，场景移动指令使用
  JY.SubSceneY = 0
  JY.Darkness = 0     --=0 屏幕正常显示，=1 不显示，屏幕全黑
  JY.CurrentD = -1    --当前调用D*的编号
  JY.OldDPass = -1    --上次触发路过事件的D*编号, 避免多次触发
  JY.CurrentEventType = -1   --当前触发事件的方式 1 空格 2 物品 3 路过
  
  JY.oldSMapX = -1    --上次显示场景地图的坐标。用来判断是否需要全部重绘屏幕
  JY.oldSMapY = -1
  JY.oldSMapXoff = -1   --上次场景偏移
  JY.oldSMapYoff = -1   
  JY.oldSMapPic = -1   --上次显示场景地图主角贴图
  
  JY.D_Valid = nil     --记录当前场景有效的D的编号，提高速度，不用每次显示都计算了。若为nil则重新计算
  JY_D_Valld_Num = 0   --当前场景有效的D个数
  
  JY.D_PicChange = {}   --记录事件动画改变，以计算Clip
  JY.NumD_PicChange = 0   --事件动画改变的个数
  
  JY.CurrentThing = -1   --当前选择物品，触发事件使用
  JY.MmapMusic = -1     --切换大地图音乐，返回主地图时，如果设置，则播放此音乐
  
  JY.CurrentMIDI = -1   --当前播放的音乐id，用来在关闭音乐时保存音乐id。
  JY.EnableMusic = 1    --是否播放音乐 1 播放，0 不播放
  JY.EnableSound = 1    --是否播放音效 1 播放，0 不播放
  
  
  JY.ThingUseFunction = {}   --物品使用时调用函数，SetModify函数使用，增加新类型的物品
  JY.SceneNewEventFunction = {}  --调用场景事件函数，SetModify函数使用，定义使用新场景事件触发的函数
  WAR = {}   --战斗使用的全程变量。。这里占个位置，因为程序后面不允许定义全局变量了。具体内容在WarSetGlobal函数中
  AutoMoveTab = {[0] = 0}
  Bright = {}
  CC.Light = 200
  CC.Sight = 120
  
end


--显示在大地图上的位置，罗盘专用
function Show_Position()
  if JY.Status ~= GAME_MMAP then
    return 0
  end
  DrawStrBoxWaitKey(string.format("当前位置(%d,%d)", JY.Base["人X"], JY.Base["人Y"]), C_ORANGE, CC.DefaultFont)
  return 1
end
--横向显示菜单，参数和ShowMenu一样
function ShowMenu2(menuItem,numItem,numShow,x1,y1,x2,y2,isBox,isEsc,size,color,selectColor)     --通用菜单函数
    local w=0;
    local h=0;   --边框的宽高
    local i=0;
    local num=0;     --实际的显示菜单项
    local newNumItem=0;  --能够显示的总菜单项数

    lib.GetKey();

    local newMenu={};   -- 定义新的数组，以保存所有能显示的菜单项

    --计算能够显示的总菜单项数
    for i=1,numItem do
        if menuItem[i][3]>0 then
            newNumItem=newNumItem+1;
            newMenu[newNumItem]={menuItem[i][1],menuItem[i][2],menuItem[i][3],i};   --新数组多了[4],保存和原数组的对应
        end
    end

    --计算实际显示的菜单项数
    if numShow==0 or numShow > newNumItem then
        num=newNumItem;
    else
        num=numShow;
    end

    --计算边框实际宽高
    local maxlength=0;
    if x2==0 and y2==0 then
        for i=1,newNumItem do
            if string.len(newMenu[i][1])>maxlength then
                maxlength=string.len(newMenu[i][1]);
            end
        end
		w=(size*maxlength/2+CC.RowPixel)*num+CC.MenuBorderPixel;
		h=size+2*CC.MenuBorderPixel;
    else
        w=x2-x1;
        h=y2-y1;
    end

    local start=1;             --显示的第一项

    local current =1;          --当前选择项
	for i=1,newNumItem do
	    if newMenu[i][3]==2 then
		    current=i;
			break;
		end
	end
	if numShow~=0 then
	    current=1;
	end

    local keyPress =-1;
    local returnValue =0;
	if isBox==1 then
		DrawBox(x1,y1,x1+w,y1+h,C_WHITE);
	end
    while true do
	    if numShow ~=0 then
	        Cls(x1,y1,x1+w,y1+h);
			if isBox==1 then
				DrawBox(x1,y1,x1+w,y1+h,C_WHITE);
			end
		end

	    for i=start,start+num-1 do
  	        local drawColor=color;           --设置不同的绘制颜色
	        if i==current then
	            drawColor=selectColor;
	        end
			DrawString(x1+CC.MenuBorderPixel+(i-start)*(size*maxlength/2+CC.RowPixel),
			           y1+CC.MenuBorderPixel,newMenu[i][1],drawColor,size);
	    end
	    ShowScreen();
		keyPress=WaitKey(1);
		lib.Delay(100);

		if keyPress==VK_ESCAPE then                  --Esc 退出
		    if isEsc==1 then
		        break;
		    end
		elseif keyPress==VK_RIGHT then                --Down
		    current = current +1;
		    if current > (start + num-1) then
		        start=start+1;
		    end
		    if current > newNumItem then
		        start=1;
		        current =1;
		    end
		elseif keyPress==VK_LEFT then                  --Up
		    current = current -1;
		    if current < start then
		        start=start-1;
		    end
		    if current < 1 then
		        current = newNumItem;
		        start =current-num+1;
		    end
		elseif   (keyPress==VK_SPACE) or (keyPress==VK_RETURN)  then
		    if newMenu[current][2]==nil then
		        returnValue=newMenu[current][4];
		        break;
		    else
		        local r=newMenu[current][2](newMenu,current);               --调用菜单函数
		        if r==1 then
		            returnValue= -newMenu[current][4];
		            break;
				else
			        Cls(x1,y1,x1+w,y1+h);
					if isBox==1 then
						DrawBox(x1,y1,x1+w,y1+h,C_WHITE);
					end
		        end
		    end
		elseif keyPress>999999 then
			local kind,mx,my
			if keyPress>1999999 then
				kind=1
				keyPress=keyPress-2000000
			else
				kind=0
				keyPress=keyPress-1000000
			end
			mx=math.modf(keyPress/1000)
			my=math.fmod(keyPress,1000)
			if mx>x1 and mx<x1+w and my>y1 and my<y1+h then
				current=1+math.modf((mx-x1-CC.MenuBorderPixel)/(size*maxlength/2+CC.RowPixel))
				if kind==1 then
					if newMenu[current][2]==nil then
						returnValue=newMenu[current][4];
						break;
					else
						local r=newMenu[current][2](newMenu,current);               --调用菜单函数
						if r==1 then
							returnValue= -newMenu[current][4];
							break;
						else
							Cls(x1,y1,x1+w,y1+h);
							if isBox==1 then
								DrawBox(x1,y1,x1+w,y1+h,C_WHITE);
							end
						end
					end
				end
			end
		end
    end

    Cls(x1,y1,x1+w+1,y1+h+1,0,1);
    return returnValue;
end--通用菜单函数
-- menuItem 表，每项保存一个子表，内容为一个菜单项的定义
--          菜单项定义为  {   ItemName,     菜单项名称字符串
--                          ItemFunction, 菜单调用函数，如果没有则为nil
--                          Visible       是否可见  0 不可见 1 可见, 2 可见，作为当前选择项。只能有一个为2，
--                                        多了则只取第一个为2的，没有则第一个菜单项为当前选择项。
--                                        在只显示部分菜单的情况下此值无效。
--                                        此值目前只用于是否菜单缺省显示否的情况
--                       }
--          菜单调用函数说明：         itemfunction(newmenu,id)
--
--       返回值
--              0 正常返回，继续菜单循环 1 调用函数要求退出菜单，不进行菜单循环
--
-- numItem      总菜单项个数
-- numShow      显示菜单项目，如果总菜单项很多，一屏显示不下，则可以定义此值
--                =0表示显示全部菜单项

-- (x1,y1),(x2,y2)  菜单区域的左上角和右下角坐标，如果x2,y2=0,则根据字符串长度和显示菜单项自动计算x2,y2
-- isBox        是否绘制边框，0 不绘制，1 绘制。若绘制，则按照(x1,y1,x2,y2)的矩形绘制白色方框，并使方框内背景变暗
-- isEsc        Esc键是否起作用 0 不起作用，1起作用
-- Size         菜单项字体大小
-- color        正常菜单项颜色，均为RGB
-- selectColor  选中菜单项颜色,
--;
-- 返回值  0 Esc返回
--         >0 选中的菜单项(1表示第一项)
--         <0 选中的菜单项，调用函数要求退出父菜单，这个用于退出多层菜单
-- star：扩充为全系列战斗快捷键
function ShowMenu(menuItem, numItem, numShow, x1, y1, x2, y2, isBox, isEsc, size, color, selectColor)
	local w = 0
	local h = 0
	local i = 0
	local num = 0
	local newNumItem = 0
	lib.GetKey()
	local newMenu = { }
	for i = 1, numItem do
		if menuItem[i][3] > 0 then
			newNumItem = newNumItem + 1
			newMenu[newNumItem] = { menuItem[i][1], menuItem[i][2], menuItem[i][3], i }
		end
	end
	if newNumItem == 0 then
		return 0
	end
	if numShow == 0 or newNumItem < numShow then
		num = newNumItem
	else
		num = numShow
	end
	local maxlength = 0
	if x2 == 0 and y2 == 0 then
		for i = 1, newNumItem do
			if maxlength < string.len(newMenu[i][1]) then
				maxlength = string.len(newMenu[i][1])
			end
		end
		w = size * maxlength / 2 + 2 * CC.MenuBorderPixel
		h =(size + CC.RowPixel) * num + CC.MenuBorderPixel
	else
		w = x2 - x1
		h = y2 - y1
	end
	local start = 1
	local current = 1
	for i = 1, newNumItem do
		if newMenu[i][3] == 2 then
			current = i
		end
	end
	if numShow ~= 0 then
		current = 1
	end
	local surid = lib.SaveSur(0, 0, CC.ScreenW, CC.ScreenH)
	local keyPress	= -1
	local typeIn		= -1
	local m_x				= -1
	local m_y				= -1
	local returnValue = 0
	if isBox == 1 then
		DrawBox(x1, y1, x1 +(w), y1 +(h), C_WHITE)
	end
  
  
  while true do
    if num ~= 0 then
      lib.LoadSur(surid, 0, 0)
	    if isBox == 1 then
	      DrawBox(x1, y1, x1 + (w), y1 + (h), C_WHITE)
	    end
  	end
	  for i = start, start + num - 1 do
	    local drawColor = color
	    if i == current then
	      drawColor = selectColor
	      lib.Background(x1 + CC.MenuBorderPixel, y1 + CC.MenuBorderPixel + (i - start) * (size + CC.RowPixel), x1 - CC.MenuBorderPixel + (w), y1 + CC.MenuBorderPixel + (i - start) * (size + CC.RowPixel) + size, 128, color)
	    end
		if newMenu[i] ~= nil then
			DrawString(x1 + CC.MenuBorderPixel, y1 + CC.MenuBorderPixel + (i - start) * (size + CC.RowPixel), newMenu[i][1], drawColor, size)
		end
	  end

		-- star：重新排版战斗快捷键说明文字
	if JY.Status == GAME_WMAP and numItem == 15 and menuItem[15][1] == "自动" then		-- 如果是战斗状态
     --if JY.Status == GAME_WMAP and menuItem[14][1] == "自动" then 
	  DrawString(70, CC.ScreenH - 22, CC.EVB117, C_WHITE, 20)
    end

	  ShowScreen()
	  keyPress = WaitKey(1)
	  lib.Delay(100)
	  if keyPress==VK_ESCAPE then                  --Esc 退出
			if isEsc==1 then
				break							-- star：这里用break更好，不会产生内存泄露问题
				--return 0
			end
	  elseif keyPress==VK_DOWN then                --Down
	    current = current +1;
	    if current > (start + num-1) then
	        start=start+1;
	    end
	    if current > newNumItem then
	        start=1;
	        current =1;
	    end
		elseif keyPress==VK_UP then                  --Up
	    current = current -1;
	    if current < start then
	        start=start-1;
	    end
	    if current < 1 then
	        current = newNumItem;
	        start =current-num+1;
	    end
	  elseif keyPress == VK_RIGHT then
      current = current + 10
      if start + num - 1 < current then
      	start = start + 10
      end
      if newNumItem < current then
      	current = newNumItem
      	start = current - num + 1
      end
    elseif keyPress == VK_LEFT then
	    current = current - 10
	    if current < start then
	    	start = start - 10
	    end
	    if current < 1 then
	    	start = 1
	    	current = 1
	    end
		elseif  keyPress==VK_SPACE or keyPress==VK_RETURN  then
	    if newMenu[current][2]==nil then
	      returnValue=newMenu[current][4];
	      break;
	    else
				local r = newMenu[current][2](newMenu, current);			-- 调用菜单函数
				if r == 1 then
					returnValue = - newMenu[current][4];
					break;
				elseif r == 10000 then
					returnValue = -10000
					break;
				end
				lib.LoadSur(surid, 0, 0);
				if isBox == 1 then
					DrawBox(x1, y1, x1 + w, y1 + h, C_WHITE);
				end
			end
		elseif keyPress == 888 and start > 1 then
			start = start - 1
		elseif keyPress == 999 and start < newNumItem - num + 1 then
			start = start + 1
		elseif keyPress > 999999 then
			local kind, mx, my = nil, nil, nil
			local dealed_keyPress = keyPress
			if dealed_keyPress > 1999999 then
				kind = 1
				dealed_keyPress = dealed_keyPress - 2000000
			else
				kind = 0
				dealed_keyPress = dealed_keyPress - 1000000
			end
			mx = math.modf(dealed_keyPress / 1000)
			my = math.fmod(dealed_keyPress, 1000)
			
			if mx > x1 and mx < x1 + w and my > y1 and my < y1 + h then
				current = start + math.modf((my - y1 - CC.MenuBorderPixel) /(size + CC.RowPixel))
				if kind == 1 then
					if newMenu[current][2] == nil then
						returnValue = newMenu[current][4];
						break;
					else
						local r = newMenu[current][2](newMenu, current);
						-- 调用菜单函数
						if r == 1 then
							returnValue = - newMenu[current][4];
							break;
						elseif r == 10000 then
							returnValue = -10000
							break;
						end
					end
				end
			end
			lib.LoadSur(surid, 0, 0)
			if isBox == 1 then
				DrawBox(x1, y1, x1 +(w), y1 +(h), C_WHITE)
			end
		end
		-- star：战斗快捷键的实现，现已扩充完整
		-- 加入更严密的判断条件
		--if JY.Status == GAME_WMAP and numItem == 17 and menuItem[15][1] == "自动" then --numItem == 14 武骧金星：允许投降带来的问题
		if JY.Status == GAME_WMAP and numItem >= 17 and menuItem[15][1] == "自动" then --numItem == 14 无酒不欢：打磨了一下四老师9000000000小时精心制作的判断条件
		--if JY.Status == GAME_WMAP and menuItem[14][1] == "自动" then 
				if keyPress == 97 and menuItem[2][3] == 1 then
				local r = War_FightMenu()
					if r == 1 then
						returnValue = -2
						break;
					end
				end
				if keyPress >= 49 and keyPress <= 57 and menuItem[2][3] == 1 then
					local r = DIY_War_FightMenu(0,0,keyPress-48)
					if r == 1 then
						returnValue = -2
						break;
					end
				end
				if keyPress == 48 and menuItem[2][3] == 1 then
					local r = DIY_War_FightMenu(0,0,10)
					if r == 1 then
						returnValue = -2
						break;
					end
				end
				if keyPress == 100 and menuItem[8][3] == 1 then
					local r = War_DefupMenu()
					if r == 1 then
						returnValue = -8
						break;
					end
				end
				if keyPress == 112 and menuItem[7][3] == 1 then
					local r = War_ActupMenu()
					if r == 1 then
						returnValue = -7
						break;
					end
				end

			if keyPress == 101 and menuItem[6][3] == 1 then	--E物品
				local r = War_ThingMenu()
				if r == 1 then
					returnValue = -6
					break;
				end
			end
			if keyPress == 114 and menuItem[10][3] == 1 then	--R休息
				local r = War_RestMenu()
				if r == 1 then
					returnValue = -10
					break;
				end
			end
			if keyPress == 102 and menuItem[5][3] == 1 then	--F医疗
				local r = War_DoctorMenu()
				if r == 1 then
					returnValue = -5
					break;
				end
			end
			if keyPress == 118 and menuItem[3][3] == 1 then	--V用毒
				local r = War_PoisonMenu()
				if r == 1 then
					returnValue = -3
					break;
				end
			end
			
			if keyPress == 116 and menuItem[11][3] == 1 then	--T指令
				local r = War_TgrtsMenu()
				if r == 1 then
					returnValue = -11
					break;
				end
			end
			
          --[[  if keyPress == 113 then	--Q隐藏（直接胜利）
				local r = War_Quit()	
				if r == 1 then
					returnValue = -2
					break;
				end
			end]]			
			
			if keyPress == 122 and menuItem[9][3] == 1 then	--Z状态
				local r = War_StatusMenu()
				if r == 1 then
					returnValue = -9
					break;
				end
			end
			
			if keyPress == 119 and menuItem[16][3] == 1 then	--武骧金星：W状态
				local r = War_Wait()
				if r == 1 then
					returnValue = -16
					break;
				end
			end			
		end
		
	end
	
	lib.LoadSur(surid, 0, 0)
	lib.FreeSur(surid)
	return returnValue
	
end

--flag =0 or nil 全部刷新屏幕
--      1 考虑脏矩形的快速刷新
function ShowScreen(flag)
  if JY.Darkness == 0 then
    if flag == nil then
      flag = 0
    end
    lib.ShowSurface(flag)
  end
end--分割字符串
--szFullString字符串
--szSeparator分割符
--返回总数,分割后数组
function Split(szFullString, szSeparator)
  local nFindStartIndex = 1
  local nSplitIndex = 1
  local nSplitArray = {}
  while true do
    local nFindLastIndex = string.find(szFullString, szSeparator, nFindStartIndex)
    if not nFindLastIndex then
      nSplitArray[nSplitIndex] = string.sub(szFullString, nFindStartIndex, string.len(szFullString))
      break;
    else
	    nSplitArray[nSplitIndex] = string.sub(szFullString, nFindStartIndex, nFindLastIndex - 1)
	    nFindStartIndex = nFindLastIndex + string.len(szSeparator)
	    nSplitIndex = nSplitIndex + 1
	  end
  end
  return nSplitIndex, nSplitArray
end
--SSQXH
function SSQXH()
  local hm = {0, 0, 0, 0, 0, 0}
  for i = 1, 6 do
    local a = 1
    if a == 1 then
      hm[i] = math.random(32)
      for s = 1, i do
        if hm[i] == hm[s] and i ~= s then
          a = 2
        end
      end
    end
    if hm[i] < 10 then
    	hm[i] = "0" .. hm[i]
    end
	end
	local t = math.random(16)
	DrawStrBoxWaitKey(hm[1] .. "," .. hm[2] .. "," .. hm[3] .. "," .. hm[4] .. "," .. hm[5] .. "," .. hm[6] .. "," .. t, C_GOLD, 40)
end
----
function ssssdad()
    local movetable={};  --   记录每步移动
    for i=movenum,1,-1 do    --从目的位置反着找到初始位置，作为移动的次序
        movetable[i]={};
        movetable[i].x=xx;
        movetable[i].y=yy;
        if xy[xx-1][yy]==i-1 then
            xx=xx-1;
            movetable[i].direct=1;
        elseif xy[xx+1][yy]==i-1 then
            xx=xx+1;
            movetable[i].direct=2;
        elseif xy[xx][yy-1]==i-1 then
            yy=yy-1;
            movetable[i].direct=3;
        elseif xy[xx][yy+1]==i-1 then
            yy=yy+1;
            movetable[i].direct=0;
        end
    end
	local rmove=-1
    for i=1,movenum do
        local t1=lib.GetTime();
		--JY.Base["人X1"]=movetable[i].x
		--JY.Base["人Y1"]=movetable[i].y
		if JY.Status==GAME_SMAP then
			if instruct_30_sub(movetable[i].direct) ==nil then 
				break
			end
		elseif JY.Status==GAME_MMAP then
			if MMAPMovesub(movetable[i].direct) ==nil then 
				break
			end
		end
		ShowScreen();
		local key=lib.GetKey()
        local t2=lib.GetTime();
		if i<movenum then
			if (t2-t1)< 2*CC.Frame then
				lib.Delay(2*CC.Frame-(t2-t1));
			end
		end
		if key~=-1 then
			if key>1999999 then
				rmove=key-2000000
				break
			elseif key<1000000 then
				break
			end
		end
    end
	if rmove~=-1 then
			local mx=math.modf(rmove/1000)
			local my=math.fmod(rmove,1000)
			mx=mx-CC.ScreenW/2
			my=my-CC.ScreenH/2
			mx=mx/CC.XScale
			my=my/CC.YScale
			mx,my=(mx+my)/2,(my-mx)/2
			if mx>0 then mx=mx+0.99 else mx=mx-0.01 end
			if my>0 then my=my+0.99 else mx=mx-0.01 end
			mx=math.modf(mx)
			my=math.modf(my)
			for i=1,20 do
				if JY.Status==GAME_MMAP or mx+i >63 or my+i>63 then
					break
				end
				if math.abs(GetS(JY.SubScene,JY.Base["人X1"]+mx+i,JY.Base["人Y1"]+my+i,4)-CC.YScale*i*2)<8 then
					mx=mx+i
					my=my+i
					break
				end
			end
			walkto(mx,my)
	end
end--开始游戏动画
function STARTDH()
  lib.FillColor(0, 0, CC.ScreenW, CC.ScreenH, C_BLACK)
  ShowScreen()
  lib.Delay(100)
  local ssid = lib.SaveSur(0, 0, CC.ScreenW, CC.ScreenH)
  for ii = 1574, 1578 do
    lib.PicLoadCache(3, ii * 2, CC.ScreenW / 2, CC.ScreenH / 2, 2, 192)
    ShowScreen()
    lib.Delay(20)
    lib.LoadSur(ssid, 0, 0)
  end
  for ii = 1574, 1578 do
    lib.PicLoadCache(3, ii * 2, CC.ScreenW / 2, CC.ScreenH / 2, 2, 192)
    ShowScreen()
    lib.Delay(20)
    lib.LoadSur(ssid, 0, 0)
  end
  for ii = 1566, 1573 do
    lib.PicLoadCache(3, ii * 2, CC.ScreenW / 2, CC.ScreenH / 2, 2, 192)
    ShowScreen()
    lib.Delay(50)
    lib.LoadSur(ssid, 0, 0)
  end
  for i = 20, 40 do
    NewDrawString(-1, -1, CC.s30, C_GOLD, i)
    ShowScreen()
    lib.Delay(1)
    if i == 40 then
      ClsN()
      for z = 1, 20 do
        if z > 10 then
          NewDrawString(1150, 680, CC.s31, C_RED, 20)
        end
        NewDrawString(-1, -1, CC.s30, C_GOLD, 40)
        ShowScreen()
        lib.Delay(1)
      end
    end
  end
  for ii = 1597, 1604 do
    lib.PicLoadCache(3, ii * 2, CC.ScreenW / 2, CC.ScreenH / 2, 2, 192)
    ShowScreen()
    lib.Delay(50)
    lib.LoadSur(ssid, 0, 0)
  end
  for ii = 1610, 1616 do
    lib.PicLoadCache(3, ii * 2, CC.ScreenW / 2, CC.ScreenH / 2, 2, 192)
    ShowScreen()
    lib.Delay(50)
    lib.LoadSur(ssid, 0, 0)
  end
  for i = 20, 40 do
    NewDrawString(-1, -1, CC.s40, C_RED, i)
    ShowScreen()
    lib.Delay(1)
    if i == 40 then
      ClsN()
      for z = 1, 30 do
        if z > 10 then
          NewDrawString(-1, 680, CC.s46, C_GOLD, 20)
        end
        NewDrawString(-1, -1, CC.s40, C_RED, 40)
        ShowScreen()
        lib.Delay(1)
      end
    end
  end
  for ii = 1535, 1563 do
    lib.PicLoadCache(3, ii * 2, CC.ScreenW / 2, CC.ScreenH / 2, 2, 192)
    ShowScreen()
    lib.Delay(100)
    lib.LoadSur(ssid, 0, 0)
  end
  lib.FreeSur(ssid)
end--角色是否为零二七
function T1LEQ(id)
  if zj() == 0 and id == 0 and teshu() == 1 then
    return true
  else
    return false
  end
end--判断角色是否为水镜四奇
function T2SQ(id)
  if zj() == 0 and id == 0 and teshu() == 2 then
    return true
  else
    return false
  end
end--判断角色是否为萧雨客
function T3XYK(id)
  if zj() == 0 and id == 0 and teshu() == 3 then
    return true
  else
    return false
  end
end

function T4WXS(id) --王小石判定
  if zj() == 0 and id == 0 and teshu() == 4 then
    return true
  else
    return false
  end
end

function T5BCF(id) --白愁飞判定
  if zj() == 0 and id == 0 and teshu() == 5 then
    return true
  else
    return false
  end
end

function T6XQS(id) --萧秋水判定
  if zj() == 0 and id == 0 and teshu() == 6 then
    return true
  else
    return false
  end
end

function T7DFWM(id) --东方未明判定
  if zj() == 0 and id == 0 and teshu() == 7 then
    return true
  else
    return false
  end
end

function T8LXY(id) --李逍遥判定
  if zj() == 0 and id == 0 and teshu() == 8 then
    return true
  else
    return false
  end
end

--3mm判定
function ZLE(id)
	if DT(id, 656) then --id == 656 or (id == 92 and T8LXY(0)) then
		return true
	else
		return false
	end
end

function LYR(id)
	if DT(id, 655) then --id == 655 or (id == 92 and T8LXY(0)) then
		return true
	else
		return false
	end
end

function AN(id)
	if DT(id, 657) then --id == 657 or (id == 92 and T8LXY(0)) then
		return true
	else
		return false
	end
end

function GX(id)
	if id == 92 and JY.Person[id]["姓名"] == JY.GX and not T8LXY(0) then
		return true
	else
		return false
	end
end

function ZM(id)
	if id == 92 and JY.Person[id]["姓名"] == JY.ZM and not T8LXY(0) then
		return true
	else
		return false
	end
end

function ZZR(id)
	if id == 92 and JY.Person[id]["姓名"] == JY.ZZR and not T8LXY(0) then
		return true
	else
		return false
	end
end

function LWS(id)
	if id == 92 and JY.Person[id]["姓名"] == JY.LWS and not T8LXY(0) then
		return true
	else
		return false
	end
end

function MRL(id)
	if id == 92 and JY.Person[id]["姓名"] == "苗若兰" and not T8LXY(0) then
		return true
	else
		return false
	end
end

function TMQ(id)
	if id == 92 and JY.Person[id]["姓名"] == "唐萌浅" and setRW(5) and not T8LXY(0) then
		return true
	else
		return false
	end
end

function SJL(id) --武骧金星：森九岚判定
	if DT(id,929) then
		return true
	else
		return false
	end
end

function T9ZY(id) --赵云判定
  if zj() == 0 and id == 0 and teshu() == 9 then
    return true
  end
  --if id == 582 and JY.Person[0]["姓名"] == JY.ZY and 
	--teshu() == 9 and WAR.ZY > 0 then
	--return true
  --end
  return false
end

function T10XXZ(id) --武骧金星：萧笑竹判定
  if zj() == 0 and id == 0 and teshu() == 10 then
    return true
  else
    return false
  end
end

function T11CJR(id) --武骧金星：藏镜人判定
  if zj() == 0 and id == 0 and teshu() == 11 then
    return true
  else
    return false
  end
end

function T12YMZ(id) --武骧金星：杨妙真判定
  if zj() == 0 and id == 0 and teshu() == 12 then
    return true
  else
    return false
  end
end

function T13TQS(id) ----沼跃鱼：滕青山判定
  if zj() == 0 and id == 0 and teshu() == 13 then
    return true
  else
    return false
  end
end

function XYL(id) --武骧金星：谢云流判定
  if zj() == 0 and id == 0 and teshu() == 14 then
    return true 
  else
    return false
  end
end

function NF(id) --聂风判定
  if zj() == 0 and id == 0 and teshu() == 15 then
    return true 
  else
    return false
  end
end

function BJY(id) --步惊云判定
  if zj() == 0 and id == 0 and teshu() == 16 then
    return true 
  else
    return false
  end
end

function FHXX(id) --风花小雪
  if zj() == 0 and id == 0 and putong() == 2 and JY.Person[0]["姓名"] == "风花小雪" and JY.Person[0]["性别"] == 1 then
    return true 
  else
    return false
  end
end

function J1ZBF(id) --卓不凡
  if zj() == 0 and id == 0 and putong() == 2 and JY.Person[0]["姓名"] == "卓不凡" and JY.Person[0]["性别"] == 0 then
    return true 
  else
    return false
  end
end

function J2YSS(id) --燕十三
  if zj() == 0 and id == 0 and putong() == 2 and JY.Person[0]["姓名"] == "燕十三" and JY.Person[0]["性别"] == 0 then
    return true 
  else
    return false
  end
end

function D1GHYD(id)
	if zj() == 0 and id == 0 and putong() == 3 and JY.Person[0]["姓名"] == "归海一刀" and JY.Person[0]["性别"] == 0 then
    return true 
  else
    return false
  end
end
--新人物

--最简单版本对话
function Talk(s,personid)            --最简单版本对话
    local flag;
    if personid==0 then
        flag=1;
	else
	    flag=0;
	end
	TalkEx(s,personid,flag);
end

--复杂版本对话
--s 字符串，必须加上*作为分行，如果里面没有*,则会自动加上
function TalkEx(s,headid,flag)          --复杂版本对话
  local picw = 130
  local pich = 130
  local talkxnum = 18
  local talkynum = 3
  local dx = 2
  local dy = 2
  local boxpicw = picw + 10
  local boxpich = pich + 10
  local boxtalkw = 12 * CC.DefaultFont + 10
  local boxtalkh = boxpich
  local talkBorder = (pich - talkynum * CC.DefaultFont) / (talkynum + 1)
  local xy = {
{headx = CC.ScreenW - 1 - dx - boxpicw, heady = CC.ScreenH - dy - boxpich, talkx = CC.ScreenW - 1 - dx - boxpicw - boxtalkw - 2, talky = CC.ScreenH - dy - boxpich, showhead = 1}, 
{headx = dx, heady = dy, talkx = dx + boxpicw + 2, talky = dy, showhead = 0}, 
{headx = CC.ScreenW - 1 - dx - boxpicw, heady = CC.ScreenH - dy - boxpich, talkx = CC.ScreenW - 1 - dx - boxpicw - boxtalkw - 2, talky = CC.ScreenH - dy - boxpich, showhead = 1}, 
{headx = CC.ScreenW - 1 - dx - boxpicw, heady = dy, talkx = CC.ScreenW - 1 - dx - boxpicw - boxtalkw - 2, talky = dy, showhead = 1}, 
{headx = dx, heady = CC.ScreenH - dy - boxpich, talkx = dx + boxpicw + 2, talky = CC.ScreenH - dy - boxpich, showhead = 1}; 
[0] = {headx = dx, heady = dy, talkx = dx + boxpicw + 2, talky = dy, showhead = 1}}
  if flag < 0 or flag > 5 then
    flag = 0
  end
  if xy[flag].showhead == 0 then
    headid = -1
  end
  if string.find(s, "*") == nil then
    s = GenTalkString(s, 12)
  end
  if CONFIG.KeyRepeat == 0 then
    lib.EnableKeyRepeat(0, CONFIG.KeyRepeatInterval)
  end
  lib.GetKey()
  local startp = 1
  local endp = nil
  local dy = 0
   if headid >= 0 then
	if headid > 243 and headid < 249 then
	  headid = 0
	end
	headid = gethead(headid)
	end
  while 1 do
    if dy == 0 then
      Cls()
      if headid >= 0 then
        DrawBox(xy[flag].headx, xy[flag].heady, xy[flag].headx + boxpicw, xy[flag].heady + boxpich, C_WHITE)
        local w, h = lib.PicGetXY(1, (headid) * 2)
        local x = (picw - w) / 2
        local y = (pich - h) / 2
        lib.PicLoadCache(1, (headid) * 2, xy[flag].headx + 5 + x, xy[flag].heady + 5 + y, 1)
        if headid > 0 and headid < 190 then
			if AN(92) and headid == 25 then
				DrawString(xy[flag].headx + 5 + x, xy[flag].heady + 5 + y + 110, "阿奴", C_GOLD, 20)
			else
				DrawString(xy[flag].headx + 5 + x, xy[flag].heady + 5 + y + 110, JY.Person[headid]["姓名"], C_GOLD, 20)
			end
		end
	    DrawBox(xy[flag].talkx, xy[flag].talky, xy[flag].talkx + boxtalkw, xy[flag].talky + boxtalkh, C_WHITE)
      end
      
    end
    endp = string.find(s, "*", startp)
    if endp == nil then
      DrawString(xy[flag].talkx + 5, xy[flag].talky + 5 + talkBorder + dy * (CC.DefaultFont + talkBorder), string.sub(s, startp), C_WHITE, CC.DefaultFont)
      ShowScreen()
      WaitKey()
      break;
    else
      DrawString(xy[flag].talkx + 5, xy[flag].talky + 5 + talkBorder + dy * (CC.DefaultFont + talkBorder), string.sub(s, startp, endp - 1), C_WHITE, CC.DefaultFont)
    end
    dy = dy + 1
    startp = endp + 1
    if talkynum <= dy then
      ShowScreen()
      WaitKey()
      dy = 0
    end
  end
  if CONFIG.KeyRepeat == 0 then
    lib.EnableKeyRepeat(CONFIG.KeyRepeatDelay, CONFIG.KeyRepeatInterval)
  end
  Cls()
end

--最简单版本对话
function MyTalk(s,personid)            --最简单版本对话
    --[[local flag;
    if personid==0 then
        flag=1;
		else
	    flag=0;
	end
	MyTalkEx(s,personid,flag,1);]]
	say(s, personid)
end

--最简单版本对话
function MyTalk1(s,personid, name)            --最简单版本对话
    local flag;
    if personid==0 then
        flag=1;
		else
	    flag=0;
	end
	MyTalkEx(s,personid,flag,1, name);
end

--自定义复杂版本对话
--s 字符串，必须加上*作为分行，如果里面没有*,则会自动加上
--pid 人物编号
--flag 显示位置
--showname 是否显示名字
--name 显示的名字
function MyTalkEx(s,pid,flag,showname,name)          --复杂版本对话
  local picw = 130
  local pich = 130
  local talkxnum = 18
  local talkynum = 3
  local dx = 2
  local dy = 2
  local boxpicw = picw + 10
  local boxpich = pich + 10
  local boxtalkw = 12 * CC.DefaultFont + 10
  local boxtalkh = boxpich
  local talkBorder = (pich - talkynum * CC.DefaultFont) / (talkynum + 1)
  local xy = {
{headx = CC.ScreenW - 1 - dx - boxpicw, heady = CC.ScreenH - dy - boxpich, talkx = CC.ScreenW - 1 - dx - boxpicw - boxtalkw - 2, talky = CC.ScreenH - dy - boxpich, showhead = 1}, 
{headx = dx, heady = dy, talkx = dx + boxpicw + 2, talky = dy, showhead = 0}, 
{headx = CC.ScreenW - 1 - dx - boxpicw, heady = CC.ScreenH - dy - boxpich, talkx = CC.ScreenW - 1 - dx - boxpicw - boxtalkw - 2, talky = CC.ScreenH - dy - boxpich, showhead = 1}, 
{headx = CC.ScreenW - 1 - dx - boxpicw, heady = dy, talkx = CC.ScreenW - 1 - dx - boxpicw - boxtalkw - 2, talky = dy, showhead = 1}, 
{headx = dx, heady = CC.ScreenH - dy - boxpich, talkx = dx + boxpicw + 2, talky = CC.ScreenH - dy - boxpich, showhead = 1}; 
[0] = {headx = dx, heady = dy, talkx = dx + boxpicw + 2, talky = dy, showhead = 1}}
  if flag < 0 or flag > 5 then
    flag = 0
  end
  if string.find(s, "*") == nil then
    s = GenTalkString(s, 12)
  end
  if CONFIG.KeyRepeat == 0 then
    lib.EnableKeyRepeat(0, CONFIG.KeyRepeatInterval)
  end
  lib.GetKey()
  local startp = 1
  local endp = nil
  local dy = 0
  local headid = JY.Person[pid]["头像代号"];
  if headid >= 0 then
if headid > 243 and headid < 249 then
  headid = 0
end
headid = gethead(headid)  
end
  while 1 do
    if dy == 0 then
      Cls()
      if headid >= 0 then
        DrawBox(xy[flag].headx, xy[flag].heady, xy[flag].headx + boxpicw, xy[flag].heady + boxpich, C_WHITE)
        local w, h = lib.PicGetXY(1, (headid) * 2)
        local x = (picw - w) / 2
        local y = (pich - h) / 2
        lib.PicLoadCache(1, (headid) * 2, xy[flag].headx + 5 + x, xy[flag].heady + 5 + y, 1)
        if showname ~= nil and showname == 1 then
        	local showx = xy[flag].headx + 5;
        	local showy = xy[flag].heady + 5 + pich - 20
        	if name ~= nil then
	      		DrawString(showx, showy, name, C_GOLD, 20)
	      	else
	      		DrawString(showx, showy, JY.Person[pid]["姓名"], C_GOLD, 20)
	      	end
	      end
	      DrawBox(xy[flag].talkx, xy[flag].talky, xy[flag].talkx + boxtalkw, xy[flag].talky + boxtalkh, C_WHITE)
      end
      
    end
    endp = string.find(s, "*", startp)
    if endp == nil then
      DrawString(xy[flag].talkx + 5, xy[flag].talky + 5 + talkBorder + dy * (CC.DefaultFont + talkBorder), string.sub(s, startp), C_WHITE, CC.DefaultFont)
      ShowScreen()
      WaitKey()
      break;
    else
      DrawString(xy[flag].talkx + 5, xy[flag].talky + 5 + talkBorder + dy * (CC.DefaultFont + talkBorder), string.sub(s, startp, endp - 1), C_WHITE, CC.DefaultFont)
    end
    dy = dy + 1
    startp = endp + 1
    if talkynum <= dy then
      ShowScreen()
      WaitKey()
      dy = 0
    end
  end
  if CONFIG.KeyRepeat == 0 then
    lib.EnableKeyRepeat(CONFIG.KeyRepeatDelay, CONFIG.KeyRepeatInterval)
  end
  Cls()
end


--计算人物修炼成功需要的点数
--id 人物id
function TrainNeedExp(id)         --计算人物修炼物品成功需要的点数
  local thingid = JY.Person[id]["修炼物品"]
  local r = 0
  if thingid >= 0 then
    if JY.Thing[thingid]["练出武功"] >= 0 then
      local level = 0
      for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
        if JY.Person[id]["武功" .. i] == JY.Thing[thingid]["练出武功"] then
          level = math.modf(JY.Person[id]["武功等级" .. i] / 100)
		  if level > 10 then level = 10 end
        end
      end
      if level < 9 then
        r = (150 - JY.Person[id]["资质"]) * JY.Thing[thingid]["需经验"] * (level + 1) / 50
			else
      	r = math.huge
      	return r
      end
    else
    	r = (150 - JY.Person[id]["资质"]) * JY.Thing[thingid]["需经验"] * 2 / 50
    end
  end
  return math.modf(r)
end--物品使用模块
--当前物品id
--返回1 使用了物品， 0 没有使用物品。可能是某些原因不能使用
function UseThing(id)
  if JY.ThingUseFunction[id] == nil then
    return DefaultUseThing(id)
  else
    return JY.ThingUseFunction[id](id)
  end
end--剧情物品，触发事件
function UseThing_Type0(id)
  if JY.SubScene >= 0 then
    local x = JY.Base["人X1"] + CC.DirectX[JY.Base["人方向"] + 1]
    local y = JY.Base["人Y1"] + CC.DirectY[JY.Base["人方向"] + 1]
    local d_num = GetS(JY.SubScene, x, y, 3)
    if d_num >= 0 then
      JY.CurrentThing = id
      EventExecute(d_num, 2)
      JY.CurrentThing = -1
      return 1
    end
    return 0
  end
end--装备物品

function chkthingattrib(id)
	local aa = JY.Thing[id]["加攻击力"] + JY.Thing[id]["加防御力"] + JY.Thing[id]["加轻功"]
	aa = aa + math.modf((JY.Thing[id]["加拳掌功夫"] + JY.Thing[id]["加御剑能力"] + JY.Thing[id]["加耍刀技巧"] + JY.Thing[id]["加特殊兵器"]) * 2)
	local bb = JY.Thing[id]["需拳掌功夫"] + JY.Thing[id]["需御剑能力"] + JY.Thing[id]["需耍刀技巧"] + JY.Thing[id]["需特殊兵器"]
	local cc = JY.Thing[id][WZ5] - 1
	if cc < 0 then cc = 0 end
	aa = aa - cc
	if (id >= 36 and id <= 57) or id == 236 or (id >= 243 and id <= 247) or (id > 249 and id <= 252) 
		or id == 255 or (id >= 290 and id <= 302) then
		if math.modf(aa * 2) == bb then
			return true
		end
	end
	if id >= 58 and id <= 62 then
		if aa <= 60 then
			return true
		end
	end
	if id == 63 or id == 230 or id == 248 or id == 253 then
		if aa <= 30 then
			return true
		end		
	end
	return false
end

function UseThing_Type1(id)
  DrawStrBox(CC.MainSubMenuX, CC.MainSubMenuY, string.format("谁要配备%s?", JY.Thing[id]["名称"]), C_WHITE, CC.DefaultFont)
  local nexty = CC.MainSubMenuY + CC.SingleLineHeight
  local r = SelectTeamMenu(CC.MainSubMenuX, nexty, id) --武骧金星：不适用的人物不显示
  local pp1, pp2 = 0, 0
  if r > 0 then
    local personid = JY.Base["队伍" .. r]
    if CanUseThing(id, personid) or T2SQ(personid) then
		if JY.Thing[id]["装备类型"] == 0 then
			if JY.Thing[id]["使用人"] >= 0 then
				if doubleweapon(JY.Thing[id]["使用人"]) then
					JY.Thing[id]["加攻击力"] = JY.Thing[id]["加攻击力"] / 2
					JY.Thing[id]["加防御力"] = JY.Thing[id]["加防御力"] / 2
					JY.Thing[id]["加轻功"] = JY.Thing[id]["加轻功"] / 2
				end
				JY.Person[JY.Thing[id]["使用人"]]["武器"] = -1
			end
			if JY.Person[personid]["武器"] >= 0 then
				if doubleweapon(personid) then
					JY.Thing[JY.Person[personid]["武器"]]["加攻击力"] = JY.Thing[JY.Person[personid]["武器"]]["加攻击力"] / 2
					JY.Thing[JY.Person[personid]["武器"]]["加防御力"] = JY.Thing[JY.Person[personid]["武器"]]["加防御力"] / 2
					JY.Thing[JY.Person[personid]["武器"]]["加轻功"] = JY.Thing[JY.Person[personid]["武器"]]["加轻功"] / 2
				end
				JY.Thing[JY.Person[personid]["武器"]]["使用人"] = -1
			end
			JY.Person[personid]["武器"] = id
			if doubleweapon(personid) then
				JY.Thing[id]["加攻击力"] = JY.Thing[id]["加攻击力"] * 2
				JY.Thing[id]["加防御力"] = JY.Thing[id]["加防御力"] * 2
				JY.Thing[id]["加轻功"] = JY.Thing[id]["加轻功"] * 2
			end
		elseif JY.Thing[id]["装备类型"] == 1 then
			if JY.Thing[id]["使用人"] >= 0 then
				if doublearmor(JY.Thing[id]["使用人"]) then
					JY.Thing[id]["加攻击力"] = JY.Thing[id]["加攻击力"] / 2
					JY.Thing[id]["加防御力"] = JY.Thing[id]["加防御力"] / 2
					JY.Thing[id]["加轻功"] = JY.Thing[id]["加轻功"] / 2
				end
				JY.Person[JY.Thing[id]["使用人"]]["防具"] = -1
			  end
			  if JY.Person[personid]["防具"] >= 0 then
					if doublearmor(personid) then
					  JY.Thing[JY.Person[personid]["防具"]]["加攻击力"] = JY.Thing[JY.Person[personid]["防具"]]["加攻击力"] / 2
					  JY.Thing[JY.Person[personid]["防具"]]["加防御力"] = JY.Thing[JY.Person[personid]["防具"]]["加防御力"] / 2
					  JY.Thing[JY.Person[personid]["防具"]]["加轻功"] = JY.Thing[JY.Person[personid]["防具"]]["加轻功"] / 2
					end
				JY.Thing[JY.Person[personid]["防具"]]["使用人"] = -1
			  end
			JY.Person[personid]["防具"] = id
			if doublearmor(personid) then
				JY.Thing[id]["加攻击力"] = JY.Thing[id]["加攻击力"] * 2
				JY.Thing[id]["加防御力"] = JY.Thing[id]["加防御力"] * 2
				JY.Thing[id]["加轻功"] = JY.Thing[id]["加轻功"] * 2
			end
		elseif JY.Thing[id]["装备类型"] == 2 then
			if JY.Thing[id]["使用人"] >= 0 then
				JY.Person[JY.Thing[id]["使用人"]]["无用15"] = -1
			end
			if JY.Person[personid]["无用15"] >= 0 then
				JY.Thing[JY.Person[personid]["无用15"]]["使用人"] = -1
			end
			JY.Person[personid]["无用15"] = id
		end
		JY.Thing[id]["使用人"] = personid
    else
    	DrawStrBoxWaitKey("此人不适合配备此物品", C_WHITE, CC.DefaultFont)
    	return 0
    end
  end
  return 1
end
--ivansz:遗忘技能
function DIY_yiwang(pid,wg)
	local kfmenu={}
	for i=1,HHH_GAME_SETTING["WG_COUNT_MAX"] do
		if JY.Person[pid]["武功"..i]~=0 then
			kfmenu[i]={JY.Wugong[JY.Person[pid]["武功"..i]]["名称"],nil,1}
		end
	end
	Cls()
	local r=ShowMenu(kfmenu,#kfmenu,0,10,10,0,0,1,1,CC.DefaultFont,C_ORANGE,C_WHITE)
	if r==0 then return false end
	local kfid=JY.Person[pid]["武功"..r]
	if kfid>108 and 113>kfid or kfid == 91 then
		QZXS(JY.Wugong[JY.Person[pid]["武功"..r]]["名称"].."不能被替换！")
		return DIY_yiwang(pid,wg)
	end
	if DrawStrBoxYesNo(-1,-1,"确定要替换"..JY.Wugong[JY.Person[pid]["武功"..r]]["名称"].."吗？",C_WHITE,CC.DefaultFont)==false then
		DIY_yiwang(pid,wg)
	else
		if GetS(4, 8, r, 5) == 0 then
			SetS(4, 8, r, 5, kfid)
		end
		JY.Person[pid]["武功"..r] = wg
		QZXS(JY.Wugong[kfid]["名称"].."已经换成"..JY.Wugong[wg]["名称"])
	end
	return true
end
--秘籍物品使用
function UseThing_Type2(id)
  if JY.Thing[id]["使用人"] >= 0 and DrawStrBoxYesNo(-1, -1, CC.EVB140, C_WHITE, CC.DefaultFont) == false then
    Cls(CC.MainSubMenuX, CC.MainSubMenuY, CC.ScreenW, CC.ScreenH)
    ShowScreen()
    return 0
  end
  Cls()
  DrawStrBox(CC.MainSubMenuX, CC.MainSubMenuY, string.format(CC.EVB141, JY.Thing[id]["名称"]), C_WHITE, CC.DefaultFont)
  local nexty = CC.MainSubMenuY + CC.SingleLineHeight
  local r = SelectTeamMenu(CC.MainSubMenuX, nexty, id) --武骧金星：不适用的人物不显示
  if r > 0 then
    local personid = JY.Base["队伍" .. r]
    local yes, full = nil, nil
    if JY.Thing[id]["练出武功"] >= 0 then
      yes = 0
      full = 1
      for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
        if JY.Person[personid]["武功" .. i] == JY.Thing[id]["练出武功"] then
          yes = 1
        else
          if JY.Person[personid]["武功" .. i] == 0 then
            full = 0
          end
        end
      end
    end	
	
    --葵花宝典
    if CC.Shemale[id] == 1 then
      if T1LEQ(personid) or T2SQ(personid) or T3XYK(personid) then --特殊人物不用切
        say(CC.EVB143)
        say(CC.EVB144)
        say(CC.EVB145)
        say(CC.EVB146)
        yes = 2; 
	elseif (putong() == 2 or T8LXY(0)) and personid == 0 and JY.Person[personid]["性别"] == 0 and id == 78 then
		Talk("我看这剑法的精妙之处并不在于是否自宫。看我如何以剑入道克服这个问题！", 0);
		yes = 2;
	elseif putong() == 2 and personid == 0 and JY.Person[personid]["性别"] == 0 and id == 93 and PersonKF(0, 48) then
		Talk("这葵花神功与辟邪剑法实在有很多相似之处。既然我已经克服了后者，修炼葵花神功应该会事半功倍吧。", 0);
		yes = 2;
	elseif putong() == 2 and personid == 0 and JY.Person[personid]["性别"] == 0 and id == 357 and PersonKF(0, 48) then
		Talk("暗香疏影与辟邪剑法本为同源。既然我已经克服了后者，修炼暗香疏影应该是手到擒来。", 0);
		yes = 2;		
	elseif (teshu() == 15 or NF(0)) and personid == 0 and JY.Person[personid]["性别"] == 0 and (id == 78 or id == 93 or id == 337 or id == 357) then
		Talk("我聂家冰心诀正能克制这葵花缺陷！", 0);
		yes = 2;	
	elseif putong() == 13 and personid == 0 and JY.Person[personid]["性别"] == 0 and id == 337 then
		Talk("人说暗器练至极境飞花摘叶俱可伤人，这绣花针虽小，却隐藏了深奥的武学呢。", 0);
		yes = 2;
	elseif putong() == 13 and personid == 0 and JY.Person[personid]["性别"] == 0 and id == 93 and PersonKF(0, 177) then
		Talk("这葵花神功与葵花神针一脉相连。既然我已经克服了后者，修炼葵花神功应该会事半功倍吧。", 0);
		yes = 2;
	elseif putong() == 13 and personid == 0 and JY.Person[personid]["性别"] == 0 and id == 357 and PersonKF(0, 177) then
		Talk("这暗香疏影与葵花神针本为同源。既然我已经克服了后者，修炼暗香疏影应该是手到擒来。", 0);
		yes = 2;	
	elseif GetS(111, 0, 0, 0) == 105  and personid == 0 and (id == 78 or id == 93 or id == 337 or id ==357) then 	
		Talk("我有葵花真解，无需自宫，而且精妙之处不在于自宫，而在于速度。", 0);
		yes = 2;
	elseif personid == 0 and cxzj() == 27 and (id == 78 or id == 93 or id == 337 or id == 357) then 	
		Talk("我有葵花真解，无需自宫，而且精妙之处不在于自宫，而在于速度。", 0);
		yes = 2;	
	elseif GetS(113, 0, 0, 0) == 177 and personid == 0 and (id == 337) then
	    Talk("葵花神针不在于自宫，而是速度", 0)	
	elseif T4WXS(personid) or T5BCF(personid) or T6XQS(personid) then
        Talk("这种武功不练也罢！", 0);
      	return 0
	elseif T8LXY(personid) then
		Talk("我才不要做太监！", 0);
		return 0
	elseif T11CJR(personid) then
		Talk("战神的尊严不容践踏！", 0);
		return 0	
    elseif personid == 29 and GetS(86,10,12,5) == 1 then			--田伯光，不被阉割之后，不可修炼葵花宝典
      	Talk(JY.Thing[id]["名称"] .. "这玩意不适合我", 29);
      	return 0
    elseif JY.Person[personid]["性别"] == 0 and CanUseThing(id, personid) then
        Cls(CC.MainSubMenuX, CC.MainSubMenuY, CC.ScreenW, CC.ScreenH)
        if DrawStrBoxYesNo(-1, -1, CC.EVB147, C_WHITE, CC.DefaultFont) == false then
          return 0
        else
	        lib.FillColor(0, 0, CC.ScreenW, CC.ScreenH, C_RED, 128)
	        ShowScreen()
	        lib.Delay(80)
	        lib.ShowSlow(15, 1)
	        Cls()
	        lib.ShowSlow(100, 0)
	        JY.Person[personid]["性别"] = 2
	        local add, str = AddPersonAttrib(personid, "攻击力", -30)
	        DrawStrBoxWaitKey(JY.Person[personid]["姓名"] .. str, C_ORANGE, CC.DefaultFont)
	        add, str = AddPersonAttrib(personid, "防御力", -50)
	        DrawStrBoxWaitKey(JY.Person[personid]["姓名"] .. str, C_ORANGE, CC.DefaultFont)
	      end
    elseif JY.Person[personid]["性别"] == 1 then
        DrawStrBoxWaitKey(CC.EVB148, C_WHITE, CC.DefaultFont)
        return 0
      end
    end
    
    if yes == 1 or CanUseThing(id, personid) or yes == 2 then
		if yes == 0 and full == 1 then
			DrawStrBoxWaitKey(CC.EVB142, C_WHITE, CC.DefaultFont)
			Cls();
			return 0
		end
	  
	  if JY.Thing[id]["使用人"] == personid then
        return 0
      end
      if JY.Person[personid]["修炼物品"] >= 0 then
        JY.Thing[JY.Person[personid]["修炼物品"]]["使用人"] = -1
      end
      if JY.Thing[id]["使用人"] >= 0 then
        JY.Person[JY.Thing[id]["使用人"]]["修炼物品"] = -1
        JY.Person[JY.Thing[id]["使用人"]]["物品修炼点数"] = 0
      end
      JY.Thing[id]["使用人"] = personid
      JY.Person[personid]["修炼物品"] = id
      JY.Person[personid]["物品修炼点数"] = 0
    else
    	DrawStrBoxWaitKey("此人不适合修炼此物品", C_WHITE, CC.DefaultFont)
    	return 0
    end
  end
  return 1
end--药品物品
function UseThing_Type3(id)
  local usepersonid = -1
  if JY.Status == GAME_MMAP or JY.Status == GAME_SMAP then
    Cls(CC.MainSubMenuX, CC.MainSubMenuY, CC.ScreenW, CC.ScreenH)
    DrawStrBox(CC.MainSubMenuX, CC.MainSubMenuY, string.format("谁要使用%s?", JY.Thing[id]["名称"]), C_WHITE, CC.DefaultFont)
    local nexty = CC.MainSubMenuY + CC.SingleLineHeight
    local r = SelectTeamMenu(CC.MainSubMenuX, nexty)
    if r > 0 then
      usepersonid = JY.Base["队伍" .. r]
    end
  elseif JY.Status == GAME_WMAP then
    if WAR.Person[WAR.CurID]["人物编号"] == 16 then
      War_CalMoveStep(WAR.CurID, 8, 1)
      local x, y = War_SelectMove()
      if x ~= nil then
        local emeny = GetWarMap(x, y, 2)
        if emeny >= 0 and WAR.Person[WAR.CurID]["我方"] == WAR.Person[emeny]["我方"] then
        	usepersonid = WAR.Person[emeny]["人物编号"]
      	end
      end
    else
    	usepersonid = WAR.Person[WAR.CurID]["人物编号"]
    end
  end
  if usepersonid >= 0 then
	local dj = 1
	if id >= 14 and id <= 25 then
		local drupsNum = 0
		for i = 1, CC.MyThingNum do
			if JY.Base["物品" .. i] == id then
				drupsNum = JY.Base["物品数量" .. i];
				break;
			end
		end	
		DrawStrBoxWaitKey("请输入使用数量", C_WHITE, CC.DefaultFont, 1)
		local T = {}
		for a = 1, 1000 do
			local b = "" .. a
			T[b] = a
		end
		dj = -1
		while dj == -1 do
			local r = GetPinyin1(32, CC.ScreenH - CC.Fontbig * 6)
			if T[r] ~= nil and T[r] >= 1 and T[r] <= drupsNum then
			dj = T[r]
			else
				DrawStrBoxWaitKey("输入错误", C_WHITE, 30)
			end
		end	
	end
	for i = 1, dj do
		if UseThingEffect(id, usepersonid) == 1 then
			instruct_32(id, -1)
			if dj == 1 then WaitKey() end
		end
	end
  else
    return 0
  end
  return 1
end--暗器物品
function UseThing_Type4(id)
  if JY.Status == GAME_WMAP then
    return War_UseAnqi(id)
  end
  return 0
end--等待键盘输入
function WaitKey(flag)
  local keyPress=-1;
    while true do
		keyPress=lib.GetKey();
		if keyPress ~=-1 then
			if flag or keyPress<1000000 or keyPress>1999999 then
				break;
			end
	  end
    lib.Delay(20);
	end
	return keyPress;
end--主角走路
function walkto(xx,yy,x,y,flag)
	local x,y
	AutoMoveTab={[0]=0}
	if JY.Status==GAME_SMAP  then
		x=x or JY.Base['人X1']
		y=y or JY.Base['人Y1']
	elseif JY.Status==GAME_MMAP then
		x=x or JY.Base['人X']
		y=y or JY.Base['人Y']
	end
	xx,yy=xx+x,yy+y
	if JY.Status==GAME_SMAP and SceneCanPass(xx,yy)==false then
		return
	end
	if JY.Status==GAME_MMAP and ((lib.GetMMap(xx,yy,3)==0 and lib.GetMMap(xx,yy,4)==0) or CanEnterScene(xx,yy)~=-1)==false then
		return
	end
	local steparray={};
	local stepmax;
	local xy={}
	if JY.Status==GAME_SMAP then
		for i=0,63 do
			xy[i]={}
		end
	elseif JY.Status==GAME_MMAP then
		for i=0,479 do
			xy[i]={}
		end
	end
	if flag~=nil then
		stepmax=640
	else
		stepmax=240
	end
	for i=0,stepmax do
	    steparray[i]={};
        steparray[i].x={};
        steparray[i].y={};
	end
	local function canpass(nx,ny)
		if JY.Status==GAME_SMAP and (nx>63 or ny>63 or nx<1 or ny<1) then 
			return false 
		end
		if JY.Status==GAME_MMAP and (nx>479 or ny>479 or nx<1 or ny<1) then 
			return false 
		end
		if xy[nx][ny]==nil then
			if JY.Status==GAME_SMAP then
				if  SceneCanPass(nx,ny) then
					return true
				end
			elseif JY.Status==GAME_MMAP then
				if (lib.GetMMap(nx,ny,3)==0 and lib.GetMMap(nx,ny,4)==0) or CanEnterScene(nx,ny)~=-1 then
					return true
				end
			end
		end
		return false
	end
	
	local function FindNextStep(step)
		if step==stepmax then
			return
		end
		local step1=step+1
		local num=0
		for i=1,steparray[step].num do
			
			if steparray[step].x[i]==xx and steparray[step].y[i]==yy then
				return
			end
			
			if canpass(steparray[step].x[i]+1,steparray[step].y[i]) then
				num=num+1
				steparray[step1].x[num]=steparray[step].x[i]+1
				steparray[step1].y[num]=steparray[step].y[i]
				xy[steparray[step1].x[num]][steparray[step1].y[num]]=step1
			end
			if canpass(steparray[step].x[i]-1,steparray[step].y[i]) then
				num=num+1
				steparray[step1].x[num]=steparray[step].x[i]-1
				steparray[step1].y[num]=steparray[step].y[i]
				xy[steparray[step1].x[num]][steparray[step1].y[num]]=step1
			end
			if canpass(steparray[step].x[i],steparray[step].y[i]+1) then
				num=num+1
				steparray[step1].x[num]=steparray[step].x[i]
				steparray[step1].y[num]=steparray[step].y[i]+1
				xy[steparray[step1].x[num]][steparray[step1].y[num]]=step1
			end
			if canpass(steparray[step].x[i],steparray[step].y[i]-1) then
				num=num+1
				steparray[step1].x[num]=steparray[step].x[i]
				steparray[step1].y[num]=steparray[step].y[i]-1
				xy[steparray[step1].x[num]][steparray[step1].y[num]]=step1
			end
		end
		if num>0 then
			steparray[step1].num=num
			FindNextStep(step1)
		end
	end
	
    steparray[0].num=1;
	steparray[0].x[1]=x;
	steparray[0].y[1]=y;
	xy[x][y]=0
	FindNextStep(0);
	
	
    local movenum=xy[xx][yy];
	
	if movenum==nil then
		return
	end
	AutoMoveTab[0]=movenum
	for i=movenum,1,-1 do
        if xy[xx-1][yy]==i-1 then
            xx=xx-1;
            AutoMoveTab[1+movenum-i]=1;
        elseif xy[xx+1][yy]==i-1 then
            xx=xx+1;
            AutoMoveTab[1+movenum-i]=2;
        elseif xy[xx][yy-1]==i-1 then
            yy=yy-1;
            AutoMoveTab[1+movenum-i]=3;
        elseif xy[xx][yy+1]==i-1 then
            yy=yy+1;
            AutoMoveTab[1+movenum-i]=0;
        end
	end
end--计算暗器伤害
function War_AnqiHurt(pid, emenyid, thingid)
	local warid = -1
	for i = 0, WAR.PersonNum - 1 do		
		if WAR.Person[i]["人物编号"] == emenyid then
			warid = i
			break
		end	
	end	
  local num = nil
  local tmpanqi = JY.Person[pid]["暗器技巧"] + MPAttrib(pid, 7)
  local aaa = math.abs(JY.Thing[thingid]["加生命"]) / 2
  if JY.Person[emenyid]["受伤程度"] == 0 then
    num = JY.Thing[thingid]["加生命"] / 4 - Rnd(aaa)
  elseif JY.Person[emenyid]["受伤程度"] <= 33 then
      num = JY.Thing[thingid]["加生命"] / 3 - Rnd(aaa)
  elseif JY.Person[emenyid]["受伤程度"] <= 66 then
      num = JY.Thing[thingid]["加生命"] / 2 - Rnd(aaa)
  else
    num = JY.Thing[thingid]["加生命"] / 2 - Rnd(aaa + 10)
  end
  
  num = math.modf((num * 2 - tmpanqi * 2) / 3)
  num = -100 --暂时的
  
  if WAR.FGYJ[pid]~=nil then----
  num=-200
  end

  if WAR.BHFJ[pid]~=nil then----
  num=-200+limitX(math.modf(JY.Person[pid]["内力"] - JY.Person[emenyid]["内力"])*0.1 , 200 , 1000) * (-1)
  end
 
  if WAR.XYFJ[pid]~=nil then----
  num=-200-math.modf(JY.Person[pid]["耍刀技巧"]*2)
  end

  if WAR.WQYJ[pid]~=nil then----
  num=-200-math.modf(JY.Person[pid]["拳掌功夫"]*2)
  end

  if WAR.SLFJ[pid]~=nil then----
  num=-200-math.modf(JY.Person[pid]["拳掌功夫"]+JY.Person[pid]["御剑能力"]+JY.Person[pid]["耍刀技巧"]+JY.Person[pid]["特殊兵器"]+JY.Person[pid]["暗器技巧"])	
  end

  if WAR.DGFJ[pid]~=nil then----
  num=-200-math.modf(JY.Person[pid]["御剑能力"]*1.5)
  end	

  if WAR.YFZ[pid]~=nil then----
  num=-200-math.modf(JY.Person[pid]["暗器技巧"]*0.5)
  end

  if WAR.KHFJ[pid]~=nil then----
  num=-200
  end

  if WAR.LMC>0 then
  local tmpanqi = JY.Person[pid]["暗器技巧"]
     if DT(pid, 601) then
  		WAR.ICEXS[emenyid] = 1
		WAR.ICE[emenyid] = limitX((WAR.ICE[emenyid] or 0) + math.random(15), 0, 50)
		WAR.QFY1[pid] = WAR.QFY1[pid] or 0 +math.modf(tmpanqi/10)
		num=-200-math.modf(JY.Person[pid]["暗器技巧"]*0.5)
     end
     if DT(pid, 106) then
	    AddPersonAttrib(emenyid,"中毒程度",math.modf(tmpanqi/10))
  		WAR.ICEXS[emenyid] = 1
		WAR.ICE[emenyid] = limitX((WAR.ICE[emenyid] or 0) + math.random(15), 0, 50)
		WAR.QFY1[pid] = WAR.QFY1[pid] or 0 +math.modf(tmpanqi/10)
		num=-200-math.modf(JY.Person[pid]["暗器技巧"]*0.5)
     end
     if DT(pid, 153) and JX(pid) then
	    if WAR.LMC==3 then
	    AddPersonAttrib(emenyid,"中毒程度",math.modf(tmpanqi/10))
		WAR.POISON[emenyid] = limitX((WAR.POISON[emenyid] or 0) + math.random(15), 0, 50)
		addeffect(WAR.QSLZ, emenyid, 1)
		WAR.QFY1[pid] = WAR.QFY1[pid] or 0 +math.modf(tmpanqi/10)
		num=-200-math.modf(JY.Person[pid]["暗器技巧"]*0.5)
		elseif WAR.LMC==1 then
		WAR.OYFSD[emenyid]=WAR.OYFSD[pid] or 0 +math.modf(tmpanqi/10)
		num=-200-math.modf(JY.Person[pid]["暗器技巧"]*0.5)
		elseif WAR.LMC==2 then
		num=-200-math.modf(JY.Person[pid]["暗器技巧"]*0.5)
		end
     end
  end
 
  --飞影彩蛋：真龙心法【真龙・逆鳞】反击伤害计算
	if thingid == 32 and JY.ZLXF == 1 then
		num = limitX(math.modf(JY.Person[pid]["内力"] - JY.Person[emenyid]["内力"])*0.1 , 200 , 1000) * (-1)
	end
  
  WAR.Person[warid]["内伤点数"] = (WAR.Person[warid]["内伤点数"] or 0) + AddPersonAttrib(emenyid, "受伤程度", math.modf(-num / 20))
  local r = AddPersonAttrib(emenyid, "生命", math.modf(num / 2))
  
  if (emenyid == 129 or emenyid == 65) and JY.Person[emenyid]["生命"] <= 0 then
    JY.Person[emenyid]["生命"] = 1
  end
  
  if emenyid == 553 and JY.Person[emenyid]["生命"] <= 0 then
    WAR.YZB = 1
  end
  --[[if JY.Thing[thingid]["加中毒解毒"] > 0 then
    num = math.modf((JY.Thing[thingid]["加中毒解毒"] + tmpanqi) / 10)
    num = num - JY.Person[emenyid]["抗毒能力"]
    num = limitX(num, 0, CC.PersonAttribMax["用毒能力"])
	WAR.Person[warid]["中毒点数"] = (WAR.Person[warid]["中毒点数"] or 0) + AddPersonAttrib(emenyid, "中毒程度", num)
  end]]
  if MPPD(pid) == 9 then --唐门暗器异常状态
	local jilv = 0
	jilv = jilv + math.modf(JY.Person[pid]["实战"] / 25)
	if JLSD(10, 25 + jilv, pid) then 
		WAR.FXXS[emenyid] = 1
		WAR.FXDS[emenyid] = limitX((WAR.FXDS[emenyid] or 0) + math.random(10), 0, 50)
	end
	if JLSD(10, 35 + jilv, pid) then
		WAR.LXXS[emenyid] = 1
		WAR.LXZT[emenyid] = limitX((WAR.LXZT[emenyid] or 0) + math.random(20), 0, 100)
	end
	if JLSD(10, 30 + jilv, pid) then
		WAR.CHXS[emenyid] = 1
		WAR.CHZ[emenyid] = limitX((WAR.CHZ[emenyid] or 0) + math.random(10), 0, 50)
	end
	if JLSD(10, 35 + jilv, pid) then
		WAR.ICEXS[emenyid] = 1
		WAR.ICE[emenyid] = limitX((WAR.ICE[emenyid] or 0) + math.random(15), 0, 50)
	end
	if JLSD(10, 35 + jilv, pid) then
		WAR.HOTXS[emenyid] = 1
		WAR.HOT[emenyid] = limitX((WAR.HOT[emenyid] or 0) + math.random(15), 0, 50)
	end	
  end
  if JY.Person[emenyid]["生命"] <= 0 then
    WAR.Person[WAR.CurID]["经验"] = WAR.Person[WAR.CurID]["经验"] + JY.Person[emenyid]["等级"] * 5
	if WAR.ZDDH ~= 226 then --2261 武骧金星：这里估计是笔误
		if MPPD(pid) == 9 then
			AddPersonAttrib(pid, "实战", 5)
			--AddPersonAttrib(pid, "暗器技巧", 3) 武骧金星：取消暗器技巧提升
			local tmpcount = 0
			for i = 0, WAR.PersonNum - 1 do
				if WAR.Person[i]["死亡"] == false and WAR.Person[i]["我方"] == false then
					tmpcount = tmpcount + 1
				end
			end
			if tmpcount > 1 and JY.Person[pid]["体力"] >= 50 then 
				WAR.Person[warid]["我方"] = WAR.Person[WAR.CurID]["我方"] 
				WAR.NPC[emenyid] = 50 + math.modf(JY.Person[pid]["实战"] / 5)
				WAR.ZOMBIE[emenyid] = 1
				WAR.Person[warid][CC.TXWZ3] = "千魂弄巧"
				JY.Person[emenyid]["生命"] = 200 + math.modf(JY.Person[pid]["实战"] / 2)
				AddPersonAttrib(pid, "体力", -5)
			end	
		else
			AddPersonAttrib(pid, "实战", 1)
		end
	end			
  end  
  
  return r
end--计算从(x,y)开始攻击最多能够击中几个敌人

function War_AutoCalMaxEnemy(x, y, wugongid, level)
  local wugongtype = JY.Wugong[wugongid]["攻击范围"]
  local movescope = JY.Wugong[wugongid]["移动范围" .. level]
  local fightscope = JY.Wugong[wugongid]["杀伤范围" .. level]
  local maxnum = 0
  local xmax, ymax = nil, nil
  if wugongtype == 0 or wugongtype == 3 then
    local movestep = War_CalMoveStep(WAR.CurID, movescope, 1)	--计算武功移动步数
    for i = 1, movescope do
      local step_num = movestep[i].num
      if step_num == 0 then
        break;
      end
      for j = 1, step_num do
        local xx = movestep[i].x[j]
        local yy = movestep[i].y[j]
        local enemynum = 0
        for n = 0, WAR.PersonNum - 1 do
          if n ~= WAR.CurID and WAR.Person[n]["死亡"] == false and WAR.Person[n]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
            local x = math.abs(WAR.Person[n]["坐标X"] - xx)
            local y = math.abs(WAR.Person[n]["坐标Y"] - yy)
          end
          if x <= fightscope and y <= fightscope then
            enemynum = enemynum + 1
          end
        end
        if maxnum < enemynum then
          maxnum = enemynum
          xmax = xx
          ymax = yy
        end
      end
    end
  elseif wugongtype == 1 then
    for direct = 0, 3 do
      local enemynum = 0
      for i = 1, movescope do
        local xnew = x + CC.DirectX[direct + 1] * i
        local ynew = y + CC.DirectY[direct + 1] * i
        if xnew >= 0 and xnew < CC.WarWidth and ynew >= 0 and ynew < CC.WarHeight then
          local id = GetWarMap(xnew, ynew, 2)
        end
        if id >= 0 and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[id]["我方"] then
          enemynum = enemynum + 1
        end
      end
      if maxnum < enemynum then
        maxnum = enemynum
        xmax = x + CC.DirectX[direct + 1]
        ymax = y + CC.DirectY[direct + 1]
      end
    end
  elseif wugongtype == 2 then
    local enemynum = 0
    for direct = 0, 3 do
      for i = 1, movescope do
        local xnew = x + CC.DirectX[direct + 1] * i
        local ynew = y + CC.DirectY[direct + 1] * i
        if xnew >= 0 and xnew < CC.WarWidth and ynew >= 0 and ynew < CC.WarHeight then
          local id = GetWarMap(xnew, ynew, 2)
        end
        if id >= 0 and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[id]["我方"] then
          enemynum = enemynum + 1
        end
      end
    end
  end
  if enemynum > 0 then
    maxnum = enemynum
    xmax = x
    ymax = y
  end
  return maxnum, xmax, ymax
end--得到可以走到攻击到敌人的最近位置。
--scope可以攻击的范围
--返回 x,y。如果无法走到攻击位置，返回空
function War_AutoCalMaxEnemyMap(wugongid, level)
  local wugongtype = JY.Wugong[wugongid]["攻击范围"]
  local movescope = JY.Wugong[wugongid]["移动范围" .. level]
  local fightscope = JY.Wugong[wugongid]["杀伤范围" .. level]
  local x0 = WAR.Person[WAR.CurID]["坐标X"]
  local y0 = WAR.Person[WAR.CurID]["坐标Y"]
  CleanWarMap(4, 0)
  if wugongtype == 0 or wugongtype == 3 then
    for n = 0, WAR.PersonNum - 1 do
      if n ~= WAR.CurID and WAR.Person[n]["死亡"] == false and WAR.Person[n]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
        local xx = WAR.Person[n]["坐标X"]
        local yy = WAR.Person[n]["坐标Y"]
        local movestep = War_CalMoveStep(n, movescope, 1)
        for i = 1, movescope do
          local step_num = movestep[i].num
	        if step_num == 0 then
	          
	        else
	          for j = 1, step_num do
	            SetWarMap(movestep[i].x[j], movestep[i].y[j], 4, 1)
	          end
	        end
	      end
      end
    end
  elseif wugongtype == 1 or wugongtype == 2 then
    for n = 0, WAR.PersonNum - 1 do
      if n ~= WAR.CurID and WAR.Person[n]["死亡"] == false and WAR.Person[n]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
        local xx = WAR.Person[n]["坐标X"]
        local yy = WAR.Person[n]["坐标Y"]
        for direct = 0, 3 do
          for i = 1, movescope do
            local xnew = xx + CC.DirectX[direct + 1] * i
            local ynew = yy + CC.DirectY[direct + 1] * i
            if xnew >= 0 and xnew < CC.WarWidth and ynew >= 0 and ynew < CC.WarHeight then
              local v = GetWarMap(xnew, ynew, 4)
              SetWarMap(xnew, ynew, 4, v + 1)
            end
          end
        end
      end
    end
  end
end--自动医疗
function War_AutoDoctor()
  local x1 = WAR.Person[WAR.CurID]["坐标X"]
  local y1 = WAR.Person[WAR.CurID]["坐标Y"]
  War_ExecuteMenu_Sub(x1, y1, 3, -1)
end--自动吃药
--flag=2 生命，3内力；4体力  6 解毒
function War_AutoEatDrug(flag)
  local pid = WAR.Person[WAR.CurID]["人物编号"]
  local life = JY.Person[pid]["生命"]
  local maxlife = JY.Person[pid]["生命最大值"]
  local selectid = nil
  local minvalue = math.huge
  local shouldadd, maxattrib, str = nil, nil, nil
  if flag == 2 then
    maxattrib = JY.Person[pid]["生命最大值"]
    shouldadd = maxattrib - JY.Person[pid]["生命"]
    str = "加生命"
  elseif flag == 3 then
    maxattrib = JY.Person[pid]["内力最大值"]
    shouldadd = maxattrib - JY.Person[pid]["内力"]
    str = "加内力"
  elseif flag == 4 then
    maxattrib = CC.PersonAttribMax["体力"]
    shouldadd = maxattrib - JY.Person[pid]["体力"]
    str = "加体力"
  elseif flag == 6 then
    maxattrib = CC.PersonAttribMax["中毒程度"]
    shouldadd = JY.Person[pid]["中毒程度"]
    str = "加中毒解毒"
  else
    return 
  end
  local function Get_Add(thingid)
    if flag == 6 then
      return -JY.Thing[thingid][str] / 2
    else
      return JY.Thing[thingid][str]
    end
  end
  
  if inteam(pid) and WAR.Person[WAR.CurID]["我方"] == true then
    local extra = 0
    for i = 1, CC.MyThingNum do
      local thingid = JY.Base["物品" .. i]
      if thingid >= 0 then
        local add = Get_Add(thingid)
        if JY.Thing[thingid]["类型"] == 3 and add > 0 then
	        local v = shouldadd - add
	        if v < 0 then
	          extra = 1
		      elseif v < minvalue then
		        minvalue = v
		        selectid = thingid
		      end
		    end
      end
    end
    if extra == 1 then
      minvalue = math.huge
      for i = 1, CC.MyThingNum do
        local thingid = JY.Base["物品" .. i]
        if thingid >= 0 then
          local add = Get_Add(thingid)
          if JY.Thing[thingid]["类型"] == 3 and add > 0 then
	          local v = add - shouldadd
	          if v >= 0 and v < minvalue then
		          minvalue = v
		          selectid = thingid
		        end
	        end
        end
      end
    end
    if UseThingEffect(selectid, pid) == 1 then
      instruct_32(selectid, -1)
    end
  else
    local extra = 0
    for i = 1, 4 do
      local thingid = JY.Person[pid]["携带物品" .. i]
      local tids = JY.Person[pid]["携带物品数量" .. i]
      if thingid >= 0 and tids > 0 then
        local add = Get_Add(thingid)
        if JY.Thing[thingid]["类型"] == 3 and add > 0 then
	        local v = shouldadd - add
	        if v < 0 then		--可以加满生命, 用其他方法找合适药品
	          extra = 1
		      elseif v < minvalue then
		        minvalue = v
		        selectid = thingid
		      end
		    end
      end
    end
    if extra == 1 then
      minvalue = math.huge
      for i = 1, 4 do
        local thingid = JY.Person[pid]["携带物品" .. i]
        local tids = JY.Person[pid]["携带物品数量" .. i]
        if thingid >= 0 and tids > 0 then
          local add = Get_Add(thingid)
          if JY.Thing[thingid]["类型"] == 3 and add > 0 then
	          local v = add - shouldadd
	          if v >= 0 and v < minvalue then
		          minvalue = v
		          selectid = thingid
		        end
	        end
        end 
      end
    end
  end
  if UseThingEffect(selectid, pid) == 1 then
    instruct_41(pid, selectid, -1)
  end
  lib.Delay(500)
end

function War_AutoKHYX()
 local nx, ny = nil, nil
  War_CalMoveStep(WAR.CurID,12, 1)
  WarDrawMap(1)
  ShowScreen()
  local starttime = lib.GetTime()
  local array = {}
  local num = 0
  
  for i = 0, CC.WarWidth - 1 do
    for j = 0, CC.WarHeight - 1 do		
		if GetWarMap(i, j, 2) > 0 and GetWarMap(i, j, 2) ~= WAR.CurID then		
		elseif GetWarMap(i, j, 5) > 0 and GetWarMap(i, j, 5) ~= WAR.Person[WAR.CurID]["贴图"] then		
		elseif GetWarMap(i, j, 3) < 128 then
			local minDest = math.huge
			for k = 0, WAR.PersonNum - 1 do
			  if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[k]["我方"] and WAR.Person[k]["死亡"] == false then
				local dx = math.abs(i - WAR.Person[k]["坐标X"])
				local dy = math.abs(j - WAR.Person[k]["坐标Y"])
				  if dx + dy < minDest then		--计算当前距离敌人最近的位置
					minDest = dx + dy
				  end
			  end
			end
			num = num + 1
			array[num] = {}
			array[num].x = i
			array[num].y = j
			array[num].p = minDest
		end
    end
  end
  
  for i = 1, num - 1 do
    for j = i, num do
      if array[i].p < array[j].p then
        array[i], array[j] = array[j], array[i]
      end
    end
  end
  for i = 2, num do
    if array[i].p < array[1].p / 2 then
      num = i - 1
    end
  end
  for i = 1, num do
    array[i].p = array[i].p * 5 + GetMovePoint(array[i].x, array[i].y, 1)
  end
  for i = 1, num - 1 do
    for j = i, num do
      if array[i].p < array[j].p then
        array[i], array[j] = array[j], array[i]
      end
    end
  end
  nx = array[1].x
  ny = array[1].y
  if nx == WAR.Person[WAR.CurID]["坐标X"] and ny == WAR.Person[WAR.CurID]["坐标Y"] then 
     nx = WAR.KHYX[WAR.Person[WAR.CurID]["人物编号"]][1]
	 ny = WAR.KHYX[WAR.Person[WAR.CurID]["人物编号"]][2] 
  end
  local endtime = starttime + 200 - lib.GetTime()
  if endtime > 0 then
    lib.Delay(endtime)
  end
	War_CalMoveStep(WAR.CurID,12, 1)	
                          --   local nx, ny = math.random(i-2,i+3), math.random(j-3,j+2)
                            -- if lib.GetWarMap(nx, ny, 2) < 0 and lib.GetWarMap(nx, ny, 5) < 0 and CC.SceneWater[lib.GetWarMap(nx, ny, 2)] == nil and CC.SceneWater[lib.GetWarMap(nx, ny, 5)] == nil then--GetWarMap(nx, ny, 1) > 0 do
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 1382, 1390)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 5, -1)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 2, -1)
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 1390, 1398)
	    WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] = nx, ny
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 1382, 1390)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 5, WAR.Person[WAR.CurID]["贴图"])
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 2, WAR.CurID)
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 1390, 1398)
end
--自动逃跑
function War_AutoEscape()
  local pid = WAR.Person[WAR.CurID]["人物编号"]
  if JY.Person[pid]["体力"] <= 5 then
    return 
  end
  local x, y = nil, nil
  if nozoc(WAR.Person[WAR.CurID]["人物编号"]) then
	WAR.QX = 1
	War_CalMoveStep(WAR.CurID, WAR.Person[WAR.CurID]["移动步数"], 1)
	WAR.QX = 0
  else
	War_CalMoveStep(WAR.CurID, WAR.Person[WAR.CurID]["移动步数"], 0)		
  end
  WarDrawMap(1)
  ShowScreen()
  local starttime = lib.GetTime()
  local array = {}
  local num = 0
  
  for i = 0, CC.WarWidth - 1 do
    for j = 0, CC.WarHeight - 1 do		
		if GetWarMap(i, j, 2) > 0 and GetWarMap(i, j, 2) ~= WAR.CurID then		
		elseif GetWarMap(i, j, 5) > 0 and GetWarMap(i, j, 5) ~= WAR.Person[WAR.CurID]["贴图"] then		
		elseif GetWarMap(i, j, 3) < 128 then
			local minDest = math.huge
			for k = 0, WAR.PersonNum - 1 do
			  if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[k]["我方"] and WAR.Person[k]["死亡"] == false then
				local dx = math.abs(i - WAR.Person[k]["坐标X"])
				local dy = math.abs(j - WAR.Person[k]["坐标Y"])
				  if dx + dy < minDest then		--计算当前距离敌人最近的位置
					minDest = dx + dy
				  end
			  end
			end
			num = num + 1
			array[num] = {}
			array[num].x = i
			array[num].y = j
			array[num].p = minDest
		end
    end
  end
  
  for i = 1, num - 1 do
    for j = i, num do
      if array[i].p < array[j].p then
        array[i], array[j] = array[j], array[i]
      end
    end
  end
  for i = 2, num do
    if array[i].p < array[1].p / 2 then
      num = i - 1
    end
  end
  for i = 1, num do
    array[i].p = array[i].p * 5 + GetMovePoint(array[i].x, array[i].y, 1)
  end
  for i = 1, num - 1 do
    for j = i, num do
      if array[i].p < array[j].p then
        array[i], array[j] = array[j], array[i]
      end
    end
  end
  x = array[1].x
  y = array[1].y
  
  local endtime = starttime + 200 - lib.GetTime()
  if endtime > 0 then
    lib.Delay(endtime)
  end
  if nozoc(WAR.Person[WAR.CurID]["人物编号"]) then
	WAR.QX = 1
	War_CalMoveStep(WAR.CurID, WAR.Person[WAR.CurID]["移动步数"], 1)
	WAR.QX = 0
  else
	War_CalMoveStep(WAR.CurID, WAR.Person[WAR.CurID]["移动步数"], 0)		
  end
  War_MovePerson(x, y)	--移动到相应的位置
end

function War_Retreat() --武骧金星：允许投降
	if DrawStrBoxYesNo(-1, -1, "真的要放弃战斗么？", C_WHITE, 30) == true then
		for i = 0, WAR.PersonNum - 1 do
			if WAR.Person[i]["我方"] then
				WAR.Person[i]["死亡"] = true
			end		
		end
		return 1
	end
end

function War_Wait() --武骧金星：允许待机
	WAR.Person[WAR.CurID].Time = WAR.Person[WAR.CurID].Time + 500
	Cls()
	CurIDTXDH(WAR.CurID, 1343, 1375, "待机而动");
	return 1
end

--自动执行战斗，此时的位置一定可以打到敌人
function War_AutoExecuteFight(wugongnum)
  local pid = WAR.Person[WAR.CurID]["人物编号"]
  local x0 = WAR.Person[WAR.CurID]["坐标X"]
  local y0 = WAR.Person[WAR.CurID]["坐标Y"]
  local wugongid = JY.Person[pid]["武功" .. wugongnum]
  local level = math.modf(JY.Person[pid]["武功等级" .. wugongnum] / 100) + 1
  if level > 10 then level = 10 end
  local maxnum, x, y = War_AutoCalMaxEnemy(x0, y0, wugongid, level)
  if x ~= nil then
    War_Fight_Sub(WAR.CurID, wugongnum, x, y)
    WAR.Person[WAR.CurID].Action = {"atk", x - WAR.Person[WAR.CurID]["坐标X"], y - WAR.Person[WAR.CurID]["坐标Y"]}
  end
end--自动战斗
function War_AutoMenu()
  WAR.AutoFight = 1
  WAR.ShowHead = 0
  Cls()
  War_Auto()
  return 1
end--自动往敌人方向移动
--人物武功编号，不是武功id
--返回 1=可以攻击敌人， 0 不能攻击
function War_AutoMove(wugongnum)
  local pid = WAR.Person[WAR.CurID]["人物编号"]
  local wugongid = JY.Person[pid]["武功" .. wugongnum]
  local level = math.modf(JY.Person[pid]["武功等级" .. wugongnum] / 100) + 1
  if level > 10 then level = 10 end
  local wugongtype = JY.Wugong[wugongid]["攻击范围"]
  local movescope = JY.Wugong[wugongid]["移动范围" .. level]
  local fightscope = JY.Wugong[wugongid]["杀伤范围" .. level]
  local scope = movescope + fightscope
  local x, y = nil, nil
  local move = 128
  local maxenemy = 0
  local movestep = War_CalMoveStep(WAR.CurID, WAR.Person[WAR.CurID]["移动步数"], 0)
  War_AutoCalMaxEnemyMap(wugongid, level)		--计算该武功各个坐标可以攻击到敌人的个数
  for i = 0, WAR.Person[WAR.CurID]["移动步数"] do
    local step_num = movestep[i].num
    if step_num ~= nil then
      if step_num == 0 then
        break;
      end
    end
    for j = 1, step_num do
      local xx = movestep[i].x[j]
      local yy = movestep[i].y[j]
      local num = 0
      if wugongtype == 0 or wugongtype == 2 or wugongtype == 3 then
        num = GetWarMap(xx, yy, 4)			--计算这个位置可以攻击到的最多敌人个数
      elseif wugongtype == 1 then
        local v = GetWarMap(xx, yy, 4)		--计算这个位置可以攻击到的最多敌人个数
        if v > 0 then
        	num = War_AutoCalMaxEnemy(xx, yy, wugongid, level)
      	end
      end
      if maxenemy < num then
        maxenemy = num
        x = xx
        y = yy
        move = i
      elseif num == maxenemy and num > 0 and Rnd(3) == 0 then
        maxenemy = num
        x = xx
        y = yy
        move = i
      end
    end
  end
  if maxenemy > 0 then
    War_CalMoveStep(WAR.CurID, WAR.Person[WAR.CurID]["移动步数"], 0)		--重新计算移动步数
    War_MovePerson(x, y)		--移动到相应的位置
    return 1
  else		--任何移动都直接攻击不到敌人，寻找一条可以移动到攻击到敌人位置的路线
    x, y = War_GetCanFightEnemyXY(scope)		--计算可以攻击到敌人的最近位置
    local minDest = math.huge
    if x == nil then			--无法走到可以攻击敌人的地方，可能敌人被围住，或者被敌人围住。
      local enemyid = War_AutoSelectEnemy()		--选择最近敌人
      War_CalMoveStep(WAR.CurID, 100, 0)		--计算移动步数 假设最大100步
      for i = 0, CC.WarWidth - 1 do
        for j = 0, CC.WarHeight - 1 do
          local dest = GetWarMap(i, j, 3)
          if dest < 128 then
            local dx = math.abs(i - WAR.Person[enemyid]["坐标X"])
            local dy = math.abs(j - WAR.Person[enemyid]["坐标Y"])
            if dx + dy < minDest then		--此时x,y是距离敌人的最短路径，虽然可能被围住
              minDest = dx + dy
              x = i
              y = j
            end
          elseif minDest == dx + dy and Rnd(2) == 0 then
            x = i
            y = j
          end
        end
      end
    else
      minDest = 0
    end
  
    if minDest < math.huge then		--有路可走
      while true do
	      local i = GetWarMap(x, y, 3)
	      if i <= WAR.Person[WAR.CurID]["移动步数"] then
	        break;
	      end
	      
	      if GetWarMap(x - 1, y, 3) == i - 1 then
	        x = x - 1
	      elseif GetWarMap(x + 1, y, 3) == i - 1 then
	        x = x + 1
	      elseif GetWarMap(x, y - 1, 3) == i - 1 then
	        y = y - 1
	      elseif GetWarMap(x, y + 1, 3) == i - 1 then
	        y = y + 1
	      end
	    end
	    War_MovePerson(x, y)
	  end
  end
  return 0
end--自动选择敌人
function War_AutoSelectEnemy()
  local enemyid = War_AutoSelectEnemy_near()
  WAR.Person[WAR.CurID]["自动选择对手"] = enemyid
  return enemyid
end--选择最近敌人
function War_AutoSelectEnemy_near()
  War_CalMoveStep(WAR.CurID, 100, 1)			--标记每个位置的步数
  local maxDest = math.huge
  local nearid = -1
  for i = 0, WAR.PersonNum - 1 do		--查找最近步数的敌人
    if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[i]["我方"] and WAR.Person[i]["死亡"] == false then
      local step = GetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 3)
      if step < maxDest then
	      nearid = i
	      maxDest = step
    	end
    end
  end
  return nearid
end
--计算可移动步数
--id 战斗人id，
--stepmax 最大步数，
--flag=0  移动，物品不能绕过，1 武功，用毒医疗等，不考虑挡路。
function War_CalMoveStep(id, stepmax, flag)
  CleanWarMap(3, 255)
  local x = WAR.Person[id]["坐标X"]
  local y = WAR.Person[id]["坐标Y"]
  local steparray = {}
  for i = 0, stepmax do
    steparray[i] = {}
    steparray[i].bushu = {}
    steparray[i].x = {}
    steparray[i].y = {}
  end
  SetWarMap(x, y, 3, 0)
  steparray[0].num = 1
  steparray[0].bushu[1] = stepmax
  steparray[0].x[1] = x
  steparray[0].y[1] = y
  War_FindNextStep(steparray, 0, flag, id)
  return steparray
end
--判断x,y是否为可移动位置
function War_CanMoveXY(x, y, flag)
  if GetWarMap(x, y, 1) > 0 then --有建筑则不行
	if WAR.CurID ~= nil and WAR.CurID > -1 then
		local pid = WAR.Person[WAR.CurID]["人物编号"]
		if freefight(pid) and WAR.BH[pid] ~= nil then
			return true
		end
	end
	return false
  end
  if flag == 0 then
    if CC.WarWater[GetWarMap(x, y, 0)] ~= nil then
      return false
    end
    if GetWarMap(x, y, 2) >= 0 then
    	return false
  	end
  end
  if flag == 1 and (WAR.HUFEI == 1 or WAR.QX == 1) then --无视ZOC
    if CC.WarWater[GetWarMap(x, y, 0)] ~= nil then
      return false
    end
    if GetWarMap(x, y, 2) >= 0 then
    	return true
  	end	
  end
  return true --武功之类的选择
end

--解毒菜单
function War_DecPoisonMenu()
  WAR.ShowHead = 0
  local r = War_ExecuteMenu(2)
  WAR.ShowHead = 1
  Cls()
  return r
end

--判断攻击后面对的方向
function War_Direct(x1, y1, x2, y2)
  local x = x2 - x1
  local y = y2 - y1
  if x == 0 and y == 0 then
    return WAR.Person[WAR.CurID]["人方向"]
  end
  if math.abs(x) < math.abs(y) then
    if y > 0 then
      return 3
    else
      return 0
    end
  else 
    if x > 0 then
    	return 1
  	else
    	return 2
    end
  end
end
--医疗菜单
function War_DoctorMenu()
  WAR.ShowHead = 0
  local r = War_ExecuteMenu(3)
  WAR.ShowHead = 1
  Cls()
  return r
end---执行医疗，解毒用毒
---flag=1 用毒， 2 解毒，3 医疗 4 暗器
---thingid 暗器物品id
function War_ExecuteMenu(flag, thingid)
  local pid = WAR.Person[WAR.CurID]["人物编号"]
  local step = nil
  if flag == 1 then
    step = math.modf((JY.Person[pid]["用毒能力"] + MPAttrib(pid, 5)) / 40)
  elseif flag == 2 then
    step = math.modf((JY.Person[pid]["解毒能力"] + MPAttrib(pid, 6)) / 40)
  elseif flag == 3 then
    step = math.modf((JY.Person[pid]["医疗能力"] + MPAttrib(pid, 4)) / 40)
  elseif flag == 4 then
    step = math.modf((JY.Person[pid]["暗器技巧"] + MPAttrib(pid, 7)) / 15) + 1
	step = limitX(step, 1, 8)
  end
  War_CalMoveStep(WAR.CurID, step, 1)
  local x1, y1 = War_SelectMove()
  if x1 == nil then
    lib.GetKey()
    Cls()
    return 0
  else
    return War_ExecuteMenu_Sub(x1, y1, flag, thingid)
  end
end---执行医疗，解毒用毒暗器的子函数，自动医疗也可调用
function War_ExecuteMenu_Sub(x1, y1, flag, thingid)
  local pid = WAR.Person[WAR.CurID]["人物编号"]
  local x0 = WAR.Person[WAR.CurID]["坐标X"]
  local y0 = WAR.Person[WAR.CurID]["坐标Y"]
  CleanWarMap(4, 0)
  WAR.Person[WAR.CurID]["人方向"] = War_Direct(x0, y0, x1, y1)
  SetWarMap(x1, y1, 4, 1)
  local emeny = GetWarMap(x1, y1, 2)
  if emeny >= 0 then
	  if flag == 1 and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emeny]["我方"] then
	    WAR.Person[emeny]["点数"] = War_PoisonHurt(pid, WAR.Person[emeny]["人物编号"])
	    SetWarMap(x1, y1, 4, 5)
	    WAR.Effect = 5
	  elseif flag == 2 and WAR.Person[WAR.CurID]["我方"] == WAR.Person[emeny]["我方"] then
	    WAR.Person[emeny]["点数"] = ExecDecPoison(pid, WAR.Person[emeny]["人物编号"])
	    SetWarMap(x1, y1, 4, 6)
	    WAR.Effect = 6
	  elseif flag == 3 then
	    if WAR.Person[WAR.CurID]["人物编号"] == 0 and putong() == 7 then
	      
	    elseif WAR.Person[WAR.CurID]["我方"] == WAR.Person[emeny]["我方"] then
	      WAR.Person[emeny]["点数"] = ExecDoctor(pid, WAR.Person[emeny]["人物编号"])
	      SetWarMap(x1, y1, 4, 4)
	      WAR.Effect = 4
	    end
	  elseif flag == 4 and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emeny]["我方"] then
	    WAR.Person[emeny]["点数"] = War_AnqiHurt(pid, WAR.Person[emeny]["人物编号"], thingid) * 2
	    SetWarMap(x1, y1, 4, 2)
	    WAR.Effect = 2
	  end
  
	  --主角医生方阵医疗
	  if flag == 3 and WAR.Person[WAR.CurID]["人物编号"] == 0 and putong() == 7 then
	    for ex = x1 - 3, x1 + 3 do
	      for ey = y1 - 3, y1 + 3 do
	        SetWarMap(ex, ey, 4, 1)
	        if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
	          local ep = GetWarMap(ex, ey, 2)
	          if WAR.Person[WAR.CurID]["我方"] == WAR.Person[ep]["我方"] then
		          WAR.Person[ep]["点数"] = ExecDoctor(pid, WAR.Person[ep]["人物编号"])
		          SetWarMap(ex, ey, 4, 4)
		          WAR.Effect = 4
		        end
	        end        
	      end
	    end
	  end
	  if flag == 4 and DT(WAR.Person[WAR.CurID]["人物编号"],153) and WAR.LMC==1 then
	    for ex = x1 - 5, x1 + 5 do
	      for ey = y1 - 5, y1 + 5 do
	        SetWarMap(ex, ey, 4, 1)
	        if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
	          local ep = GetWarMap(ex, ey, 2)
	          if WAR.Person[WAR.CurID]["我方"] == WAR.Person[ep]["我方"] then
		          WAR.Person[ep]["点数"] = War_AnqiHurt(pid, WAR.Person[ep]["人物编号"], thingid)* 2
		          SetWarMap(ex, ey, 4, 2)
		          WAR.Effect = 2
		        end
	        end        
	      end
	    end
	  end
  end
  WAR.EffectXY = {}
  WAR.EffectXY[1] = {x1, y1}
  WAR.EffectXY[2] = {x1, y1}
  if flag == 1 then
    War_ShowFight(pid, 0, 0, 0, x1, y1, 30)
  elseif flag == 2 then
    War_ShowFight(pid, 0, 0, 0, x1, y1, 36)
  elseif flag == 3 then
    War_ShowFight(pid, 0, 0, 0, x1, y1, 0)
  elseif flag == 4 and emeny >= 0 then
    War_ShowFight(pid, 0, -1, 0, x1, y1, JY.Thing[thingid]["暗器动画编号"])
  end
  for i = 0, WAR.PersonNum - 1 do
    WAR.Person[i]["点数"] = 0
  end
  if flag == 4 then
    if emeny >= 0 then
      instruct_32(thingid, -1)
      return 1
    else
      return 0
    end
  else
    WAR.Person[WAR.CurID]["经验"] = WAR.Person[WAR.CurID]["经验"] + 1
    AddPersonAttrib(pid, "体力", -2)
  end
  
  if inteam(pid) then
    AddPersonAttrib(pid, "体力", -4)
  end
  return 1
end
--War_FightSelectType 
War_FightSelectType = function(movefanwei, atkfanwei, x, y)
  local x0 = WAR.Person[WAR.CurID]["坐标X"]
  local y0 = WAR.Person[WAR.CurID]["坐标Y"]
  if x == nil and y == nil then
    x, y = War_KfMove(movefanwei, atkfanwei)
    if x == nil then
      lib.GetKey()
      Cls()
      return 
    end
  else
    WarDrawAtt(x, y, atkfanwei, 1)
    ShowScreen()
    lib.Delay(500)
  end
  if not War_Direct(x0, y0, x, y) then
    WAR.Person[WAR.CurID]["人方向"] = WAR.Person[WAR.CurID]["人方向"]
  else
  	WAR.Person[WAR.CurID]["人方向"] = War_Direct(x0, y0, x, y)
  end
  SetWarMap(x, y, 4, 1)
  WAR.EffectXY = {}
  return x, y
end
---War_FindNextStep1
function War_FindNextStep1(steparray, step, id, idb)
  local num = 0
  local step1 = step + 1
  steparray[step1] = {}
  steparray[step1].bushu = {}
  steparray[step1].x = {}
  steparray[step1].y = {}
  local function fujinnum(tx, ty)
    local tnum = 0
    local wofang = WAR.Person[id]["我方"]
    local tv = nil
    tv = GetWarMap(tx + 1, ty, 2)
    if idb==nil then
			if tv~=-1 then
				if WAR.Person[tv]["我方"]~=wofang then
					return -1
				end
			end
		elseif tv==idb then
			return -1
		end
    if tv ~= -1 and WAR.Person[tv]["我方"] ~= wofang then
      tnum = tnum + 1
    end
    
    tv = GetWarMap(tx - 1, ty, 2)
    if idb==nil then
			if tv~=-1 then
				if WAR.Person[tv]["我方"]~=wofang then
					return -1
				end
			end
		elseif tv==idb then
			return -1
		end
    if tv ~= -1 and WAR.Person[tv]["我方"] ~= wofang then
      tnum = tnum + 1
    end
    tv = GetWarMap(tx, ty + 1, 2)
    if idb==nil then
			if tv~=-1 then
				if WAR.Person[tv]["我方"]~=wofang then
					return -1
				end
			end
		elseif tv==idb then
			return -1
		end
    if tv ~= -1 and WAR.Person[tv]["我方"] ~= wofang then
      tnum = tnum + 1
    end
    tv = GetWarMap(tx, ty - 1, 2)
    if idb==nil then
			if tv~=-1 then
				if WAR.Person[tv]["我方"]~=wofang then
					return -1
				end
			end
		elseif tv==idb then
			return -1
		end
    if tv ~= -1 and WAR.Person[tv]["我方"] ~= wofang then
      tnum = tnum + 1
    end
    return tnum
  end
  
  for i = 1, steparray[step].num do
    steparray[step].bushu[i] = steparray[step].bushu[i] + 1
    local x = steparray[step].x[i]
    local y = steparray[step].y[i]
    if x + 1 < CC.WarWidth - 1 then
      local v = GetWarMap(x + 1, y, 3)
      if v == 255 and War_CanMoveXY(x + 1, y, 0) == true then
	      num = num + 1
	      steparray[step1].x[num] = x + 1
	      steparray[step1].y[num] = y
	      SetWarMap(x + 1, y, 3, step1)
	      local mnum = fujinnum(x + 1, y)
	      if mnum == -1 then
	        return steparray[step].bushu[i], x + 1, y
	      else
	      	steparray[step1].bushu[num] = steparray[step].bushu[i] + mnum
	    	end
	    end  
    end
    
    
    if x - 1 > 0 then
      local v = GetWarMap(x - 1, y, 3)
      if v == 255 and War_CanMoveXY(x - 1, y, 0) == true then
	      num = num + 1
	      steparray[step1].x[num] = x - 1
	      steparray[step1].y[num] = y
	      SetWarMap(x - 1, y, 3, step1)
	      local mnum = fujinnum(x - 1, y)
	      if mnum == -1 then
	        return steparray[step].bushu[i], x - 1, y
	      else
	      	steparray[step1].bushu[num] = steparray[step].bushu[i] + mnum
	    	end
	    end
	    
    end
    
    if y + 1 < CC.WarHeight - 1 then
      local v = GetWarMap(x, y + 1, 3)
      if v == 255 and War_CanMoveXY(x, y + 1, 0) == true then
	      num = num + 1
	      steparray[step1].x[num] = x
	      steparray[step1].y[num] = y + 1
	      SetWarMap(x, y + 1, 3, step1)
	      local mnum = fujinnum(x, y + 1)
	      if mnum == -1 then
	        return steparray[step].bushu[i], x, y + 1
	      else
	      	steparray[step1].bushu[num] = steparray[step].bushu[i] + mnum
	      end    
	    end	
    end
    
    if y - 1 > 0 then
      local v = GetWarMap(x, y - 1, 3)
      if v == 255 and War_CanMoveXY(x, y - 1, 0) == true then
	      num = num + 1
	      steparray[step1].x[num] = x
	      steparray[step1].y[num] = y - 1
	      SetWarMap(x, y - 1, 3, step1)
	      local mnum = fujinnum(x, y - 1)
	      if mnum == -1 then
	        return steparray[step].bushu[i], x, y - 1
	      else
	      	steparray[step1].bushu[num] = steparray[step].bushu[i] + mnum
	      end
	    
	    end
    end
  end
  if num == 0 then
    return -1
  end
  steparray[step1].num = num
  for i = 1, num - 1 do
    for j = i + 1, num do
      if steparray[step1].bushu[j] < steparray[step1].bushu[i] then
        steparray[step1].bushu[i], steparray[step1].bushu[j] = steparray[step1].bushu[j], steparray[step1].bushu[i]
        steparray[step1].x[i], steparray[step1].x[j] = steparray[step1].x[j], steparray[step1].x[i]
        steparray[step1].y[i], steparray[step1].y[j] = steparray[step1].y[j], steparray[step1].y[i]
      end
    end
  end
  return War_FindNextStep1(steparray, step1, id, idb)
end
--设置下一步可移动的坐标
function War_FindNextStep(steparray, step, flag, id)
  local num = 0
  local step1 = step + 1
  
  local fujinnum = function(tx, ty)
    if flag ~= 0 or id == nil then
      return 0
    end
    local tnum = 0
    local wofang = WAR.Person[id]["我方"]
    local tv = nil
    tv = GetWarMap(tx + 1, ty, 2)
    if tv ~= -1 and WAR.Person[tv]["我方"] ~= wofang then
      tnum = 9999
    end
    tv = GetWarMap(tx - 1, ty, 2)
    if tv ~= -1 and WAR.Person[tv]["我方"] ~= wofang then
      tnum = 999
    end
    tv = GetWarMap(tx, ty + 1, 2)
    if tv ~= -1 and WAR.Person[tv]["我方"] ~= wofang then
      tnum = 999
    end
    tv = GetWarMap(tx, ty - 1, 2)
    if tv ~= -1 and WAR.Person[tv]["我方"] ~= wofang then
      tnum = 999
    end
    return tnum
  end
  
  for i = 1, steparray[step].num do
    if steparray[step].bushu[i] > 0 then
      steparray[step].bushu[i] = steparray[step].bushu[i] - 1
      local x = steparray[step].x[i]
      local y = steparray[step].y[i]
      if x + 1 < CC.WarWidth - 1 then
        local v = GetWarMap(x + 1, y, 3)
        if v == 255 and War_CanMoveXY(x + 1, y, flag) == true then
	        num = num + 1
	        steparray[step1].x[num] = x + 1
	        steparray[step1].y[num] = y
	        SetWarMap(x + 1, y, 3, step1)
	        steparray[step1].bushu[num] = steparray[step].bushu[i] - fujinnum(x + 1, y)
      	end
      end
      
      if x - 1 > 0 then
        local v = GetWarMap(x - 1, y, 3)
        if v == 255 and War_CanMoveXY(x - 1, y, flag) == true then
	        num = num + 1
	        steparray[step1].x[num] = x - 1
	        steparray[step1].y[num] = y
	        SetWarMap(x - 1, y, 3, step1)
	        steparray[step1].bushu[num] = steparray[step].bushu[i] - fujinnum(x - 1, y)
	      end
      end
      
      if y + 1 < CC.WarHeight - 1 then
        local v = GetWarMap(x, y + 1, 3)
        if v == 255 and War_CanMoveXY(x, y + 1, flag) == true then
	        num = num + 1
	        steparray[step1].x[num] = x
	        steparray[step1].y[num] = y + 1
	        SetWarMap(x, y + 1, 3, step1)
	        steparray[step1].bushu[num] = steparray[step].bushu[i] - fujinnum(x, y + 1)
	      end
      end
      
      if y - 1 > 0 then
	      local v = GetWarMap(x, y - 1, 3)
	      if v == 255 and War_CanMoveXY(x, y - 1, flag) == true then
		      num = num + 1
		      steparray[step1].x[num] = x
		      steparray[step1].y[num] = y - 1
		      SetWarMap(x, y - 1, 3, step1)
		      steparray[step1].bushu[num] = steparray[step].bushu[i] - fujinnum(x, y - 1)
	    	end
    	end
    end
  end
  if num == 0 then
    return 
  end
  steparray[step1].num = num
  War_FindNextStep(steparray, step1, flag, id)
end--判断是否能打到敌人
function War_GetCanFightEnemyXY()
  local num, x, y = nil, nil, nil
  num, x, y = War_realjl(WAR.CurID)
  if num == -1 then
    return 
  end
  return x, y
end--移动
function War_MoveMenu()
  if WAR.Person[WAR.CurID]["人物编号"] ~= -1 then
    WAR.ShowHead = 0
    if WAR.Person[WAR.CurID]["移动步数"] <= 0 then
      return 0
    end
	if DT3(WAR.Person[WAR.CurID]["人物编号"], 1) and WAR.HUFEI == 1 then --无视ZOC
		War_CalMoveStep(WAR.CurID, WAR.Person[WAR.CurID]["移动步数"], 1)		
	elseif nozoc(WAR.Person[WAR.CurID]["人物编号"]) then
		WAR.QX = 1
		War_CalMoveStep(WAR.CurID, WAR.Person[WAR.CurID]["移动步数"], 1)
		WAR.QX = 0
	else
		War_CalMoveStep(WAR.CurID, WAR.Person[WAR.CurID]["移动步数"], 0)
	end
    local r = nil
    local x, y = War_SelectMove()
	if nozoc(WAR.Person[WAR.CurID]["人物编号"]) or
		(DT3(WAR.Person[WAR.CurID]["人物编号"], 1) and WAR.HUFEI == 1) then --无视ZOC
		if x ~= nil then
			while x ~= nil and GetWarMap(x, y, 2) >= 0 do
				x, y = War_SelectMove()
			end
		end
	end
    if x ~= nil then
      War_MovePerson(x, y, 1)
      r = 1
    else
      r = 0
      WAR.ShowHead = 1
      Cls()
    end
    lib.GetKey()
    return r
  else
    local ydd = {}
    local n = 1
    for i = 0, WAR.PersonNum - 1 do
      if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
        ydd[n] = i
        n = n + 1
      end
    end
    local dx = ydd[math.random(n - 1)]
    local DX = WAR.Person[dx]["坐标X"]
    local DY = WAR.Person[dx]["坐标Y"]
    local YDX = {DX + 1, DX - 1, DX}
    local YDY = {DY + 1, DY - 1, DY}
    local ZX = YDX[math.random(3)]
    local ZY = YDY[math.random(3)]
    if not SceneCanPass(ZX, ZY) or GetWarMap(ZX, ZY, 2) < 0 then
      SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 2, -1)
      SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 5, -1)
      WAR.Person[WAR.CurID]["坐标X"] = ZX
      WAR.Person[WAR.CurID]["坐标Y"] = ZY
      SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 2, WAR.CurID)
      SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 5, WAR.Person[WAR.CurID]["贴图"])
    end
  end
  return 1
end--人物移动
function War_MovePerson(x, y, flag)
  local x1 = x
  local y1 = y
  WAR.TJZS[WAR.Person[WAR.CurID]["人物编号"]] = {WAR.Person[WAR.CurID]["坐标X"],WAR.Person[WAR.CurID]["坐标Y"]} ----
  if not flag then
    flag = 0
  end
  local movenum = GetWarMap(x, y, 3)
  local movetable = {}
  for i = movenum, 1, -1 do
    movetable[i] = {}
    movetable[i].x = x
    movetable[i].y = y
    if GetWarMap(x - 1, y, 3) == i - 1 then
      x = x - 1
      movetable[i].direct = 1
    elseif GetWarMap(x + 1, y, 3) == i - 1 then
      x = x + 1
      movetable[i].direct = 2
    elseif GetWarMap(x, y - 1, 3) == i - 1 then
      y = y - 1
      movetable[i].direct = 3
    elseif GetWarMap(x, y + 1, 3) == i - 1 then
      y = y + 1
      movetable[i].direct = 0
    end
  for j = 0,WAR.PersonNum-1 do 
    if txjid(WAR.Person[j]["人物编号"]) and WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
			local df = WAR.Person[j]["人物编号"] 
			local offset1 = math.abs(movetable[i].x - WAR.Person[j]["坐标X"]) 
            local offset2 = math.abs(movetable[i].y - WAR.Person[j]["坐标Y"])
			local offset=offset1+offset2	
			if offset1 <= 10 and offset2 <= 10 and offset <= 20 then
			      WAR.YDBS = WAR.YDBS + 1
				  WAR.WZJS[WAR.Person[WAR.CurID]["人物编号"]]=1
			end
    end
  end
  end
 -- WAR.TJZS[WAR.Person[WAR.CurID]["人物编号"]] = nil
  movetable.num = movenum
  movetable.now = 0
  WAR.Person[WAR.CurID].Move = movetable
  if WAR.Person[WAR.CurID]["移动步数"] < movenum then
    movenum = WAR.Person[WAR.CurID]["移动步数"]
    WAR.Person[WAR.CurID]["移动步数"] = 0
  else
    WAR.Person[WAR.CurID]["移动步数"] = WAR.Person[WAR.CurID]["移动步数"] - movenum
  end
  WAR.LBPM = movenum
  WAR.XKZ=movenum
  for i = 1, movenum do --无视zoc
    local t1 = lib.GetTime()
    SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 2, -1)
    SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 5, -1)
	if GetWarMap(movetable[i].x, movetable[i].y, 2) > 0 and 
		GetWarMap(movetable[i].x, movetable[i].y, 2) ~= WAR.CurID then
	elseif GetWarMap(movetable[i].x, movetable[i].y, 5) > 0 and
		GetWarMap(movetable[i].x, movetable[i].y, 5) ~= WAR.Person[WAR.CurID]["贴图"] then
	else
		WAR.Person[WAR.CurID]["坐标X"] = movetable[i].x
		WAR.Person[WAR.CurID]["坐标Y"] = movetable[i].y
		WAR.Person[WAR.CurID]["人方向"] = movetable[i].direct
		WAR.Person[WAR.CurID]["贴图"] = WarCalPersonPic(WAR.CurID)
		SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 2, WAR.CurID)
		SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 5, WAR.Person[WAR.CurID]["贴图"])
    WarDrawMap(0)
    ShowScreen()
	end
    local t2 = lib.GetTime()
    if i < movenum and t2 - t1 < 2 * CC.Frame then
      lib.Delay(2 * CC.Frame - (t2 - t1))
    end
  end
   for j = 0,WAR.PersonNum-1 do  ----
	if DT(WAR.Person[j]["人物编号"],5) and (WAR.Person[j]["人物编号"] == 5 or WAR.Person[j]["人物编号"] == 0) and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] 
	and WAR.Person[j]["死亡"] == false then
			local offset1 = math.abs(WAR.Person[WAR.CurID]["坐标X"] - WAR.Person[j]["坐标X"]) 
            local offset2 = math.abs(WAR.Person[WAR.CurID]["坐标Y"] - WAR.Person[j]["坐标Y"])  
			local offset3 = math.abs(WAR.TJZS[WAR.Person[WAR.CurID]["人物编号"]][1] - WAR.Person[j]["坐标X"]) 
			local offset4 = math.abs(WAR.TJZS[WAR.Person[WAR.CurID]["人物编号"]][2] - WAR.Person[j]["坐标Y"]) 
			local offset6 = offset3 + offset4
			local offset5 = offset1 + offset2
			if offset1 > 8 or offset2 > 8 then
			   if offset5 > offset6 then 
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 1850, 1863)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 5, -1)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 2, -1)
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 1850, 1863)
	    WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] = WAR.TJZS[WAR.Person[WAR.CurID]["人物编号"]][1], WAR.TJZS[WAR.Person[WAR.CurID]["人物编号"]][2]
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 1850, 1863)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 5, WAR.Person[WAR.CurID]["贴图"])
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 2, WAR.CurID)
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 1850, 1863)
	    WAR.TJZS[2000+WAR.Person[WAR.CurID]["人物编号"]] = 1 
		WAR.TJZS[WAR.Person[WAR.CurID]["人物编号"]] = nil
		end
	end
	end
	end
	
	for j = 0,WAR.PersonNum-1 do  ----
	if BJY(WAR.Person[j]["人物编号"],0) and juexing() > 2 and WAR.Person[j]["我方"] ~= WAR.Person[WAR.CurID]["我方"] 
	and WAR.Person[j]["死亡"] == false then
			local offset1 = math.abs(WAR.Person[WAR.CurID]["坐标X"] - WAR.Person[j]["坐标X"]) 
            local offset2 = math.abs(WAR.Person[WAR.CurID]["坐标Y"] - WAR.Person[j]["坐标Y"])  
			local offset3 = math.abs(WAR.TJZS[WAR.Person[WAR.CurID]["人物编号"]][1] - WAR.Person[j]["坐标X"]) 
			local offset4 = math.abs(WAR.TJZS[WAR.Person[WAR.CurID]["人物编号"]][2] - WAR.Person[j]["坐标Y"]) 
			local offset6 = offset3 + offset4
			local offset5 = offset1 + offset2
			if offset1 > 8 or offset2 > 8 then
			   if offset5 > offset6 then 
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 2741, 2754)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 5, -1)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 2, -1)
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 2741, 2754)
	    WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] = WAR.TJZS[WAR.Person[WAR.CurID]["人物编号"]][1], WAR.TJZS[WAR.Person[WAR.CurID]["人物编号"]][2]
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 2741, 2754)
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 5, WAR.Person[WAR.CurID]["贴图"])
	    lib.SetWarMap(WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"], 2, WAR.CurID)
	    WarDrawMap(0)
	    CurIDTXDH(WAR.CurID, 2741, 2754)
	    WAR.TJZS[2000+WAR.Person[WAR.CurID]["人物编号"]] = 1 
		WAR.TJZS[WAR.Person[WAR.CurID]["人物编号"]] = nil
		end
	end
	end
	end
end

--修炼物品
function War_PersonTrainDrug(pid)
  local p = JY.Person[pid]
  local thingid = p["修炼物品"]
  if thingid < 0 then
    return 
  end
  if JY.Thing[thingid]["练出物品需经验"] <= 0 then
    return 
  end
  local needpoint = (7 - math.modf(p["资质"] / 15)) * JY.Thing[thingid]["练出物品需经验"]
  if p["物品修炼点数"] < needpoint then
    return 
  end
  
  local haveMaterial = 0
  local MaterialNum = -1
  for i = 1, CC.MyThingNum do
    if JY.Base["物品" .. i] == JY.Thing[thingid]["需材料"] then
      haveMaterial = 1
      MaterialNum = JY.Base["物品数量" .. i]
    end
  end
  
  --材料足够
  if haveMaterial == 1 then
    local enough = {}
    local canMake = 0
    for i = 1, 5 do
      if JY.Thing[thingid]["练出物品" .. i] >= 0 and JY.Thing[thingid]["需要物品数量" .. i] <= MaterialNum then
        canMake = 1
        enough[i] = 1
      else
        enough[i] = 0
      end
    end

  
	  --可以练出
	  if canMake == 1 then
	    local makeID = nil
	    while true do
	      makeID = Rnd(5) + 1
	      if thingid == 221 and pid == 88 and enough[4] == 1 then
	        makeID = 4
	      end
	      if thingid == 220 and pid == 89 and enough[4] == 1 then
	        makeID = 4
	      end
	      if enough[makeID] == 1 then
	        break;
	      end
	    end
	    
	    local newThingID = JY.Thing[thingid]["练出物品" .. makeID]
	    DrawStrBoxWaitKey(string.format("%s 制造出 %s", p["姓名"], JY.Thing[newThingID]["名称"]), C_WHITE, CC.DefaultFont)
	    if instruct_18(newThingID) == true then
	      instruct_32(newThingID, 1)
	    else
	      instruct_32(newThingID, 1)
	    end
	    instruct_32(JY.Thing[thingid]["需材料"], -JY.Thing[thingid]["需要物品数量" .. makeID])
	    p["物品修炼点数"] = 0
	  end
	end
end--计算敌人中毒点数
--pid 使毒人，
--emenyid  中毒人
function War_PoisonHurt(pid, emenyid)
  local vv = math.modf((JY.Person[pid]["用毒能力"] + MPAttrib(pid, 5) - JY.Person[emenyid]["抗毒能力"]) / 4)
  if JY.Status == GAME_WMAP then
    for i,v in pairs(CC.AddPoi) do
      if v[1] == pid then
        for wid = 0, WAR.PersonNum - 1 do
          if WAR.Person[wid]["人物编号"] == v[2] and WAR.Person[wid]["死亡"] == false then
            vv = vv + v[3] / 4
          end
        end
      end
    end
  end
  vv = vv - JY.Person[emenyid]["内力"] / 200

  if PersonGT(emenyid, 108) then --易筋经免疫毒
	vv = 0
  end
  vv = math.modf(vv)
  if vv < 0 then
    vv = 0
  end
  return AddPersonAttrib(emenyid, "中毒程度", vv)
end---用毒菜单
function War_PoisonMenu()
  WAR.ShowHead = 0
  local r = War_ExecuteMenu(1)
  WAR.ShowHead = 1
  Cls()
  return r
end--返回两人之间的实际距离
function War_realjl(ida, idb)
  if ida == nil then
    ida = WAR.CurID
  end
  CleanWarMap(3, 255)
  local x = WAR.Person[ida]["坐标X"]
  local y = WAR.Person[ida]["坐标Y"]
  local steparray = {}
  steparray[0] = {}
  steparray[0].bushu = {}
  steparray[0].x = {}
  steparray[0].y = {}
  SetWarMap(x, y, 3, 0)
  steparray[0].num = 1
  steparray[0].bushu[1] = 0		--还能移动的步数
  steparray[0].x[1] = x
  steparray[0].y[1] = y
  return War_FindNextStep1(steparray, 0, ida, idb)
end--战斗休息
function War_RestMenu()
	if WAR.CurID and WAR.CurID >= 0  then
	  local pid = WAR.Person[WAR.CurID]["人物编号"]
	  if WAR.tmp[1000 + pid] == 1 then
	    return 1
	  end
	  local vv = math.modf(JY.Person[pid]["体力"] / 100 - JY.Person[pid]["受伤程度"] / 50 - JY.Person[pid]["中毒程度"] / 50) + 2
	  if WAR.Person[WAR.CurID]["移动步数"] > 0 then
	    vv = vv + 2
	  end
	  if inteam(pid) then
	    vv = vv + math.random(3)
	  else
	    vv = vv + 2 + math.random(4)
	  end
	  vv = (vv) / 120
	  local v = 3 + Rnd(3)
	  AddPersonAttrib(pid, "体力", v)
	  if JY.Person[pid]["体力"] > 0 then
		local ttt = JY.Person[pid]["生命最大值"]
		if ttt > 2000 then
			ttt = math.random(2000, JY.Person[pid]["生命最大值"])
		end
	    v = 3 + math.modf(ttt * (vv))
	    AddPersonAttrib(pid, "生命", v)
	    v = 3 + math.modf(JY.Person[pid]["内力最大值"] * (vv))
	    AddPersonAttrib(pid, "内力", v)
	  end
	  
	if MPPD(pid)==15 and PersonGT(pid,100) then --沼跃鱼：大理先天
	    local XK = nil
		local NK = nil
		local NS = nil
		local NT = nil
	    local mpdj=0.25
	    XK = 1000 * mpdj
	    NK = XK*3
		NS = 5 + math.modf(JY.Person[pid]["受伤程度"]/10)
		NT = NS*2
	    WAR.Person[WAR.CurID]["生命点数"]=AddPersonAttrib(pid, "生命", XK);
		WAR.Person[WAR.CurID]["内力点数"]=AddPersonAttrib(pid, "内力", NK);
		WAR.Person[WAR.CurID]["体力点数"]=AddPersonAttrib(pid, "体力", NT)
	    AddPersonAttrib(pid, "受伤程度", -NS);
		DHdisplay(1923, 1940, "先天功调理内息");
	end	
	
    if DT(pid,50) then 
	    local XK = nil
		local NK = nil
		local NS = nil
		local NT = nil
	    local mpdj=0.25
	    XK = 100 * mpdj
	    NK = XK*500
		NS = 5 + math.modf(JY.Person[pid]["受伤程度"]/10)
		NT = NS*2
	    WAR.Person[WAR.CurID]["生命点数"]=AddPersonAttrib(pid, "生命", XK);
		WAR.Person[WAR.CurID]["内力点数"]=AddPersonAttrib(pid, "内力", NK);
		WAR.Person[WAR.CurID]["体力点数"]=AddPersonAttrib(pid, "体力", NT)
	    AddPersonAttrib(pid, "受伤程度", -NS);
		AddPersonAttrib(pid, "中毒程度", -NS);
		DHdisplay(1715, 1727, "擒龙真气");
	end	
	
	if DT(pid,558) then 
	    local XK = nil
		local NK = nil
		local NS = nil
		local NT = nil
	    local mpdj=0.25
	    XK = 1000 * mpdj
	    NK = XK*3
		NS = 5 + math.modf(JY.Person[pid]["受伤程度"]/10)
		NT = NS*2
	    WAR.Person[WAR.CurID]["生命点数"]=AddPersonAttrib(pid, "生命", XK);
		WAR.Person[WAR.CurID]["内力点数"]=AddPersonAttrib(pid, "内力", NK);
		WAR.Person[WAR.CurID]["体力点数"]=AddPersonAttrib(pid, "体力", NT)
	    AddPersonAttrib(pid, "受伤程度", -NS);
		DHdisplay(1923, 1940, "圣火调息");
		WAR.HIDE[pid]=50
	end

    if DT(pid,583) then 
	    local XK = nil
		local NK = nil
		local NS = nil
		local NT = nil
	    XK = 1000 * 0.3
	    NK = XK * 3
		NS = 5 + math.modf(JY.Person[pid]["受伤程度"]/10)
		NT = NS*2
	    WAR.Person[WAR.CurID]["生命点数"]=AddPersonAttrib(pid, "生命", XK);
		WAR.Person[WAR.CurID]["内力点数"]=AddPersonAttrib(pid, "内力", NK);
		WAR.Person[WAR.CurID]["体力点数"]=AddPersonAttrib(pid, "体力", NT)
	    AddPersonAttrib(pid, "受伤程度", -NS);
		AddPersonAttrib(pid, "中毒程度", -NS);
		DHdisplay(1002, 1025, "森罗万道・调息");
		WAR.HIDE[pid] = 50
	end

	if (DT(pid,599) or wglw(pid,107)) and PersonGT(pid,107) then 
	    local XK = nil
		local NK = nil
		local NS = nil
		local NT = nil
	    local mpdj=0.25
	    XK = 1000 * mpdj
	    NK = XK*3
		NS = 5 + math.modf(JY.Person[pid]["受伤程度"]/10)
		NT = NS*2
	    WAR.Person[WAR.CurID]["生命点数"]=AddPersonAttrib(pid, "生命", XK);
		WAR.Person[WAR.CurID]["内力点数"]=AddPersonAttrib(pid, "内力", NK);
		WAR.Person[WAR.CurID]["体力点数"]=AddPersonAttrib(pid, "体力", NT)
	    AddPersonAttrib(pid, "受伤程度", -NS);
		AddPersonAttrib(pid, "中毒程度", -NS);
		DHdisplay(2538, 2558, "天之道・损有余而补不足");
	end
	 
    if (DT(pid,9) or wglw(pid,106)) and PersonGT(pid,106) then 
	    local XK = nil
		local NK = nil
		local NS = nil
		local NT = nil
	    local mpdj=0.25
	    XK = 1000 * mpdj
	    NK = XK*3
		NS = 5 + math.modf(JY.Person[pid]["受伤程度"]/10)
		NT = NS*2
	    WAR.Person[WAR.CurID]["生命点数"]=AddPersonAttrib(pid, "生命", XK);
		WAR.Person[WAR.CurID]["内力点数"]=AddPersonAttrib(pid, "内力", NK);
		WAR.Person[WAR.CurID]["体力点数"]=AddPersonAttrib(pid, "体力", NT)
	    AddPersonAttrib(pid, "受伤程度", -NS);
		AddPersonAttrib(pid, "中毒程度", -NS);
		DHdisplay(1400, 1419, "九阳神功・大周天搬运");
	end	
	
    if DT(pid,592) then 
	    local XK = nil
		local NK = nil
		local NS = nil
		local NT = nil
	    local mpdj=0.25
	    XK = 2000 * mpdj
	    NK = XK*3
		NS = 5 + math.modf(JY.Person[pid]["受伤程度"]/100)
		NT = NS*2
	    WAR.Person[WAR.CurID]["生命点数"]=AddPersonAttrib(pid, "生命", 25);
		WAR.Person[WAR.CurID]["内力点数"]=AddPersonAttrib(pid, "内力", NK);
		WAR.Person[WAR.CurID]["体力点数"]=AddPersonAttrib(pid, "体力", 5)
	    AddPersonAttrib(pid, "受伤程度", -NS);
		AddPersonAttrib(pid, "中毒程度", -NS);
		DHdisplay(1312, 1325, "独孤剑意");
	end	
	
    if DT(pid,600) then 
	    local XK = nil
		local NK = nil
		local NS = nil
		local NT = nil
	    local mpdj=0.25
	    XK = 1000 * mpdj
	    NK = XK*3
		NS = 5 + math.modf(JY.Person[pid]["受伤程度"]/10)
		NT = NS*2
	    WAR.Person[WAR.CurID]["生命点数"]=AddPersonAttrib(pid, "生命", XK);
		WAR.Person[WAR.CurID]["内力点数"]=AddPersonAttrib(pid, "内力", NK);
		WAR.Person[WAR.CurID]["体力点数"]=AddPersonAttrib(pid, "体力", NT)
	    AddPersonAttrib(pid, "受伤程度", -NS);
		AddPersonAttrib(pid, "中毒程度", -NS);
		DHdisplay(2317, 2336, "玄武真气");
	end 	
	
	if DT(pid,602) then 
	   local XK = nil
		local NK = nil
		local NS = nil
		local NT = nil
	    local mpdj=0.25
	    XK = 1000 * mpdj
	    NK = XK*3
		NS = 5 + math.modf(JY.Person[pid]["受伤程度"]/10)
		NT = NS*2
	    WAR.Person[WAR.CurID]["生命点数"]=AddPersonAttrib(pid, "生命", XK);
		WAR.Person[WAR.CurID]["内力点数"]=AddPersonAttrib(pid, "内力", NK);
		WAR.Person[WAR.CurID]["体力点数"]=AddPersonAttrib(pid, "体力", NT)
	    AddPersonAttrib(pid, "受伤程度", -NS);
		AddPersonAttrib(pid, "中毒程度", -NS);
		DHdisplay(1672, 1685, "剑气逆行");
	end
	  
    if T3XYK(pid) and juexing() > 0 then 
        local XK = nil
		local NK = nil
		local NS = nil
		local NT = nil
	    local mpdj=0.15
	    XK = 1000 * mpdj
	    NK = XK*1.5
		NS = 3 + math.modf(JY.Person[pid]["受伤程度"]/20)
		NT = NS*2
	    WAR.Person[WAR.CurID]["生命点数"]=AddPersonAttrib(pid, "生命", XK);
		WAR.Person[WAR.CurID]["内力点数"]=AddPersonAttrib(pid, "内力", NK);
		WAR.Person[WAR.CurID]["体力点数"]=AddPersonAttrib(pid, "体力", NT)
	    AddPersonAttrib(pid, "受伤程度", -NS);
		AddPersonAttrib(pid, "中毒程度", -NS);
		DHdisplay(770, 782, "万里龙城");
	end	
	
    if NF(pid) then 
	    local XK = nil
		local NK = nil
		local NS = nil
		local NT = nil
	    local mpdj=0.25
	    XK = 1000 * mpdj
	    NK = XK*3
		NS = 5 + math.modf(JY.Person[pid]["受伤程度"]/10)
		NT = NS*2
	    WAR.Person[WAR.CurID]["生命点数"]=AddPersonAttrib(pid, "生命", XK);
		WAR.Person[WAR.CurID]["内力点数"]=AddPersonAttrib(pid, "内力", NK);
		WAR.Person[WAR.CurID]["体力点数"]=AddPersonAttrib(pid, "体力", NT)
	    AddPersonAttrib(pid, "受伤程度", -NS);
		AddPersonAttrib(pid, "中毒程度", -NS);
		DHdisplay(678, 690, "心若冰清 天塌不惊");
	end	
	
    if BJY(pid) and juexing() > 0 then 
	    local XK = nil
		local NK = nil
		local NS = nil
		local NT = nil
	    local mpdj=0.25
	    XK = 1000 * mpdj
	    NK = XK*3
		NS = 5 + math.modf(JY.Person[pid]["受伤程度"]/10)
		NT = NS*2
	    WAR.Person[WAR.CurID]["生命点数"]=AddPersonAttrib(pid, "生命", XK);
		WAR.Person[WAR.CurID]["内力点数"]=AddPersonAttrib(pid, "内力", NK);
		WAR.Person[WAR.CurID]["体力点数"]=AddPersonAttrib(pid, "体力", NT)
	    AddPersonAttrib(pid, "受伤程度", -NS);
		AddPersonAttrib(pid, "中毒程度", -NS);
		DHdisplay(345, 357, "以一御六 七气归一");
	end		
	
    if wglw(pid,183) or (DT(pid,615) and PersonGT(pid,183)) then	
		local XK = nil
		local NK = nil
		local NS = nil
		local NT = nil
	    local mpdj=0.25
	    XK = 1000 * mpdj
	    NK = XK*3
		NS = 5 + math.modf(JY.Person[pid]["受伤程度"]/10)
		NT = NS*2
	    WAR.Person[WAR.CurID]["生命点数"]=AddPersonAttrib(pid, "生命", XK);
		WAR.Person[WAR.CurID]["内力点数"]=AddPersonAttrib(pid, "内力", NK);
		WAR.Person[WAR.CurID]["体力点数"]=AddPersonAttrib(pid, "体力", NT)
	    AddPersonAttrib(pid, "受伤程度", -NS);
		AddPersonAttrib(pid, "中毒程度", -NS);
		DHdisplay(2681, 2690, "静坐生气");
	end 		
	
    if (wglw1(pid,47) or DT(pid,592)) and WAR.DGJJ_ZJS == 1 then
	    WAR.Person[WAR.CurID]["生命点数"]=AddPersonAttrib(pid, "生命", 150);
		WAR.Person[WAR.CurID]["内力点数"]=AddPersonAttrib(pid, "内力", 500);
		WAR.Person[WAR.CurID]["体力点数"]=AddPersonAttrib(pid, "体力", 9)
	    AddPersonAttrib(pid, "受伤程度", -10);
		AddPersonAttrib(pid, "中毒程度", -10);
		DHdisplay(113, 130, "三增为五化而为九");
	end 		
	
	if MPPD(pid) == 18 and MPDJ(pid) >= 3 and PersonGT(pid,189) then --崆峒堂主
        local a = JY.Person[pid]["拳掌功夫"]
		local b = JY.Person[pid]["特殊兵器"]
		local c = JY.Person[pid]["暗器技巧"]
		local d = a + b + c
		AddPersonAttrib(pid, "生命", d);
		AddPersonAttrib(pid, "内力", d);
		DHdisplay(1380, 1398, "豹隐龟藏");
	end
	
	
	for j = 0, WAR.PersonNum - 1 do --武骧金星：双儿在场时
	  	if DT(WAR.Person[j]["人物编号"], 663) and WAR.Person[j]["死亡"] == false then 
	  		if WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"] then
				return War_DefupMenu()
	  		end	  
	  	end
	end	
	  --高难度，敌人休息会自动蓄力
	  --[[if JY.Thing[202][WZ7] > 1 and not inteam(pid) then
	    if math.modf(JY.Person[pid]["生命最大值"] / 2) < JY.Person[pid]["生命"] then
	      return War_ActupMenu()
	    else
	      return War_DefupMenu()
	    end
	  else
	    return 1
	  end]]
	  return 1
	end
end
function War_StatusMenu()--战斗查看状态
  WAR.ShowHead = 0
  Menu_Status()
  WAR.ShowHead = 1
  Cls()
end
function War_ThingMenu()--战斗物品菜单
  WAR.ShowHead = 0
  local thing = {}
  local thingnum = {}
  for i = 0, CC.MyThingNum - 1 do
    thing[i] = -1
    thingnum[i] = 0
  end
  local num = 0
  for i = 0, CC.MyThingNum - 1 do
    local id = JY.Base["物品" .. i + 1]
    if id >= 0 and (JY.Thing[id]["类型"] == 3 or JY.Thing[id]["类型"] == 4) then
      thing[num] = id
      thingnum[num] = JY.Base["物品数量" .. i + 1]
      num = num + 1
    end
  end
  local r = SelectThing(thing, thingnum)
  Cls()
  local rr = 0
  if r >= 0 and UseThing(r) == 1 then
    rr = 1
  end
  WAR.ShowHead = 1
  Cls()
  return rr
end
function War_ThinkDoctor()--自动战斗判断是否能医疗
  local pid = WAR.Person[WAR.CurID]["人物编号"]
  if JY.Person[pid]["体力"] < 50 or JY.Person[pid]["医疗能力"] < 20 then
    return -1
  end
  if JY.Person[pid]["医疗能力"] + 20 < JY.Person[pid]["受伤程度"] then
    return -1
  end
  local rate = -1
  local v = JY.Person[pid]["生命最大值"] - JY.Person[pid]["生命"]
  if JY.Person[pid]["医疗能力"] < v / 4 then
    rate = 30
  elseif JY.Person[pid]["医疗能力"] < v / 3 then
      rate = 50
  elseif JY.Person[pid]["医疗能力"] < v / 2 then
      rate = 70
  else
    rate = 90
  end
  if Rnd(100) < rate then
    return 5
  end
  return -1
end--能否吃药增加参数
--flag=2 生命，3内力；4体力  6 解毒
function War_ThinkDrug(flag)
  local pid = WAR.Person[WAR.CurID]["人物编号"]
  local str = nil
  local r = -1
  if flag == 2 then
    str = "加生命"
  elseif flag == 3 then
    str = "加内力"
  elseif flag == 4 then
    str = "加体力"
  elseif flag == 6 then
    str = "加中毒解毒"
  else
    return r
  end
  local function Get_Add(thingid)
    if flag == 6 then
      return -JY.Thing[thingid][str]
    else
      return JY.Thing[thingid][str]
    end
  end
  
  --身上是否有药品
  if inteam(pid) and WAR.Person[WAR.CurID]["我方"] == true then
    for i = 1, CC.MyThingNum do
      local thingid = JY.Base["物品" .. i]
      if thingid >= 0 and JY.Thing[thingid]["类型"] == 3 and Get_Add(thingid) > 0 then
        r = flag
        break;
      end
    end
  else
    for i = 1, 4 do
      local thingid = JY.Person[pid]["携带物品" .. i]
      if thingid >= 0 and JY.Thing[thingid]["类型"] == 3 and Get_Add(thingid) > 0 then
        r = flag
        break;
      end
    end
  end
  return r
end--使用暗器
function War_UseAnqi(id)
  return War_ExecuteMenu(4, id)
end--获取战斗数据key
function WARFHS()
  local WF = filelength(CC.WarFile)
  local d = Byte.create(WF)
  Byte.loadfile(d, CC.WarFile, 0, WF)
  local WHS = Byte.hash(d, WF)
  d = Byte.create(1)
  return WHS
end
---
function WarLoad(warid)
  WarSetGlobal()
  local data = Byte.create(CC.WarDataSize)
  Byte.loadfile(data, CC.WarFile, warid * CC.WarDataSize, CC.WarDataSize)
  LoadData(WAR.Data, CC.WarData_S, data)
  WAR.ZDDH = warid
end
--加载战斗地图
function WarLoadMap(mapid)
  lib.Debug(string.format("load war map %d", mapid))
  lib.LoadWarMap(CC.WarMapFile[1], CC.WarMapFile[2], mapid, 6, CC.WarWidth, CC.WarHeight)
end

function GetWarMap(x, y, level)
  if x > 63 or x < 0 or y > 63 or y < 0 then
    return 
  end
  return lib.GetWarMap(x, y, level)
end

function SetWarMap(x, y, level, v)
  if x > 63 or x < 0 or y > 63 or y < 0 then
    return 
  end
  lib.SetWarMap(x, y, level, v)
end

function CleanWarMap(level, v)
  lib.CleanWarMap(level, v)
end--人物按轻功进行排序
function WarPersonSort(flag)
  for i = 0, WAR.PersonNum - 1 do
    local id = WAR.Person[i]["人物编号"]
    local add = 0
    if JY.Person[id]["武器"] > -1 then
      add = add + JY.Thing[JY.Person[id]["武器"]]["加轻功"]
    end
    if JY.Person[id]["防具"] > -1 then
      add = add + JY.Thing[JY.Person[id]["防具"]]["加轻功"]
    end
	if JY.Person[id]["无用15"] > -1 then
      add = add + JY.Thing[JY.Person[id]["无用15"]]["加轻功"]
    end
	add = add + MPAttrib(id, 3)
    WAR.Person[i]["轻功"] = JY.Person[id]["轻功"] + (add)
    if inteam(id) then --我方初始集气增加
		WAR.Person[i]["轻功"] = WAR.Person[i]["轻功"] + math.modf(JY.Person[id]["内力最大值"] / 100)
    else
	    if GetS(0, 0, 0, 0) == 1 then
	      WAR.Person[i]["轻功"] = WAR.Person[i]["轻功"] + math.modf(JY.Person[id]["内力最大值"] / 70) --+ JY.Person[id]["等级"]
	    else
	      WAR.Person[i]["轻功"] = WAR.Person[i]["轻功"] + math.modf(JY.Person[id]["内力最大值"] / 100)
	    end
	end
    for ii,v in pairs(CC.AddSpd) do
      if v[1] == id then
        for wid = 0, WAR.PersonNum - 1 do
          if WAR.Person[wid]["人物编号"] == v[2] and WAR.Person[wid]["死亡"] == false then
            WAR.Person[i]["轻功"] = WAR.Person[i]["轻功"] + v[3]
			if hasTF(id, 129) then
				WAR.Person[i]["轻功"] = WAR.Person[i]["轻功"] + v[3]
			end	
          end
        end
      end
    end
  end
  if flag ~= nil then
    return 
  end
  for i = 0, WAR.PersonNum - 2 do
    local maxid = i
    for j = i, WAR.PersonNum - 1 do
      if WAR.Person[maxid]["轻功"] < WAR.Person[j]["轻功"] then
        maxid = j;
      end
    end
    WAR.Person[maxid], WAR.Person[i] = WAR.Person[i], WAR.Person[maxid]
  end
end--设置人物贴图
function WarSetPerson()
  CleanWarMap(2, -1)
  CleanWarMap(5, -1)
  for i = 0, WAR.PersonNum - 1 do
    if WAR.Person[i]["死亡"] == false then
      SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 2, i)
      SetWarMap(WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"], 5, WAR.Person[i]["贴图"])
    end
  end
end--等待键盘输入
function WSHOW()
  ShowScreen()
  WaitKey()
end
---数据验证和保存
function FRISTWORK()
  local d = Byte.create(466400)
  Byte.loadfile(d, CC.D_Filename[0], 0, 466400)
  if Byte.hash(d, 466400) ~= 131815543 then
  	--lib.Debug("11d= "..Byte.hash(d, 466400));
    --JY.Status = x
  end
  local d = Byte.create(190048)
  Byte.loadfile(d, CC.KDEFFILE, 0, 190048)
  if Byte.hash(d, 190048) ~= -1260270405 then
  	--lib.Debug("11 CC.KDE "..Byte.hash(d, 190048));
    --JY.Status = x
  end
  local d = Byte.create(174230) 
  Byte.loadfile(d, CC.R_GRPFilename[0], 0, 174230)
  if Byte.hash(d, 174230) ~= -1014300560 then
  	
  	--lib.Debug("11 CC.R_GR "..Byte.hash(d, 174230));
    --JY.Status = x
  end
end

function FINALWORK()
  for i = 311, 319 do
    JY.Person[i]["头像代号"] = 214
  end
  if filelength(CC.KDEFFILE) ~= CC.KDEFSIZE then
  	--lib.Debug("11 KDE "..filelength(CC.KDEFFILE));
    --JY.Status = x
    --ZBXS()
  end
  local d = Byte.create(190048)
  Byte.loadfile(d, CC.KDEFFILE, 0, 190048)
  if Byte.hash(d, 190048) ~= -1260270405 then
  	--lib.Debug("11KDEFF "..Byte.hash(d, 190048));
    --JY.Status = x
  end
  JY.MY = JY.Person[0]
  RDEBUG()
  for i = 1, 200 do
    if JY.Base["物品" .. i] == 174 then
      JY.GOLD = JY.Base["物品数量" .. i]
    end
  end
end

function FINALWORK2()

  for i = 1, #TeamP do
    JY.SZJPJC[i] = "" .. GetS(5, i, 6, 5)
  end
  JY.Wugong[201] = {}
  for i,v in pairs(CC.Wugong_S) do
    JY.Wugong[201][i] = JY.Wugong[48][i]
  end
  JY.Wugong[201]["名称"] = CC.EVB204
  JY.Wugong[201]["攻击力10"] = 1800
  for i = 497, 515 do
    JY.Person[i]["武功1"] = 201
  end
  SetS(70, 32, 7, 1, 0)
  SetS(70, 33, 7, 1, 0)
  SetS(70, 29, 7, 1, 0)
  SetS(28, 37, 11, 1, 1)
  SetS(28, 45, 9, 1, 1)
  SetD(12, 22, 2, 0)
  if GetS(10, 0, 17, 0) ~= 1 then
    SetD(83, 48, 4, 0)
  end
  --[[ 武骧金星：萧笑竹一开始不是狂刀
  if putong() == 3 then
    JY.Thing[138]["需内力性质"] = 2
    JY.Thing[138]["名称"] = CC.s50
    JY.Thing[138]["物品说明"] = "无名的绝世刀法" 
    JY.Wugong[64]["名称"] = CC.s51
    for i = 1, 10 do
      JY.Wugong[64]["移动范围" .. i] = 4
      JY.Wugong[64]["杀伤范围" .. i] = 0
    end
    JY.Wugong[64]["攻击范围"] = 3
  end
  --]]
   
  --田伯光指令
	if GetS(86,10,12,5) == 1 then
		GRTS[29] = "浪荡"
    GRTSSAY[29] = "效果：本次攻击有机率打出浪荡招式*条件：体力大于20 内力大于200*消耗：体力10点 内力100点"
  elseif GetS(86,10,12,5) == 2 then
  	GRTS[29] = "戒色"
    GRTSSAY[29] = "效果：本回合气防和集气速度提高，受到伤害减少*条件：体力大于20 内力大于200*消耗：体力10点 内力100点"
	end
	
    JY.Wugong[9999] = {}
    for i,v in pairs(CC.Wugong_S) do
    JY.Wugong[9999][i] = JY.Wugong[106][i]
    end
    JY.Wugong[9999]["名称"] = JY.Thing[224]["名称2"]
	JY.Wugong[9999]["攻击力10"] = 1500
	JY.Wugong[9999]["类型"] = 0
end

function RSDLSJL(s)
  local RSD = math.random(20000) + 10000
  JY.Wugong[34][WZ5] = RSD
  SetS(34, 34, 34, 5, RSD)
  SetD(34, 34, 8, RSD)
  JY.Thing[201][WZ6] = s
  SetS(34, 34, 34, 4, s)
  SetD(34, 33, 8, s)
end

function RSDLSJLJC(s)
  if s ~= 0 then
    local ZB = 0
    if GetS(4, 5, 5, 5) ~= JY.Thing[201][WZ7] then
      ZB = 1
    end
    if JY.Wugong[34][WZ5] ~= GetS(34, 34, 34, 5) then
      ZB = 2
    end
    if JY.Wugong[34][WZ5] ~= GetD(34, 34, 8) then
      ZB = 3
    end
    if JY.Thing[201][WZ6] ~= GetS(34, 34, 34, 4) then
      ZB = 4
    end
    if JY.Thing[201][WZ6] ~= GetD(34, 33, 8) then
      ZB = 5
    end
    if JY.Wugong[34][WZ4] ~= GetS(34, 0, 9, 5) then
      ZB = 6
    end
    if JY.Wugong[34][WZ4] ~= GetD(34, 80, 8) then
      ZB = 7
    end
    if ZB ~= 0 then
      JY.Status = x
    end
  else
    if GetS(34, 34, 34, 5) ~= 0 then
      JY.Status = x
    end
  end
  if GetD(34, 34, 8) ~= 0 then
    JY.Status = x
  end
end

function GCJJL()
  for y = 1, 2 do
    for x = 0, 52 do
      SetS(100, x, y, 5, JY.Scene[x + (y - 1) * 53]["进入条件"])
    end
  end
end

function CSPJC()
	
end

function CSWPJC()
	
end


function CSCJJC()
	
end

function CSWGJC()
	
end

function CSSDJC()
	
end
function ZBXS()
  JY.Status = x
end




--判断触发机率
function myrandom(p, pp)
	if JY.STATUS == GAME_WMAP then
		for i = 0, WAR.PersonNum - 1 do
			local pid = WAR.Person[i]["人物编号"]
			if WAR.Person[i]["死亡"] == false and pid == 76 and inteam(pp) then
			  p = p + 5		--王语嫣+5点
			end
		end
		if DT1(pp,76) then
			p = p + 5
		end
		--旧版逆运走火+40点
		if WAR.tmp[1000 + pp] == 1 then
			p = p + 40
		end
		--新版逆运走火+40点
		if WAR.L_NYZH == 1 or wglw(pid,104) then
			p = p + 40;
		end
	end
	
	if PersonKF(pp, 102) then  --太玄神功+10点
		p = p + 10
	end
	
	p = math.modf(p + JY.Person[pp]["生命最大值"] * 4 / (JY.Person[pp]["生命"] + 20) + JY.Person[pp]["体力"] / 20)		--生命值越低，机率越高
	
	--石破天+10点
	if DT(pp, 38) then
		p = p + 10
	end
	
	--满实战+20点
	local jp = math.modf(JY.Person[pp]["实战"] / 25)
	p = p + jp
	
	--内力值最多+20点
	p = p + limitX(math.modf(JY.Person[pp]["内力"] / 500), 0, 20)
	
	--羞月洛神
	if WAR.XYLS[pp] ~= nil then
		p = p - 10
	end	
	
	if not inteam(pp) then
		p = p + 30
	end
	
	local times = 1
    
	if JY.Person[pp]["资质"] < math.random(120) - 10 then
      times = 2
    end
    if T1LEQ(pp) and juexing() > 1 then --027二次观武后必二次判定
      times = 2
    end
	
	for i = 1, times do
		local bd = math.random(130) + 10
		if bd <= p then
		  return true
		end
	end
	return false
end

--显示武功动画，人物受伤动画，音效等
function War_ShowFight(pid, wugong, wugongtype, level, x, y, eft, ZHEN_ID)
  if not ZHEN_ID then
    ZHEN_ID = -1
  end
  local x0 = WAR.Person[WAR.CurID]["坐标X"]
  local y0 = WAR.Person[WAR.CurID]["坐标Y"]
  
  --令狐冲，扫地老僧  随机动画
  if (wugong == 47 and pid ~= 592) then
    eft = math.random(100)
  end
  
  if NF(pid) and juexing() > 2 then
	eft = math.random(100)
  end 

  if T8LXY(pid) and WAR.LXYYJ > 0 then ----沼跃鱼：李逍遥动画
	eft = 61
  end
  if T8LXY(pid) and WAR.LXYJS == 1 then 
	eft = 46
  end
  
  if MPPD(pid)==13 and WAR.MJZB2[pid] == 1 then 
	eft = 119
  end
  
	if pid == 592 then
		if WAR.L_DGQB_X < 3 then
			eft = 24
		elseif WAR.L_DGQB_X < 5 then
			eft = 48
		elseif WAR.L_DGQB_X < 7 then
			eft = 10
		elseif WAR.L_DGQB_X < 9 then
			eft = 46
		elseif WAR.L_DGQB_X < 10 then
			eft = 62
		else
			eft = 84
		end
	end
  
  if XYL(pid) and yongjian(wugong) then --豸苗：谢云流动画
  eft = 158
  end
  if jtyl(pid) and yongjian(wugong) then --谢无悠
  eft = 158
  end
  if wssz(pid) and yongquan(wugong) then --滕文婷
  eft = 157
  end
  if wssz(pid) and yongdao(wugong) then --滕文婷
  eft = 159
  end
  if MPPD(pid) == 11 and wugong == 131 then
  eft = 158
  end
  if wugong == 49 or wugong == 92 then
	wugongtype = 1
  end
  
  if yongnei(wugong) then
	wugongtype = 1
  end
  
  if wugongtype > 4 then wugongtype = 4 end
  
  --合击动画
  local ZHEN_pid, ZHEN_type, ZHEN_startframe, ZHEN_fightframe = nil, nil, nil, nil
  if ZHEN_ID >= 0 then
    ZHEN_pid = WAR.Person[ZHEN_ID]["人物编号"]
    ZHEN_type = wugongtype
    ZHEN_startframe = 0
    ZHEN_fightframe = 0
  end
  
  local fightdelay, fightframe, sounddelay = nil, nil, nil
  if wugongtype >= 0 then
    fightdelay = JY.Person[pid]["出招动画延迟" .. wugongtype + 1]
    fightframe = JY.Person[pid]["出招动画帧数" .. wugongtype + 1]
    sounddelay = JY.Person[pid]["武功音效延迟" .. wugongtype + 1]
  else
    fightdelay = 0
    fightframe = -1
    sounddelay = -1
  end
  
  if fightdelay == 0 or fightframe == 0 then
    for i = 1, 5 do
      if JY.Person[pid]["出招动画帧数" .. i] ~= 0 then
        fightdelay = JY.Person[pid]["出招动画延迟" .. i]
        fightframe = JY.Person[pid]["出招动画帧数" .. i]
        sounddelay = JY.Person[pid]["武功音效延迟" .. i]
        wugongtype = i - 1
      end
    end
  end
  
  if ZHEN_ID >= 0 then
    if JY.Person[ZHEN_pid]["出招动画帧数" .. ZHEN_type + 1] == 0 then
      for i = 1, 5 do
        if JY.Person[ZHEN_pid]["出招动画帧数" .. i] ~= 0 then
          ZHEN_type = i - 1
          ZHEN_fightframe = JY.Person[ZHEN_pid]["出招动画帧数" .. i]
        end
      end
    else
    	ZHEN_fightframe = JY.Person[ZHEN_pid]["出招动画帧数" .. ZHEN_type + 1]
    end
  end
  
  
  local framenum = fightdelay + CC.Effect[eft]
  local startframe = 0
  if wugongtype >= 0 then
    for i = 0, wugongtype - 1 do
      startframe = startframe + 4 * JY.Person[pid]["出招动画帧数" .. i + 1]
    end
  end
  if ZHEN_ID >= 0 and ZHEN_type >= 0 then
    for i = 0, ZHEN_type - 1 do
      ZHEN_startframe = ZHEN_startframe + 4 * JY.Person[ZHEN_pid]["出招动画帧数" .. i + 1]
    end
  end
  
  local starteft = 0
  for i = 0, eft - 1 do
    starteft = starteft + CC.Effect[i]
  end
  WAR.Person[WAR.CurID]["贴图类型"] = 0
  WAR.Person[WAR.CurID]["贴图"] = WarCalPersonPic(WAR.CurID)
  if ZHEN_ID >= 0 then
    WAR.Person[ZHEN_ID]["贴图类型"] = 0
    WAR.Person[ZHEN_ID]["贴图"] = WarCalPersonPic(ZHEN_ID)
  end
  local fastdraw = nil
  
  if CONFIG.FastShowScreen == 0 or CC.AutoWarShowHead == 1 then
    fastdraw = 0
  else
    fastdraw = 1
  end
  
  local oldpic = WAR.Person[WAR.CurID]["贴图"] / 2		--当前贴图的位置
  local oldpic_type = 0
  local oldeft = -1
  local kfname = JY.Wugong[wugong]["名称"]
  local showsize = 32
  local showx = CC.ScreenW / 2 - showsize * string.len(kfname) / 4
  local hb = GetS(JY.SubScene, x0, y0, 4)
  if CONFIG.Zoom == 1 then
    hb = hb * 2
  end
  
  --显示武功，放到特效文字0
  if wugong ~= 0 then
    if MPPD(pid) == 9 and WAR.TMMS[pid] == 1 and WAR.ACT == 1 and (DT(pid, 93) or yongan(wugong)) then 
       if WAR.DPJ[pid] <= 3 then
	      kfname = "夺魄箭"
	   elseif WAR.DPJ[pid] == 4 then 
	      kfname = "追命箭"
	   end  
	end
    if MPPD(pid) == 9 and WAR.TMMS[pid] == 2 and (DT(pid, 93) or yongan(wugong)) then 
	      kfname = "蚀肌弹" 
	end
	if T3XYK(pid) and WAR.XYKP == 1 then     --雷震九州
      kfname = CC.EVB208
    end
	if DT(600,pid) and WAR.QJSD1 == 1 then     --强极十道
      kfname = CC.EVB209
    end
   if WAR.LHQ_BNZ == 2 then     --般若掌
		kfname = "证果・"..CC.EVB202
	elseif  WAR.LHQ_BNZ == 1 then
		kfname = CC.EVB202
    end
    if WAR.JGZ_DMZ == 2 then
		kfname = "证果・"..CC.EVB203
	elseif WAR.JGZ_DMZ == 1 then     --达摩掌
		kfname = CC.EVB203
    end
	if  WAR.RL == 2 then
		kfname = "证果・"..CC.EVB210
	elseif WAR.RL == 1 then     --达摩掌
		kfname = CC.EVB210
    end
	if WAR.XMS_QSRL == 2 then
		kfname = "证果・"..CC.EVB211
	elseif WAR.XMS_QSRL == 1 then
		kfname = CC.EVB211
	end	
	if WAR.SJHB[pid] == 3 then
		kfname = "玉女素心剑"
	end		
	if WAR.ZBX[pid] ~= nil then
		kfname = "醉・"..kfname
	end
	if MPPD(pid) == 1 and WAR.SYWGZ >= 1 then
		kfname = CC.PSKILL[1][3].."・"..kfname
		if WAR.SYWGZ > 1 then
		kfname = "终极".."・"..kfname
		end
	end
	if T3XYK(pid) and WAR.JUNSHEN > 0 then
		kfname = "血翼・"..kfname
	end
	if WAR.BHBM ~= 0 then  --豸苗：童姥八荒八灭
	kfname = "八荒八灭"
	end
	if DT(pid,164) and ZYJ(pid) and wugong == 18 then
	kfname = "碧针清掌"
	end
	if XYL(pid) and yongjian(wugong) and JY.Person[pid]["声望"] == 180 and juexing() > 1 then
	kfname = WAR.WZTS1[WAR.XYLCZ]--"太虚剑"
	end
	if T9ZY(pid) and wugong == 112 and juexing() > 1 then 
	kfname = "七探蛇盘枪"
	end
	if wugong == 13 and JY.Person[pid]["声望"] == 103 then
		kfname = "龙象般若掌"
	end	
  end
  
 if ZHEN_ID >= 0 then          --合击
  	--kfname = "双人合击・"..kfname
    if WAR.DUIZHAO == 1 and DT(WAR.Person[ZHEN_ID]["人物编号"],27) then
	kfname = "真解・葵花刺目"
	elseif WAR.DUIZHAO == 2 and DT(WAR.Person[ZHEN_ID]["人物编号"],5) then
	kfname = "太极・以静制动"
	elseif WAR.DUIZHAO == 3 and DT(WAR.Person[ZHEN_ID]["人物编号"],114) then
	kfname = "化气・无形气墙"
	elseif WAR.DUIZHAO == 4 and DT(WAR.Person[ZHEN_ID]["人物编号"],50) then
	kfname = "擒龙・九龙护体"	
	elseif WAR.DUIZHAO == 5 and DT(WAR.Person[ZHEN_ID]["人物编号"],597) then
	kfname = "九天一流・格切"
	elseif WAR.DUIZHAO == 6 and DT(WAR.Person[ZHEN_ID]["人物编号"],592) then
	kfname = "独孤・破尽天下"
	elseif WAR.DUIZHAO == 7 and (T1LEQ(WAR.Person[ZHEN_ID]["人物编号"]) and juexing()>1) then
	kfname = "逍遥鹏飞.大鹏逆袭"
	elseif WAR.DUIZHAO == 8 and  (wglw1(WAR.Person[ZHEN_ID]["人物编号"],43) or (DT(WAR.Person[ZHEN_ID]["人物编号"],113) and JX(WAR.Person[ZHEN_ID]["人物编号"]))) then
	kfname = "以彼之道.还施彼身"
	elseif WAR.DUIZHAO == 9 and (DT(WAR.Person[ZHEN_ID]["人物编号"],598) or (T13TQS(WAR.Person[ZHEN_ID]["人物编号"]) and juexing()>2) )then
	kfname = "兽王心经.龙虎啸"
	elseif WAR.DUIZHAO == 10 and DT(WAR.Person[ZHEN_ID]["人物编号"],600) then
	kfname = "强极十道"
	--[[
	elseif WAR.DUIZHAO == 11 and NF(WAR.Person[ZHEN_ID]["人物编号"]) then
	kfname = "风雨江湖・转动乾坤"
	]]
	elseif WAR.DUIZHAO == 12 and BJY(WAR.Person[ZHEN_ID]["人物编号"]) then
	kfname = "道若水兮柔攻坚"
	elseif WAR.DUIZHAO == 13 and wglw(WAR.Person[ZHEN_ID]["人物编号"],43) then
	kfname = "灿若繁星"
	elseif WAR.DUIZHAO == 14 and DT(WAR.Person[ZHEN_ID]["人物编号"],583) then
	kfname = "森罗万道・天罗火道"
	elseif WAR.DUIZHAO == 15 and KHTJF(WAR.Person[ZHEN_ID]["人物编号"]) then
	kfname = "分水・江上弄笛"
	elseif TGLX(WAR.Person[ZHEN_ID]["人物编号"]) then
	kfname = "桃谷六仙.联手"
	elseif WAR.WAWY2 == 1 then
	kfname = "万象真如"
	else
	kfname = "合击・"..kfname
	end
  end
  
  --特效文字0和武功名称显示
	if wugong > 0 then				--使用武功时才显示
		--连锁显示
		if math.max(WAR.URCHAIN, WAR.MYCHAIN) > 1 and WAR.ACT == 1 then
			for i = 15, 30 do					
				NewDrawString(-1, 100, "连锁"..math.max(WAR.URCHAIN, WAR.MYCHAIN).."段", M_DarkOrange, 15 + i)
				ShowScreen();
				if i == 30 then
					Cls();							
					NewDrawString(-1, 100, "连锁"..math.max(WAR.URCHAIN, WAR.MYCHAIN).."段", C_GOLD, 15 + i)
					ShowScreen();
					lib.Delay(500);
				else
					lib.Delay(2);
				end						
			end		
		end
		for i=5, 15 do
			local colorx = C_GOLD
			if WAR.WAWY2 == 1 then
				colorx = M_DeepSkyBlue
			end
		  if WAR.Person[WAR.CurID][CC.TXWZ0] ~= nil then
		  	local n, strs = Split(WAR.Person[WAR.CurID][CC.TXWZ0], "・");
		  	local len = string.len(WAR.Person[WAR.CurID][CC.TXWZ0]);
		  	local color = RGB(255,40,10);
		  	local off = 0;
		  	for j=1, n do
		  		if strs[j] == "连击" then
		  			color = M_DeepSkyBlue;
		  		elseif strs[j] == "左右互搏" then
			  		color = M_DarkOrange
		  		else
		  			color = RGB(255,40,10);
		  		end
		  		if j > 1 then
		  			strs[j] = "・"..strs[j];
		  		end
		  		KungfuString(strs[j], CC.ScreenW / 2 - (n-1)*len*(24+i/2)/8 + off, CC.ScreenH / 2  - hb - 160    , color, 24+i/2, CC.FontName, 0)
		  		off = off + string.len(strs[j])*(24+i/2)/4 + (24+i/2)*3/2;
		  	end
			end 
		
			--武功显示
			KungfuString(kfname, CC.ScreenW / 2 -#kfname/2, CC.ScreenH / 2 - hb - 120  , colorx, 30+i, CC.FontName, 0)
		  ShowScreen()
		  lib.Delay(2)
		  if i == 15 then
		  	Cls()
		  	if WAR.Person[WAR.CurID][CC.TXWZ0] ~= nil then
		  		local n, strs = Split(WAR.Person[WAR.CurID][CC.TXWZ0], "・");
			  	local len = string.len(WAR.Person[WAR.CurID][CC.TXWZ0]);
			  	local color = RGB(255,40,10);
			  	local off = 0;
			  	for j=1, n do
			  		if strs[j] == "连击" then
			  			color = M_DeepSkyBlue;
			  		elseif strs[j] == "左右互搏" then
			  			color = M_DarkOrange
			  		else
		  				color = RGB(255,40,10);
			  		end
			  		if j > 1 then
		  				strs[j] = "・"..strs[j];
		  			end
			  		KungfuString(strs[j], CC.ScreenW / 2 - (n-1)*len*(24+i/2)/8 + off, CC.ScreenH / 2  - hb - 160    , color, 24+i/2, CC.FontName, 0)
			  		off = off + string.len(strs[j])*(24+i/2)/4 + (24+i/2)*3/2;			
			  	end

				end
				--武功显示
				KungfuString(kfname, CC.ScreenW / 2 -#kfname/2, CC.ScreenH / 2 - hb - 120  , colorx, 30+i, CC.FontName, 0)
			  ShowScreen()
			  lib.Delay(300)
		  end
		end
	end
  
  --显示攻击动画
  for i = 0, framenum - 1 do
  lib.GetKey()
    local tstart = (lib.GetTime())
    local mytype = nil
    if fightframe > 0 then
      WAR.Person[WAR.CurID]["贴图类型"] = 1
      mytype = 4 + WAR.CurID
      if i < fightframe then
        WAR.Person[WAR.CurID]["贴图"] = (startframe + WAR.Person[WAR.CurID]["人方向"] * fightframe + i) * 2
      end
    else
      WAR.Person[WAR.CurID]["贴图类型"] = 0
      WAR.Person[WAR.CurID]["贴图"] = WarCalPersonPic(WAR.CurID)
      mytype = 0
    end
    
    if ZHEN_ID >= 0 then
      if ZHEN_fightframe > 0 then
        WAR.Person[ZHEN_ID]["贴图类型"] = 1
        if i < ZHEN_fightframe and i < framenum - 1 then
          WAR.Person[ZHEN_ID]["贴图"] = (ZHEN_startframe + WAR.Person[ZHEN_ID]["人方向"] * ZHEN_fightframe + i) * 2
        else
          WAR.Person[ZHEN_ID]["贴图"] = WarCalPersonPic(ZHEN_ID)
        end
      else
        WAR.Person[ZHEN_ID]["贴图类型"] = 0
        WAR.Person[ZHEN_ID]["贴图"] = WarCalPersonPic(ZHEN_ID)
      end
      SetWarMap(WAR.Person[ZHEN_ID]["坐标X"], WAR.Person[ZHEN_ID]["坐标Y"], 5, WAR.Person[ZHEN_ID]["贴图"])
    end
    
    if i == sounddelay then
      PlayWavAtk(JY.Wugong[wugong]["出招音效"])		--
    end
    
    if i == fightdelay then
      PlayWavE(eft)
    end
    
    if i == 1 and WAR.SSFwav == 1 then
	if JY.Person[pid]["性别"] == 0 then
	PlayWavAtk(32)
	else
		PlayWavAtk(33)
		end
      WAR.SSFwav = 0
    end
    if i == 1 and WAR.LMSJwav == 1 then
	  if JY.Person[pid]["性别"] == 0 then
      PlayWavAtk(31)
	  else
	  PlayWavAtk(46)
	  end
      WAR.LMSJwav = 0
    end
    if i == 1 and WAR.JTYLwav == 1 then 
	   PlayWavAtk(45)
	   WAR.JTYLwav =0
	end
    local pic = WAR.Person[WAR.CurID]["贴图"] / 2
    if fastdraw == 1 then
      local rr = ClipRect(Cal_PicClip(0, 0, oldpic, oldpic_type, 0, 0, pic, mytype))
      if rr ~= nil then
        lib.SetClip(rr.x1, rr.y1, rr.x2, rr.y2)
      end
    else
      lib.SetClip(0, 0, 0, 0)
    end
    oldpic = pic
    oldpic_type = mytype
    
    if i < fightdelay then
      WarDrawMap(4, pic * 2, mytype, -1)
  		
      if i == 1 and WAR.Person[WAR.CurID][CC.TXDH] ~= -1 then
        local theeft = WAR.Person[WAR.CurID][CC.TXDH]
        local sf = 0
        for ii = 0, theeft - 1 do
          sf = sf + CC.Effect[ii]
        end
        local ssid = lib.SaveSur(CC.ScreenW/2 - 5 * CC.XScale, CC.ScreenH/2 - hb - 18 * CC.YScale, CC.ScreenW/2 + 5 * CC.XScale, CC.ScreenH/2 - hb + 5 * CC.YScale)
        for ii = 1, CC.Effect[theeft] do
          --lib.PicLoadCache(3, (sf+ii) * 2, CC.ScreenW/2 , CC.ScreenH/2  - hb, 2, 192)
          lib.PicLoadCache(3, (sf+ii) * 2, CC.ScreenW/2 , CC.ScreenH/2  - hb, 0)
          
          if WAR.Person[WAR.CurID][CC.TXWZ1] ~= nil then
            KungfuString(WAR.Person[WAR.CurID][CC.TXWZ1], CC.ScreenW / 2, CC.ScreenH / 2 - hb, C_RED, 24, CC.FontName, 3)
          end
          if WAR.Person[WAR.CurID][CC.TXWZ2] ~= nil then
            KungfuString(WAR.Person[WAR.CurID][CC.TXWZ2], CC.ScreenW / 2, CC.ScreenH / 2 - hb, C_GOLD, 24, CC.FontName, 2)
          end
          if WAR.Person[WAR.CurID][CC.TXWZ3] ~= nil then
            KungfuString(WAR.Person[WAR.CurID][CC.TXWZ3], CC.ScreenW / 2, CC.ScreenH / 2 - hb, C_WHITE, 24, CC.FontName, 1)
          end
          ShowScreen()
          lib.Delay(30)
          lib.LoadSur(ssid, CC.ScreenW/2 - 5 * CC.XScale, CC.ScreenH/2 - hb - 18 * CC.YScale)
		  
        end
        lib.FreeSur(ssid)
        WAR.Person[WAR.CurID][CC.TXDH] = -1
      else
        if WAR.Person[WAR.CurID][CC.TXWZ1] ~= nil or WAR.Person[WAR.CurID][CC.TXWZ2] ~= nil or WAR.Person[WAR.CurID][CC.TXWZ3] ~= nil then
          KungfuString(WAR.Person[WAR.CurID][CC.TXWZ1], CC.ScreenW / 2, CC.ScreenH / 2 - hb, C_RED, 24, CC.FontName, 3)
          KungfuString(WAR.Person[WAR.CurID][CC.TXWZ2], CC.ScreenW / 2, CC.ScreenH / 2 - hb, C_GOLD, 24, CC.FontName, 2)
          KungfuString(WAR.Person[WAR.CurID][CC.TXWZ3], CC.ScreenW / 2, CC.ScreenH / 2 - hb, C_WHITE, 24, CC.FontName, 1)
          lib.Delay(30)
        end
      end
    else
      starteft = starteft + 1
      if fastdraw == 1 then
        local clip1 = {}
        clip1 = Cal_PicClip(WAR.EffectXY[1][1] - x0, WAR.EffectXY[1][2] - y0, oldeft, 3, WAR.EffectXY[1][1] - x0, WAR.EffectXY[1][2] - y0, starteft, 3)
        local clip2 = {}
        clip2 = Cal_PicClip(WAR.EffectXY[2][1] - x0, WAR.EffectXY[2][2] - y0, oldeft, 3, WAR.EffectXY[2][1] - x0, WAR.EffectXY[2][2] - y0, starteft, 3)
        local clip = ClipRect(MergeRect(clip1, clip2))
        if clip ~= nil then
          local area = (clip.x2 - clip.x1) * (clip.y2 - clip.y1)
          if area < CC.ScreenW * CC.ScreenH / 2 then
            WarDrawMap(4, pic * 2, mytype, (starteft) * 2)
            lib.SetClip(clip.x1, clip.y1, clip.x2, clip.y2)
            WarDrawMap(4, pic * 2, mytype, (starteft) * 2)
          else
            lib.SetClip(0, 0, CC.ScreenW, CC.ScreenH)
            WarDrawMap(4, pic * 2, mytype, (starteft) * 2)
          end
        else
          WarDrawMap(4, pic * 2, mytype, (starteft) * 2)
        end
      else
        lib.SetClip(0, 0, 0, 0)
        WarDrawMap(4, pic * 2, mytype, (starteft) * 2)
      end
      
      oldeft = starteft
    end

    ShowScreen(fastdraw)
    lib.SetClip(0, 0, 0, 0)
    local tend = lib.GetTime()
    if tend - tstart < 1 * CC.Frame then
      lib.Delay(1 * CC.Frame - (tend - tstart))
    end
  end
  
  lib.SetClip(0, 0, 0, 0)
  WAR.Person[WAR.CurID]["贴图类型"] = 0
  WAR.Person[WAR.CurID]["贴图"] = WarCalPersonPic(WAR.CurID)
  WarSetPerson()
  WarDrawMap(0)
  ShowScreen()
  lib.Delay(200)
  WarDrawMap(2)
  ShowScreen()
  lib.Delay(200)
  WarDrawMap(0)
  ShowScreen()
  
  --计算攻击到的人
  local HitXY = {}
  local HitXYNum = 0
  local hnum = 16;		--HitXY的长度个数
  for i = 0, WAR.PersonNum - 1 do
    local x1 = WAR.Person[i]["坐标X"]
    local y1 = WAR.Person[i]["坐标Y"]
	local tmppid = WAR.Person[i]["人物编号"]
    if WAR.Person[i]["死亡"] == false and (GetWarMap(x1, y1, 4) > 1 or WAR.XNXS[WAR.Person[i]["人物编号"]] == 1) then
      SetWarMap(x1, y1, 4, 1)
      --local n = WAR.Person[i]["点数"]
      local hp = WAR.Person[i]["生命点数"];
      local mp = WAR.Person[i]["内力点数"];
      local tl = WAR.Person[i]["体力点数"];
      local ed = WAR.Person[i]["中毒点数"];
	  local fx = WAR.FXDS[WAR.Person[i]["人物编号"]]--12-28
	  local lx = WAR.LXZT[WAR.Person[i]["人物编号"]]
	  local ch = WAR.CHZ[WAR.Person[i]["人物编号"]]
	  local bf = WAR.ICE[WAR.Person[i]["人物编号"]]
	  local zs = WAR.HOT[WAR.Person[i]["人物编号"]]
	  local mb = WAR.MABI[WAR.Person[i]["人物编号"]]
	  local kx = WAR.Person[i]["真伤点数"];
	  
	  if PersonGT(tmppid, 108) then --易筋经免疫毒
		ed = 0
	  end
	  
      local dd = WAR.Person[i]["解毒点数"];
      local ns = WAR.Person[i]["内伤点数"];
	  local ns1 = JY.Person[WAR.Person[i]["人物编号"]]["受伤程度"];
      
	  if getHZ(tmppid, 9) and WAR.CSF[i] ~= nil then --长生印显示
		hp = WAR.CSF[i]
		WAR.CSF[i] = nil
	  end
	  
      HitXY[HitXYNum] = {x1, y1, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil, nil};		--x, y, 生命, 内力, 体力, 封穴, 流血, 中毒, 解毒, 内伤, 迟缓 冰封 灼烧 麻痹

		if hp ~= nil then
	      if hp == 0 then			--显示受到的生命
	      	if WAR.JG[tmppid] ~= nil then
				HitXY[HitXYNum][3] = "0";
			elseif JY.Person[tmppid]["生命"] < 1 then
				HitXY[HitXYNum][3] = "死"
			else
				HitXY[HitXYNum][3] = "miss";
			end
	      elseif hp > 0 then
	      	HitXY[HitXYNum][3] = "+"..hp;
	      else
	      	HitXY[HitXYNum][3] = ""..hp;
	      end
	    end
      
      
      if mp ~= nil then			--显示内力变化
      	if mp > 0 then
      		HitXY[HitXYNum][4] = "+"..mp;
      	elseif mp ==  0 then
      		HitXY[HitXYNum][4] = nil;			--变化为0时不显示
      	else
      		HitXY[HitXYNum][4] = ""..mp;
      	end
      end
      
		
      if tl ~= nil then			--显示体力变化
      	if tl > 0 then
      		HitXY[HitXYNum][5] = "体+"..tl;
      	elseif tl == 0 then
      		HitXY[HitXYNum][5] = nil;
      	else
      		HitXY[HitXYNum][5] = "体"..tl;
      	end
      end
      
      if WAR.FXXS[WAR.Person[i]["人物编号"]] == 1 then			--显示是否封穴12-28
	    if fx == nil then 
		HitXY[HitXYNum][6] = nil 
		else
       	if fx >= 0 then
		HitXY[HitXYNum][6] = "封穴+"..fx;
		else
		HitXY[HitXYNum][6] = "封穴"..fx;
		end
       	WAR.FXXS[WAR.Person[i]["人物编号"]] = 0
		end
      end
      
      if WAR.LXXS[WAR.Person[i]["人物编号"]] == 1 then		--显示是否被流血12-28
	    if lx == nil then 
		HitXY[HitXYNum][7] = nil 
		else
			if lx >= 0 then
			HitXY[HitXYNum][7] = "流血+"..lx
			else
			HitXY[HitXYNum][7] = "流血"..lx
			end
        WAR.LXXS[WAR.Person[i]["人物编号"]] = 0
		end
      end
      
      
      if ed ~= nil then				--显示中毒
      	if ed == 0 then
      		HitXY[HitXYNum][8] = nil;
      	elseif ed > 0 then
      		HitXY[HitXYNum][8] = "中毒+"..ed;
		else	
		    HitXY[HitXYNum][8] = "中毒"..ed;
      	end
      end
      
      if dd ~= nil then			--显示解毒
      	if dd  == 0 then
      		HitXY[HitXYNum][9] = nil;
      	else
      		HitXY[HitXYNum][9] = "解毒-"..dd;
      	end
      end
      
      if ns ~= nil then		--显示内伤
      	if ns == 0 then
      		HitXY[HitXYNum][10] = nil;
      	elseif ns > 0 then
      		HitXY[HitXYNum][10] = "内伤+"..ns1
      	else
      		HitXY[HitXYNum][10] = "内伤"..ns
      	end
      end
	  
      if WAR.CHXS[WAR.Person[i]["人物编号"]] == 1 then		 --显示迟缓
	    if ch == nil then 
		HitXY[HitXYNum][11] = nil 
		else
			if ch >= 0 then
			HitXY[HitXYNum][11] = "迟缓+"..ch
			else
			HitXY[HitXYNum][11] = "迟缓"..ch
			end
        WAR.CHXS[WAR.Person[i]["人物编号"]] = 0
		end
      end
      
      if WAR.ICEXS[WAR.Person[i]["人物编号"]] == 1 then		 --显示
	    if bf == nil then 
		HitXY[HitXYNum][12] = nil 
		else
      	if bf >= 0 then
		HitXY[HitXYNum][12] = "冰封+"..bf
		else
		HitXY[HitXYNum][12] = "冰封"..bf
		end
        WAR.ICEXS[WAR.Person[i]["人物编号"]] = 0
		end
      end	  

      if WAR.HOTXS[WAR.Person[i]["人物编号"]] == 1 then		 --显示灼烧
	    if zs == nil then 
		HitXY[HitXYNum][13] = nil 
		else
			if zs >= 0 then
			HitXY[HitXYNum][13] = "灼烧+"..zs
			else
			HitXY[HitXYNum][13] = "灼烧"..zs
			end
        WAR.HOTXS[WAR.Person[i]["人物编号"]] = 0
		end
      end
	  if WAR.MBXS[WAR.Person[i]["人物编号"]] == 1 then		 --显示麻痹
	    if mb == nil then 
		HitXY[HitXYNum][14] = nil 
		else
			if mb >= 0 then
			HitXY[HitXYNum][14] = "麻痹+"..mb
			else
			HitXY[HitXYNum][14] = "麻痹"..mb
			end
			WAR.MBXS[WAR.Person[i]["人物编号"]] = 0
		end
      end	
	  if kx == nil then
		HitXY[HitXYNum][15] = nil
	  elseif kx ~= nil then --真实伤害
		if kx > 0 then
			HitXY[HitXYNum][15] = "血量+"..kx;
		elseif kx == 0 then
			HitXY[HitXYNum][15] = nil
		elseif kx < 0 then
			HitXY[HitXYNum][15] = "血量"..kx;
		end
	  end	
	  
      HitXYNum = HitXYNum + 1
    end
    
    --偷东西，斗转 - -
    if WAR.TD > -1 then
      if WAR.TD == 118 then
        say("哈哈哈－－－，想偷我的斗转星移？没门儿！要想得斗转下次就乖乖跟我合作吧！", 51)
      else
        instruct_2(WAR.TD, 1)
      end
      WAR.TD = -1
    end
  end
  
  local TP = 0
  local TPXS = {}
  for i = 0, WAR.PersonNum - 1 do
    if WAR.Person[i][CC.TXDH] ~= -1 then
      TP = TP + 1
      TPXS[i] = TP
    end
  end
  if TP ~= 0 then
    TP = math.modf(20 / (TP))
  end
  
  local minx = CC.ScreenW;
  local maxx = 0;
  local miny = CC.ScreenH;
  local maxy = 0;
  for i = 0, WAR.PersonNum - 1 do
  	if WAR.Person[i]["死亡"] == false  then
  		local dx = WAR.Person[i]["坐标X"] - x
      local dy = WAR.Person[i]["坐标Y"] - y
      local rx = CC.XScale * (dx - dy) + CC.ScreenW / 2
      local ry = CC.YScale * (dx + dy) + CC.ScreenH / 2 - hb
      
      if rx > 0 and rx < minx then
      	minx = rx;
      end
      if rx > 0 and rx > maxx and rx <= CC.ScreenW then
      	maxx = rx;
      end
      
      if ry > 0 and ry < miny then
      	miny = ry;
      end
      if ry > 0 and ry > maxy and ry <= CC.ScreenH then
      	maxy = ry;
      end
  	end
  end
 
  minx = limitX(minx - 10 * CC.XScale, 0, CC.ScreenW);
  maxx = limitX(maxx + 10 * CC.XScale, 0, CC.ScreenW);
  miny = limitX(miny - 18 * CC.YScale, 0, CC.ScreenH);
  maxy = limitX(maxy + 5 * CC.YScale, 0, CC.ScreenH);
  
  local sssid = lib.SaveSur(minx, miny, maxx, maxy)
  --显示特效文字
  for ii = 1, 20 do
    local yanshi = false
    local yanshi2 = false		--无动画时的延迟
    for i = 0, WAR.PersonNum - 1 do
    	if WAR.Person[i]["死亡"] == false then
	      local theeft = WAR.Person[i][CC.TXDH]
	      if theeft ~= -1 and ii < CC.Effect[theeft] then
	        local dx = WAR.Person[i]["坐标X"] - x0
	        local dy = WAR.Person[i]["坐标Y"] - y0
	        local rx = CC.XScale * (dx - dy) + CC.ScreenW / 2
	        local ry = CC.YScale * (dx + dy) + CC.ScreenH / 2
	        starteft = ii
	        for i = 0, WAR.Person[i][CC.TXDH] - 1 do
	          starteft = starteft + CC.Effect[i]
	        end
	        local hb = GetS(JY.SubScene, dx + x0, dy + y0, 4)
	        if CONFIG.Zoom == 1 then
	          hb = hb * 2
	        end
	        ry = ry - hb
	        --lib.PicLoadCache(3, (starteft) * 2, rx, ry, 2, 192)
			lib.PicLoadCache(3, (starteft) * 2, rx, ry, 0)
	        if ii < TPXS[i] * TP and (TPXS[i] - 1) * TP < ii then	
		        KungfuString(WAR.Person[i][CC.TXWZ1], rx, ry, C_WHITE, 24, CC.FontName, 1)
		        KungfuString(WAR.Person[i][CC.TXWZ2], rx, ry, C_GOLD, 24, CC.FontName, 2)
		        KungfuString(WAR.Person[i][CC.TXWZ3], rx, ry, C_RED, 24, CC.FontName, 3)
		        KungfuString(WAR.Person[i][CC.TXWZ0], rx, ry, C_WHITE, 24, CC.FontName, 4)
				KungfuString(WAR.Person[i][CC.TXWZ4], rx, ry, C_ORANGE, 26, CC.FontName, 5)
		        yanshi = true
	      	end
	      else
	      	--蓝烟清： 修正无动画时不显示文字的BUG
	      	if i~= WAR.CurID and theeft == -1 and ((WAR.Person[i][CC.TXWZ1] ~= nil and WAR.Person[i][CC.TXWZ1] ~= "  ") or (WAR.Person[i][CC.TXWZ2] ~= nil and WAR.Person[i][CC.TXWZ2] ~= "  ")  or (WAR.Person[i][CC.TXWZ3] ~= nil and WAR.Person[i][CC.TXWZ3] ~= "  ")  or (WAR.Person[i][CC.TXWZ0] ~= nil and WAR.Person[i][CC.TXWZ0] ~= "  ") or (WAR.Person[i][CC.TXWZ4] ~= nil and WAR.Person[i][CC.TXWZ4] ~= "  ")) then
	          local dx = WAR.Person[i]["坐标X"] - x0
	        	local dy = WAR.Person[i]["坐标Y"] - y0
	        	local rx = CC.XScale * (dx - dy) + CC.ScreenW / 2
	        	local ry = CC.YScale * (dx + dy) + CC.ScreenH / 2
		        local hb = GetS(JY.SubScene, dx + x0, dy + y0, 4)
		        if CONFIG.Zoom == 1 then
		          hb = hb * 2
		        end
		        ry = ry - hb
		        
	          KungfuString(WAR.Person[i][CC.TXWZ1], rx, ry, C_WHITE, 24, CC.FontName, 1)
		        KungfuString(WAR.Person[i][CC.TXWZ2], rx, ry, C_GOLD, 24, CC.FontName, 2)
		        KungfuString(WAR.Person[i][CC.TXWZ3], rx, ry, C_RED, 24, CC.FontName, 3)
		        KungfuString(WAR.Person[i][CC.TXWZ0], rx, ry, C_WHITE, 24, CC.FontName, 4)
				KungfuString(WAR.Person[i][CC.TXWZ4], rx, ry, C_ORANGE, 26, CC.FontName, 5)
	          yanshi2 = true
		      end
	      end
	    end
    end
    if yanshi then
      lib.ShowSurface(0)
      lib.LoadSur(sssid, minx, miny)
      lib.Delay(30)
    elseif yanshi2 then
      lib.ShowSurface(0)
      lib.LoadSur(sssid, minx, miny)
      lib.Delay(1)
    end
  end
  lib.FreeSur(sssid)
  
  --显示受伤点数
  if HitXYNum > 0 then
    local clips = {}
    for i = 0, HitXYNum - 1 do
      local dx = HitXY[i][1] - x0
      local dy = HitXY[i][2] - y0
      local hb = GetS(JY.SubScene, HitXY[i][1], HitXY[i][2], 4)		--点数效果存在战场的第四层数据
      
      if CONFIG.Zoom == 1 then
        hb = hb * 2
      end
      
      local ll = 4;
      for y=3, hnum do
      	if HitXY[i][y] ~= nil then
      		ll = string.len(HitXY[i][y]);
      		break;
      	end
      end
      local w = ll * CC.DefaultFont / 2 + 1
      clips[i] = {x1 = CC.XScale * (dx - dy) + CC.ScreenW / 2, y1 = CC.YScale * (dx + dy) + CC.ScreenH / 2 - hb, x2 = CC.XScale * (dx - dy) + CC.ScreenW / 2 + w, y2 = CC.YScale * (dx + dy) + CC.ScreenH / 2 + CC.DefaultFont + 1}
    end
    
    local clip = clips[0]
    for i = 1, HitXYNum - 1 do
      clip = MergeRect(clip, clips[i])
    end
    
    local area = (clip.x2 - clip.x1) * (clip.y2 - clip.y1)		--绘画的范围
    local surid = lib.SaveSur(minx, miny, maxx, maxy)		--绘画句柄
    
    --显示点数
    for y = 3, hnum do
    	local flag = false;
      for i = 5, 15 do
        local tstart = lib.GetTime()
        local y_off = i * 2 + 65
        
        if fastdraw == 1 and area < CC.ScreenW * CC.ScreenH / 2 then
          local tmpclip = {x1 = clip.x1, y1 = clip.y1 - y_off, x2 = clip.x2, y2 = clip.y2 - y_off}
          tmpclip = ClipRect(tmpclip)
          if tmpclip ~= nil then
            lib.SetClip(tmpclip.x1, tmpclip.y1, tmpclip.x2, tmpclip.y2)
            WarDrawMap(0)
            for j = 0, HitXYNum - 1 do
            	if HitXY[j][y] ~= nil then
            		local c = y - 1;
            		if y == 3 and string.sub(HitXY[j][y],1,1) == "-" then
	          			local cr = 250;
	          			local cg = 250;
	          			local cb = 30;
	          			if HitXY[j][10] ~= nil and HitXY[j][10] > 0 then
	          				cg = cg - HitXY[j][10]

	          			end
	          			DrawString(clips[j].x1 - string.len(HitXY[j][y])*CC.DefaultFont/4, clips[j].y1 - y_off, HitXY[j][y], RGB(cr, cg, cb), CC.DefaultFont)
	          		else
	          			DrawString(clips[j].x1 - string.len(HitXY[j][y])*CC.DefaultFont/4, clips[j].y1 - y_off, HitXY[j][y], WAR.L_EffectColor[c], CC.DefaultFont)
	          		end
            		flag = true;
            	end 
            end
          end
        else
          lib.SetClip(0, 0, CC.ScreenW, CC.ScreenH)
          lib.LoadSur(surid, minx, miny)
          for j = 0, HitXYNum - 1 do
          	if HitXY[j][y] ~= nil then   		
          		local c = y - 1;
          		if y == 3 and string.sub(HitXY[j][y],1,1) == "-" then
          			local cr = 250;
          			local cg = 250;
          			local cb = 30;
          		--	if HitXY[j][10] ~= nil then
          		--		cg = cg - HitXY[j][10]
          		--	end
          			DrawString(clips[j].x1 - string.len(HitXY[j][y])*CC.DefaultFont/4, clips[j].y1 - y_off, HitXY[j][y], RGB(cr, cg, cb), CC.DefaultFont)
          		else
          			DrawString(clips[j].x1 - string.len(HitXY[j][y])*CC.DefaultFont/4, clips[j].y1 - y_off, HitXY[j][y], WAR.L_EffectColor[c], CC.DefaultFont)
          		end
          		
          		flag = true;
          	end
          end
        end
        if flag then
	        ShowScreen(1)
	        lib.SetClip(0, 0, 0, 0)
	        local tend = lib.GetTime()
	        if tend - tstart < CC.Frame then
	          lib.Delay(CC.Frame - (tend - tstart))
	        end
	      end
      end
    end
    lib.FreeSur(surid)
  end

  --清除点数
  for i = 0, HitXYNum - 1 do
    local id = GetWarMap(HitXY[i][1], HitXY[i][2], 2);
    WAR.Person[id]["生命点数"] = nil;
    WAR.Person[id]["内力点数"] = nil;
    WAR.Person[id]["体力点数"] = nil;
    WAR.Person[id]["中毒点数"] = nil;
    WAR.Person[id]["解毒点数"] = nil;
    WAR.Person[id]["内伤点数"] = nil;
	WAR.Person[id]["真伤点数"] = nil;
  end
  
  --清除特效文字
  for i = 0, WAR.PersonNum - 1 do
    WAR.Person[i][CC.TXDH] = -1
    WAR.Person[i][CC.TXWZ0] = nil
    WAR.Person[i][CC.TXWZ1] = nil
    WAR.Person[i][CC.TXWZ2] = nil
    WAR.Person[i][CC.TXWZ3] = nil
	WAR.Person[i][CC.TXWZ4] = nil
  end
  lib.SetClip(0, 0, 0, 0)
  WarDrawMap(0)
  ShowScreen()
end

--药品使用实际效果
--id 物品id，
--personid 使用人id
--返回值：0 使用没有效果，物品数量应该不变。1 使用有效果，则使用后物品数量应该-1
function UseThingEffect(id, personid)
  local str = {}
  str[0] = string.format("使用 %s", JY.Thing[id]["名称"])
  local strnum = 1
  local addvalue = nil
  if JY.Thing[id]["加生命"] > 0 then
    local add = JY.Thing[id]["加生命"] - math.modf(JY.Thing[id]["加生命"] * JY.Person[personid]["受伤程度"] / 200) + Rnd(5)
    
    --胡青牛在队，吃药效果为1.3倍
    if JY.Status == GAME_WMAP and inteam(personid) and inteam(16) then
      for w = 0, WAR.PersonNum - 1 do
        if WAR.Person[w]["人物编号"] == 16 and WAR.Person[w]["死亡"] == false and WAR.Person[w]["我方"] then
          add = math.modf(add * 1.3)
        end
      end
    end
    if JY.Status == GAME_WMAP and inteam(personid) and hasSK(45) then
      for w = 0, WAR.PersonNum - 1 do
        if WAR.Person[w]["人物编号"] == 0 and WAR.Person[w]["死亡"] == false and WAR.Person[w]["我方"] then
          add = math.modf(add * 1.3)
        end
      end
    end	
	if DT(personid, 616) then
		add = add * 2
	end
	if PersonKF(personid,197) then --逍遥游吃吃喝喝
		add = add *2
	end	
    if add <= 0 then
      add = 5 + Rnd(5)
    end
    add = math.modf(add)
    
    if JY.Status == GAME_WMAP then
	    if inteam(personid) then
	      WAR.Person[WAR.CurID]["内伤点数"] = AddPersonAttrib(personid, "受伤程度", -math.modf(add / 10))
	    else
	      WAR.Person[WAR.CurID]["内伤点数"] = AddPersonAttrib(personid, "受伤程度", -math.modf(add / 4))
	    end
	  end
	  --敌人吃药效果加倍
	  if not inteam(personid) then
	  	add = add * 2;
	  end
    addvalue, str[strnum] = AddPersonAttrib(personid, "生命", add)
    
    --蓝烟清：显示生命点数
    if JY.Status == GAME_WMAP then
    	WAR.Person[WAR.CurID]["生命点数"] = addvalue;
    end

    if addvalue ~= 0 then
    	strnum = strnum + 1
  	end
  end
  
  local function ThingAddAttrib(s)
    if JY.Thing[id]["加" .. s] ~= 0 then
		local tmpadd = JY.Thing[id]["加" .. s]
		if DT(personid, 616) then
			tmpadd = tmpadd * 2
		end
		if PersonKF(personid,197) then --逍遥游吃吃喝喝
			tmpadd = tmpadd * 1.5
		end	
      addvalue, str[strnum] = AddPersonAttrib(personid, s, tmpadd)
      if addvalue ~= 0 then
      	strnum = strnum + 1
    	end
    	
    	--蓝烟清：显示体力，内力点数
    	if JY.Status == GAME_WMAP then
  			if s == "体力" then
  				WAR.Person[WAR.CurID]["体力点数"] = addvalue;
  			elseif s == "内力" then
  				WAR.Person[WAR.CurID]["内力点数"] = addvalue;
  			end
  		end
    end
  end
  
  ThingAddAttrib("生命最大值")
  
  if JY.Thing[id]["加中毒解毒"] < 0 then
    addvalue, str[strnum] = AddPersonAttrib(personid, "中毒程度", math.modf(JY.Thing[id]["加中毒解毒"] / 2))
  	if addvalue ~= 0 then
    	strnum = strnum + 1
 		end
 		
 		--蓝烟清：显示中解毒点数
    if JY.Status == GAME_WMAP then
	 		if addvalue < 0 then
	 			WAR.Person[WAR.CurID]["解毒点数"] = -addvalue;
	 		elseif addvalue > 0 then
	 			WAR.Person[WAR.CurID]["中毒点数"] = addvalue;
	 		end
	 	end
  end
  
  ThingAddAttrib("体力")
  
  if JY.Person[personid]["内力性质"] ~= 3 then
	  if JY.Thing[id]["改变内力性质"] == 2 then
		JY.Person[personid]["内力性质"] = 2
		str[strnum] = "内力门路转为阴阳合一"
		strnum = strnum + 1
	  end
	  if JY.Thing[id]["改变内力性质"] == 3 then
		JY.Person[personid]["内力性质"] = 0
		str[strnum] = "内力门路转为阴性"
		strnum = strnum + 1	
	  elseif JY.Thing[id]["改变内力性质"] == 4 then
		JY.Person[personid]["内力性质"] = 1
		str[strnum] = "内力门路转为阳性"
		strnum = strnum + 1	
	  end
  end

  ThingAddAttrib("内力")
  ThingAddAttrib("内力最大值")
  ThingAddAttrib("攻击力")
  ThingAddAttrib("防御力")
  ThingAddAttrib("轻功")
  ThingAddAttrib("医疗能力")
  ThingAddAttrib("用毒能力")
  ThingAddAttrib("解毒能力")
  ThingAddAttrib("抗毒能力")
  ThingAddAttrib("拳掌功夫")
  ThingAddAttrib("御剑能力")
  ThingAddAttrib("耍刀技巧")
  ThingAddAttrib("特殊兵器")
  ThingAddAttrib("暗器技巧")
  ThingAddAttrib("武学常识")
  ThingAddAttrib("攻击带毒")
  
  if strnum > 1 then
    local maxlength = 0
    for i = 0, strnum-1 do
      if maxlength < #str[i] then
        maxlength = #str[i]
      end
    end
    Cls()
    
    if JY.Status ~= GAME_WMAP then
	    local ww = maxlength * CC.DefaultFont / 2 + CC.MenuBorderPixel * 2
	    local hh = (strnum) * CC.DefaultFont + (strnum - 1) * CC.RowPixel + 2 * CC.MenuBorderPixel
	    local x = (CC.ScreenW - ww) / 2
	    local y = (CC.ScreenH - hh) / 2
	    DrawBox(x, y, x + ww, y + hh, C_WHITE)
	    DrawString(x + CC.MenuBorderPixel, y + CC.MenuBorderPixel, str[0], C_WHITE, CC.DefaultFont)
	    for i = 1, strnum - 1 do
	      DrawString(x + CC.MenuBorderPixel, y + CC.MenuBorderPixel + (CC.DefaultFont + CC.RowPixel) * i, str[i], C_ORANGE, CC.DefaultFont)
	    end
	    ShowScreen()
	  else
	  
	  	--显示使用物品文字
	  	DrawString(CC.MainMenuX, CC.MainMenuY + 490, JY.Person[WAR.Person[WAR.CurID]["人物编号"]]["姓名"].." "..str[0], C_WHITE, CC.Fontsmall - 5);
	  	for i=1, strnum-1 do 
	  		DrawString(CC.MainMenuX, CC.MainMenuY + 490 + i*25, str[i], C_WHITE, CC.Fontsmall - 5);
	  	end
	  	
	  	ShowScreen()
	  	--显示点数
	  	War_Show_Count(WAR.CurID);
	  	return 1;
	  end
    
    
    return 1
  else
    DrawStrBox(-1, -1, str[0], C_WHITE, 30)
    ShowScreen()
    return 1
  end
end

--计算医疗量
--id1 医疗id2, 返回id2生命增加点数
function ExecDoctor(id1, id2)
  if JY.Person[id1]["体力"] < 50 then
    return 0
  end
  local add = JY.Person[id1]["医疗能力"] 
  local value = JY.Person[id2]["受伤程度"]
  if add + 20 < value then
    return 0
  end
  
  -- 平一指，医疗量和杀人数有关
  if id1 == 28 and JY.Status == GAME_WMAP then
    add = math.modf(JY.Person[id1]["医疗能力"] * (1 + WAR.PYZ / 10))
  end
  
  --战斗状态的医疗
  --程灵素对胡斐有额外120点，胡青牛和王难姑互加额外50
  if JY.Status == GAME_WMAP then
    for i,v in pairs(CC.AddDoc) do
      if v[1] == id1 then
        for wid = 0, WAR.PersonNum - 1 do
          if WAR.Person[wid]["人物编号"] == v[2] and WAR.Person[wid]["死亡"] == false then
            add = add + v[3]
          end
        end
      end
    end
  end
  
  add = add + MPAttrib(id1, 4)
  
  add = add - (add) * value / 200
  add = math.modf(add) + Rnd(5)
  if JY.Status == GAME_WMAP then --玄一无相
     if WAR.XYWX[100+id2] ~= nil then 
	    add = math.modf(add/2)
	 end
  end	 
  local n = AddPersonAttrib(id2, "受伤程度", -math.modf((add) / 10))
  --蓝烟清：医疗时显示内伤减少
  if JY.Status == GAME_WMAP then
	  local p = -1;
	  for wid = 0, WAR.PersonNum - 1 do
	    if WAR.Person[wid]["人物编号"] == id2 and WAR.Person[wid]["死亡"] == false then
	      p = wid;
	      break;
	    end
	  end
	  WAR.Person[p]["内伤点数"] = n;
	end
  
	if hasTF(id2, 128) and add > 0 then
		AddPersonAttrib(id1, "生命", math.modf(add * 0.5))
	end
  
  return AddPersonAttrib(id2, "生命", add)
end

---执行医疗，解毒用毒暗器的子函数，自动医疗也可调用
--新函数
function War_ExecuteMenu_Sub(x1, y1, flag, thingid)
  local pid = WAR.Person[WAR.CurID]["人物编号"]
  local x0 = WAR.Person[WAR.CurID]["坐标X"]
  local y0 = WAR.Person[WAR.CurID]["坐标Y"]
  CleanWarMap(4, 0)
  WAR.Person[WAR.CurID]["人方向"] = War_Direct(x0, y0, x1, y1)
  SetWarMap(x1, y1, 4, 1)
  local emeny = GetWarMap(x1, y1, 2)
  if emeny >= 0 then
	  if flag == 1 and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emeny]["我方"] then
	    WAR.Person[emeny]["中毒点数"] = War_PoisonHurt(pid, WAR.Person[emeny]["人物编号"])
		if DT(pid, 17) then WAR.Person[emeny].Time = math.max(WAR.Person[emeny].Time - WAR.Person[emeny]["中毒点数"] * 5, -500) end --武骧金星：王难姑用毒
		if MPPD(pid) == 1 then
			WAR.Person[emeny]["生命点数"] = -math.modf(WAR.Person[emeny]["中毒点数"])
			JY.Person[WAR.Person[emeny]["人物编号"]]["生命"] = JY.Person[WAR.Person[emeny]["人物编号"]]["生命"] 
				- math.modf(WAR.Person[emeny]["中毒点数"])
			if JY.Person[WAR.Person[emeny]["人物编号"]]["生命"] <= 0 then
				JY.Person[WAR.Person[emeny]["人物编号"]]["生命"] = 1
			end		
		end
	    SetWarMap(x1, y1, 4, 5)
	    WAR.Effect = 5
		if MPPD(pid) == 1 then
			for ex = x1 - 4, x1 + 4 do
				for ey = y1 - 4, y1 + 4 do
					if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
						local ep = GetWarMap(ex, ey, 2)
						if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[ep]["我方"] and ep ~= emeny then
							if JLSD(10, 70 + tianshu(), pid) then
								SetWarMap(ex, ey, 4, 5)
								WAR.Person[ep]["中毒点数"] = War_PoisonHurt(pid, WAR.Person[ep]["人物编号"])
								WAR.Person[ep]["生命点数"] = -math.modf(WAR.Person[ep]["中毒点数"])
								JY.Person[WAR.Person[ep]["人物编号"]]["生命"] = JY.Person[WAR.Person[ep]["人物编号"]]["生命"] 
									- WAR.Person[ep]["生命点数"]
								if JY.Person[WAR.Person[ep]["人物编号"]]["生命"] <= 0 then
									JY.Person[WAR.Person[ep]["人物编号"]]["生命"] = 1
								end
							end
						end
					end
				end
			end
		end
	  elseif flag == 2 and WAR.Person[WAR.CurID]["我方"] == WAR.Person[emeny]["我方"] then
	    WAR.Person[emeny]["解毒点数"] = ExecDecPoison(pid, WAR.Person[emeny]["人物编号"])
	    SetWarMap(x1, y1, 4, 6)
	    WAR.Effect = 6
	  elseif flag == 3 then
	    if WAR.Person[WAR.CurID]["人物编号"] == 0 and putong() == 7 then
	      
	    elseif WAR.Person[WAR.CurID]["我方"] == WAR.Person[emeny]["我方"] then
	      WAR.Person[emeny]["生命点数"] = ExecDoctor(pid, WAR.Person[emeny]["人物编号"])
	      SetWarMap(x1, y1, 4, 4)
	      WAR.Effect = 4
	    end
	  elseif flag == 4 and WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[emeny]["我方"] then
	    WAR.Person[emeny]["生命点数"] = War_AnqiHurt(pid, WAR.Person[emeny]["人物编号"], thingid)
	    SetWarMap(x1, y1, 4, 2)
	    WAR.Effect = 2
	  end
  end
  --主角医生方阵医疗
  if flag == 3 and WAR.Person[WAR.CurID]["人物编号"] == 0 and putong() == 7 then
    for ex = x1 - 3, x1 + 3 do
      for ey = y1 - 3, y1 + 3 do
        SetWarMap(ex, ey, 4, 1)
        if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
			local ep = GetWarMap(ex, ey, 2)
			if WAR.Person[WAR.CurID]["我方"] == WAR.Person[ep]["我方"] then
				WAR.Person[ep]["生命点数"] = ExecDoctor(pid, WAR.Person[ep]["人物编号"])
				SetWarMap(ex, ey, 4, 4)
				WAR.Effect = 4
	        else
				if GetS(49, 0, 0, 0) == 4 then 
					local tmp = JY.Person[0]["用毒能力"]
					JY.Person[0]["用毒能力"] = math.modf(JY.Person[0]["用毒能力"] * 0.5)
					WAR.Person[ep]["中毒点数"] = War_PoisonHurt(pid, WAR.Person[ep]["人物编号"])
					SetWarMap(ex, ey, 4, 5)
					JY.Person[0]["用毒能力"] = tmp
				end
			end
        end        
      end
    end
  end
  WAR.EffectXY = {}
  WAR.EffectXY[1] = {x1, y1}
  WAR.EffectXY[2] = {x1, y1}
  if flag == 1 then
    War_ShowFight(pid, 0, 0, 0, x1, y1, 30)
  elseif flag == 2 then
    War_ShowFight(pid, 0, 0, 0, x1, y1, 36)
  elseif flag == 3 then
    War_ShowFight(pid, 0, 0, 0, x1, y1, 0)
  elseif flag == 4 and emeny >= 0 then
    War_ShowFight(pid, 0, -1, 0, x1, y1, JY.Thing[thingid]["暗器动画编号"])
  end
  for i = 0, WAR.PersonNum - 1 do
    WAR.Person[i]["点数"] = 0
  end
  if flag == 4 then
    if emeny >= 0 then
      instruct_32(thingid, -1)
      return 1
    else
      return 0
    end
  else
    WAR.Person[WAR.CurID]["经验"] = WAR.Person[WAR.CurID]["经验"] + 1
    AddPersonAttrib(pid, "体力", -2)
  end
  
  if inteam(pid) then
    AddPersonAttrib(pid, "体力", -4)
  end
  return 1
end



--离队菜单
function Menu_PersonExit()
  DrawStrBox(CC.MainSubMenuX, CC.MainSubMenuY, "要求谁离队", C_WHITE, CC.DefaultFont)
  local nexty = CC.MainSubMenuY + CC.SingleLineHeight
  local r = SelectTeamMenu(CC.MainSubMenuX, nexty)
  if r == 1 then
    DrawStrBoxWaitKey("抱歉！没有你游戏进行不下去", C_WHITE, CC.DefaultFont, 1)
  else
    if JY.SubScene == 82 then
      do return end
    end
  end
  if r > 0 and JY.SubScene == 55 and JY.Base["队伍" .. r] == 35 then
    do return end
  end
	if r > 1 then
		local personid = JY.Base["队伍" .. r]
		local hasevent = 0
		for i,v in ipairs(CC.PersonExit) do
			if personid == v[1] then
				hasevent = 1
				if OEVENTLUA[v[2]] ~= nil then
					OEVENTLUA[v[2]]()
				else
					oldCallEvent(v[2])
				end
			end
		end
		if hasevent == 0 then
			local ppl = {
				{625, "袁公子"},
				{77, "萧姑娘"},
				{626, "何先生"},
				{627, "公孙姑娘"},
				{628, "香香公主"},
				{629, "阿九妹子"},
				{630, "夏兄"},				
				{631, "殷姑娘"},
				{632, "丁大哥"},		
				{633, "凌姑娘"},
				{635, "穆姑娘"},		
				{636, "袁姑娘"},
				{176, "何姑娘"},	
				{161, "李仙子"},	
				{104, "阿朱姑娘"},
				{582, "木姑娘"},
				{638, "周姑娘"},	
				{639, "赵姑娘"},
				{655, "月如"}, --武骧金星：增加仙剑女主
				{656, "灵儿"},
				{657, "阿奴"},
				{661, "雪儿"},
				{662, "水镜先生"},
				{663, "双儿"},
				{929, "森九岚"},
			}
			local str = ""
			for i = 1, #ppl do
				if ppl[i][1] == personid then
					str = ppl[i][2]
				end
			end
			if str ~= "" then
				say(str.."，请你先回家休息，有需要时，我再去找你帮忙。")
			else
				tb(JY.Person[personid]["姓名"].."离队")
			end
			instruct_21(personid)
			setteam(personid, 1)	
		end
	end
	Cls()
  return 0
end--物品菜单
function Menu_Thing()
  local menu = {
{"全部物品", nil, 1}, 
{"剧情物品", nil, 1}, 
{"神兵宝甲", nil, 1}, 
{"武功秘笈", nil, 1}, 
{"灵丹妙药", nil, 1}, 
{"伤人暗器", nil, 0}}
  local r = ShowMenu(menu, #menu, 0, CC.MainSubMenuX, CC.MainSubMenuY, 0, 0, 1, 1, CC.DefaultFont, C_ORANGE, C_WHITE)
  if r > 0 then
    local thing = {}
    local thingnum = {}
    for i = 0, CC.MyThingNum - 1 do
      thing[i] = -1
      thingnum[i] = 0
    end
    local num = 0
    for i = 0, CC.MyThingNum - 1 do
      local id = JY.Base["物品" .. i + 1]
      if id >= 0 then
        if r == 1 then
          thing[i] = id
          thingnum[i] = JY.Base["物品数量" .. i + 1]
        else
	        if JY.Thing[id]["类型"] == r - 2 then
	          thing[num] = id
	          thingnum[num] = JY.Base["物品数量" .. i + 1]
	          num = num + 1
	        end
      	end
      end 
    end
    local r = SelectThing(thing, thingnum)
    
    if r >= 0 then
    	UseThing(r)
    	return 1
  	end
  end
  return 0
end




---显示队友状态
-- 左右键翻页，上下键换队友
function ShowPersonStatus(teamid)
  local page = 1
  local pagenum = 2
  local teamnum = GetTeamNum()
  while true do
	page = limitX(page, 1, 2)
    Cls()
    local id = JY.Base["队伍" .. teamid]
	local name = JY.Person[id]["姓名"]
	if page == 1 then
		ShowPersonStatus_sub(id, page)
	elseif page == 2 then
		page = NLJS(id, page)
		if page == -1 then
			break
		end
		Cls()
		ShowPersonStatus_sub(id, page)
		ShowScreen()
	else
		ShowPersonStatus_sub(id, page)
	end
    ShowScreen()
    local keypress = WaitKey()
    lib.Delay(100)
    if keypress == VK_ESCAPE then
      break;
    elseif keypress == VK_UP then
      teamid = teamid - 1
    elseif keypress == VK_DOWN then
      teamid = teamid + 1
    elseif keypress == VK_LEFT then
      page = page - 1
    elseif keypress == VK_RIGHT then
      page = page + 1
    elseif keypress == VK_SPACE or keypress > 1999999 then

    end
    teamid = limitX(teamid, 1, teamnum)
    page = limitX(page, 1, pagenum)
  end
end


function ShowPersonStatus_sub(id, page)
	page = 1
  local size = 25
  local size2 = size - 5
  local p = JY.Person[id]
  local p0 = JY.Person[0]
  local width = 18 * size + 15
  local h = size + CC.PersonStateRowPixel
  local h2 = h - 5
  local height = 13 * h + 10
  local dx = (CC.ScreenW - width) / 2
  local dy = (CC.ScreenH - height) / 2
  dx = 0
  dy = 0
  local i = 1
  local x1, y1, x2 = nil, nil, nil
		lib.PicLoadFile(CC.ThingPicFile[1], CC.ThingPicFile[2], 93)
		lib.PicLoadCache(93, 2, 500, 300)
		--lib.PicLoadCache(4, 4, 500, 300)
  --lib.LoadPicture(CONFIG.PicturePath .. "bj-2.png", 0, 0)
  --lib.LoadPicture(CONFIG.PicturePath .. "bk2.png", 0, CC.ScreenH-300)
  --lib.LoadPicture(CONFIG.PicturePath .. "bk3.png", CC.ScreenW/3+2, 0)
 -- lib.LoadPicture(CONFIG.PicturePath .. "bk4.png", CC.ScreenW/3+2, h*6+4)
  --lib.LoadPicture(CONFIG.PicturePath .. "bk5.png", CC.ScreenW/3+2, CC.ScreenH-200)
  DrawBox(dx, dy, CC.ScreenW, CC.ScreenH, M_Wheat)
  --DrawBox(470, dy, CC.ScreenW, h*7+2, M_Wheat)
  --DrawBox(270, dy, 468, CC.ScreenH, M_Wheat)
  --DrawBox(470, h*7+3, CC.ScreenW, CC.ScreenH, M_Wheat)
  lib.PicLoadCache(93, 4, 500, 300)
 -- lib.LoadPicture(CONFIG.PicturePath .. "jm2.png", 0, 0)
 -- lib.LoadPicture(CONFIG.PicturePath .. "jm3.png", 268-6, 0)

  --lib.LoadPicture(CONFIG.PicturePath .. "jm4.png", 0, CC.ScreenH-6)
 -- lib.LoadPicture(CONFIG.PicturePath .. "bt1.png", 115, 2)
 -- lib.LoadPicture(CONFIG.PicturePath .. "bt0.png", 0, CC.ScreenH-34)
  --lib.LoadPicture(CONFIG.PicturePath .. "jm1.png", 0, 0)
  x1 = dx + 25
  y1 = dy + 5
  x2 = 4 * size
  local headw, headh = lib.PicGetXY(1, p["头像代号"] * 2)
  local headx = (width / 2 - headw) / 3
  local heady = (h * 6 - headh) / 6
  local hid = gethead(id)
	local title = gettitle(id)
	if title ~= "" then
		title = "【"..title.."】"
	else
		title = "【※】"
	end	
	
	lib.PicLoadCache(55, hid * 2, dx + 1, CC.ScreenH - dy - 397, 17)
  lib.PicLoadCache(55, 0, dx + 5, CC.ScreenH - dy - 147, 17)
    MyDrawString(dx, dx + 260, CC.ScreenH - dy - 77, p[CC.s23], C_WHITE, 30) 
  MyDrawString(dx, dx + 260, CC.ScreenH - dy - 47, title, C_GOLD, 30) 
	i = 1
  
  DrawString(x1, y1 + h * i, p[CC.s23], C_WHITE, size)
  DrawString(x1 + 10 * size / 2, y1 + h * i, string.format("%3d", p["等级"]), C_GOLD, size)
  DrawString(x1 + 13 * size / 2, y1 + h * i, "级", C_ORANGE, size)
--[[
   --经验值
   i = i + 1
    DrawString(x1, y1 + h * (i), "升级", C_ORANGE, size)
    local kk = nil
    if p["等级"] >= 30 then
      kk = "   ＝"
    else
      --kk = 2 * (p["经验"] - CC.Exp[p["等级"] - 1])
	  kk = 2 * (CC.Exp[p["等级"] + 1] - p["经验"])
	  local kkk = 10 - string.len(kk)
		for i = 1, kkk do
			kk = " "..kk
		end
    end


    DrawString(x1 + size * 2 + 16, y1 + h * (i), kk, C_GOLD, size)]]
   --[[ local tmp = nil
    if CC.Level <= p["等级"] then
      tmp = "="
    else
      tmp = 2 * CC.Exp[p["等级"] + 1]
    end   
	i = i + 1
    DrawString(x1 + size * 2 + 16, y1 + h * (i), "/" .. tmp, C_GOLD, size)  ]]
  
  --受伤，流血，中毒，封穴，内力性质等属性
  local function DrawAttrib(str, color1, color2, v)	
    if not v then
      v = 0
    end
	if str == "武学常识" then	
		DrawString(x1, y1 + h * i, "武常", color1, size)
	elseif str == "特殊兵器" then
		DrawString(x1, y1 + h * i, "奇门", color1, size)
	else
		DrawString(x1, y1 + h * i, string.sub(str, 1, 4), color1, size)
	end
    DrawString(x1 + x2 - 60, y1 + h * i, string.format("%5d", p[str] + v), color2, size)
    i = i + 1
  end

    local color = nil
    if p["受伤程度"] < 33 then
      color = RGB(236, 200, 40)
    elseif p["受伤程度"] < 66 then
      color = RGB(244, 128, 32)
    else
      color = RGB(232, 32, 44)
    end
    i = i + 1
    DrawString(x1, y1 + h * (i), "生命", C_ORANGE, size)
    DrawString(x1 + 2 * size, y1 + h * (i), string.format("%5d", p["生命"]), color, size)
    DrawString(x1 + 9 * size / 2, y1 + h * (i), "/", C_GOLD, size)
    if p["中毒程度"] == 0 then
      color = RGB(252, 148, 16)
    elseif p["中毒程度"] < 50 then
      color = RGB(120, 208, 88)
    else
      color = RGB(56, 136, 36)
    end
    DrawString(x1 + 5 * size, y1 + h * (i), string.format("%5s", p["生命最大值"]), color, size)
    i = i + 1
    if p["内力性质"] == 0 then
      color = RGB(208, 152, 208)
    elseif p["内力性质"] == 1 then
      color = RGB(236, 200, 40)
    else
      color = RGB(236, 236, 236)
    end
    if p["内力性质"] == 3 then
      color = RGB(216, 20, 24)
    end
    DrawString(x1, y1 + h * (i), "内力", C_ORANGE, size)
    DrawString(x1 + 2 * size, y1 + h * (i), string.format("%5d/%5d", p["内力"], p["内力最大值"]), color, size)
    i = i + 1
    DrawString(x1, y1 + h * (i), "内功潜力", C_ORANGE, size)
	local nlmax = math.modf((JY.Person[id]["资质"] - 1) / 5) --5资质为一档，一档=250内
	local attribmax = 9750 - nlmax * 250
	
	attribmax  = attribmax + (math.modf((101-JY.Person[id]["资质"])/20) * 300) --资质每少20点上限+300，1资+1500
	
	if ZLE(id) then --赵灵儿内力上限+3000
		attribmax = attribmax + 3000
	end
	
	if id == 0 and T7DFWM(0) then --东方未明每学一个内功内力上限+200
		local tg = wgnumber(id, 5)
		attribmax = attribmax + math.modf(tg * 200)
	end
	
	if GX(id) and JX(id) then
		attribmax = attribmax + 1000
	end
	
	if DT(id, 631) then
	--	local aa, bb = JX(id)
	--	if aa then
	local aa = JY.Person[578]["拳掌功夫"]--JX(pid)
			attribmax = attribmax + aa * 50
	--	end	
	end
		
	if MPPD(id) == 2 and MPDJ(id) == 3 then
		attribmax = attribmax + 750
	end	
	
	if PersonKF(id, 85) then
		attribmax = attribmax + 750		
	end
	
	--飞影彩蛋：真龙心法内力硬上限 +2500
	if PersonKF(id, 91) and JY.Person[id]["武功2"] == 91 and JY.Wugong[91]["名称"] == "赤血真龙诀" then
		attribmax = attribmax + 2500
	end
	
	if PersonKF(id, 88) then
		attribmax = attribmax + 750		
	end	
	
	if PersonKF(id, 108) then
		attribmax = attribmax + 600		
	end

	if wglw(id,188) or (DT(id,48) and PersonGT(id,188)) then	 --神足经
		attribmax = attribmax + 1500
	end
	
	if wglw(id,102) or (DT(id,38) and PersonGT(id,102)) or (T5BCF(id) and PersonGT(id,102)) then	 --神足经
		attribmax = attribmax + 1500
	end
	
		
	if wglw(id,203) or (DT(id,592) and PersonGT(id,203)) then	 --太玄经
		attribmax = attribmax + 1000
	end
	
    if id == 58 then
      attribmax = attribmax - JY.Person[578]["半身像"] * 100	--武骧金星：修正杨过内力上限BUG
    end
	
	if id == 0 and putong() > 7 and juexing() > 0 then
		attribmax = attribmax + 1000		
	end

	attribmax = math.modf(attribmax * MPAttrib(id, 9))
	
	if T1LEQ(id) or hasTF(id, 93) then
      attribmax = 10000
    end	
	if DT(id, 592) then
      attribmax = 10000
    end		
	if DT(id, 583) then
	  attribmax = 10000
	elseif DT(id, 600) then
	  attribmax = 10000
	end 
	if DT(id, 602) then
      attribmax = 10000
    end
    if attribmax < 500 then
      attribmax = 500
    end
	if not duiyou(id) then
		attribmax = 10000
	end	
    if wglw(id,85) or DT(id,118) or T1LEQ(id) then
	attribmax = math.min(attribmax, 12500)	
	attribmax = attribmax + 2500
	else
	attribmax = math.min(attribmax, 10000)
	end
	--DrawString(x1 + size * 12 - 45, y1 + h2 * (i+1), "  "..tostring(attribmax), M_Wheat, size2)	
    DrawString(x1 + size * 2 + 40, y1 + h * (i), "  "..tostring(attribmax), M_Wheat, size)
	i = i + 1
    DrawString(x1, y1 + h * (i), "体力", C_ORANGE, size)
    DrawString(x1 + size * 2 + 8, y1 + h * (i), p["体力"], C_GOLD, size)
    DrawString(x1 + size * 4 + 10, y1 + h * (i), "体质", C_ORANGE, size)
    DrawString(x1 + size * 6 + 18, y1 + h * (i), p["生命增长"], C_GOLD, size)
    i = i + 1
    
    --实战
    DrawString(x1, y1 + h * (i), "实战", C_ORANGE, size)

        local num, cl = JY.Person[id]["实战"], C_GOLD
        if num > 499 then
          if not T11CJR(id) then num = "极" end
          cl = C_RED
        end
        DrawString(x1 + size * 2 + 8, y1 + h * (i), num, cl, size)

    
    --左右
    DrawString(x1 + size * 4 + 10, y1 + h * (i), "互搏", C_ORANGE, size)
    local hb = nil
    if p["左右互搏"] == 1 then
      --hb = "◎"
	  hb = tostring(ZYHBJL(id)).."%"
    else
      hb = "未学"
    end
    DrawString(x1 + size * 6 + 18, y1 + h * (i), hb, C_GOLD, size)
	i = i + 1 --武骧金星：显示一些额外的信息
    DrawString(x1, y1 + h * (i), "带毒", C_ORANGE, size)
	DrawString(x1 + size * 2 + 8, y1 + h * (i), JY.Person[id]["攻击带毒"], M_Green, size)
    DrawString(x1 + size * 4 + 10, y1 + h * (i), "抗毒", C_ORANGE, size)
	DrawString(x1 + size * 6 + 18, y1 + h * (i), JY.Person[id]["抗毒能力"], M_DarkOliveGreen, size)
    --中毒、封穴、流血
    
	i = i+ 1
	DrawString(x1, y1 + h * (i), "武常", C_ORANGE, size)
	DrawString(x1 + size * 2 + 8, y1 + h * (i), p["武学常识"], C_GOLD, size)
	DrawString(x1 + size * 4 + 10, y1 + h * (i), "资质", C_ORANGE, size)
	DrawString(x1 + size * 6 + 18, y1 + h * (i), p["资质"], C_GOLD, size)
	
	i = i + 1
	DrawString(x1, y1 + h * (i), "品德", C_ORANGE, size)
	DrawString(x1 + size * 2 + 8, y1 + h * (i), p["品德"], C_GOLD, size)
	DrawString(x1 + size * 4 + 10, y1 + h * (i), "性别", C_ORANGE, size)
	if p["性别"] == 0 then
		DrawString(x1 + size * 6 + 18, y1 + h * (i), "须眉", C_GOLD, size)
	elseif p["性别"] == 1 then
		DrawString(x1 + size * 6 + 18, y1 + h * (i), "巾帼", C_GOLD, size)
	else
		DrawString(x1 + size * 6 + 18, y1 + h * (i), "？？", C_GOLD, size)
	end
    --DrawAttrib("资质", C_WHITE, C_GOLD)
    --DrawAttrib("武学常识", C_WHITE, C_GOLD)
	local tmp1, tmp2, tmp3 = 0, 0, 0 --攻防轻
	local tmp4, tmp5, tmp6, tmp7 = 0, 0, 0, 0 --医毒解暗
	local tmpa, tmpb, tmpc, tmpd = 0, 0, 0, 0 --拳剑刀特
    if p["武器"] > -1 then
      tmp1 = tmp1 + JY.Thing[p["武器"]]["加攻击力"]
      tmp2 = tmp2 + JY.Thing[p["武器"]]["加防御力"]
      tmp3 = tmp3 + JY.Thing[p["武器"]]["加轻功"]
    end
    if p["防具"] > -1 then
      tmp1 = tmp1 + JY.Thing[p["防具"]]["加攻击力"]
      tmp2 = tmp2 + JY.Thing[p["防具"]]["加防御力"]
      tmp3 = tmp3 + JY.Thing[p["防具"]]["加轻功"]
    end
	if p["无用15"] > -1 then
      tmp1 = tmp1 + JY.Thing[p["无用15"]]["加攻击力"]
      tmp2 = tmp2 + JY.Thing[p["无用15"]]["加防御力"]
      tmp3 = tmp3 + JY.Thing[p["无用15"]]["加轻功"]
    end
	
	
    --nino：门派属性追加
	tmp1 = tmp1 + MPAttrib(id, 1)
	tmp2 = tmp2 + MPAttrib(id, 2)
	tmp3 = tmp3 + MPAttrib(id, 3)
	tmp4 = tmp4 + MPAttrib(id, 4)
	tmp5 = tmp5 + MPAttrib(id, 5)
	tmp6 = tmp6 + MPAttrib(id, 6)
	tmp7 = tmp7 + MPAttrib(id, 7)	
    i = 1
    x1 = dx + width / 2 +55

    DrawAttrib("攻击力", C_WHITE, C_GOLD)
    if tmp1 > -1 then
		DrawString(x1 + size * 4, y1 + h, " ".."+" .. tmp1, M_DIY2, size)
	else
		tmp1 = -(tmp1)
		DrawString(x1 + size * 4, y1 + h ," " .."-" .. tmp1, M_DIY1, size)
	end
    DrawAttrib("防御力", C_WHITE, C_GOLD)
	if tmp2 > -1 then
		DrawString(x1 + size * 4, y1  + h * 2," " .."+" .. tmp2, M_DIY2, size)
	else
		tmp2 = -(tmp2)
		DrawString(x1 + size * 4, y1  + h * 2," " .."-" .. tmp2, M_DIY1, size)
	end
    DrawAttrib("轻功", C_WHITE, C_GOLD)
    if tmp3 > -1 then
      DrawString(x1 + size * 4, y1 + h * 3," " .."+" .. tmp3, M_DIY2, size)
    else
      tmp3 = -(tmp3)
      DrawString(x1 + size * 4 , y1 + h * 3," " .."-" .. tmp3, M_DIY1, size)
    end
    
    --能力属性
    DrawAttrib("医疗能力", C_WHITE, C_GOLD)
    if tmp4 > -1 then
      DrawString(x1 + size * 4, y1 + h * 4," " .."+" .. tmp4, M_DIY2, size)
    else
      tmp4 = -(tmp4)
      DrawString(x1 + size * 4, y1 + h * 4," " .."-" .. tmp4, M_DIY1, size)
    end	
    DrawAttrib("用毒能力", C_WHITE, C_GOLD)
    if tmp5 > -1 then
      DrawString(x1 + size * 4, y1 + h * 5," " .."+" .. tmp5, M_DIY2, size)
    else
      tmp5 = -(tmp5)
      DrawString(x1 + size * 4, y1 + h * 5," " .."-" .. tmp5, M_DIY1, size)
    end	
    DrawAttrib("解毒能力", C_WHITE, C_GOLD)
    if tmp6 > -1 then
      DrawString(x1 + size * 4, y1 + h * 6," " .."+" .. tmp6, M_DIY2, size)
    else
      tmp6 = -(tmp6)
      DrawString(x1 + size * 4, y1 + h * 6," " .."-" .. tmp6, M_DIY1, size)
    end		
    DrawAttrib("拳掌功夫", C_WHITE, C_GOLD)
	if sixi(id, 1) == 0 then 
    DrawString(x1 + size * 4 , y1 + h * 7," " .."+" .. sixi(id, 1), M_DIY2, size)
	else 
	DrawString(x1 + size * 4 , y1 + h * 7," " .."+" .. sixi(id, 1) - p["拳掌功夫"], M_DIY2, size)
	end
    DrawAttrib("御剑能力", C_WHITE, C_GOLD)
	if sixi(id, 2) == 0 then 
    DrawString(x1 + size * 4 , y1 + h * 8," " .."+" .. sixi(id, 2), M_DIY2, size)
	else 
	DrawString(x1 + size * 4 , y1 + h * 8," " .."+" .. sixi(id, 2) - p["御剑能力"], M_DIY2, size)
	end
	--DrawString(x1 + size * 4 , y1 + h * 8," " .."+" .. sixi(id, 2) - p["御剑能力"], M_DIY2, size)
    DrawAttrib("耍刀技巧", C_WHITE, C_GOLD)
	if sixi(id, 3) == 0 then 
    DrawString(x1 + size * 4, y1 + h * 9," " .."+" .. sixi(id, 3), M_DIY2, size)
	else 
	DrawString(x1 + size * 4, y1 + h * 9," " .."+" .. sixi(id, 3) - p["耍刀技巧"], M_DIY2, size)
	end
	--DrawString(x1 + size * 4, y1 + h * 9," " .."+" .. sixi(id, 3) - p["耍刀技巧"], M_DIY2, size)
    DrawAttrib("特殊兵器", C_WHITE, C_GOLD)
	if sixi(id, 4) == 0 then 
    DrawString(x1 + size * 4, y1 + h * 10," " .."+" .. sixi(id, 4), M_DIY2, size)
	else 
	DrawString(x1 + size * 4, y1 + h * 10," " .."+" .. sixi(id, 4) - p["特殊兵器"], M_DIY2, size)
	end
	--DrawString(x1 + size * 4, y1 + h * 10," " .."+" .. sixi(id, 4) - p["特殊兵器"], M_DIY2, size)
    DrawAttrib("暗器技巧", C_WHITE, C_GOLD)
	if sixi(id, 5) == 0 then 
    DrawString(x1 + size * 4 , y1 + h * 11," " .."+" .. sixi(id, 5), M_DIY2, size)
	else 
	DrawString(x1 + size * 4 , y1 + h * 11," " .."+" .. sixi(id, 5) - p["暗器技巧"], M_DIY2, size)
	end
	--DrawString(x1 + size * 4 , y1 + h * 11, "↑" .. sixi(id, 5) - p["暗器技巧"], M_DIY2, size)
  --[[  if tmp7 > -1 then
      DrawString(x1 + size * 4 - 5, y1 + h * 12, "↑" .. tmp7, M_DIY2, size)
    else
      tmp7 = -(tmp7)
      DrawString(x1 + size * 4 - 5, y1 + h * 12, "↓" .. tmp7, M_DIY1, size)
    end	]]	
   -- DrawAttrib("资质", C_WHITE, C_GOLD)
    --DrawAttrib("武学常识", C_WHITE, C_GOLD)	
	DrawString(x1, y1 + h * 12, "连击率：", C_GOLD, size)
	DrawString(x1 + size * 4, y1 + h * 12, tostring(LJJL(id)).."%", M_Wheat, size)
	DrawString(x1, y1 + h * 13, "暴击率：", C_GOLD, size)
	DrawString(x1 + size * 4, y1 + h * 13, tostring(BJJL(id)).."%", M_Wheat, size)	
	
	DrawString(x1, y1 + h * 14, "加力率：", C_GOLD, size)
	DrawString(x1 + size * 4, y1 + h * 14, tostring(JLJL(id)).."%", M_Wheat, size)
	DrawString(x1, y1 + h * 15, "护体率：", C_GOLD, size)
	DrawString(x1 + size * 4, y1 + h * 15, tostring(HTJL(id)).."%", M_Wheat, size)	
	i = i +4
    DrawString(x1, y1 + h * (i), "修炼功法:", C_GOLD, size-6)
    local thingid = p["修炼物品"]
    if thingid > 0 then
      DrawString(x1 + size * 3 + 10, y1 + h * (i), JY.Thing[thingid]["名称"], C_GOLD,  size - 6)
    else
      DrawString(x1 + 10 + size * 3, y1 + h * (i), "无", C_GOLD, size-6)	
    end
    i = i + 1
    DrawString(x1, y1 + h * (i), "外功领悟:", C_GOLD, size - 6)
    if T12YMZ(id) and juexing() >= 3 then
		DrawString(x1 + size * 3 + 10, y1 + h * (i),"杨家梨花枪", C_GOLD,  size - 6)
	elseif id == 0 and GetS(113,0,0,0) == 997  then--and GetS(113,0,0,0) <= 180
		DrawString(x1 + size * 3 + 10, y1 + h * (i) ,"萨适二诀", C_GOLD,  size - 6)
	elseif id == 0 and GetS(113,0,0,0) == 60 then
		DrawString(x1 + size * 3 + 10, y1 + h * (i) ,"两仪微尘阵", C_GOLD,  size - 6)
	elseif id == 0 and GetS(113,0,0,0) == 40 then
		DrawString(x1 + size * 3 + 10, y1 + h * (i) ,"金蛇秘传", C_GOLD,  size - 6)	
	elseif id == 0 and GetS(113,0,0,0) == 996 then--
		DrawString(x1 + size * 3 + 10, y1 + h * (i) ,"草头百姓", C_GOLD,  size - 6)	
	elseif id == 0 and GetS(113,0,0,0) > 0 and GetS(113,0,0,0) <= 202 then--
		DrawString(x1 + size * 3 + 10, y1 + h * (i) , JY.Wugong[GetS(113,0,0,0)]["名称"], C_GOLD,  size - 6)	
	elseif id == 0 and GetS(113,0,0,0) == 0 then--
		DrawString(x1 + size * 3 + 10, y1 + h * (i) , "无", C_GOLD,  size - 6)
	else	
		if id > 0 then
			if JY.Person[id]["无用16"] ~= 0 then
				DrawString(x1 + size * 3 + 10, y1 + h * (i) , JY.Wugong[JY.Person[id]["无用16"]]["名称"], C_GOLD,  size - 6)
			else
				DrawString(x1 + 10 + size * 3, y1 + h * (i), "无", C_GOLD, size-6)
			end
		end	
    end
	i = i + 1
    DrawString(x1, y1 + h * (i), "内功领悟:", C_GOLD, size - 6)
    if id == 0 and GetS(111,0,0,0) == 998 then
		DrawString(x1 + size * 3 + 10, y1 + h * (i),"逍遥绝学", C_GOLD,  size - 6)
	elseif id == 0 and GetS(111,0,0,0) == 592 then
		DrawString(x1 + size * 3 + 10, y1 + h * (i) ,"独孤真传", C_GOLD,  size - 6)
	elseif id == 0 and GetS(111,0,0,0) == 997 then
		DrawString(x1 + size * 3 + 10, y1 + h * (i) ,"萨适二诀", C_GOLD,  size - 6)	
	elseif id == 0 and GetS(111,0,0,0) == 999 then
		DrawString(x1 + size * 3 + 10, y1 + h * (i),"真・左右互搏", C_GOLD,  size - 6)		
	elseif id == 0 and GetS(111,0,0,0) > 0 and GetS(111,0,0,0) ~= 47 then
		DrawString(x1 + size * 3 + 10, y1 + h * (i) ,JY.Wugong[GetS(111,0,0,0)]["名称"], C_GOLD,  size - 6)		
	else	
		DrawString(x1 + 10 + size * 3, y1 + h * (i), "无", C_GOLD, size-6)
    end
	i = i + 1
    DrawString(x1, y1 + h * (i), "轻功领悟:", C_GOLD, size - 6)
    if DT(id,667)  then
		DrawString(x1 + size * 3 + 10, y1 + h * (i),"渡世凌虚", C_GOLD,  size - 6)
    elseif id == 0 and GetS(114,0,0,0) > 0 then
		DrawString(x1 + size * 3 + 10, y1 + h * (i),JY.Wugong[GetS(114,0,0,0)]["名称"], C_GOLD,  size - 6)
	else	
		DrawString(x1 + 10 + size * 3, y1 + h * (i), "无", C_GOLD, size-6)
    end	
	x1 = x1 + 20
	--lib.PicLoadCache(2, thingid * 2, x1 + size * 2 - 10, y1 + h * (i) + 4, 1)
	i = 1
	
	--[[local lw = "【※】"
	--外功领悟显示
	if T12YMZ(id) and juexing() >= 3 then
		DrawString(x1 + size * 8 - 18, y1 + h2 * (tmpi+1), "外功领悟:".."【杨家梨花枪】", M_Wheat, size2)	
	elseif id == 0 and GetS(113,0,0,0) > 0 and GetS(113,0,0,0) <= 180 then 
		DrawString(x1 + size * 8 - 18, y1 + h2 * (tmpi+1), "外功领悟:".."【"..string.format("%s", JY.Wugong[GetS(113,0,0,0)]["名称"]).."】", M_Wheat, size2)	
	else
		DrawString(x1 + size * 8 - 18, y1 + h2 * (tmpi+1), "外功领悟:".."【※】", M_Wheat, size2)
	end
	--内功领悟显示
	if id == 0 and GetS(111,0,0,0) == 998 then 
	   DrawString(x1 + size * 8 - 18, y1 + h2 * (tmpi+2), "内功领悟:".."【逍遥绝学】", M_Wheat, size2)	 
	elseif id == 0 and GetS(111,0,0,0) == 592 then 
	   DrawString(x1 + size * 8 - 18, y1 + h2 * (tmpi+2), "内功领悟:".."【独孤真传】", M_Wheat, size2)	
	elseif id == 0 and GetS(111,0,0,0) == 999 then 
	   DrawString(x1 + size * 8 - 18, y1 + h2 * (tmpi+2), "内功领悟:".."【左右互搏】", M_Wheat, size2) 
	elseif id == 0 and GetS(111,0,0,0) > 0 and GetS(111,0,0,0) ~= 47 then 
	   DrawString(x1 + size * 8 - 18, y1 + h2 * (tmpi+2), "内功领悟:".."【"..string.format("%s", JY.Wugong[GetS(111,0,0,0)]["名称"]).."】", M_Wheat, size2)		   
	else 
	   DrawString(x1 + size * 8 - 18, y1 + h2 * (tmpi+2), "内功领悟:".."【※】", M_Wheat, size2)	
    end	
	--轻功领悟显示
	if id == 0 and GetS(114,0,0,0) > 0 and GetS(114,0,0,0) ~= 47 then 
	   DrawString(x1 + size * 8 - 18, y1 + h2 * (tmpi+3), "轻功领悟:".."【"..string.format("%s", JY.Wugong[GetS(114,0,0,0)]["名称"]).."】", M_Wheat, size2)		   
	else 
	   DrawString(x1 + size * 8 - 18, y1 + h2 * (tmpi+3), "轻功领悟:".."【※】", M_Wheat, size2)	
    end
	x1 = dx + 5 + size
	y1 = dy + 5]]
	
--武功显示
	if MPPD(id) ~= 0 then
		local mptype, mpdj = MPDISPLAY(id)
		if mptype ~= nil then
		--由于门派不足，暂时将部分人物归于其他的门派
			if MPPD(id) == 14 then
				if DT(id,24) or DT(id,137) or (id >= 211 and id <= 220) or (id >= 669 and id <= 678) then
					mptype = "青城派"
				elseif DT(id,43) or DT(id,661) or (id >= 241 and id <= 250) or (id >= 699 and id <= 708) then
					mptype = "雪山派"
				end
			elseif MPPD(id) == 12 then
				if DT(id,25) or DT(id,83) or DT(id,176) or (id >= 221 and id <= 230) or (id >= 679 and id <= 688) then
					mptype = "五毒教"
				end
			elseif MPPD(id) == 18 then
				if DT(id,67) or (id >= 281 and id <= 290) or (id >= 739 and id <= 748) then
					mptype = "铁掌帮"
				end
			elseif MPPD(id) == 13 then
				if DT(id,71) or DT(id,87) or DT(id,596) or (id >= 390 and id <= 399) or (id >= 848 and id <= 857) then
					mptype = "神龙教"
				end				
			end
		--临时处理结束
			if id >= 497 and id <= 515 then
				DrawString(x1 + size * 8 - 17, y1 + h2 * i, "【扶桑忍者】", M_Wheat, size2)
			elseif id >= 516 and id <= 536 then
				DrawString(x1 + size * 8 - 17, y1 + h2 * i, "【东瀛剑豪】", M_Wheat, size2)
			elseif id >= 537 and id <= 557 then
				DrawString(x1 + size * 8 - 17, y1 + h2 * i, "【战国大名】", M_Wheat, size2)
			elseif id >= 559 and id <= 577 then
				DrawString(x1 + size * 8 - 17, y1 + h2 * i, "【军国战犯】", M_Wheat, size2)		
		    elseif MPPD(id) == 11 and XYL(id) and  juexing() > 1 then
				DrawString(x1 + size * 8 - 17, y1 + h2 * i, "【".."静虚子".."】", M_Wheat, size2)
			elseif MPPD(id) == 11 and DT(id,597) then
				DrawString(x1 + size * 8 - 17, y1 + h2 * i, "【".."一刀流妖刀姬".."】", M_Wheat, size2)
			elseif MPPD(id) == 5 and DT(id,114) then
				DrawString(x1 + size * 8 - 17, y1 + h2 * i, "【".."隐世禅祖".."】", M_Wheat, size2)
			elseif MPPD(id) == 12 and DT(id,73) then
				DrawString(x1 + size * 8 - 17, y1 + h2 * i, "【".."日月神教圣姑".."】", M_Wheat, size2)
			elseif MPPD(id) == 12 and DT(id,26) then
				DrawString(x1 + size * 8 - 17, y1 + h2 * i, "【".."日月神教前教主".."】", M_Wheat, size2)
			elseif MPPD(id) == 13 and DT(id,66) then
				DrawString(x1 + size * 8 - 17, y1 + h2 * i, "【".."波斯明教圣女".."】", M_Wheat, size2)
			elseif MPPD(id) == 13 and (ZJ(id) and zjtype() ~= 3) then
				DrawString(x1 + size * 8 - 17, y1 + h2 * i, "【".."明教代行使者".."】", M_Wheat, size2)
			elseif MPPD(id) == 13 and (DT(id,173) or DT(id,174) or DT(id,175)) then
				DrawString(x1 + size * 8 - 17, y1 + h2 * i, "【".."波斯明教使者".."】", M_Wheat, size2)
			elseif MPPD(id) == 15 and DT(id,602) then
				DrawString(x1 + size * 8 - 17, y1 + h2 * i, "【".."大理先祖".."】", M_Wheat, size2)
			elseif MPPD(id) == 5 and DT(id,615) then
				DrawString(x1 + size * 8 - 17, y1 + h2 * i, "【".."禅宗初祖".."】", M_Wheat, size2)
			elseif MPPD(id) == 16 and DT(id,129) then
				DrawString(x1 + size * 8 - 17, y1 + h2 * i, "【".."重阳真人".."】", M_Wheat, size2)
			elseif MPPD(id) == 10 and DT(id,667) then
				DrawString(x1 + size * 8 - 17, y1 + h2 * i, "【".."桃花岛客卿".."】", M_Wheat, size2)
			elseif MPPD(id) == 2 then
				if DT(id,69) then
				DrawString(x1 + size * 8 - 17, y1 + h2 * i, "【"..mptype..mpdj.."・乌净共主".."】", M_Wheat, size2)
				elseif GB(id) == 2 then
				DrawString(x1 + size * 8 - 17, y1 + h2 * i, "【"..mptype..mpdj.."・净衣派".."】", M_Wheat, size2)
				elseif GB(id) == 3 then
				DrawString(x1 + size * 8 - 17, y1 + h2 * i, "【"..mptype..mpdj.."・乌衣派".."】", M_Wheat, size2)
				else
				DrawString(x1 + size * 8 - 17, y1 + h2 * i, "【"..mptype..mpdj.."】", M_Wheat, size2)
				end
			else
				DrawString(x1 + size * 8 - 17, y1 + h2 * i, "【"..mptype..mpdj.."】", M_Wheat, size2)
			end
		else
			DrawString(x1 + size * 8 - 17, y1 + h2 * i, "【江湖侠士】", M_Wheat, size2)
		end
	else
		DrawString(x1 + size * 8 - 17, y1 + h2 * i, "【江湖侠士】", M_Wheat, size2)
	end
	    DrawString(x1 + size * 17+10, y1 + h * i,"外功精通:", C_RED, size)--天赋外功
		for k, v in ipairs(CC.TFWG) do --豸苗：更多显示
			if v[1] == id then
				DrawString(x1 + size * 22, y1 + h * i, JY.Wugong[v[2]]["名称"], M_Wheat, size)	 
				break
			end
			if v[1] == cxzj() and id == 0 then
				DrawString(x1 + size * 22, y1 + h * i, JY.Wugong[v[2]]["名称"], M_Wheat, size)						
				break
			end
		end
			if id == 0 and (putong() > 0 or teshu() > 0) then
				if GetS(112,1,0,0)> 0 then
				if T9ZY(id) then
				DrawString(x1 + size * 22, y1 + h * i, "七探蛇盘枪", M_Wheat, size)
				elseif T12YMZ(id) then
				DrawString(x1 + size * 22, y1 + h * i, "梨花枪", M_Wheat, size)
				else
				DrawString(x1 + size * 22, y1 + h * i, JY.Wugong[GetS(112,1,0,0)]["名称"], M_Wheat, size)		
			    end
				end
		    end
            if id == 92 and JY.Person[578]["攻击力"] > 0 then
				DrawString(x1 + size * 22, y1 + h * i, JY.Wugong[JY.Person[578]["攻击力"]]["名称"], M_Wheat, size)		
			end
		for k, v in ipairs(CC.TFWG1) do --豸苗：更多显示
			if v[1] == id then
				DrawString(x1 + size * 22, y1 + h * (i+1), JY.Wugong[v[2]]["名称"], M_Wheat, size)						
				break
			end
			if v[1] == cxzj() and id == 0 then
				DrawString(x1 + size * 22, y1 + h * (i+1), JY.Wugong[v[2]]["名称"], M_Wheat, size)					
				break
			end
		end
			if T4WXS(id) then
				if GetS(112,4,0,0)> 0 then
				DrawString(x1 + size * 22, y1 + h * (i+1), JY.Wugong[GetS(112,4,0,0)]["名称"], M_Wheat, size)
				end
			end
	i = i + 1
	if yongnei(p["声望"]) then
		DrawString(x1 + size * 8 - 18, y1 + h2 * i, "主运功体:".."【"..JY.Wugong[p["声望"]]["名称"].."】", M_Wheat, size2)
	else
		DrawString(x1 + size * 8 - 18, y1 + h2 * i, "主运功体:".."【无】", M_Wheat, size2)
	end
        DrawString(x1 + size * 17+10, y1 + h * (i+1), "内功精通:", M_DeepSkyBlue, size)--天赋内功
		for k, v in ipairs(CC.TFNG) do --豸苗：更多显示12.26
			if v[1] == id then
				DrawString(x1 + size * 22, y1 + h * (i+1), JY.Wugong[v[2]]["名称"], M_Wheat, size)						
				break
			end
			if v[1] == cxzj() and id == 0 then
				DrawString(x1 + size * 22, y1 + h * (i+1), JY.Wugong[v[2]]["名称"], M_Wheat, size)					
				break
			end
		end
			if id ==92 and JY.Person[578]["防御力"] > 0 then
				DrawString(x1 + size * 22, y1 + h * (i+1), JY.Wugong[JY.Person[578]["防御力"]]["名称"], M_Wheat, size)			
			end
			if id == 0 and (putong() > 0 or teshu() > 0) then
				if GetS(112,2,0,0)> 0 then
				DrawString(x1 + size * 22, y1 + h * (i+1), JY.Wugong[GetS(112,2,0,0)]["名称"], M_Wheat, size)		
			    end
		    end
		for k, v in ipairs(CC.TFNG1) do --豸苗：更多显示
			if v[1] == id then
				DrawString(x1 + size * 22, y1 + h * (i+2), JY.Wugong[v[2]]["名称"], M_Wheat, size)						
				break
			end
			if v[1] == cxzj() and id == 0 then
				DrawString(x1 + size * 22, y1 + h * (i+2), JY.Wugong[v[2]]["名称"], M_Wheat, size)				
				break
			end
		end
		
	i = i + 1 --武骧金星：显示潜力
	DrawString(x1 + size * 17+10, y1 + h * (i+2), "轻功精通:", M_green1, size)--天赋轻功
		for k, v in ipairs(CC.TFQG) do --豸苗：更多显示
			if v[1] == id then
				DrawString(x1 + size * 22, y1 + h * (i+2), JY.Wugong[v[2]]["名称"], M_Wheat, size)						
				break
			end
			if v[1] == cxzj() and id == 0 then
				DrawString(x1 + size * 22, y1 + h * (i+2), JY.Wugong[v[2]]["名称"], M_Wheat, size)				
				break
			end
		end
		if id == 0 and (putong() > 0 or teshu() > 0) then
			if GetS(112,3,0,0)> 0 then
			if XYL(id) then
			DrawString(x1 + size * 22, y1 + h * (i+2), "梯云步", M_Wheat, size)	
			else
			DrawString(x1 + size * 22, y1 + h * (i+2), JY.Wugong[GetS(112,3,0,0)]["名称"], M_Wheat, size)	
			end	
			end
		end
		if id ==92 and JY.Person[578]["轻功"] > 0 then
			DrawString(x1 + size * 22, y1 + h * (i+2), JY.Wugong[JY.Person[578]["轻功"]]["名称"], M_Wheat, size)			
		end
	if p["武器"] > -1 then
	DrawString(x1 + size * 8 - 18, y1 + h2 * (i+1), "神兵利器:".."【"..string.format("%s", JY.Thing[p["武器"]]["名称"]).."】", M_Wheat, size2)	
	else
	DrawString(x1 + size * 8 - 18, y1 + h2 * (i+1), "神兵利器:".."【无】", M_Wheat, size2)
	end	
	
	i = i + 1
	local tmpi = i
	local fgt = -1

	i = i + 3
	DrawString(x1 + size * 8 - 18, y1 + h * i, "所会功夫", C_RED, size)
	DrawString(x1 + size * 13 - 8, y1 + h * i, "等级", C_RED, size)
	DrawString(x1 + size * 15 + 13, y1 + h * i, "威力", C_RED, size)
	DrawString(x1 + size * 17 + 34, y1 + h * i, "连击", C_RED, size) --武骧金星：更多显示
	DrawString(x1 + size * 19 + 55, y1 + h * i, "暴击", C_RED, size)		
	--DrawString(x1 + size * 21 + 76, y1 + h * i, "封穴", C_RED, size)
	--DrawString(x1 + size * 23 + 97, y1 + h * i, "流血", C_RED, size)	
	--DrawString(x1 + size * 25 + 118, y1 + h * i, "迟缓", C_RED, size)	
	--DrawString(x1 + size * 27 + 139, y1 + h * i, "带毒", C_RED, size)
	DrawString(x1 + size * 21 + 76, y1 + h * i, "上限", C_RED, size) 	
    local T = {"一", "二", "三", "四", "五", "六", "七", "八", "九", "十", "极","悟"}
    for j = 1, 12 do
      i = i + 1
      local wugong = p["武功" .. j]
      if wugong > 0 then
        local level = math.modf(p["武功等级" .. j] / 100) + 1
        if p["武功等级" .. j] >= 999 then
			level = 11
			if wglw(id,wugong) or wglw1(id,wugong) or wglw2(id,wugong) then
				level = 12
			end
        end
		if p["声望"] == wugong then --功体显示
			DrawString(x1 + size * 8 - 18, y1 + h * (i), string.format("%s", JY.Wugong[wugong]["名称"]), C_GOLD, size)
        elseif twogt(id) and p["外号"] == tostring(wugong) then
			DrawString(x1 + size * 8 - 18, y1 + h * (i), string.format("%s", JY.Wugong[wugong]["名称"]), C_GOLD, size)
			fgt = wugong
		else
		    if XYL(id) then
              	if p["武功" .. j] == GetS(112,3,0,0) then
			       DrawString(x1 + size * 8 - 18, y1 + h * (i), string.format("%s", "梯云步"), C_GOLD, size)
				else
				   DrawString(x1 + size * 8 - 18, y1 + h * (i), string.format("%s", JY.Wugong[wugong]["名称"]), C_GOLD, size)
				end
			elseif T9ZY(id)  then
              	if p["武功" .. j] == GetS(112,1,0,0) and juexing() > 1 then
			       DrawString(x1 + size * 8 - 18, y1 + h * (i), string.format("%s", "七探蛇盘枪"), C_GOLD, size)
				else
				   DrawString(x1 + size * 8 - 18, y1 + h * (i), string.format("%s", JY.Wugong[wugong]["名称"]), C_GOLD, size)
				end  
			elseif T12YMZ(id) then
              	if p["武功" .. j] == GetS(112,1,0,0) then
			       DrawString(x1 + size * 8 - 18, y1 + h * (i), string.format("%s", "梨花枪"), C_GOLD, size)
				else
				   DrawString(x1 + size * 8 - 18, y1 + h * (i), string.format("%s", JY.Wugong[wugong]["名称"]), C_GOLD, size)
				end  
			else
			DrawString(x1 + size * 8 - 18, y1 + h * (i), string.format("%s", JY.Wugong[wugong]["名称"]), C_GOLD, size)
			end
        end
		if p["武功等级" .. j] > 900 then
			lib.SetClip(x1 + size * 8 - 18, y1 + h * 1, x1 + size * 10 + string.len(JY.Wugong[wugong]["名称"]) * size * (p["武功等级" .. j] - 900) / 200, y1 + h * (i) + h)
			if p["声望"] == wugong then
			    DrawString(x1 + size * 8 - 18, y1 + h * (i), string.format("%s", JY.Wugong[wugong]["名称"]), C_ORANGE, size)
			elseif twogt(id) and p["外号"] == tostring(wugong) then
				DrawString(x1 + size * 8 - 18, y1 + h * (i), string.format("%s", JY.Wugong[wugong]["名称"]), C_ORANGE, size)
				fgt = wugong
			else
		    if XYL(id) then
              	if p["武功" .. j] == GetS(112,3,0,0) then
			       DrawString(x1 + size * 8 - 18, y1 + h * (i), string.format("%s", "梯云步"), C_ORANGE, size)
				else
				   DrawString(x1 + size * 8 - 18, y1 + h * (i), string.format("%s", JY.Wugong[wugong]["名称"]), C_ORANGE, size)
				end
			elseif T9ZY(id) then
              	if p["武功" .. j] == GetS(112,1,0,0) and juexing() > 1 then
			       DrawString(x1 + size * 8 - 18, y1 + h * (i), string.format("%s", "七探蛇盘枪"), C_ORANGE, size)
				else
				   DrawString(x1 + size * 8 - 18, y1 + h * (i), string.format("%s", JY.Wugong[wugong]["名称"]), C_ORANGE, size)
				end  
			elseif T12YMZ(id) then
              	if p["武功" .. j] == GetS(112,1,0,0) then
			       DrawString(x1 + size * 8 - 18, y1 + h * (i), string.format("%s", "梨花枪"), C_ORANGE, size)
				else
				   DrawString(x1 + size * 8 - 18, y1 + h * (i), string.format("%s", JY.Wugong[wugong]["名称"]), C_ORANGE, size)
				end  
			else
			DrawString(x1 + size * 8 - 18, y1 + h * (i), string.format("%s", JY.Wugong[wugong]["名称"]), C_ORANGE, size)
			end
			end
			lib.SetClip(0, 0, 0, 0)
        end
		if level == 12 then
			DrawString(x1 + size * 13 + 5, y1 + h * (i), T[level], C_RED, size)
		else
			DrawString(x1 + size * 13 + 5, y1 + h * (i), T[level], C_WHITE, size)
		end
		DrawString(x1 + size * 15 + 16, y1 + h * (i), WGWL(id, wugong, level), C_WHITE, size)
		for k, v in ipairs(CC.WGJC) do --武骧金星：更多显示
			if v[1] == wugong then
				local lianji = v[2]
				local baoji = v[3]
				DrawString(x1 + size * 17 + 37, y1 + h * i, v[2], C_WHITE, size)
				DrawString(x1 + size * 19 + 58, y1 + h * i, v[3], C_WHITE, size)						
				break
			end
		end		
		--for k, v in ipairs(CC.WGJC2) do
		--	if v[1] == wugong then
		--		local fengxue = v[2]
		--		local liuxue = v[3]
		--		local chihuan = v[4]
		--		DrawString(x1 + size * 21 + 79, y1 + h * i, v[2], C_WHITE, size)
		--		DrawString(x1 + size * 23 + 100, y1 + h * i, v[3], C_WHITE, size)	
		--		DrawString(x1 + size * 25 + 121, y1 + h * i, v[4], C_WHITE, size)					
		--		break
		--	end
		--end
		--DrawString(x1 + size * 27 + 142, y1 + h * (i), JY.Wugong[wugong]["敌人中毒点数"], C_WHITE, size)
		local tmp3 = math.modf((100 - JY.Person[id]["资质"]) / 25) + 1
		--tmp3 = math.min(2, 1 + tmp3 * 0.5)
		tmp3 = 2
		DrawString(x1 + size * 21 + 79, y1 + h * (i), math.modf(JY.Wugong[wugong]["攻击力" .. 10] * tmp3) + JY.Wugong[wugong]["上限"], C_WHITE, size)		 
      end
    end	
	--if twogt(id) and fgt ~= -1 then
	if twogt(id) and tonumber(JY.Person[id]["外号"])~= nil then
		DrawString(x1 + size * 8 - 18, y1 + h2 * (tmpi-1), "副运功体:".."【"..JY.Wugong[tonumber(JY.Person[id]["外号"])]["名称"].."】", M_Wheat, size2)
	elseif twogt(id) then
		DrawString(x1 + size * 8 - 18, y1 + h2 * (tmpi-1), "副运功体:".."【无】", M_Wheat, size2)
	else
		DrawString(x1 + size * 8 - 18, y1 + h2 * (tmpi-1), "副运功体:".."【未开启】", M_Wheat, size2)	
	end	
	--local lw = "【※】"
	--武器显示
	if p["防具"] > -1 then 
		DrawString(x1 + size * 8 - 18, y1 + h2 * (tmpi+1), "铁甲征衣:".."【"..string.format("%s", JY.Thing[p["防具"]]["名称"]).."】", M_Wheat, size2)	
	else
		DrawString(x1 + size * 8 - 18, y1 + h2 * (tmpi+1), "铁甲征衣:".."【无】", M_Wheat, size2)
	end
	--防具、载具显示
	if p["无用15"] > 0 then 
		DrawString(x1 + size * 8 - 18, y1 + h2 * (tmpi+2), "策马天下:".."【"..string.format("%s", JY.Thing[p["无用15"]]["名称"]).."】", M_Wheat, size2)		
	else
		DrawString(x1 + size * 8 - 18, y1 + h2 * (tmpi+2), "策马天下:".."【无】", M_Wheat, size2)
	end
	--i = i +4
    --DrawString(x1, y1 + h * (i), "武器:", C_GOLD, size)
    --if p["武器"] > -1 then
	--	DrawString(x1 + size * 3 - 10, y1 + h * (i) + 4, JY.Thing[p["武器"]]["名称"], C_GOLD, size - 7)
    --else
	--	DrawString(x1 + 3 + size * 3, y1 + h * (i), "无", C_GOLD, size)
	--end
    --i = i + 1
    --DrawString(x1, y1 + h * (i), "防具:", C_GOLD, size)
    --if p["防具"] > -1 then
	--	DrawString(x1 + size * 3 - 10, y1 + h * (i) + 4, JY.Thing[p["防具"]]["名称"], C_GOLD,  size - 7)
	--else	
	--	DrawString(x1 + 3 + size * 3, y1 + h * (i), "无", C_GOLD, size)
    --end
	
	x1 = dx + 5 + size
	y1 = dy + 5
	--DrawString(x1 + size * 5, y1 + h + h * 15 , "上下键浏览，左右键切换，ESC退出", C_ORANGE, size - 3)
	--DrawString(dx + 170, CC.ScreenH - dy - 27 , "上下键浏览，左右键切换，ESC退出", C_ORANGE, size - 3) --武骧金星：微调位置
end

--战斗会跳出的问题
GetAtkNum = function(x, y, movfw, atkfw, atk)
  local point = {}
  local num = 0
  local kind, len = movfw[1], movfw[2]
  if kind == 0 then
    local array = MY_CalMoveStep(x, y, len, 1)
    for i = 0, len do
      local step_num = array[i].num
      if step_num ~= nil then
        if step_num == 0 then
          break;
        end
      end
      for j = 1, step_num do
        num = num + 1
        point[num] = {array[i].x[j], array[i].y[j]}
      end
    end
  elseif kind == 1 then
    local array = MY_CalMoveStep(x, y, len * 2, 1)
    for r = 1, len * 2 do
      for i = 0, r do
        local j = r - i
        if len < i or len < j then
          SetWarMap(x + i, y + j, 3, 255)
          SetWarMap(x + i, y - j, 3, 255)
          SetWarMap(x - i, y + j, 3, 255)
          SetWarMap(x - i, y - j, 3, 255)
        end
      end
    end
    for i = 0, len do
      local step_num = array[i].num
      if step_num ~= nil then
        if step_num == 0 then
          break;
        end
      end
      for j = 1, step_num do
        if GetWarMap(array[i].x[j], array[i].y[j], 3) < 128 then
          num = num + 1
          point[num] = {array[i].x[j], array[i].y[j]}
        end
      end
    end
  elseif kind == 2 then
    if not len then
      len = 1
    end
    for i = 1, len do
      if x + i < CC.WarWidth - 1 and GetWarMap(x + i, y, 1) > 0 and CC.WarWater[GetWarMap(x + i, y, 0)] == nil then
        break;
      end
      num = num + 1
      point[num] = {x + i, y}
    end
    for i = 1, len do
      if x - i > 0 and GetWarMap(x - i, y, 1) > 0 and CC.WarWater[GetWarMap(x - i, y, 0)] == nil then
        break;
      end
      num = num + 1
      point[num] = {x - i, y}
    end
    for i = 1, len do
      if y + i < CC.WarHeight - 1 and GetWarMap(x, y + i, 1) > 0 and CC.WarWater[GetWarMap(x, y + i, 0)] == nil then
        break;
      end
      num = num + 1
      point[num] = {x, y + i}
    end
    for i = 1, len do
      if y - i > 0 and GetWarMap(x, y - i, 1) > 0 and CC.WarWater[GetWarMap(x, y - i, 0)] == nil then
        break;
      end
      num = num + 1
      point[num] = {x, y - i}
    end
  elseif kind == 3 then
    if x + 1 < CC.WarWidth - 1 and GetWarMap(x + 1, y, 1) == 0 and CC.WarWater[GetWarMap(x + 1, y, 0)] == nil then
      num = num + 1
      point[num] = {x + 1, y}
    end
    if x - 1 > 0 and GetWarMap(x - 1, y, 1) == 0 and CC.WarWater[GetWarMap(x - 1, y, 0)] == nil then
      num = num + 1
      point[num] = {x - 1, y}
    end
    if y + 1 < CC.WarHeight - 1 and GetWarMap(x, y + 1, 1) == 0 and CC.WarWater[GetWarMap(x, y + 1, 0)] == nil then
      num = num + 1
      point[num] = {x, y + 1}
    end
    if y - 1 > 0 and GetWarMap(x, y - 1, 1) == 0 and CC.WarWater[GetWarMap(x, y - 1, 0)] == nil then
      num = num + 1
      point[num] = {x, y - 1}
    end
    if x + 1 < CC.WarWidth - 1 and y + 1 < CC.WarHeight - 1 and GetWarMap(x + 1, y + 1, 1) == 0 and CC.WarWater[GetWarMap(x + 1, y + 1, 0)] == nil then
      num = num + 1
      point[num] = {x + 1, y + 1}
    end
    if x - 1 > 0 and y + 1 < CC.WarHeight - 1 and GetWarMap(x - 1, y + 1, 1) == 0 and CC.WarWater[GetWarMap(x - 1, y + 1, 0)] == nil then
      num = num + 1
      point[num] = {x - 1, y + 1}
    end
    if x + 1 < CC.WarWidth - 1 and y - 1 > 0 and GetWarMap(x + 1, y - 1, 1) == 0 and CC.WarWater[GetWarMap(x + 1, y - 1, 0)] == nil then
      num = num + 1
      point[num] = {x + 1, y - 1}
    end
  end
  if x - 1 > 0 and y - 1 > 0 and GetWarMap(x - 1, y - 1, 1) == 0 and CC.WarWater[GetWarMap(x - 1, y - 1, 0)] == nil then
    num = num + 1
    point[num] = {x - 1, y - 1}
  end
  local maxx, maxy, maxnum, atknum = 0, 0, 0, 0
  for i = 1, num do
    atknum = GetWarMap(point[i][1], point[i][2], 4)
    if atknum == -1 or atkfw[1] > 9 then
      atknum = WarDrawAtt(point[i][1], point[i][2], atkfw, 2, x, y, atk)
      SetWarMap(point[i][1], point[i][2], 4, atknum)
    end
    if atknum~= nil and maxnum < atknum then
      maxnum, maxx, maxy = atknum, point[i][1], point[i][2]
    end
  end
  return maxnum, maxx, maxy
end


--[[
定义全局函数:
CC.MapWatch()
CC.FriList()
CC.EnemyList()

修改系统函数:
War_StatusMenu()


]]


function MapWatch()
	local x = WAR.Person[WAR.CurID]["坐标X"];
  local y = WAR.Person[WAR.CurID]["坐标Y"];
  local page = 1
  War_CalMoveStep(WAR.CurID,128,1);
  WarDrawMap(1,x,y);
  ShowScreen();
  x,y=War_SelectMove()
  if x == nil then
	  return
  end
  local i
  local id = 0
	for i = 0,WAR.PersonNum do
		if WAR.Person[i]["坐标X"] == x and WAR.Person[i]["坐标Y"] == y and WAR.Person[i]["死亡"] == false then
			id = WAR.Person[i]["人物编号"]
			break;
		end
	end
	while true do
		Cls()
		page = limitX(page, 1, 2)
		--ShowPersonStatus_sub(list[r],page)
		if page == 1 then
			ShowPersonStatus_sub(id, page)
		elseif page == 2 then
			page = NLJS(id, page)
			if page == -1 then
				break
			end
			Cls()
			ShowPersonStatus_sub(id, page)
			ShowScreen()
		else
			ShowPersonStatus_sub(id, page)
		end	
		ShowScreen();
		local keypress = WaitKey()
		if keypress == VK_LEFT then
	  	  page = page - 1;
   		elseif keypress == VK_RIGHT then
	  	  page = page + 1;
		elseif keypress == 27 then
	  		break
		end
	end
end

function FriList()
	local menu = {};
	local list = {}
	local page = 1
	for i = 1,WAR.PersonNum do
		if WAR.Person[i - 1]["我方"] == true and WAR.Person[i - 1]["死亡"] == false then
			menu[#menu + 1] = {JY.Person[WAR.Person[i - 1]["人物编号"]]["姓名"],nil,1}
			list[#list + 1] = WAR.Person[i - 1]["人物编号"]
		end
	end
	Cls()
	local r = ShowMenu(menu,#menu, 15, CC.MainSubMenuX, CC.MainSubMenuY, 0, 0, 1, 1, CC.DefaultFont, C_ORANGE, C_WHITE)
	if r < 1 then
		return
	end
	while true do
		Cls()
		page = limitX(page, 1, 2)
		--ShowPersonStatus_sub(list[r],page)
		if page == 1 then
			ShowPersonStatus_sub(list[r], page)
		elseif page == 2 then
			page = NLJS(list[r], page)
			if page == -1 then
				break
			end
			Cls()
			ShowPersonStatus_sub(list[r], page)
			ShowScreen()
		else
			ShowPersonStatus_sub(list[r], page)
		end		
		ShowScreen();
		local keypress = WaitKey()
		if keypress == VK_LEFT then
	  		page = page - 1;
   		elseif keypress == VK_RIGHT then
	  		page = page + 1;
	  	elseif keypress == VK_UP then
	  		r = r - 1
	  	elseif keypress == VK_DOWN then
	  		r = r + 1
		elseif keypress == 27 then
	  		break
		end
		if r < 1 then
			r = 1
		end
		if r > #list then
			r = #list
		end
	end
end

function EnemyList()
	local menu = {};
	local list = {}
	local page = 1
	for i = 1,WAR.PersonNum do
		if WAR.Person[i - 1]["我方"] == false and WAR.Person[i - 1]["死亡"] == false then
			menu[#menu + 1] = {JY.Person[WAR.Person[i - 1]["人物编号"]]["姓名"],nil,1}
			list[#list + 1] = WAR.Person[i - 1]["人物编号"]
		end
	end
	Cls()
	local r = ShowMenu(menu,#menu, 15, CC.MainSubMenuX, CC.MainSubMenuY, 0, 0, 1, 1, CC.DefaultFont, C_ORANGE, C_WHITE)
	if r < 1 then
		return
	end
	local id = list[r] 
	while true do
		Cls()
		page = limitX(page, 1, 2)
		--ShowPersonStatus_sub(list[r],page)
		if page == 1 then
			ShowPersonStatus_sub(list[r], page)
		elseif page == 2 then
			page = NLJS(list[r], page)
			if page == -1 then
				break
			end
			Cls()
			ShowPersonStatus_sub(list[r], page)
			ShowScreen()
		else
			ShowPersonStatus_sub(list[r], page)
		end	
		ShowScreen();
		local keypress = WaitKey()
		if keypress == VK_LEFT then
	  		page = page - 1;
   		elseif keypress == VK_RIGHT then
	  		page = page + 1;
	  	elseif keypress == VK_UP then
	  		r = r - 1
	  	elseif keypress == VK_DOWN then
	  		r = r + 1
		elseif keypress == 27 then
	  		break
		end
		if r < 1 then
			r = 1
		end
		if r > #list then
			r = #list
		end
	end
end

function War_StatusMenu()          ---战斗中显示状态
	local menu={ 
	{"地图选点查看",MapWatch,1},
    {"我方人员列表",FriList,1},
    {"敌方人员列表",EnemyList,1},
	};
    WAR.ShowHead = 0
    local nexty=CC.MainSubMenuY+CC.SingleLineHeight;
    ShowMenu(menu,3, 0, CC.MainSubMenuX, CC.MainSubMenuY, 0, 0, 1, 1, CC.DefaultFont, C_ORANGE, C_WHITE)
    WAR.ShowHead = 1
end

function ownMP()
	if GetS(106, 0, 0, 0) == 1 then
		return true
	end
	return false
end

function ownMPstat(flag)
	local wugong = 122
	local name = {JY.Wugong[wugong]["名称"], nil, 1, "宗师"}
	local level = {"入门弟子", "高级弟子", "掌门"}
	local attrib = {} 
	for i = 1, 9 do
		attrib[i] = JY.Wugong[wugong]["杀内力"..i] * 0.1
	end
	local askill = {GRTS[JY.Wugong[wugong]["未知4"]], GRTS[JY.Wugong[wugong]["未知5"]]}
	if flag == 1 then
		return name
	elseif flag == 2 then
		return level
	elseif flag == 3 then
		return attrib
	else
		return askill
	end
end

function MPPD(tmppid)
	if tmppid == 0 then
		tmppid = zj()
	end
	if JY.Person[tmppid]["无用"] == nil or JY.Person[tmppid]["无用"] < 101 then
		return 0
	elseif ownMP() == false and JY.Person[tmppid]["无用"] > 6300 then
		return 0
	else
		local mptype = math.floor(JY.Person[tmppid]["无用"] / 100)
		return mptype
	end
end

function MPDJ(tmppid)
	if tmppid == 0 then
		tmppid = zj()
	end
	local mpdj
	if MPPD(tmppid) == 0 then
		return 0
	end
	mpdj = math.fmod(JY.Person[tmppid]["无用"], 100)
	return mpdj
end

function MPDISPLAY(tmppid) --门派显示
	local aa = MPPD(tmppid)
	local bb = MPDJ(tmppid)
	if aa == 63 then
		local name = ownMPstat(1)
		local level = ownMPstat(2)
		local mptype = name[1]
		local mpdj = level[bb]
		return mptype, mpdj
	end
	if CC.MP[aa][1] == nil or CC.MPDJ[aa][bb] == nil then
		return nil, nil
	end
	local mptype = CC.MP[aa][1]
	local mpdj = CC.MPDJ[aa][bb]
	return mptype, mpdj
end

function JoinMP(tmppid, mptype, mpdj)
	if tmppid == 0 then
		tmppid = zj()
	end
	if tmppid == 0 and MPPD(zj()) == 11 and not (XYL(tmppid) or cxzj() == 597) and MPPD(zj()) ~= mptype then 
	   SetS(106, MPPD(zj()), 0, 0, 1)
	   SetS(106, MPPD(zj()), 1, 0, 0)
	end
	if MPPD(zj()) ~= 0 and MPPD(zj()) ~= 11 and MPPD(zj()) ~= mptype and tmppid == 0 then 
	   SetS(106, MPPD(zj()), 0, 0, 1)
	   SetS(106, MPPD(zj()), 1, 0, 0)
	end
	if GetS(106, mptype, 0, 0) == 1 and tmppid == 0 then 
	else
	JY.Person[tmppid]["无用"] = mptype * 100 + mpdj
	AddPersonAttrib(tmppid, "内力最大值", -1)
	AddPersonAttrib(tmppid, "内力最大值", 1)
	AddPersonAttrib(tmppid, "生命最大值", -1)
	AddPersonAttrib(tmppid, "生命最大值", 1)	
	if JY.Person[tmppid]["内力"] > JY.Person[tmppid]["内力最大值"] then
		JY.Person[tmppid]["内力"] = JY.Person[tmppid]["内力最大值"]
	end
	if JY.Person[tmppid]["生命"] > JY.Person[tmppid]["生命最大值"] then
		JY.Person[tmppid]["生命"] = JY.Person[tmppid]["生命最大值"]
	end	
	for num = 3, 4 do
		if JY.Person[tmppid]["HZ"..num] ~= 0 then --reset the one thats there
			local hid = JY.Person[tmppid]["HZ"..num]
			CC.HZlist[hid][3] = 0
			JY.Person[tmppid]["HZ"..num] = 0
		end
	end
	end
	--clearHZ2(tmppid)
end

function MPReq(tmppid, mptype) --队友条件
	if MPPD(tmppid) == MPPD(0) and MPDJ(tmppid) == MPDJ(0) - 1 then
		return false
	end
	if mptype == 1 then --星宿派
		if JY.Person[tmppid]["用毒能力"] >= 40 and JY.Person[tmppid]["品德"] <= 50 then
			return true
		end
	elseif mptype == 2 then --丐帮
		if JY.Person[tmppid]["内力最大值"] >= 6000 and JY.Person[tmppid]["品德"] >= 50 then
			return true
		end		
	elseif mptype == 3 then --古墓派
		if JY.Person[tmppid]["性别"] == 1 and JY.Person[tmppid]["轻功"] >= 450 then
			return true
	    end		
	elseif mptype == 4 then --武当派
		if JY.Person[tmppid]["品德"] >= 60 then
			return true
		end	
	elseif mptype == 5 then --少林寺
		if JY.Person[tmppid]["性别"] == 0 and JY.Person[tmppid]["品德"] >= 50 then
			return true
		end		
	elseif mptype == 6 then --密宗（血刀门）
		if JY.Person[tmppid]["性别"] == 0 and JY.Person[tmppid]["耍刀技巧"] >= 100 then
			return true
		end		
	elseif mptype == 7 then --逍遥派
		if JY.Person[tmppid]["资质"] >= 75 then
			return true
		end	
	elseif mptype == 8 then --白驼山
		if JY.Person[tmppid]["内力最大值"] >= 6000 and JY.Person[tmppid]["品德"] <= 50 then
			return true
		end	
	elseif mptype == 9 then --唐门
		if JY.Person[tmppid]["暗器技巧"] >= 150 then
			return true
		end			
	elseif mptype == 10 then --桃花岛
		if JY.Person[tmppid]["资质"] >= 70 and JY.Person[tmppid]["御剑能力"] >= 70 and JY.Person[tmppid]["拳掌功夫"] >= 70 then
			return true
		end			
	elseif mptype == 11 then --一刀流
		if JY.Person[tmppid]["御剑能力"] >= 300 then
			return true
		end	
	elseif mptype == 12 then --日月神教
		if JY.Person[tmppid]["品德"] <= 40 then
			return true
		end	
	elseif mptype == 13 then --明教
		if JY.Person[tmppid]["内力最大值"] >= 6000 and (JY.Person[tmppid]["耍刀技巧"] >= 150 or JY.Person[tmppid]["特殊兵器"] >= 150) then
			return true
		end
	elseif mptype == 14 then --五岳剑派
		if JY.Person[tmppid]["御剑能力"] >= 150 then
			return true
		end	
	elseif mptype == 15 then --大理
		if JY.Person[tmppid]["内力最大值"] >= 6000 and JY.Person[tmppid]["拳掌功夫"] >= 100 and JY.Person[tmppid]["品德"] >= 50 then
			return true
		end
	elseif mptype == 16 then --全真教
		if JY.Person[tmppid]["内力最大值"] >= 6000 and (JY.Person[tmppid]["御剑能力"] >= 150 or JY.Person[tmppid]["拳掌功夫"] >= 150) and JY.Person[tmppid]["品德"] >= 50 then
			return true
		end		
	elseif mptype == 17 then --峨眉派
		if JY.Person[tmppid]["性别"] == 1 and JY.Person[tmppid]["御剑能力"] >= 70 and JY.Person[tmppid]["拳掌功夫"] >= 70 and JY.Person[tmppid]["品德"] >= 50 then
			return true
	    end		
	elseif mptype == 18 then --崆峒派
		if (JY.Person[tmppid]["拳掌能力"] >= 150 or JY.Person[tmppid]["特殊兵器"] >= 150 or JY.Person[tmppid]["暗器技巧"] >= 150) and JY.Person[tmppid]["品德"] >= 50 then
			return true
	    end
	elseif mptype == 19 then --昆仑派
		if (JY.Person[tmppid]["御剑能力"] >= 150 or JY.Person[tmppid]["耍刀技巧"] >= 150) and JY.Person[tmppid]["品德"] >= 50 then
			return true
	    end	
	elseif mptype == 63 then
		return true
	end
	return false
end

function MZ(tmppid)
	if tmppid == 0 then
		tmppid = zj()
	end
	local mz=0
	if MPPD(tmppid) == 6 then
		mz=1
		if JY.Person[tmppid]["武器"]==44 or (DT(tmppid,97) and JY.Person[tmppid]["声望"]~=103) then
		mz=2
		elseif JY.Person[tmppid]["声望"]==103 then
		mz=3	
		end
	else
		
	end
	return mz
end

function GB(tmppid)
	if tmppid == 0 then
		tmppid = zj()
	end
	local mz=0
	if MPPD(tmppid) == 2 then
		mz=1
		if (JY.Person[tmppid]["防具"]>=58 and JY.Person[tmppid]["防具"]<=60)  or DT(tmppid,69) or DT(tmppid,458)  or DT(tmppid,459) then
		mz=2
		elseif (JY.Person[tmppid]["防具"]>=61 and JY.Person[tmppid]["防具"]<=63) or DT(tmppid,50) then
		mz=3	
		end
	elseif DT(tmppid,56) or DT(tmppid,58) then
     mz=2
	elseif DT(tmppid,55) or DT(tmppid,619) then
	 mz=3
	else
		
	end
	return mz
end

function War_MPMenu() --门派指令菜单
	local pid = WAR.Person[WAR.CurID]["人物编号"]
	local mptype = MPPD(pid)
	local mpdj = MPDJ(pid)
	local menu = {}
	if ownMP() and mptype == 63 then
		for i = 1, 2 do
			menu[i] = {GRTS[JY.Wugong[122]["未知"..i + 3]], nil, 1, JY.Wugong[122]["未知"..i + 3]}	
			if JY.Wugong[122]["未知"..i + 3] == 0 or GRTS[JY.Wugong[122]["未知"..i + 3]] == nil then
				menu[i][3] = 0
			end
			  if JY.Wugong[122]["未知"..i + 3] == 49 then
				local t = 0
				for i = 0, WAR.PersonNum - 1 do
				  local wid = WAR.Person[i]["人物编号"]
				  if WAR.TZ_XZ_SSH[wid] == 1 and WAR.Person[i]["死亡"] == false then
					t = 1
				  end
				end
				if t == 0 then
				  menu[i][3] = 0
				end
			  end
			  
			  if JY.Wugong[122]["未知"..i + 3] == 83 then --何铁手龙眠指令
				local yes = 0
				for i = 0, WAR.PersonNum - 1 do
					local wid = WAR.Person[i]["人物编号"]
					if WAR.Person[i]["我方"] == false and WAR.Person[i]["死亡"] == false 
						and RealJL(WAR.CurID, i, 4) and WAR.GUDUVICTIE[wid] == nil then
					yes = 1
					break
				  end
				end
				if yes == 0 then
				  menu[i][3] = 0
				end  
			  end  
			  
			   if JY.Wugong[122]["未知"..i + 3] == 76 then --王语嫣点破指令
				local yes = 0
				for i = 0, WAR.PersonNum - 1 do
					local wid = WAR.Person[i]["人物编号"]
					if WAR.Person[i]["我方"] == false and WAR.Person[i]["死亡"] == false 
						and RealJL(WAR.CurID, i, 6) then
					yes = 1
					break
				  end
				end
				if yes == 0 then
				  menu[i][3] = 0
				end  
			  end   
			  
			  if JY.Wugong[122]["未知"..i + 3] == 88 then
				local yes = 0
				for i = 0, WAR.PersonNum - 1 do
				  if WAR.Person[i]["我方"] == true and WAR.Person[i]["死亡"] == false and RealJL(WAR.CurID, i, 5) and i ~= WAR.CurID then
					yes = 1
				  end
				end
				if yes == 0 then
				   menu[i][3] = 0
				end
			  end  
			  
			  if JY.Wugong[122]["未知"..i + 3] == 89 then
				local px, py = WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"]
				local mxy = {
						{WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] + 1}, 
						{WAR.Person[WAR.CurID]["坐标X"], WAR.Person[WAR.CurID]["坐标Y"] - 1}, 
						{WAR.Person[WAR.CurID]["坐标X"] + 1, WAR.Person[WAR.CurID]["坐标Y"]}, 
						{WAR.Person[WAR.CurID]["坐标X"] - 1, WAR.Person[WAR.CurID]["坐标Y"]}}

				local yes = 0
				for i = 1, 4 do
				  if GetWarMap(mxy[i][1], mxy[i][2], 2) >= 0 then
					local mid = GetWarMap(mxy[i][1], mxy[i][2], 2)
					if inteam(WAR.Person[mid]["人物编号"]) then
						yes = 1
						end
				  end  
				end
				if yes == 0 then
				  menu[i][3] = 0
				end
			  end  
			  
			  if JY.Wugong[122]["未知"..i + 3] == 9 then
				local yes = 0
				for i = 0, WAR.PersonNum - 1 do
				  if WAR.Person[i]["我方"] == true and WAR.Person[i]["死亡"] == false and RealJL(WAR.CurID, i, 8) and i ~= WAR.CurID then
					yes = 1
				  end
				end
				if yes == 0 then
				  menu[i][3] = 0
				end
			  end  
			  
			  if JY.Wugong[122]["未知"..i + 3] == 2 or JY.Wugong[122]["未知"..i + 3] == 47 then
				local yes = 0
				for i = 0, WAR.PersonNum - 1 do
				  if WAR.Person[i]["我方"] == false and WAR.Person[i]["死亡"] == false and RealJL(WAR.CurID, i, 8) then
					yes = 1
					break
				  end
				end
				if yes == 0 then
				  menu[i][3] = 0
				end  
			  end    
		end
	else
		for i = 1, #CC.ASKILL[mptype] do
			menu[i] = {CC.ASKILL[mptype][i], nil, 1}			
		end	
	end
	local aaa = false
	for i = 1, #menu do
		if menu[i][3] == 1 then
			aaa = true
		end
	end
	if not aaa then
		Cls()
		QZXS("没有目前可用的技能")
		return 0
	end
	local r
	DrawStrBox(CC.MainSubMenuX, CC.MainSubMenuY,"门派技能", C_WHITE, CC.DefaultFont);
	if mptype == 1 then --星宿指令
		if JY.Person[pid]["体力"] < 20 then
			menu[1][3] = 0
		end
		if JY.Person[pid]["体力"] < 20 or JY.Person[pid]["内力"] < 200 then
			menu[2][3] = 0
		end
		r = ShowMenu(menu,#menu,0,CC.MainSubMenuX,CC.MainSubMenuY+CC.SingleLineHeight,0,0,1,1,CC.DefaultFont,C_ORANGE,C_WHITE);
		if r == 1 then
			CleanWarMap(4, 0)
			DIYdisplay(menu[1][1])	
			for i = 0, WAR.PersonNum - 1 do				
				if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and 
					WAR.Person[i]["死亡"] == false and RealJL(WAR.CurID, i, 3) then
					SetWarMap(WAR.Person[i]["坐标X"],WAR.Person[i]["坐标Y"], 4, 2)
					if JLSD(10, 41 + tianshu(), pid) then						
						WAR.LQZ[WAR.Person[i]["人物编号"]] = nil
						WAR.Person[i]["中毒点数"] = (WAR.Person[i]["中毒点数"] or 0) 
						+ AddPersonAttrib(WAR.Person[i]["人物编号"], "中毒程度", math.random(5, 10))
					end
				end
			end			
			War_ShowFight(pid, 0, 0, 0, WAR.Person[WAR.CurID]["坐标X"],WAR.Person[WAR.CurID]["坐标Y"], 80)	
			AddPersonAttrib(pid, "体力", -20)
			return 1
		elseif r == 2 then			
			CleanWarMap(4, 0)
			DIYdisplay(menu[2][1])
			for i = 0, WAR.PersonNum - 1 do
				if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and 
					WAR.Person[i]["死亡"] == false and xiaobin(WAR.Person[i]["人物编号"]) and 
					WAR.SXXYS[WAR.Person[i]["人物编号"]] == nil and RealJL(WAR.CurID, i, 3) then
					SetWarMap(WAR.Person[i]["坐标X"],WAR.Person[i]["坐标Y"], 4, 2)
					if JLSD(10, 41 + tianshu(), pid) then						
						WAR.SXXYS[WAR.Person[i]["人物编号"]] = 3
					end
				end
			end					
			War_ShowFight(pid, 0, 0, 0, WAR.Person[WAR.CurID]["坐标X"],WAR.Person[WAR.CurID]["坐标Y"], 114)	
			AddPersonAttrib(pid, "体力", -20)
			AddPersonAttrib(pid, "内力", -200)				
			return 1
		end
	elseif mptype == 2 then --丐帮指令
		for i = 1, #CC.ASKILL[mptype] do
			menu[i] = {CC.ASKILL[mptype][i], nil, 1}			
		end
		if JY.Person[pid]["体力"] < 15 then
			menu[1][3] = 0
		end
		if JY.Person[pid]["体力"] < 30 then
			menu[1][3] = 0
		end		
		if JY.Person[pid]["体力"] < 15 or mpdj < 3 or WAR.ZBX[pid] ~= nil then
			menu[3][3] = 0
		end
		r = ShowMenu(menu,#menu,0,CC.MainSubMenuX,CC.MainSubMenuY+CC.SingleLineHeight,0,0,1,1,CC.DefaultFont,C_ORANGE,C_WHITE);
		if r == 1 then	
			CleanWarMap(4, 0)
			DIYdisplay(menu[1][1])
			for i = 0, WAR.PersonNum - 1 do
				if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and 
					WAR.Person[i]["死亡"] == false and RealJL(WAR.CurID, i, 1) then
					SetWarMap(WAR.Person[i]["坐标X"],WAR.Person[i]["坐标Y"], 4, 2)				
					WAR.SH[WAR.Person[i]["人物编号"]] = 50
				end
			end		
			War_ShowFight(pid, 0, 0, 0, WAR.Person[WAR.CurID]["坐标X"],WAR.Person[WAR.CurID]["坐标Y"], 56)	
			AddPersonAttrib(pid, "体力", -15)
			if wglw(pid,106) or (DT(pid,9) and PersonGT(pid,106)) then 
			WAR.SH1[pid] = 35
			else
			WAR.SH1[pid] = 50
			end
		elseif r == 2 then
			CleanWarMap(4, 0)
			DIYdisplay(menu[2][1])
			for i = 0, WAR.PersonNum - 1 do
				if WAR.Person[i]["我方"] == WAR.Person[WAR.CurID]["我方"] and 
					WAR.Person[i]["死亡"] == false and RealJL(WAR.CurID, i, 1) then
					SetWarMap(WAR.Person[i]["坐标X"],WAR.Person[i]["坐标Y"], 4, 4)	
					AddPersonAttrib(WAR.Person[i]["人物编号"], "受伤程度", -100)	
				end
			end		
			War_ShowFight(pid, 0, 0, 0, WAR.Person[WAR.CurID]["坐标X"],WAR.Person[WAR.CurID]["坐标Y"], 93)	
			AddPersonAttrib(pid, "体力", -30)				
		elseif r == 3 then
			local jiu = -1 
			for i = 22, 25 do
				if hasthing(i) then
					jiu = i
					break
				end
			end
			if jiu == -1 then
				Cls()
				QZXS("没有酒了！")
				return 0
			else
				addthing(jiu, -1, 1)
				DHdisplay(97, 112, menu[3][1])
				JY.Person[pid]["体力"] = JY.Person[pid]["体力"] - 15
				addeffect(WAR.ZBX, pid, 9)
				if WAR.XYYLW2[pid] ~= nil then
					WAR.XYYLW2[pid] = nil
				end	
			end
		end
		if r > 0 then
			return 1
		end
	elseif mptype == 3 then --古墓指令
		if JY.Person[pid]["体力"] < 20 then
			menu[1][3] = 0
		end
		if JY.Person[pid]["体力"] < 25 then
			menu[2][3] = 0
		end
		r = ShowMenu(menu,#menu,0,CC.MainSubMenuX,CC.MainSubMenuY+CC.SingleLineHeight,0,0,1,1,CC.DefaultFont,C_ORANGE,C_WHITE);
		if r == 1 then
			CleanWarMap(4, 0)
			DIYdisplay(menu[1][1])
			for i = 0, WAR.PersonNum - 1 do
				local tmppid = WAR.Person[i]["人物编号"]
				if WAR.Person[i]["死亡"] == false then
					SetWarMap(WAR.Person[i]["坐标X"],WAR.Person[i]["坐标Y"], 4, 2)	
					if WAR.LQZ[tmppid] ~= nil then
						WAR.LQZ[tmppid] = math.modf(WAR.LQZ[tmppid] * 0.5)
					end
				end
			end		
			War_ShowFight(pid, 0, 0, 0, WAR.Person[WAR.CurID]["坐标X"],WAR.Person[WAR.CurID]["坐标Y"], 63)	
			AddPersonAttrib(pid, "体力", -20)				
		elseif r == 2 then
			CleanWarMap(4, 0)
			local tmpcount = 0
			for i = 0, WAR.PersonNum - 1 do
				if WAR.Person[i]["死亡"] == false and WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
					tmpcount = tmpcount + 1
				end
			end			
			if tmpcount < 2 then
				Cls()
				QZXS("没有可被魅惑的敌人！")	
				return 0
			end
			local nx, ny, victim, victimid = selectPerson(5, 1)
			if nx == -1 then
				return 0
			end
			DIYdisplay(menu[2][1])
			SetWarMap(nx, ny, 4, 2)
			War_ShowFight(pid,0,0,0,nx,ny,0);	
			local jilv = 26 + tianshu()
			if PersonKF(pid, 107) then
				jilv = jilv + 5
			end
			if JLSD(10, 10 + jilv, pid) then
				WAR.Person[victim]["我方"] = WAR.Person[WAR.CurID]["我方"] 
				WAR.NPC[victimid] = 100	
				if not xiaobin(victimid) then
					WAR.NPC[victimid] = 50
				end
				QZXS(JY.Person[victimid]["姓名"].."被魅惑！")					
			else
				QZXS(JY.Person[victimid]["姓名"].."魅惑失败！")		
			end
			SetWarMap(nx, ny, 4, -1)			
			AddPersonAttrib(pid, "体力", -25)	
		end
		if r > 0 then
			return 1
		end		
	elseif mptype == 4 then --武当指令
		if JY.Person[pid]["体力"] < 25 then
			menu[1][3] = 0
		end
		if JY.Person[pid]["体力"] < 20 or JY.Person[pid]["内力"] < 500 then
			menu[2][3] = 0
		end
		r = ShowMenu(menu,#menu,0,CC.MainSubMenuX,CC.MainSubMenuY+CC.SingleLineHeight,0,0,1,1,CC.DefaultFont,C_ORANGE,C_WHITE);
		if r == 1 then
			CleanWarMap(4, 0)
			local nx, ny, victim, victimid = selectPerson(4, 1)
			if nx == -1 then
				return 0
			end
			SetWarMap(nx, ny, 4, 2)
			War_ShowFight(pid,0,0,0,nx,ny,21);	
			SetWarMap(nx, ny, 4, -1)			
			AddPersonAttrib(pid, "体力", -25)	
			if WAR.LQZ[victimid] ~= nil then
				WAR.LQZ[victimid] = math.modf(WAR.LQZ[victimid] * 0.5)
			end
			WAR.LQZ[pid] = nil
			if WAR.YRKG[victimid] == nil then
				WAR.YRKG[victimid] = 11 + tianshu()
			else
				WAR.YRKG[victimid] = WAR.YRKG[victimid] + 11 + tianshu()
			end
		elseif r == 2 then
			CleanWarMap(4, 0)
			DHdisplay(298, 306, CC.ASKILL[mptype][r])
			AddPersonAttrib(pid, "体力", -20)
			AddPersonAttrib(pid, "内力", -500)
			WAR.YJZD[pid] = 25 - tianshu()
			WAR.Defup[pid] = 1			
		end
		if r > 0 then
			return 1
		end			
	elseif mptype == 5 then --少林指令
		if JY.Person[pid]["体力"] < 25 or JY.Person[pid]["品德"] < 50 or JY.Person[pid]["内力"] < math.modf(JY.Person[pid]["内力最大值"]*0.4) then
			menu[1][3] = 0
		end
		if JY.Person[pid]["体力"] < 20 or JY.Person[pid]["内力"] < 1000 then
			menu[2][3] = 0
		end
		if JY.Person[pid]["体力"] < 30 or JY.Person[pid]["内力"] < 3000 then
			menu[3][3] = 0
		end		
		r = ShowMenu(menu,#menu,0,CC.MainSubMenuX,CC.MainSubMenuY+CC.SingleLineHeight,0,0,1,1,CC.DefaultFont,C_ORANGE,C_WHITE);
		if r == 1 then
			CleanWarMap(4, 0)
			local tmpcount = 0
			for i = 0, WAR.PersonNum - 1 do
				if WAR.Person[i]["死亡"] == false and WAR.Person[i]["我方"] == false then
					tmpcount = tmpcount + 1
				end
			end			
			if tmpcount < 2 then
				Cls()
				QZXS("只剩一个敌人的时候无法使用")	
				return 0
			end
			local nx, ny, victim, victimid = selectPerson(4, 1)
			if nx == -1 then
				return 0
			end
			if MPPD(victimid) == 5 or JY.Person[victimid]["生命"] > math.modf(JY.Person[victimid]["生命最大值"]/2) then
			Cls()
			say("目标不可被点化") 
			   return 0
			else
			Cls()
			say("放下屠刀，立地成佛！",pid,0,JY.Person[pid]["姓名"]) 		
			SetWarMap(nx, ny, 4, 2)
			War_ShowFight(pid,0,0,0,nx,ny,104);	
			local jc = math.modf((WAR.SPIRIT[pid] - WAR.SPIRIT[victimid])*0.3)
			local jilv = math.modf(((JY.Person[pid]["品德"]) - 50) / 5) + tianshu()
			if xiaobin(victimid) then
				jilv = jilv + 5
			end
			if JLSD(10, 16 + jilv + jc, pid) then
				QZXS(JY.Person[victimid]["姓名"].."退场！")
				WAR.Person[victim]["死亡"] = true
				lib.SetWarMap(nx, ny, 5, -1)
				lib.SetWarMap(nx, ny, 2, -1)					
			else
				QZXS(JY.Person[victimid]["姓名"].."点化失败！")		
			end
			SetWarMap(nx, ny, 4, -1)			
			AddPersonAttrib(pid, "体力", -25)
			AddPersonAttrib(pid, "内力", -math.modf(JY.Person[pid]["内力"]*0.5))
			end
		elseif r == 2 then
			CleanWarMap(4, 0)
			DHdisplay(1365, 1381, CC.ASKILL[5][2])
			AddPersonAttrib(pid, "体力", -20)
			AddPersonAttrib(pid, "内力", -200)
			WAR.JG[pid] = 40 + math.modf(tianshu() * 5)			
		elseif r == 3 then
			Cls()
			say("苦--海--无--边--回--头--是--岸-----",pid,0,JY.Person[pid]["姓名"]) 		
			local sq = math.modf(JY.Person[pid]["内力"] / 15)
			for e = 0, WAR.PersonNum - 1 do
				local tmppid = WAR.Person[e]["人物编号"]
				if WAR.Person[e]["死亡"] == false and WAR.Person[e]["我方"] ~= WAR.Person[WAR.CurID]["我方"]
					and JY.Person[pid]["内力"] > JY.Person[tmppid]["内力"] then
					WAR.Person[e].TimeAdd = WAR.Person[e].TimeAdd - sq
				end
			end		
			DrawTimeBar2()
			AddPersonAttrib(pid, "体力", -30)
			AddPersonAttrib(pid, "内力", -math.modf(JY.Person[pid]["内力"] / 2))
		end
		if r > 0 then
			return 1
		end		
	elseif mptype == 6 then --血刀门指令
		if JY.Person[pid]["体力"] < 15 or WAR.XUEMO[pid] ~= nil or
			JY.Person[pid]["生命"] < math.modf(JY.Person[pid]["生命最大值"] * 0.5) then
			menu[1][3] = 0
		end
		if JY.Person[pid]["体力"] < 25 or WAR.HUANXUE[pid] ~= nil or
			JY.Person[pid]["生命"] < math.modf(JY.Person[pid]["生命最大值"] * 0.5) then
			menu[2][3] = 0
		end
		r = ShowMenu(menu,#menu,0,CC.MainSubMenuX,CC.MainSubMenuY+CC.SingleLineHeight,0,0,1,1,CC.DefaultFont,C_ORANGE,C_WHITE);
		if r == 1 then
			CleanWarMap(4, 0)
			DHdisplay(890, 913, CC.ASKILL[6][1])
			AddPersonAttrib(pid, "体力", -15)
			addeffect(WAR.XUEMO, pid, 1)
			addeffect(WAR.LQZ, pid, 100)
		elseif r == 2 then	
			CleanWarMap(4, 0)
			local nx, ny, victim, victimid = selectPerson(4, 1)
			if nx == -1 then
				return 0
			end
			Cls()
			SetWarMap(nx, ny, 4, 2)
			DIYdisplay(CC.ASKILL[6][2])
			War_ShowFight(pid,0,0,0,nx,ny,98);	
			QZXS(JY.Person[victimid]["姓名"].."与"..JY.Person[pid]["姓名"].."血量交换")		
			SetWarMap(nx, ny, 4, -1)			
			AddPersonAttrib(pid, "体力", -25)	
			local tmpratio1 = JY.Person[pid]["生命"] / JY.Person[pid]["生命最大值"]
			local tmpratio2 = JY.Person[victimid]["生命"] / JY.Person[victimid]["生命最大值"]
			JY.Person[pid]["生命"] = math.modf(tmpratio2 * JY.Person[pid]["生命最大值"])
			JY.Person[victimid]["生命"] = math.modf(tmpratio1 * JY.Person[victimid]["生命最大值"])
			if JY.Person[pid]["生命"] < 1 then JY.Person[pid]["生命"] = 1 end
			if JY.Person[victimid]["生命"] < 1 then JY.Person[victimid]["生命"] = 1 end			
			addeffect(WAR.HUANXUE, pid, 1)
		end
		if r > 0 then
			return 1
		end			
	
	elseif mptype == 7 then
		if JY.Person[pid]["体力"] < 15 or JY.Person[pid]["内力"] < 300 then
			menu[1][3] = 0
		end
		if JY.Person[pid]["体力"] < 20 or WAR.LB[pid] ~= nil then
			menu[2][3] = 0
		end
		r = ShowMenu(menu,#menu,0,CC.MainSubMenuX,CC.MainSubMenuY+CC.SingleLineHeight,0,0,1,1,CC.DefaultFont,C_ORANGE,C_WHITE);
		if r == 1 then
			Cls()		
			for e = 0, WAR.PersonNum - 1 do
				local tmppid = WAR.Person[e]["人物编号"]
				if WAR.Person[e]["死亡"] == false then
					addeffect(WAR.BZ, tmppid, 1)
					if tmppid == pid then
						addeffect(WAR.BZ, tmppid, 2)
					end
				end
			end		
			DHdisplay(1694, 1705, "唯不争，故天下莫能与之争")
			AddPersonAttrib(pid, "体力", -15)
			AddPersonAttrib(pid, "内力", -300)
		elseif r == 2 then	
			addeffect(WAR.LB, pid, 3)
			DHdisplay(1345, 1364, CC.EVB174)
			AddPersonAttrib(pid, "体力", -20)
		end
		if r > 0 then
			return 1
		end		
	elseif mptype == 8 then --白驼指令 武骧金星：实装白驼山指令
		if JY.Person[pid]["体力"] < 30 or JY.Person[pid]["内力"] < 300 then
			menu[1][3] = 0
		end
		if JY.Person[pid]["体力"] < 20 then
			menu[2][3] = 0
		end
		r = ShowMenu(menu,#menu,0,CC.MainSubMenuX,CC.MainSubMenuY+CC.SingleLineHeight,0,0,1,1,CC.DefaultFont,C_ORANGE,C_WHITE);
		if r == 1 then
			Cls()		
			for e = 0, WAR.PersonNum - 1 do
				local tmppid = WAR.Person[e]["人物编号"]
				if WAR.Person[e]["我方"] then
					if WAR.JD[pid] == nil then
						WAR.JD[pid] = JY.Person[tmppid]["中毒程度"]
					else
						WAR.JD[pid] = WAR.JD[pid] + JY.Person[tmppid]["中毒程度"]
					end					
					JY.Person[tmppid]["中毒程度"] = 0
				end
			end		
			DHdisplay(890, 910, "白驼山秘技 万毒归元")
			AddPersonAttrib(pid, "体力", -30)
			AddPersonAttrib(pid, "内力", -300)
		elseif r == 2 then	
			War_ActupMenu()
			War_DefupMenu()
			if PersonKF(pid, 95) then
				if WAR.tmp[200 + pid] == nil or WAR.tmp[200 + pid] == 0 then
					WAR.tmp[200 + pid] = 50;
				else
					WAR.tmp[200 + pid] = WAR.tmp[200 + pid] + 35;
				end
			end
			AddPersonAttrib(pid, "体力", -20)
		end
		if r > 0 then
			return 1
		end				
	elseif mptype == 9 then --唐门指令
		local num = 0
		local list = {}
		for i = 0, WAR.PersonNum - 1 do
			local wid = WAR.Person[i]["人物编号"]
			if WAR.Person[i]["我方"] == false and WAR.Person[i]["死亡"] == false 
				and RealJL(WAR.CurID, i, 10) then
				num = num + 1
				list[num] = {wid, WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"]}
			end
		end				
		if JY.Person[pid]["体力"] < 50 or JY.Person[pid]["内力"] < 5000 or num == 0 then --or anqinum() < 10 武骧金星：取消暗器数量判断
			menu[1][3] = 0
		end		
		r = ShowMenu(menu,#menu,0,CC.MainSubMenuX,CC.MainSubMenuY+CC.SingleLineHeight,0,0,1,1,CC.DefaultFont,C_ORANGE,C_WHITE);					
		if r == 1 then
			AddPersonAttrib(pid, "体力", -25)
			AddPersonAttrib(pid, "内力", -1000)
			for j = 1, 10 do
				local victim = math.random(#list)
				local anqi = randomanqi()
				War_ExecuteMenu_Sub(list[victim][2], list[victim][3], 4, anqi)
				num = 0
				list = {}
				for i = 0, WAR.PersonNum - 1 do
					local wid = WAR.Person[i]["人物编号"]
					if WAR.Person[i]["我方"] == false and WAR.Person[i]["死亡"] == false 
						and JY.Person[wid]["生命"] > 0 and RealJL(WAR.CurID, i, 10) then
						num = num + 1
						list[num] = {wid, WAR.Person[i]["坐标X"], WAR.Person[i]["坐标Y"]}
					end
				end				
				if num == 0 then
					break
				end
			end
			return 1
		elseif r == 2 then
            if WAR.TMMS[pid] == 1 then 	
            WAR.TMMS[pid] = 2 
			QZXS("切换为天罗诡道！")	
            else 
            WAR.TMMS[pid] = 1
			QZXS("切换为惊羽决！")
            end			
		end	
	elseif mptype == 10 then --沼跃鱼：实装桃花岛指令
		if JY.Person[pid]["体力"] < 50 or JY.Person[pid]["内力"] < 500 then
			menu[1][3] = 0
		end
		if JY.Person[pid]["体力"] < 20 or WAR.BHMJ ~= 0 then
			menu[2][3] = 0
		end
		r = ShowMenu(menu,#menu,0,CC.MainSubMenuX,CC.MainSubMenuY+CC.SingleLineHeight,0,0,1,1,CC.DefaultFont,C_ORANGE,C_WHITE);
		if r == 1 then
			Cls()		
			for e = 0, WAR.PersonNum - 1 do
				local tmppid = WAR.Person[e]["人物编号"]
				if WAR.Person[e]["我方"] then
					if WAR.JH[pid] == nil then
						WAR.JH[pid] = JY.Person[tmppid]["受伤程度"]
					else
						WAR.JH[pid] = WAR.JH[pid] + JY.Person[tmppid]["受伤程度"]
					end					
					JY.Person[tmppid]["受伤程度"] = 0
				end
			end		
			DHdisplay(890, 910, "桃花岛秘药 九花玉露")
			AddPersonAttrib(pid, "体力", -30)
			AddPersonAttrib(pid, "内力", -300)
		elseif r == 2 then	
			WAR.BHMJ = 3
			DHdisplay(1345, 1364, CC.EVB174)
			AddPersonAttrib(pid, "体力", -20)
		end
		if r > 0 then
			return 1
		end	
	elseif mptype == 11 then --豸苗：谢云流一刀流指令
		if JY.Person[pid]["体力"] < 15 then
			menu[1][3] = 0
		end 
		if JY.Person[pid]["体力"] < 25 then
			menu[2][3] = 0
		end
		r = ShowMenu(menu,#menu,0,CC.MainSubMenuX,CC.MainSubMenuY+CC.SingleLineHeight,0,0,1,1,CC.DefaultFont,C_ORANGE,C_WHITE);
			if r == 1 then
				DHdisplay(2182, 2197, "秘剑・切返")
				JY.Person[pid]["体力"] = JY.Person[pid]["体力"] - 15
				addeffect(WAR.PD, pid, 5)
			elseif r == 2 then
				DHdisplay(2197, 2219,"斩流・切返")
				JY.Person[pid]["体力"] = JY.Person[pid]["体力"] - 20
				addeffect(WAR.LW, pid, 5)
			end
				if r > 0 then
			return 1
		end	
	elseif mptype == 12 then --豸苗：日月神教
		if JY.Person[pid]["体力"] < 25 or WAR.SSNSD >= 1 then
			menu[1][3] = 0
		end 
		if JY.Person[pid]["体力"] < 25 then
			menu[2][3] = 0
		end
		r = ShowMenu(menu,#menu,0,CC.MainSubMenuX,CC.MainSubMenuY+CC.SingleLineHeight,0,0,1,1,CC.DefaultFont,C_ORANGE,C_WHITE);
			if r == 1 then
			CleanWarMap(4, 0)
			local tmpcount = 0
			for i = 0, WAR.PersonNum - 1 do
				if WAR.Person[i]["死亡"] == false and WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] then
					tmpcount = tmpcount + 1
				end
			end			
			if tmpcount < 2 then
				Cls()
				QZXS("没有可被控制的敌人！")	
				return 0
			end
			local nx, ny, victim, victimid = selectPerson(5, 1)
			if nx == -1 then
				return 0
			end
			if JY.Person[victimid]["生命"] > math.modf(JY.Person[victimid]["生命最大值"]/2) then
				Cls()
				QZXS("目标不可使用！")
			    return 0
			else	
			DIYdisplay(menu[1][1])
			SetWarMap(nx, ny, 4, 2)
			War_ShowFight(pid,0,0,0,nx,ny,0);	
			WAR.SSNS[victimid] = 500	
		    QZXS(JY.Person[victimid]["姓名"].."被控制！")		
			SetWarMap(nx, ny, 4, -1)			
			AddPersonAttrib(pid, "体力", -25)
			WAR.SSNSD = WAR.SSNSD + 1
			end
		    elseif r == 2 then
						    DHdisplay(2197, 2219,"逆杀")
							CleanWarMap(4, 0)
					   		local x1 = WAR.Person[WAR.CurID]["坐标X"];
			                local y1 = WAR.Person[WAR.CurID]["坐标Y"];
			                for ex = x1 - 5, x1 + 5 do
				            for ey = y1 - 5, y1 + 5 do
					            SetWarMap(ex, ey, 4, 1)
					        if GetWarMap(ex, ey, 2) ~= nil and GetWarMap(ex, ey, 2) > -1 then
						        local ep = GetWarMap(ex, ey, 2)
						        if WAR.Person[WAR.CurID]["我方"] ~= WAR.Person[ep]["我方"] then
							       WAR.LXZT[WAR.Person[ep]["人物编号"]] = 100
                                   WAR.NS[WAR.Person[ep]["人物编号"]] = 100
							       SetWarMap(ex, ey, 4, 4)
						        end
					        end
				            end
			                end
			            War_ShowFight(pid,0,0,0,x1,y1,30);
						AddPersonAttrib(pid, "体力", -25)							
			end	
		if r > 0 then
			return 1
		end	
elseif mptype == 13 then --沼跃鱼：明教
		if JY.Person[pid]["体力"] < 50 then
			menu[1][3] = 0
		end 
		if JY.Person[pid]["体力"] < 25 or JY.Person[pid]["内力"] < 500 then
			menu[2][3] = 0
		end
		r = ShowMenu(menu,#menu,0,CC.MainSubMenuX,CC.MainSubMenuY+CC.SingleLineHeight,0,0,1,1,CC.DefaultFont,C_ORANGE,C_WHITE);
			if r == 1 then
			   if (WAR.LQZ[pid] == nil or WAR.LQZ[pid] < 100) and JY.Person[pid]["生命"]>=math.modf(JY.Person[pid]["生命最大值"]*0.25) then
							DrawStrBoxWaitKey("条件不符，不可使用", C_WHITE, 30)
							return 0
			   end
						WAR.LQZ[pid] = nil
						WAR.MJZBDS[pid] = JY.Person[pid]["内力"]
						WAR.MJZBDS[pid] = 150 + math.modf(WAR.MJZBDS[pid] / 10) 
						WAR.MJZBDS[pid] = math.modf(WAR.MJZBDS[pid]*(3-JY.Person[pid]["生命"]/JY.Person[pid]["生命最大值"]))
						for i = 1864, 1879 do
							CurIDTXDH(WAR.CurID, i, i, "怜我世人，忧患实多");		--动画显示	
							lib.Delay(10)
						end						
						WAR.MJZB[pid] = 1
						WAR.MJZB2[pid] = 1
						local nx, ny, victim, victimid = selectPerson(7, 1)
						if nx == -1 then
							return 0
						end
						CleanWarMap(4, 0)
						for i = 0, WAR.PersonNum - 1 do
							if WAR.Person[i]["我方"] ~= WAR.Person[WAR.CurID]["我方"] and 
								WAR.Person[i]["死亡"] == false and RealJL(victim, i, 3) then
								SetWarMap(WAR.Person[i]["坐标X"],WAR.Person[i]["坐标Y"], 4, 2)
								JY.Person[WAR.Person[i]["人物编号"]]["生命"] = JY.Person[WAR.Person[i]["人物编号"]]["生命"]-WAR.MJZBDS[pid]
								WAR.HOT[WAR.Person[i]["人物编号"]] = limitX((WAR.HOT[WAR.Person[i]["人物编号"]] or 0) + math.modf(WAR.MJZBDS[pid]/100), 0, 100)
								AddPersonAttrib(WAR.Person[i]["人物编号"], "受伤程度", math.modf(WAR.MJZBDS[pid]/100))
							end
						end		
						for i = 0, WAR.PersonNum - 1 do
							if WAR.Person[i]["我方"] == WAR.Person[WAR.CurID]["我方"] and WAR.Person[i]["死亡"] == false then
								local bid = WAR.Person[i]["人物编号"]
								if wglw2(bid,194) == true then
									if JLSD(10,30,bid) then
										WAR.LQZ[bid] = 100
									end
								end
							end
						end	
									
						War_ShowFight(pid, 0, 0, 0, WAR.Person[WAR.CurID]["坐标X"],WAR.Person[WAR.CurID]["坐标Y"], 111)	
						for i = 2197, 2219 do
							CurIDTXDH(WAR.CurID, i, i, "喜乐悲愁，皆归尘土");		--动画显示	
							lib.Delay(10)
						end							
						WAR.MJZB[pid] = 0
						WAR.MJZB2[pid] = 0
						JY.Person[pid]["生命"] = 0
						WAR.Person[WAR.CurID]["死亡"] = true
						--[[
                        JY.Person[pid]["内力"] = 0
						JY.Person[pid]["生命"] = 1
                        AddPersonAttrib(pid, "体力", -25)
                        AddPersonAttrib(pid, "受伤程度", 100)
						]]
		    elseif r == 2 then
				    if JY.Person[pid]["体力"] > 25 and WAR.MJCJ>0 then
						local nx, ny, victim, victimid = selectPerson(7, 1)
						if nx == -1 then
							return 0
						end
						CleanWarMap(4, 0)
						SetWarMap(WAR.Person[victim]["坐标X"],WAR.Person[victim]["坐标Y"], 4, 2)
						QZXS("我指认面前的敌人是光明的死敌，邪恶的帮凶！")
						WAR.MJBCJ[victimid] = WAR.MJBCJ[victimid] or 0 + 1
						--WAR.LQZ[victimid] = 0
						War_ShowFight(pid, 0, 0, 0, WAR.Person[WAR.CurID]["坐标X"],WAR.Person[WAR.CurID]["坐标Y"], 145)	
						AddPersonAttrib(pid, "体力", -20)
						WAR.MJCJ=WAR.MJCJ-1						
					else
						DrawStrBoxWaitKey("条件不符，不可使用", C_WHITE, 30)
						return 0
					end
						AddPersonAttrib(pid, "体力", -25)							
			end	
		if r > 0 then
			return 1
		end	
elseif mptype == 14 then --沼跃鱼：五岳剑派
		if JY.Person[pid]["体力"] < 50 or JY.Person[pid]["内力"] < 500 then
			menu[1][3] = 0
		end 
		if JY.Person[pid]["体力"] < 25 or JY.Person[pid]["内力"] < 500 then
			menu[2][3] = 0
		end
		r = ShowMenu(menu,#menu,0,CC.MainSubMenuX,CC.MainSubMenuY+CC.SingleLineHeight,0,0,1,1,CC.DefaultFont,C_ORANGE,C_WHITE);
			if r == 1 then


			for i = 1251, 1257 do
				CurIDTXDH(WAR.CurID, i, i, "剑宗秘传.夺命连环三仙剑");		--动画显示	
				lib.Delay(10)
			end
			WAR.SXJ  = 1
			War_FightMenu()
			if wglw2(pid,198) then
			else
				AddPersonAttrib(pid, "体力", -30)
			end	
			AddPersonAttrib(pid, "内力", -1000)
            WAR.SXJ = 0			
		elseif r == 2 then
            for i = 97, 112 do
				CurIDTXDH(WAR.CurID, i, i, "寒冰秘法.冰封天下");		--动画显示	
				lib.Delay(10)
			end
			WAR.BFTX = 1
			War_FightMenu()
	        AddPersonAttrib(pid, "内力", -1500) 
		    if wglw2(pid,198) then
			else
			AddPersonAttrib(pid, "体力", -25)
			end
			WAR.BFTX = 0			
	   end	
		if r > 0 then
			return 1
		end	
elseif mptype == 15 then --沼跃鱼：大理
		if JY.Person[pid]["体力"] < 25 or JY.Person[pid]["内力"] < 500 then
			menu[1][3] = 0
		end 
		if JY.Person[pid]["体力"] < 50 or JY.Person[pid]["内力"] < 2500 then
			menu[2][3] = 0
		end
		r = ShowMenu(menu,#menu,0,CC.MainSubMenuX,CC.MainSubMenuY+CC.SingleLineHeight,0,0,1,1,CC.DefaultFont,C_ORANGE,C_WHITE);
			if r == 1 then
			local str=""
			local a=0
                if JLSD(20,30,pid) then
				a=1
				else
				a=math.random(2,4)
                end
           local WZTS = {"残悔","新血愁","足三里","手三里"}
            str=WZTS[a]		   
			for i =2197, 2219 do
				CurIDTXDH(WAR.CurID, i, i, "秘孔战术"..str);		--动画显示	
				lib.Delay(10)
			end
			WAR.MKZS = a
			War_FightMenu()
			AddPersonAttrib(pid, "体力", -30)
			AddPersonAttrib(pid, "内力", -1000)
            WAR.MKZS = 0			
		elseif r == 2 then
            for i = 97, 112 do
				CurIDTXDH(WAR.CurID, i, i, "天南大理.转龙呼吸法");		--动画显示	
				lib.Delay(10)
			end
			if DT(pid, 65) then
            WAR.Person[WAR.CurID].Time = 980
	        WAR.LQZ[pid]=WAR.LQZ[pid] or 0 + 100
	        if WAR.LQZ[pid]>=100 then
	        WAR.LQZ[pid]=100
	        end
	        WAR.WCY4 = 2
			end
			WAR.HIDE[pid]=100
			WAR.QFY1[pid]=100
	        AddPersonAttrib(pid, "内力", -2500) 
		    AddPersonAttrib(pid, "体力", -25)			
	   end	
		if r > 0 then
			return 1
		end	
elseif mptype == 16 then --沼跃鱼：全真
		if JY.Person[pid]["体力"] < 25 or JY.Person[pid]["内力"] < 500 then
			menu[1][3] = 0
		end 
		if JY.Person[pid]["体力"] < 50 or JY.Person[pid]["内力"] < 2500 then
			menu[2][3] = 0
		end
		r = ShowMenu(menu,#menu,0,CC.MainSubMenuX,CC.MainSubMenuY+CC.SingleLineHeight,0,0,1,1,CC.DefaultFont,C_ORANGE,C_WHITE);
			if r == 1 then
			for i = 1251, 1257 do
				CurIDTXDH(WAR.CurID, i, i, "重阳遗剑.真打一击");		--动画显示	
				lib.Delay(10)
			end
			if DT(pid, 129) then
	        WAR.LQZ[pid]=WAR.LQZ[pid] or 0 + 100
	        if WAR.LQZ[pid]>=100 then
	        WAR.LQZ[pid]=100
	        end
	        WAR.WCY3 = 1
			end
			WAR.CYYJ  = 1
			War_FightMenu()
			AddPersonAttrib(pid, "体力", -30)
			AddPersonAttrib(pid, "内力", -1000)
            WAR.CYYJ= 0				
		elseif r == 2 then
			local aa=math.modf(JY.Person[pid]["生命最大值"]-JY.Person[pid]["生命"])
			local bb=math.modf(JY.Person[pid]["内力"])
			   if bb>aa*10 then
							DrawStrBoxWaitKey("条件不符，不可使用", C_WHITE, 30)
							return 0
			   end
            for i = 97, 112 do
				CurIDTXDH(WAR.CurID, i, i, "重阳秘法.气返先天");		--动画显示	
				lib.Delay(10)
			end
			if DT(pid, 129) then
            WAR.Person[WAR.CurID].Time = 1000
	        WAR.LQZ[pid]=WAR.LQZ[pid] or 0 + 100
	        if WAR.LQZ[pid]>=100 then
	        WAR.LQZ[pid]=100
	        end
	        WAR.WCY3 = 2
			end
			JY.Person[pid]["内力"]=JY.Person[pid]["内力"]-aa*10
			JY.Person[pid]["生命"]=JY.Person[pid]["生命最大值"]
			for i = 0, WAR.PersonNum - 1 do
				local tmppid = WAR.Person[i]["人物编号"]
				if WAR.Person[i]["死亡"] == false and WAR.Person[i]["我方"] then
				  AddPersonAttrib(tmppid, "受伤程度", -100)
				end
			end
		    AddPersonAttrib(pid, "体力", -25)			
	    end	
		if r > 0 then
			return 1
		end				
elseif mptype == 17 then --峨眉
		if JY.Person[pid]["体力"] < 50 or JY.Person[pid]["内力"] < 500 then
			menu[1][3] = 0
		end
		if JY.Person[pid]["体力"] < 20 or WAR.BHMJ ~= 0 then
			menu[2][3] = 0
		end
		r = ShowMenu(menu,#menu,0,CC.MainSubMenuX,CC.MainSubMenuY+CC.SingleLineHeight,0,0,1,1,CC.DefaultFont,C_ORANGE,C_WHITE);
		if r == 1 then
			Cls()
			say("南--明--离--火--剑-----!!!",pid,0,JY.Person[pid]["姓名"]) 		
			local sq = math.modf(JY.Person[pid]["内力"] / 10)
			for e = 0, WAR.PersonNum - 1 do
				local tmppid = WAR.Person[e]["人物编号"]
				if WAR.Person[e]["死亡"] == false and WAR.Person[e]["我方"] ~= WAR.Person[WAR.CurID]["我方"]
					and JY.Person[pid]["内力"] > JY.Person[tmppid]["内力"] then
					WAR.Person[e].TimeAdd = WAR.Person[e].TimeAdd - sq
				end
			end		
			DrawTimeBar2()
			AddPersonAttrib(pid, "体力", -20)
			AddPersonAttrib(pid, "内力", -math.modf(JY.Person[pid]["内力"] / 2))
		elseif r == 2 then	
			WAR.DUO = 1
			Cls()		
			for e = 0, WAR.PersonNum - 1 do
				local tmppid = WAR.Person[e]["人物编号"]
				if WAR.Person[e]["我方"] then
					if WAR.JH[pid] == nil then
						WAR.JH[pid] = JY.Person[tmppid]["受伤程度"]
					else
						WAR.JH[pid] = WAR.JH[pid] + JY.Person[tmppid]["受伤程度"]
					end					
					JY.Person[tmppid]["受伤程度"] = 0
				end
			end		
			DHdisplay(2121, 2134, "三阳归一")
			AddPersonAttrib(pid, "体力", -20)
		end
		if r > 0 then
			return 1
		end		
elseif mptype == 18 then --崆峒
		if JY.Person[pid]["体力"] < 50 or JY.Person[pid]["内力"] < 500 then
			menu[1][3] = 0
		end
		r = ShowMenu(menu,#menu,0,CC.MainSubMenuX,CC.MainSubMenuY+CC.SingleLineHeight,0,0,1,1,CC.DefaultFont,C_ORANGE,C_WHITE);
		if r == 1 then
			for i = 1124, 1141 do
				CurIDTXDH(WAR.CurID, i, i, "分光两仪 阴柔共济");		--动画显示	
				lib.Delay(10)
			end	
			WAR.KTAY1 = 1
			War_FightMenu()
			AddPersonAttrib(pid, "体力", -25)
			AddPersonAttrib(pid, "内力", -3000)
		elseif r == 2 then	
			WAR.KTAY2 = 1
			Cls()		
			DHdisplay(1442, 1458, "九天都录")
			AddPersonAttrib(pid, "体力", -20)
			AddPersonAttrib(pid, "内力", -2000)
		end
		if r > 0 then
			return 1
		end			
elseif mptype == 19 then --昆仑
		if JY.Person[pid]["体力"] < 50 or JY.Person[pid]["内力"] < 500 then
			menu[1][3] = 0
		end
		r = ShowMenu(menu,#menu,0,CC.MainSubMenuX,CC.MainSubMenuY+CC.SingleLineHeight,0,0,1,1,CC.DefaultFont,C_ORANGE,C_WHITE);
		if r == 1 then
			Cls()
			say("身演两仪，敌若微尘！！",pid,0,JY.Person[pid]["姓名"]) 		
			WAR.KLLY1[pid] = 1
			AddPersonAttrib(pid, "体力", -20)
			AddPersonAttrib(pid, "内力", -2500)
		elseif r == 2 then	
			WAR.KLLY2[pid] = 50		
			DHdisplay(2121, 2134, "大静神")
		end
		if r > 0 then
			return 1
		end
elseif mptype == 63 then
		r = ShowMenu(menu,#menu,0,CC.MainSubMenuX,CC.MainSubMenuY+CC.SingleLineHeight,0,0,1,1,CC.DefaultFont,C_ORANGE,C_WHITE)
		if r > 0 then
			local tmp = War_TgrtsMenu(1, menu[r][4])
			if tmp > 0 then
				WAR.OWN = 0
			end
			return tmp
		end	
end		
end

function dark()
	instruct_14()
end

function light()
	instruct_13()
end

function hasthing(pp)
	return instruct_18(pp)
end

function hasppl(pp)
	return instruct_16(pp)
end

function addthing(pp, num, flag)
	if num == nil then
		num = 1
	end
	if flag == 1 then
		instruct_32(pp, num)
	else
		instruct_2(pp, num)
	end
end

function addeffect(eft, pp, num)
	--if T9ZY(pp) then
	--	eft[0] = num
	--	eft[582] = num
	--else
	eft[pp] = num
	--end
end

function reseteffect(eft, pp)
	if eft[pp] ~= nil then
		--if T9ZY(pp) then
		--	eft[0] = eft[0] - 1
		--	eft[582] = eft[582] - 1
		--else
		eft[pp] = eft[pp] - 1
		--end	
		if eft[pp] <= 0 then
			eft[pp] = nil
		end
	end
end

function PDReq(pid, str, aa, bb)
	if JY.Person[pid][str] >= aa and JY.Person[pid][str] <= bb then
		return true
	else
		return false
	end
end

function MPAttrib(pid, att)	
	local function tox(aa)
		local str = ""
		if aa == 1 then
			str = "攻击力"
		elseif aa == 2 then
			str = "防御力"
		elseif aa == 3 then
			str = "轻功"
		end
		return str
	end
	local add = 0
	if MPPD(pid) == 0 then
		add = CC.MPAttrib[MPPD(pid)][att]	
	else
		if ownMP() and MPPD(pid) == 63 then
			if att > 9 then
				add = 0 
			else
				add = JY.Wugong[122]["杀内力"..att] * 0.1
			end
		else
			add = CC.MPAttrib[MPPD(pid)][att]
		end
		if MPPD(pid) == 4 and MPDJ(pid) > 2 then
			if att == 1 then
				add = 1.1
			elseif att == 2 then
				add = 1.1
			end
		end
		if att == 1 then		
			add = math.modf(add * JY.Person[pid]["攻击力"] - JY.Person[pid]["攻击力"]) 
		elseif att == 2 then
			add = math.modf(add * JY.Person[pid]["防御力"] - JY.Person[pid]["防御力"]) 
		elseif att == 3 then
			add = math.modf(add * JY.Person[pid]["轻功"] - JY.Person[pid]["轻功"]) 
		end		
	end	
	if att == 4 then
		if getHZ(pid, 18) then
			add = add + 100
		end
		if hasTF(pid, 5) then
			add = add + 250
		end
	end
	if att == 5 then
		if getHZ(pid, 19) then
			add = add + 100
		end	
		if hasTF(pid, 6) then
			add = add + 250
		end		
	end
	if att == 1 or att == 2 or att == 3 then
		if getHZ(pid, 6) then
			add = add + math.modf(JY.Person[pid][tox(att)] * 0.1) 
		end
	end
	if att == 1 then
		if hasTF(pid, 7) then
			add = add + math.modf(JY.Person[pid][tox(att)] * 0.2) 
		end
	elseif att == 2 then
		if hasTF(pid, 8) then
			add = add + math.modf(JY.Person[pid][tox(att)] * 0.2) 
		end	
	elseif att == 3 then
		if hasTF(pid, 9) then
			add = add + math.modf(JY.Person[pid][tox(att)] * 0.2) 
		end	
	end
	return add
end

function PJPD(pp)
	if GetS(106, pp, 0, 0) ~= 0 then
		return true
	else
		return false
	end
end

--返回数字
function ZYHBJL(pid)
  local zyjl = 75 - JY.Person[pid]["资质"]
  if zyjl < 0 then
    zyjl = 0
  end
  if DT(pid, 64) then
    zyjl = 100
  end
  if T2SQ(pid) then
    zyjl = 40
  end
  if T2SQ(pid) and juexing() > 1 then --水镜2次觉醒后左右几率70%
    zyjl = 70
  end
	if T3XYK(pid) then
		zyjl = 40
	end
	if wglw(pid,999) then --豸苗：左右奥义
		zyjl = zyjl + 30
	end	
	
	if DT(pid,618) then --豸苗：左右奥义
		zyjl = zyjl + 30
	end	
	
  if T4WXS(pid) then --王小石左右互搏初始几率25%
	zyjl = 25
	if juexing() > 1 then zyjl = 50 end --二次觉醒后左右几率50%
  end
  
  if DT(pid,72) and JX(pid) then --田归农刀剑十杀领悟左右初始几率25%
	zyjl = 50
  end
  
  if (wglw1(pid,77) or ((DT(pid,605) or DT(pid,627))and JX(pid))) then --倒乱刃领悟
	zyjl = 60
  end
  
  if T7DFWM(pid) and juexing() > 2 then --东方未明3次觉醒后左右几率50%
	zyjl = 50
  end

  zyjl = zyjl + zuoyouhubo(pid)
  if zyjl > 100 then zyjl = 100 end
  return zyjl
end

function JLJL(pid)
	if JY.Person[pid]["声望"] <= 0 or not yongnei(JY.Person[pid]["声望"]) then
		return 0
	end
	local bjl = 20	
	for i = 1, #CC.ExtraGT do --+20
		if DT(pid, CC.ExtraGT[i][1]) and PersonGT(pid, CC.ExtraGT[i][2]) then
			bjl = bjl + 20
			break
		end
	end		
	
	if JY.Status == GAME_WMAP then
		if pid == 0 and putong() == 11 then
			if WAR.PLJZ["加力率"] ~= nil then
				bjl = bjl + WAR.PLJZ["加力率"]
			end
		end
	end		
	
	if DT(pid, 48)  then
		bjl = bjl + 10
	end
	
	if DT(pid, 68) or DT(pid, 123) or DT(pid, 124) or DT(pid, 125) or 
		DT(pid, 126) or DT(pid, 127) or DT(pid, 128) then
		if WAR.ZDDH == 73 then
			bjl = bjl + 14
		else
			bjl = bjl + 7
		end	
	end		
	
	if pid == 0 and putong() == 5 then --天罡越多内功加成越多
		bjl = bjl + 5 * wgnumber(0, 5)
	end
	bjl =  math.modf(attribRandom(pid, bjl, 1)*0.7)
	
	if JY.Person[pid]["声望"] > 0 and yongnei(JY.Person[pid]["声望"]) and PersonTFGT(pid,JY.Person[pid]["声望"]) then 
	   bjl = bjl + 20 
	end 
	if MPPD(pid) == 11 and JY.Person[pid]["声望"] == 180 then
	   bjl = bjl + 20
	end
	if pid == 0 and putong() == 6 then --仁者+20
		bjl = bjl + 20
	end
	if pid == 0 and JY.Person[pid]["声望"] == 9999 then
		bjl = bjl + 20
	end
	if MPPD(pid) == 5 and PersonGT(pid,183) and MPDJ(pid) > 1 then
		bjl = bjl + 30
	end	
	if JY.Person[pid]["武学常识"] > 10 then 
		bjl = bjl + math.modf(JY.Person[pid]["武学常识"] / 10) 
	end
	if PersonGT(pid,184) then
		bjl = 100
	end
	if wglw(pid,94)then
		bjl = 100
	end
	--以上是加力机率加成
	--以下是加力机率削弱
	if JY.Status == GAME_WMAP then
		if WAR.ZDNS[pid] ~= nil then
			bjl = bjl - 30
		end
		if WAR.YMH[pid] ~= nil and WAR.YMH[pid] > 0 then
			if bjl > 10 then bjl = 10 end
		end
	end	
	--加力机率最终结算
	if bjl > 75 then
		if pid == 0 and bjl > 85 and (putong() == 5 or putong() == 6) then --天罡越多内功加成越多
			bjl = 85
		else
			bjl = 75
		end	
	end
	--逍遥子特别保障加力机率
	if bjl < 100 then
		if DT(pid, 600) or hasTF(pid, 105) or DT(pid,665) or (DT(pid,632) and PersonKF(pid,94)) or (DT(pid, 9) and JY.Person[pid]["声望"] == 106) or (MPPD(pid) == 5 and PersonGT(pid,183) and MPDJ(pid) > 1 and wglw(pid,183)) then
			bjl = 100
		end
	end
	--逍遥子特别保障加力机率
	return limitX(bjl, 0, 100)
end

function HTJL(eid)
	if JY.Person[eid]["声望"] <= 0 or not yongnei(JY.Person[eid]["声望"]) then
		return 0
	end

	local bht = 20
	for i = 1, #CC.ExtraGT do --+20
		if DT(eid, CC.ExtraGT[i][1]) and PersonGT(eid, CC.ExtraGT[i][2]) then
			bht = bht + 20
			break
		end
	end
	
	if JY.Status == GAME_WMAP then
		if eid == 0 and putong() == 11 then
			if WAR.PLJZ["护体率"] ~= nil then
				bht = bht + WAR.PLJZ["护体率"]
			end
		end
	end	
	
	if DT(eid, 48) then
		bht = bht + 10
	end
	
	if DT(eid, 68) or DT(eid, 123) or DT(eid, 124) or DT(eid, 125) or 
		DT(eid, 126) or DT(eid, 127) or DT(eid, 128) then
		if WAR.ZDDH == 73 then
			bht = bht + 14
		else
			bht = bht + 7
		end	
	end			
	
	if eid == 0 and putong() == 5 then --天罡越多内功加成越多
		bht = bht + 5 * wgnumber(0, 5)
	end
	
	bht =  math.modf(attribRandom(eid, bht, 2)*0.7)
	if JY.Person[eid]["声望"] > 0 and yongnei(JY.Person[eid]["声望"]) and PersonTFGT(eid,JY.Person[eid]["声望"]) then 
	   bht = bht + 20 
	end 
	if eid == 0 and putong() == 6 then --仁者+20
		bht = bht + 20
	end
	if MPPD(eid) == 11 and JY.Person[eid]["声望"] == 180 then
	   bht = bht + 20
	end
	if eid == 0 and JY.Person[eid]["声望"] == 9999 then
		bht = bht + 20
	end		
	if JY.Person[eid]["武学常识"] > 10 then 
		bht = bht + math.modf(JY.Person[eid]["武学常识"] / 10) 
	end
	if PersonGT(eid,184)then
		bht = 100
	end	
	if MPPD(eid) == 5 and PersonGT(eid,183) and MPDJ(eid) > 1 then
		bht = bht + 30
	end
	--以上为护体机率加成
	--以下为护体机率削弱
	if JY.Status == GAME_WMAP then
		if WAR.BPLW5 == 1 then
			local aa = WAR.ICE[eid]
			bht = bht - (math.ceil(aa/15))
		end
		if WAR.ZDNS[eid] ~= nil then
			bht = bht - 30
		end
		if WAR.YMD[eid] ~= nil and WAR.YMD[eid] > 0 then
			if bht > 10 then bht = 10 end
		end	
		if WAR.XQFJ[eid] ~= nil and WAR.XQFJ[eid] > 30 and JLSD(10,40,eid) then --血脉咒杀
			bht = bht - 15
		end	
	end
	--护体机率最后限制
	if bht > 75 then
		if eid == 0 and bht > 85 and (putong() == 5 or putong() == 6) then
			bht = 85
		else
			bht = 75
		end
	end	
	--个别人物特别保障护体机率
	if bht < 100 then
		if DT(eid, 600) or hasTF(eid, 106) or DT(eid,665) or (MPPD(eid) == 5 and PersonGT(eid,183) and MPDJ(eid) > 1 and wglw(eid,183)) then
			bht = 100
		end
	end
	return limitX(bht, 0, 100)
end

function LJJL(pid)
	local LJ1 = (JY.Person[pid]["轻功"] + MPAttrib(pid, 3)) / 30
	local LJ2 = (JY.Person[pid]["内力最大值"] + JY.Person[pid]["内力"]) / 2000
	local LJ3 =JY.Person[pid]["资质"] / 10
	local LJ4 = (11 - JY.Person[pid]["生命增长"]) * 2
	local LJ = 0
	LJ = math.modf(LJ1 + LJ2 + LJ3 + LJ4)
	if not inteam(pid) then   
		LJ = LJ + 10    --敌人连击+10
	end
	if PersonKF(pid, 47) then --独孤九剑连击+10
		LJ = LJ + 10
	end

	
	if T4WXS(pid) then --王小石剑法加连击
		LJ = LJ + math.modf(JY.Person[pid]["御剑能力"]/ 10)  --每个剑法加3连击
	end
		
	if T1LEQ(pid) and juexing() > 0 then   --零二七，观武后连击+20
		LJ = LJ + 20
	end
	
	if MPPD(pid) == 12 then --日月神教
	local mpdj = MPDJ(pid)
		LJ = LJ + 10*mpdj
	end
	
	if DT(pid, 140) then     --风清扬，连击+10
		LJ = LJ + 10
	end  

	if MPPD(pid) == 3 then
		LJ = LJ + 10
	end  
	if PersonKF(pid, 121) then --玉女心经加连击
		LJ = LJ + 10
		if PersonGT(pid, 121) then
			LJ = LJ + 5
		end
	end

	if DT(pid, 68) or DT(pid, 123) or DT(pid, 124) or DT(pid, 125) or 
		DT(pid, 126) or DT(pid, 127) or DT(pid, 128) then
		LJ = LJ + 14
	end
	
	if JY.Status == GAME_WMAP then
		if pid == 0 and putong() == 11 then
			if WAR.PLJZ["连击率"] ~= nil then
				LJ = LJ + WAR.PLJZ["连击率"] * 2
			end
		end
		if DT(pid, 625) then
			for j = 0, WAR.PersonNum - 1 do
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"]
					and WAR.Person[j]["人物编号"] == 77 then
					LJ = 200
				end
			end
		end	
		if DT(pid, 77) then
			for j = 0, WAR.PersonNum - 1 do
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"]
					and WAR.Person[j]["人物编号"] == 0 and JY.Person[578]["觉醒"] > 0 then
					LJ = 200
				end
			end
		end	
	end
	
  	if getHZ(pid, 11) then	--涅印
  		LJ = LJ + math.modf(JY.Person[pid]["受伤程度"] * 0.2)    		
  	end    
 
  	if getHZ(pid, 12) then	--狂龙令
  		LJ = LJ + 30;      		
  	end      	
	if DT(pid, 36) and JX(pid) then
		LJ = LJ + 50     	
	end  
	--令狐冲，变身之后，增加50的连击
	if DT(pid, 35) and JX(pid) then
		LJ = LJ + 50
	end	
    local jp = math.modf(JY.Person[pid]["实战"] / 50)   --实战加连击
    LJ = LJ + jp

	LJ = LJ + lianji(pid)		
	if getHZ(pid, 27) then
		LJ = 200
	end
	if JY.Person[pid]["武学常识"] > 10 then LJ = LJ + math.modf(JY.Person[pid]["武学常识"] / 10) end
	LJ = limitX(LJ, 0, 200)
	return math.modf(LJ / 200 * 100)
end
function BJJL(pid)
    local BJ1 = (JY.Person[pid]["攻击力"] + MPAttrib(pid, 1)) / 30
    local BJ2 = (JY.Person[pid]["内力最大值"] + JY.Person[pid]["内力"]) / 2000
    local BJ3 =JY.Person[pid]["体力"] / 10
	local BJ4 = JY.Person[pid]["生命增长"] * 2
	local BJ = 0
    BJ = math.modf(BJ1 + BJ2 + BJ3 + BJ4)

    if not inteam(pid) then
    	BJ = BJ + 10     --敌人+10点
    end

	if JY.Status == GAME_WMAP then
		if pid == 0 and putong() == 11 then
			if WAR.PLJZ["暴击率"] ~= nil then
				BJ = BJ + WAR.PLJZ["暴击率"] * 2
			end
		end
		if WAR.SXTJ <= 100 then
			if DT(pid, 8) or DT(pid, 167) or DT(pid, 167) then
				BJ = 200
			end
		end
		if DT(pid, 77) then
			for j = 0, WAR.PersonNum - 1 do
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"]
					and WAR.Person[j]["人物编号"] == 625 then
					BJ = 200
				end
				if WAR.Person[j]["死亡"] == false and WAR.Person[j]["我方"] == WAR.Person[WAR.CurID]["我方"]
					and WAR.Person[j]["人物编号"] == 0 and JY.Person[578]["觉醒"] > 0 then
					BJ = 200
				end
			end
		end	
	end	
	
	if DT(pid, 68) or DT(pid, 123) or DT(pid, 124) or DT(pid, 125) or 
		DT(pid, 126) or DT(pid, 127) or DT(pid, 128) then
		BJ = BJ + 14
	end	
	if MPPD(pid) == 9 then --唐门模式1
		BJ = BJ + 40
	end
	if DT(pid, 12) then
		BJ = 200
	end
	if DT(pid,50) then 
	    BJ = BJ + 60
	end	
	if PersonGT(pid, 153) then --临济加暴击
		BJ = BJ + 15
	elseif PersonKF(pid, 153) then
		BJ = BJ + 10
	end
	if PersonGT(pid, 178) or T9ZY(pid) then --擒龙加暴击
		BJ = BJ + 10
	end	
	if MPPD(pid) == 6 and MZ(pid)== 2 then
		BJ = BJ + 30
	end
  	if getHZ(pid, 11) then	--涅印
  		BJ = BJ + math.modf(JY.Person[pid]["受伤程度"] * 0.2)      		
  	end    	
  	if getHZ(pid, 12) then	--狂龙令
  		BJ = BJ + 30;      		
  	end 
	
	if MPPD(pid) == 12 then --日月神教
	local mpdj = MPDJ(pid)
--		BJ = BJ + 10*mpdj
	end
	
	if T1LEQ(pid) and juexing() > 0 then   --零二七，观武后暴击+20
		BJ = BJ + 20
	end	
  	if T9ZY(pid) and JY.Person[pid]["武器"] == 255 and juexing() >= 2 then --赵云+亮银枪
		BJ = BJ + 15
	end
	if T4WXS(pid) then --王小石刀法加暴击
		BJ = BJ +math.modf(JY.Person[pid]["耍刀技巧"]/ 10) --每个刀法加3暴击
	end	
	local jp = math.modf(JY.Person[pid]["实战"] / 50)   --实战加成
	BJ = BJ + jp	
	BJ = BJ + baoji(pid)	
	
	if DT(pid, 58) then
		if JY.Person[pid]["生命"] < JY.Person[pid]["生命最大值"] / 4 then
			BJ = BJ + 60
		elseif JY.Person[pid]["生命"] < JY.Person[pid]["生命最大值"] / 2 then
			BJ = BJ + 30
		end
	end
	if JY.Person[pid]["武学常识"] > 10 then BJ = BJ + math.modf(JY.Person[pid]["武学常识"] / 10) end
	BJ = limitX(BJ, 0, 200)
	
	return math.modf(BJ / 200 * 100) 
end	

function WGWL(pid, wugong, level)
  local wgwl = 0
  
  if level > 10 then
    wgwl = JY.Wugong[wugong]["攻击力" .. 10]
  else
    wgwl = JY.Wugong[wugong]["攻击力" .. level]
  end
  
  if wgwl < 1000 and hasTF(pid, 160) then
	wgwl = 0
  end
  
  local num = 0
  for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
	if JY.Person[pid]["武功" .. i] == wugong and JY.Person[pid]["武功等级" .. i] > 999 then	
		local tmp = JY.Person[pid]["武功等级" .. i] - 999
		local tmp2 = math.modf((JY.Wugong[wugong]["等级"] / 2) + 1)
		wgwl = wgwl + math.modf(tmp / tmp2)
		local tmp3 = math.modf((100 - JY.Person[pid]["资质"]) / 25) + 1
		--tmp3 = math.min(2, 1 + tmp3 * 0.5)
		tmp3 = 2
		if wgwl > math.modf(JY.Wugong[wugong]["攻击力" .. 10] * tmp3) + JY.Wugong[wugong]["上限"] then
			wgwl = math.modf(JY.Wugong[wugong]["攻击力" .. 10] * tmp3) + JY.Wugong[wugong]["上限"] 
		end	
		break
	end
  end
  
  if SJL(pid) and wugong == 131 then --豸苗：森九岚
	--local q = wgnumber(pid, 2)
	wgwl = 500 + math.modf(JY.Person[pid]["实战"]*5)
  end 
 
  if wugong == 131 and not XYL(pid) and not SJL(pid) and not jtyl(pid) then --豸苗：一刀流谢无悠
	--local q = wgnumber(pid, 2)
	wgwl = 500 + math.modf(JY.Person[pid]["实战"]*5)
	if wgwl > 3000 then 
	   wgwl = 3000 
	end   
  end
  
  --天赋武功12.26
  for i,v in ipairs(CC.TFWG) do
    if ((v[1] == pid) or (v[1] == cxzj() and pid == 0)) and v[2] == wugong then
      wgwl = math.modf(wgwl*v[3])
	  break
    end
  end
  --天赋武功12.26
  if pid == 0 and (putong() > 0 or teshu() > 0) and wugong == GetS(112,1,0,0) then
	  wgwl = math.modf(wgwl*1.3)					
  end--12.26
  --天赋武功12.26
  if pid == 0 and (putong() > 0 or teshu() > 0) and wugong == GetS(112,2,0,0) then
	  wgwl = math.modf(wgwl*1.3)					
  end--12.26
  if pid == 0 and (putong() > 0 or teshu() > 0) and wugong == GetS(112,4,0,0) then
	  wgwl = math.modf(wgwl*1.3)					
  end
  if pid == 92 and wugong == JY.Person[578]["攻击力"] then
	  wgwl = math.modf(wgwl*1.3)
  end
  if wglw(pid,592) and (wugong == 45 or wugong == 47) then 
	  wgwl = math.modf(wgwl*1.3)			
  end
  --天赋武功12.26
  for i,v in ipairs(CC.TFWG1) do
    if ((v[1] == pid) or (v[1] == cxzj() and pid == 0)) and v[2] == wugong then
      wgwl =  math.modf(wgwl*v[3])
	  break
    end
  end
  for i,v in ipairs(CC.TFNG) do
    if ((v[1] == pid) or (v[1] == cxzj() and pid == 0)) and v[2] == wugong then
      wgwl = math.modf(wgwl*v[3]/2)
	  break
    end
  end
  for i,v in ipairs(CC.TFNG1) do
    if ((v[1] == pid) or (v[1] == cxzj() and pid == 0)) and v[2] == wugong then
      wgwl = math.modf(wgwl*v[3]/2)
	  break
    end
  end
  for i,v in ipairs(CC.ExtraOffense) do
    if v[1] == JY.Person[pid]["武器"] and v[2] == wugong then
      wgwl = wgwl + v[3]
	  break
    end
  end
  
  for i,v in ipairs(CC.ZGT11) do --内功伤害加成
    if (v[1] == wugong or (T12YMZ(pid) and wugong == 112)) and (PersonGT(pid, v[2]) or ((PersonGT(pid,9999) and (JY.Thing[224]["加攻击力"]) == v[2] or JY.Thing[224]["加防御力"]) == v[2])) then
	  wgwl = wgwl + v[3]
	  break
    end
  end 
  --and (PersonGT(pid, v[2]) or ((PersonGT(pid,9999) and (JY.Thing[224]["加攻击力"]) == v[2] or JY.Thing[224]["加防御力"]) == v[2]) then
  for i,v in ipairs(CC.ZGT11) do --1-26-
    if (v[1] == WAR.HLTX or v[2] == WAR.HLTX) and (wglw(pid,102) or (DT(pid,38) and PersonKF(pid,102))) then
	  wgwl = wgwl + v[3]
	  break
    end
  end
  for i,v in ipairs(CC.ZGT11) do --豸苗：折梅手
	for l = 1,10 do
	local jl = 15 + math.modf(JY.Person[pid]["实战"] / 20)+ math.modf(JY.Person[pid]["武学常识"] / 10)
	    if wugong == 14 and (JLSD(0,5+jl,pid) or (MPPD(pid)==7 and JLSD(0,15,pid))) and JY.Person[pid]["内力"] >= 7000 then
	    if JY.Person[pid]["武功" .. l] == v[1] then
	  wgwl = wgwl + v[3]
	  WAR.ZMS = 1
	  break
      end
	  end 
	end
  end 
  
  if wugong >= 30 and wugong <= 34 then --武骧金星：五岳剑法增加威力
	local jiacheng = 0
	if wugong ~= 30 and PersonKF(pid, 30) then jiacheng = jiacheng + 1 end
	if wugong ~= 31 and PersonKF(pid, 31) then jiacheng = jiacheng + 1 end
	if wugong ~= 32 and PersonKF(pid, 32) then jiacheng = jiacheng + 1 end
	if wugong ~= 33 and PersonKF(pid, 33) then jiacheng = jiacheng + 1 end
	if wugong ~= 34 and PersonKF(pid, 34) then jiacheng = jiacheng + 1 end
	wgwl = wgwl + jiacheng * 50  
  end

  if DT(pid, 614) and yongjian(wugong) then --阿青剑法加成
	--local q = wgnumber(pid, 2)
	wgwl = wgwl + sixi(pid, 2) --武骧金星：修正BUG
  end 
  
  if XYL(pid) and yongjian(wugong) then --豸苗：谢云流剑法加成
	--local q = wgnumber(pid, 2)
	wgwl = wgwl + 200 --武骧金星：修正BUG
  end  
  
  if XYL(pid) and wugong == 131 then --豸苗：谢云流剑法加成
    if juexing() == 0 then
        JY.Wugong[131]["攻击力10"] = 500
	elseif juexing() == 1 then
        JY.Wugong[131]["攻击力10"] = 1000  
	elseif juexing() == 2 then
        JY.Wugong[131]["攻击力10"] = 1500
	end
  end

  if pid == 0 and WAR.XTG == 1 then
     wgwl = math.modf(wgwl * 1.5)
  end 
  
  if hasTF(pid, 125) then
	wgwl = math.modf(wgwl * 1.5)
  end
  if txjid(pid) and yongjian(wugong) then 
    wgwl = math.modf(wgwl * 1.3)
  end
  if hasTF(pid, 1) and yongquan(wugong) then
	wgwl = math.modf(wgwl * 1.2)
  end
  if hasTF(pid, 2) and yongjian(wugong) then
	wgwl = math.modf(wgwl * 1.2)
  end
  if hasTF(pid, 3) and yongdao(wugong) then
	wgwl = math.modf(wgwl * 1.2)
  end
  if hasTF(pid, 4) and yongte(wugong) then
	wgwl = math.modf(wgwl * 1.2)
  end  
  if hasTF(pid, 148) and yongan(wugong) then
	wgwl = math.modf(wgwl * 1.2)
  end  
  
  if wglw1(pid, 58) and wugong==58 then
	wgwl = wgwl+1000
  end  
  
  if wglw1(pid, 57) and wugong==57 then
	wgwl = wgwl+1000
  end  
  
  if wglw1(pid, 5) and wugong==5 then
	wgwl = wgwl+1500
  end
  
  if wglw1(pid, 13) and wugong==13 then
	wgwl = wgwl+1000
  end
  if wglw1(pid,68) and wugong == 68 then
		wgwl = wgwl + 2000
	end
  if PersonGT(pid, 151) and MPPD(pid) == 5 then --不动明王特定武功威力
   if wugong == 20 then
   wgwl = wgwl+750
   elseif wugong == 22 then
   wgwl = wgwl+500
   else
   
   end
  end
  
  if DT(pid,80) and JX(pid) then
    if wugong == 36 then
   wgwl = wgwl+750
   elseif wugong == 46 then
   wgwl = wgwl+500
   else
   
   end
  end
  
  	--飞影彩蛋：真龙心法所有武功威力+50%
	if PersonKF(pid, 91) and inteam(pid) and JY.ZLXF == 1 then	
		wgwl = math.modf(wgwl * 1.5)
	end
  
    --安七
	if DT(pid,456) then	
		wgwl = math.modf(wgwl * 1.5)
	end

  if yongjian(wugong) then --紫霞增加剑系威力
	if PersonGT(pid, 89) then
		wgwl = math.modf(wgwl * 1.15)
	elseif PersonKF(pid, 89) then
		wgwl = math.modf(wgwl * 1.1)
	end
	if wglw(pid,96) and PersonGT(pid, 89) and MPPD(pid)==14 then
		wgwl = math.modf(wgwl * 1.25)
	end
  end
  
  if yongte(wugong) then --罗汉伏魔增加特系威力
	if PersonGT(pid, 96) then
		wgwl = math.modf(wgwl * 1.15)
	elseif PersonKF(pid, 96) then
		wgwl = math.modf(wgwl * 1.1)
	end	
	if wglw(pid,96) and PersonGT(pid, 96) and MPPD(pid)==5 then
	    wgwl = math.modf(wgwl * 1.25)
	end
  end
  
  if yongdao(wugong) then --圣火神功增加刀系威力
	if PersonGT(pid, 93) then
		wgwl = math.modf(wgwl * 1.15)
	elseif PersonKF(pid, 93) then
		wgwl = math.modf(wgwl * 1.1)
	end
	if wglw(pid,96) and PersonGT(pid, 96) and MPPD(pid)==5 then
	    wgwl = math.modf(wgwl * 1.25)
	end
  end
  
  if yongquan(wugong) then --金关玉锁增加拳系威力
	if PersonGT(pid, 150) then
		wgwl = math.modf(wgwl * 1.15)
	elseif PersonKF(pid, 150) then
		wgwl = math.modf(wgwl * 1.1)
	end	
  end
  
  if yongan(wugong) then --天南易阳增加暗系威力
	if PersonGT(pid, 152) then
		wgwl = math.modf(wgwl * 1.15)
	elseif PersonKF(pid, 152) then
		wgwl = math.modf(wgwl * 1.1)
	end	
  end
  if fqdid(pid) and wugong == 62 then 
     wgwl = wgwl *2
  end  
  return wgwl
end

function setGT(pid, gt)
	JY.Person[pid]["声望"] = gt
end

--人物升级
function War_AddPersonLVUP(pid)
  local tmplevel = JY.Person[pid]["等级"]
  if CC.Level <= tmplevel then
    return false
  end
  if JY.Person[pid]["经验"] < CC.Exp[tmplevel] then
    return false
  end
  while CC.Exp[tmplevel] <= JY.Person[pid]["经验"] do
    tmplevel = tmplevel + 1
    if CC.Level <= tmplevel then
    	break;
    end
  end
  
  DrawStrBoxWaitKey(string.format(CC.WARS125, JY.Person[pid]["姓名"]), C_WHITE, CC.DefaultFont)
  --计算提升的等级
	local leveladd = tmplevel - JY.Person[pid]["等级"]
	
	JY.Person[pid]["等级"] = JY.Person[pid]["等级"] + leveladd
	
	--提高生命增长
	AddPersonAttrib(pid, "生命最大值", (JY.Person[pid]["生命增长"] + 5) * leveladd * 3) --武骧金星：简单起见
	
	JY.Person[pid]["生命"] = JY.Person[pid]["生命最大值"]
	JY.Person[pid]["体力"] = CC.PersonAttribMax["体力"]
	JY.Person[pid]["受伤程度"] = 0
	JY.Person[pid]["中毒程度"] = 0
	
	--属性点资质加成
	local function cleveradd()
	  local ca, rndnum = nil, nil
	  if CC.Debug then
	    rndnum = math.random(1)
	  else
	    rndnum = math.random(1)
	  end
	  ca = JY.Person[pid]["资质"] / 5 --武骧金星：简单起见 (rndnum + 4)
	  return ca
	end
	
	local theadd = cleveradd()
	--聪明人内力加少。。。
	--增加内力的成长
	AddPersonAttrib(pid, "内力最大值", math.modf(leveladd * ((26 - JY.Person[pid]["生命增长"]) * 6 + 250 / (theadd + 1))))
	
	--天罡内力每级额外加20
	if pid == 0 and putong() == 5 then
	  AddPersonAttrib(pid, "内力最大值", 20 * leveladd)
	end
	
	
	JY.Person[pid]["内力"] = JY.Person[pid]["内力最大值"]
	
	--循环提升等级，累加属性
	for i = 1, leveladd do
	  --local ups = math.modf((JY.Person[pid]["资质"] - 1) / 15) + 1 --资质1-15，1点
	  local ups = 1
	  --[[
	  --令狐冲 内伤回复前，每级3点
	  if pid == 35 and GetD(82, 1, 0) == 1 then
	    ups = 3
	  end
	  
	  --郭靖 20级之后，每级6点
	  if pid == 55 and JY.Person[pid]["等级"] > 20 then
	    ups = 6
	  end
	  
	  --零二七，每级8点
	  if T1LEQ(pid) then
	    ups = 8
	  end
	  
	  --难度额外加成
	  if JY.Thing[202][WZ7] == 2 then
	    ups = ups + 2
	  end
	   
	  if JY.Thing[202][WZ7] >= 3 then --难度3加3点
	    ups = ups + 3
	  end
	  ]] --武骧金星：取消高难度下的额外加成
	  
	  AddPersonAttrib(pid, "攻击力", ups)
	  AddPersonAttrib(pid, "防御力", ups)
	  AddPersonAttrib(pid, "轻功", ups)
	 --[[ 
	  if pid==0 then --主角额外加1
		  local sanwei=math.random(3)
		  if sanwei==1 then
			AddPersonAttrib(pid, "攻击力", 1)
		  elseif sanwei==2 then
			AddPersonAttrib(pid, "防御力", 1)
		  else
			AddPersonAttrib(pid, "轻功", 1)	  
		  end
	  end]]
	  
	  --修复医疗、用毒、解毒能力不与等级挂钩的问题
	  if JY.Person[pid]["医疗能力"] >= 20 then
  		--AddPersonAttrib(pid, "医疗能力", math.random(5))
		AddPersonAttrib(pid, "医疗能力", 5)	--武骧金星：升级最大成长
		end
		if JY.Person[pid]["用毒能力"] >= 20 then
  		--AddPersonAttrib(pid, "用毒能力", math.random(5))
		AddPersonAttrib(pid, "用毒能力", 5)
		end
		if JY.Person[pid]["解毒能力"] >= 20 then
  		--AddPersonAttrib(pid, "解毒能力", math.random(5))
		AddPersonAttrib(pid, "解毒能力", 5)
		end
		
		--陈家洛 升级加四围
		if pid == 75 then 
		  if JY.Person[pid]["拳掌功夫"] >= 0 then
		    --AddPersonAttrib(pid, "拳掌功夫", (1 + math.random(3)))
			AddPersonAttrib(pid, "拳掌功夫", 4)
		  end
		  if JY.Person[pid]["御剑能力"] >= 0 then
		    --AddPersonAttrib(pid, "御剑能力", (3 + math.random(4)))
			AddPersonAttrib(pid, "御剑能力", 7)
		  end
		  if JY.Person[pid]["耍刀技巧"] >= 0 then
		    --AddPersonAttrib(pid, "耍刀技巧", (3 + math.random(4)))
			AddPersonAttrib(pid, "耍刀技巧", 7)
		  end
		  if JY.Person[pid]["特殊兵器"] >= 0 then
		  	--AddPersonAttrib(pid, "特殊兵器", (3 + math.random(4)))
			AddPersonAttrib(pid, "特殊兵器", 7)
		  end
		  if JY.Person[pid]["暗器技巧"] >= 0 then	--武骧金星：增加暗器成长
			AddPersonAttrib(pid, "暗器技巧", 7)
		  end		  
		end
		
		if ZJ(pid) and cxzj() == 75 then
			if JY.Person[pid]["拳掌功夫"] >= 0 then
				--AddPersonAttrib(pid, "拳掌功夫", (1 + math.random(3)))
				AddPersonAttrib(pid, "拳掌功夫", 4)
			end
			if JY.Person[pid]["御剑能力"] >= 0 then
				--AddPersonAttrib(pid, "御剑能力", (1 + math.random(3)))
				AddPersonAttrib(pid, "御剑能力", 4)
			end
			if JY.Person[pid]["耍刀技巧"] >= 0 then
				--AddPersonAttrib(pid, "耍刀技巧", (1 + math.random(3)))
				AddPersonAttrib(pid, "耍刀技巧", 4)
			end
			if JY.Person[pid]["特殊兵器"] >= 0 then
				--AddPersonAttrib(pid, "特殊兵器", (1 + math.random(3)))
				AddPersonAttrib(pid, "特殊兵器", 4)
			end
			if JY.Person[pid]["暗器技巧"] >= 0 then
			    --AddPersonAttrib(pid, "暗器技巧", (1 + math.random(3)))
				AddPersonAttrib(pid, "暗器技巧", 4)
			end			
		end		

	end

	local ey = 1;  --每级的随机点数

  --[[武骧金星：取消高难度下的额外加成
  --难度额外加成 难度3有3点
  if JY.Thing[202][WZ7] > 1 then
    ey = ey + 1;
  end
  if JY.Thing[202][WZ7] > 2 then
    ey = ey + 1;
  end
  ]]
  
  --[[if getHZ(pid, 16) then  ivansz 懒得换印信
  if hasHZ(16) then
	ey = ey + 1
  end
  ]]
  ey = ey + tianzi(pid)
  --增加随机点数
  --ey = ey + 5
  
		local extra = math.modf((JY.Person[pid]["资质"] - 1) / 5) --资质1-5，0分配，5资质一档，一档为1
		
		extra = extra + 8
		
		extra = extra + math.modf((JY.Person[pid]["资质"]) / 20) --资质1-19 0，每高20+1
		
  	  --if pid == 35 and GetD(82, 1, 0) == 1 then
	  --  extra=extra-5
	  --end
	  if T1LEQ(pid) then
	    extra = extra + 3
	  end
	  --extra = extra * 2
	  extra = extra * leveladd
	  local sanwei = 3 --武骧金星：固定升级成长
	  while extra ~= 0 do
		  --local sanwei=math.random(3)	
		  if sanwei==1 then
			AddPersonAttrib(pid, "防御力", 1)
		  elseif sanwei==2 then
			AddPersonAttrib(pid, "攻击力", 1)
		  else
			AddPersonAttrib(pid, "轻功", 1)	  
		  end	  
		  extra = extra - 1
		  sanwei = sanwei - 1
		  if sanwei <= 0 then
			sanwei = 3
		  end
	  end
	  
	--ey=ey+extra
  
 --以下为变动部分 
  
local n = ey*leveladd;		--计算随机额外点数
	local gj = JY.Person[pid]["攻击力"];
  local fy = JY.Person[pid]["防御力"];
  local qg = JY.Person[pid]["轻功"];
  local ee=0
  local ff=0
  local gg=0
  local tmpN = n;
	repeat
  	Cls();
  	
		local title = JY.Person[pid]["姓名"].." 升级随机点分配";
		local str = string.format("☆剩余的额外随机升级点数：%d 点☆*攻击：%d + %d*防御：%d + %d*轻功：%d + %d",tmpN, gj, ee, fy, ff, qg, gg);
		local btn = {"自动","加攻","加防","加轻","重置","确定"};
		local num = #btn;
		local r = JYMsgBox(title,str,btn,num);
		
		local T = {}
    for a = 0, 1000 do
      local b = "" .. a
      T[b] = a
    end
    

        if r == 1 then
          local e1=math.random(n) 
		  ee=e1
		  gj = JY.Person[pid]["攻击力"]+e1
		  
		  if gj>CC.PersonAttribMax["攻击力"] then
		  gj=CC.PersonAttribMax["攻击力"]
		  end
		  
		  
		  
		  
		  local f1=n-e1
		  if f1==0 then
		  f1=1
		  end		  
		  local e2=math.random(f1)
		  local f2={0,1}
		  
		  if e2==1 then
		  e2=f2[math.random(2)]
		  end
		  if e1+e2>n then
		  e2=0
		  end
		  
		  ff=e2
		  fy = JY.Person[pid]["防御力"]+e2
		  
		  if fy>CC.PersonAttribMax["防御力"] then
		  fy=CC.PersonAttribMax["防御力"]
		  end
		  
		  local e3=n-e1-e2
		  local qy=math.random(100)
		  
		  if qy == 1 then
		  	local x1 = CC.ScreenW/2 - 200 ;
	        local y1 = 100
			
		  DrawStrBoxWaitKey("天降奇缘！轻功额外增加1点～恭喜！", C_GOLD, CC.DefaultFont)
		  e3=e3+1
		  end
		  gg=e3
  		  qg = JY.Person[pid]["轻功"]+e3
		  
		  
		  if qg>CC.PersonAttribMax["轻功"] then
		  qg=CC.PersonAttribMax["轻功"]
		  end
		  
  	      tmpN = 0
          		 

	    elseif r ==  2 then			--输入攻击力
	    local r = GetPinyin1(32, CC.ScreenH - CC.Fontbig * 6)
	    if T[r] == 0 or r == "" then

	    elseif T[r] ~= nil and T[r] > -1 and T[r] <= tmpN then
		  ee=T[r]
	      gj =  gj + T[r]
		  
		  if gj>CC.PersonAttribMax["攻击力"] then
		  gj=CC.PersonAttribMax["攻击力"]
		  end
		  
		  
	      tmpN = tmpN-T[r];

	    else
	    	DrawStrBoxWaitKey("对不起，你输入的攻击力数据不正确!", C_WHITE, 30)
	    end
		
		elseif r ==  3 then		--输入防御力
	    local r = GetPinyin1(32, CC.ScreenH - CC.Fontbig * 6)
	    if T[r] == 0 or r == "" then

	    elseif T[r] ~= nil and T[r] > -1 and T[r] <= tmpN then
		  ff=T[r]
	      fy =  fy + T[r]
		  
		  if fy>CC.PersonAttribMax["防御力"] then
		  fy=CC.PersonAttribMax["防御力"]
		  end
		  
	      tmpN = tmpN-T[r];
	    else
	    	DrawStrBoxWaitKey("对不起，你输入的防御力数据不正确!", C_WHITE, 30)
	    end

		elseif r ==  4 then		--输入轻功
	    local r = GetPinyin1(32, CC.ScreenH - CC.Fontbig * 6)
	    if T[r] == 0 or r == "" then
    		
	    elseif T[r] ~= nil and T[r] > -1 and T[r] <= tmpN then
		gg=T[r]
	      qg =  qg + T[r]
		  
		  if qg>CC.PersonAttribMax["轻功"] then
		  qg=CC.PersonAttribMax["轻功"]
		  end
		  
	      tmpN = tmpN-T[r];
	    else
	    	DrawStrBoxWaitKey("对不起，你输入的轻功数据不正确!", C_WHITE, 30)
	    end
		elseif r == 5 then
			gj = JY.Person[pid]["攻击力"];
  	  fy = JY.Person[pid]["防御力"];
  		qg = JY.Person[pid]["轻功"];
  	  tmpN = n;
	  ee=0
	  gg=0
	  ff=0
		
		elseif r == 6 then
			if tmpN > 0 then
				DrawStrBoxWaitKey("对不起，"..JY.Person[pid]["姓名"].."还有剩余的点数没加!", C_WHITE, 30)
			else
				JY.Person[pid]["攻击力"] = gj;
				JY.Person[pid]["防御力"] = fy;
				JY.Person[pid]["轻功"] = qg;
				
				n = 0;
			end
		end
 	until n == 0

	return true
end

function DIYselect(aa)    
	local thing=aa
  local xnum=CC.MenuThingXnum+1;
  local ynum=CC.MenuThingYnum+1;

	local w=CC.ThingPicWidth*xnum+(xnum-1)*CC.ThingGapIn+2*CC.ThingGapOut;  --总体宽度
	local h=CC.ThingPicHeight*ynum+(ynum-1)*CC.ThingGapIn+2*CC.ThingGapOut; --物品栏高度

	local dx=(CC.ScreenW-w)/2;
	local dy=(CC.ScreenH-h-2*(CC.ThingFontSize+2*CC.MenuBorderPixel+5))/2-15-25;


  local y1_1,y1_2,y2_1,y2_2,y3_1,y3_2,yx_1,yx_2;                  --名称，说明和图片的Y坐标

  local cur_line=0;
  local cur_x=0;
  local cur_y=0;
  local cur_thing=-1;

	while true do
	  Cls();
		y1_1=dy+15;
    y1_2=y1_1+CC.ThingFontSize+2*CC.MenuBorderPixel;
    DrawBox(dx,y1_1,dx+w,y1_2,C_WHITE);
		y2_1=y1_2+5
		y2_2=y2_1+CC.ThingFontSize+2*CC.MenuBorderPixel
		
	local ty2_1 = y2_2+5
	local ty2_2 = ty2_1+CC.ThingFontSize+2*CC.MenuBorderPixel		
    DrawBox(dx,y2_1,dx+w,y2_2,C_WHITE);
	DrawBox(dx,ty2_1,dx+w,ty2_2,C_WHITE);

		--yx_1=y2_2+5
		--yx_2=yx_1+CC.ThingFontSize+2*CC.MenuBorderPixel
   -- DrawBox(dx,yx_1,dx+w,yx_2,C_WHITE);	
   
    y3_1=ty2_2+5
    y3_2=y3_1+h;
		DrawBox(dx,y3_1,dx+w,y3_2,C_WHITE);

    for y=0,ynum-1 do
      for x=0,xnum-1 do
	      local id=y*xnum+x+xnum*cur_line+1         --当前待选择物品
				local explain = {"数据型", "初始型", "移动型", "战斗型", "回合型", "光环型", "修炼型", "特殊型", "几率型", "状态型", "击退型"}
				local boxcolor;
	      if x==cur_x and y==cur_y then
		    	boxcolor=C_WHITE;
	        if thing[id] ~= nil and thing[id][1] ~= nil and thing[id][1]>=0 then
	          cur_thing=thing[id][1];
	          local str=thing[id][2].."【"..explain[thing[id][4]].."】"
			  local tmpstr = ""
			  local dp = thing[id][1]
			  if CC.HZlist[thing[id][1]][3] > 0 then
				tmpstr = tmpstr.."（"..JY.Person[CC.HZlist[thing[id][1]][3] - 1]["姓名"].."）"
				str = str..tmpstr
			  end
				local tmpstr = {}
				tmpstr[1] = thing[id][3]
				tmpstr[2] = ""
				if CONFIG.Zoom == 1 then
					breakdown(tmpstr, 60)
				else
					breakdown(tmpstr, 23 * 2)
				end
				local str2=tmpstr[1]
				local tmpstr2 = tmpstr[2]
				if hasHZ(thing[id][1]) == false then
	   			 DrawString(dx+CC.ThingGapOut,y1_1+CC.MenuBorderPixel,"？？？",C_GOLD,CC.ThingFontSize);
	   			 DrawString(dx+CC.ThingGapOut,y2_1+CC.MenuBorderPixel,"？？？",C_ORANGE,CC.ThingFontSize);
				else
	   			 DrawString(dx+CC.ThingGapOut-5,y1_1+CC.MenuBorderPixel,str,C_GOLD,CC.ThingFontSize);
	   			 DrawString(dx+CC.ThingGapOut-5,y2_1+CC.MenuBorderPixel,str2,C_ORANGE,CC.ThingFontSize);
				 DrawString(dx+CC.ThingGapOut-5,ty2_1+CC.MenuBorderPixel,tmpstr2,C_ORANGE,CC.ThingFontSize);
				end
					local myfont=math.modf(CC.ThingFontSize*0.7)--20
						local mx, my = dx + 4 * myfont, y3_2 + 2
						local myflag=0
						
					 else
	        	cur_thing=-1;
	        end
	      else
					boxcolor=C_BLACK;
				end
				
				local boxx = dx + CC.ThingGapOut + x * (CC.ThingPicWidth + CC.ThingGapIn)
	      local boxy = y3_1 + CC.ThingGapOut + y * (CC.ThingPicHeight + CC.ThingGapIn)
	      lib.DrawRect(boxx, boxy, boxx + CC.ThingPicWidth + 1, boxy + CC.ThingPicHeight + 1, boxcolor)
	      if thing[id] ~= nil and thing[id][1] ~= nil and thing[id][1] >= 0 then
				if CC.LoadThingPic == 1 then
					if hasHZ(thing[id][1]) then
						lib.PicLoadCache(9, thing[id][4] * 2, boxx + 1, boxy + 1, 1)
						tb2(string.sub(thing[id][2], 1, 2), boxx + CC.ThingPicWidth / 2 - 20, boxy + CC.ThingPicHeight / 2 - 20, M_Wheat, 40)
					else
						lib.PicLoadCache(9, 0 * 2, boxx + 1, boxy + 1, 1)
					end
		     	else
				end
	      end
	    end
		end

  	ShowScreen();
  	
		local keypress=WaitKey(1);
  	lib.Delay(100);
  	if keypress==VK_ESCAPE then
    	cur_thing=-1;
    	break;
    elseif keypress==VK_RETURN or keypress==VK_SPACE then
      break;
    elseif keypress==VK_UP then
    	if  cur_y == 0 then
      	if  cur_line > 0 then
        	cur_line = cur_line - 1;
        end
      else
      	cur_y = cur_y - 1;
      end
    elseif keypress==VK_DOWN then
    	if  cur_y ==ynum-1 then
    		if  cur_line < (math.modf(200/xnum)-ynum) then
        	cur_line = cur_line + 1;
        end
      else
      	cur_y = cur_y + 1;
      end
      
    elseif keypress==VK_LEFT then
    	if  cur_x > 0 then
      	cur_x=cur_x-1;
      else
      	cur_x=xnum-1;
      end
      
    elseif keypress==VK_RIGHT then
    	if  cur_x ==xnum-1 then
      	cur_x=0;
      else
      	cur_x=cur_x+1;
      end
		elseif keypress==888 and cur_line>0 then
			cur_line=cur_line-1
		elseif keypress==999 and cur_line<(math.modf(200/xnum)-ynum) then
			cur_line=cur_line+1
		elseif keypress>999999 then
			local k,mx,my
			k=math.modf(keypress/1000000)
			keypress=math.fmod(keypress,1000000)
			mx=math.modf(keypress/1000)
			my=math.fmod(keypress,1000)
			if mx>dx and my>dy and mx<CC.ScreenW-dx and my<CC.ScreenH-dy then
				cur_x=math.modf((mx-dx-CC.ThingGapOut/2)/(CC.ThingPicWidth+CC.ThingGapIn))
				cur_y=math.modf((my-y3_1-CC.ThingGapOut/2)/(CC.ThingPicHeight+CC.ThingGapIn))
				if k==2 then
					break
				end
			end
    end
	end

  Cls();
  return cur_thing;
end

	
function HZ_Menu() --需添加
	local r = DIYselect(CC.HZ)
	if hasHZ(r) == false then
		return
	end
	if r > 0 then
		DrawStrBox(CC.MainSubMenuX, CC.MainSubMenuY, "谁要装备？", C_WHITE, CC.DefaultFont)
		local nexty = CC.MainSubMenuY + CC.SingleLineHeight
		local r2 = SelectTeamMenu(CC.MainSubMenuX, nexty)
		
		if r2 > 0 then
			local pid = JY.Base["队伍"..r2]
			local menu = {}
			local m = limitX(2 + math.modf(JY.Person[pid]["实战"] / 250), 2, 4) --m = m + math.modf(JY.Person[pid]["实战"] / 250) 
			if MPPD(pid) ~= 0 then
				m = 2
			end
			for i = 1, m do
				menu[i] = {"－－－", nil, 1, JY.Person[pid]["HZ"..i]}
				if menu[i][4] ~= 0 then
					menu[i][1] = CC.HZ[menu[i][4]][2]
				end
			end
			Cls()
			local r3 = ShowMenu3(menu,#menu,1,-2,-2,-2,-2,1,1,24,C_GOLD,C_WHITE,"装备栏：","",M_DimGray,C_RED)
			if r3 <= 0 then
				return
			end
			setHZ(pid, r, r3)
		else
			return
		end		
	else
		return
	end
end	

--nino: 徽章系统
function hasHZ(hz)
	if hz > CC.HZNum or hz < 1 then
		return false
	end
	if CC.HZlist[hz][2] ~= nil and CC.HZlist[hz][2] == 1 then
		return true
	else
		return false
	end
end

function addHZ(hz)
	if CC.HZ[hz] ~= nil and CC.HZlist[hz] ~= nil and hasHZ(hz) == false then
		CC.HZlist[hz][2] = 1
		QZXS("得到印信【"..CC.HZ[hz][2].."】！")
	end
end

function setHZ(id, hz, num)
	if num == nil then
		num = 1
	end
	if CC.HZlist[hz][3] > 0 then
		local pid = CC.HZlist[hz][3] - 1
		for j = 1, 4 do
			if JY.Person[pid]["HZ"..j] == hz then --reset the one being used
				JY.Person[pid]["HZ"..j] = 0
				break
			end
		end
	end
	if JY.Person[id]["HZ"..num] ~= 0 then --reset the one thats there
		local hid = JY.Person[id]["HZ"..num]
		CC.HZlist[hid][3] = 0
	end
	JY.Person[id]["HZ"..num] = hz --add new one
	CC.HZlist[hz][3] = id + 1 --make a note
end	

function getHZ(id, hz)
	return false
end

function getHZ2(id, hz)
	for i = 1, 4 do
		if JY.Person[id]["HZ"..i] == hz then
			return true
		end
	end
	if ownMP() then
		if MPPD(id) == 63 then
			for i = 1, 5 do
				if JY.Wugong[122]["未知"..i] == hz then
					return true
				end
			end
		end
	end
	return false
end

function clearHZ(id)
	for num = 1, 4 do
		if JY.Person[id]["HZ"..num] ~= 0 then --reset the one thats there
			local hid = JY.Person[id]["HZ"..num]
			CC.HZlist[hid][3] = 0
			JY.Person[id]["HZ"..num] = 0
		end
	end
end

function clearHZ2(id)
	for num = 2, 4 do
		if JY.Person[id]["HZ"..num] ~= 0 then --reset the one thats there
			local hid = JY.Person[id]["HZ"..num]
			CC.HZlist[hid][3] = 0
			JY.Person[id]["HZ"..num] = 0
		end
	end
end

function update() --需添加
	checkRW()
end

function zjini(menu)

	loadConstant()
	for i = 1, #menu do
		if menu[i][4] == 1 then--苗人凤->胡斐
		    if JY.Person[3]["解锁"] == 1 then
			  menu[i][3] = 1
			end
		elseif menu[i][4] == 3 then--程灵素or阎基or田归农->苗人凤
		    if JY.Person[2]["解锁"] == 1 or JY.Person[4]["解锁"] == 1 or JY.Person[72]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 5 then--张无忌->张三丰
		    if JY.Person[9]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 6 then--唐文亮or何太冲->灭绝
		    if JY.Person[8]["解锁"] == 1 or JY.Person[7]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 9 then--谢逊+莫声谷->张无忌
		    if JY.Person[13]["解锁"] == 1 and JY.Person[172]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 11 then--殷天正+谢逊->杨逍
		    if JY.Person[12]["解锁"] == 1 and JY.Person[13]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 13 then--小昭->谢逊
		    if JY.Person[66]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 18 then--成昆公式未知，暂时无法解锁。
		    
		elseif menu[i][4] == 19 then--左冷禅+令狐冲->岳不群
		    if JY.Person[22]["解锁"] == 1 and JY.Person[35]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 22 then--余沧海->左冷禅
		    if JY.Person[24]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 26 then--任盈盈->任我行
		    if JY.Person[73]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 27 then--东方不败公式未知，暂时无法解锁。
		
		elseif menu[i][4] == 35 then--岳灵珊->令狐冲
		    if JY.Person[79]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 36 then--令狐冲->林平之
		    if JY.Person[35]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 37 then--水笙->狄云
		    if JY.Person[589]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 38 then--白万剑or张三or李四->石破天
		    if JY.Person[41]["解锁"] == 1 or JY.Person[42]["解锁"] == 1 or JY.Person[43]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 39 then--石破天->龙岛主
		    if JY.Person[38]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 40 then--石破天->木岛主
		    if JY.Person[38]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 46 then--游坦之->丁春秋
		    if JY.Person[48]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 48 then--薛慕华or阿紫->游坦之
		    if JY.Person[45]["解锁"] == 1 or JY.Person[47]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 49 then--苏星河or李秋水->虚竹
		    if JY.Person[115]["解锁"] == 1 or JY.Person[118]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 50 then--福利：峰神可以暂时用萧远山+无崖子解锁。
		    if JY.Person[112]["解锁"] == 1 or JY.Person[116]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 51 then--阿朱or阿碧or钟灵->慕容复
		    if JY.Person[90]["解锁"] == 1 or JY.Person[104]["解锁"] == 1 or JY.Person[105]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 53 then--枯荣or一灯->段誉
		    if JY.Person[65]["解锁"] == 1 or JY.Person[102]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 54 then--袁承志不明
		
		elseif menu[i][4] == 55 then--江南七怪or梅超风->郭靖
		    if JY.Person[130]["解锁"] == 1 or JY.Person[131]["解锁"] == 1 or JY.Person[132]["解锁"] == 1 or JY.Person[133]["解锁"] == 1 or JY.Person[134]["解锁"] == 1 or JY.Person[135]["解锁"] == 1 or JY.Person[136]["解锁"] == 1 or JY.Person[78]["解锁"] == 1 then--江南七怪
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 56 then--程英->黄蓉
		    if JY.Person[63]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 57 then--黄蓉->黄药师
		    if JY.Person[56]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 58 then--小龙女->杨过
		    if JY.Person[59]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 59 then--李莫愁->小龙女
		    if JY.Person[161]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 60 then--裘千仞->欧阳锋
		    if JY.Person[67]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 62 then--霍都->金轮法王
		    if JY.Person[84]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 64 then--全真七子->周伯通
		    if JY.Person[68]["解锁"] == 1 or JY.Person[123]["解锁"] == 1 or JY.Person[124]["解锁"] == 1 or JY.Person[125]["解锁"] == 1 or JY.Person[126]["解锁"] == 1 or JY.Person[127]["解锁"] == 1 or JY.Person[128]["解锁"] == 1 then--江南七怪
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 65 then--渔樵耕读or朱长龄or朱丹臣->一灯
		    if JY.Person[165]["解锁"] == 1 or JY.Person[101]["解锁"] == 1 or JY.Person[119]["解锁"] == 1 or JY.Person[120]["解锁"] == 1 or JY.Person[121]["解锁"] == 1 or JY.Person[122]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 66 then--胡青牛->小昭
		    if JY.Person[16]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 67 then--欧阳克->裘千仞
		    if JY.Person[61]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 69 then--郭靖->洪七公
		    if JY.Person[55]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 71 then--苏荃->洪教主
		    if JY.Person[87]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 73 then--平一指->任盈盈
		    if JY.Person[28]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 74 then--霍青桐->陈家洛
		    if JY.Person[75]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 75 then--红花会众->陈家洛
		    if JY.Person[152]["解锁"] == 1 or JY.Person[153]["解锁"] == 1 or JY.Person[154]["解锁"] == 1 or JY.Person[155]["解锁"] == 1 or JY.Person[156]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 76 then--慕容复->王语嫣
		    if JY.Person[51]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 79 then--田伯光->岳灵珊
		    if JY.Person[29]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 80 then--张绍重未知
		
		elseif menu[i][4] == 81 then--朱长龄->朱九真
			if JY.Person[165]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 83 then--何红药->何铁手
			if JY.Person[176]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 84 then--达尔巴->霍都
			if JY.Person[160]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 85 then--白万剑or张三or李四->贝海石
		    if JY.Person[41]["解锁"] == 1 or JY.Person[42]["解锁"] == 1 or JY.Person[43]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 97 then--狄云->血刀老祖
		    if JY.Person[37]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 98 then--三大恶人->段延庆
		    if JY.Person[44]["解锁"] == 1 or JY.Person[99]["解锁"] == 1 or JY.Person[100]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 102 then--渔樵耕读or朱长龄or朱丹臣->枯荣
		    if JY.Person[165]["解锁"] == 1 or JY.Person[101]["解锁"] == 1 or JY.Person[119]["解锁"] == 1 or JY.Person[120]["解锁"] == 1 or JY.Person[121]["解锁"] == 1 or JY.Person[122]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 103 then--鸠摩智未知
		
		elseif menu[i][4] == 112 then--王语嫣->萧远山
		    if JY.Person[76]["解锁"] == 1 then
		      menu[i][3] = 1
			end
	    elseif menu[i][4] == 113 then--王语嫣->慕容博
		    if JY.Person[76]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 114 then--扫地未知
		
		elseif menu[i][4] == 116 then--天山童姥->无涯子
		    if JY.Person[117]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 117 then--虚竹->天山童姥
		    if JY.Person[49]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 129 then--周伯通->王重阳
		    if JY.Person[64]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 140 then--岳不群+林平之->风清扬
		    if JY.Person[19]["解锁"] == 1 and JY.Person[36]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 149 then--空闻空性or玄慈->方证
		    if JY.Person[70]["解锁"] == 1 or JY.Person[169]["解锁"] == 1 or JY.Person[170]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 150 then--阿珂->冯锡范
		    if JY.Person[86]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 164 then--石破天->谢烟客
		    if JY.Person[38]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] == 184 then--玉真子未知
		
		elseif menu[i][4] == 185 then--穆人清未知
		
		elseif menu[i][4] == 186 then--归心树未知
		
		elseif menu[i][4] == 188 then--梅剑和->黄真
		    if JY.Person[183]["解锁"] == 1 then
		      menu[i][3] = 1
			end
		elseif menu[i][4] >= 607 and menu[i][4] <= 613 then --宠物
		
		elseif menu[i][4] == 614 then --阿青
		
		else
		    menu[i][3] = 1--这是敌人0级解锁
	    end
		if duiyou(i) and i ~= 606 then
		
		elseif i < 190 then
		
		elseif i >= 597 and i <= 606 then
			 menu[i][3] = 0
		elseif i >= 594 and i <= 596 then
			 menu[i][3] = 0
		elseif xiaobin(i) then
			menu[i][3] = 0
		else	
		     menu[i][3] = 0
		end
		if menu[i][4] == 580 then--雕兄的解锁。
		    menu[i][3] = 1
	    end
		if menu[i][4] == 592 then--独孤求败的解锁。
		    if JY.Person[58]["解锁"] == 1 and JY.Person[140]["解锁"] == 1 and JY.Person[580]["解锁"] == 1 then--杨过+雕兄+风清扬
		      menu[i][3] = 1
			end
	    end
		if menu[i][4] == 92 then
			menu[i][3] = 0
		end	
		
		if cheat() then
			menu[i][3] = 1
		end
		
		if xiaobin(i) then
			menu[i][3] = 0
		end
		if CC.NLJS[JY.Person[i]["姓名"]] == nil then
			menu[i][3] = 0
		end
	end		
end

function All_team(pid1,pid2) --借用的函数
	for i=pid1,pid2 do
		
		CC.menu[CC.i][1]=CC.i..JY.Person[i]["姓名"];
		CC.menu[CC.i][2]=nil;
		CC.menu[CC.i][3]=1;
		CC.menu[CC.i][4]=i;
		CC.i=CC.i+1;		
	end
end

function My_Select(menu,num,list)  --借用的函数
	local nexty = CC.MainSubMenuY + CC.SingleLineHeight;	  
	local r=ShowMenu(menu,num,list,CC.MainSubMenuX,nexty,0,0,1,1,CC.DefaultFont,C_ORANGE,C_WHITE);
	if r==0 then
        return -1;
    end
	return r;	
end

function addevent(sid, pid, pass, event, etype, pic, x, y)
	if x == nil then x = -2 end
	if y == nil then y = -2 end
	if pic == nil then pic = -2 end
	if etype == nil then etype = 1 end--1空格2物品3通过
	if event == nil then event = -2 end
	if pass == nil then pass = -2 end
	if etype == 1 then
		instruct_3(sid, pid, pass, 0, event, 0, 0, pic, pic, pic, -2, x, y)
	elseif etype == 2 then
		instruct_3(sid, pid, pass, 0, 0, event, 0, pic, pic, pic, -2, x, y)
	else
		instruct_3(sid, pid, pass, 0, 0, 0, event, pic, pic, pic, -2, x, y)
	end	
end

function getevent(sid, pid)
	GetD(sid, pid, 2)
end

function addpoint(sid, pid, x, y)
	SetS(sid, x, y, 3, pid)
end

function deletepoint(sid, x, y)
	SetS(sid, x, y, 3, -1)
end

function yesno (str)
	return DrawStrBoxYesNo(-1, -1, str, C_WHITE, 30)
end

function addtime(aa)
	JY.DAY = JY.DAY + aa
	while JY.DAY > 30 do
		JY.DAY = JY.DAY - 30
		JY.MONTH = JY.MONTH + 1
	end
	while JY.MONTH > 12 do
		JY.MONTH = JY.MONTH - 12
		JY.YEAR = JY.YEAR + 1
	end
	while JY.YEAR > 60 do
		JY.YEAR = JY.YEAR - 60
	end
	JY.TL = limitX(JY.TL - (aa * 2), 0, 100)
	if JY.TL <= 10 then		
		say("需要休息一下了。")
		dark()
		JY.TL = 100
		instruct_12()
		addtime2(2)
		light()		
	end	
	timeevent()
end

function addtime2(aa)
	JY.DAY = JY.DAY + aa
	while JY.DAY > 30 do
		JY.DAY = JY.DAY - 30
		JY.MONTH = JY.MONTH + 1
	end
	while JY.MONTH > 12 do
		JY.MONTH = JY.MONTH - 12
		JY.YEAR = JY.YEAR + 1
	end
	while JY.YEAR > 60 do
		JY.YEAR = JY.YEAR - 60
	end
	timeevent()
end



--菜单相对居中
function My_ShowMenu(menuItem,numItem,numShow,x1,y1,x2,y2,isBox,isEsc,size,color,selectColor)

        if size == nil then   --如果size不传值，使用默认大小
                size = CC.DefaultFont;
        end
        
        if color == nil then   --如果不传color，默认橙色
                color = C_ORANGE;
        end
        
        if selectColor == nil then   --如果不传selectColor，默认选中为白色
                selectColor = C_WHITE;
        end

        if x1 == -1 then        --如果x1传的是-1，水平居中显示
                local len = 0;
                for i,v in pairs(menuItem) do
                        if #v[1] > len then
                                len = #v[1];
                        end
                end
                
                if x2 == 0 then    --如果是默认计算长度
                        x1 = CC.ScreenW/2 - 2*CC.MenuBorderPixel - len*size/4;
                elseif x2 > x1 then   --如果要传x2进来
                        x1 = CC.ScreenW - x2;
                        
                        --x2传屏幕一半时，总要留个缝给文字显示吧，两边都挪一挪
                        local diffx = x2 - x1;
                        if diffx < len*size/2 + 2*CC.MenuBorderPixel then
                                x1 = x1 - (len*size/2 + 2*CC.MenuBorderPixel)/2 + diffx/2;
                                x2 = x2 + (len*size/2 + 2*CC.MenuBorderPixel)/2 - diffx/2;
                        end
                end
                
        end
        
        if y1 == -1 then   --如果y1传的是-1，垂直居中显示
                if y2 == 0 then
                        y1 = CC.ScreenH/2 - 2*CC.MenuBorderPixel - numItem*(size+CC.RowPixel)/2 + CC.RowPixel/2;
                elseif y2 > y1 then
                        y1 = CC.ScreenH - y2;
                        
                        --y1也是同样，文字要留点空隙
                        local diffy = y2 - y1;
                        if diffy < 2*CC.MenuBorderPixel + numItem*(size+CC.RowPixel)/2 - CC.RowPixel/2 then
                                y1 = y1 - (2*CC.MenuBorderPixel + numItem*(size+CC.RowPixel) - CC.RowPixel/2)/2 + diffy/2;
                                y2 = y2 + (2*CC.MenuBorderPixel + numItem*(size+CC.RowPixel) - CC.RowPixel/2)/2 - diffy/2;
                        end
                end
        end       
        ShowMenu(menuItem,numItem,numShow,x1,y1,x2,y2,isBox,isEsc,size,color,selectColor);
end

function ceshi()
	return false
end
function ceshi2()
	return false
end

function zhanyi(pp, aa, flag)
	if aa > 0 and flag == nil then
		if PersonGT(pp, 92) then
			aa = aa * 1.5
		elseif PersonKF(pp, 92) then
			aa = aa * 1.2
		end
		if hasTF(pp, 137) then
			aa = aa * 2
		end
		if T2SQ(pp) and juexing() > 1 then
			aa = aa * 2
		end	
		if PersonGT(pp, 178) or T9ZY(pp) then
			aa = aa * 1.6
		elseif PersonKF(pp, 178) then
			aa = aa * 1.3
		end
		if WAR.QX1[pp] == 1 then --玉女经17-3-3-
		   aa = 0 
		end  
	end
	if aa < 0 and hasTF(pp, 117) then
		aa = 0
	end
	WAR.SPIRIT[pp] = limitX((WAR.SPIRIT[pp] or 100) + aa, (WAR.SPIRITMIN[pp] or 90), (WAR.SPIRITMAX[pp] or 140))	
end

function JX(pid) --队友觉醒
	if JY.Person[pid]["觉醒"] > 0 then
		return true, JY.Person[pid]["觉醒"]
	else
		return false
	end
end

function setJX(pid, flag)
	if pid == 0 and JY.Person[0]["觉醒"] < 1 and not (XYL(pid) or SJL(pid) or jtyl(pid)) then 
		local ts = 0
		local js = {}
		for i = 1, 200 do
			if JY.Base[CC.EVB12 .. i] > 143 and JY.Base[CC.EVB12 .. i] < 158 then
				ts = ts + 1
				js[ts] = i
			end
		end
		if ts > 0 then
			say("什么人？")
			say("..........",553)
			local js1 = js[math.random(ts)]
			JY.Person[578]["无用13"] = JY.Base[CC.EVB12 .. js1]
			addthing(JY.Base[CC.EVB12 .. js1], -1) 
			say("糟糕！！天书！！东瀛人？可恶！")
		end
	end
	if flag == nil then
		JY.Person[pid]["觉醒"] = 1	
	else
		JY.Person[pid]["觉醒"] = JY.Person[pid]["觉醒"] + flag
	end
	if JY.Person[pid]["觉醒"] < 0 then JY.Person[pid]["觉醒"] = 0 end
end

function gangxi(pid, wugong) --钢系
	if ZJ(pid) then
		if yongquan(wugong) and hasSK(1) then
			return 0.1
		elseif yongjian(wugong) and hasSK(4) then
			return 0.1
		elseif yongdao(wugong) and hasSK(7) then
			return 0.1
		elseif yongte(wugong) and hasSK(10) then
			return 0.1
		end
	end
	return 0
end

function baxi(pid, wugong) --霸系
	local a = 0
	if ZJ(pid) then
		if hasSK(2) then
			a = a + wgnumber(pid, 1) * 25
		end
		if hasSK(5) then
			a = a + wgnumber(pid, 2) * 25
		end
		if hasSK(8) then
			a = a + wgnumber(pid, 3) * 25
		end
		if hasSK(11) then
			a = a + wgnumber(pid, 4) * 25
		end
	end	
	return a
end

function rouxi(pid, wugong) --柔系
	local a = 0
	if ZJ(pid) then
		if hasSK(3) then
			a = a + wgnumber(pid, 1) * 100
		end
		if hasSK(6) then
			a = a + wgnumber(pid, 2) * 100
		end
		if hasSK(9) then
			a = a + wgnumber(pid, 3) * 100
		end
		if hasSK(12) then
			a = a + wgnumber(pid, 4) * 100
		end
	end	
	return a	
end

function qingshen(pid) --轻身
	local a = 0
	if ZJ(pid) then
		if hasSK(13) then
			a = a + 2
		end
		if hasSK(14) then
			a = a + 4
		end
		if hasSK(15) then
			a = a + 6
		end
	end	
	if hasTF(pid, 15) then
		a = a + 5
	end
	if hasTF(pid, 16) then
		a = a + 10
	end	
	return a 
end

function lianji(pid) --连击加成
	local a = 0
	if ZJ(pid) then
		if hasSK(16) then
			a = a + 10
		end
		if hasSK(17) then
			a = a + 20
		end
		if hasSK(18) then
			a = a + 30
		end
	end	
	
	--飞影彩蛋：真龙心法所有武功连击+50%
	if PersonKF(pid, 91) and inteam(pid) and JY.ZLXF == 1 then
		a = a + 100
	end
	
    --安七
	if DT(pid,456) then
		a = a + 100
	end	
	
	if hasTF(pid, 99) then
		a = a + 20
	end
	if hasTF(pid, 100) then
		a = a + 40
	end	
	if wglw2(pid, 193) then
		return 200
	end
	if hasTF(pid, 107) then
		return 200
	end		
	return a 
end

function baoji(pid) --暴击加成
	local a = 0
	if ZJ(pid) then
		if hasSK(19) then
			a = a + 10
		end
		if hasSK(20) then
			a = a + 20
		end
		if hasSK(21) then
			a = a + 30
		end
	end	
	
	--飞影彩蛋：真龙心法所有武功暴击+50%
	if PersonKF(pid, 91) and inteam(pid) and JY.ZLXF == 1 then
		a = a + 100
	end
	
    --安七
	if DT(pid,456) then
		a = a + 100
	end	
	
	if hasTF(pid, 101) then
		a = a + 20
	end	
	if hasTF(pid, 102) then
		a = a + 40
	end	
	if hasTF(pid, 108) and not wglw(pid,153) then
		return 200
	end		
	return a 
end

function jiazhanyi(pid) --加战意
	if ZJ(pid) then
		if hasSK(24) then
			return 20
		elseif hasSK(23) then
			return 15
		elseif hasSK(22) then
			return 10
		end
	end
	return 0
end

function zuoyouhubo(pid) --左右互搏
	if ZJ(pid) then
		if hasSK(27) then
			return 30
		elseif hasSK(26) then
			return 20
		elseif hasSK(25) then
			return 10
		end
	end
	if hasTF(pid, 98) then
		return 45
	end
	return 0	
end

function tianzi(pid) --天资
	if ZJ(pid) then
		if hasSK(30) then
			return 3
		elseif hasSK(29) then
			return 2
		elseif hasSK(28) then
			return 1
		end
	end
	if hasHZ(92) or hasTF(pid, 92) then --hasTF(pid, 92) 武骧金星：免去换印信的麻烦
		return 3
	end
	return 0	
end

function blqs(pid, t) --博览
	if ZJ(pid) then
		if hasSK(32) and t == 1 then
			return true
		end
		if hasSK(33) and t == 2 then
			return true
		end
		if hasSK(34) and t == 3 then
			return true
		end
		if hasSK(35) and t == 4 then
			return true
		end
		if hasSK(36) and t == 5 then
			return true
		end
		if hasSK(37) and t == 6 then
			return true
		end
		if hasSK(38) and t == 7 then
			return true
		end
	end	
	return false 	
end

function startjiqi(pid) --初始集气
	local a = 0
	if ZJ(pid) then
		if hasSK(41) then
			a = a + 400
		end
		if hasSK(42) then
			a = a + 999
		end
	end	
	if pid == 0 and putong() == 10 then
		a = a + JY.Person[pid]["实战"]
	end
	a = limitX(a, -500, 999)
	return a 	
end

function guwu(pid) --鼓舞
	local a = 0
	if ZJ(pid) then
		if hasSK(43) then
			a = a + 0.1
		end
	end		
	return a
end

function qunchao(pid) --群嘲
	local a = 0
	if ZJ(pid) then
		if hasSK(44) then
			a = a + 0.1
		end
	end		
	return a	
end

function spoison(pid) --单毒
	local a = 0
	if ZJ(pid) then
		if hasSK(46) then
			a = a + 20
		end
	end	
	return a 		
end

function bpoison(pid) --群毒
	local a = 0
	if ZJ(pid) then
		if hasSK(47) then
			a = a + 20
		end
	end	
	return a 		
end

function nozoc(pid) --无视zoc
	if ZJ(pid) then
		if hasSK(48) then
			return true
		end
	end		
	if hasTF(pid, 17) then
		return true
	end
	if pid == 0 and putong() == 10 then
		return true
	end
	if MPPD(pid) == 6 and MZ(pid)== 2 then
		return true
	end	
	if pid == 0 and zjtype()==1 and (tianshu()>=7 or juexing() > 0) then
	   return true
	end
	if NF(pid) == 0 then
		return true 
	end
	if DT(pid,667) then
		return true
	end	
	if pid == 0 and GetS(114,0,0,0) > 0 then
		return true
	end	
	return false
end

function jiasu(pid) --加速
	local a = 0
	if ZJ(pid) then
		if hasSK(49) then
			a = a + 0.1
		end
	end		
	return a	
end

function extrabj(pid) --暴击额外伤害
	local a = 0
	if ZJ(pid) then
		--if hasSK(50) then
		--	return 0.25
		--end
		if T11CJR(pid) and juexing() > 2 then a = JY.Person[pid]["实战"] / 10000 end
	end	
	if DT(pid, 58) then
		if JY.Person[pid]["生命"] < JY.Person[pid]["生命最大值"] / 4 then
			a = 0.5
		elseif JY.Person[pid]["生命"] < JY.Person[pid]["生命最大值"] / 2 then
			a = 0.25
		end		
	end	
	if hasTF(pid, 52) then
		a = a + 0.25 --return 0.25
	end
	if WAR.ARJX == 2 then
		a = a + 0.5 --return 0.25
	end
	if WAR.LMSJ > 0 then
		a = a + 1
	end
	return a --0
end

function addjl(pid) --增加几率
	if ZJ(pid) then
		if hasSK(51) then
			return 10
		end
	end	
	if hasTF(pid, 103) then
		return 10
	end
	if pid == 0 and putong() == 11 then
		return 10
	end
	return 0
end

function nomiss(pid) --必命中
	if DT(pid, 614) or DT(pid,152) then
		return true
	end
	if NF(pid) and juexing() > 2 then  --聂风冰心
		return true
	end
	if BJY(pid) and juexing() > 1 then  --步惊云命中
		return true
	end
	if DT(pid,600) then  
		return true
	end
	if XYL(pid) and juexing() > 0 then  --豸苗：谢云流心眼
		return true
	end
    if DT(pid,58) and ZYBF(pid) then  --沼跃鱼: 杨过战意下必中
		return true
	end
	if DT(pid, 592) or wglw1(pid, 47) then
		return true
	end
	if ((DT(pid, 55) or DT(pid,617)) and PersonKF(pid,26)) or wglw1(pid, 148) then
		return true 
	end	
	if DT(pid, 64) and WAR.KMWD==2 then
		return true
	end
	if wglw1(pid,78) and WAR.KMWD==2 then 
		return true
	end
	if JY.Person[pid]["武器"] == 294 then --射雕弓
		return true
	end
	if wglw(pid,153) and JY.Person[pid]["体力"] >= 95 then
		return true
	end	
	--if WAR.ZDDH == 226 and GetS(86, 1, 9, 5) == 1 and GetS(86, 2, 11, 5) == 3 then
		--return true
	--end
	return false
end

function halflx(pid) --流血减半
	if ZJ(pid) then
		if hasSK(52) then
			return true
		end
	end	
	return false
end

function halfns(pid) --内伤减半
	if ZJ(pid) then
		if hasSK(53) then
			return true
		end
	end	
	return false
end

function halfch(pid) --迟缓减半
	if ZJ(pid) then
		if hasSK(54) then
			return true
		end
	end	
	return false
end

function nows(pid) --不误伤
	if ZJ(pid) then
		if hasSK(55) then
			return true
		end
	end	
	return false	
end

function extralj(pid) --连击不减伤害
	if ZJ(pid) then
		if hasSK(56) then
			return true
		end
	end	
	if hasTF(pid, 127) then
		return true
	end
	if XYL(pid) then
		return true
	end
	if NF(pid) and juexing() > 2 then --聂风觉醒十方无敌
		return true
	end
	if BJY(pid) and juexing() > 1 then --步惊云连击不减伤害
		return true
	end
	if T6XQS(pid) and juexing() > 2 then --滕青山觉醒连击不减伤害
		return true
	end
	return false
end

function extrajq(pid) --行动恢复集气
	local a = 0
	if ZJ(pid) then
		if hasSK(57) then
			a = a + 200
		end
	end

	return a
end

function zhaoshi(pid) --必出招式
	if ZJ(pid) then
		if hasSK(59) then
			return 100
		end
	end		
	if hasTF(pid, 104) then
		return 100
	end
	if DT(pid, 600) then
		return 100
	end
	if NF(pid) and juexing() > 2 then --魔心渡后聂风必出
		return 100
	end
	if BJY(pid) and juexing() > 1 then --步惊云必出
		return 100
	end
	if WAR.HYYQ[pid] == 1 then 
		return 100
	end
	return 0
end

function extrazs(pid) --招式杀气加成
	local a = 0
	if ZJ(pid) then
		if hasSK(59) then
			a = a + 0.5
		end
	end	
	if hasTF(pid, 11) then
		a = a + 0.5
	end
	if WAR.HYYQ[pid] == 1 then 
		a = a + 1
	end
	return a
end

function ngattack(pid) --内功攻击
	if ZJ(pid) then
		if hasSK(60) then
			return true
		end
	end			
	if hasTF(pid, 91) then
		return true
	end
	return false
end

function ljbj(pid, fightnum) --连击必暴
	if fightnum > 1 then
		if ZJ(pid) then
			if hasSK(61) then
				return true
			end
		end		
	end
	return false
end

function twogt(pid) --装备两个功体
	if pid == 0 and putong() == 5 and juexing() >= 1 then
		return true
	end
	if ZJ(pid) then
		if hasSK(62) then
			return true
		end
	end	
    if jtyl(pid) then
		return true
	end	
	if hasTF(pid, 90) then
		return true
	end
	if NF(pid) then -- 聂风装备两个功体
		return true
	end
	if FHXX(pid) then 
		return true
	end
	if DT(pid,666) or DT(pid,667) then
		return true
	end	
	return false
end

function kill(pid, eid) --秒杀
	if ZJ(pid) then
		if hasSK(63) then
			if JY.Person[pid]["生命"] <= math.modf(JY.Person[pid]["生命最大值"] * 0.3) 
				and xiaobin(eid) and JLSD(10, 20, pid) then
				return true
			end
		end
	end			
	return false
end

function multiple(pid, f) --多连击
	local a = f
	if f > 4 then return f end
	if ZJ(pid) then
		if hasSK(64) and JLSD(10, 30, pid) then
			a = limitX(a + math.random(2), f, 4)
		end
	end		
	return a
end

function pofang(pid) --必破防
	if ZJ(pid) then
		if hasSK(65) and JLSD(10, 30, pid) then
			WAR.BLX = 1
			return true, "开碑裂石"
		end
	end			
	if DT(pid, 630) or (DT(pid, 91) and JX(pid)) then --夏雪宜和青青破防
		local jl = 20
		jl = jl + math.modf(JY.Person[pid]["实战"] / 10)
		if JLSD(10, 10 + jl, pid) then
			return true, "金蛇椎"
		end
	end
	return false
end

function blood(pid)
	if ZJ(pid) then
		if hasSK(65) and JLSD(10, 30, pid) then
			return true
		end
	end			
	if hasTF(pid, 109) then
		return true
	end
	return false
end

function paralyze(pid)
	if ZJ(pid) then
		if hasSK(66) and JLSD(10, 30, pid) then
			return 10, "剑发琴音"
		end	
	end	
	return -1
end

function allkillspeed(pid)
	if ZJ(pid) then
		if hasSK(67) and JLSD(10, 30, pid) and WAR.ACT == 1 then
			return 200, "霹雳狂刀"
		end	
	end	
	if WAR.ACT == 1 and hasTF(pid, 40) and JLSD(10, 60, pid) then
		return 100, "天霄狂浪"
	end
	if WAR.ACT == 1 and (DT(pid, 592) or wglw1(pid, 45)) and JLSD(10, 60, pid) then	
		return 750, "玄铁重剑・倒劈"
	end	
	if wglw2(pid,195) and PersonKF(pid, 195) and JLSD(10, 35, pid) then
		return 50, "雪夜追猎"
	end
	if DT(pid, 58) and WAR.XK ~= 2 then
	    local tmp1=100
	    local tmp2=CC.WARS48
	    if ZYBF(pid) then
	        tmp1=tmp1+200
	        tmp2="怒涛撩剑式"
	    end
		    return tmp1, tmp2
	end
	if XYL(pid) and WAR.XYLCZ1 == 4 then
	    return 150, "一念无量劫"
	end
	if XYL(pid) and WAR.XYLCZ == 4 then
	    return 150, "八荒归元"
	end
	if wglw1(pid,18) and WAR.TZPT == 92 then
		return 300, ""
	end
	if MPPD(pid) == 3 and PersonGT(pid,121) and PersonKFJ(pid,39) and PersonKFJ(pid,42) and yongjian(wugong) and JLSD(10,40,pid) then
		if DT(pid,59) or DT(pid,601) then
			return 150, "纤手握星辰"
		else
			return 100, "纤手握星辰"
		end
	end
	if WAR.BXJF == 2 then
		return 200, ""
	end	
	if WAR.BXJF2 == 1 then
		return 400, ""
	end	
	return -1
end

function noangry(pid)
	if ZJ(pid) then
		if hasSK(68) and JLSD(10, 30, pid) then
			return 100, "兵甲武狂"
		end	
	end	
	return -1
end

function noparalyze(pid)
	if ZJ(pid) then
		if hasSK(69) then
			return true
		end	
	end		
	if PersonKF(pid, 104) then
		return true
	end
	if hasTF(pid, 115) then
		return true
	end
	return false
end

function maxhurt(pid)
	if ZJ(pid) then
		if hasSK(70) and JLSD(10, 35, pid) then
			return 100, "罡炎霸体"
		end	
	end	
	return -1	
end

function miss(pid)
	if ZJ(pid) then
		if hasSK(71) and JLSD(10, 30, pid) then
			return true, "天机身法"
		end	
	end		
	return false	
end

function hitall(pid)
	if ZJ(pid) then
		if hasSK(72) and JLSD(10, 30, pid) then
			return true, "祸乱江湖"
		end	
	end		
	if WAR.HITALL[pid] ~= nil and WAR.HITALL[pid] > 0 then
		return true, ""
	end
	return false		
end

function nokillspeed(pid)
	if ZJ(pid) then
		if hasSK(73) then
			return true
		end	
	end		
	if hasTF(pid, 114) then
		return true
	end	
	if DT(pid, 114) then
		return true
	end
	if wglw(pid,108) or DT(pid,615) then
		return true
	end
	if (wglw(pid,99) or DT(pid,5) or DT(pid,666)) and  WAR.LSQL1 == 1 then 
        return true
	end
    if wglw(pid,104) and MPPD(pid)==8 then
		return true
	end
	if wglw1(pid,58) and WAR.LQZ[pid]~=nil and WAR.LQZ[pid]>=100 then
		return true
	end
	if wglw1(pid,18) and WAR.TZQJ7[pid] ~= nil then
		return true
	end	
	return false
end

function nospeeddelay(pid)
    if wglw(pid,104) and MPPD(pid)==8 then
	return true
	end
	return false
end

function freefight(pid)
	if hasTF(pid, 37) then
		return true
	end
	if MPPD(pid) == 7 then
		return true
	end
	return false
end

function doubleweapon(pid)
	if T2SQ(pid) then
		return true
	end
	if hasTF(pid, 95) then
		return true
	end
	return false
end

function doublearmor(pid)
	if T2SQ(pid) then
		return true
	end
	if hasTF(pid, 96) then
		return true
	end
	if MPPD(pid) == 2 then
		return true
	end
	return false
end

function setLW(a) --领悟
   SetS(111,0,0,0,a)
end

function wssz(pid) --滕文婷
    if DT(pid,598) then
	return true
	end
	return false
end


function jtyl(pid) --谢无悠
    if DT(pid,597) then
	return true
	end
	return false
end

function txjid(pid)--剑势压制
    if DT(pid,597) then
	return true
	end
    if SJL(pid) and juexing() > 0 then
	return true
	end
    if XYL(pid) and juexing() > 1 then
	return true
	end
	if wglw(pid,180) and PersonGT(pid,180) then
	return true
	end
	return false
end

function ycfy(pid)
	if jtyl(pid) then 
		return true
	end
	if hasTF(pid,143) then 
		return true
	end
	if NF(pid) then  --魔心渡恢复异常状态
		return true
	end
	if PersonGT(pid,182) then --太极神功恢复异常状态
		return true
	end	
	if WAR.KHZJ[pid] then --葵花组件
		return true
	end
	if wglw1(pid,48) and WAR.LQZ[pid] ~= nil and WAR.LQZ[pid] >= 100 then
		return true 
	end	
	return false
end

function qkfy(pid)
    if jtyl(pid) then 
	    return true
	end
    if PersonKF(pid,16) and PersonKF(pid,46) then
	    return true
	end
	if PersonKF(pid,182) then --太极神功免疫反弹
	    return true
	end
	if DT(pid, 592) or wglw1(pid, 47) then
		return true
	end
	if WAR.QCZL == 1 then
		return true
	end
	return false
end

function moveme(x, y, z)
	dark()
	instruct_19(x, y)
	if z ~= nil then
		instruct_40(z)
	end
	instruct_25(x, y, x, y)
	light()
end

function transferme(s, x, y, z)
	My_Enter_SubScene(s, x, y, z)
end

function walkme(x2, y2, x1, y1)
	if x1 == nil then
		x1 = JY.Base["人X1"]
	end	
	if y1 == nil then
		y1 = JY.Base["人Y1"]
	end
	instruct_30(x1, y1, x2, y2)
end

function oldCallEvent(eventnum)     --执行旧的事件函数
	ReadKDEF(eventnum)
	--[[
	if eventnum==CC.NewGameEvent then
		Init_SMap_Debug()
	end
	]]--
end


function TalkEx(s,headid,flag,name)        --半身像对话 by小二
	if flag == nil or flag < 1 then flag = 1 end
	if flag > 3 then flag = 1 end
	if headid == nil then headid = 0 end
	if headid >= 244 and headid <= 248 then headid = 0 end
	if name == "" then name = nil end
	if headid == 0 and flag ~= 2 then flag = 3 end
  local pich = 130
  local h0, w0 = math.modf(360 * 1.1), math.modf(400 * 1.1)
  local talkynum = 3
  local dx = 2 
  local dy = 55 
  local talkBorder = 8
  
--
	s = string.gsub(s, '"', "＂")
	s = string.gsub(s, ':', "：")
	s = string.gsub(s, "*", "")
	s = string.gsub(s, " ", "")
	s = string.gsub(s, ",", "，")


  local xy = {	
	{headx = dx, heady = dy, talkx = 155, talky = 470, showhead = 1}, --头像右	
	{headx = dx, heady = dy, talkx = CC.ScreenW / 2 - 650 / 2, talky = CC.ScreenH / 2 - 134 / 2, showhead = 0}, --头像左
	{headx = dx, heady = dy, talkx = 5, talky = 470, showhead = 17}, --头像左
	} 
	local dl = {"Ｒ" , "Ｇ", "Ｂ", "Ｗ", "Ｏ", "Ｈ", "Ｓ", "Ｆ"}
	for i = 1, #dl do
		local letter = string.find(s, dl[i])
		while letter ~= nil and math.fmod(letter, 2) ~= 0 do
			s = string.sub(s, 1, letter - 1)..string.sub(s, letter + 2, -1)
			letter = string.find(s, dl[i])	
		end
	end
	
  if CONFIG.KeyRepeat == 0 then
    lib.EnableKeyRepeat(0, CONFIG.KeyRepeatInterval)
  end
  lib.GetKey()
  
  local endp = nil
  local stop = 42
  local dy = 0
  local pid = headid

  if headid >= 0 then 
	pid = headid
	if name == nil then
		headid = gethead(headid) 
	else
		headid = gethead(headid, 1) 
	end
  end

  while 1 do
    if dy == 0 then
      Cls()
	  DrawBox(xy[flag].talkx - 5, xy[flag].talky - 5, xy[flag].talkx - 5 + 650, xy[flag].talky - 5 + 135, C_WHITE)
	  
	  if name ~= nil and name ~= "１２３４５６ｍａｒｋ" then
		if xy[flag].showhead == 1 then
			DrawBox(xy[flag].talkx - 5, xy[flag].talky - 55, xy[flag].talkx + 5 + math.modf(string.len(name) * 0.5 * 35), xy[flag].talky - 10, C_WHITE)
			DrawString(xy[flag].talkx, xy[flag].talky - 50, name, C_GOLD, 35) 
		elseif xy[flag].showhead == 17 then
			DrawBox(650 - 10 - math.modf(string.len(name) * 0.5 * 35), xy[flag].talky - 55, 650, xy[flag].talky - 10, C_WHITE)
			DrawString(650 - 5 - math.modf(string.len(name) * 0.5 * 35), xy[flag].talky - 50, name, C_GOLD, 35) 			
		end
	  elseif name ~= "１２３４５６ｍａｒｋ" then	
			if xy[flag].showhead == 1 then
				DrawBox(xy[flag].talkx - 5, xy[flag].talky - 55, xy[flag].talkx + 5 + math.modf(string.len(JY.Person[pid]["姓名"]) * 0.5 * 35), xy[flag].talky - 10, C_WHITE)
				DrawString(xy[flag].talkx, xy[flag].talky - 50, JY.Person[pid]["姓名"], C_GOLD, 35) 
			elseif xy[flag].showhead == 17 then
				DrawBox(650 - 10 - math.modf(string.len(JY.Person[pid]["姓名"]) * 0.5 * 35), xy[flag].talky - 55, 650, xy[flag].talky - 10, C_WHITE)
				DrawString(650 - 5 - math.modf(string.len(JY.Person[pid]["姓名"]) * 0.5 * 35), xy[flag].talky - 50, JY.Person[pid]["姓名"], C_GOLD, 35) 
			end  	  
	  elseif name == "１２３４５６ｍａｒｋ" then
		if pid == 0 or pid == JY.Person[pid]["半身像"] then
			if xy[flag].showhead == 1 then
				DrawBox(xy[flag].talkx - 5, xy[flag].talky - 55, xy[flag].talkx + 5 + math.modf(string.len(JY.Person[pid]["姓名"]) * 0.5 * 35), xy[flag].talky - 10, C_WHITE)
				DrawString(xy[flag].talkx, xy[flag].talky - 50, JY.Person[pid]["姓名"], C_GOLD, 35) 
			elseif xy[flag].showhead == 17 then
				DrawBox(650 - 10 - math.modf(string.len(JY.Person[pid]["姓名"]) * 0.5 * 35), xy[flag].talky - 55, 650, xy[flag].talky - 10, C_WHITE)
				DrawString(650 - 5 - math.modf(string.len(JY.Person[pid]["姓名"]) * 0.5 * 35), xy[flag].talky - 50, JY.Person[pid]["姓名"], C_GOLD, 35) 
			end 			
		end
	  end
	  if xy[flag].showhead == 1 then
		lib.PicLoadCache(55, headid * 2, CC.ScreenW - w0, CC.ScreenH - h0 - 135, xy[flag].showhead) 
	  elseif xy[flag].showhead == 17 then
		lib.PicLoadCache(55, headid * 2, 0, CC.ScreenH - h0 - 135, xy[flag].showhead) 
	  end
    end
	
    endp = string.len(s)
	
    if endp <= stop then 
      DrawString(xy[flag].talkx + 5, xy[flag].talky + 5 + talkBorder + dy * (CC.DefaultFont + talkBorder), s, C_WHITE, CC.DefaultFont)
      ShowScreen()
      WaitKey()
      break;
    else
      DrawString(xy[flag].talkx + 5, xy[flag].talky + 5 + talkBorder + dy * (CC.DefaultFont + talkBorder), string.sub(s, 1, stop), C_WHITE, CC.DefaultFont)
    end
    dy = dy + 1
	
    s = string.sub(s, stop + 1)
	
    if talkynum <= dy then
      ShowScreen()
      WaitKey()
      dy = 0
    end
  end
  if CONFIG.KeyRepeat == 0 then
    lib.EnableKeyRepeat(CONFIG.KeyRepeatDelay, CONFIG.KeyRepeatInterval)
  end
  Cls()
end

function say(s,pid,flag,name)  --改为简单版对话了...有时间再整复杂的
	TalkEx(s,pid,flag,name)
end

function fqdid(pid)
if ((pid == 0 and putong() == 3) or DT(pid,77)) and GetS(99,0,1,0) == 2 then --JY.Person[578]["无用14"] == 1 and JY.Person[578]["觉醒"] > 0 then 
return true 
end
return false
end

function War_Quit()  --直接胜利
    if DrawStrBoxYesNo(-1, -1, "确定要直接取胜么？", C_WHITE, 30) == false then        
        do return end
    end
    for i = 0, WAR.PersonNum - 1 do
        if WAR.Person[i]["我方"] == false then
            WAR.Person[i]["死亡"] = true
        end
    end
    return 1
end

--外功领悟指令菜单
function War_WGLW()
	local pid = WAR.Person[WAR.CurID]["人物编号"]
	local take_turn = 1
	if wglw1(pid,98) and (wglw1(pid,98) and PersonKF(pid,98)) or (PersonKF(pid,98) and (DT(pid,618) or NF(pid))) then
		if JY.Person[pid]["体力"] >= 10 then
			Cls()		
			local dxp = {}
			local num = 1
			for i = 1, HHH_GAME_SETTING["WG_COUNT_MAX"] do
				local wid = JY.Person[pid]["武功" .. i]
				if wid == 9999 then wid = JY.Thing[224]["加攻击力"] end
				if wid > 0 and wid <= JY.WugongNum - 1 and ((JY.Wugong[wid]["类型"] > 0 and JY.Wugong[wid]["类型"] < 5) or (wid == 43 and JY.Person[50]["姓名"] == "乔峰" and hasthing(147))) then --斗转需要完成天龙邪
					if wid ~= 98 then
						dxp[num] = {}
						dxp[num][1] = JY.Wugong[wid]["名称"]
						dxp[num][2] = nil
						dxp[num][3] = 1
						dxp[num][4] = wid
						num = num + 1
					end
				end
			end
			if num <= 1 then
				DrawStrBoxWaitKey("没有可模拟的武功", C_WHITE, 30)
				return 0							
			end			
			DrawStrBox(CC.MainMenuX, CC.MainMenuY, "武中无相・外功模拟", C_GOLD, 30)
			local r = ShowMenu(dxp, num - 1, 10, CC.MainMenuX, CC.MainMenuY + 45, 0, 0, 1, 0, CC.DefaultFont, C_RED, C_GOLD)
			SetS(113,0,0,0,dxp[r][4]) 
			SetS(113, 1, 0, 0, 98)
			return 0			
			--[[
			local qishu = JYMsgBox("模拟", "要选择哪一个指令？", {"一", "二", "三", "四", "五"}, 5, pid)
			if qishu <= 0 then
				return 0
			end	
			if qishu == 1 then
				local hh1 = JYMsgBox("一", "要选择哪一个指令？", {"降", "黯", "落", "嵩", "华", "泰", "衡", "恒", "玉", "玄", "伏"}, 11, pid)	
			    if hh1 <= 0 then
					return 0
				end		
				if hh1 == 1 and PersonKF(pid,26) then
				    local zh = JYMsgBox("降龙十八掌", "有余不尽", CC.EVB173, 2, pid)
					if zh == 1 then
					    SetS(113,0,0,0,26) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end	
				elseif hh1 == 2 and PersonKF(pid,25) then
				    local zh = JYMsgBox("黯然销魂掌", "黯然销魂", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,25) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end		
				elseif hh1 == 3 and PersonKF(pid,12) then
				    local zh = JYMsgBox("落英神剑掌", "桃花落英", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,12) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end			
				elseif hh1 == 4 and PersonKF(pid,33) then
				    local zh = JYMsgBox("万岳朝宗", "嵩山剑法", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,33) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end	
				elseif hh1 == 5 and PersonKF(pid,34) then
				    local zh = JYMsgBox("太岳三清峰", "华山剑法", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,34) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end		
				elseif hh1 == 6 and PersonKF(pid,31) then
				    local zh = JYMsgBox("泰山十八盘", "泰山剑法", CC.EVB173, 2, pid)			
					if zh == 1 then
					    SetS(113,0,0,0,31) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end						
				elseif hh1 == 7 and PersonKF(pid,32) then
				    local zh = JYMsgBox("云雾十三式", "衡山剑法", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,32) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end	
				elseif hh1 == 8 and PersonKF(pid,30) then
				    local zh = JYMsgBox("万花剑法", "恒山剑法", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,30) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end	
				elseif hh1 == 9 and PersonKF(pid,38) then
				    local zh = JYMsgBox("玉箫剑法", "桃花神剑", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,38) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				elseif hh1 == 10 and PersonKF(pid,21) then
				    local zh = JYMsgBox("玄冥神掌", "毒吞天下", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,21) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end	
				elseif hh1 == 11 and PersonKF(pid,86) then
				    local zh = JYMsgBox("伏魔杖法", "警恶惩奸", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,86) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end		
				else
				    QZXS("未曾学得此武功，请重新选择")
					return 0
				end	
            elseif qishu == 2 then 	
				local hh2 = JYMsgBox("二", "要选择哪一个指令？", {"霹", "血", "五", "狗", "生", "乱", "极", "六", "太", "火"}, 10, pid)	
			    if hh2 <= 0 then
					return 0
				end	
				if hh2 == 1 and PersonKF(pid,141) then
				    local zh = JYMsgBox("霹雳刀法", "神州三绝", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,141) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				elseif hh2 == 2 and PersonKF(pid,63) then
				    local zh = JYMsgBox("血刀大法", "血洗天河", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,63) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				elseif hh2 == 3 and PersonKF(pid,155) then
				    local zh = JYMsgBox("五指秘刀", "密宗气刀", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,155) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				elseif hh2 == 4 and PersonKF(pid,80) then
				    local zh = JYMsgBox("打狗棒法", "天下无狗", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,80) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				elseif hh2 == 5 and PersonKF(pid,176) then
				    local zh = JYMsgBox("生死符", "生死无常", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,176) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end			
				elseif hh2 == 6 and PersonKF(pid,77) then
				    local zh = JYMsgBox("阴阳倒乱刃", "阴阳倒乱", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,77) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end	
				elseif hh2 == 7 and PersonKF(pid,46) then
				    local zh = JYMsgBox("太极剑法", "意在剑先", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,46) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end	
				elseif hh2 == 8 and PersonKF(pid,49) then
				    local zh = JYMsgBox("六脉神剑", "六脉剑气", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,49) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end		
				elseif hh2 == 9 and PersonKF(pid,16) then
				    local zh = JYMsgBox("太极拳经", "后发先至", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,16) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end		
				elseif hh2 == 10 and PersonKF(pid,66) then
				    local zh = JYMsgBox("火焰刀法", "宁玛绝学", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,66) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end			
				else
				    QZXS("未曾学得此武功，请重新选择")
					return 0
				end
            elseif qishu == 3 then 	
				local hh3 = JYMsgBox("三", "要选择哪一个指令？", {"葵", "修", "天", "一", "七", "催", "霹", "参", "玉", "北"}, 10, pid)	
			    if hh3 <= 0 then
					return 0
				end	
                if hh3 == 1 and PersonKF(pid,177) then
				    local zh = JYMsgBox("葵花神针", "似剑飞针", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,177) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				elseif hh3 == 2 and PersonKF(pid,58) then
				    local zh = JYMsgBox("修罗刀法", "阿鼻三刀", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,58) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end	
				elseif hh3 == 3 and PersonKF(pid,8) then
				    local zh = JYMsgBox("天山六阳", "潇洒如意", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,8) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end		
				elseif hh3 == 4 and PersonKF(pid,17) then
				    local zh = JYMsgBox("一阳指法", "六脉根基", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,17) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end			
				elseif hh3 == 5 and PersonKF(pid,23) then
				    local zh = JYMsgBox("七伤拳法", "伤己伤敌", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,23) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end				
				elseif hh3 == 6 and PersonKF(pid,11) then
				    local zh = JYMsgBox("摧坚神爪", "飘忽灵动", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,11) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end					
				elseif hh3 == 7 and PersonKF(pid,175) then
				    local zh = JYMsgBox("霹雳火雷", "神州三绝", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,175) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end					
				elseif hh3 == 8 and PersonKF(pid,133) then
				    local zh = JYMsgBox("参合指法", "慕容家传", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,133) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end			
				elseif hh3 == 9 and PersonKF(pid,42) then
				    local zh = JYMsgBox("玉女素心", "古墓绝学", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,42) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end			
				elseif hh3 == 10 and PersonKF(pid,39) then
				    local zh = JYMsgBox("北斗罡剑", "全真绝学", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,39) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end						
                else
				    QZXS("未曾学得此武功，请重新选择")
					return 0
			    end				
			elseif qishu == 4 then 	
				local hh4 = JYMsgBox("四", "要选择哪一个指令？", {"空", "幻", "白", "蚊", "阴", "反", "须", "力", "沙", "琴"}, 10, pid)	
			    if hh4 <= 0 then
					return 0
				end	
				if hh4 == 1 and PersonKF(pid,15) then
				    local zh = JYMsgBox("空明拳法", "以虚击实", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,15) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end	
				elseif hh4 == 2 and PersonKF(pid,19) then
				    local zh = JYMsgBox("幻阴指法", "阴寒霸道", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,19) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end		
				elseif hh4 == 3 and PersonKF(pid,148) then
				    local zh = JYMsgBox("白羽箭法", "草原神箭", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,148) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end								
				elseif hh4 == 4 and PersonKF(pid,166) then
				    local zh = JYMsgBox("蚊须针法", "天鹰暗器", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,166) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				elseif hh4 == 5 and PersonKF(pid,140) then
				    local zh = JYMsgBox("阴风刀法", "诡异莫测", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,140) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end			
				elseif hh4 == 6 and PersonKF(pid,60) then
				    local zh = JYMsgBox("反两仪刀法", "昆仑双绝", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,60) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				elseif hh4 == 7 and PersonKF(pid,24) then
				    local zh = JYMsgBox("须弥山神掌", "净罪佛光", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,24) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end		
				elseif hh4 == 8 and PersonKF(pid,83) then
				    local zh = JYMsgBox("无上大力杵", "大力神威", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,83) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				elseif hh4 == 9 and PersonKF(pid,78) then
				    local zh = JYMsgBox("黄沙万里鞭", "血沙漫天", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,78) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				elseif hh4 == 10 and PersonKF(pid,73) then
				    local zh = JYMsgBox("持瑶琴", "弦奏神邪", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,73) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end	
				else
				    QZXS("未曾学得此武功，请重新选择")
					return 0
				end		
			elseif qishu == 5 then 	
				local hh5 = JYMsgBox("五", "要选择哪一个指令？", {"金", "八", "胡", "魄", "弹", "灵", "灵", "蛇", "杨", "？"}, 10, pid)	
			    if hh5 <= 0 then
					return 0
				end	
				if hh5 == 1 and PersonKF(pid,61) then
				    local zh = JYMsgBox("金乌刀法", "烈阳高照", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,61) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				else
				    QZXS("未曾学得此武功，请重新选择")
					return 0
				end
				if hh5 == 2 and PersonKF(pid,138) then
				    local zh = JYMsgBox("八卦刀法", "阵图护身", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,138) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				else
				    QZXS("未曾学得此武功，请重新选择")
					return 0
				end
				if hh5 == 3 and PersonKF(pid,67) then
				    local zh = JYMsgBox("胡家刀法", "精绝一刀", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,67) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				else
				    QZXS("未曾学得此武功，请重新选择")
					return 0
				end
				if hh5 == 4 and PersonKF(pid,170) then
				    local zh = JYMsgBox("冰魄银针", "情为何物", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,170) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				else
				    QZXS("未曾学得此武功，请重新选择")
					return 0
				end
				if hh5 == 5 and PersonKF(pid,18) then
				    local zh = JYMsgBox("弹指神通", "桃花绝技", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,18) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				else
				    QZXS("未曾学得此武功，请重新选择")
					return 0
				end
				if hh5 == 6 and PersonKF(pid,120) then
				    local zh = JYMsgBox("灵蛇杖法", "杖毒合一", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,120) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				else
				    QZXS("未曾学得此武功，请重新选择")
					return 0
				end
				if hh5 == 7 and PersonKF(pid,9) then
				    local zh = JYMsgBox("灵蛇拳法", "拳路难测", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,9) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				else
				    QZXS("未曾学得此武功，请重新选择")
					return 0
				end
				if hh5 == 8 and PersonKF(pid,40) then
				    local zh = JYMsgBox("金蛇秘传", "剑锥夺魂", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,40) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				else
				    QZXS("未曾学得此武功，请重新选择")
					return 0
				end
				if hh5 == 9 and PersonKF(pid,68) then
				    local zh = JYMsgBox("杨家枪法", "燎原枪势", CC.EVB173, 2, pid)				
					if zh == 1 then
					    SetS(113,0,0,0,68) 
						SetS(113, 1, 0, 0, 98)
						return 0
					else
						return 0
					end
				else
				    QZXS("未曾学得此武功，请重新选择")
					return 0
				end
			end
			]]
		end
	elseif (wglw1(pid,67) and GetS(113,0,0,0) == 67 and PersonKF(pid,67)) or (DT(pid, 1) and JX(pid)) or (DT(pid, 621) and JX(pid)) then  
		WAR.ShowHead = 0
		local thing = {}
		local thingnum = {}
		for i = 0, CC.MyThingNum - 1 do
			thing[i] = -1
			thingnum[i] = 0
		end
		local num = 0
		for i = 0, CC.MyThingNum - 1 do
			local id = JY.Base["物品" .. i + 1]
			if id >= 0 and (JY.Thing[id]["类型"] == 1) then
			  thing[num] = id
			  thingnum[num] = JY.Base["物品数量" .. i + 1]
			  num = num + 1
			end
		end
		local r = SelectThing(thing, thingnum)
		Cls()
		local rr = 0
		if r >= 0 and UseThing(r) == 1 then
		rr = 0
		end
		WAR.ShowHead = 1
		Cls()
		return rr
	else
		QZXS("该人物不会领悟")
		take_turn = 0
	end
	    return take_turn
end

function War_ThingMenu1()--战斗物品菜单
local pid = WAR.Person[WAR.CurID]["人物编号"]
	if (wglw1(pid,67) and GetS(113,0,0,0) == 67 and PersonKF(pid,67)) or (DT(pid, 1) and JX(pid)) or (DT(pid, 621) and JX(pid)) then  
		WAR.ShowHead = 0
		local thing = {}
		local thingnum = {}
		for i = 0, CC.MyThingNum - 1 do
			thing[i] = -1
			thingnum[i] = 0
		end
		local num = 0
		for i = 0, CC.MyThingNum - 1 do
			local id = JY.Base["物品" .. i + 1]
			if id >= 0 and (JY.Thing[id]["类型"] == 1) then
			  thing[num] = id
			  thingnum[num] = JY.Base["物品数量" .. i + 1]
			  num = num + 1
			end
		end
		local r = SelectThing(thing, thingnum)
		Cls()
		local rr = 0
		if r >= 0 and UseThing(r) == 1 then
		rr = 1
		end
		WAR.ShowHead = 1
		Cls()
		return rr
	else
		QZXS("该人物不会领悟")
		local rr = 0
		WAR.ShowHead = 1
		Cls()
		return rr
	end	
end

--检测是否支持模块
function isModuleAvailable(name)
  if package.loaded[name] then
    return true
  else
    for _,searcher in ipairs(package.searchers or package.loaders) do
      local loader = searcher(name)
      if type(loader) == 'function' then
        package.preload[name] = loader
        return true
      end
    end
    return false
  end
end